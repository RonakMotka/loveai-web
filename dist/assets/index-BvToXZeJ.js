var Ede=Object.defineProperty;var vde=(o,d,h)=>d in o?Ede(o,d,{enumerable:!0,configurable:!0,writable:!0,value:h}):o[d]=h;var ry=(o,d,h)=>vde(o,typeof d!="symbol"?d+"":d,h);function Sde(o,d){for(var h=0;h<d.length;h++){const g=d[h];if(typeof g!="string"&&!Array.isArray(g)){for(const T in g)if(T!=="default"&&!(T in o)){const I=Object.getOwnPropertyDescriptor(g,T);I&&Object.defineProperty(o,T,I.get?I:{enumerable:!0,get:()=>g[T]})}}}return Object.freeze(Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}))}(function(){const d=document.createElement("link").relList;if(d&&d.supports&&d.supports("modulepreload"))return;for(const T of document.querySelectorAll('link[rel="modulepreload"]'))g(T);new MutationObserver(T=>{for(const I of T)if(I.type==="childList")for(const N of I.addedNodes)N.tagName==="LINK"&&N.rel==="modulepreload"&&g(N)}).observe(document,{childList:!0,subtree:!0});function h(T){const I={};return T.integrity&&(I.integrity=T.integrity),T.referrerPolicy&&(I.referrerPolicy=T.referrerPolicy),T.crossOrigin==="use-credentials"?I.credentials="include":T.crossOrigin==="anonymous"?I.credentials="omit":I.credentials="same-origin",I}function g(T){if(T.ep)return;T.ep=!0;const I=h(T);fetch(T.href,I)}})();var r5=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function _G(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}function yde(o){if(Object.prototype.hasOwnProperty.call(o,"__esModule"))return o;var d=o.default;if(typeof d=="function"){var h=function g(){return this instanceof g?Reflect.construct(d,arguments,this.constructor):d.apply(this,arguments)};h.prototype=d.prototype}else h={};return Object.defineProperty(h,"__esModule",{value:!0}),Object.keys(o).forEach(function(g){var T=Object.getOwnPropertyDescriptor(o,g);Object.defineProperty(h,g,T.get?T:{enumerable:!0,get:function(){return o[g]}})}),h}var bK={exports:{}},kj={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var f$;function Tde(){if(f$)return kj;f$=1;var o=Symbol.for("react.transitional.element"),d=Symbol.for("react.fragment");function h(g,T,I){var N=null;if(I!==void 0&&(N=""+I),T.key!==void 0&&(N=""+T.key),"key"in T){I={};for(var M in T)M!=="key"&&(I[M]=T[M])}else I=T;return T=I.ref,{$$typeof:o,type:g,key:N,ref:T!==void 0?T:null,props:I}}return kj.Fragment=d,kj.jsx=h,kj.jsxs=h,kj}var h$;function bde(){return h$||(h$=1,bK.exports=Tde()),bK.exports}var j=bde(),CK={exports:{}},Xr={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var p$;function Cde(){if(p$)return Xr;p$=1;var o=Symbol.for("react.transitional.element"),d=Symbol.for("react.portal"),h=Symbol.for("react.fragment"),g=Symbol.for("react.strict_mode"),T=Symbol.for("react.profiler"),I=Symbol.for("react.consumer"),N=Symbol.for("react.context"),M=Symbol.for("react.forward_ref"),k=Symbol.for("react.suspense"),x=Symbol.for("react.memo"),V=Symbol.for("react.lazy"),K=Symbol.iterator;function Q(Ae){return Ae===null||typeof Ae!="object"?null:(Ae=K&&Ae[K]||Ae["@@iterator"],typeof Ae=="function"?Ae:null)}var ie={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},X=Object.assign,Z={};function ae(Ae,rt,yt){this.props=Ae,this.context=rt,this.refs=Z,this.updater=yt||ie}ae.prototype.isReactComponent={},ae.prototype.setState=function(Ae,rt){if(typeof Ae!="object"&&typeof Ae!="function"&&Ae!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Ae,rt,"setState")},ae.prototype.forceUpdate=function(Ae){this.updater.enqueueForceUpdate(this,Ae,"forceUpdate")};function le(){}le.prototype=ae.prototype;function fe(Ae,rt,yt){this.props=Ae,this.context=rt,this.refs=Z,this.updater=yt||ie}var ue=fe.prototype=new le;ue.constructor=fe,X(ue,ae.prototype),ue.isPureReactComponent=!0;var de=Array.isArray,te={H:null,A:null,T:null,S:null,V:null},ye=Object.prototype.hasOwnProperty;function Te(Ae,rt,yt,Lt,Pt,_n){return yt=_n.ref,{$$typeof:o,type:Ae,key:rt,ref:yt!==void 0?yt:null,props:_n}}function Le(Ae,rt){return Te(Ae.type,rt,void 0,void 0,void 0,Ae.props)}function je(Ae){return typeof Ae=="object"&&Ae!==null&&Ae.$$typeof===o}function he(Ae){var rt={"=":"=0",":":"=2"};return"$"+Ae.replace(/[=:]/g,function(yt){return rt[yt]})}var ke=/\/+/g;function We(Ae,rt){return typeof Ae=="object"&&Ae!==null&&Ae.key!=null?he(""+Ae.key):rt.toString(36)}function ze(){}function $e(Ae){switch(Ae.status){case"fulfilled":return Ae.value;case"rejected":throw Ae.reason;default:switch(typeof Ae.status=="string"?Ae.then(ze,ze):(Ae.status="pending",Ae.then(function(rt){Ae.status==="pending"&&(Ae.status="fulfilled",Ae.value=rt)},function(rt){Ae.status==="pending"&&(Ae.status="rejected",Ae.reason=rt)})),Ae.status){case"fulfilled":return Ae.value;case"rejected":throw Ae.reason}}throw Ae}function et(Ae,rt,yt,Lt,Pt){var _n=typeof Ae;(_n==="undefined"||_n==="boolean")&&(Ae=null);var Gt=!1;if(Ae===null)Gt=!0;else switch(_n){case"bigint":case"string":case"number":Gt=!0;break;case"object":switch(Ae.$$typeof){case o:case d:Gt=!0;break;case V:return Gt=Ae._init,et(Gt(Ae._payload),rt,yt,Lt,Pt)}}if(Gt)return Pt=Pt(Ae),Gt=Lt===""?"."+We(Ae,0):Lt,de(Pt)?(yt="",Gt!=null&&(yt=Gt.replace(ke,"$&/")+"/"),et(Pt,rt,yt,"",function(ir){return ir})):Pt!=null&&(je(Pt)&&(Pt=Le(Pt,yt+(Pt.key==null||Ae&&Ae.key===Pt.key?"":(""+Pt.key).replace(ke,"$&/")+"/")+Gt)),rt.push(Pt)),1;Gt=0;var zt=Lt===""?".":Lt+":";if(de(Ae))for(var rn=0;rn<Ae.length;rn++)Lt=Ae[rn],_n=zt+We(Lt,rn),Gt+=et(Lt,rt,yt,_n,Pt);else if(rn=Q(Ae),typeof rn=="function")for(Ae=rn.call(Ae),rn=0;!(Lt=Ae.next()).done;)Lt=Lt.value,_n=zt+We(Lt,rn++),Gt+=et(Lt,rt,yt,_n,Pt);else if(_n==="object"){if(typeof Ae.then=="function")return et($e(Ae),rt,yt,Lt,Pt);throw rt=String(Ae),Error("Objects are not valid as a React child (found: "+(rt==="[object Object]"?"object with keys {"+Object.keys(Ae).join(", ")+"}":rt)+"). If you meant to render a collection of children, use an array instead.")}return Gt}function Oe(Ae,rt,yt){if(Ae==null)return Ae;var Lt=[],Pt=0;return et(Ae,Lt,"","",function(_n){return rt.call(yt,_n,Pt++)}),Lt}function qe(Ae){if(Ae._status===-1){var rt=Ae._result;rt=rt(),rt.then(function(yt){(Ae._status===0||Ae._status===-1)&&(Ae._status=1,Ae._result=yt)},function(yt){(Ae._status===0||Ae._status===-1)&&(Ae._status=2,Ae._result=yt)}),Ae._status===-1&&(Ae._status=0,Ae._result=rt)}if(Ae._status===1)return Ae._result.default;throw Ae._result}var lt=typeof reportError=="function"?reportError:function(Ae){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var rt=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof Ae=="object"&&Ae!==null&&typeof Ae.message=="string"?String(Ae.message):String(Ae),error:Ae});if(!window.dispatchEvent(rt))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",Ae);return}console.error(Ae)};function Ge(){}return Xr.Children={map:Oe,forEach:function(Ae,rt,yt){Oe(Ae,function(){rt.apply(this,arguments)},yt)},count:function(Ae){var rt=0;return Oe(Ae,function(){rt++}),rt},toArray:function(Ae){return Oe(Ae,function(rt){return rt})||[]},only:function(Ae){if(!je(Ae))throw Error("React.Children.only expected to receive a single React element child.");return Ae}},Xr.Component=ae,Xr.Fragment=h,Xr.Profiler=T,Xr.PureComponent=fe,Xr.StrictMode=g,Xr.Suspense=k,Xr.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=te,Xr.__COMPILER_RUNTIME={__proto__:null,c:function(Ae){return te.H.useMemoCache(Ae)}},Xr.cache=function(Ae){return function(){return Ae.apply(null,arguments)}},Xr.cloneElement=function(Ae,rt,yt){if(Ae==null)throw Error("The argument must be a React element, but you passed "+Ae+".");var Lt=X({},Ae.props),Pt=Ae.key,_n=void 0;if(rt!=null)for(Gt in rt.ref!==void 0&&(_n=void 0),rt.key!==void 0&&(Pt=""+rt.key),rt)!ye.call(rt,Gt)||Gt==="key"||Gt==="__self"||Gt==="__source"||Gt==="ref"&&rt.ref===void 0||(Lt[Gt]=rt[Gt]);var Gt=arguments.length-2;if(Gt===1)Lt.children=yt;else if(1<Gt){for(var zt=Array(Gt),rn=0;rn<Gt;rn++)zt[rn]=arguments[rn+2];Lt.children=zt}return Te(Ae.type,Pt,void 0,void 0,_n,Lt)},Xr.createContext=function(Ae){return Ae={$$typeof:N,_currentValue:Ae,_currentValue2:Ae,_threadCount:0,Provider:null,Consumer:null},Ae.Provider=Ae,Ae.Consumer={$$typeof:I,_context:Ae},Ae},Xr.createElement=function(Ae,rt,yt){var Lt,Pt={},_n=null;if(rt!=null)for(Lt in rt.key!==void 0&&(_n=""+rt.key),rt)ye.call(rt,Lt)&&Lt!=="key"&&Lt!=="__self"&&Lt!=="__source"&&(Pt[Lt]=rt[Lt]);var Gt=arguments.length-2;if(Gt===1)Pt.children=yt;else if(1<Gt){for(var zt=Array(Gt),rn=0;rn<Gt;rn++)zt[rn]=arguments[rn+2];Pt.children=zt}if(Ae&&Ae.defaultProps)for(Lt in Gt=Ae.defaultProps,Gt)Pt[Lt]===void 0&&(Pt[Lt]=Gt[Lt]);return Te(Ae,_n,void 0,void 0,null,Pt)},Xr.createRef=function(){return{current:null}},Xr.forwardRef=function(Ae){return{$$typeof:M,render:Ae}},Xr.isValidElement=je,Xr.lazy=function(Ae){return{$$typeof:V,_payload:{_status:-1,_result:Ae},_init:qe}},Xr.memo=function(Ae,rt){return{$$typeof:x,type:Ae,compare:rt===void 0?null:rt}},Xr.startTransition=function(Ae){var rt=te.T,yt={};te.T=yt;try{var Lt=Ae(),Pt=te.S;Pt!==null&&Pt(yt,Lt),typeof Lt=="object"&&Lt!==null&&typeof Lt.then=="function"&&Lt.then(Ge,lt)}catch(_n){lt(_n)}finally{te.T=rt}},Xr.unstable_useCacheRefresh=function(){return te.H.useCacheRefresh()},Xr.use=function(Ae){return te.H.use(Ae)},Xr.useActionState=function(Ae,rt,yt){return te.H.useActionState(Ae,rt,yt)},Xr.useCallback=function(Ae,rt){return te.H.useCallback(Ae,rt)},Xr.useContext=function(Ae){return te.H.useContext(Ae)},Xr.useDebugValue=function(){},Xr.useDeferredValue=function(Ae,rt){return te.H.useDeferredValue(Ae,rt)},Xr.useEffect=function(Ae,rt,yt){var Lt=te.H;if(typeof yt=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return Lt.useEffect(Ae,rt)},Xr.useId=function(){return te.H.useId()},Xr.useImperativeHandle=function(Ae,rt,yt){return te.H.useImperativeHandle(Ae,rt,yt)},Xr.useInsertionEffect=function(Ae,rt){return te.H.useInsertionEffect(Ae,rt)},Xr.useLayoutEffect=function(Ae,rt){return te.H.useLayoutEffect(Ae,rt)},Xr.useMemo=function(Ae,rt){return te.H.useMemo(Ae,rt)},Xr.useOptimistic=function(Ae,rt){return te.H.useOptimistic(Ae,rt)},Xr.useReducer=function(Ae,rt,yt){return te.H.useReducer(Ae,rt,yt)},Xr.useRef=function(Ae){return te.H.useRef(Ae)},Xr.useState=function(Ae){return te.H.useState(Ae)},Xr.useSyncExternalStore=function(Ae,rt,yt){return te.H.useSyncExternalStore(Ae,rt,yt)},Xr.useTransition=function(){return te.H.useTransition()},Xr.version="19.1.0",Xr}var m$;function EG(){return m$||(m$=1,CK.exports=Cde()),CK.exports}var q=EG();const fo=_G(q),AX=Sde({__proto__:null,default:fo},[q]);var wK={exports:{}},xj={},RK={exports:{}},IK={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var g$;function wde(){return g$||(g$=1,function(o){function d(Oe,qe){var lt=Oe.length;Oe.push(qe);e:for(;0<lt;){var Ge=lt-1>>>1,Ae=Oe[Ge];if(0<T(Ae,qe))Oe[Ge]=qe,Oe[lt]=Ae,lt=Ge;else break e}}function h(Oe){return Oe.length===0?null:Oe[0]}function g(Oe){if(Oe.length===0)return null;var qe=Oe[0],lt=Oe.pop();if(lt!==qe){Oe[0]=lt;e:for(var Ge=0,Ae=Oe.length,rt=Ae>>>1;Ge<rt;){var yt=2*(Ge+1)-1,Lt=Oe[yt],Pt=yt+1,_n=Oe[Pt];if(0>T(Lt,lt))Pt<Ae&&0>T(_n,Lt)?(Oe[Ge]=_n,Oe[Pt]=lt,Ge=Pt):(Oe[Ge]=Lt,Oe[yt]=lt,Ge=yt);else if(Pt<Ae&&0>T(_n,lt))Oe[Ge]=_n,Oe[Pt]=lt,Ge=Pt;else break e}}return qe}function T(Oe,qe){var lt=Oe.sortIndex-qe.sortIndex;return lt!==0?lt:Oe.id-qe.id}if(o.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var I=performance;o.unstable_now=function(){return I.now()}}else{var N=Date,M=N.now();o.unstable_now=function(){return N.now()-M}}var k=[],x=[],V=1,K=null,Q=3,ie=!1,X=!1,Z=!1,ae=!1,le=typeof setTimeout=="function"?setTimeout:null,fe=typeof clearTimeout=="function"?clearTimeout:null,ue=typeof setImmediate<"u"?setImmediate:null;function de(Oe){for(var qe=h(x);qe!==null;){if(qe.callback===null)g(x);else if(qe.startTime<=Oe)g(x),qe.sortIndex=qe.expirationTime,d(k,qe);else break;qe=h(x)}}function te(Oe){if(Z=!1,de(Oe),!X)if(h(k)!==null)X=!0,ye||(ye=!0,We());else{var qe=h(x);qe!==null&&et(te,qe.startTime-Oe)}}var ye=!1,Te=-1,Le=5,je=-1;function he(){return ae?!0:!(o.unstable_now()-je<Le)}function ke(){if(ae=!1,ye){var Oe=o.unstable_now();je=Oe;var qe=!0;try{e:{X=!1,Z&&(Z=!1,fe(Te),Te=-1),ie=!0;var lt=Q;try{t:{for(de(Oe),K=h(k);K!==null&&!(K.expirationTime>Oe&&he());){var Ge=K.callback;if(typeof Ge=="function"){K.callback=null,Q=K.priorityLevel;var Ae=Ge(K.expirationTime<=Oe);if(Oe=o.unstable_now(),typeof Ae=="function"){K.callback=Ae,de(Oe),qe=!0;break t}K===h(k)&&g(k),de(Oe)}else g(k);K=h(k)}if(K!==null)qe=!0;else{var rt=h(x);rt!==null&&et(te,rt.startTime-Oe),qe=!1}}break e}finally{K=null,Q=lt,ie=!1}qe=void 0}}finally{qe?We():ye=!1}}}var We;if(typeof ue=="function")We=function(){ue(ke)};else if(typeof MessageChannel<"u"){var ze=new MessageChannel,$e=ze.port2;ze.port1.onmessage=ke,We=function(){$e.postMessage(null)}}else We=function(){le(ke,0)};function et(Oe,qe){Te=le(function(){Oe(o.unstable_now())},qe)}o.unstable_IdlePriority=5,o.unstable_ImmediatePriority=1,o.unstable_LowPriority=4,o.unstable_NormalPriority=3,o.unstable_Profiling=null,o.unstable_UserBlockingPriority=2,o.unstable_cancelCallback=function(Oe){Oe.callback=null},o.unstable_forceFrameRate=function(Oe){0>Oe||125<Oe?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Le=0<Oe?Math.floor(1e3/Oe):5},o.unstable_getCurrentPriorityLevel=function(){return Q},o.unstable_next=function(Oe){switch(Q){case 1:case 2:case 3:var qe=3;break;default:qe=Q}var lt=Q;Q=qe;try{return Oe()}finally{Q=lt}},o.unstable_requestPaint=function(){ae=!0},o.unstable_runWithPriority=function(Oe,qe){switch(Oe){case 1:case 2:case 3:case 4:case 5:break;default:Oe=3}var lt=Q;Q=Oe;try{return qe()}finally{Q=lt}},o.unstable_scheduleCallback=function(Oe,qe,lt){var Ge=o.unstable_now();switch(typeof lt=="object"&&lt!==null?(lt=lt.delay,lt=typeof lt=="number"&&0<lt?Ge+lt:Ge):lt=Ge,Oe){case 1:var Ae=-1;break;case 2:Ae=250;break;case 5:Ae=1073741823;break;case 4:Ae=1e4;break;default:Ae=5e3}return Ae=lt+Ae,Oe={id:V++,callback:qe,priorityLevel:Oe,startTime:lt,expirationTime:Ae,sortIndex:-1},lt>Ge?(Oe.sortIndex=lt,d(x,Oe),h(k)===null&&Oe===h(x)&&(Z?(fe(Te),Te=-1):Z=!0,et(te,lt-Ge))):(Oe.sortIndex=Ae,d(k,Oe),X||ie||(X=!0,ye||(ye=!0,We()))),Oe},o.unstable_shouldYield=he,o.unstable_wrapCallback=function(Oe){var qe=Q;return function(){var lt=Q;Q=qe;try{return Oe.apply(this,arguments)}finally{Q=lt}}}}(IK)),IK}var _$;function Rde(){return _$||(_$=1,RK.exports=wde()),RK.exports}var AK={exports:{}},gd={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var E$;function Ide(){if(E$)return gd;E$=1;var o=EG();function d(k){var x="https://react.dev/errors/"+k;if(1<arguments.length){x+="?args[]="+encodeURIComponent(arguments[1]);for(var V=2;V<arguments.length;V++)x+="&args[]="+encodeURIComponent(arguments[V])}return"Minified React error #"+k+"; visit "+x+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function h(){}var g={d:{f:h,r:function(){throw Error(d(522))},D:h,C:h,L:h,m:h,X:h,S:h,M:h},p:0,findDOMNode:null},T=Symbol.for("react.portal");function I(k,x,V){var K=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:T,key:K==null?null:""+K,children:k,containerInfo:x,implementation:V}}var N=o.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function M(k,x){if(k==="font")return"";if(typeof x=="string")return x==="use-credentials"?x:""}return gd.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=g,gd.createPortal=function(k,x){var V=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!x||x.nodeType!==1&&x.nodeType!==9&&x.nodeType!==11)throw Error(d(299));return I(k,x,null,V)},gd.flushSync=function(k){var x=N.T,V=g.p;try{if(N.T=null,g.p=2,k)return k()}finally{N.T=x,g.p=V,g.d.f()}},gd.preconnect=function(k,x){typeof k=="string"&&(x?(x=x.crossOrigin,x=typeof x=="string"?x==="use-credentials"?x:"":void 0):x=null,g.d.C(k,x))},gd.prefetchDNS=function(k){typeof k=="string"&&g.d.D(k)},gd.preinit=function(k,x){if(typeof k=="string"&&x&&typeof x.as=="string"){var V=x.as,K=M(V,x.crossOrigin),Q=typeof x.integrity=="string"?x.integrity:void 0,ie=typeof x.fetchPriority=="string"?x.fetchPriority:void 0;V==="style"?g.d.S(k,typeof x.precedence=="string"?x.precedence:void 0,{crossOrigin:K,integrity:Q,fetchPriority:ie}):V==="script"&&g.d.X(k,{crossOrigin:K,integrity:Q,fetchPriority:ie,nonce:typeof x.nonce=="string"?x.nonce:void 0})}},gd.preinitModule=function(k,x){if(typeof k=="string")if(typeof x=="object"&&x!==null){if(x.as==null||x.as==="script"){var V=M(x.as,x.crossOrigin);g.d.M(k,{crossOrigin:V,integrity:typeof x.integrity=="string"?x.integrity:void 0,nonce:typeof x.nonce=="string"?x.nonce:void 0})}}else x==null&&g.d.M(k)},gd.preload=function(k,x){if(typeof k=="string"&&typeof x=="object"&&x!==null&&typeof x.as=="string"){var V=x.as,K=M(V,x.crossOrigin);g.d.L(k,V,{crossOrigin:K,integrity:typeof x.integrity=="string"?x.integrity:void 0,nonce:typeof x.nonce=="string"?x.nonce:void 0,type:typeof x.type=="string"?x.type:void 0,fetchPriority:typeof x.fetchPriority=="string"?x.fetchPriority:void 0,referrerPolicy:typeof x.referrerPolicy=="string"?x.referrerPolicy:void 0,imageSrcSet:typeof x.imageSrcSet=="string"?x.imageSrcSet:void 0,imageSizes:typeof x.imageSizes=="string"?x.imageSizes:void 0,media:typeof x.media=="string"?x.media:void 0})}},gd.preloadModule=function(k,x){if(typeof k=="string")if(x){var V=M(x.as,x.crossOrigin);g.d.m(k,{as:typeof x.as=="string"&&x.as!=="script"?x.as:void 0,crossOrigin:V,integrity:typeof x.integrity=="string"?x.integrity:void 0})}else g.d.m(k)},gd.requestFormReset=function(k){g.d.r(k)},gd.unstable_batchedUpdates=function(k,x){return k(x)},gd.useFormState=function(k,x,V){return N.H.useFormState(k,x,V)},gd.useFormStatus=function(){return N.H.useHostTransitionStatus()},gd.version="19.1.0",gd}var v$;function Kie(){if(v$)return AK.exports;v$=1;function o(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(o)}catch(d){console.error(d)}}return o(),AK.exports=Ide(),AK.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var S$;function Ade(){if(S$)return xj;S$=1;var o=Rde(),d=EG(),h=Kie();function g(p){var v="https://react.dev/errors/"+p;if(1<arguments.length){v+="?args[]="+encodeURIComponent(arguments[1]);for(var w=2;w<arguments.length;w++)v+="&args[]="+encodeURIComponent(arguments[w])}return"Minified React error #"+p+"; visit "+v+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function T(p){return!(!p||p.nodeType!==1&&p.nodeType!==9&&p.nodeType!==11)}function I(p){var v=p,w=p;if(p.alternate)for(;v.return;)v=v.return;else{p=v;do v=p,(v.flags&4098)!==0&&(w=v.return),p=v.return;while(p)}return v.tag===3?w:null}function N(p){if(p.tag===13){var v=p.memoizedState;if(v===null&&(p=p.alternate,p!==null&&(v=p.memoizedState)),v!==null)return v.dehydrated}return null}function M(p){if(I(p)!==p)throw Error(g(188))}function k(p){var v=p.alternate;if(!v){if(v=I(p),v===null)throw Error(g(188));return v!==p?null:p}for(var w=p,L=v;;){var U=w.return;if(U===null)break;var H=U.alternate;if(H===null){if(L=U.return,L!==null){w=L;continue}break}if(U.child===H.child){for(H=U.child;H;){if(H===w)return M(U),p;if(H===L)return M(U),v;H=H.sibling}throw Error(g(188))}if(w.return!==L.return)w=U,L=H;else{for(var pe=!1,Ce=U.child;Ce;){if(Ce===w){pe=!0,w=U,L=H;break}if(Ce===L){pe=!0,L=U,w=H;break}Ce=Ce.sibling}if(!pe){for(Ce=H.child;Ce;){if(Ce===w){pe=!0,w=H,L=U;break}if(Ce===L){pe=!0,L=H,w=U;break}Ce=Ce.sibling}if(!pe)throw Error(g(189))}}if(w.alternate!==L)throw Error(g(190))}if(w.tag!==3)throw Error(g(188));return w.stateNode.current===w?p:v}function x(p){var v=p.tag;if(v===5||v===26||v===27||v===6)return p;for(p=p.child;p!==null;){if(v=x(p),v!==null)return v;p=p.sibling}return null}var V=Object.assign,K=Symbol.for("react.element"),Q=Symbol.for("react.transitional.element"),ie=Symbol.for("react.portal"),X=Symbol.for("react.fragment"),Z=Symbol.for("react.strict_mode"),ae=Symbol.for("react.profiler"),le=Symbol.for("react.provider"),fe=Symbol.for("react.consumer"),ue=Symbol.for("react.context"),de=Symbol.for("react.forward_ref"),te=Symbol.for("react.suspense"),ye=Symbol.for("react.suspense_list"),Te=Symbol.for("react.memo"),Le=Symbol.for("react.lazy"),je=Symbol.for("react.activity"),he=Symbol.for("react.memo_cache_sentinel"),ke=Symbol.iterator;function We(p){return p===null||typeof p!="object"?null:(p=ke&&p[ke]||p["@@iterator"],typeof p=="function"?p:null)}var ze=Symbol.for("react.client.reference");function $e(p){if(p==null)return null;if(typeof p=="function")return p.$$typeof===ze?null:p.displayName||p.name||null;if(typeof p=="string")return p;switch(p){case X:return"Fragment";case ae:return"Profiler";case Z:return"StrictMode";case te:return"Suspense";case ye:return"SuspenseList";case je:return"Activity"}if(typeof p=="object")switch(p.$$typeof){case ie:return"Portal";case ue:return(p.displayName||"Context")+".Provider";case fe:return(p._context.displayName||"Context")+".Consumer";case de:var v=p.render;return p=p.displayName,p||(p=v.displayName||v.name||"",p=p!==""?"ForwardRef("+p+")":"ForwardRef"),p;case Te:return v=p.displayName||null,v!==null?v:$e(p.type)||"Memo";case Le:v=p._payload,p=p._init;try{return $e(p(v))}catch{}}return null}var et=Array.isArray,Oe=d.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,qe=h.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,lt={pending:!1,data:null,method:null,action:null},Ge=[],Ae=-1;function rt(p){return{current:p}}function yt(p){0>Ae||(p.current=Ge[Ae],Ge[Ae]=null,Ae--)}function Lt(p,v){Ae++,Ge[Ae]=p.current,p.current=v}var Pt=rt(null),_n=rt(null),Gt=rt(null),zt=rt(null);function rn(p,v){switch(Lt(Gt,v),Lt(_n,p),Lt(Pt,null),v.nodeType){case 9:case 11:p=(p=v.documentElement)&&(p=p.namespaceURI)?gO(p):0;break;default:if(p=v.tagName,v=v.namespaceURI)v=gO(v),p=_O(v,p);else switch(p){case"svg":p=1;break;case"math":p=2;break;default:p=0}}yt(Pt),Lt(Pt,p)}function ir(){yt(Pt),yt(_n),yt(Gt)}function kt(p){p.memoizedState!==null&&Lt(zt,p);var v=Pt.current,w=_O(v,p.type);v!==w&&(Lt(_n,p),Lt(Pt,w))}function Ht(p){_n.current===p&&(yt(Pt),yt(_n)),zt.current===p&&(yt(zt),u_._currentValue=lt)}var Jt=Object.prototype.hasOwnProperty,tn=o.unstable_scheduleCallback,Yn=o.unstable_cancelCallback,oi=o.unstable_shouldYield,Ri=o.unstable_requestPaint,jr=o.unstable_now,dr=o.unstable_getCurrentPriorityLevel,Ii=o.unstable_ImmediatePriority,sa=o.unstable_UserBlockingPriority,ar=o.unstable_NormalPriority,Sn=o.unstable_LowPriority,vc=o.unstable_IdlePriority,Zi=o.log,bm=o.unstable_setDisableYieldValue,jl=null,Tr=null;function ss(p){if(typeof Zi=="function"&&bm(p),Tr&&typeof Tr.setStrictMode=="function")try{Tr.setStrictMode(jl,p)}catch{}}var Za=Math.clz32?Math.clz32:Cf,Vh=Math.log,ec=Math.LN2;function Cf(p){return p>>>=0,p===0?32:31-(Vh(p)/ec|0)|0}var Sc=256,Fa=4194304;function ko(p){var v=p&42;if(v!==0)return v;switch(p&-p){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return p&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return p&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return p}}function wf(p,v,w){var L=p.pendingLanes;if(L===0)return 0;var U=0,H=p.suspendedLanes,pe=p.pingedLanes;p=p.warmLanes;var Ce=L&134217727;return Ce!==0?(L=Ce&~H,L!==0?U=ko(L):(pe&=Ce,pe!==0?U=ko(pe):w||(w=Ce&~p,w!==0&&(U=ko(w))))):(Ce=L&~H,Ce!==0?U=ko(Ce):pe!==0?U=ko(pe):w||(w=L&~p,w!==0&&(U=ko(w)))),U===0?0:v!==0&&v!==U&&(v&H)===0&&(H=U&-U,w=v&-v,H>=w||H===32&&(w&4194048)!==0)?v:U}function Cm(p,v){return(p.pendingLanes&~(p.suspendedLanes&~p.pingedLanes)&v)===0}function Td(p,v){switch(p){case 1:case 2:case 4:case 8:case 64:return v+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return v+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Su(){var p=Sc;return Sc<<=1,(Sc&4194048)===0&&(Sc=256),p}function wE(){var p=Fa;return Fa<<=1,(Fa&62914560)===0&&(Fa=4194304),p}function RE(p){for(var v=[],w=0;31>w;w++)v.push(p);return v}function wm(p,v){p.pendingLanes|=v,v!==268435456&&(p.suspendedLanes=0,p.pingedLanes=0,p.warmLanes=0)}function uC(p,v,w,L,U,H){var pe=p.pendingLanes;p.pendingLanes=w,p.suspendedLanes=0,p.pingedLanes=0,p.warmLanes=0,p.expiredLanes&=w,p.entangledLanes&=w,p.errorRecoveryDisabledLanes&=w,p.shellSuspendCounter=0;var Ce=p.entanglements,Fe=p.expirationTimes,it=p.hiddenUpdates;for(w=pe&~w;0<w;){var pt=31-Za(w),xt=1<<pt;Ce[pt]=0,Fe[pt]=-1;var ct=it[pt];if(ct!==null)for(it[pt]=null,pt=0;pt<ct.length;pt++){var dt=ct[pt];dt!==null&&(dt.lane&=-536870913)}w&=~xt}L!==0&&Bh(p,L,0),H!==0&&U===0&&p.tag!==0&&(p.suspendedLanes|=H&~(pe&~v))}function Bh(p,v,w){p.pendingLanes|=v,p.suspendedLanes&=~v;var L=31-Za(v);p.entangledLanes|=v,p.entanglements[L]=p.entanglements[L]|1073741824|w&4194090}function Fh(p,v){var w=p.entangledLanes|=v;for(p=p.entanglements;w;){var L=31-Za(w),U=1<<L;U&v|p[L]&v&&(p[L]|=v),w&=~U}}function yu(p){switch(p){case 2:p=1;break;case 8:p=4;break;case 32:p=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:p=128;break;case 268435456:p=134217728;break;default:p=0}return p}function er(p){return p&=-p,2<p?8<p?(p&134217727)!==0?32:268435456:8:2}function yc(){var p=qe.p;return p!==0?p:(p=window.event,p===void 0?32:LO(p.type))}function Ty(p,v){var w=qe.p;try{return qe.p=p,v()}finally{qe.p=w}}var os=Math.random().toString(36).slice(2),$i="__reactFiber$"+os,Tc="__reactProps$"+os,Rf="__reactContainer$"+os,Rm="__reactEvents$"+os,fC="__reactListeners$"+os,hC="__reactHandles$"+os,pC="__reactResources$"+os,E0="__reactMarker$"+os;function IE(p){delete p[$i],delete p[Tc],delete p[Rm],delete p[fC],delete p[hC]}function Im(p){var v=p[$i];if(v)return v;for(var w=p.parentNode;w;){if(v=w[Rf]||w[$i]){if(w=v.alternate,v.child!==null||w!==null&&w.child!==null)for(p=SO(p);p!==null;){if(w=p[$i])return w;p=SO(p)}return v}p=w,w=p.parentNode}return null}function v0(p){if(p=p[$i]||p[Rf]){var v=p.tag;if(v===5||v===6||v===13||v===26||v===27||v===3)return p}return null}function AE(p){var v=p.tag;if(v===5||v===26||v===27||v===6)return p.stateNode;throw Error(g(33))}function Gh(p){var v=p[pC];return v||(v=p[pC]={hoistableStyles:new Map,hoistableScripts:new Map}),v}function cs(p){p[E0]=!0}var OE=new Set,zh={};function Vl(p,v){S0(p,v),S0(p+"Capture",v)}function S0(p,v){for(zh[p]=v,p=0;p<v.length;p++)OE.add(v[p])}var Tu=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),bd={},i2={};function ls(p){return Jt.call(i2,p)?!0:Jt.call(bd,p)?!1:Tu.test(p)?i2[p]=!0:(bd[p]=!0,!1)}function Ga(p,v,w){if(ls(v))if(w===null)p.removeAttribute(v);else{switch(typeof w){case"undefined":case"function":case"symbol":p.removeAttribute(v);return;case"boolean":var L=v.toLowerCase().slice(0,5);if(L!=="data-"&&L!=="aria-"){p.removeAttribute(v);return}}p.setAttribute(v,""+w)}}function by(p,v,w){if(w===null)p.removeAttribute(v);else{switch(typeof w){case"undefined":case"function":case"symbol":case"boolean":p.removeAttribute(v);return}p.setAttribute(v,""+w)}}function If(p,v,w,L){if(L===null)p.removeAttribute(w);else{switch(typeof L){case"undefined":case"function":case"symbol":case"boolean":p.removeAttribute(w);return}p.setAttributeNS(v,w,""+L)}}var mC,Cy;function Hh(p){if(mC===void 0)try{throw Error()}catch(w){var v=w.stack.trim().match(/\n( *(at )?)/);mC=v&&v[1]||"",Cy=-1<w.stack.indexOf(`
    at`)?" (<anonymous>)":-1<w.stack.indexOf("@")?"@unknown:0:0":""}return`
`+mC+p+Cy}var wy=!1;function Ry(p,v){if(!p||wy)return"";wy=!0;var w=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var L={DetermineComponentFrameRoot:function(){try{if(v){var xt=function(){throw Error()};if(Object.defineProperty(xt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(xt,[])}catch(dt){var ct=dt}Reflect.construct(p,[],xt)}else{try{xt.call()}catch(dt){ct=dt}p.call(xt.prototype)}}else{try{throw Error()}catch(dt){ct=dt}(xt=p())&&typeof xt.catch=="function"&&xt.catch(function(){})}}catch(dt){if(dt&&ct&&typeof dt.stack=="string")return[dt.stack,ct.stack]}return[null,null]}};L.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var U=Object.getOwnPropertyDescriptor(L.DetermineComponentFrameRoot,"name");U&&U.configurable&&Object.defineProperty(L.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var H=L.DetermineComponentFrameRoot(),pe=H[0],Ce=H[1];if(pe&&Ce){var Fe=pe.split(`
`),it=Ce.split(`
`);for(U=L=0;L<Fe.length&&!Fe[L].includes("DetermineComponentFrameRoot");)L++;for(;U<it.length&&!it[U].includes("DetermineComponentFrameRoot");)U++;if(L===Fe.length||U===it.length)for(L=Fe.length-1,U=it.length-1;1<=L&&0<=U&&Fe[L]!==it[U];)U--;for(;1<=L&&0<=U;L--,U--)if(Fe[L]!==it[U]){if(L!==1||U!==1)do if(L--,U--,0>U||Fe[L]!==it[U]){var pt=`
`+Fe[L].replace(" at new "," at ");return p.displayName&&pt.includes("<anonymous>")&&(pt=pt.replace("<anonymous>",p.displayName)),pt}while(1<=L&&0<=U);break}}}finally{wy=!1,Error.prepareStackTrace=w}return(w=p?p.displayName||p.name:"")?Hh(w):""}function YP(p){switch(p.tag){case 26:case 27:case 5:return Hh(p.type);case 16:return Hh("Lazy");case 13:return Hh("Suspense");case 19:return Hh("SuspenseList");case 0:case 15:return Ry(p.type,!1);case 11:return Ry(p.type.render,!1);case 1:return Ry(p.type,!0);case 31:return Hh("Activity");default:return""}}function a2(p){try{var v="";do v+=YP(p),p=p.return;while(p);return v}catch(w){return`
Error generating stack: `+w.message+`
`+w.stack}}function po(p){switch(typeof p){case"bigint":case"boolean":case"number":case"string":case"undefined":return p;case"object":return p;default:return""}}function Af(p){var v=p.type;return(p=p.nodeName)&&p.toLowerCase()==="input"&&(v==="checkbox"||v==="radio")}function gC(p){var v=Af(p)?"checked":"value",w=Object.getOwnPropertyDescriptor(p.constructor.prototype,v),L=""+p[v];if(!p.hasOwnProperty(v)&&typeof w<"u"&&typeof w.get=="function"&&typeof w.set=="function"){var U=w.get,H=w.set;return Object.defineProperty(p,v,{configurable:!0,get:function(){return U.call(this)},set:function(pe){L=""+pe,H.call(this,pe)}}),Object.defineProperty(p,v,{enumerable:w.enumerable}),{getValue:function(){return L},setValue:function(pe){L=""+pe},stopTracking:function(){p._valueTracker=null,delete p[v]}}}}function Ai(p){p._valueTracker||(p._valueTracker=gC(p))}function ea(p){if(!p)return!1;var v=p._valueTracker;if(!v)return!0;var w=v.getValue(),L="";return p&&(L=Af(p)?p.checked?"true":"false":p.value),p=L,p!==w?(v.setValue(p),!0):!1}function NE(p){if(p=p||(typeof document<"u"?document:void 0),typeof p>"u")return null;try{return p.activeElement||p.body}catch{return p.body}}var _C=/[\n"\\]/g;function rl(p){return p.replace(_C,function(v){return"\\"+v.charCodeAt(0).toString(16)+" "})}function EC(p,v,w,L,U,H,pe,Ce){p.name="",pe!=null&&typeof pe!="function"&&typeof pe!="symbol"&&typeof pe!="boolean"?p.type=pe:p.removeAttribute("type"),v!=null?pe==="number"?(v===0&&p.value===""||p.value!=v)&&(p.value=""+po(v)):p.value!==""+po(v)&&(p.value=""+po(v)):pe!=="submit"&&pe!=="reset"||p.removeAttribute("value"),v!=null?vC(p,pe,po(v)):w!=null?vC(p,pe,po(w)):L!=null&&p.removeAttribute("value"),U==null&&H!=null&&(p.defaultChecked=!!H),U!=null&&(p.checked=U&&typeof U!="function"&&typeof U!="symbol"),Ce!=null&&typeof Ce!="function"&&typeof Ce!="symbol"&&typeof Ce!="boolean"?p.name=""+po(Ce):p.removeAttribute("name")}function s2(p,v,w,L,U,H,pe,Ce){if(H!=null&&typeof H!="function"&&typeof H!="symbol"&&typeof H!="boolean"&&(p.type=H),v!=null||w!=null){if(!(H!=="submit"&&H!=="reset"||v!=null))return;w=w!=null?""+po(w):"",v=v!=null?""+po(v):w,Ce||v===p.value||(p.value=v),p.defaultValue=v}L=L??U,L=typeof L!="function"&&typeof L!="symbol"&&!!L,p.checked=Ce?p.checked:!!L,p.defaultChecked=!!L,pe!=null&&typeof pe!="function"&&typeof pe!="symbol"&&typeof pe!="boolean"&&(p.name=pe)}function vC(p,v,w){v==="number"&&NE(p.ownerDocument)===p||p.defaultValue===""+w||(p.defaultValue=""+w)}function y0(p,v,w,L){if(p=p.options,v){v={};for(var U=0;U<w.length;U++)v["$"+w[U]]=!0;for(w=0;w<p.length;w++)U=v.hasOwnProperty("$"+p[w].value),p[w].selected!==U&&(p[w].selected=U),U&&L&&(p[w].defaultSelected=!0)}else{for(w=""+po(w),v=null,U=0;U<p.length;U++){if(p[U].value===w){p[U].selected=!0,L&&(p[U].defaultSelected=!0);return}v!==null||p[U].disabled||(v=p[U])}v!==null&&(v.selected=!0)}}function o2(p,v,w){if(v!=null&&(v=""+po(v),v!==p.value&&(p.value=v),w==null)){p.defaultValue!==v&&(p.defaultValue=v);return}p.defaultValue=w!=null?""+po(w):""}function LE(p,v,w,L){if(v==null){if(L!=null){if(w!=null)throw Error(g(92));if(et(L)){if(1<L.length)throw Error(g(93));L=L[0]}w=L}w==null&&(w=""),v=w}w=po(v),p.defaultValue=w,L=p.textContent,L===w&&L!==""&&L!==null&&(p.value=L)}function Of(p,v){if(v){var w=p.firstChild;if(w&&w===p.lastChild&&w.nodeType===3){w.nodeValue=v;return}}p.textContent=v}var Iy=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Ay(p,v,w){var L=v.indexOf("--")===0;w==null||typeof w=="boolean"||w===""?L?p.setProperty(v,""):v==="float"?p.cssFloat="":p[v]="":L?p.setProperty(v,w):typeof w!="number"||w===0||Iy.has(v)?v==="float"?p.cssFloat=w:p[v]=(""+w).trim():p[v]=w+"px"}function Oy(p,v,w){if(v!=null&&typeof v!="object")throw Error(g(62));if(p=p.style,w!=null){for(var L in w)!w.hasOwnProperty(L)||v!=null&&v.hasOwnProperty(L)||(L.indexOf("--")===0?p.setProperty(L,""):L==="float"?p.cssFloat="":p[L]="");for(var U in v)L=v[U],v.hasOwnProperty(U)&&w[U]!==L&&Ay(p,U,L)}else for(var H in v)v.hasOwnProperty(H)&&Ay(p,H,v[H])}function DE(p){if(p.indexOf("-")===-1)return!1;switch(p){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var c2=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),l2=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Ny(p){return l2.test(""+p)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":p}var SC=null;function yC(p){return p=p.target||p.srcElement||window,p.correspondingUseElement&&(p=p.correspondingUseElement),p.nodeType===3?p.parentNode:p}var T0=null,b0=null;function d2(p){var v=v0(p);if(v&&(p=v.stateNode)){var w=p[Tc]||null;e:switch(p=v.stateNode,v.type){case"input":if(EC(p,w.value,w.defaultValue,w.defaultValue,w.checked,w.defaultChecked,w.type,w.name),v=w.name,w.type==="radio"&&v!=null){for(w=p;w.parentNode;)w=w.parentNode;for(w=w.querySelectorAll('input[name="'+rl(""+v)+'"][type="radio"]'),v=0;v<w.length;v++){var L=w[v];if(L!==p&&L.form===p.form){var U=L[Tc]||null;if(!U)throw Error(g(90));EC(L,U.value,U.defaultValue,U.defaultValue,U.checked,U.defaultChecked,U.type,U.name)}}for(v=0;v<w.length;v++)L=w[v],L.form===p.form&&ea(L)}break e;case"textarea":o2(p,w.value,w.defaultValue);break e;case"select":v=w.value,v!=null&&y0(p,!!w.multiple,v,!1)}}}var TC=!1;function bC(p,v,w){if(TC)return p(v,w);TC=!0;try{var L=p(v);return L}finally{if(TC=!1,(T0!==null||b0!==null)&&(sg(),T0&&(v=T0,p=b0,b0=T0=null,d2(v),p)))for(v=0;v<p.length;v++)d2(p[v])}}function C0(p,v){var w=p.stateNode;if(w===null)return null;var L=w[Tc]||null;if(L===null)return null;w=L[v];e:switch(v){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(L=!L.disabled)||(p=p.type,L=!(p==="button"||p==="input"||p==="select"||p==="textarea")),p=!L;break e;default:p=!1}if(p)return null;if(w&&typeof w!="function")throw Error(g(231,v,typeof w));return w}var Nf=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),CC=!1;if(Nf)try{var Lf={};Object.defineProperty(Lf,"passive",{get:function(){CC=!0}}),window.addEventListener("test",Lf,Lf),window.removeEventListener("test",Lf,Lf)}catch{CC=!1}var Bl=null,wC=null,Ly=null;function u2(){if(Ly)return Ly;var p,v=wC,w=v.length,L,U="value"in Bl?Bl.value:Bl.textContent,H=U.length;for(p=0;p<w&&v[p]===U[p];p++);var pe=w-p;for(L=1;L<=pe&&v[w-L]===U[H-L];L++);return Ly=U.slice(p,1<L?1-L:void 0)}function PE(p){var v=p.keyCode;return"charCode"in p?(p=p.charCode,p===0&&v===13&&(p=13)):p=v,p===10&&(p=13),32<=p||p===13?p:0}function ME(){return!0}function f2(){return!1}function bc(p){function v(w,L,U,H,pe){this._reactName=w,this._targetInst=U,this.type=L,this.nativeEvent=H,this.target=pe,this.currentTarget=null;for(var Ce in p)p.hasOwnProperty(Ce)&&(w=p[Ce],this[Ce]=w?w(H):H[Ce]);return this.isDefaultPrevented=(H.defaultPrevented!=null?H.defaultPrevented:H.returnValue===!1)?ME:f2,this.isPropagationStopped=f2,this}return V(v.prototype,{preventDefault:function(){this.defaultPrevented=!0;var w=this.nativeEvent;w&&(w.preventDefault?w.preventDefault():typeof w.returnValue!="unknown"&&(w.returnValue=!1),this.isDefaultPrevented=ME)},stopPropagation:function(){var w=this.nativeEvent;w&&(w.stopPropagation?w.stopPropagation():typeof w.cancelBubble!="unknown"&&(w.cancelBubble=!0),this.isPropagationStopped=ME)},persist:function(){},isPersistent:ME}),v}var Cc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(p){return p.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},$a=bc(Cc),mo=V({},Cc,{view:0,detail:0}),h2=bc(mo),RC,IC,Es,Ks=V({},mo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:LC,button:0,buttons:0,relatedTarget:function(p){return p.relatedTarget===void 0?p.fromElement===p.srcElement?p.toElement:p.fromElement:p.relatedTarget},movementX:function(p){return"movementX"in p?p.movementX:(p!==Es&&(Es&&p.type==="mousemove"?(RC=p.screenX-Es.screenX,IC=p.screenY-Es.screenY):IC=RC=0,Es=p),RC)},movementY:function(p){return"movementY"in p?p.movementY:IC}}),p2=bc(Ks),KP=V({},Ks,{dataTransfer:0}),Dy=bc(KP),kE=V({},mo,{relatedTarget:0}),Py=bc(kE),AC=V({},Cc,{animationName:0,elapsedTime:0,pseudoElement:0}),OC=bc(AC),NC=V({},Cc,{clipboardData:function(p){return"clipboardData"in p?p.clipboardData:window.clipboardData}}),xE=bc(NC),UE=V({},Cc,{data:0}),My=bc(UE),qP={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Wh={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},bu={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function jE(p){var v=this.nativeEvent;return v.getModifierState?v.getModifierState(p):(p=bu[p])?!!v[p]:!1}function LC(){return jE}var JP=V({},mo,{key:function(p){if(p.key){var v=qP[p.key]||p.key;if(v!=="Unidentified")return v}return p.type==="keypress"?(p=PE(p),p===13?"Enter":String.fromCharCode(p)):p.type==="keydown"||p.type==="keyup"?Wh[p.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:LC,charCode:function(p){return p.type==="keypress"?PE(p):0},keyCode:function(p){return p.type==="keydown"||p.type==="keyup"?p.keyCode:0},which:function(p){return p.type==="keypress"?PE(p):p.type==="keydown"||p.type==="keyup"?p.keyCode:0}}),XP=bc(JP),QP=V({},Ks,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Am=bc(QP),w0=V({},mo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:LC}),R0=bc(w0),Om=V({},Cc,{propertyName:0,elapsedTime:0,pseudoElement:0}),m2=bc(Om),br=V({},Ks,{deltaX:function(p){return"deltaX"in p?p.deltaX:"wheelDeltaX"in p?-p.wheelDeltaX:0},deltaY:function(p){return"deltaY"in p?p.deltaY:"wheelDeltaY"in p?-p.wheelDeltaY:"wheelDelta"in p?-p.wheelDelta:0},deltaZ:0,deltaMode:0}),pr=bc(br),ZP=V({},Cc,{newState:0,oldState:0}),$P=bc(ZP),eM=[9,13,27,32],VE=Nf&&"CompositionEvent"in window,Nm=null;Nf&&"documentMode"in document&&(Nm=document.documentMode);var tM=Nf&&"TextEvent"in window&&!Nm,g2=Nf&&(!VE||Nm&&8<Nm&&11>=Nm),ky=" ",xy=!1;function _2(p,v){switch(p){case"keyup":return eM.indexOf(v.keyCode)!==-1;case"keydown":return v.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function DC(p){return p=p.detail,typeof p=="object"&&"data"in p?p.data:null}var Lm=!1;function Df(p,v){switch(p){case"compositionend":return DC(v);case"keypress":return v.which!==32?null:(xy=!0,ky);case"textInput":return p=v.data,p===ky&&xy?null:p;default:return null}}function Yh(p,v){if(Lm)return p==="compositionend"||!VE&&_2(p,v)?(p=u2(),Ly=wC=Bl=null,Lm=!1,p):null;switch(p){case"paste":return null;case"keypress":if(!(v.ctrlKey||v.altKey||v.metaKey)||v.ctrlKey&&v.altKey){if(v.char&&1<v.char.length)return v.char;if(v.which)return String.fromCharCode(v.which)}return null;case"compositionend":return g2&&v.locale!=="ko"?null:v.data;default:return null}}var nM={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function E2(p){var v=p&&p.nodeName&&p.nodeName.toLowerCase();return v==="input"?!!nM[p.type]:v==="textarea"}function PC(p,v,w,L){T0?b0?b0.push(L):b0=[L]:T0=L,v=Gv(v,"onChange"),0<v.length&&(w=new $a("onChange","change",null,w,L),p.push({event:w,listeners:v}))}var Kh=null,Dm=null;function rM(p){FT(p,0)}function tc(p){var v=AE(p);if(ea(v))return p}function v2(p,v){if(p==="change")return v}var il=!1;if(Nf){var MC;if(Nf){var kC="oninput"in document;if(!kC){var xC=document.createElement("div");xC.setAttribute("oninput","return;"),kC=typeof xC.oninput=="function"}MC=kC}else MC=!1;il=MC&&(!document.documentMode||9<document.documentMode)}function S2(){Kh&&(Kh.detachEvent("onpropertychange",UC),Dm=Kh=null)}function UC(p){if(p.propertyName==="value"&&tc(Dm)){var v=[];PC(v,Dm,p,yC(p)),bC(rM,v)}}function y2(p,v,w){p==="focusin"?(S2(),Kh=v,Dm=w,Kh.attachEvent("onpropertychange",UC)):p==="focusout"&&S2()}function jC(p){if(p==="selectionchange"||p==="keyup"||p==="keydown")return tc(Dm)}function T2(p,v){if(p==="click")return tc(v)}function VC(p,v){if(p==="input"||p==="change")return tc(v)}function Uy(p,v){return p===v&&(p!==0||1/p===1/v)||p!==p&&v!==v}var al=typeof Object.is=="function"?Object.is:Uy;function qh(p,v){if(al(p,v))return!0;if(typeof p!="object"||p===null||typeof v!="object"||v===null)return!1;var w=Object.keys(p),L=Object.keys(v);if(w.length!==L.length)return!1;for(L=0;L<w.length;L++){var U=w[L];if(!Jt.call(v,U)||!al(p[U],v[U]))return!1}return!0}function b2(p){for(;p&&p.firstChild;)p=p.firstChild;return p}function Cd(p,v){var w=b2(p);p=0;for(var L;w;){if(w.nodeType===3){if(L=p+w.textContent.length,p<=v&&L>=v)return{node:w,offset:v-p};p=L}e:{for(;w;){if(w.nextSibling){w=w.nextSibling;break e}w=w.parentNode}w=void 0}w=b2(w)}}function C2(p,v){return p&&v?p===v?!0:p&&p.nodeType===3?!1:v&&v.nodeType===3?C2(p,v.parentNode):"contains"in p?p.contains(v):p.compareDocumentPosition?!!(p.compareDocumentPosition(v)&16):!1:!1}function Pf(p){p=p!=null&&p.ownerDocument!=null&&p.ownerDocument.defaultView!=null?p.ownerDocument.defaultView:window;for(var v=NE(p.document);v instanceof p.HTMLIFrameElement;){try{var w=typeof v.contentWindow.location.href=="string"}catch{w=!1}if(w)p=v.contentWindow;else break;v=NE(p.document)}return v}function nc(p){var v=p&&p.nodeName&&p.nodeName.toLowerCase();return v&&(v==="input"&&(p.type==="text"||p.type==="search"||p.type==="tel"||p.type==="url"||p.type==="password")||v==="textarea"||p.contentEditable==="true")}var iM=Nf&&"documentMode"in document&&11>=document.documentMode,Ls=null,BC=null,BE=null,jy=!1;function w2(p,v,w){var L=w.window===w?w.document:w.nodeType===9?w:w.ownerDocument;jy||Ls==null||Ls!==NE(L)||(L=Ls,"selectionStart"in L&&nc(L)?L={start:L.selectionStart,end:L.selectionEnd}:(L=(L.ownerDocument&&L.ownerDocument.defaultView||window).getSelection(),L={anchorNode:L.anchorNode,anchorOffset:L.anchorOffset,focusNode:L.focusNode,focusOffset:L.focusOffset}),BE&&qh(BE,L)||(BE=L,L=Gv(BC,"onSelect"),0<L.length&&(v=new $a("onSelect","select",null,v,w),p.push({event:v,listeners:L}),v.target=Ls)))}function Jh(p,v){var w={};return w[p.toLowerCase()]=v.toLowerCase(),w["Webkit"+p]="webkit"+v,w["Moz"+p]="moz"+v,w}var I0={animationend:Jh("Animation","AnimationEnd"),animationiteration:Jh("Animation","AnimationIteration"),animationstart:Jh("Animation","AnimationStart"),transitionrun:Jh("Transition","TransitionRun"),transitionstart:Jh("Transition","TransitionStart"),transitioncancel:Jh("Transition","TransitionCancel"),transitionend:Jh("Transition","TransitionEnd")},Vy={},R2={};Nf&&(R2=document.createElement("div").style,"AnimationEvent"in window||(delete I0.animationend.animation,delete I0.animationiteration.animation,delete I0.animationstart.animation),"TransitionEvent"in window||delete I0.transitionend.transition);function Xh(p){if(Vy[p])return Vy[p];if(!I0[p])return p;var v=I0[p],w;for(w in v)if(v.hasOwnProperty(w)&&w in R2)return Vy[p]=v[w];return p}var By=Xh("animationend"),Fy=Xh("animationiteration"),Gy=Xh("animationstart"),ft=Xh("transitionrun"),aM=Xh("transitionstart"),ht=Xh("transitioncancel"),I2=Xh("transitionend"),A2=new Map,FC="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");FC.push("scrollEnd");function wd(p,v){A2.set(p,v),Vl(v,[p])}var GC=new WeakMap;function sl(p,v){if(typeof p=="object"&&p!==null){var w=GC.get(p);return w!==void 0?w:(v={value:p,source:v,stack:a2(v)},GC.set(p,v),v)}return{value:p,source:v,stack:a2(v)}}var rc=[],Rd=0,zC=0;function Pm(){for(var p=Rd,v=zC=Rd=0;v<p;){var w=rc[v];rc[v++]=null;var L=rc[v];rc[v++]=null;var U=rc[v];rc[v++]=null;var H=rc[v];if(rc[v++]=null,L!==null&&U!==null){var pe=L.pending;pe===null?U.next=U:(U.next=pe.next,pe.next=U),L.pending=U}H!==0&&FE(w,U,H)}}function Qh(p,v,w,L){rc[Rd++]=p,rc[Rd++]=v,rc[Rd++]=w,rc[Rd++]=L,zC|=L,p.lanes|=L,p=p.alternate,p!==null&&(p.lanes|=L)}function HC(p,v,w,L){return Qh(p,v,w,L),Mm(p)}function Zh(p,v){return Qh(p,null,null,v),Mm(p)}function FE(p,v,w){p.lanes|=w;var L=p.alternate;L!==null&&(L.lanes|=w);for(var U=!1,H=p.return;H!==null;)H.childLanes|=w,L=H.alternate,L!==null&&(L.childLanes|=w),H.tag===22&&(p=H.stateNode,p===null||p._visibility&1||(U=!0)),p=H,H=H.return;return p.tag===3?(H=p.stateNode,U&&v!==null&&(U=31-Za(w),p=H.hiddenUpdates,L=p[U],L===null?p[U]=[v]:L.push(v),v.lane=w|536870912),H):null}function Mm(p){if(50<xu)throw xu=0,Kf=null,Error(g(185));for(var v=p.return;v!==null;)p=v,v=p.return;return p.tag===3?p.stateNode:null}var Ds={};function sM(p,v,w,L){this.tag=p,this.key=w,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=v,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=L,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function go(p,v,w,L){return new sM(p,v,w,L)}function WC(p){return p=p.prototype,!(!p||!p.isReactComponent)}function Mf(p,v){var w=p.alternate;return w===null?(w=go(p.tag,v,p.key,p.mode),w.elementType=p.elementType,w.type=p.type,w.stateNode=p.stateNode,w.alternate=p,p.alternate=w):(w.pendingProps=v,w.type=p.type,w.flags=0,w.subtreeFlags=0,w.deletions=null),w.flags=p.flags&65011712,w.childLanes=p.childLanes,w.lanes=p.lanes,w.child=p.child,w.memoizedProps=p.memoizedProps,w.memoizedState=p.memoizedState,w.updateQueue=p.updateQueue,v=p.dependencies,w.dependencies=v===null?null:{lanes:v.lanes,firstContext:v.firstContext},w.sibling=p.sibling,w.index=p.index,w.ref=p.ref,w.refCleanup=p.refCleanup,w}function zy(p,v){p.flags&=65011714;var w=p.alternate;return w===null?(p.childLanes=0,p.lanes=v,p.child=null,p.subtreeFlags=0,p.memoizedProps=null,p.memoizedState=null,p.updateQueue=null,p.dependencies=null,p.stateNode=null):(p.childLanes=w.childLanes,p.lanes=w.lanes,p.child=w.child,p.subtreeFlags=0,p.deletions=null,p.memoizedProps=w.memoizedProps,p.memoizedState=w.memoizedState,p.updateQueue=w.updateQueue,p.type=w.type,v=w.dependencies,p.dependencies=v===null?null:{lanes:v.lanes,firstContext:v.firstContext}),p}function GE(p,v,w,L,U,H){var pe=0;if(L=p,typeof p=="function")WC(p)&&(pe=1);else if(typeof p=="string")pe=Xw(p,w,Pt.current)?26:p==="html"||p==="head"||p==="body"?27:5;else e:switch(p){case je:return p=go(31,w,v,U),p.elementType=je,p.lanes=H,p;case X:return $h(w.children,U,H,v);case Z:pe=8,U|=24;break;case ae:return p=go(12,w,v,U|2),p.elementType=ae,p.lanes=H,p;case te:return p=go(13,w,v,U),p.elementType=te,p.lanes=H,p;case ye:return p=go(19,w,v,U),p.elementType=ye,p.lanes=H,p;default:if(typeof p=="object"&&p!==null)switch(p.$$typeof){case le:case ue:pe=10;break e;case fe:pe=9;break e;case de:pe=11;break e;case Te:pe=14;break e;case Le:pe=16,L=null;break e}pe=29,w=Error(g(130,p===null?"null":typeof p,"")),L=null}return v=go(pe,w,v,U),v.elementType=p,v.type=L,v.lanes=H,v}function $h(p,v,w,L){return p=go(7,p,L,v),p.lanes=w,p}function wc(p,v,w){return p=go(6,p,null,v),p.lanes=w,p}function YC(p,v,w){return v=go(4,p.children!==null?p.children:[],p.key,v),v.lanes=w,v.stateNode={containerInfo:p.containerInfo,pendingChildren:null,implementation:p.implementation},v}var Fl=[],A0=0,zE=null,HE=0,ol=[],cl=0,Cu=null,kf=1,Id="";function km(p,v){Fl[A0++]=HE,Fl[A0++]=zE,zE=p,HE=v}function KC(p,v,w){ol[cl++]=kf,ol[cl++]=Id,ol[cl++]=Cu,Cu=p;var L=kf;p=Id;var U=32-Za(L)-1;L&=~(1<<U),w+=1;var H=32-Za(v)+U;if(30<H){var pe=U-U%5;H=(L&(1<<pe)-1).toString(32),L>>=pe,U-=pe,kf=1<<32-Za(v)+U|w<<U|L,Id=H+p}else kf=1<<H|w<<U|L,Id=p}function Hy(p){p.return!==null&&(km(p,1),KC(p,1,0))}function Wy(p){for(;p===zE;)zE=Fl[--A0],Fl[A0]=null,HE=Fl[--A0],Fl[A0]=null;for(;p===Cu;)Cu=ol[--cl],ol[cl]=null,Id=ol[--cl],ol[cl]=null,kf=ol[--cl],ol[cl]=null}var qs=null,wa=null,Si=!1,xm=null,wu=!1,qC=Error(g(519));function Um(p){var v=Error(g(418,""));throw ep(sl(v,p)),qC}function JC(p){var v=p.stateNode,w=p.type,L=p.memoizedProps;switch(v[$i]=p,v[Tc]=L,w){case"dialog":Pr("cancel",v),Pr("close",v);break;case"iframe":case"object":case"embed":Pr("load",v);break;case"video":case"audio":for(w=0;w<lg.length;w++)Pr(lg[w],v);break;case"source":Pr("error",v);break;case"img":case"image":case"link":Pr("error",v),Pr("load",v);break;case"details":Pr("toggle",v);break;case"input":Pr("invalid",v),s2(v,L.value,L.defaultValue,L.checked,L.defaultChecked,L.type,L.name,!0),Ai(v);break;case"select":Pr("invalid",v);break;case"textarea":Pr("invalid",v),LE(v,L.value,L.defaultValue,L.children),Ai(v)}w=L.children,typeof w!="string"&&typeof w!="number"&&typeof w!="bigint"||v.textContent===""+w||L.suppressHydrationWarning===!0||GT(v.textContent,w)?(L.popover!=null&&(Pr("beforetoggle",v),Pr("toggle",v)),L.onScroll!=null&&Pr("scroll",v),L.onScrollEnd!=null&&Pr("scrollend",v),L.onClick!=null&&(v.onclick=zv),v=!0):v=!1,v||Um(p)}function Yy(p){for(qs=p.return;qs;)switch(qs.tag){case 5:case 13:wu=!1;return;case 27:case 3:wu=!0;return;default:qs=qs.return}}function WE(p){if(p!==qs)return!1;if(!Si)return Yy(p),Si=!0,!1;var v=p.tag,w;if((w=v!==3&&v!==27)&&((w=v===5)&&(w=p.type,w=!(w!=="form"&&w!=="button")||Bw(p.type,p.memoizedProps)),w=!w),w&&wa&&Um(p),Yy(p),v===13){if(p=p.memoizedState,p=p!==null?p.dehydrated:null,!p)throw Error(g(317));e:{for(p=p.nextSibling,v=0;p;){if(p.nodeType===8)if(w=p.data,w==="/$"){if(v===0){wa=Bd(p.nextSibling);break e}v--}else w!=="$"&&w!=="$!"&&w!=="$?"||v++;p=p.nextSibling}wa=null}}else v===27?(v=wa,Ip(p.type)?(p=Hw,Hw=null,wa=p):wa=v):wa=qs?Bd(p.stateNode.nextSibling):null;return!0}function jm(){wa=qs=null,Si=!1}function O2(){var p=xm;return p!==null&&(xs===null?xs=p:xs.push.apply(xs,p),xm=null),p}function ep(p){xm===null?xm=[p]:xm.push(p)}var O0=rt(null),xf=null,Uf=null;function tp(p,v,w){Lt(O0,v._currentValue),v._currentValue=w}function jf(p){p._currentValue=O0.current,yt(O0)}function Ky(p,v,w){for(;p!==null;){var L=p.alternate;if((p.childLanes&v)!==v?(p.childLanes|=v,L!==null&&(L.childLanes|=v)):L!==null&&(L.childLanes&v)!==v&&(L.childLanes|=v),p===w)break;p=p.return}}function qy(p,v,w,L){var U=p.child;for(U!==null&&(U.return=p);U!==null;){var H=U.dependencies;if(H!==null){var pe=U.child;H=H.firstContext;e:for(;H!==null;){var Ce=H;H=U;for(var Fe=0;Fe<v.length;Fe++)if(Ce.context===v[Fe]){H.lanes|=w,Ce=H.alternate,Ce!==null&&(Ce.lanes|=w),Ky(H.return,w,p),L||(pe=null);break e}H=Ce.next}}else if(U.tag===18){if(pe=U.return,pe===null)throw Error(g(341));pe.lanes|=w,H=pe.alternate,H!==null&&(H.lanes|=w),Ky(pe,w,p),pe=null}else pe=U.child;if(pe!==null)pe.return=U;else for(pe=U;pe!==null;){if(pe===p){pe=null;break}if(U=pe.sibling,U!==null){U.return=pe.return,pe=U;break}pe=pe.return}U=pe}}function Vm(p,v,w,L){p=null;for(var U=v,H=!1;U!==null;){if(!H){if((U.flags&524288)!==0)H=!0;else if((U.flags&262144)!==0)break}if(U.tag===10){var pe=U.alternate;if(pe===null)throw Error(g(387));if(pe=pe.memoizedProps,pe!==null){var Ce=U.type;al(U.pendingProps.value,pe.value)||(p!==null?p.push(Ce):p=[Ce])}}else if(U===zt.current){if(pe=U.alternate,pe===null)throw Error(g(387));pe.memoizedState.memoizedState!==U.memoizedState.memoizedState&&(p!==null?p.push(u_):p=[u_])}U=U.return}p!==null&&qy(v,p,w,L),v.flags|=262144}function Jy(p){for(p=p.firstContext;p!==null;){if(!al(p.context._currentValue,p.memoizedValue))return!0;p=p.next}return!1}function Ru(p){xf=p,Uf=null,p=p.dependencies,p!==null&&(p.firstContext=null)}function za(p){return N2(xf,p)}function N0(p,v){return xf===null&&Ru(p),N2(p,v)}function N2(p,v){var w=v._currentValue;if(v={context:v,memoizedValue:w,next:null},Uf===null){if(p===null)throw Error(g(308));Uf=v,p.dependencies={lanes:0,firstContext:v},p.flags|=524288}else Uf=Uf.next=v;return w}var oM=typeof AbortController<"u"?AbortController:function(){var p=[],v=this.signal={aborted:!1,addEventListener:function(w,L){p.push(L)}};this.abort=function(){v.aborted=!0,p.forEach(function(w){return w()})}},cM=o.unstable_scheduleCallback,L2=o.unstable_NormalPriority,vs={$$typeof:ue,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function L0(){return{controller:new oM,data:new Map,refCount:0}}function YE(p){p.refCount--,p.refCount===0&&cM(L2,function(){p.controller.abort()})}var KE=null,Bm=0,np=0,D0=null;function lM(p,v){if(KE===null){var w=KE=[];Bm=0,np=Rp(),D0={status:"pending",value:void 0,then:function(L){w.push(L)}}}return Bm++,v.then(qE,qE),v}function qE(){if(--Bm===0&&KE!==null){D0!==null&&(D0.status="fulfilled");var p=KE;KE=null,np=0,D0=null;for(var v=0;v<p.length;v++)(0,p[v])()}}function dM(p,v){var w=[],L={status:"pending",value:null,reason:null,then:function(U){w.push(U)}};return p.then(function(){L.status="fulfilled",L.value=v;for(var U=0;U<w.length;U++)(0,w[U])(v)},function(U){for(L.status="rejected",L.reason=U,U=0;U<w.length;U++)(0,w[U])(void 0)}),L}var D2=Oe.S;Oe.S=function(p,v){typeof v=="object"&&v!==null&&typeof v.then=="function"&&lM(p,v),D2!==null&&D2(p,v)};var rp=rt(null);function XC(){var p=rp.current;return p!==null?p:oa.pooledCache}function Xy(p,v){v===null?Lt(rp,rp.current):Lt(rp,v.pool)}function P2(){var p=XC();return p===null?null:{parent:vs._currentValue,pool:p}}var Iu=Error(g(460)),QC=Error(g(474)),Qy=Error(g(542)),P0={then:function(){}};function ZC(p){return p=p.status,p==="fulfilled"||p==="rejected"}function Zy(){}function M2(p,v,w){switch(w=p[w],w===void 0?p.push(v):w!==v&&(v.then(Zy,Zy),v=w),v.status){case"fulfilled":return v.value;case"rejected":throw p=v.reason,eT(p),p;default:if(typeof v.status=="string")v.then(Zy,Zy);else{if(p=oa,p!==null&&100<p.shellSuspendCounter)throw Error(g(482));p=v,p.status="pending",p.then(function(L){if(v.status==="pending"){var U=v;U.status="fulfilled",U.value=L}},function(L){if(v.status==="pending"){var U=v;U.status="rejected",U.reason=L}})}switch(v.status){case"fulfilled":return v.value;case"rejected":throw p=v.reason,eT(p),p}throw JE=v,Iu}}var JE=null;function $y(){if(JE===null)throw Error(g(459));var p=JE;return JE=null,p}function eT(p){if(p===Iu||p===Qy)throw Error(g(483))}var Gl=!1;function M0(p){p.updateQueue={baseState:p.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function tT(p,v){p=p.updateQueue,v.updateQueue===p&&(v.updateQueue={baseState:p.baseState,firstBaseUpdate:p.firstBaseUpdate,lastBaseUpdate:p.lastBaseUpdate,shared:p.shared,callbacks:null})}function Vf(p){return{lane:p,tag:0,payload:null,callback:null,next:null}}function zl(p,v,w){var L=p.updateQueue;if(L===null)return null;if(L=L.shared,(Oi&2)!==0){var U=L.pending;return U===null?v.next=v:(v.next=U.next,U.next=v),L.pending=v,v=Mm(p),FE(p,null,w),v}return Qh(p,L,v,w),Mm(p)}function Bf(p,v,w){if(v=v.updateQueue,v!==null&&(v=v.shared,(w&4194048)!==0)){var L=v.lanes;L&=p.pendingLanes,w|=L,v.lanes=w,Fh(p,w)}}function $C(p,v){var w=p.updateQueue,L=p.alternate;if(L!==null&&(L=L.updateQueue,w===L)){var U=null,H=null;if(w=w.firstBaseUpdate,w!==null){do{var pe={lane:w.lane,tag:w.tag,payload:w.payload,callback:null,next:null};H===null?U=H=pe:H=H.next=pe,w=w.next}while(w!==null);H===null?U=H=v:H=H.next=v}else U=H=v;w={baseState:L.baseState,firstBaseUpdate:U,lastBaseUpdate:H,shared:L.shared,callbacks:L.callbacks},p.updateQueue=w;return}p=w.lastBaseUpdate,p===null?w.firstBaseUpdate=v:p.next=v,w.lastBaseUpdate=v}var ew=!1;function ip(){if(ew){var p=D0;if(p!==null)throw p}}function Fm(p,v,w,L){ew=!1;var U=p.updateQueue;Gl=!1;var H=U.firstBaseUpdate,pe=U.lastBaseUpdate,Ce=U.shared.pending;if(Ce!==null){U.shared.pending=null;var Fe=Ce,it=Fe.next;Fe.next=null,pe===null?H=it:pe.next=it,pe=Fe;var pt=p.alternate;pt!==null&&(pt=pt.updateQueue,Ce=pt.lastBaseUpdate,Ce!==pe&&(Ce===null?pt.firstBaseUpdate=it:Ce.next=it,pt.lastBaseUpdate=Fe))}if(H!==null){var xt=U.baseState;pe=0,pt=it=Fe=null,Ce=H;do{var ct=Ce.lane&-536870913,dt=ct!==Ce.lane;if(dt?(ii&ct)===ct:(L&ct)===ct){ct!==0&&ct===np&&(ew=!0),pt!==null&&(pt=pt.next={lane:0,tag:Ce.tag,payload:Ce.payload,callback:null,next:null});e:{var tr=p,wn=Ce;ct=v;var ta=w;switch(wn.tag){case 1:if(tr=wn.payload,typeof tr=="function"){xt=tr.call(ta,xt,ct);break e}xt=tr;break e;case 3:tr.flags=tr.flags&-65537|128;case 0:if(tr=wn.payload,ct=typeof tr=="function"?tr.call(ta,xt,ct):tr,ct==null)break e;xt=V({},xt,ct);break e;case 2:Gl=!0}}ct=Ce.callback,ct!==null&&(p.flags|=64,dt&&(p.flags|=8192),dt=U.callbacks,dt===null?U.callbacks=[ct]:dt.push(ct))}else dt={lane:ct,tag:Ce.tag,payload:Ce.payload,callback:Ce.callback,next:null},pt===null?(it=pt=dt,Fe=xt):pt=pt.next=dt,pe|=ct;if(Ce=Ce.next,Ce===null){if(Ce=U.shared.pending,Ce===null)break;dt=Ce,Ce=dt.next,dt.next=null,U.lastBaseUpdate=dt,U.shared.pending=null}}while(!0);pt===null&&(Fe=xt),U.baseState=Fe,U.firstBaseUpdate=it,U.lastBaseUpdate=pt,H===null&&(U.shared.lanes=0),Ud|=pe,p.lanes=pe,p.memoizedState=xt}}function tw(p,v){if(typeof p!="function")throw Error(g(191,p));p.call(v)}function XE(p,v){var w=p.callbacks;if(w!==null)for(p.callbacks=null,p=0;p<w.length;p++)tw(w[p],v)}var Gm=rt(null),QE=rt(0);function ZE(p,v){p=xd,Lt(QE,p),Lt(Gm,v),xd=p|v.baseLanes}function zm(){Lt(QE,xd),Lt(Gm,Gm.current)}function nw(){xd=QE.current,yt(Gm),yt(QE)}var ap=0,Nr=null,ci=null,Ss=null,$E=!1,k0=!1,sp=!1,nT=0,x0=0,U0=null,uM=0;function es(){throw Error(g(321))}function Ad(p,v){if(v===null)return!1;for(var w=0;w<v.length&&w<p.length;w++)if(!al(p[w],v[w]))return!1;return!0}function rw(p,v,w,L,U,H){return ap=H,Nr=v,v.memoizedState=null,v.updateQueue=null,v.lanes=0,Oe.H=p===null||p.memoizedState===null?lp:dp,sp=!1,H=w(L,U),sp=!1,k0&&(H=x2(v,w,L,U)),k2(p),H}function k2(p){Oe.H=Ic;var v=ci!==null&&ci.next!==null;if(ap=0,Ss=ci=Nr=null,$E=!1,x0=0,U0=null,v)throw Error(g(300));p===null||Ms||(p=p.dependencies,p!==null&&Jy(p)&&(Ms=!0))}function x2(p,v,w,L){Nr=p;var U=0;do{if(k0&&(U0=null),x0=0,k0=!1,25<=U)throw Error(g(301));if(U+=1,Ss=ci=null,p.updateQueue!=null){var H=p.updateQueue;H.lastEffect=null,H.events=null,H.stores=null,H.memoCache!=null&&(H.memoCache.index=0)}Oe.H=Gf,H=v(w,L)}while(k0);return H}function U2(){var p=Oe.H,v=p.useState()[0];return v=typeof v.then=="function"?V0(v):v,p=p.useState()[0],(ci!==null?ci.memoizedState:null)!==p&&(Nr.flags|=1024),v}function iw(){var p=nT!==0;return nT=0,p}function rT(p,v,w){v.updateQueue=p.updateQueue,v.flags&=-2053,p.lanes&=~w}function ev(p){if($E){for(p=p.memoizedState;p!==null;){var v=p.queue;v!==null&&(v.pending=null),p=p.next}$E=!1}ap=0,Ss=ci=Nr=null,k0=!1,x0=nT=0,U0=null}function Rc(){var p={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ss===null?Nr.memoizedState=Ss=p:Ss=Ss.next=p,Ss}function ds(){if(ci===null){var p=Nr.alternate;p=p!==null?p.memoizedState:null}else p=ci.next;var v=Ss===null?Nr.memoizedState:Ss.next;if(v!==null)Ss=v,ci=p;else{if(p===null)throw Nr.alternate===null?Error(g(467)):Error(g(310));ci=p,p={memoizedState:ci.memoizedState,baseState:ci.baseState,baseQueue:ci.baseQueue,queue:ci.queue,next:null},Ss===null?Nr.memoizedState=Ss=p:Ss=Ss.next=p}return Ss}function j0(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function V0(p){var v=x0;return x0+=1,U0===null&&(U0=[]),p=M2(U0,p,v),v=Nr,(Ss===null?v.memoizedState:Ss.next)===null&&(v=v.alternate,Oe.H=v===null||v.memoizedState===null?lp:dp),p}function iT(p){if(p!==null&&typeof p=="object"){if(typeof p.then=="function")return V0(p);if(p.$$typeof===ue)return za(p)}throw Error(g(438,String(p)))}function aw(p){var v=null,w=Nr.updateQueue;if(w!==null&&(v=w.memoCache),v==null){var L=Nr.alternate;L!==null&&(L=L.updateQueue,L!==null&&(L=L.memoCache,L!=null&&(v={data:L.data.map(function(U){return U.slice()}),index:0})))}if(v==null&&(v={data:[],index:0}),w===null&&(w=j0(),Nr.updateQueue=w),w.memoCache=v,w=v.data[v.index],w===void 0)for(w=v.data[v.index]=Array(p),L=0;L<p;L++)w[L]=he;return v.index++,w}function Ff(p,v){return typeof v=="function"?v(p):v}function aT(p){var v=ds();return sw(v,ci,p)}function sw(p,v,w){var L=p.queue;if(L===null)throw Error(g(311));L.lastRenderedReducer=w;var U=p.baseQueue,H=L.pending;if(H!==null){if(U!==null){var pe=U.next;U.next=H.next,H.next=pe}v.baseQueue=U=H,L.pending=null}if(H=p.baseState,U===null)p.memoizedState=H;else{v=U.next;var Ce=pe=null,Fe=null,it=v,pt=!1;do{var xt=it.lane&-536870913;if(xt!==it.lane?(ii&xt)===xt:(ap&xt)===xt){var ct=it.revertLane;if(ct===0)Fe!==null&&(Fe=Fe.next={lane:0,revertLane:0,action:it.action,hasEagerState:it.hasEagerState,eagerState:it.eagerState,next:null}),xt===np&&(pt=!0);else if((ap&ct)===ct){it=it.next,ct===np&&(pt=!0);continue}else xt={lane:0,revertLane:it.revertLane,action:it.action,hasEagerState:it.hasEagerState,eagerState:it.eagerState,next:null},Fe===null?(Ce=Fe=xt,pe=H):Fe=Fe.next=xt,Nr.lanes|=ct,Ud|=ct;xt=it.action,sp&&w(H,xt),H=it.hasEagerState?it.eagerState:w(H,xt)}else ct={lane:xt,revertLane:it.revertLane,action:it.action,hasEagerState:it.hasEagerState,eagerState:it.eagerState,next:null},Fe===null?(Ce=Fe=ct,pe=H):Fe=Fe.next=ct,Nr.lanes|=xt,Ud|=xt;it=it.next}while(it!==null&&it!==v);if(Fe===null?pe=H:Fe.next=Ce,!al(H,p.memoizedState)&&(Ms=!0,pt&&(w=D0,w!==null)))throw w;p.memoizedState=H,p.baseState=pe,p.baseQueue=Fe,L.lastRenderedState=H}return U===null&&(L.lanes=0),[p.memoizedState,L.dispatch]}function tv(p){var v=ds(),w=v.queue;if(w===null)throw Error(g(311));w.lastRenderedReducer=p;var L=w.dispatch,U=w.pending,H=v.memoizedState;if(U!==null){w.pending=null;var pe=U=U.next;do H=p(H,pe.action),pe=pe.next;while(pe!==U);al(H,v.memoizedState)||(Ms=!0),v.memoizedState=H,v.baseQueue===null&&(v.baseState=H),w.lastRenderedState=H}return[H,L]}function ow(p,v,w){var L=Nr,U=ds(),H=Si;if(H){if(w===void 0)throw Error(g(407));w=w()}else w=v();var pe=!al((ci||U).memoizedState,w);pe&&(U.memoizedState=w,Ms=!0),U=U.queue;var Ce=sT.bind(null,L,U,p);if(Od(2048,8,Ce,[p]),U.getSnapshot!==v||pe||Ss!==null&&Ss.memoizedState.tag&1){if(L.flags|=2048,z0(9,cT(),j2.bind(null,L,U,w,v),null),oa===null)throw Error(g(349));H||(ap&124)!==0||cw(L,v,w)}return w}function cw(p,v,w){p.flags|=16384,p={getSnapshot:v,value:w},v=Nr.updateQueue,v===null?(v=j0(),Nr.updateQueue=v,v.stores=[p]):(w=v.stores,w===null?v.stores=[p]:w.push(p))}function j2(p,v,w,L){v.value=w,v.getSnapshot=L,V2(v)&&nv(p)}function sT(p,v,w){return w(function(){V2(v)&&nv(p)})}function V2(p){var v=p.getSnapshot;p=p.value;try{var w=v();return!al(p,w)}catch{return!0}}function nv(p){var v=Zh(p,2);v!==null&&Dc(v,p,2)}function oT(p){var v=Rc();if(typeof p=="function"){var w=p;if(p=w(),sp){ss(!0);try{w()}finally{ss(!1)}}}return v.memoizedState=v.baseState=p,v.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ff,lastRenderedState:p},v}function B0(p,v,w,L){return p.baseState=w,sw(p,ci,typeof L=="function"?L:Ff)}function fM(p,v,w,L,U){if(lv(p))throw Error(g(485));if(p=v.action,p!==null){var H={payload:U,action:p,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(pe){H.listeners.push(pe)}};Oe.T!==null?w(!0):H.isTransition=!1,L(H),w=v.pending,w===null?(H.next=v.pending=H,B2(v,H)):(H.next=w.next,v.pending=w.next=H)}}function B2(p,v){var w=v.action,L=v.payload,U=p.state;if(v.isTransition){var H=Oe.T,pe={};Oe.T=pe;try{var Ce=w(U,L),Fe=Oe.S;Fe!==null&&Fe(pe,Ce),lw(p,v,Ce)}catch(it){F0(p,v,it)}finally{Oe.T=H}}else try{H=w(U,L),lw(p,v,H)}catch(it){F0(p,v,it)}}function lw(p,v,w){w!==null&&typeof w=="object"&&typeof w.then=="function"?w.then(function(L){F2(p,v,L)},function(L){return F0(p,v,L)}):F2(p,v,w)}function F2(p,v,w){v.status="fulfilled",v.value=w,dw(v),p.state=w,v=p.pending,v!==null&&(w=v.next,w===v?p.pending=null:(w=w.next,v.next=w,B2(p,w)))}function F0(p,v,w){var L=p.pending;if(p.pending=null,L!==null){L=L.next;do v.status="rejected",v.reason=w,dw(v),v=v.next;while(v!==L)}p.action=null}function dw(p){p=p.listeners;for(var v=0;v<p.length;v++)(0,p[v])()}function uw(p,v){return v}function Hm(p,v){if(Si){var w=oa.formState;if(w!==null){e:{var L=Nr;if(Si){if(wa){t:{for(var U=wa,H=wu;U.nodeType!==8;){if(!H){U=null;break t}if(U=Bd(U.nextSibling),U===null){U=null;break t}}H=U.data,U=H==="F!"||H==="F"?U:null}if(U){wa=Bd(U.nextSibling),L=U.data==="F!";break e}}Um(L)}L=!1}L&&(v=w[0])}}return w=Rc(),w.memoizedState=w.baseState=v,L={pending:null,lanes:0,dispatch:null,lastRenderedReducer:uw,lastRenderedState:v},w.queue=L,w=ov.bind(null,Nr,L),L.dispatch=w,L=oT(!1),H=cv.bind(null,Nr,!1,L.queue),L=Rc(),U={state:v,dispatch:null,action:p,pending:null},L.queue=U,w=fM.bind(null,Nr,U,H,w),U.dispatch=w,L.memoizedState=p,[v,w,!1]}function rv(p){var v=ds();return G0(v,ci,p)}function G0(p,v,w){if(v=sw(p,v,uw)[0],p=aT(Ff)[0],typeof v=="object"&&v!==null&&typeof v.then=="function")try{var L=V0(v)}catch(pe){throw pe===Iu?Qy:pe}else L=v;v=ds();var U=v.queue,H=U.dispatch;return w!==v.memoizedState&&(Nr.flags|=2048,z0(9,cT(),hM.bind(null,U,w),null)),[L,H,p]}function hM(p,v){p.action=v}function G2(p){var v=ds(),w=ci;if(w!==null)return G0(v,w,p);ds(),v=v.memoizedState,w=ds();var L=w.queue.dispatch;return w.memoizedState=p,[v,L,!1]}function z0(p,v,w,L){return p={tag:p,create:w,deps:L,inst:v,next:null},v=Nr.updateQueue,v===null&&(v=j0(),Nr.updateQueue=v),w=v.lastEffect,w===null?v.lastEffect=p.next=p:(L=w.next,w.next=p,p.next=L,v.lastEffect=p),p}function cT(){return{destroy:void 0,resource:void 0}}function op(){return ds().memoizedState}function lT(p,v,w,L){var U=Rc();L=L===void 0?null:L,Nr.flags|=p,U.memoizedState=z0(1|v,cT(),w,L)}function Od(p,v,w,L){var U=ds();L=L===void 0?null:L;var H=U.memoizedState.inst;ci!==null&&L!==null&&Ad(L,ci.memoizedState.deps)?U.memoizedState=z0(v,H,w,L):(Nr.flags|=p,U.memoizedState=z0(1|v,H,w,L))}function H0(p,v){lT(8390656,8,p,v)}function Wm(p,v){Od(2048,8,p,v)}function W0(p,v){return Od(4,2,p,v)}function iv(p,v){return Od(4,4,p,v)}function z2(p,v){if(typeof v=="function"){p=p();var w=v(p);return function(){typeof w=="function"?w():v(null)}}if(v!=null)return p=p(),v.current=p,function(){v.current=null}}function fw(p,v,w){w=w!=null?w.concat([p]):null,Od(4,4,z2.bind(null,v,p),w)}function hw(){}function Y0(p,v){var w=ds();v=v===void 0?null:v;var L=w.memoizedState;return v!==null&&Ad(v,L[1])?L[0]:(w.memoizedState=[p,v],p)}function H2(p,v){var w=ds();v=v===void 0?null:v;var L=w.memoizedState;if(v!==null&&Ad(v,L[1]))return L[0];if(L=p(),sp){ss(!0);try{p()}finally{ss(!1)}}return w.memoizedState=[L,v],L}function cp(p,v,w){return w===void 0||(ap&1073741824)!==0?p.memoizedState=v:(p.memoizedState=w,p=NT(),Nr.lanes|=p,Ud|=p,w)}function K0(p,v,w,L){return al(w,v)?w:Gm.current!==null?(p=cp(p,w,L),al(p,v)||(Ms=!0),p):(ap&42)===0?(Ms=!0,p.memoizedState=w):(p=NT(),Nr.lanes|=p,Ud|=p,v)}function Ym(p,v,w,L,U){var H=qe.p;qe.p=H!==0&&8>H?H:8;var pe=Oe.T,Ce={};Oe.T=Ce,cv(p,!1,v,w);try{var Fe=U(),it=Oe.S;if(it!==null&&it(Ce,Fe),Fe!==null&&typeof Fe=="object"&&typeof Fe.then=="function"){var pt=dM(Fe,L);Nd(p,v,pt,Lc(p))}else Nd(p,v,L,Lc(p))}catch(xt){Nd(p,v,{then:function(){},status:"rejected",reason:xt},Lc())}finally{qe.p=H,Oe.T=pe}}function av(){}function q0(p,v,w,L){if(p.tag!==5)throw Error(g(476));var U=pw(p).queue;Ym(p,U,v,lt,w===null?av:function(){return sv(p),w(L)})}function pw(p){var v=p.memoizedState;if(v!==null)return v;v={memoizedState:lt,baseState:lt,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ff,lastRenderedState:lt},next:null};var w={};return v.next={memoizedState:w,baseState:w,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ff,lastRenderedState:w},next:null},p.memoizedState=v,p=p.alternate,p!==null&&(p.memoizedState=v),v}function sv(p){var v=pw(p).next.queue;Nd(p,v,{},Lc())}function mw(){return za(u_)}function Hl(){return ds().memoizedState}function Km(){return ds().memoizedState}function qm(p){for(var v=p.return;v!==null;){switch(v.tag){case 24:case 3:var w=Lc();p=Vf(w);var L=zl(v,p,w);L!==null&&(Dc(L,v,w),Bf(L,v,w)),v={cache:L0()},p.payload=v;return}v=v.return}}function dT(p,v,w){var L=Lc();w={lane:L,revertLane:0,action:w,hasEagerState:!1,eagerState:null,next:null},lv(p)?dv(v,w):(w=HC(p,v,w,L),w!==null&&(Dc(w,p,L),W2(w,v,L)))}function ov(p,v,w){var L=Lc();Nd(p,v,w,L)}function Nd(p,v,w,L){var U={lane:L,revertLane:0,action:w,hasEagerState:!1,eagerState:null,next:null};if(lv(p))dv(v,U);else{var H=p.alternate;if(p.lanes===0&&(H===null||H.lanes===0)&&(H=v.lastRenderedReducer,H!==null))try{var pe=v.lastRenderedState,Ce=H(pe,w);if(U.hasEagerState=!0,U.eagerState=Ce,al(Ce,pe))return Qh(p,v,U,0),oa===null&&Pm(),!1}catch{}finally{}if(w=HC(p,v,U,L),w!==null)return Dc(w,p,L),W2(w,v,L),!0}return!1}function cv(p,v,w,L){if(L={lane:2,revertLane:Rp(),action:L,hasEagerState:!1,eagerState:null,next:null},lv(p)){if(v)throw Error(g(479))}else v=HC(p,w,L,2),v!==null&&Dc(v,p,2)}function lv(p){var v=p.alternate;return p===Nr||v!==null&&v===Nr}function dv(p,v){k0=$E=!0;var w=p.pending;w===null?v.next=v:(v.next=w.next,w.next=v),p.pending=v}function W2(p,v,w){if((w&4194048)!==0){var L=v.lanes;L&=p.pendingLanes,w|=L,v.lanes=w,Fh(p,w)}}var Ic={readContext:za,use:iT,useCallback:es,useContext:es,useEffect:es,useImperativeHandle:es,useLayoutEffect:es,useInsertionEffect:es,useMemo:es,useReducer:es,useRef:es,useState:es,useDebugValue:es,useDeferredValue:es,useTransition:es,useSyncExternalStore:es,useId:es,useHostTransitionStatus:es,useFormState:es,useActionState:es,useOptimistic:es,useMemoCache:es,useCacheRefresh:es},lp={readContext:za,use:iT,useCallback:function(p,v){return Rc().memoizedState=[p,v===void 0?null:v],p},useContext:za,useEffect:H0,useImperativeHandle:function(p,v,w){w=w!=null?w.concat([p]):null,lT(4194308,4,z2.bind(null,v,p),w)},useLayoutEffect:function(p,v){return lT(4194308,4,p,v)},useInsertionEffect:function(p,v){lT(4,2,p,v)},useMemo:function(p,v){var w=Rc();v=v===void 0?null:v;var L=p();if(sp){ss(!0);try{p()}finally{ss(!1)}}return w.memoizedState=[L,v],L},useReducer:function(p,v,w){var L=Rc();if(w!==void 0){var U=w(v);if(sp){ss(!0);try{w(v)}finally{ss(!1)}}}else U=v;return L.memoizedState=L.baseState=U,p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:p,lastRenderedState:U},L.queue=p,p=p.dispatch=dT.bind(null,Nr,p),[L.memoizedState,p]},useRef:function(p){var v=Rc();return p={current:p},v.memoizedState=p},useState:function(p){p=oT(p);var v=p.queue,w=ov.bind(null,Nr,v);return v.dispatch=w,[p.memoizedState,w]},useDebugValue:hw,useDeferredValue:function(p,v){var w=Rc();return cp(w,p,v)},useTransition:function(){var p=oT(!1);return p=Ym.bind(null,Nr,p.queue,!0,!1),Rc().memoizedState=p,[!1,p]},useSyncExternalStore:function(p,v,w){var L=Nr,U=Rc();if(Si){if(w===void 0)throw Error(g(407));w=w()}else{if(w=v(),oa===null)throw Error(g(349));(ii&124)!==0||cw(L,v,w)}U.memoizedState=w;var H={value:w,getSnapshot:v};return U.queue=H,H0(sT.bind(null,L,H,p),[p]),L.flags|=2048,z0(9,cT(),j2.bind(null,L,H,w,v),null),w},useId:function(){var p=Rc(),v=oa.identifierPrefix;if(Si){var w=Id,L=kf;w=(L&~(1<<32-Za(L)-1)).toString(32)+w,v=""+v+"R"+w,w=nT++,0<w&&(v+="H"+w.toString(32)),v+=""}else w=uM++,v=""+v+"r"+w.toString(32)+"";return p.memoizedState=v},useHostTransitionStatus:mw,useFormState:Hm,useActionState:Hm,useOptimistic:function(p){var v=Rc();v.memoizedState=v.baseState=p;var w={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return v.queue=w,v=cv.bind(null,Nr,!0,w),w.dispatch=v,[p,v]},useMemoCache:aw,useCacheRefresh:function(){return Rc().memoizedState=qm.bind(null,Nr)}},dp={readContext:za,use:iT,useCallback:Y0,useContext:za,useEffect:Wm,useImperativeHandle:fw,useInsertionEffect:W0,useLayoutEffect:iv,useMemo:H2,useReducer:aT,useRef:op,useState:function(){return aT(Ff)},useDebugValue:hw,useDeferredValue:function(p,v){var w=ds();return K0(w,ci.memoizedState,p,v)},useTransition:function(){var p=aT(Ff)[0],v=ds().memoizedState;return[typeof p=="boolean"?p:V0(p),v]},useSyncExternalStore:ow,useId:Hl,useHostTransitionStatus:mw,useFormState:rv,useActionState:rv,useOptimistic:function(p,v){var w=ds();return B0(w,ci,p,v)},useMemoCache:aw,useCacheRefresh:Km},Gf={readContext:za,use:iT,useCallback:Y0,useContext:za,useEffect:Wm,useImperativeHandle:fw,useInsertionEffect:W0,useLayoutEffect:iv,useMemo:H2,useReducer:tv,useRef:op,useState:function(){return tv(Ff)},useDebugValue:hw,useDeferredValue:function(p,v){var w=ds();return ci===null?cp(w,p,v):K0(w,ci.memoizedState,p,v)},useTransition:function(){var p=tv(Ff)[0],v=ds().memoizedState;return[typeof p=="boolean"?p:V0(p),v]},useSyncExternalStore:ow,useId:Hl,useHostTransitionStatus:mw,useFormState:G2,useActionState:G2,useOptimistic:function(p,v){var w=ds();return ci!==null?B0(w,ci,p,v):(w.baseState=p,[p,w.queue.dispatch])},useMemoCache:aw,useCacheRefresh:Km},Jm=null,Ld=0;function J0(p){var v=Ld;return Ld+=1,Jm===null&&(Jm=[]),M2(Jm,p,v)}function uv(p,v){v=v.props.ref,p.ref=v!==void 0?v:null}function X0(p,v){throw v.$$typeof===K?Error(g(525)):(p=Object.prototype.toString.call(v),Error(g(31,p==="[object Object]"?"object with keys {"+Object.keys(v).join(", ")+"}":p)))}function Y2(p){var v=p._init;return v(p._payload)}function fv(p){function v(nt,Je){if(p){var st=nt.deletions;st===null?(nt.deletions=[Je],nt.flags|=16):st.push(Je)}}function w(nt,Je){if(!p)return null;for(;Je!==null;)v(nt,Je),Je=Je.sibling;return null}function L(nt){for(var Je=new Map;nt!==null;)nt.key!==null?Je.set(nt.key,nt):Je.set(nt.index,nt),nt=nt.sibling;return Je}function U(nt,Je){return nt=Mf(nt,Je),nt.index=0,nt.sibling=null,nt}function H(nt,Je,st){return nt.index=st,p?(st=nt.alternate,st!==null?(st=st.index,st<Je?(nt.flags|=67108866,Je):st):(nt.flags|=67108866,Je)):(nt.flags|=1048576,Je)}function pe(nt){return p&&nt.alternate===null&&(nt.flags|=67108866),nt}function Ce(nt,Je,st,Nt){return Je===null||Je.tag!==6?(Je=wc(st,nt.mode,Nt),Je.return=nt,Je):(Je=U(Je,st),Je.return=nt,Je)}function Fe(nt,Je,st,Nt){var sn=st.type;return sn===X?pt(nt,Je,st.props.children,Nt,st.key):Je!==null&&(Je.elementType===sn||typeof sn=="object"&&sn!==null&&sn.$$typeof===Le&&Y2(sn)===Je.type)?(Je=U(Je,st.props),uv(Je,st),Je.return=nt,Je):(Je=GE(st.type,st.key,st.props,null,nt.mode,Nt),uv(Je,st),Je.return=nt,Je)}function it(nt,Je,st,Nt){return Je===null||Je.tag!==4||Je.stateNode.containerInfo!==st.containerInfo||Je.stateNode.implementation!==st.implementation?(Je=YC(st,nt.mode,Nt),Je.return=nt,Je):(Je=U(Je,st.children||[]),Je.return=nt,Je)}function pt(nt,Je,st,Nt,sn){return Je===null||Je.tag!==7?(Je=$h(st,nt.mode,Nt,sn),Je.return=nt,Je):(Je=U(Je,st),Je.return=nt,Je)}function xt(nt,Je,st){if(typeof Je=="string"&&Je!==""||typeof Je=="number"||typeof Je=="bigint")return Je=wc(""+Je,nt.mode,st),Je.return=nt,Je;if(typeof Je=="object"&&Je!==null){switch(Je.$$typeof){case Q:return st=GE(Je.type,Je.key,Je.props,null,nt.mode,st),uv(st,Je),st.return=nt,st;case ie:return Je=YC(Je,nt.mode,st),Je.return=nt,Je;case Le:var Nt=Je._init;return Je=Nt(Je._payload),xt(nt,Je,st)}if(et(Je)||We(Je))return Je=$h(Je,nt.mode,st,null),Je.return=nt,Je;if(typeof Je.then=="function")return xt(nt,J0(Je),st);if(Je.$$typeof===ue)return xt(nt,N0(nt,Je),st);X0(nt,Je)}return null}function ct(nt,Je,st,Nt){var sn=Je!==null?Je.key:null;if(typeof st=="string"&&st!==""||typeof st=="number"||typeof st=="bigint")return sn!==null?null:Ce(nt,Je,""+st,Nt);if(typeof st=="object"&&st!==null){switch(st.$$typeof){case Q:return st.key===sn?Fe(nt,Je,st,Nt):null;case ie:return st.key===sn?it(nt,Je,st,Nt):null;case Le:return sn=st._init,st=sn(st._payload),ct(nt,Je,st,Nt)}if(et(st)||We(st))return sn!==null?null:pt(nt,Je,st,Nt,null);if(typeof st.then=="function")return ct(nt,Je,J0(st),Nt);if(st.$$typeof===ue)return ct(nt,Je,N0(nt,st),Nt);X0(nt,st)}return null}function dt(nt,Je,st,Nt,sn){if(typeof Nt=="string"&&Nt!==""||typeof Nt=="number"||typeof Nt=="bigint")return nt=nt.get(st)||null,Ce(Je,nt,""+Nt,sn);if(typeof Nt=="object"&&Nt!==null){switch(Nt.$$typeof){case Q:return nt=nt.get(Nt.key===null?st:Nt.key)||null,Fe(Je,nt,Nt,sn);case ie:return nt=nt.get(Nt.key===null?st:Nt.key)||null,it(Je,nt,Nt,sn);case Le:var Gr=Nt._init;return Nt=Gr(Nt._payload),dt(nt,Je,st,Nt,sn)}if(et(Nt)||We(Nt))return nt=nt.get(st)||null,pt(Je,nt,Nt,sn,null);if(typeof Nt.then=="function")return dt(nt,Je,st,J0(Nt),sn);if(Nt.$$typeof===ue)return dt(nt,Je,st,N0(Je,Nt),sn);X0(Je,Nt)}return null}function tr(nt,Je,st,Nt){for(var sn=null,Gr=null,Rn=Je,Vn=Je=0,Us=null;Rn!==null&&Vn<st.length;Vn++){Rn.index>Vn?(Us=Rn,Rn=null):Us=Rn.sibling;var $r=ct(nt,Rn,st[Vn],Nt);if($r===null){Rn===null&&(Rn=Us);break}p&&Rn&&$r.alternate===null&&v(nt,Rn),Je=H($r,Je,Vn),Gr===null?sn=$r:Gr.sibling=$r,Gr=$r,Rn=Us}if(Vn===st.length)return w(nt,Rn),Si&&km(nt,Vn),sn;if(Rn===null){for(;Vn<st.length;Vn++)Rn=xt(nt,st[Vn],Nt),Rn!==null&&(Je=H(Rn,Je,Vn),Gr===null?sn=Rn:Gr.sibling=Rn,Gr=Rn);return Si&&km(nt,Vn),sn}for(Rn=L(Rn);Vn<st.length;Vn++)Us=dt(Rn,nt,Vn,st[Vn],Nt),Us!==null&&(p&&Us.alternate!==null&&Rn.delete(Us.key===null?Vn:Us.key),Je=H(Us,Je,Vn),Gr===null?sn=Us:Gr.sibling=Us,Gr=Us);return p&&Rn.forEach(function(hl){return v(nt,hl)}),Si&&km(nt,Vn),sn}function wn(nt,Je,st,Nt){if(st==null)throw Error(g(151));for(var sn=null,Gr=null,Rn=Je,Vn=Je=0,Us=null,$r=st.next();Rn!==null&&!$r.done;Vn++,$r=st.next()){Rn.index>Vn?(Us=Rn,Rn=null):Us=Rn.sibling;var hl=ct(nt,Rn,$r.value,Nt);if(hl===null){Rn===null&&(Rn=Us);break}p&&Rn&&hl.alternate===null&&v(nt,Rn),Je=H(hl,Je,Vn),Gr===null?sn=hl:Gr.sibling=hl,Gr=hl,Rn=Us}if($r.done)return w(nt,Rn),Si&&km(nt,Vn),sn;if(Rn===null){for(;!$r.done;Vn++,$r=st.next())$r=xt(nt,$r.value,Nt),$r!==null&&(Je=H($r,Je,Vn),Gr===null?sn=$r:Gr.sibling=$r,Gr=$r);return Si&&km(nt,Vn),sn}for(Rn=L(Rn);!$r.done;Vn++,$r=st.next())$r=dt(Rn,nt,Vn,$r.value,Nt),$r!==null&&(p&&$r.alternate!==null&&Rn.delete($r.key===null?Vn:$r.key),Je=H($r,Je,Vn),Gr===null?sn=$r:Gr.sibling=$r,Gr=$r);return p&&Rn.forEach(function(sR){return v(nt,sR)}),Si&&km(nt,Vn),sn}function ta(nt,Je,st,Nt){if(typeof st=="object"&&st!==null&&st.type===X&&st.key===null&&(st=st.props.children),typeof st=="object"&&st!==null){switch(st.$$typeof){case Q:e:{for(var sn=st.key;Je!==null;){if(Je.key===sn){if(sn=st.type,sn===X){if(Je.tag===7){w(nt,Je.sibling),Nt=U(Je,st.props.children),Nt.return=nt,nt=Nt;break e}}else if(Je.elementType===sn||typeof sn=="object"&&sn!==null&&sn.$$typeof===Le&&Y2(sn)===Je.type){w(nt,Je.sibling),Nt=U(Je,st.props),uv(Nt,st),Nt.return=nt,nt=Nt;break e}w(nt,Je);break}else v(nt,Je);Je=Je.sibling}st.type===X?(Nt=$h(st.props.children,nt.mode,Nt,st.key),Nt.return=nt,nt=Nt):(Nt=GE(st.type,st.key,st.props,null,nt.mode,Nt),uv(Nt,st),Nt.return=nt,nt=Nt)}return pe(nt);case ie:e:{for(sn=st.key;Je!==null;){if(Je.key===sn)if(Je.tag===4&&Je.stateNode.containerInfo===st.containerInfo&&Je.stateNode.implementation===st.implementation){w(nt,Je.sibling),Nt=U(Je,st.children||[]),Nt.return=nt,nt=Nt;break e}else{w(nt,Je);break}else v(nt,Je);Je=Je.sibling}Nt=YC(st,nt.mode,Nt),Nt.return=nt,nt=Nt}return pe(nt);case Le:return sn=st._init,st=sn(st._payload),ta(nt,Je,st,Nt)}if(et(st))return tr(nt,Je,st,Nt);if(We(st)){if(sn=We(st),typeof sn!="function")throw Error(g(150));return st=sn.call(st),wn(nt,Je,st,Nt)}if(typeof st.then=="function")return ta(nt,Je,J0(st),Nt);if(st.$$typeof===ue)return ta(nt,Je,N0(nt,st),Nt);X0(nt,st)}return typeof st=="string"&&st!==""||typeof st=="number"||typeof st=="bigint"?(st=""+st,Je!==null&&Je.tag===6?(w(nt,Je.sibling),Nt=U(Je,st),Nt.return=nt,nt=Nt):(w(nt,Je),Nt=wc(st,nt.mode,Nt),Nt.return=nt,nt=Nt),pe(nt)):w(nt,Je)}return function(nt,Je,st,Nt){try{Ld=0;var sn=ta(nt,Je,st,Nt);return Jm=null,sn}catch(Rn){if(Rn===Iu||Rn===Qy)throw Rn;var Gr=go(29,Rn,null,nt.mode);return Gr.lanes=Nt,Gr.return=nt,Gr}finally{}}}var up=fv(!0),K2=fv(!1),ys=rt(null),Au=null;function fp(p){var v=p.alternate;Lt(Ps,Ps.current&1),Lt(ys,p),Au===null&&(v===null||Gm.current!==null||v.memoizedState!==null)&&(Au=p)}function q2(p){if(p.tag===22){if(Lt(Ps,Ps.current),Lt(ys,p),Au===null){var v=p.alternate;v!==null&&v.memoizedState!==null&&(Au=p)}}else hp()}function hp(){Lt(Ps,Ps.current),Lt(ys,ys.current)}function Ou(p){yt(ys),Au===p&&(Au=null),yt(Ps)}var Ps=rt(0);function Q0(p){for(var v=p;v!==null;){if(v.tag===13){var w=v.memoizedState;if(w!==null&&(w=w.dehydrated,w===null||w.data==="$?"||HT(w)))return v}else if(v.tag===19&&v.memoizedProps.revealOrder!==void 0){if((v.flags&128)!==0)return v}else if(v.child!==null){v.child.return=v,v=v.child;continue}if(v===p)break;for(;v.sibling===null;){if(v.return===null||v.return===p)return null;v=v.return}v.sibling.return=v.return,v=v.sibling}return null}function hv(p,v,w,L){v=p.memoizedState,w=w(L,v),w=w==null?v:V({},v,w),p.memoizedState=w,p.lanes===0&&(p.updateQueue.baseState=w)}var Nu={enqueueSetState:function(p,v,w){p=p._reactInternals;var L=Lc(),U=Vf(L);U.payload=v,w!=null&&(U.callback=w),v=zl(p,U,L),v!==null&&(Dc(v,p,L),Bf(v,p,L))},enqueueReplaceState:function(p,v,w){p=p._reactInternals;var L=Lc(),U=Vf(L);U.tag=1,U.payload=v,w!=null&&(U.callback=w),v=zl(p,U,L),v!==null&&(Dc(v,p,L),Bf(v,p,L))},enqueueForceUpdate:function(p,v){p=p._reactInternals;var w=Lc(),L=Vf(w);L.tag=2,v!=null&&(L.callback=v),v=zl(p,L,w),v!==null&&(Dc(v,p,w),Bf(v,p,w))}};function gw(p,v,w,L,U,H,pe){return p=p.stateNode,typeof p.shouldComponentUpdate=="function"?p.shouldComponentUpdate(L,H,pe):v.prototype&&v.prototype.isPureReactComponent?!qh(w,L)||!qh(U,H):!0}function J2(p,v,w,L){p=v.state,typeof v.componentWillReceiveProps=="function"&&v.componentWillReceiveProps(w,L),typeof v.UNSAFE_componentWillReceiveProps=="function"&&v.UNSAFE_componentWillReceiveProps(w,L),v.state!==p&&Nu.enqueueReplaceState(v,v.state,null)}function Xm(p,v){var w=v;if("ref"in v){w={};for(var L in v)L!=="ref"&&(w[L]=v[L])}if(p=p.defaultProps){w===v&&(w=V({},w));for(var U in p)w[U]===void 0&&(w[U]=p[U])}return w}var uT=typeof reportError=="function"?reportError:function(p){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var v=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof p=="object"&&p!==null&&typeof p.message=="string"?String(p.message):String(p),error:p});if(!window.dispatchEvent(v))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",p);return}console.error(p)};function X2(p){uT(p)}function Q2(p){console.error(p)}function fT(p){uT(p)}function hT(p,v){try{var w=p.onUncaughtError;w(v.value,{componentStack:v.stack})}catch(L){setTimeout(function(){throw L})}}function _w(p,v,w){try{var L=p.onCaughtError;L(w.value,{componentStack:w.stack,errorBoundary:v.tag===1?v.stateNode:null})}catch(U){setTimeout(function(){throw U})}}function Dd(p,v,w){return w=Vf(w),w.tag=3,w.payload={element:null},w.callback=function(){hT(p,v)},w}function Z2(p){return p=Vf(p),p.tag=3,p}function $2(p,v,w,L){var U=w.type.getDerivedStateFromError;if(typeof U=="function"){var H=L.value;p.payload=function(){return U(H)},p.callback=function(){_w(v,w,L)}}var pe=w.stateNode;pe!==null&&typeof pe.componentDidCatch=="function"&&(p.callback=function(){_w(v,w,L),typeof U!="function"&&(ku===null?ku=new Set([this]):ku.add(this));var Ce=L.stack;this.componentDidCatch(L.value,{componentStack:Ce!==null?Ce:""})})}function pM(p,v,w,L,U){if(w.flags|=32768,L!==null&&typeof L=="object"&&typeof L.then=="function"){if(v=w.alternate,v!==null&&Vm(v,w,U,!0),w=ys.current,w!==null){switch(w.tag){case 13:return Au===null?bp():w.alternate===null&&Ha===0&&(Ha=3),w.flags&=-257,w.flags|=65536,w.lanes=U,L===P0?w.flags|=16384:(v=w.updateQueue,v===null?w.updateQueue=new Set([L]):v.add(L),a_(p,L,U)),!1;case 22:return w.flags|=65536,L===P0?w.flags|=16384:(v=w.updateQueue,v===null?(v={transitions:null,markerInstances:null,retryQueue:new Set([L])},w.updateQueue=v):(w=v.retryQueue,w===null?v.retryQueue=new Set([L]):w.add(L)),a_(p,L,U)),!1}throw Error(g(435,w.tag))}return a_(p,L,U),bp(),!1}if(Si)return v=ys.current,v!==null?((v.flags&65536)===0&&(v.flags|=256),v.flags|=65536,v.lanes=U,L!==qC&&(p=Error(g(422),{cause:L}),ep(sl(p,w)))):(L!==qC&&(v=Error(g(423),{cause:L}),ep(sl(v,w))),p=p.current.alternate,p.flags|=65536,U&=-U,p.lanes|=U,L=sl(L,w),U=Dd(p.stateNode,L,U),$C(p,U),Ha!==4&&(Ha=2)),!1;var H=Error(g(520),{cause:L});if(H=sl(H,w),n_===null?n_=[H]:n_.push(H),Ha!==4&&(Ha=2),v===null)return!0;L=sl(L,w),w=v;do{switch(w.tag){case 3:return w.flags|=65536,p=U&-U,w.lanes|=p,p=Dd(w.stateNode,L,p),$C(w,p),!1;case 1:if(v=w.type,H=w.stateNode,(w.flags&128)===0&&(typeof v.getDerivedStateFromError=="function"||H!==null&&typeof H.componentDidCatch=="function"&&(ku===null||!ku.has(H))))return w.flags|=65536,U&=-U,w.lanes|=U,U=Z2(U),$2(U,p,w,L),$C(w,U),!1}w=w.return}while(w!==null);return!1}var Ew=Error(g(461)),Ms=!1;function _o(p,v,w,L){v.child=p===null?K2(v,null,w,L):up(v,p.child,w,L)}function pT(p,v,w,L,U){w=w.render;var H=v.ref;if("ref"in L){var pe={};for(var Ce in L)Ce!=="ref"&&(pe[Ce]=L[Ce])}else pe=L;return Ru(v),L=rw(p,v,w,pe,H,U),Ce=iw(),p!==null&&!Ms?(rT(p,v,U),Lu(p,v,U)):(Si&&Ce&&Hy(v),v.flags|=1,_o(p,v,L,U),v.child)}function pv(p,v,w,L,U){if(p===null){var H=w.type;return typeof H=="function"&&!WC(H)&&H.defaultProps===void 0&&w.compare===null?(v.tag=15,v.type=H,mT(p,v,H,L,U)):(p=GE(w.type,null,L,v,v.mode,U),p.ref=v.ref,p.return=v,v.child=p)}if(H=p.child,!vT(p,U)){var pe=H.memoizedProps;if(w=w.compare,w=w!==null?w:qh,w(pe,L)&&p.ref===v.ref)return Lu(p,v,U)}return v.flags|=1,p=Mf(H,L),p.ref=v.ref,p.return=v,v.child=p}function mT(p,v,w,L,U){if(p!==null){var H=p.memoizedProps;if(qh(H,L)&&p.ref===v.ref)if(Ms=!1,v.pendingProps=L=H,vT(p,U))(p.flags&131072)!==0&&(Ms=!0);else return v.lanes=p.lanes,Lu(p,v,U)}return Sw(p,v,w,L,U)}function vw(p,v,w){var L=v.pendingProps,U=L.children,H=p!==null?p.memoizedState:null;if(L.mode==="hidden"){if((v.flags&128)!==0){if(L=H!==null?H.baseLanes|w:w,p!==null){for(U=v.child=p.child,H=0;U!==null;)H=H|U.lanes|U.childLanes,U=U.sibling;v.childLanes=H&~L}else v.childLanes=0,v.child=null;return mv(p,v,L,w)}if((w&536870912)!==0)v.memoizedState={baseLanes:0,cachePool:null},p!==null&&Xy(v,H!==null?H.cachePool:null),H!==null?ZE(v,H):zm(),q2(v);else return v.lanes=v.childLanes=536870912,mv(p,v,H!==null?H.baseLanes|w:w,w)}else H!==null?(Xy(v,H.cachePool),ZE(v,H),hp(),v.memoizedState=null):(p!==null&&Xy(v,null),zm(),hp());return _o(p,v,U,w),v.child}function mv(p,v,w,L){var U=XC();return U=U===null?null:{parent:vs._currentValue,pool:U},v.memoizedState={baseLanes:w,cachePool:U},p!==null&&Xy(v,null),zm(),q2(v),p!==null&&Vm(p,v,L,!0),null}function gv(p,v){var w=v.ref;if(w===null)p!==null&&p.ref!==null&&(v.flags|=4194816);else{if(typeof w!="function"&&typeof w!="object")throw Error(g(284));(p===null||p.ref!==w)&&(v.flags|=4194816)}}function Sw(p,v,w,L,U){return Ru(v),w=rw(p,v,w,L,void 0,U),L=iw(),p!==null&&!Ms?(rT(p,v,U),Lu(p,v,U)):(Si&&L&&Hy(v),v.flags|=1,_o(p,v,w,U),v.child)}function gT(p,v,w,L,U,H){return Ru(v),v.updateQueue=null,w=x2(v,L,w,U),k2(p),L=iw(),p!==null&&!Ms?(rT(p,v,H),Lu(p,v,H)):(Si&&L&&Hy(v),v.flags|=1,_o(p,v,w,H),v.child)}function _v(p,v,w,L,U){if(Ru(v),v.stateNode===null){var H=Ds,pe=w.contextType;typeof pe=="object"&&pe!==null&&(H=za(pe)),H=new w(L,H),v.memoizedState=H.state!==null&&H.state!==void 0?H.state:null,H.updater=Nu,v.stateNode=H,H._reactInternals=v,H=v.stateNode,H.props=L,H.state=v.memoizedState,H.refs={},M0(v),pe=w.contextType,H.context=typeof pe=="object"&&pe!==null?za(pe):Ds,H.state=v.memoizedState,pe=w.getDerivedStateFromProps,typeof pe=="function"&&(hv(v,w,pe,L),H.state=v.memoizedState),typeof w.getDerivedStateFromProps=="function"||typeof H.getSnapshotBeforeUpdate=="function"||typeof H.UNSAFE_componentWillMount!="function"&&typeof H.componentWillMount!="function"||(pe=H.state,typeof H.componentWillMount=="function"&&H.componentWillMount(),typeof H.UNSAFE_componentWillMount=="function"&&H.UNSAFE_componentWillMount(),pe!==H.state&&Nu.enqueueReplaceState(H,H.state,null),Fm(v,L,H,U),ip(),H.state=v.memoizedState),typeof H.componentDidMount=="function"&&(v.flags|=4194308),L=!0}else if(p===null){H=v.stateNode;var Ce=v.memoizedProps,Fe=Xm(w,Ce);H.props=Fe;var it=H.context,pt=w.contextType;pe=Ds,typeof pt=="object"&&pt!==null&&(pe=za(pt));var xt=w.getDerivedStateFromProps;pt=typeof xt=="function"||typeof H.getSnapshotBeforeUpdate=="function",Ce=v.pendingProps!==Ce,pt||typeof H.UNSAFE_componentWillReceiveProps!="function"&&typeof H.componentWillReceiveProps!="function"||(Ce||it!==pe)&&J2(v,H,L,pe),Gl=!1;var ct=v.memoizedState;H.state=ct,Fm(v,L,H,U),ip(),it=v.memoizedState,Ce||ct!==it||Gl?(typeof xt=="function"&&(hv(v,w,xt,L),it=v.memoizedState),(Fe=Gl||gw(v,w,Fe,L,ct,it,pe))?(pt||typeof H.UNSAFE_componentWillMount!="function"&&typeof H.componentWillMount!="function"||(typeof H.componentWillMount=="function"&&H.componentWillMount(),typeof H.UNSAFE_componentWillMount=="function"&&H.UNSAFE_componentWillMount()),typeof H.componentDidMount=="function"&&(v.flags|=4194308)):(typeof H.componentDidMount=="function"&&(v.flags|=4194308),v.memoizedProps=L,v.memoizedState=it),H.props=L,H.state=it,H.context=pe,L=Fe):(typeof H.componentDidMount=="function"&&(v.flags|=4194308),L=!1)}else{H=v.stateNode,tT(p,v),pe=v.memoizedProps,pt=Xm(w,pe),H.props=pt,xt=v.pendingProps,ct=H.context,it=w.contextType,Fe=Ds,typeof it=="object"&&it!==null&&(Fe=za(it)),Ce=w.getDerivedStateFromProps,(it=typeof Ce=="function"||typeof H.getSnapshotBeforeUpdate=="function")||typeof H.UNSAFE_componentWillReceiveProps!="function"&&typeof H.componentWillReceiveProps!="function"||(pe!==xt||ct!==Fe)&&J2(v,H,L,Fe),Gl=!1,ct=v.memoizedState,H.state=ct,Fm(v,L,H,U),ip();var dt=v.memoizedState;pe!==xt||ct!==dt||Gl||p!==null&&p.dependencies!==null&&Jy(p.dependencies)?(typeof Ce=="function"&&(hv(v,w,Ce,L),dt=v.memoizedState),(pt=Gl||gw(v,w,pt,L,ct,dt,Fe)||p!==null&&p.dependencies!==null&&Jy(p.dependencies))?(it||typeof H.UNSAFE_componentWillUpdate!="function"&&typeof H.componentWillUpdate!="function"||(typeof H.componentWillUpdate=="function"&&H.componentWillUpdate(L,dt,Fe),typeof H.UNSAFE_componentWillUpdate=="function"&&H.UNSAFE_componentWillUpdate(L,dt,Fe)),typeof H.componentDidUpdate=="function"&&(v.flags|=4),typeof H.getSnapshotBeforeUpdate=="function"&&(v.flags|=1024)):(typeof H.componentDidUpdate!="function"||pe===p.memoizedProps&&ct===p.memoizedState||(v.flags|=4),typeof H.getSnapshotBeforeUpdate!="function"||pe===p.memoizedProps&&ct===p.memoizedState||(v.flags|=1024),v.memoizedProps=L,v.memoizedState=dt),H.props=L,H.state=dt,H.context=Fe,L=pt):(typeof H.componentDidUpdate!="function"||pe===p.memoizedProps&&ct===p.memoizedState||(v.flags|=4),typeof H.getSnapshotBeforeUpdate!="function"||pe===p.memoizedProps&&ct===p.memoizedState||(v.flags|=1024),L=!1)}return H=L,gv(p,v),L=(v.flags&128)!==0,H||L?(H=v.stateNode,w=L&&typeof w.getDerivedStateFromError!="function"?null:H.render(),v.flags|=1,p!==null&&L?(v.child=up(v,p.child,null,U),v.child=up(v,null,w,U)):_o(p,v,w,U),v.memoizedState=H.state,p=v.child):p=Lu(p,v,U),p}function eO(p,v,w,L){return jm(),v.flags|=256,_o(p,v,w,L),v.child}var _T={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Qm(p){return{baseLanes:p,cachePool:P2()}}function Ev(p,v,w){return p=p!==null?p.childLanes&~w:0,v&&(p|=Wl),p}function ET(p,v,w){var L=v.pendingProps,U=!1,H=(v.flags&128)!==0,pe;if((pe=H)||(pe=p!==null&&p.memoizedState===null?!1:(Ps.current&2)!==0),pe&&(U=!0,v.flags&=-129),pe=(v.flags&32)!==0,v.flags&=-33,p===null){if(Si){if(U?fp(v):hp(),Si){var Ce=wa,Fe;if(Fe=Ce){e:{for(Fe=Ce,Ce=wu;Fe.nodeType!==8;){if(!Ce){Ce=null;break e}if(Fe=Bd(Fe.nextSibling),Fe===null){Ce=null;break e}}Ce=Fe}Ce!==null?(v.memoizedState={dehydrated:Ce,treeContext:Cu!==null?{id:kf,overflow:Id}:null,retryLane:536870912,hydrationErrors:null},Fe=go(18,null,null,0),Fe.stateNode=Ce,Fe.return=v,v.child=Fe,qs=v,wa=null,Fe=!0):Fe=!1}Fe||Um(v)}if(Ce=v.memoizedState,Ce!==null&&(Ce=Ce.dehydrated,Ce!==null))return HT(Ce)?v.lanes=32:v.lanes=536870912,null;Ou(v)}return Ce=L.children,L=L.fallback,U?(hp(),U=v.mode,Ce=vv({mode:"hidden",children:Ce},U),L=$h(L,U,w,null),Ce.return=v,L.return=v,Ce.sibling=L,v.child=Ce,U=v.child,U.memoizedState=Qm(w),U.childLanes=Ev(p,pe,w),v.memoizedState=_T,L):(fp(v),Zm(v,Ce))}if(Fe=p.memoizedState,Fe!==null&&(Ce=Fe.dehydrated,Ce!==null)){if(H)v.flags&256?(fp(v),v.flags&=-257,v=yw(p,v,w)):v.memoizedState!==null?(hp(),v.child=p.child,v.flags|=128,v=null):(hp(),U=L.fallback,Ce=v.mode,L=vv({mode:"visible",children:L.children},Ce),U=$h(U,Ce,w,null),U.flags|=2,L.return=v,U.return=v,L.sibling=U,v.child=L,up(v,p.child,null,w),L=v.child,L.memoizedState=Qm(w),L.childLanes=Ev(p,pe,w),v.memoizedState=_T,v=U);else if(fp(v),HT(Ce)){if(pe=Ce.nextSibling&&Ce.nextSibling.dataset,pe)var it=pe.dgst;pe=it,L=Error(g(419)),L.stack="",L.digest=pe,ep({value:L,source:null,stack:null}),v=yw(p,v,w)}else if(Ms||Vm(p,v,w,!1),pe=(w&p.childLanes)!==0,Ms||pe){if(pe=oa,pe!==null&&(L=w&-w,L=(L&42)!==0?1:yu(L),L=(L&(pe.suspendedLanes|w))!==0?0:L,L!==0&&L!==Fe.retryLane))throw Fe.retryLane=L,Zh(p,L),Dc(pe,p,L),Ew;Ce.data==="$?"||bp(),v=yw(p,v,w)}else Ce.data==="$?"?(v.flags|=192,v.child=p.child,v=null):(p=Fe.treeContext,wa=Bd(Ce.nextSibling),qs=v,Si=!0,xm=null,wu=!1,p!==null&&(ol[cl++]=kf,ol[cl++]=Id,ol[cl++]=Cu,kf=p.id,Id=p.overflow,Cu=v),v=Zm(v,L.children),v.flags|=4096);return v}return U?(hp(),U=L.fallback,Ce=v.mode,Fe=p.child,it=Fe.sibling,L=Mf(Fe,{mode:"hidden",children:L.children}),L.subtreeFlags=Fe.subtreeFlags&65011712,it!==null?U=Mf(it,U):(U=$h(U,Ce,w,null),U.flags|=2),U.return=v,L.return=v,L.sibling=U,v.child=L,L=U,U=v.child,Ce=p.child.memoizedState,Ce===null?Ce=Qm(w):(Fe=Ce.cachePool,Fe!==null?(it=vs._currentValue,Fe=Fe.parent!==it?{parent:it,pool:it}:Fe):Fe=P2(),Ce={baseLanes:Ce.baseLanes|w,cachePool:Fe}),U.memoizedState=Ce,U.childLanes=Ev(p,pe,w),v.memoizedState=_T,L):(fp(v),w=p.child,p=w.sibling,w=Mf(w,{mode:"visible",children:L.children}),w.return=v,w.sibling=null,p!==null&&(pe=v.deletions,pe===null?(v.deletions=[p],v.flags|=16):pe.push(p)),v.child=w,v.memoizedState=null,w)}function Zm(p,v){return v=vv({mode:"visible",children:v},p.mode),v.return=p,p.child=v}function vv(p,v){return p=go(22,p,null,v),p.lanes=0,p.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},p}function yw(p,v,w){return up(v,p.child,null,w),p=Zm(v,v.pendingProps.children),p.flags|=2,v.memoizedState=null,p}function Tw(p,v,w){p.lanes|=v;var L=p.alternate;L!==null&&(L.lanes|=v),Ky(p.return,v,w)}function zf(p,v,w,L,U){var H=p.memoizedState;H===null?p.memoizedState={isBackwards:v,rendering:null,renderingStartTime:0,last:L,tail:w,tailMode:U}:(H.isBackwards=v,H.rendering=null,H.renderingStartTime=0,H.last=L,H.tail=w,H.tailMode=U)}function tO(p,v,w){var L=v.pendingProps,U=L.revealOrder,H=L.tail;if(_o(p,v,L.children,w),L=Ps.current,(L&2)!==0)L=L&1|2,v.flags|=128;else{if(p!==null&&(p.flags&128)!==0)e:for(p=v.child;p!==null;){if(p.tag===13)p.memoizedState!==null&&Tw(p,w,v);else if(p.tag===19)Tw(p,w,v);else if(p.child!==null){p.child.return=p,p=p.child;continue}if(p===v)break e;for(;p.sibling===null;){if(p.return===null||p.return===v)break e;p=p.return}p.sibling.return=p.return,p=p.sibling}L&=1}switch(Lt(Ps,L),U){case"forwards":for(w=v.child,U=null;w!==null;)p=w.alternate,p!==null&&Q0(p)===null&&(U=w),w=w.sibling;w=U,w===null?(U=v.child,v.child=null):(U=w.sibling,w.sibling=null),zf(v,!1,U,w,H);break;case"backwards":for(w=null,U=v.child,v.child=null;U!==null;){if(p=U.alternate,p!==null&&Q0(p)===null){v.child=U;break}p=U.sibling,U.sibling=w,w=U,U=p}zf(v,!0,w,null,H);break;case"together":zf(v,!1,null,null,void 0);break;default:v.memoizedState=null}return v.child}function Lu(p,v,w){if(p!==null&&(v.dependencies=p.dependencies),Ud|=v.lanes,(w&v.childLanes)===0)if(p!==null){if(Vm(p,v,w,!1),(w&v.childLanes)===0)return null}else return null;if(p!==null&&v.child!==p.child)throw Error(g(153));if(v.child!==null){for(p=v.child,w=Mf(p,p.pendingProps),v.child=w,w.return=v;p.sibling!==null;)p=p.sibling,w=w.sibling=Mf(p,p.pendingProps),w.return=v;w.sibling=null}return v.child}function vT(p,v){return(p.lanes&v)!==0?!0:(p=p.dependencies,!!(p!==null&&Jy(p)))}function nO(p,v,w){switch(v.tag){case 3:rn(v,v.stateNode.containerInfo),tp(v,vs,p.memoizedState.cache),jm();break;case 27:case 5:kt(v);break;case 4:rn(v,v.stateNode.containerInfo);break;case 10:tp(v,v.type,v.memoizedProps.value);break;case 13:var L=v.memoizedState;if(L!==null)return L.dehydrated!==null?(fp(v),v.flags|=128,null):(w&v.child.childLanes)!==0?ET(p,v,w):(fp(v),p=Lu(p,v,w),p!==null?p.sibling:null);fp(v);break;case 19:var U=(p.flags&128)!==0;if(L=(w&v.childLanes)!==0,L||(Vm(p,v,w,!1),L=(w&v.childLanes)!==0),U){if(L)return tO(p,v,w);v.flags|=128}if(U=v.memoizedState,U!==null&&(U.rendering=null,U.tail=null,U.lastEffect=null),Lt(Ps,Ps.current),L)break;return null;case 22:case 23:return v.lanes=0,vw(p,v,w);case 24:tp(v,vs,p.memoizedState.cache)}return Lu(p,v,w)}function Sv(p,v,w){if(p!==null)if(p.memoizedProps!==v.pendingProps)Ms=!0;else{if(!vT(p,w)&&(v.flags&128)===0)return Ms=!1,nO(p,v,w);Ms=(p.flags&131072)!==0}else Ms=!1,Si&&(v.flags&1048576)!==0&&KC(v,HE,v.index);switch(v.lanes=0,v.tag){case 16:e:{p=v.pendingProps;var L=v.elementType,U=L._init;if(L=U(L._payload),v.type=L,typeof L=="function")WC(L)?(p=Xm(L,p),v.tag=1,v=_v(null,v,L,p,w)):(v.tag=0,v=Sw(null,v,L,p,w));else{if(L!=null){if(U=L.$$typeof,U===de){v.tag=11,v=pT(null,v,L,p,w);break e}else if(U===Te){v.tag=14,v=pv(null,v,L,p,w);break e}}throw v=$e(L)||L,Error(g(306,v,""))}}return v;case 0:return Sw(p,v,v.type,v.pendingProps,w);case 1:return L=v.type,U=Xm(L,v.pendingProps),_v(p,v,L,U,w);case 3:e:{if(rn(v,v.stateNode.containerInfo),p===null)throw Error(g(387));L=v.pendingProps;var H=v.memoizedState;U=H.element,tT(p,v),Fm(v,L,null,w);var pe=v.memoizedState;if(L=pe.cache,tp(v,vs,L),L!==H.cache&&qy(v,[vs],w,!0),ip(),L=pe.element,H.isDehydrated)if(H={element:L,isDehydrated:!1,cache:pe.cache},v.updateQueue.baseState=H,v.memoizedState=H,v.flags&256){v=eO(p,v,L,w);break e}else if(L!==U){U=sl(Error(g(424)),v),ep(U),v=eO(p,v,L,w);break e}else{switch(p=v.stateNode.containerInfo,p.nodeType){case 9:p=p.body;break;default:p=p.nodeName==="HTML"?p.ownerDocument.body:p}for(wa=Bd(p.firstChild),qs=v,Si=!0,xm=null,wu=!0,w=K2(v,null,L,w),v.child=w;w;)w.flags=w.flags&-3|4096,w=w.sibling}else{if(jm(),L===U){v=Lu(p,v,w);break e}_o(p,v,L,w)}v=v.child}return v;case 26:return gv(p,v),p===null?(w=RO(v.type,null,v.pendingProps,null))?v.memoizedState=w:Si||(w=v.type,p=v.pendingProps,L=zT(Gt.current).createElement(w),L[$i]=v,L[Tc]=p,Qs(L,w,p),cs(L),v.stateNode=L):v.memoizedState=RO(v.type,p.memoizedProps,v.pendingProps,p.memoizedState),null;case 27:return kt(v),p===null&&Si&&(L=v.stateNode=yO(v.type,v.pendingProps,Gt.current),qs=v,wu=!0,U=wa,Ip(v.type)?(Hw=U,wa=Bd(L.firstChild)):wa=U),_o(p,v,v.pendingProps.children,w),gv(p,v),p===null&&(v.flags|=4194304),v.child;case 5:return p===null&&Si&&((U=L=wa)&&(L=CM(L,v.type,v.pendingProps,wu),L!==null?(v.stateNode=L,qs=v,wa=Bd(L.firstChild),wu=!1,U=!0):U=!1),U||Um(v)),kt(v),U=v.type,H=v.pendingProps,pe=p!==null?p.memoizedProps:null,L=H.children,Bw(U,H)?L=null:pe!==null&&Bw(U,pe)&&(v.flags|=32),v.memoizedState!==null&&(U=rw(p,v,U2,null,null,w),u_._currentValue=U),gv(p,v),_o(p,v,L,w),v.child;case 6:return p===null&&Si&&((p=w=wa)&&(w=wM(w,v.pendingProps,wu),w!==null?(v.stateNode=w,qs=v,wa=null,p=!0):p=!1),p||Um(v)),null;case 13:return ET(p,v,w);case 4:return rn(v,v.stateNode.containerInfo),L=v.pendingProps,p===null?v.child=up(v,null,L,w):_o(p,v,L,w),v.child;case 11:return pT(p,v,v.type,v.pendingProps,w);case 7:return _o(p,v,v.pendingProps,w),v.child;case 8:return _o(p,v,v.pendingProps.children,w),v.child;case 12:return _o(p,v,v.pendingProps.children,w),v.child;case 10:return L=v.pendingProps,tp(v,v.type,L.value),_o(p,v,L.children,w),v.child;case 9:return U=v.type._context,L=v.pendingProps.children,Ru(v),U=za(U),L=L(U),v.flags|=1,_o(p,v,L,w),v.child;case 14:return pv(p,v,v.type,v.pendingProps,w);case 15:return mT(p,v,v.type,v.pendingProps,w);case 19:return tO(p,v,w);case 31:return L=v.pendingProps,w=v.mode,L={mode:L.mode,children:L.children},p===null?(w=vv(L,w),w.ref=v.ref,v.child=w,w.return=v,v=w):(w=Mf(p.child,L),w.ref=v.ref,v.child=w,w.return=v,v=w),v;case 22:return vw(p,v,w);case 24:return Ru(v),L=za(vs),p===null?(U=XC(),U===null&&(U=oa,H=L0(),U.pooledCache=H,H.refCount++,H!==null&&(U.pooledCacheLanes|=w),U=H),v.memoizedState={parent:L,cache:U},M0(v),tp(v,vs,U)):((p.lanes&w)!==0&&(tT(p,v),Fm(v,null,null,w),ip()),U=p.memoizedState,H=v.memoizedState,U.parent!==L?(U={parent:L,cache:L},v.memoizedState=U,v.lanes===0&&(v.memoizedState=v.updateQueue.baseState=U),tp(v,vs,L)):(L=H.cache,tp(v,vs,L),L!==U.cache&&qy(v,[vs],w,!0))),_o(p,v,v.pendingProps.children,w),v.child;case 29:throw v.pendingProps}throw Error(g(156,v.tag))}function Du(p){p.flags|=4}function ST(p,v){if(v.type!=="stylesheet"||(v.state.loading&4)!==0)p.flags&=-16777217;else if(p.flags|=16777216,!AO(v)){if(v=ys.current,v!==null&&((ii&4194048)===ii?Au!==null:(ii&62914560)!==ii&&(ii&536870912)===0||v!==Au))throw JE=P0,QC;p.flags|=8192}}function yT(p,v){v!==null&&(p.flags|=4),p.flags&16384&&(v=p.tag!==22?wE():536870912,p.lanes|=v,Yf|=v)}function $m(p,v){if(!Si)switch(p.tailMode){case"hidden":v=p.tail;for(var w=null;v!==null;)v.alternate!==null&&(w=v),v=v.sibling;w===null?p.tail=null:w.sibling=null;break;case"collapsed":w=p.tail;for(var L=null;w!==null;)w.alternate!==null&&(L=w),w=w.sibling;L===null?v||p.tail===null?p.tail=null:p.tail.sibling=null:L.sibling=null}}function ga(p){var v=p.alternate!==null&&p.alternate.child===p.child,w=0,L=0;if(v)for(var U=p.child;U!==null;)w|=U.lanes|U.childLanes,L|=U.subtreeFlags&65011712,L|=U.flags&65011712,U.return=p,U=U.sibling;else for(U=p.child;U!==null;)w|=U.lanes|U.childLanes,L|=U.subtreeFlags,L|=U.flags,U.return=p,U=U.sibling;return p.subtreeFlags|=L,p.childLanes=w,v}function rO(p,v,w){var L=v.pendingProps;switch(Wy(v),v.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ga(v),null;case 1:return ga(v),null;case 3:return w=v.stateNode,L=null,p!==null&&(L=p.memoizedState.cache),v.memoizedState.cache!==L&&(v.flags|=2048),jf(vs),ir(),w.pendingContext&&(w.context=w.pendingContext,w.pendingContext=null),(p===null||p.child===null)&&(WE(v)?Du(v):p===null||p.memoizedState.isDehydrated&&(v.flags&256)===0||(v.flags|=1024,O2())),ga(v),null;case 26:return w=v.memoizedState,p===null?(Du(v),w!==null?(ga(v),ST(v,w)):(ga(v),v.flags&=-16777217)):w?w!==p.memoizedState?(Du(v),ga(v),ST(v,w)):(ga(v),v.flags&=-16777217):(p.memoizedProps!==L&&Du(v),ga(v),v.flags&=-16777217),null;case 27:Ht(v),w=Gt.current;var U=v.type;if(p!==null&&v.stateNode!=null)p.memoizedProps!==L&&Du(v);else{if(!L){if(v.stateNode===null)throw Error(g(166));return ga(v),null}p=Pt.current,WE(v)?JC(v):(p=yO(U,L,w),v.stateNode=p,Du(v))}return ga(v),null;case 5:if(Ht(v),w=v.type,p!==null&&v.stateNode!=null)p.memoizedProps!==L&&Du(v);else{if(!L){if(v.stateNode===null)throw Error(g(166));return ga(v),null}if(p=Pt.current,WE(v))JC(v);else{switch(U=zT(Gt.current),p){case 1:p=U.createElementNS("http://www.w3.org/2000/svg",w);break;case 2:p=U.createElementNS("http://www.w3.org/1998/Math/MathML",w);break;default:switch(w){case"svg":p=U.createElementNS("http://www.w3.org/2000/svg",w);break;case"math":p=U.createElementNS("http://www.w3.org/1998/Math/MathML",w);break;case"script":p=U.createElement("div"),p.innerHTML="<script><\/script>",p=p.removeChild(p.firstChild);break;case"select":p=typeof L.is=="string"?U.createElement("select",{is:L.is}):U.createElement("select"),L.multiple?p.multiple=!0:L.size&&(p.size=L.size);break;default:p=typeof L.is=="string"?U.createElement(w,{is:L.is}):U.createElement(w)}}p[$i]=v,p[Tc]=L;e:for(U=v.child;U!==null;){if(U.tag===5||U.tag===6)p.appendChild(U.stateNode);else if(U.tag!==4&&U.tag!==27&&U.child!==null){U.child.return=U,U=U.child;continue}if(U===v)break e;for(;U.sibling===null;){if(U.return===null||U.return===v)break e;U=U.return}U.sibling.return=U.return,U=U.sibling}v.stateNode=p;e:switch(Qs(p,w,L),w){case"button":case"input":case"select":case"textarea":p=!!L.autoFocus;break e;case"img":p=!0;break e;default:p=!1}p&&Du(v)}}return ga(v),v.flags&=-16777217,null;case 6:if(p&&v.stateNode!=null)p.memoizedProps!==L&&Du(v);else{if(typeof L!="string"&&v.stateNode===null)throw Error(g(166));if(p=Gt.current,WE(v)){if(p=v.stateNode,w=v.memoizedProps,L=null,U=qs,U!==null)switch(U.tag){case 27:case 5:L=U.memoizedProps}p[$i]=v,p=!!(p.nodeValue===w||L!==null&&L.suppressHydrationWarning===!0||GT(p.nodeValue,w)),p||Um(v)}else p=zT(p).createTextNode(L),p[$i]=v,v.stateNode=p}return ga(v),null;case 13:if(L=v.memoizedState,p===null||p.memoizedState!==null&&p.memoizedState.dehydrated!==null){if(U=WE(v),L!==null&&L.dehydrated!==null){if(p===null){if(!U)throw Error(g(318));if(U=v.memoizedState,U=U!==null?U.dehydrated:null,!U)throw Error(g(317));U[$i]=v}else jm(),(v.flags&128)===0&&(v.memoizedState=null),v.flags|=4;ga(v),U=!1}else U=O2(),p!==null&&p.memoizedState!==null&&(p.memoizedState.hydrationErrors=U),U=!0;if(!U)return v.flags&256?(Ou(v),v):(Ou(v),null)}if(Ou(v),(v.flags&128)!==0)return v.lanes=w,v;if(w=L!==null,p=p!==null&&p.memoizedState!==null,w){L=v.child,U=null,L.alternate!==null&&L.alternate.memoizedState!==null&&L.alternate.memoizedState.cachePool!==null&&(U=L.alternate.memoizedState.cachePool.pool);var H=null;L.memoizedState!==null&&L.memoizedState.cachePool!==null&&(H=L.memoizedState.cachePool.pool),H!==U&&(L.flags|=2048)}return w!==p&&w&&(v.child.flags|=8192),yT(v,v.updateQueue),ga(v),null;case 4:return ir(),p===null&&$f(v.stateNode.containerInfo),ga(v),null;case 10:return jf(v.type),ga(v),null;case 19:if(yt(Ps),U=v.memoizedState,U===null)return ga(v),null;if(L=(v.flags&128)!==0,H=U.rendering,H===null)if(L)$m(U,!1);else{if(Ha!==0||p!==null&&(p.flags&128)!==0)for(p=v.child;p!==null;){if(H=Q0(p),H!==null){for(v.flags|=128,$m(U,!1),p=H.updateQueue,v.updateQueue=p,yT(v,p),v.subtreeFlags=0,p=w,w=v.child;w!==null;)zy(w,p),w=w.sibling;return Lt(Ps,Ps.current&1|2),v.child}p=p.sibling}U.tail!==null&&jr()>Sp&&(v.flags|=128,L=!0,$m(U,!1),v.lanes=4194304)}else{if(!L)if(p=Q0(H),p!==null){if(v.flags|=128,L=!0,p=p.updateQueue,v.updateQueue=p,yT(v,p),$m(U,!0),U.tail===null&&U.tailMode==="hidden"&&!H.alternate&&!Si)return ga(v),null}else 2*jr()-U.renderingStartTime>Sp&&w!==536870912&&(v.flags|=128,L=!0,$m(U,!1),v.lanes=4194304);U.isBackwards?(H.sibling=v.child,v.child=H):(p=U.last,p!==null?p.sibling=H:v.child=H,U.last=H)}return U.tail!==null?(v=U.tail,U.rendering=v,U.tail=v.sibling,U.renderingStartTime=jr(),v.sibling=null,p=Ps.current,Lt(Ps,L?p&1|2:p&1),v):(ga(v),null);case 22:case 23:return Ou(v),nw(),L=v.memoizedState!==null,p!==null?p.memoizedState!==null!==L&&(v.flags|=8192):L&&(v.flags|=8192),L?(w&536870912)!==0&&(v.flags&128)===0&&(ga(v),v.subtreeFlags&6&&(v.flags|=8192)):ga(v),w=v.updateQueue,w!==null&&yT(v,w.retryQueue),w=null,p!==null&&p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(w=p.memoizedState.cachePool.pool),L=null,v.memoizedState!==null&&v.memoizedState.cachePool!==null&&(L=v.memoizedState.cachePool.pool),L!==w&&(v.flags|=2048),p!==null&&yt(rp),null;case 24:return w=null,p!==null&&(w=p.memoizedState.cache),v.memoizedState.cache!==w&&(v.flags|=2048),jf(vs),ga(v),null;case 25:return null;case 30:return null}throw Error(g(156,v.tag))}function mM(p,v){switch(Wy(v),v.tag){case 1:return p=v.flags,p&65536?(v.flags=p&-65537|128,v):null;case 3:return jf(vs),ir(),p=v.flags,(p&65536)!==0&&(p&128)===0?(v.flags=p&-65537|128,v):null;case 26:case 27:case 5:return Ht(v),null;case 13:if(Ou(v),p=v.memoizedState,p!==null&&p.dehydrated!==null){if(v.alternate===null)throw Error(g(340));jm()}return p=v.flags,p&65536?(v.flags=p&-65537|128,v):null;case 19:return yt(Ps),null;case 4:return ir(),null;case 10:return jf(v.type),null;case 22:case 23:return Ou(v),nw(),p!==null&&yt(rp),p=v.flags,p&65536?(v.flags=p&-65537|128,v):null;case 24:return jf(vs),null;case 25:return null;default:return null}}function iO(p,v){switch(Wy(v),v.tag){case 3:jf(vs),ir();break;case 26:case 27:case 5:Ht(v);break;case 4:ir();break;case 13:Ou(v);break;case 19:yt(Ps);break;case 10:jf(v.type);break;case 22:case 23:Ou(v),nw(),p!==null&&yt(rp);break;case 24:jf(vs)}}function eg(p,v){try{var w=v.updateQueue,L=w!==null?w.lastEffect:null;if(L!==null){var U=L.next;w=U;do{if((w.tag&p)===p){L=void 0;var H=w.create,pe=w.inst;L=H(),pe.destroy=L}w=w.next}while(w!==U)}}catch(Ce){ca(v,v.return,Ce)}}function pp(p,v,w){try{var L=v.updateQueue,U=L!==null?L.lastEffect:null;if(U!==null){var H=U.next;L=H;do{if((L.tag&p)===p){var pe=L.inst,Ce=pe.destroy;if(Ce!==void 0){pe.destroy=void 0,U=v;var Fe=w,it=Ce;try{it()}catch(pt){ca(U,Fe,pt)}}}L=L.next}while(L!==H)}}catch(pt){ca(v,v.return,pt)}}function aO(p){var v=p.updateQueue;if(v!==null){var w=p.stateNode;try{XE(v,w)}catch(L){ca(p,p.return,L)}}}function yv(p,v,w){w.props=Xm(p.type,p.memoizedProps),w.state=p.memoizedState;try{w.componentWillUnmount()}catch(L){ca(p,v,L)}}function Tv(p,v){try{var w=p.ref;if(w!==null){switch(p.tag){case 26:case 27:case 5:var L=p.stateNode;break;case 30:L=p.stateNode;break;default:L=p.stateNode}typeof w=="function"?p.refCleanup=w(L):w.current=L}}catch(U){ca(p,v,U)}}function ll(p,v){var w=p.ref,L=p.refCleanup;if(w!==null)if(typeof L=="function")try{L()}catch(U){ca(p,v,U)}finally{p.refCleanup=null,p=p.alternate,p!=null&&(p.refCleanup=null)}else if(typeof w=="function")try{w(null)}catch(U){ca(p,v,U)}else w.current=null}function TT(p){var v=p.type,w=p.memoizedProps,L=p.stateNode;try{e:switch(v){case"button":case"input":case"select":case"textarea":w.autoFocus&&L.focus();break e;case"img":w.src?L.src=w.src:w.srcSet&&(L.srcset=w.srcSet)}}catch(U){ca(p,p.return,U)}}function bT(p,v,w){try{var L=p.stateNode;vM(L,p.type,w,v),L[Tc]=v}catch(U){ca(p,p.return,U)}}function sO(p){return p.tag===5||p.tag===3||p.tag===26||p.tag===27&&Ip(p.type)||p.tag===4}function tg(p){e:for(;;){for(;p.sibling===null;){if(p.return===null||sO(p.return))return null;p=p.return}for(p.sibling.return=p.return,p=p.sibling;p.tag!==5&&p.tag!==6&&p.tag!==18;){if(p.tag===27&&Ip(p.type)||p.flags&2||p.child===null||p.tag===4)continue e;p.child.return=p,p=p.child}if(!(p.flags&2))return p.stateNode}}function bv(p,v,w){var L=p.tag;if(L===5||L===6)p=p.stateNode,v?(w.nodeType===9?w.body:w.nodeName==="HTML"?w.ownerDocument.body:w).insertBefore(p,v):(v=w.nodeType===9?w.body:w.nodeName==="HTML"?w.ownerDocument.body:w,v.appendChild(p),w=w._reactRootContainer,w!=null||v.onclick!==null||(v.onclick=zv));else if(L!==4&&(L===27&&Ip(p.type)&&(w=p.stateNode,v=null),p=p.child,p!==null))for(bv(p,v,w),p=p.sibling;p!==null;)bv(p,v,w),p=p.sibling}function mp(p,v,w){var L=p.tag;if(L===5||L===6)p=p.stateNode,v?w.insertBefore(p,v):w.appendChild(p);else if(L!==4&&(L===27&&Ip(p.type)&&(w=p.stateNode),p=p.child,p!==null))for(mp(p,v,w),p=p.sibling;p!==null;)mp(p,v,w),p=p.sibling}function ng(p){var v=p.stateNode,w=p.memoizedProps;try{for(var L=p.type,U=v.attributes;U.length;)v.removeAttributeNode(U[0]);Qs(v,L,w),v[$i]=p,v[Tc]=w}catch(H){ca(p,p.return,H)}}var Pd=!1,Da=!1,gp=!1,oO=typeof WeakSet=="function"?WeakSet:Set,Js=null;function Cv(p,v){if(p=p.containerInfo,Vw=XT,p=Pf(p),nc(p)){if("selectionStart"in p)var w={start:p.selectionStart,end:p.selectionEnd};else e:{w=(w=p.ownerDocument)&&w.defaultView||window;var L=w.getSelection&&w.getSelection();if(L&&L.rangeCount!==0){w=L.anchorNode;var U=L.anchorOffset,H=L.focusNode;L=L.focusOffset;try{w.nodeType,H.nodeType}catch{w=null;break e}var pe=0,Ce=-1,Fe=-1,it=0,pt=0,xt=p,ct=null;t:for(;;){for(var dt;xt!==w||U!==0&&xt.nodeType!==3||(Ce=pe+U),xt!==H||L!==0&&xt.nodeType!==3||(Fe=pe+L),xt.nodeType===3&&(pe+=xt.nodeValue.length),(dt=xt.firstChild)!==null;)ct=xt,xt=dt;for(;;){if(xt===p)break t;if(ct===w&&++it===U&&(Ce=pe),ct===H&&++pt===L&&(Fe=pe),(dt=xt.nextSibling)!==null)break;xt=ct,ct=xt.parentNode}xt=dt}w=Ce===-1||Fe===-1?null:{start:Ce,end:Fe}}else w=null}w=w||{start:0,end:0}}else w=null;for(o_={focusedElem:p,selectionRange:w},XT=!1,Js=v;Js!==null;)if(v=Js,p=v.child,(v.subtreeFlags&1024)!==0&&p!==null)p.return=v,Js=p;else for(;Js!==null;){switch(v=Js,H=v.alternate,p=v.flags,v.tag){case 0:break;case 11:case 15:break;case 1:if((p&1024)!==0&&H!==null){p=void 0,w=v,U=H.memoizedProps,H=H.memoizedState,L=w.stateNode;try{var tr=Xm(w.type,U,w.elementType===w.type);p=L.getSnapshotBeforeUpdate(tr,H),L.__reactInternalSnapshotBeforeUpdate=p}catch(wn){ca(w,w.return,wn)}}break;case 3:if((p&1024)!==0){if(p=v.stateNode.containerInfo,w=p.nodeType,w===9)zw(p);else if(w===1)switch(p.nodeName){case"HEAD":case"HTML":case"BODY":zw(p);break;default:p.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((p&1024)!==0)throw Error(g(163))}if(p=v.sibling,p!==null){p.return=v.return,Js=p;break}Js=v.return}}function CT(p,v,w){var L=w.flags;switch(w.tag){case 0:case 11:case 15:xo(p,w),L&4&&eg(5,w);break;case 1:if(xo(p,w),L&4)if(p=w.stateNode,v===null)try{p.componentDidMount()}catch(pe){ca(w,w.return,pe)}else{var U=Xm(w.type,v.memoizedProps);v=v.memoizedState;try{p.componentDidUpdate(U,v,p.__reactInternalSnapshotBeforeUpdate)}catch(pe){ca(w,w.return,pe)}}L&64&&aO(w),L&512&&Tv(w,w.return);break;case 3:if(xo(p,w),L&64&&(p=w.updateQueue,p!==null)){if(v=null,w.child!==null)switch(w.child.tag){case 27:case 5:v=w.child.stateNode;break;case 1:v=w.child.stateNode}try{XE(p,v)}catch(pe){ca(w,w.return,pe)}}break;case 27:v===null&&L&4&&ng(w);case 26:case 5:xo(p,w),v===null&&L&4&&TT(w),L&512&&Tv(w,w.return);break;case 12:xo(p,w);break;case 13:xo(p,w),L&4&&cO(p,w),L&64&&(p=w.memoizedState,p!==null&&(p=p.dehydrated,p!==null&&(w=Nw.bind(null,w),RM(p,w))));break;case 22:if(L=w.memoizedState!==null||Pd,!L){v=v!==null&&v.memoizedState!==null||Da,U=Pd;var H=Da;Pd=L,(Da=v)&&!H?Oc(p,w,(w.subtreeFlags&8772)!==0):xo(p,w),Pd=U,Da=H}break;case 30:break;default:xo(p,w)}}function Z0(p){var v=p.alternate;v!==null&&(p.alternate=null,Z0(v)),p.child=null,p.deletions=null,p.sibling=null,p.tag===5&&(v=p.stateNode,v!==null&&IE(v)),p.stateNode=null,p.return=null,p.dependencies=null,p.memoizedProps=null,p.memoizedState=null,p.pendingProps=null,p.stateNode=null,p.updateQueue=null}var qi=null,ic=!1;function dl(p,v,w){for(w=w.child;w!==null;)_p(p,v,w),w=w.sibling}function _p(p,v,w){if(Tr&&typeof Tr.onCommitFiberUnmount=="function")try{Tr.onCommitFiberUnmount(jl,w)}catch{}switch(w.tag){case 26:Da||ll(w,v),dl(p,v,w),w.memoizedState?w.memoizedState.count--:w.stateNode&&(w=w.stateNode,w.parentNode.removeChild(w));break;case 27:Da||ll(w,v);var L=qi,U=ic;Ip(w.type)&&(qi=w.stateNode,ic=!1),dl(p,v,w),Hv(w.stateNode),qi=L,ic=U;break;case 5:Da||ll(w,v);case 6:if(L=qi,U=ic,qi=null,dl(p,v,w),qi=L,ic=U,qi!==null)if(ic)try{(qi.nodeType===9?qi.body:qi.nodeName==="HTML"?qi.ownerDocument.body:qi).removeChild(w.stateNode)}catch(H){ca(w,v,H)}else try{qi.removeChild(w.stateNode)}catch(H){ca(w,v,H)}break;case 18:qi!==null&&(ic?(p=qi,vO(p.nodeType===9?p.body:p.nodeName==="HTML"?p.ownerDocument.body:p,w.stateNode),Mc(p)):vO(qi,w.stateNode));break;case 4:L=qi,U=ic,qi=w.stateNode.containerInfo,ic=!0,dl(p,v,w),qi=L,ic=U;break;case 0:case 11:case 14:case 15:Da||pp(2,w,v),Da||pp(4,w,v),dl(p,v,w);break;case 1:Da||(ll(w,v),L=w.stateNode,typeof L.componentWillUnmount=="function"&&yv(w,v,L)),dl(p,v,w);break;case 21:dl(p,v,w);break;case 22:Da=(L=Da)||w.memoizedState!==null,dl(p,v,w),Da=L;break;default:dl(p,v,w)}}function cO(p,v){if(v.memoizedState===null&&(p=v.alternate,p!==null&&(p=p.memoizedState,p!==null&&(p=p.dehydrated,p!==null))))try{Mc(p)}catch(w){ca(v,v.return,w)}}function $0(p){switch(p.tag){case 13:case 19:var v=p.stateNode;return v===null&&(v=p.stateNode=new oO),v;case 22:return p=p.stateNode,v=p._retryCache,v===null&&(v=p._retryCache=new oO),v;default:throw Error(g(435,p.tag))}}function wT(p,v){var w=$0(p);v.forEach(function(L){var U=gM.bind(null,p,L);w.has(L)||(w.add(L),L.then(U,U))})}function _a(p,v){var w=v.deletions;if(w!==null)for(var L=0;L<w.length;L++){var U=w[L],H=p,pe=v,Ce=pe;e:for(;Ce!==null;){switch(Ce.tag){case 27:if(Ip(Ce.type)){qi=Ce.stateNode,ic=!1;break e}break;case 5:qi=Ce.stateNode,ic=!1;break e;case 3:case 4:qi=Ce.stateNode.containerInfo,ic=!0;break e}Ce=Ce.return}if(qi===null)throw Error(g(160));_p(H,pe,U),qi=null,ic=!1,H=U.alternate,H!==null&&(H.return=null),U.return=null}if(v.subtreeFlags&13878)for(v=v.child;v!==null;)lO(v,p),v=v.sibling}var Md=null;function lO(p,v){var w=p.alternate,L=p.flags;switch(p.tag){case 0:case 11:case 14:case 15:_a(v,p),Ac(p),L&4&&(pp(3,p,p.return),eg(3,p),pp(5,p,p.return));break;case 1:_a(v,p),Ac(p),L&512&&(Da||w===null||ll(w,w.return)),L&64&&Pd&&(p=p.updateQueue,p!==null&&(L=p.callbacks,L!==null&&(w=p.shared.hiddenCallbacks,p.shared.hiddenCallbacks=w===null?L:w.concat(L))));break;case 26:var U=Md;if(_a(v,p),Ac(p),L&512&&(Da||w===null||ll(w,w.return)),L&4){var H=w!==null?w.memoizedState:null;if(L=p.memoizedState,w===null)if(L===null)if(p.stateNode===null){e:{L=p.type,w=p.memoizedProps,U=U.ownerDocument||U;t:switch(L){case"title":H=U.getElementsByTagName("title")[0],(!H||H[E0]||H[$i]||H.namespaceURI==="http://www.w3.org/2000/svg"||H.hasAttribute("itemprop"))&&(H=U.createElement(L),U.head.insertBefore(H,U.querySelector("head > title"))),Qs(H,L,w),H[$i]=p,cs(H),L=H;break e;case"link":var pe=Jw("link","href",U).get(L+(w.href||""));if(pe){for(var Ce=0;Ce<pe.length;Ce++)if(H=pe[Ce],H.getAttribute("href")===(w.href==null||w.href===""?null:w.href)&&H.getAttribute("rel")===(w.rel==null?null:w.rel)&&H.getAttribute("title")===(w.title==null?null:w.title)&&H.getAttribute("crossorigin")===(w.crossOrigin==null?null:w.crossOrigin)){pe.splice(Ce,1);break t}}H=U.createElement(L),Qs(H,L,w),U.head.appendChild(H);break;case"meta":if(pe=Jw("meta","content",U).get(L+(w.content||""))){for(Ce=0;Ce<pe.length;Ce++)if(H=pe[Ce],H.getAttribute("content")===(w.content==null?null:""+w.content)&&H.getAttribute("name")===(w.name==null?null:w.name)&&H.getAttribute("property")===(w.property==null?null:w.property)&&H.getAttribute("http-equiv")===(w.httpEquiv==null?null:w.httpEquiv)&&H.getAttribute("charset")===(w.charSet==null?null:w.charSet)){pe.splice(Ce,1);break t}}H=U.createElement(L),Qs(H,L,w),U.head.appendChild(H);break;default:throw Error(g(468,L))}H[$i]=p,cs(H),L=H}p.stateNode=L}else IO(U,p.type,p.stateNode);else p.stateNode=KT(U,L,p.memoizedProps);else H!==L?(H===null?w.stateNode!==null&&(w=w.stateNode,w.parentNode.removeChild(w)):H.count--,L===null?IO(U,p.type,p.stateNode):KT(U,L,p.memoizedProps)):L===null&&p.stateNode!==null&&bT(p,p.memoizedProps,w.memoizedProps)}break;case 27:_a(v,p),Ac(p),L&512&&(Da||w===null||ll(w,w.return)),w!==null&&L&4&&bT(p,p.memoizedProps,w.memoizedProps);break;case 5:if(_a(v,p),Ac(p),L&512&&(Da||w===null||ll(w,w.return)),p.flags&32){U=p.stateNode;try{Of(U,"")}catch(dt){ca(p,p.return,dt)}}L&4&&p.stateNode!=null&&(U=p.memoizedProps,bT(p,U,w!==null?w.memoizedProps:U)),L&1024&&(gp=!0);break;case 6:if(_a(v,p),Ac(p),L&4){if(p.stateNode===null)throw Error(g(162));L=p.memoizedProps,w=p.stateNode;try{w.nodeValue=L}catch(dt){ca(p,p.return,dt)}}break;case 3:if(Kv=null,U=Md,Md=WT(v.containerInfo),_a(v,p),Md=U,Ac(p),L&4&&w!==null&&w.memoizedState.isDehydrated)try{Mc(v.containerInfo)}catch(dt){ca(p,p.return,dt)}gp&&(gp=!1,RT(p));break;case 4:L=Md,Md=WT(p.stateNode.containerInfo),_a(v,p),Ac(p),Md=L;break;case 12:_a(v,p),Ac(p);break;case 13:_a(v,p),Ac(p),p.child.flags&8192&&p.memoizedState!==null!=(w!==null&&w.memoizedState!==null)&&(Nv=jr()),L&4&&(L=p.updateQueue,L!==null&&(p.updateQueue=null,wT(p,L)));break;case 22:U=p.memoizedState!==null;var Fe=w!==null&&w.memoizedState!==null,it=Pd,pt=Da;if(Pd=it||U,Da=pt||Fe,_a(v,p),Da=pt,Pd=it,Ac(p),L&8192)e:for(v=p.stateNode,v._visibility=U?v._visibility&-2:v._visibility|1,U&&(w===null||Fe||Pd||Da||Ep(p)),w=null,v=p;;){if(v.tag===5||v.tag===26){if(w===null){Fe=w=v;try{if(H=Fe.stateNode,U)pe=H.style,typeof pe.setProperty=="function"?pe.setProperty("display","none","important"):pe.display="none";else{Ce=Fe.stateNode;var xt=Fe.memoizedProps.style,ct=xt!=null&&xt.hasOwnProperty("display")?xt.display:null;Ce.style.display=ct==null||typeof ct=="boolean"?"":(""+ct).trim()}}catch(dt){ca(Fe,Fe.return,dt)}}}else if(v.tag===6){if(w===null){Fe=v;try{Fe.stateNode.nodeValue=U?"":Fe.memoizedProps}catch(dt){ca(Fe,Fe.return,dt)}}}else if((v.tag!==22&&v.tag!==23||v.memoizedState===null||v===p)&&v.child!==null){v.child.return=v,v=v.child;continue}if(v===p)break e;for(;v.sibling===null;){if(v.return===null||v.return===p)break e;w===v&&(w=null),v=v.return}w===v&&(w=null),v.sibling.return=v.return,v=v.sibling}L&4&&(L=p.updateQueue,L!==null&&(w=L.retryQueue,w!==null&&(L.retryQueue=null,wT(p,w))));break;case 19:_a(v,p),Ac(p),L&4&&(L=p.updateQueue,L!==null&&(p.updateQueue=null,wT(p,L)));break;case 30:break;case 21:break;default:_a(v,p),Ac(p)}}function Ac(p){var v=p.flags;if(v&2){try{for(var w,L=p.return;L!==null;){if(sO(L)){w=L;break}L=L.return}if(w==null)throw Error(g(160));switch(w.tag){case 27:var U=w.stateNode,H=tg(p);mp(p,H,U);break;case 5:var pe=w.stateNode;w.flags&32&&(Of(pe,""),w.flags&=-33);var Ce=tg(p);mp(p,Ce,pe);break;case 3:case 4:var Fe=w.stateNode.containerInfo,it=tg(p);bv(p,it,Fe);break;default:throw Error(g(161))}}catch(pt){ca(p,p.return,pt)}p.flags&=-3}v&4096&&(p.flags&=-4097)}function RT(p){if(p.subtreeFlags&1024)for(p=p.child;p!==null;){var v=p;RT(v),v.tag===5&&v.flags&1024&&v.stateNode.reset(),p=p.sibling}}function xo(p,v){if(v.subtreeFlags&8772)for(v=v.child;v!==null;)CT(p,v.alternate,v),v=v.sibling}function Ep(p){for(p=p.child;p!==null;){var v=p;switch(v.tag){case 0:case 11:case 14:case 15:pp(4,v,v.return),Ep(v);break;case 1:ll(v,v.return);var w=v.stateNode;typeof w.componentWillUnmount=="function"&&yv(v,v.return,w),Ep(v);break;case 27:Hv(v.stateNode);case 26:case 5:ll(v,v.return),Ep(v);break;case 22:v.memoizedState===null&&Ep(v);break;case 30:Ep(v);break;default:Ep(v)}p=p.sibling}}function Oc(p,v,w){for(w=w&&(v.subtreeFlags&8772)!==0,v=v.child;v!==null;){var L=v.alternate,U=p,H=v,pe=H.flags;switch(H.tag){case 0:case 11:case 15:Oc(U,H,w),eg(4,H);break;case 1:if(Oc(U,H,w),L=H,U=L.stateNode,typeof U.componentDidMount=="function")try{U.componentDidMount()}catch(it){ca(L,L.return,it)}if(L=H,U=L.updateQueue,U!==null){var Ce=L.stateNode;try{var Fe=U.shared.hiddenCallbacks;if(Fe!==null)for(U.shared.hiddenCallbacks=null,U=0;U<Fe.length;U++)tw(Fe[U],Ce)}catch(it){ca(L,L.return,it)}}w&&pe&64&&aO(H),Tv(H,H.return);break;case 27:ng(H);case 26:case 5:Oc(U,H,w),w&&L===null&&pe&4&&TT(H),Tv(H,H.return);break;case 12:Oc(U,H,w);break;case 13:Oc(U,H,w),w&&pe&4&&cO(U,H);break;case 22:H.memoizedState===null&&Oc(U,H,w),Tv(H,H.return);break;case 30:break;default:Oc(U,H,w)}v=v.sibling}}function wv(p,v){var w=null;p!==null&&p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(w=p.memoizedState.cachePool.pool),p=null,v.memoizedState!==null&&v.memoizedState.cachePool!==null&&(p=v.memoizedState.cachePool.pool),p!==w&&(p!=null&&p.refCount++,w!=null&&YE(w))}function ac(p,v){p=null,v.alternate!==null&&(p=v.alternate.memoizedState.cache),v=v.memoizedState.cache,v!==p&&(v.refCount++,p!=null&&YE(p))}function Pu(p,v,w,L){if(v.subtreeFlags&10256)for(v=v.child;v!==null;)dO(p,v,w,L),v=v.sibling}function dO(p,v,w,L){var U=v.flags;switch(v.tag){case 0:case 11:case 15:Pu(p,v,w,L),U&2048&&eg(9,v);break;case 1:Pu(p,v,w,L);break;case 3:Pu(p,v,w,L),U&2048&&(p=null,v.alternate!==null&&(p=v.alternate.memoizedState.cache),v=v.memoizedState.cache,v!==p&&(v.refCount++,p!=null&&YE(p)));break;case 12:if(U&2048){Pu(p,v,w,L),p=v.stateNode;try{var H=v.memoizedProps,pe=H.id,Ce=H.onPostCommit;typeof Ce=="function"&&Ce(pe,v.alternate===null?"mount":"update",p.passiveEffectDuration,-0)}catch(Fe){ca(v,v.return,Fe)}}else Pu(p,v,w,L);break;case 13:Pu(p,v,w,L);break;case 23:break;case 22:H=v.stateNode,pe=v.alternate,v.memoizedState!==null?H._visibility&2?Pu(p,v,w,L):rg(p,v):H._visibility&2?Pu(p,v,w,L):(H._visibility|=2,Hf(p,v,w,L,(v.subtreeFlags&10256)!==0)),U&2048&&wv(pe,v);break;case 24:Pu(p,v,w,L),U&2048&&ac(v.alternate,v);break;default:Pu(p,v,w,L)}}function Hf(p,v,w,L,U){for(U=U&&(v.subtreeFlags&10256)!==0,v=v.child;v!==null;){var H=p,pe=v,Ce=w,Fe=L,it=pe.flags;switch(pe.tag){case 0:case 11:case 15:Hf(H,pe,Ce,Fe,U),eg(8,pe);break;case 23:break;case 22:var pt=pe.stateNode;pe.memoizedState!==null?pt._visibility&2?Hf(H,pe,Ce,Fe,U):rg(H,pe):(pt._visibility|=2,Hf(H,pe,Ce,Fe,U)),U&&it&2048&&wv(pe.alternate,pe);break;case 24:Hf(H,pe,Ce,Fe,U),U&&it&2048&&ac(pe.alternate,pe);break;default:Hf(H,pe,Ce,Fe,U)}v=v.sibling}}function rg(p,v){if(v.subtreeFlags&10256)for(v=v.child;v!==null;){var w=p,L=v,U=L.flags;switch(L.tag){case 22:rg(w,L),U&2048&&wv(L.alternate,L);break;case 24:rg(w,L),U&2048&&ac(L.alternate,L);break;default:rg(w,L)}v=v.sibling}}var e_=8192;function Wf(p){if(p.subtreeFlags&e_)for(p=p.child;p!==null;)uO(p),p=p.sibling}function uO(p){switch(p.tag){case 26:Wf(p),p.flags&e_&&p.memoizedState!==null&&PM(Md,p.memoizedState,p.memoizedProps);break;case 5:Wf(p);break;case 3:case 4:var v=Md;Md=WT(p.stateNode.containerInfo),Wf(p),Md=v;break;case 22:p.memoizedState===null&&(v=p.alternate,v!==null&&v.memoizedState!==null?(v=e_,e_=16777216,Wf(p),e_=v):Wf(p));break;default:Wf(p)}}function IT(p){var v=p.alternate;if(v!==null&&(p=v.child,p!==null)){v.child=null;do v=p.sibling,p.sibling=null,p=v;while(p!==null)}}function Rv(p){var v=p.deletions;if((p.flags&16)!==0){if(v!==null)for(var w=0;w<v.length;w++){var L=v[w];Js=L,Iv(L,p)}IT(p)}if(p.subtreeFlags&10256)for(p=p.child;p!==null;)AT(p),p=p.sibling}function AT(p){switch(p.tag){case 0:case 11:case 15:Rv(p),p.flags&2048&&pp(9,p,p.return);break;case 3:Rv(p);break;case 12:Rv(p);break;case 22:var v=p.stateNode;p.memoizedState!==null&&v._visibility&2&&(p.return===null||p.return.tag!==13)?(v._visibility&=-3,vp(p)):Rv(p);break;default:Rv(p)}}function vp(p){var v=p.deletions;if((p.flags&16)!==0){if(v!==null)for(var w=0;w<v.length;w++){var L=v[w];Js=L,Iv(L,p)}IT(p)}for(p=p.child;p!==null;){switch(v=p,v.tag){case 0:case 11:case 15:pp(8,v,v.return),vp(v);break;case 22:w=v.stateNode,w._visibility&2&&(w._visibility&=-3,vp(v));break;default:vp(v)}p=p.sibling}}function Iv(p,v){for(;Js!==null;){var w=Js;switch(w.tag){case 0:case 11:case 15:pp(8,w,v);break;case 23:case 22:if(w.memoizedState!==null&&w.memoizedState.cachePool!==null){var L=w.memoizedState.cachePool.pool;L!=null&&L.refCount++}break;case 24:YE(w.memoizedState.cache)}if(L=w.child,L!==null)L.return=w,Js=L;else e:for(w=p;Js!==null;){L=Js;var U=L.sibling,H=L.return;if(Z0(L),L===w){Js=null;break e}if(U!==null){U.return=H,Js=U;break e}Js=H}}}var Av={getCacheForType:function(p){var v=za(vs),w=v.data.get(p);return w===void 0&&(w=p(),v.data.set(p,w)),w}},bw=typeof WeakMap=="function"?WeakMap:Map,Oi=0,oa=null,Lr=null,ii=0,Zr=0,ks=null,kd=!1,Mu=!1,t_=!1,xd=0,Ha=0,Ud=0,Nc=0,OT=0,Wl=0,Yf=0,n_=null,xs=null,Ov=!1,Nv=0,Sp=1/0,r_=null,ku=null,Xs=0,jd=null,Yl=null,yp=0,ig=0,Tp=null,Cw=null,xu=0,Kf=null;function Lc(){if((Oi&2)!==0&&ii!==0)return ii&-ii;if(Oe.T!==null){var p=np;return p!==0?p:Rp()}return yc()}function NT(){Wl===0&&(Wl=(ii&536870912)===0||Si?Su():536870912);var p=ys.current;return p!==null&&(p.flags|=32),Wl}function Dc(p,v,w){(p===oa&&(Zr===2||Zr===9)||p.cancelPendingCommit!==null)&&(og(p,0),Uu(p,ii,Wl,!1)),wm(p,w),((Oi&2)===0||p!==oa)&&(p===oa&&((Oi&2)===0&&(Nc|=w),Ha===4&&Uu(p,ii,Wl,!1)),fl(p))}function ag(p,v,w){if((Oi&6)!==0)throw Error(g(327));var L=!w&&(v&124)===0&&(v&p.expiredLanes)===0||Cm(p,v),U=L?ju(p,v):Rw(p,v,!0),H=L;do{if(U===0){Mu&&!L&&Uu(p,v,0,!1);break}else{if(w=p.current.alternate,H&&!LT(w)){U=Rw(p,v,!1),H=!1;continue}if(U===2){if(H=v,p.errorRecoveryDisabledLanes&H)var pe=0;else pe=p.pendingLanes&-536870913,pe=pe!==0?pe:pe&536870912?536870912:0;if(pe!==0){v=pe;e:{var Ce=p;U=n_;var Fe=Ce.current.memoizedState.isDehydrated;if(Fe&&(og(Ce,pe).flags|=256),pe=Rw(Ce,pe,!1),pe!==2){if(t_&&!Fe){Ce.errorRecoveryDisabledLanes|=H,Nc|=H,U=4;break e}H=xs,xs=U,H!==null&&(xs===null?xs=H:xs.push.apply(xs,H))}U=pe}if(H=!1,U!==2)continue}}if(U===1){og(p,0),Uu(p,v,0,!0);break}e:{switch(L=p,H=U,H){case 0:case 1:throw Error(g(345));case 4:if((v&4194048)!==v)break;case 6:Uu(L,v,Wl,!kd);break e;case 2:xs=null;break;case 3:case 5:break;default:throw Error(g(329))}if((v&62914560)===v&&(U=Nv+300-jr(),10<U)){if(Uu(L,v,Wl,!kd),wf(L,0,!0)!==0)break e;L.timeoutHandle=EO(ww.bind(null,L,w,xs,r_,Ov,v,Wl,Nc,Yf,kd,H,2,-0,0),U);break e}ww(L,w,xs,r_,Ov,v,Wl,Nc,Yf,kd,H,0,-0,0)}}break}while(!0);fl(p)}function ww(p,v,w,L,U,H,pe,Ce,Fe,it,pt,xt,ct,dt){if(p.timeoutHandle=-1,xt=v.subtreeFlags,(xt&8192||(xt&16785408)===16785408)&&(qv={stylesheets:null,count:0,unsuspend:DM},uO(v),xt=Qw(),xt!==null)){p.cancelPendingCommit=xt(Pv.bind(null,p,v,H,w,L,U,pe,Ce,Fe,pt,1,ct,dt)),Uu(p,H,pe,!it);return}Pv(p,v,H,w,L,U,pe,Ce,Fe)}function LT(p){for(var v=p;;){var w=v.tag;if((w===0||w===11||w===15)&&v.flags&16384&&(w=v.updateQueue,w!==null&&(w=w.stores,w!==null)))for(var L=0;L<w.length;L++){var U=w[L],H=U.getSnapshot;U=U.value;try{if(!al(H(),U))return!1}catch{return!1}}if(w=v.child,v.subtreeFlags&16384&&w!==null)w.return=v,v=w;else{if(v===p)break;for(;v.sibling===null;){if(v.return===null||v.return===p)return!0;v=v.return}v.sibling.return=v.return,v=v.sibling}}return!0}function Uu(p,v,w,L){v&=~OT,v&=~Nc,p.suspendedLanes|=v,p.pingedLanes&=~v,L&&(p.warmLanes|=v),L=p.expirationTimes;for(var U=v;0<U;){var H=31-Za(U),pe=1<<H;L[H]=-1,U&=~pe}w!==0&&Bh(p,w,v)}function sg(){return(Oi&6)===0?(Uv(0),!1):!0}function i_(){if(Lr!==null){if(Zr===0)var p=Lr.return;else p=Lr,Uf=xf=null,ev(p),Jm=null,Ld=0,p=Lr;for(;p!==null;)iO(p.alternate,p),p=p.return;Lr=null}}function og(p,v){var w=p.timeoutHandle;w!==-1&&(p.timeoutHandle=-1,yM(w)),w=p.cancelPendingCommit,w!==null&&(p.cancelPendingCommit=null,w()),i_(),oa=p,Lr=w=Mf(p.current,null),ii=v,Zr=0,ks=null,kd=!1,Mu=Cm(p,v),t_=!1,Yf=Wl=OT=Nc=Ud=Ha=0,xs=n_=null,Ov=!1,(v&8)!==0&&(v|=v&32);var L=p.entangledLanes;if(L!==0)for(p=p.entanglements,L&=v;0<L;){var U=31-Za(L),H=1<<U;v|=p[U],L&=~H}return xd=v,Pm(),w}function qf(p,v){Nr=null,Oe.H=Ic,v===Iu||v===Qy?(v=$y(),Zr=3):v===QC?(v=$y(),Zr=4):Zr=v===Ew?8:v!==null&&typeof v=="object"&&typeof v.then=="function"?6:1,ks=v,Lr===null&&(Ha=1,hT(p,sl(v,p.current)))}function Jf(){var p=Oe.H;return Oe.H=Ic,p===null?Ic:p}function fO(){var p=Oe.A;return Oe.A=Av,p}function bp(){Ha=4,kd||(ii&4194048)!==ii&&ys.current!==null||(Mu=!0),(Ud&134217727)===0&&(Nc&134217727)===0||oa===null||Uu(oa,ii,Wl,!1)}function Rw(p,v,w){var L=Oi;Oi|=2;var U=Jf(),H=fO();(oa!==p||ii!==v)&&(r_=null,og(p,v)),v=!1;var pe=Ha;e:do try{if(Zr!==0&&Lr!==null){var Ce=Lr,Fe=ks;switch(Zr){case 8:i_(),pe=6;break e;case 3:case 2:case 9:case 6:ys.current===null&&(v=!0);var it=Zr;if(Zr=0,ks=null,Xf(p,Ce,Fe,it),w&&Mu){pe=0;break e}break;default:it=Zr,Zr=0,ks=null,Xf(p,Ce,Fe,it)}}Lv(),pe=Ha;break}catch(pt){qf(p,pt)}while(!0);return v&&p.shellSuspendCounter++,Uf=xf=null,Oi=L,Oe.H=U,Oe.A=H,Lr===null&&(oa=null,ii=0,Pm()),pe}function Lv(){for(;Lr!==null;)Iw(Lr)}function ju(p,v){var w=Oi;Oi|=2;var L=Jf(),U=fO();oa!==p||ii!==v?(r_=null,Sp=jr()+500,og(p,v)):Mu=Cm(p,v);e:do try{if(Zr!==0&&Lr!==null){v=Lr;var H=ks;t:switch(Zr){case 1:Zr=0,ks=null,Xf(p,v,H,1);break;case 2:case 9:if(ZC(H)){Zr=0,ks=null,DT(v);break}v=function(){Zr!==2&&Zr!==9||oa!==p||(Zr=7),fl(p)},H.then(v,v);break e;case 3:Zr=7;break e;case 4:Zr=5;break e;case 7:ZC(H)?(Zr=0,ks=null,DT(v)):(Zr=0,ks=null,Xf(p,v,H,7));break;case 5:var pe=null;switch(Lr.tag){case 26:pe=Lr.memoizedState;case 5:case 27:var Ce=Lr;if(!pe||AO(pe)){Zr=0,ks=null;var Fe=Ce.sibling;if(Fe!==null)Lr=Fe;else{var it=Ce.return;it!==null?(Lr=it,Dv(it)):Lr=null}break t}}Zr=0,ks=null,Xf(p,v,H,5);break;case 6:Zr=0,ks=null,Xf(p,v,H,6);break;case 8:i_(),Ha=6;break e;default:throw Error(g(462))}}hO();break}catch(pt){qf(p,pt)}while(!0);return Uf=xf=null,Oe.H=L,Oe.A=U,Oi=w,Lr!==null?0:(oa=null,ii=0,Pm(),Ha)}function hO(){for(;Lr!==null&&!oi();)Iw(Lr)}function Iw(p){var v=Sv(p.alternate,p,xd);p.memoizedProps=p.pendingProps,v===null?Dv(p):Lr=v}function DT(p){var v=p,w=v.alternate;switch(v.tag){case 15:case 0:v=gT(w,v,v.pendingProps,v.type,void 0,ii);break;case 11:v=gT(w,v,v.pendingProps,v.type.render,v.ref,ii);break;case 5:ev(v);default:iO(w,v),v=Lr=zy(v,xd),v=Sv(w,v,xd)}p.memoizedProps=p.pendingProps,v===null?Dv(p):Lr=v}function Xf(p,v,w,L){Uf=xf=null,ev(v),Jm=null,Ld=0;var U=v.return;try{if(pM(p,U,v,w,ii)){Ha=1,hT(p,sl(w,p.current)),Lr=null;return}}catch(H){if(U!==null)throw Lr=U,H;Ha=1,hT(p,sl(w,p.current)),Lr=null;return}v.flags&32768?(Si||L===1?p=!0:Mu||(ii&536870912)!==0?p=!1:(kd=p=!0,(L===2||L===9||L===3||L===6)&&(L=ys.current,L!==null&&L.tag===13&&(L.flags|=16384))),Aw(v,p)):Dv(v)}function Dv(p){var v=p;do{if((v.flags&32768)!==0){Aw(v,kd);return}p=v.return;var w=rO(v.alternate,v,xd);if(w!==null){Lr=w;return}if(v=v.sibling,v!==null){Lr=v;return}Lr=v=p}while(v!==null);Ha===0&&(Ha=5)}function Aw(p,v){do{var w=mM(p.alternate,p);if(w!==null){w.flags&=32767,Lr=w;return}if(w=p.return,w!==null&&(w.flags|=32768,w.subtreeFlags=0,w.deletions=null),!v&&(p=p.sibling,p!==null)){Lr=p;return}Lr=p=w}while(p!==null);Ha=6,Lr=null}function Pv(p,v,w,L,U,H,pe,Ce,Fe){p.cancelPendingCommit=null;do PT();while(Xs!==0);if((Oi&6)!==0)throw Error(g(327));if(v!==null){if(v===p.current)throw Error(g(177));if(H=v.lanes|v.childLanes,H|=zC,uC(p,w,H,pe,Ce,Fe),p===oa&&(Lr=oa=null,ii=0),Yl=v,jd=p,yp=w,ig=H,Tp=U,Cw=L,(v.subtreeFlags&10256)!==0||(v.flags&10256)!==0?(p.callbackNode=null,p.callbackPriority=0,_M(ar,function(){return MT(),null})):(p.callbackNode=null,p.callbackPriority=0),L=(v.flags&13878)!==0,(v.subtreeFlags&13878)!==0||L){L=Oe.T,Oe.T=null,U=qe.p,qe.p=2,pe=Oi,Oi|=4;try{Cv(p,v,w)}finally{Oi=pe,qe.p=U,Oe.T=L}}Xs=1,ul(),sc(),Ow()}}function ul(){if(Xs===1){Xs=0;var p=jd,v=Yl,w=(v.flags&13878)!==0;if((v.subtreeFlags&13878)!==0||w){w=Oe.T,Oe.T=null;var L=qe.p;qe.p=2;var U=Oi;Oi|=4;try{lO(v,p);var H=o_,pe=Pf(p.containerInfo),Ce=H.focusedElem,Fe=H.selectionRange;if(pe!==Ce&&Ce&&Ce.ownerDocument&&C2(Ce.ownerDocument.documentElement,Ce)){if(Fe!==null&&nc(Ce)){var it=Fe.start,pt=Fe.end;if(pt===void 0&&(pt=it),"selectionStart"in Ce)Ce.selectionStart=it,Ce.selectionEnd=Math.min(pt,Ce.value.length);else{var xt=Ce.ownerDocument||document,ct=xt&&xt.defaultView||window;if(ct.getSelection){var dt=ct.getSelection(),tr=Ce.textContent.length,wn=Math.min(Fe.start,tr),ta=Fe.end===void 0?wn:Math.min(Fe.end,tr);!dt.extend&&wn>ta&&(pe=ta,ta=wn,wn=pe);var nt=Cd(Ce,wn),Je=Cd(Ce,ta);if(nt&&Je&&(dt.rangeCount!==1||dt.anchorNode!==nt.node||dt.anchorOffset!==nt.offset||dt.focusNode!==Je.node||dt.focusOffset!==Je.offset)){var st=xt.createRange();st.setStart(nt.node,nt.offset),dt.removeAllRanges(),wn>ta?(dt.addRange(st),dt.extend(Je.node,Je.offset)):(st.setEnd(Je.node,Je.offset),dt.addRange(st))}}}}for(xt=[],dt=Ce;dt=dt.parentNode;)dt.nodeType===1&&xt.push({element:dt,left:dt.scrollLeft,top:dt.scrollTop});for(typeof Ce.focus=="function"&&Ce.focus(),Ce=0;Ce<xt.length;Ce++){var Nt=xt[Ce];Nt.element.scrollLeft=Nt.left,Nt.element.scrollTop=Nt.top}}XT=!!Vw,o_=Vw=null}finally{Oi=U,qe.p=L,Oe.T=w}}p.current=v,Xs=2}}function sc(){if(Xs===2){Xs=0;var p=jd,v=Yl,w=(v.flags&8772)!==0;if((v.subtreeFlags&8772)!==0||w){w=Oe.T,Oe.T=null;var L=qe.p;qe.p=2;var U=Oi;Oi|=4;try{CT(p,v.alternate,v)}finally{Oi=U,qe.p=L,Oe.T=w}}Xs=3}}function Ow(){if(Xs===4||Xs===3){Xs=0,Ri();var p=jd,v=Yl,w=yp,L=Cw;(v.subtreeFlags&10256)!==0||(v.flags&10256)!==0?Xs=5:(Xs=0,Yl=jd=null,pO(p,p.pendingLanes));var U=p.pendingLanes;if(U===0&&(ku=null),er(w),v=v.stateNode,Tr&&typeof Tr.onCommitFiberRoot=="function")try{Tr.onCommitFiberRoot(jl,v,void 0,(v.current.flags&128)===128)}catch{}if(L!==null){v=Oe.T,U=qe.p,qe.p=2,Oe.T=null;try{for(var H=p.onRecoverableError,pe=0;pe<L.length;pe++){var Ce=L[pe];H(Ce.value,{componentStack:Ce.stack})}}finally{Oe.T=v,qe.p=U}}(yp&3)!==0&&PT(),fl(p),U=p.pendingLanes,(w&4194090)!==0&&(U&42)!==0?p===Kf?xu++:(xu=0,Kf=p):xu=0,Uv(0)}}function pO(p,v){(p.pooledCacheLanes&=v)===0&&(v=p.pooledCache,v!=null&&(p.pooledCache=null,YE(v)))}function PT(p){return ul(),sc(),Ow(),MT()}function MT(){if(Xs!==5)return!1;var p=jd,v=ig;ig=0;var w=er(yp),L=Oe.T,U=qe.p;try{qe.p=32>w?32:w,Oe.T=null,w=Tp,Tp=null;var H=jd,pe=yp;if(Xs=0,Yl=jd=null,yp=0,(Oi&6)!==0)throw Error(g(331));var Ce=Oi;if(Oi|=4,AT(H.current),dO(H,H.current,pe,w),Oi=Ce,Uv(0,!1),Tr&&typeof Tr.onPostCommitFiberRoot=="function")try{Tr.onPostCommitFiberRoot(jl,H)}catch{}return!0}finally{qe.p=U,Oe.T=L,pO(p,v)}}function Mv(p,v,w){v=sl(w,v),v=Dd(p.stateNode,v,2),p=zl(p,v,2),p!==null&&(wm(p,2),fl(p))}function ca(p,v,w){if(p.tag===3)Mv(p,p,w);else for(;v!==null;){if(v.tag===3){Mv(v,p,w);break}else if(v.tag===1){var L=v.stateNode;if(typeof v.type.getDerivedStateFromError=="function"||typeof L.componentDidCatch=="function"&&(ku===null||!ku.has(L))){p=sl(w,p),w=Z2(2),L=zl(v,w,2),L!==null&&($2(w,L,v,p),wm(L,2),fl(L));break}}v=v.return}}function a_(p,v,w){var L=p.pingCache;if(L===null){L=p.pingCache=new bw;var U=new Set;L.set(v,U)}else U=L.get(v),U===void 0&&(U=new Set,L.set(v,U));U.has(w)||(t_=!0,U.add(w),p=Cp.bind(null,p,v,w),v.then(p,p))}function Cp(p,v,w){var L=p.pingCache;L!==null&&L.delete(v),p.pingedLanes|=p.suspendedLanes&w,p.warmLanes&=~w,oa===p&&(ii&w)===w&&(Ha===4||Ha===3&&(ii&62914560)===ii&&300>jr()-Nv?(Oi&2)===0&&og(p,0):OT|=w,Yf===ii&&(Yf=0)),fl(p)}function cg(p,v){v===0&&(v=wE()),p=Zh(p,v),p!==null&&(wm(p,v),fl(p))}function Nw(p){var v=p.memoizedState,w=0;v!==null&&(w=v.retryLane),cg(p,w)}function gM(p,v){var w=0;switch(p.tag){case 13:var L=p.stateNode,U=p.memoizedState;U!==null&&(w=U.retryLane);break;case 19:L=p.stateNode;break;case 22:L=p.stateNode._retryCache;break;default:throw Error(g(314))}L!==null&&L.delete(v),cg(p,w)}function _M(p,v){return tn(p,v)}var kT=null,Qf=null,kv=!1,xv=!1,xT=!1,Vd=0;function fl(p){p!==Qf&&p.next===null&&(Qf===null?kT=Qf=p:Qf=Qf.next=p),xv=!0,kv||(kv=!0,Pw())}function Uv(p,v){if(!xT&&xv){xT=!0;do for(var w=!1,L=kT;L!==null;){if(p!==0){var U=L.pendingLanes;if(U===0)var H=0;else{var pe=L.suspendedLanes,Ce=L.pingedLanes;H=(1<<31-Za(42|p)+1)-1,H&=U&~(pe&~Ce),H=H&201326741?H&201326741|1:H?H|2:0}H!==0&&(w=!0,jv(L,H))}else H=ii,H=wf(L,L===oa?H:0,L.cancelPendingCommit!==null||L.timeoutHandle!==-1),(H&3)===0||Cm(L,H)||(w=!0,jv(L,H));L=L.next}while(w);xT=!1}}function Lw(){mO()}function mO(){xv=kv=!1;var p=0;Vd!==0&&(SM()&&(p=Vd),Vd=0);for(var v=jr(),w=null,L=kT;L!==null;){var U=L.next,H=Dw(L,v);H===0?(L.next=null,w===null?kT=U:w.next=U,U===null&&(Qf=w)):(w=L,(p!==0||(H&3)!==0)&&(xv=!0)),L=U}Uv(p)}function Dw(p,v){for(var w=p.suspendedLanes,L=p.pingedLanes,U=p.expirationTimes,H=p.pendingLanes&-62914561;0<H;){var pe=31-Za(H),Ce=1<<pe,Fe=U[pe];Fe===-1?((Ce&w)===0||(Ce&L)!==0)&&(U[pe]=Td(Ce,v)):Fe<=v&&(p.expiredLanes|=Ce),H&=~Ce}if(v=oa,w=ii,w=wf(p,p===v?w:0,p.cancelPendingCommit!==null||p.timeoutHandle!==-1),L=p.callbackNode,w===0||p===v&&(Zr===2||Zr===9)||p.cancelPendingCommit!==null)return L!==null&&L!==null&&Yn(L),p.callbackNode=null,p.callbackPriority=0;if((w&3)===0||Cm(p,w)){if(v=w&-w,v===p.callbackPriority)return v;switch(L!==null&&Yn(L),er(w)){case 2:case 8:w=sa;break;case 32:w=ar;break;case 268435456:w=vc;break;default:w=ar}return L=wp.bind(null,p),w=tn(w,L),p.callbackPriority=v,p.callbackNode=w,v}return L!==null&&L!==null&&Yn(L),p.callbackPriority=2,p.callbackNode=null,2}function wp(p,v){if(Xs!==0&&Xs!==5)return p.callbackNode=null,p.callbackPriority=0,null;var w=p.callbackNode;if(PT()&&p.callbackNode!==w)return null;var L=ii;return L=wf(p,p===oa?L:0,p.cancelPendingCommit!==null||p.timeoutHandle!==-1),L===0?null:(ag(p,L,v),Dw(p,jr()),p.callbackNode!=null&&p.callbackNode===w?wp.bind(null,p):null)}function jv(p,v){if(PT())return null;ag(p,v,!0)}function Pw(){TM(function(){(Oi&6)!==0?tn(Ii,Lw):mO()})}function Rp(){return Vd===0&&(Vd=Su()),Vd}function Vv(p){return p==null||typeof p=="symbol"||typeof p=="boolean"?null:typeof p=="function"?p:Ny(""+p)}function UT(p,v){var w=v.ownerDocument.createElement("input");return w.name=v.name,w.value=v.value,p.id&&w.setAttribute("form",p.id),v.parentNode.insertBefore(w,v),p=new FormData(p),w.parentNode.removeChild(w),p}function Mw(p,v,w,L,U){if(v==="submit"&&w&&w.stateNode===U){var H=Vv((U[Tc]||null).action),pe=L.submitter;pe&&(v=(v=pe[Tc]||null)?Vv(v.formAction):pe.getAttribute("formAction"),v!==null&&(H=v,pe=null));var Ce=new $a("action","action",null,L,U);p.push({event:Ce,listeners:[{instance:null,listener:function(){if(L.defaultPrevented){if(Vd!==0){var Fe=pe?UT(U,pe):new FormData(U);q0(w,{pending:!0,data:Fe,method:U.method,action:H},null,Fe)}}else typeof H=="function"&&(Ce.preventDefault(),Fe=pe?UT(U,pe):new FormData(U),q0(w,{pending:!0,data:Fe,method:U.method,action:H},H,Fe))},currentTarget:U}]})}}for(var kw=0;kw<FC.length;kw++){var jT=FC[kw],s_=jT.toLowerCase(),VT=jT[0].toUpperCase()+jT.slice(1);wd(s_,"on"+VT)}wd(By,"onAnimationEnd"),wd(Fy,"onAnimationIteration"),wd(Gy,"onAnimationStart"),wd("dblclick","onDoubleClick"),wd("focusin","onFocus"),wd("focusout","onBlur"),wd(ft,"onTransitionRun"),wd(aM,"onTransitionStart"),wd(ht,"onTransitionCancel"),wd(I2,"onTransitionEnd"),S0("onMouseEnter",["mouseout","mouseover"]),S0("onMouseLeave",["mouseout","mouseover"]),S0("onPointerEnter",["pointerout","pointerover"]),S0("onPointerLeave",["pointerout","pointerover"]),Vl("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Vl("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Vl("onBeforeInput",["compositionend","keypress","textInput","paste"]),Vl("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Vl("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Vl("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var lg="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),BT=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(lg));function FT(p,v){v=(v&4)!==0;for(var w=0;w<p.length;w++){var L=p[w],U=L.event;L=L.listeners;e:{var H=void 0;if(v)for(var pe=L.length-1;0<=pe;pe--){var Ce=L[pe],Fe=Ce.instance,it=Ce.currentTarget;if(Ce=Ce.listener,Fe!==H&&U.isPropagationStopped())break e;H=Ce,U.currentTarget=it;try{H(U)}catch(pt){uT(pt)}U.currentTarget=null,H=Fe}else for(pe=0;pe<L.length;pe++){if(Ce=L[pe],Fe=Ce.instance,it=Ce.currentTarget,Ce=Ce.listener,Fe!==H&&U.isPropagationStopped())break e;H=Ce,U.currentTarget=it;try{H(U)}catch(pt){uT(pt)}U.currentTarget=null,H=Fe}}}}function Pr(p,v){var w=v[Rm];w===void 0&&(w=v[Rm]=new Set);var L=p+"__bubble";w.has(L)||(Bv(v,p,2,!1),w.add(L))}function xw(p,v,w){var L=0;v&&(L|=4),Bv(w,p,L,v)}var Zf="_reactListening"+Math.random().toString(36).slice(2);function $f(p){if(!p[Zf]){p[Zf]=!0,OE.forEach(function(w){w!=="selectionchange"&&(BT.has(w)||xw(w,!1,p),xw(w,!0,p))});var v=p.nodeType===9?p:p.ownerDocument;v===null||v[Zf]||(v[Zf]=!0,xw("selectionchange",!1,v))}}function Bv(p,v,w,L){switch(LO(v)){case 2:var U=MM;break;case 8:U=Pc;break;default:U=QT}w=U.bind(null,v,w,p),U=void 0,!CC||v!=="touchstart"&&v!=="touchmove"&&v!=="wheel"||(U=!0),L?U!==void 0?p.addEventListener(v,w,{capture:!0,passive:U}):p.addEventListener(v,w,!0):U!==void 0?p.addEventListener(v,w,{passive:U}):p.addEventListener(v,w,!1)}function Fv(p,v,w,L,U){var H=L;if((v&1)===0&&(v&2)===0&&L!==null)e:for(;;){if(L===null)return;var pe=L.tag;if(pe===3||pe===4){var Ce=L.stateNode.containerInfo;if(Ce===U)break;if(pe===4)for(pe=L.return;pe!==null;){var Fe=pe.tag;if((Fe===3||Fe===4)&&pe.stateNode.containerInfo===U)return;pe=pe.return}for(;Ce!==null;){if(pe=Im(Ce),pe===null)return;if(Fe=pe.tag,Fe===5||Fe===6||Fe===26||Fe===27){L=H=pe;continue e}Ce=Ce.parentNode}}L=L.return}bC(function(){var it=H,pt=yC(w),xt=[];e:{var ct=A2.get(p);if(ct!==void 0){var dt=$a,tr=p;switch(p){case"keypress":if(PE(w)===0)break e;case"keydown":case"keyup":dt=XP;break;case"focusin":tr="focus",dt=Py;break;case"focusout":tr="blur",dt=Py;break;case"beforeblur":case"afterblur":dt=Py;break;case"click":if(w.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":dt=p2;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":dt=Dy;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":dt=R0;break;case By:case Fy:case Gy:dt=OC;break;case I2:dt=m2;break;case"scroll":case"scrollend":dt=h2;break;case"wheel":dt=pr;break;case"copy":case"cut":case"paste":dt=xE;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":dt=Am;break;case"toggle":case"beforetoggle":dt=$P}var wn=(v&4)!==0,ta=!wn&&(p==="scroll"||p==="scrollend"),nt=wn?ct!==null?ct+"Capture":null:ct;wn=[];for(var Je=it,st;Je!==null;){var Nt=Je;if(st=Nt.stateNode,Nt=Nt.tag,Nt!==5&&Nt!==26&&Nt!==27||st===null||nt===null||(Nt=C0(Je,nt),Nt!=null&&wn.push(dg(Je,Nt,st))),ta)break;Je=Je.return}0<wn.length&&(ct=new dt(ct,tr,null,w,pt),xt.push({event:ct,listeners:wn}))}}if((v&7)===0){e:{if(ct=p==="mouseover"||p==="pointerover",dt=p==="mouseout"||p==="pointerout",ct&&w!==SC&&(tr=w.relatedTarget||w.fromElement)&&(Im(tr)||tr[Rf]))break e;if((dt||ct)&&(ct=pt.window===pt?pt:(ct=pt.ownerDocument)?ct.defaultView||ct.parentWindow:window,dt?(tr=w.relatedTarget||w.toElement,dt=it,tr=tr?Im(tr):null,tr!==null&&(ta=I(tr),wn=tr.tag,tr!==ta||wn!==5&&wn!==27&&wn!==6)&&(tr=null)):(dt=null,tr=it),dt!==tr)){if(wn=p2,Nt="onMouseLeave",nt="onMouseEnter",Je="mouse",(p==="pointerout"||p==="pointerover")&&(wn=Am,Nt="onPointerLeave",nt="onPointerEnter",Je="pointer"),ta=dt==null?ct:AE(dt),st=tr==null?ct:AE(tr),ct=new wn(Nt,Je+"leave",dt,w,pt),ct.target=ta,ct.relatedTarget=st,Nt=null,Im(pt)===it&&(wn=new wn(nt,Je+"enter",tr,w,pt),wn.target=st,wn.relatedTarget=ta,Nt=wn),ta=Nt,dt&&tr)t:{for(wn=dt,nt=tr,Je=0,st=wn;st;st=ug(st))Je++;for(st=0,Nt=nt;Nt;Nt=ug(Nt))st++;for(;0<Je-st;)wn=ug(wn),Je--;for(;0<st-Je;)nt=ug(nt),st--;for(;Je--;){if(wn===nt||nt!==null&&wn===nt.alternate)break t;wn=ug(wn),nt=ug(nt)}wn=null}else wn=null;dt!==null&&Uw(xt,ct,dt,wn,!1),tr!==null&&ta!==null&&Uw(xt,ta,tr,wn,!0)}}e:{if(ct=it?AE(it):window,dt=ct.nodeName&&ct.nodeName.toLowerCase(),dt==="select"||dt==="input"&&ct.type==="file")var sn=v2;else if(E2(ct))if(il)sn=VC;else{sn=jC;var Gr=y2}else dt=ct.nodeName,!dt||dt.toLowerCase()!=="input"||ct.type!=="checkbox"&&ct.type!=="radio"?it&&DE(it.elementType)&&(sn=v2):sn=T2;if(sn&&(sn=sn(p,it))){PC(xt,sn,w,pt);break e}Gr&&Gr(p,ct,it),p==="focusout"&&it&&ct.type==="number"&&it.memoizedProps.value!=null&&vC(ct,"number",ct.value)}switch(Gr=it?AE(it):window,p){case"focusin":(E2(Gr)||Gr.contentEditable==="true")&&(Ls=Gr,BC=it,BE=null);break;case"focusout":BE=BC=Ls=null;break;case"mousedown":jy=!0;break;case"contextmenu":case"mouseup":case"dragend":jy=!1,w2(xt,w,pt);break;case"selectionchange":if(iM)break;case"keydown":case"keyup":w2(xt,w,pt)}var Rn;if(VE)e:{switch(p){case"compositionstart":var Vn="onCompositionStart";break e;case"compositionend":Vn="onCompositionEnd";break e;case"compositionupdate":Vn="onCompositionUpdate";break e}Vn=void 0}else Lm?_2(p,w)&&(Vn="onCompositionEnd"):p==="keydown"&&w.keyCode===229&&(Vn="onCompositionStart");Vn&&(g2&&w.locale!=="ko"&&(Lm||Vn!=="onCompositionStart"?Vn==="onCompositionEnd"&&Lm&&(Rn=u2()):(Bl=pt,wC="value"in Bl?Bl.value:Bl.textContent,Lm=!0)),Gr=Gv(it,Vn),0<Gr.length&&(Vn=new My(Vn,p,null,w,pt),xt.push({event:Vn,listeners:Gr}),Rn?Vn.data=Rn:(Rn=DC(w),Rn!==null&&(Vn.data=Rn)))),(Rn=tM?Df(p,w):Yh(p,w))&&(Vn=Gv(it,"onBeforeInput"),0<Vn.length&&(Gr=new My("onBeforeInput","beforeinput",null,w,pt),xt.push({event:Gr,listeners:Vn}),Gr.data=Rn)),Mw(xt,p,it,w,pt)}FT(xt,v)})}function dg(p,v,w){return{instance:p,listener:v,currentTarget:w}}function Gv(p,v){for(var w=v+"Capture",L=[];p!==null;){var U=p,H=U.stateNode;if(U=U.tag,U!==5&&U!==26&&U!==27||H===null||(U=C0(p,w),U!=null&&L.unshift(dg(p,U,H)),U=C0(p,v),U!=null&&L.push(dg(p,U,H))),p.tag===3)return L;p=p.return}return[]}function ug(p){if(p===null)return null;do p=p.return;while(p&&p.tag!==5&&p.tag!==27);return p||null}function Uw(p,v,w,L,U){for(var H=v._reactName,pe=[];w!==null&&w!==L;){var Ce=w,Fe=Ce.alternate,it=Ce.stateNode;if(Ce=Ce.tag,Fe!==null&&Fe===L)break;Ce!==5&&Ce!==26&&Ce!==27||it===null||(Fe=it,U?(it=C0(w,H),it!=null&&pe.unshift(dg(w,it,Fe))):U||(it=C0(w,H),it!=null&&pe.push(dg(w,it,Fe)))),w=w.return}pe.length!==0&&p.push({event:v,listeners:pe})}var EM=/\r\n?/g,eh=/\u0000|\uFFFD/g;function fg(p){return(typeof p=="string"?p:""+p).replace(EM,`
`).replace(eh,"")}function GT(p,v){return v=fg(v),fg(p)===v}function zv(){}function Ji(p,v,w,L,U,H){switch(w){case"children":typeof L=="string"?v==="body"||v==="textarea"&&L===""||Of(p,L):(typeof L=="number"||typeof L=="bigint")&&v!=="body"&&Of(p,""+L);break;case"className":by(p,"class",L);break;case"tabIndex":by(p,"tabindex",L);break;case"dir":case"role":case"viewBox":case"width":case"height":by(p,w,L);break;case"style":Oy(p,L,H);break;case"data":if(v!=="object"){by(p,"data",L);break}case"src":case"href":if(L===""&&(v!=="a"||w!=="href")){p.removeAttribute(w);break}if(L==null||typeof L=="function"||typeof L=="symbol"||typeof L=="boolean"){p.removeAttribute(w);break}L=Ny(""+L),p.setAttribute(w,L);break;case"action":case"formAction":if(typeof L=="function"){p.setAttribute(w,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof H=="function"&&(w==="formAction"?(v!=="input"&&Ji(p,v,"name",U.name,U,null),Ji(p,v,"formEncType",U.formEncType,U,null),Ji(p,v,"formMethod",U.formMethod,U,null),Ji(p,v,"formTarget",U.formTarget,U,null)):(Ji(p,v,"encType",U.encType,U,null),Ji(p,v,"method",U.method,U,null),Ji(p,v,"target",U.target,U,null)));if(L==null||typeof L=="symbol"||typeof L=="boolean"){p.removeAttribute(w);break}L=Ny(""+L),p.setAttribute(w,L);break;case"onClick":L!=null&&(p.onclick=zv);break;case"onScroll":L!=null&&Pr("scroll",p);break;case"onScrollEnd":L!=null&&Pr("scrollend",p);break;case"dangerouslySetInnerHTML":if(L!=null){if(typeof L!="object"||!("__html"in L))throw Error(g(61));if(w=L.__html,w!=null){if(U.children!=null)throw Error(g(60));p.innerHTML=w}}break;case"multiple":p.multiple=L&&typeof L!="function"&&typeof L!="symbol";break;case"muted":p.muted=L&&typeof L!="function"&&typeof L!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(L==null||typeof L=="function"||typeof L=="boolean"||typeof L=="symbol"){p.removeAttribute("xlink:href");break}w=Ny(""+L),p.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",w);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":L!=null&&typeof L!="function"&&typeof L!="symbol"?p.setAttribute(w,""+L):p.removeAttribute(w);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":L&&typeof L!="function"&&typeof L!="symbol"?p.setAttribute(w,""):p.removeAttribute(w);break;case"capture":case"download":L===!0?p.setAttribute(w,""):L!==!1&&L!=null&&typeof L!="function"&&typeof L!="symbol"?p.setAttribute(w,L):p.removeAttribute(w);break;case"cols":case"rows":case"size":case"span":L!=null&&typeof L!="function"&&typeof L!="symbol"&&!isNaN(L)&&1<=L?p.setAttribute(w,L):p.removeAttribute(w);break;case"rowSpan":case"start":L==null||typeof L=="function"||typeof L=="symbol"||isNaN(L)?p.removeAttribute(w):p.setAttribute(w,L);break;case"popover":Pr("beforetoggle",p),Pr("toggle",p),Ga(p,"popover",L);break;case"xlinkActuate":If(p,"http://www.w3.org/1999/xlink","xlink:actuate",L);break;case"xlinkArcrole":If(p,"http://www.w3.org/1999/xlink","xlink:arcrole",L);break;case"xlinkRole":If(p,"http://www.w3.org/1999/xlink","xlink:role",L);break;case"xlinkShow":If(p,"http://www.w3.org/1999/xlink","xlink:show",L);break;case"xlinkTitle":If(p,"http://www.w3.org/1999/xlink","xlink:title",L);break;case"xlinkType":If(p,"http://www.w3.org/1999/xlink","xlink:type",L);break;case"xmlBase":If(p,"http://www.w3.org/XML/1998/namespace","xml:base",L);break;case"xmlLang":If(p,"http://www.w3.org/XML/1998/namespace","xml:lang",L);break;case"xmlSpace":If(p,"http://www.w3.org/XML/1998/namespace","xml:space",L);break;case"is":Ga(p,"is",L);break;case"innerText":case"textContent":break;default:(!(2<w.length)||w[0]!=="o"&&w[0]!=="O"||w[1]!=="n"&&w[1]!=="N")&&(w=c2.get(w)||w,Ga(p,w,L))}}function jw(p,v,w,L,U,H){switch(w){case"style":Oy(p,L,H);break;case"dangerouslySetInnerHTML":if(L!=null){if(typeof L!="object"||!("__html"in L))throw Error(g(61));if(w=L.__html,w!=null){if(U.children!=null)throw Error(g(60));p.innerHTML=w}}break;case"children":typeof L=="string"?Of(p,L):(typeof L=="number"||typeof L=="bigint")&&Of(p,""+L);break;case"onScroll":L!=null&&Pr("scroll",p);break;case"onScrollEnd":L!=null&&Pr("scrollend",p);break;case"onClick":L!=null&&(p.onclick=zv);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!zh.hasOwnProperty(w))e:{if(w[0]==="o"&&w[1]==="n"&&(U=w.endsWith("Capture"),v=w.slice(2,U?w.length-7:void 0),H=p[Tc]||null,H=H!=null?H[w]:null,typeof H=="function"&&p.removeEventListener(v,H,U),typeof L=="function")){typeof H!="function"&&H!==null&&(w in p?p[w]=null:p.hasAttribute(w)&&p.removeAttribute(w)),p.addEventListener(v,L,U);break e}w in p?p[w]=L:L===!0?p.setAttribute(w,""):Ga(p,w,L)}}}function Qs(p,v,w){switch(v){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Pr("error",p),Pr("load",p);var L=!1,U=!1,H;for(H in w)if(w.hasOwnProperty(H)){var pe=w[H];if(pe!=null)switch(H){case"src":L=!0;break;case"srcSet":U=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(g(137,v));default:Ji(p,v,H,pe,w,null)}}U&&Ji(p,v,"srcSet",w.srcSet,w,null),L&&Ji(p,v,"src",w.src,w,null);return;case"input":Pr("invalid",p);var Ce=H=pe=U=null,Fe=null,it=null;for(L in w)if(w.hasOwnProperty(L)){var pt=w[L];if(pt!=null)switch(L){case"name":U=pt;break;case"type":pe=pt;break;case"checked":Fe=pt;break;case"defaultChecked":it=pt;break;case"value":H=pt;break;case"defaultValue":Ce=pt;break;case"children":case"dangerouslySetInnerHTML":if(pt!=null)throw Error(g(137,v));break;default:Ji(p,v,L,pt,w,null)}}s2(p,H,Ce,Fe,it,pe,U,!1),Ai(p);return;case"select":Pr("invalid",p),L=pe=H=null;for(U in w)if(w.hasOwnProperty(U)&&(Ce=w[U],Ce!=null))switch(U){case"value":H=Ce;break;case"defaultValue":pe=Ce;break;case"multiple":L=Ce;default:Ji(p,v,U,Ce,w,null)}v=H,w=pe,p.multiple=!!L,v!=null?y0(p,!!L,v,!1):w!=null&&y0(p,!!L,w,!0);return;case"textarea":Pr("invalid",p),H=U=L=null;for(pe in w)if(w.hasOwnProperty(pe)&&(Ce=w[pe],Ce!=null))switch(pe){case"value":L=Ce;break;case"defaultValue":U=Ce;break;case"children":H=Ce;break;case"dangerouslySetInnerHTML":if(Ce!=null)throw Error(g(91));break;default:Ji(p,v,pe,Ce,w,null)}LE(p,L,U,H),Ai(p);return;case"option":for(Fe in w)if(w.hasOwnProperty(Fe)&&(L=w[Fe],L!=null))switch(Fe){case"selected":p.selected=L&&typeof L!="function"&&typeof L!="symbol";break;default:Ji(p,v,Fe,L,w,null)}return;case"dialog":Pr("beforetoggle",p),Pr("toggle",p),Pr("cancel",p),Pr("close",p);break;case"iframe":case"object":Pr("load",p);break;case"video":case"audio":for(L=0;L<lg.length;L++)Pr(lg[L],p);break;case"image":Pr("error",p),Pr("load",p);break;case"details":Pr("toggle",p);break;case"embed":case"source":case"link":Pr("error",p),Pr("load",p);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(it in w)if(w.hasOwnProperty(it)&&(L=w[it],L!=null))switch(it){case"children":case"dangerouslySetInnerHTML":throw Error(g(137,v));default:Ji(p,v,it,L,w,null)}return;default:if(DE(v)){for(pt in w)w.hasOwnProperty(pt)&&(L=w[pt],L!==void 0&&jw(p,v,pt,L,w,void 0));return}}for(Ce in w)w.hasOwnProperty(Ce)&&(L=w[Ce],L!=null&&Ji(p,v,Ce,L,w,null))}function vM(p,v,w,L){switch(v){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var U=null,H=null,pe=null,Ce=null,Fe=null,it=null,pt=null;for(dt in w){var xt=w[dt];if(w.hasOwnProperty(dt)&&xt!=null)switch(dt){case"checked":break;case"value":break;case"defaultValue":Fe=xt;default:L.hasOwnProperty(dt)||Ji(p,v,dt,null,L,xt)}}for(var ct in L){var dt=L[ct];if(xt=w[ct],L.hasOwnProperty(ct)&&(dt!=null||xt!=null))switch(ct){case"type":H=dt;break;case"name":U=dt;break;case"checked":it=dt;break;case"defaultChecked":pt=dt;break;case"value":pe=dt;break;case"defaultValue":Ce=dt;break;case"children":case"dangerouslySetInnerHTML":if(dt!=null)throw Error(g(137,v));break;default:dt!==xt&&Ji(p,v,ct,dt,L,xt)}}EC(p,pe,Ce,Fe,it,pt,H,U);return;case"select":dt=pe=Ce=ct=null;for(H in w)if(Fe=w[H],w.hasOwnProperty(H)&&Fe!=null)switch(H){case"value":break;case"multiple":dt=Fe;default:L.hasOwnProperty(H)||Ji(p,v,H,null,L,Fe)}for(U in L)if(H=L[U],Fe=w[U],L.hasOwnProperty(U)&&(H!=null||Fe!=null))switch(U){case"value":ct=H;break;case"defaultValue":Ce=H;break;case"multiple":pe=H;default:H!==Fe&&Ji(p,v,U,H,L,Fe)}v=Ce,w=pe,L=dt,ct!=null?y0(p,!!w,ct,!1):!!L!=!!w&&(v!=null?y0(p,!!w,v,!0):y0(p,!!w,w?[]:"",!1));return;case"textarea":dt=ct=null;for(Ce in w)if(U=w[Ce],w.hasOwnProperty(Ce)&&U!=null&&!L.hasOwnProperty(Ce))switch(Ce){case"value":break;case"children":break;default:Ji(p,v,Ce,null,L,U)}for(pe in L)if(U=L[pe],H=w[pe],L.hasOwnProperty(pe)&&(U!=null||H!=null))switch(pe){case"value":ct=U;break;case"defaultValue":dt=U;break;case"children":break;case"dangerouslySetInnerHTML":if(U!=null)throw Error(g(91));break;default:U!==H&&Ji(p,v,pe,U,L,H)}o2(p,ct,dt);return;case"option":for(var tr in w)if(ct=w[tr],w.hasOwnProperty(tr)&&ct!=null&&!L.hasOwnProperty(tr))switch(tr){case"selected":p.selected=!1;break;default:Ji(p,v,tr,null,L,ct)}for(Fe in L)if(ct=L[Fe],dt=w[Fe],L.hasOwnProperty(Fe)&&ct!==dt&&(ct!=null||dt!=null))switch(Fe){case"selected":p.selected=ct&&typeof ct!="function"&&typeof ct!="symbol";break;default:Ji(p,v,Fe,ct,L,dt)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var wn in w)ct=w[wn],w.hasOwnProperty(wn)&&ct!=null&&!L.hasOwnProperty(wn)&&Ji(p,v,wn,null,L,ct);for(it in L)if(ct=L[it],dt=w[it],L.hasOwnProperty(it)&&ct!==dt&&(ct!=null||dt!=null))switch(it){case"children":case"dangerouslySetInnerHTML":if(ct!=null)throw Error(g(137,v));break;default:Ji(p,v,it,ct,L,dt)}return;default:if(DE(v)){for(var ta in w)ct=w[ta],w.hasOwnProperty(ta)&&ct!==void 0&&!L.hasOwnProperty(ta)&&jw(p,v,ta,void 0,L,ct);for(pt in L)ct=L[pt],dt=w[pt],!L.hasOwnProperty(pt)||ct===dt||ct===void 0&&dt===void 0||jw(p,v,pt,ct,L,dt);return}}for(var nt in w)ct=w[nt],w.hasOwnProperty(nt)&&ct!=null&&!L.hasOwnProperty(nt)&&Ji(p,v,nt,null,L,ct);for(xt in L)ct=L[xt],dt=w[xt],!L.hasOwnProperty(xt)||ct===dt||ct==null&&dt==null||Ji(p,v,xt,ct,L,dt)}var Vw=null,o_=null;function zT(p){return p.nodeType===9?p:p.ownerDocument}function gO(p){switch(p){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function _O(p,v){if(p===0)switch(v){case"svg":return 1;case"math":return 2;default:return 0}return p===1&&v==="foreignObject"?0:p}function Bw(p,v){return p==="textarea"||p==="noscript"||typeof v.children=="string"||typeof v.children=="number"||typeof v.children=="bigint"||typeof v.dangerouslySetInnerHTML=="object"&&v.dangerouslySetInnerHTML!==null&&v.dangerouslySetInnerHTML.__html!=null}var Fw=null;function SM(){var p=window.event;return p&&p.type==="popstate"?p===Fw?!1:(Fw=p,!0):(Fw=null,!1)}var EO=typeof setTimeout=="function"?setTimeout:void 0,yM=typeof clearTimeout=="function"?clearTimeout:void 0,Gw=typeof Promise=="function"?Promise:void 0,TM=typeof queueMicrotask=="function"?queueMicrotask:typeof Gw<"u"?function(p){return Gw.resolve(null).then(p).catch(bM)}:EO;function bM(p){setTimeout(function(){throw p})}function Ip(p){return p==="head"}function vO(p,v){var w=v,L=0,U=0;do{var H=w.nextSibling;if(p.removeChild(w),H&&H.nodeType===8)if(w=H.data,w==="/$"){if(0<L&&8>L){w=L;var pe=p.ownerDocument;if(w&1&&Hv(pe.documentElement),w&2&&Hv(pe.body),w&4)for(w=pe.head,Hv(w),pe=w.firstChild;pe;){var Ce=pe.nextSibling,Fe=pe.nodeName;pe[E0]||Fe==="SCRIPT"||Fe==="STYLE"||Fe==="LINK"&&pe.rel.toLowerCase()==="stylesheet"||w.removeChild(pe),pe=Ce}}if(U===0){p.removeChild(H),Mc(v);return}U--}else w==="$"||w==="$?"||w==="$!"?U++:L=w.charCodeAt(0)-48;else L=0;w=H}while(w);Mc(v)}function zw(p){var v=p.firstChild;for(v&&v.nodeType===10&&(v=v.nextSibling);v;){var w=v;switch(v=v.nextSibling,w.nodeName){case"HTML":case"HEAD":case"BODY":zw(w),IE(w);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(w.rel.toLowerCase()==="stylesheet")continue}p.removeChild(w)}}function CM(p,v,w,L){for(;p.nodeType===1;){var U=w;if(p.nodeName.toLowerCase()!==v.toLowerCase()){if(!L&&(p.nodeName!=="INPUT"||p.type!=="hidden"))break}else if(L){if(!p[E0])switch(v){case"meta":if(!p.hasAttribute("itemprop"))break;return p;case"link":if(H=p.getAttribute("rel"),H==="stylesheet"&&p.hasAttribute("data-precedence"))break;if(H!==U.rel||p.getAttribute("href")!==(U.href==null||U.href===""?null:U.href)||p.getAttribute("crossorigin")!==(U.crossOrigin==null?null:U.crossOrigin)||p.getAttribute("title")!==(U.title==null?null:U.title))break;return p;case"style":if(p.hasAttribute("data-precedence"))break;return p;case"script":if(H=p.getAttribute("src"),(H!==(U.src==null?null:U.src)||p.getAttribute("type")!==(U.type==null?null:U.type)||p.getAttribute("crossorigin")!==(U.crossOrigin==null?null:U.crossOrigin))&&H&&p.hasAttribute("async")&&!p.hasAttribute("itemprop"))break;return p;default:return p}}else if(v==="input"&&p.type==="hidden"){var H=U.name==null?null:""+U.name;if(U.type==="hidden"&&p.getAttribute("name")===H)return p}else return p;if(p=Bd(p.nextSibling),p===null)break}return null}function wM(p,v,w){if(v==="")return null;for(;p.nodeType!==3;)if((p.nodeType!==1||p.nodeName!=="INPUT"||p.type!=="hidden")&&!w||(p=Bd(p.nextSibling),p===null))return null;return p}function HT(p){return p.data==="$!"||p.data==="$?"&&p.ownerDocument.readyState==="complete"}function RM(p,v){var w=p.ownerDocument;if(p.data!=="$?"||w.readyState==="complete")v();else{var L=function(){v(),w.removeEventListener("DOMContentLoaded",L)};w.addEventListener("DOMContentLoaded",L),p._reactRetry=L}}function Bd(p){for(;p!=null;p=p.nextSibling){var v=p.nodeType;if(v===1||v===3)break;if(v===8){if(v=p.data,v==="$"||v==="$!"||v==="$?"||v==="F!"||v==="F")break;if(v==="/$")return null}}return p}var Hw=null;function SO(p){p=p.previousSibling;for(var v=0;p;){if(p.nodeType===8){var w=p.data;if(w==="$"||w==="$!"||w==="$?"){if(v===0)return p;v--}else w==="/$"&&v++}p=p.previousSibling}return null}function yO(p,v,w){switch(v=zT(w),p){case"html":if(p=v.documentElement,!p)throw Error(g(452));return p;case"head":if(p=v.head,!p)throw Error(g(453));return p;case"body":if(p=v.body,!p)throw Error(g(454));return p;default:throw Error(g(451))}}function Hv(p){for(var v=p.attributes;v.length;)p.removeAttributeNode(v[0]);IE(p)}var Kl=new Map,TO=new Set;function WT(p){return typeof p.getRootNode=="function"?p.getRootNode():p.nodeType===9?p:p.ownerDocument}var Vu=qe.d;qe.d={f:IM,r:Ww,D:AM,C:OM,L:CO,m:wO,X:NM,S:Yw,M:LM};function IM(){var p=Vu.f(),v=sg();return p||v}function Ww(p){var v=v0(p);v!==null&&v.tag===5&&v.type==="form"?sv(v):Vu.r(p)}var c_=typeof document>"u"?null:document;function bO(p,v,w){var L=c_;if(L&&typeof v=="string"&&v){var U=rl(v);U='link[rel="'+p+'"][href="'+U+'"]',typeof w=="string"&&(U+='[crossorigin="'+w+'"]'),TO.has(U)||(TO.add(U),p={rel:p,crossOrigin:w,href:v},L.querySelector(U)===null&&(v=L.createElement("link"),Qs(v,"link",p),cs(v),L.head.appendChild(v)))}}function AM(p){Vu.D(p),bO("dns-prefetch",p,null)}function OM(p,v){Vu.C(p,v),bO("preconnect",p,v)}function CO(p,v,w){Vu.L(p,v,w);var L=c_;if(L&&p&&v){var U='link[rel="preload"][as="'+rl(v)+'"]';v==="image"&&w&&w.imageSrcSet?(U+='[imagesrcset="'+rl(w.imageSrcSet)+'"]',typeof w.imageSizes=="string"&&(U+='[imagesizes="'+rl(w.imageSizes)+'"]')):U+='[href="'+rl(p)+'"]';var H=U;switch(v){case"style":H=l_(p);break;case"script":H=Ap(p)}Kl.has(H)||(p=V({rel:"preload",href:v==="image"&&w&&w.imageSrcSet?void 0:p,as:v},w),Kl.set(H,p),L.querySelector(U)!==null||v==="style"&&L.querySelector(hg(H))||v==="script"&&L.querySelector(Wv(H))||(v=L.createElement("link"),Qs(v,"link",p),cs(v),L.head.appendChild(v)))}}function wO(p,v){Vu.m(p,v);var w=c_;if(w&&p){var L=v&&typeof v.as=="string"?v.as:"script",U='link[rel="modulepreload"][as="'+rl(L)+'"][href="'+rl(p)+'"]',H=U;switch(L){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":H=Ap(p)}if(!Kl.has(H)&&(p=V({rel:"modulepreload",href:p},v),Kl.set(H,p),w.querySelector(U)===null)){switch(L){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(w.querySelector(Wv(H)))return}L=w.createElement("link"),Qs(L,"link",p),cs(L),w.head.appendChild(L)}}}function Yw(p,v,w){Vu.S(p,v,w);var L=c_;if(L&&p){var U=Gh(L).hoistableStyles,H=l_(p);v=v||"default";var pe=U.get(H);if(!pe){var Ce={loading:0,preload:null};if(pe=L.querySelector(hg(H)))Ce.loading=5;else{p=V({rel:"stylesheet",href:p,"data-precedence":v},w),(w=Kl.get(H))&&qw(p,w);var Fe=pe=L.createElement("link");cs(Fe),Qs(Fe,"link",p),Fe._p=new Promise(function(it,pt){Fe.onload=it,Fe.onerror=pt}),Fe.addEventListener("load",function(){Ce.loading|=1}),Fe.addEventListener("error",function(){Ce.loading|=2}),Ce.loading|=4,Yv(pe,v,L)}pe={type:"stylesheet",instance:pe,count:1,state:Ce},U.set(H,pe)}}}function NM(p,v){Vu.X(p,v);var w=c_;if(w&&p){var L=Gh(w).hoistableScripts,U=Ap(p),H=L.get(U);H||(H=w.querySelector(Wv(U)),H||(p=V({src:p,async:!0},v),(v=Kl.get(U))&&qT(p,v),H=w.createElement("script"),cs(H),Qs(H,"link",p),w.head.appendChild(H)),H={type:"script",instance:H,count:1,state:null},L.set(U,H))}}function LM(p,v){Vu.M(p,v);var w=c_;if(w&&p){var L=Gh(w).hoistableScripts,U=Ap(p),H=L.get(U);H||(H=w.querySelector(Wv(U)),H||(p=V({src:p,async:!0,type:"module"},v),(v=Kl.get(U))&&qT(p,v),H=w.createElement("script"),cs(H),Qs(H,"link",p),w.head.appendChild(H)),H={type:"script",instance:H,count:1,state:null},L.set(U,H))}}function RO(p,v,w,L){var U=(U=Gt.current)?WT(U):null;if(!U)throw Error(g(446));switch(p){case"meta":case"title":return null;case"style":return typeof w.precedence=="string"&&typeof w.href=="string"?(v=l_(w.href),w=Gh(U).hoistableStyles,L=w.get(v),L||(L={type:"style",instance:null,count:0,state:null},w.set(v,L)),L):{type:"void",instance:null,count:0,state:null};case"link":if(w.rel==="stylesheet"&&typeof w.href=="string"&&typeof w.precedence=="string"){p=l_(w.href);var H=Gh(U).hoistableStyles,pe=H.get(p);if(pe||(U=U.ownerDocument||U,pe={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},H.set(p,pe),(H=U.querySelector(hg(p)))&&!H._p&&(pe.instance=H,pe.state.loading=5),Kl.has(p)||(w={rel:"preload",as:"style",href:w.href,crossOrigin:w.crossOrigin,integrity:w.integrity,media:w.media,hrefLang:w.hrefLang,referrerPolicy:w.referrerPolicy},Kl.set(p,w),H||Kw(U,p,w,pe.state))),v&&L===null)throw Error(g(528,""));return pe}if(v&&L!==null)throw Error(g(529,""));return null;case"script":return v=w.async,w=w.src,typeof w=="string"&&v&&typeof v!="function"&&typeof v!="symbol"?(v=Ap(w),w=Gh(U).hoistableScripts,L=w.get(v),L||(L={type:"script",instance:null,count:0,state:null},w.set(v,L)),L):{type:"void",instance:null,count:0,state:null};default:throw Error(g(444,p))}}function l_(p){return'href="'+rl(p)+'"'}function hg(p){return'link[rel="stylesheet"]['+p+"]"}function YT(p){return V({},p,{"data-precedence":p.precedence,precedence:null})}function Kw(p,v,w,L){p.querySelector('link[rel="preload"][as="style"]['+v+"]")?L.loading=1:(v=p.createElement("link"),L.preload=v,v.addEventListener("load",function(){return L.loading|=1}),v.addEventListener("error",function(){return L.loading|=2}),Qs(v,"link",w),cs(v),p.head.appendChild(v))}function Ap(p){return'[src="'+rl(p)+'"]'}function Wv(p){return"script[async]"+p}function KT(p,v,w){if(v.count++,v.instance===null)switch(v.type){case"style":var L=p.querySelector('style[data-href~="'+rl(w.href)+'"]');if(L)return v.instance=L,cs(L),L;var U=V({},w,{"data-href":w.href,"data-precedence":w.precedence,href:null,precedence:null});return L=(p.ownerDocument||p).createElement("style"),cs(L),Qs(L,"style",U),Yv(L,w.precedence,p),v.instance=L;case"stylesheet":U=l_(w.href);var H=p.querySelector(hg(U));if(H)return v.state.loading|=4,v.instance=H,cs(H),H;L=YT(w),(U=Kl.get(U))&&qw(L,U),H=(p.ownerDocument||p).createElement("link"),cs(H);var pe=H;return pe._p=new Promise(function(Ce,Fe){pe.onload=Ce,pe.onerror=Fe}),Qs(H,"link",L),v.state.loading|=4,Yv(H,w.precedence,p),v.instance=H;case"script":return H=Ap(w.src),(U=p.querySelector(Wv(H)))?(v.instance=U,cs(U),U):(L=w,(U=Kl.get(H))&&(L=V({},w),qT(L,U)),p=p.ownerDocument||p,U=p.createElement("script"),cs(U),Qs(U,"link",L),p.head.appendChild(U),v.instance=U);case"void":return null;default:throw Error(g(443,v.type))}else v.type==="stylesheet"&&(v.state.loading&4)===0&&(L=v.instance,v.state.loading|=4,Yv(L,w.precedence,p));return v.instance}function Yv(p,v,w){for(var L=w.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),U=L.length?L[L.length-1]:null,H=U,pe=0;pe<L.length;pe++){var Ce=L[pe];if(Ce.dataset.precedence===v)H=Ce;else if(H!==U)break}H?H.parentNode.insertBefore(p,H.nextSibling):(v=w.nodeType===9?w.head:w,v.insertBefore(p,v.firstChild))}function qw(p,v){p.crossOrigin==null&&(p.crossOrigin=v.crossOrigin),p.referrerPolicy==null&&(p.referrerPolicy=v.referrerPolicy),p.title==null&&(p.title=v.title)}function qT(p,v){p.crossOrigin==null&&(p.crossOrigin=v.crossOrigin),p.referrerPolicy==null&&(p.referrerPolicy=v.referrerPolicy),p.integrity==null&&(p.integrity=v.integrity)}var Kv=null;function Jw(p,v,w){if(Kv===null){var L=new Map,U=Kv=new Map;U.set(w,L)}else U=Kv,L=U.get(w),L||(L=new Map,U.set(w,L));if(L.has(p))return L;for(L.set(p,null),w=w.getElementsByTagName(p),U=0;U<w.length;U++){var H=w[U];if(!(H[E0]||H[$i]||p==="link"&&H.getAttribute("rel")==="stylesheet")&&H.namespaceURI!=="http://www.w3.org/2000/svg"){var pe=H.getAttribute(v)||"";pe=p+pe;var Ce=L.get(pe);Ce?Ce.push(H):L.set(pe,[H])}}return L}function IO(p,v,w){p=p.ownerDocument||p,p.head.insertBefore(w,v==="title"?p.querySelector("head > title"):null)}function Xw(p,v,w){if(w===1||v.itemProp!=null)return!1;switch(p){case"meta":case"title":return!0;case"style":if(typeof v.precedence!="string"||typeof v.href!="string"||v.href==="")break;return!0;case"link":if(typeof v.rel!="string"||typeof v.href!="string"||v.href===""||v.onLoad||v.onError)break;switch(v.rel){case"stylesheet":return p=v.disabled,typeof v.precedence=="string"&&p==null;default:return!0}case"script":if(v.async&&typeof v.async!="function"&&typeof v.async!="symbol"&&!v.onLoad&&!v.onError&&v.src&&typeof v.src=="string")return!0}return!1}function AO(p){return!(p.type==="stylesheet"&&(p.state.loading&3)===0)}var qv=null;function DM(){}function PM(p,v,w){if(qv===null)throw Error(g(475));var L=qv;if(v.type==="stylesheet"&&(typeof w.media!="string"||matchMedia(w.media).matches!==!1)&&(v.state.loading&4)===0){if(v.instance===null){var U=l_(w.href),H=p.querySelector(hg(U));if(H){p=H._p,p!==null&&typeof p=="object"&&typeof p.then=="function"&&(L.count++,L=Jv.bind(L),p.then(L,L)),v.state.loading|=4,v.instance=H,cs(H);return}H=p.ownerDocument||p,w=YT(w),(U=Kl.get(U))&&qw(w,U),H=H.createElement("link"),cs(H);var pe=H;pe._p=new Promise(function(Ce,Fe){pe.onload=Ce,pe.onerror=Fe}),Qs(H,"link",w),v.instance=H}L.stylesheets===null&&(L.stylesheets=new Map),L.stylesheets.set(v,p),(p=v.state.preload)&&(v.state.loading&3)===0&&(L.count++,v=Jv.bind(L),p.addEventListener("load",v),p.addEventListener("error",v))}}function Qw(){if(qv===null)throw Error(g(475));var p=qv;return p.stylesheets&&p.count===0&&d_(p,p.stylesheets),0<p.count?function(v){var w=setTimeout(function(){if(p.stylesheets&&d_(p,p.stylesheets),p.unsuspend){var L=p.unsuspend;p.unsuspend=null,L()}},6e4);return p.unsuspend=v,function(){p.unsuspend=null,clearTimeout(w)}}:null}function Jv(){if(this.count--,this.count===0){if(this.stylesheets)d_(this,this.stylesheets);else if(this.unsuspend){var p=this.unsuspend;this.unsuspend=null,p()}}}var pg=null;function d_(p,v){p.stylesheets=null,p.unsuspend!==null&&(p.count++,pg=new Map,v.forEach(Zw,p),pg=null,Jv.call(p))}function Zw(p,v){if(!(v.state.loading&4)){var w=pg.get(p);if(w)var L=w.get(null);else{w=new Map,pg.set(p,w);for(var U=p.querySelectorAll("link[data-precedence],style[data-precedence]"),H=0;H<U.length;H++){var pe=U[H];(pe.nodeName==="LINK"||pe.getAttribute("media")!=="not all")&&(w.set(pe.dataset.precedence,pe),L=pe)}L&&w.set(null,L)}U=v.instance,pe=U.getAttribute("data-precedence"),H=w.get(pe)||L,H===L&&w.set(null,U),w.set(pe,U),this.count++,L=Jv.bind(this),U.addEventListener("load",L),U.addEventListener("error",L),H?H.parentNode.insertBefore(U,H.nextSibling):(p=p.nodeType===9?p.head:p,p.insertBefore(U,p.firstChild)),v.state.loading|=4}}var u_={$$typeof:ue,Provider:null,Consumer:null,_currentValue:lt,_currentValue2:lt,_threadCount:0};function Et(p,v,w,L,U,H,pe,Ce){this.tag=1,this.containerInfo=p,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=RE(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=RE(0),this.hiddenUpdates=RE(null),this.identifierPrefix=L,this.onUncaughtError=U,this.onCaughtError=H,this.onRecoverableError=pe,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Ce,this.incompleteTransitions=new Map}function OO(p,v,w,L,U,H,pe,Ce,Fe,it,pt,xt){return p=new Et(p,v,w,pe,Ce,Fe,it,xt),v=1,H===!0&&(v|=24),H=go(3,null,null,v),p.current=H,H.stateNode=p,v=L0(),v.refCount++,p.pooledCache=v,v.refCount++,H.memoizedState={element:L,isDehydrated:w,cache:v},M0(H),p}function $w(p){return p?(p=Ds,p):Ds}function eR(p,v,w,L,U,H){U=$w(U),L.context===null?L.context=U:L.pendingContext=U,L=Vf(v),L.payload={element:w},H=H===void 0?null:H,H!==null&&(L.callback=H),w=zl(p,L,v),w!==null&&(Dc(w,p,v),Bf(w,p,v))}function NO(p,v){if(p=p.memoizedState,p!==null&&p.dehydrated!==null){var w=p.retryLane;p.retryLane=w!==0&&w<v?w:v}}function tR(p,v){NO(p,v),(p=p.alternate)&&NO(p,v)}function JT(p){if(p.tag===13){var v=Zh(p,67108864);v!==null&&Dc(v,p,67108864),tR(p,67108864)}}var XT=!0;function MM(p,v,w,L){var U=Oe.T;Oe.T=null;var H=qe.p;try{qe.p=2,QT(p,v,w,L)}finally{qe.p=H,Oe.T=U}}function Pc(p,v,w,L){var U=Oe.T;Oe.T=null;var H=qe.p;try{qe.p=8,QT(p,v,w,L)}finally{qe.p=H,Oe.T=U}}function QT(p,v,w,L){if(XT){var U=Xv(L);if(U===null)Fv(p,v,L,mg,w),Zv(p,L);else if(DO(U,p,v,w,L))L.stopPropagation();else if(Zv(p,L),v&4&&-1<oc.indexOf(p)){for(;U!==null;){var H=v0(U);if(H!==null)switch(H.tag){case 3:if(H=H.stateNode,H.current.memoizedState.isDehydrated){var pe=ko(H.pendingLanes);if(pe!==0){var Ce=H;for(Ce.pendingLanes|=2,Ce.entangledLanes|=2;pe;){var Fe=1<<31-Za(pe);Ce.entanglements[1]|=Fe,pe&=~Fe}fl(H),(Oi&6)===0&&(Sp=jr()+500,Uv(0))}}break;case 13:Ce=Zh(H,2),Ce!==null&&Dc(Ce,H,2),sg(),tR(H,2)}if(H=Xv(L),H===null&&Fv(p,v,L,mg,w),H===U)break;U=H}U!==null&&L.stopPropagation()}else Fv(p,v,L,null,w)}}function Xv(p){return p=yC(p),gt(p)}var mg=null;function gt(p){if(mg=null,p=Im(p),p!==null){var v=I(p);if(v===null)p=null;else{var w=v.tag;if(w===13){if(p=N(v),p!==null)return p;p=null}else if(w===3){if(v.stateNode.current.memoizedState.isDehydrated)return v.tag===3?v.stateNode.containerInfo:null;p=null}else v!==p&&(p=null)}}return mg=p,null}function LO(p){switch(p){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(dr()){case Ii:return 2;case sa:return 8;case ar:case Sn:return 32;case vc:return 268435456;default:return 32}default:return 32}}var nR=!1,Op=null,Fd=null,th=null,gg=new Map,Qv=new Map,Np=[],oc="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Zv(p,v){switch(p){case"focusin":case"focusout":Op=null;break;case"dragenter":case"dragleave":Fd=null;break;case"mouseover":case"mouseout":th=null;break;case"pointerover":case"pointerout":gg.delete(v.pointerId);break;case"gotpointercapture":case"lostpointercapture":Qv.delete(v.pointerId)}}function f_(p,v,w,L,U,H){return p===null||p.nativeEvent!==H?(p={blockedOn:v,domEventName:w,eventSystemFlags:L,nativeEvent:H,targetContainers:[U]},v!==null&&(v=v0(v),v!==null&&JT(v)),p):(p.eventSystemFlags|=L,v=p.targetContainers,U!==null&&v.indexOf(U)===-1&&v.push(U),p)}function DO(p,v,w,L,U){switch(v){case"focusin":return Op=f_(Op,p,v,w,L,U),!0;case"dragenter":return Fd=f_(Fd,p,v,w,L,U),!0;case"mouseover":return th=f_(th,p,v,w,L,U),!0;case"pointerover":var H=U.pointerId;return gg.set(H,f_(gg.get(H)||null,p,v,w,L,U)),!0;case"gotpointercapture":return H=U.pointerId,Qv.set(H,f_(Qv.get(H)||null,p,v,w,L,U)),!0}return!1}function ZT(p){var v=Im(p.target);if(v!==null){var w=I(v);if(w!==null){if(v=w.tag,v===13){if(v=N(w),v!==null){p.blockedOn=v,Ty(p.priority,function(){if(w.tag===13){var L=Lc();L=yu(L);var U=Zh(w,L);U!==null&&Dc(U,w,L),tR(w,L)}});return}}else if(v===3&&w.stateNode.current.memoizedState.isDehydrated){p.blockedOn=w.tag===3?w.stateNode.containerInfo:null;return}}}p.blockedOn=null}function h_(p){if(p.blockedOn!==null)return!1;for(var v=p.targetContainers;0<v.length;){var w=Xv(p.nativeEvent);if(w===null){w=p.nativeEvent;var L=new w.constructor(w.type,w);SC=L,w.target.dispatchEvent(L),SC=null}else return v=v0(w),v!==null&&JT(v),p.blockedOn=w,!1;v.shift()}return!0}function rR(p,v,w){h_(p)&&w.delete(v)}function iR(){nR=!1,Op!==null&&h_(Op)&&(Op=null),Fd!==null&&h_(Fd)&&(Fd=null),th!==null&&h_(th)&&(th=null),gg.forEach(rR),Qv.forEach(rR)}function p_(p,v){p.blockedOn===v&&(p.blockedOn=null,nR||(nR=!0,o.unstable_scheduleCallback(o.unstable_NormalPriority,iR)))}var nh=null;function m_(p){nh!==p&&(nh=p,o.unstable_scheduleCallback(o.unstable_NormalPriority,function(){nh===p&&(nh=null);for(var v=0;v<p.length;v+=3){var w=p[v],L=p[v+1],U=p[v+2];if(typeof L!="function"){if(gt(L||w)===null)continue;break}var H=v0(w);H!==null&&(p.splice(v,3),v-=3,q0(H,{pending:!0,data:U,method:w.method,action:L},L,U))}}))}function Mc(p){function v(Fe){return p_(Fe,p)}Op!==null&&p_(Op,p),Fd!==null&&p_(Fd,p),th!==null&&p_(th,p),gg.forEach(v),Qv.forEach(v);for(var w=0;w<Np.length;w++){var L=Np[w];L.blockedOn===p&&(L.blockedOn=null)}for(;0<Np.length&&(w=Np[0],w.blockedOn===null);)ZT(w),w.blockedOn===null&&Np.shift();if(w=(p.ownerDocument||p).$$reactFormReplay,w!=null)for(L=0;L<w.length;L+=3){var U=w[L],H=w[L+1],pe=U[Tc]||null;if(typeof H=="function")pe||m_(w);else if(pe){var Ce=null;if(H&&H.hasAttribute("formAction")){if(U=H,pe=H[Tc]||null)Ce=pe.formAction;else if(gt(U)!==null)continue}else Ce=pe.action;typeof Ce=="function"?w[L+1]=Ce:(w.splice(L,3),L-=3),m_(w)}}}function Lp(p){this._internalRoot=p}g_.prototype.render=Lp.prototype.render=function(p){var v=this._internalRoot;if(v===null)throw Error(g(409));var w=v.current,L=Lc();eR(w,L,p,v,null,null)},g_.prototype.unmount=Lp.prototype.unmount=function(){var p=this._internalRoot;if(p!==null){this._internalRoot=null;var v=p.containerInfo;eR(p.current,2,null,p,null,null),sg(),v[Rf]=null}};function g_(p){this._internalRoot=p}g_.prototype.unstable_scheduleHydration=function(p){if(p){var v=yc();p={blockedOn:null,target:p,priority:v};for(var w=0;w<Np.length&&v!==0&&v<Np[w].priority;w++);Np.splice(w,0,p),w===0&&ZT(p)}};var aR=d.version;if(aR!=="19.1.0")throw Error(g(527,aR,"19.1.0"));qe.findDOMNode=function(p){var v=p._reactInternals;if(v===void 0)throw typeof p.render=="function"?Error(g(188)):(p=Object.keys(p).join(","),Error(g(268,p)));return p=k(v),p=p!==null?x(p):null,p=p===null?null:p.stateNode,p};var kM={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:Oe,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var $v=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!$v.isDisabled&&$v.supportsFiber)try{jl=$v.inject(kM),Tr=$v}catch{}}return xj.createRoot=function(p,v){if(!T(p))throw Error(g(299));var w=!1,L="",U=X2,H=Q2,pe=fT,Ce=null;return v!=null&&(v.unstable_strictMode===!0&&(w=!0),v.identifierPrefix!==void 0&&(L=v.identifierPrefix),v.onUncaughtError!==void 0&&(U=v.onUncaughtError),v.onCaughtError!==void 0&&(H=v.onCaughtError),v.onRecoverableError!==void 0&&(pe=v.onRecoverableError),v.unstable_transitionCallbacks!==void 0&&(Ce=v.unstable_transitionCallbacks)),v=OO(p,1,!1,null,null,w,L,U,H,pe,Ce,null),p[Rf]=v.current,$f(p),new Lp(v)},xj.hydrateRoot=function(p,v,w){if(!T(p))throw Error(g(299));var L=!1,U="",H=X2,pe=Q2,Ce=fT,Fe=null,it=null;return w!=null&&(w.unstable_strictMode===!0&&(L=!0),w.identifierPrefix!==void 0&&(U=w.identifierPrefix),w.onUncaughtError!==void 0&&(H=w.onUncaughtError),w.onCaughtError!==void 0&&(pe=w.onCaughtError),w.onRecoverableError!==void 0&&(Ce=w.onRecoverableError),w.unstable_transitionCallbacks!==void 0&&(Fe=w.unstable_transitionCallbacks),w.formState!==void 0&&(it=w.formState)),v=OO(p,1,!0,v,w??null,L,U,H,pe,Ce,Fe,it),v.context=$w(null),w=v.current,L=Lc(),L=yu(L),U=Vf(L),U.callback=null,zl(w,U,L),w=L,v.current.lanes=w,wm(v,w),fl(v),p[Rf]=v.current,$f(p),new g_(v)},xj.version="19.1.0",xj}var y$;function Ode(){if(y$)return wK.exports;y$=1;function o(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(o)}catch(d){console.error(d)}}return o(),wK.exports=Ade(),wK.exports}var Nde=Ode(),Uj={},T$;function Lde(){if(T$)return Uj;T$=1,Object.defineProperty(Uj,"__esModule",{value:!0}),Uj.parse=N,Uj.serialize=x;const o=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,d=/^[\u0021-\u003A\u003C-\u007E]*$/,h=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,g=/^[\u0020-\u003A\u003D-\u007E]*$/,T=Object.prototype.toString,I=(()=>{const Q=function(){};return Q.prototype=Object.create(null),Q})();function N(Q,ie){const X=new I,Z=Q.length;if(Z<2)return X;const ae=(ie==null?void 0:ie.decode)||V;let le=0;do{const fe=Q.indexOf("=",le);if(fe===-1)break;const ue=Q.indexOf(";",le),de=ue===-1?Z:ue;if(fe>de){le=Q.lastIndexOf(";",fe-1)+1;continue}const te=M(Q,le,fe),ye=k(Q,fe,te),Te=Q.slice(te,ye);if(X[Te]===void 0){let Le=M(Q,fe+1,de),je=k(Q,de,Le);const he=ae(Q.slice(Le,je));X[Te]=he}le=de+1}while(le<Z);return X}function M(Q,ie,X){do{const Z=Q.charCodeAt(ie);if(Z!==32&&Z!==9)return ie}while(++ie<X);return X}function k(Q,ie,X){for(;ie>X;){const Z=Q.charCodeAt(--ie);if(Z!==32&&Z!==9)return ie+1}return X}function x(Q,ie,X){const Z=(X==null?void 0:X.encode)||encodeURIComponent;if(!o.test(Q))throw new TypeError(`argument name is invalid: ${Q}`);const ae=Z(ie);if(!d.test(ae))throw new TypeError(`argument val is invalid: ${ie}`);let le=Q+"="+ae;if(!X)return le;if(X.maxAge!==void 0){if(!Number.isInteger(X.maxAge))throw new TypeError(`option maxAge is invalid: ${X.maxAge}`);le+="; Max-Age="+X.maxAge}if(X.domain){if(!h.test(X.domain))throw new TypeError(`option domain is invalid: ${X.domain}`);le+="; Domain="+X.domain}if(X.path){if(!g.test(X.path))throw new TypeError(`option path is invalid: ${X.path}`);le+="; Path="+X.path}if(X.expires){if(!K(X.expires)||!Number.isFinite(X.expires.valueOf()))throw new TypeError(`option expires is invalid: ${X.expires}`);le+="; Expires="+X.expires.toUTCString()}if(X.httpOnly&&(le+="; HttpOnly"),X.secure&&(le+="; Secure"),X.partitioned&&(le+="; Partitioned"),X.priority)switch(typeof X.priority=="string"?X.priority.toLowerCase():void 0){case"low":le+="; Priority=Low";break;case"medium":le+="; Priority=Medium";break;case"high":le+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${X.priority}`)}if(X.sameSite)switch(typeof X.sameSite=="string"?X.sameSite.toLowerCase():X.sameSite){case!0:case"strict":le+="; SameSite=Strict";break;case"lax":le+="; SameSite=Lax";break;case"none":le+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${X.sameSite}`)}return le}function V(Q){if(Q.indexOf("%")===-1)return Q;try{return decodeURIComponent(Q)}catch{return Q}}function K(Q){return T.call(Q)==="[object Date]"}return Uj}Lde();var b$="popstate";function Dde(o={}){function d(g,T){let{pathname:I,search:N,hash:M}=g.location;return OX("",{pathname:I,search:N,hash:M},T.state&&T.state.usr||null,T.state&&T.state.key||"default")}function h(g,T){return typeof T=="string"?T:u5(T)}return Mde(d,h,null,o)}function Os(o,d){if(o===!1||o===null||typeof o>"u")throw new Error(d)}function h0(o,d){if(!o){typeof console<"u"&&console.warn(d);try{throw new Error(d)}catch{}}}function Pde(){return Math.random().toString(36).substring(2,10)}function C$(o,d){return{usr:o.state,key:o.key,idx:d}}function OX(o,d,h=null,g){return{pathname:typeof o=="string"?o:o.pathname,search:"",hash:"",...typeof d=="string"?PP(d):d,state:h,key:d&&d.key||g||Pde()}}function u5({pathname:o="/",search:d="",hash:h=""}){return d&&d!=="?"&&(o+=d.charAt(0)==="?"?d:"?"+d),h&&h!=="#"&&(o+=h.charAt(0)==="#"?h:"#"+h),o}function PP(o){let d={};if(o){let h=o.indexOf("#");h>=0&&(d.hash=o.substring(h),o=o.substring(0,h));let g=o.indexOf("?");g>=0&&(d.search=o.substring(g),o=o.substring(0,g)),o&&(d.pathname=o)}return d}function Mde(o,d,h,g={}){let{window:T=document.defaultView,v5Compat:I=!1}=g,N=T.history,M="POP",k=null,x=V();x==null&&(x=0,N.replaceState({...N.state,idx:x},""));function V(){return(N.state||{idx:null}).idx}function K(){M="POP";let ae=V(),le=ae==null?null:ae-x;x=ae,k&&k({action:M,location:Z.location,delta:le})}function Q(ae,le){M="PUSH";let fe=OX(Z.location,ae,le);x=V()+1;let ue=C$(fe,x),de=Z.createHref(fe);try{N.pushState(ue,"",de)}catch(te){if(te instanceof DOMException&&te.name==="DataCloneError")throw te;T.location.assign(de)}I&&k&&k({action:M,location:Z.location,delta:1})}function ie(ae,le){M="REPLACE";let fe=OX(Z.location,ae,le);x=V();let ue=C$(fe,x),de=Z.createHref(fe);N.replaceState(ue,"",de),I&&k&&k({action:M,location:Z.location,delta:0})}function X(ae){return kde(ae)}let Z={get action(){return M},get location(){return o(T,N)},listen(ae){if(k)throw new Error("A history only accepts one active listener");return T.addEventListener(b$,K),k=ae,()=>{T.removeEventListener(b$,K),k=null}},createHref(ae){return d(T,ae)},createURL:X,encodeLocation(ae){let le=X(ae);return{pathname:le.pathname,search:le.search,hash:le.hash}},push:Q,replace:ie,go(ae){return N.go(ae)}};return Z}function kde(o,d=!1){let h="http://localhost";typeof window<"u"&&(h=window.location.origin!=="null"?window.location.origin:window.location.href),Os(h,"No window.location.(origin|href) available to create URL");let g=typeof o=="string"?o:u5(o);return g=g.replace(/ $/,"%20"),!d&&g.startsWith("//")&&(g=h+g),new URL(g,h)}function qie(o,d,h="/"){return xde(o,d,h,!1)}function xde(o,d,h,g){let T=typeof d=="string"?PP(d):d,I=py(T.pathname||"/",h);if(I==null)return null;let N=Jie(o);Ude(N);let M=null;for(let k=0;M==null&&k<N.length;++k){let x=qde(I);M=Yde(N[k],x,g)}return M}function Jie(o,d=[],h=[],g=""){let T=(I,N,M)=>{let k={relativePath:M===void 0?I.path||"":M,caseSensitive:I.caseSensitive===!0,childrenIndex:N,route:I};k.relativePath.startsWith("/")&&(Os(k.relativePath.startsWith(g),`Absolute route path "${k.relativePath}" nested under path "${g}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),k.relativePath=k.relativePath.slice(g.length));let x=fy([g,k.relativePath]),V=h.concat(k);I.children&&I.children.length>0&&(Os(I.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${x}".`),Jie(I.children,d,V,x)),!(I.path==null&&!I.index)&&d.push({path:x,score:Hde(x,I.index),routesMeta:V})};return o.forEach((I,N)=>{var M;if(I.path===""||!((M=I.path)!=null&&M.includes("?")))T(I,N);else for(let k of Xie(I.path))T(I,N,k)}),d}function Xie(o){let d=o.split("/");if(d.length===0)return[];let[h,...g]=d,T=h.endsWith("?"),I=h.replace(/\?$/,"");if(g.length===0)return T?[I,""]:[I];let N=Xie(g.join("/")),M=[];return M.push(...N.map(k=>k===""?I:[I,k].join("/"))),T&&M.push(...N),M.map(k=>o.startsWith("/")&&k===""?"/":k)}function Ude(o){o.sort((d,h)=>d.score!==h.score?h.score-d.score:Wde(d.routesMeta.map(g=>g.childrenIndex),h.routesMeta.map(g=>g.childrenIndex)))}var jde=/^:[\w-]+$/,Vde=3,Bde=2,Fde=1,Gde=10,zde=-2,w$=o=>o==="*";function Hde(o,d){let h=o.split("/"),g=h.length;return h.some(w$)&&(g+=zde),d&&(g+=Bde),h.filter(T=>!w$(T)).reduce((T,I)=>T+(jde.test(I)?Vde:I===""?Fde:Gde),g)}function Wde(o,d){return o.length===d.length&&o.slice(0,-1).every((g,T)=>g===d[T])?o[o.length-1]-d[d.length-1]:0}function Yde(o,d,h=!1){let{routesMeta:g}=o,T={},I="/",N=[];for(let M=0;M<g.length;++M){let k=g[M],x=M===g.length-1,V=I==="/"?d:d.slice(I.length)||"/",K=H7({path:k.relativePath,caseSensitive:k.caseSensitive,end:x},V),Q=k.route;if(!K&&x&&h&&!g[g.length-1].route.index&&(K=H7({path:k.relativePath,caseSensitive:k.caseSensitive,end:!1},V)),!K)return null;Object.assign(T,K.params),N.push({params:T,pathname:fy([I,K.pathname]),pathnameBase:Zde(fy([I,K.pathnameBase])),route:Q}),K.pathnameBase!=="/"&&(I=fy([I,K.pathnameBase]))}return N}function H7(o,d){typeof o=="string"&&(o={path:o,caseSensitive:!1,end:!0});let[h,g]=Kde(o.path,o.caseSensitive,o.end),T=d.match(h);if(!T)return null;let I=T[0],N=I.replace(/(.)\/+$/,"$1"),M=T.slice(1);return{params:g.reduce((x,{paramName:V,isOptional:K},Q)=>{if(V==="*"){let X=M[Q]||"";N=I.slice(0,I.length-X.length).replace(/(.)\/+$/,"$1")}const ie=M[Q];return K&&!ie?x[V]=void 0:x[V]=(ie||"").replace(/%2F/g,"/"),x},{}),pathname:I,pathnameBase:N,pattern:o}}function Kde(o,d=!1,h=!0){h0(o==="*"||!o.endsWith("*")||o.endsWith("/*"),`Route path "${o}" will be treated as if it were "${o.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${o.replace(/\*$/,"/*")}".`);let g=[],T="^"+o.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(N,M,k)=>(g.push({paramName:M,isOptional:k!=null}),k?"/?([^\\/]+)?":"/([^\\/]+)"));return o.endsWith("*")?(g.push({paramName:"*"}),T+=o==="*"||o==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):h?T+="\\/*$":o!==""&&o!=="/"&&(T+="(?:(?=\\/|$))"),[new RegExp(T,d?void 0:"i"),g]}function qde(o){try{return o.split("/").map(d=>decodeURIComponent(d).replace(/\//g,"%2F")).join("/")}catch(d){return h0(!1,`The URL path "${o}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${d}).`),o}}function py(o,d){if(d==="/")return o;if(!o.toLowerCase().startsWith(d.toLowerCase()))return null;let h=d.endsWith("/")?d.length-1:d.length,g=o.charAt(h);return g&&g!=="/"?null:o.slice(h)||"/"}function Jde(o,d="/"){let{pathname:h,search:g="",hash:T=""}=typeof o=="string"?PP(o):o;return{pathname:h?h.startsWith("/")?h:Xde(h,d):d,search:$de(g),hash:eue(T)}}function Xde(o,d){let h=d.replace(/\/+$/,"").split("/");return o.split("/").forEach(T=>{T===".."?h.length>1&&h.pop():T!=="."&&h.push(T)}),h.length>1?h.join("/"):"/"}function OK(o,d,h,g){return`Cannot include a '${o}' character in a manually specified \`to.${d}\` field [${JSON.stringify(g)}].  Please separate it out to the \`to.${h}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function Qde(o){return o.filter((d,h)=>h===0||d.route.path&&d.route.path.length>0)}function SQ(o){let d=Qde(o);return d.map((h,g)=>g===d.length-1?h.pathname:h.pathnameBase)}function yQ(o,d,h,g=!1){let T;typeof o=="string"?T=PP(o):(T={...o},Os(!T.pathname||!T.pathname.includes("?"),OK("?","pathname","search",T)),Os(!T.pathname||!T.pathname.includes("#"),OK("#","pathname","hash",T)),Os(!T.search||!T.search.includes("#"),OK("#","search","hash",T)));let I=o===""||T.pathname==="",N=I?"/":T.pathname,M;if(N==null)M=h;else{let K=d.length-1;if(!g&&N.startsWith("..")){let Q=N.split("/");for(;Q[0]==="..";)Q.shift(),K-=1;T.pathname=Q.join("/")}M=K>=0?d[K]:"/"}let k=Jde(T,M),x=N&&N!=="/"&&N.endsWith("/"),V=(I||N===".")&&h.endsWith("/");return!k.pathname.endsWith("/")&&(x||V)&&(k.pathname+="/"),k}var fy=o=>o.join("/").replace(/\/\/+/g,"/"),Zde=o=>o.replace(/\/+$/,"").replace(/^\/*/,"/"),$de=o=>!o||o==="?"?"":o.startsWith("?")?o:"?"+o,eue=o=>!o||o==="#"?"":o.startsWith("#")?o:"#"+o;function tue(o){return o!=null&&typeof o.status=="number"&&typeof o.statusText=="string"&&typeof o.internal=="boolean"&&"data"in o}var Qie=["POST","PUT","PATCH","DELETE"];new Set(Qie);var nue=["GET",...Qie];new Set(nue);var MP=q.createContext(null);MP.displayName="DataRouter";var vG=q.createContext(null);vG.displayName="DataRouterState";var Zie=q.createContext({isTransitioning:!1});Zie.displayName="ViewTransition";var rue=q.createContext(new Map);rue.displayName="Fetchers";var iue=q.createContext(null);iue.displayName="Await";var p0=q.createContext(null);p0.displayName="Navigation";var D5=q.createContext(null);D5.displayName="Location";var SE=q.createContext({outlet:null,matches:[],isDataRoute:!1});SE.displayName="Route";var TQ=q.createContext(null);TQ.displayName="RouteError";function aue(o,{relative:d}={}){Os(kP(),"useHref() may be used only in the context of a <Router> component.");let{basename:h,navigator:g}=q.useContext(p0),{hash:T,pathname:I,search:N}=P5(o,{relative:d}),M=I;return h!=="/"&&(M=I==="/"?h:fy([h,I])),g.createHref({pathname:M,search:N,hash:T})}function kP(){return q.useContext(D5)!=null}function Sy(){return Os(kP(),"useLocation() may be used only in the context of a <Router> component."),q.useContext(D5).location}var $ie="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function eae(o){q.useContext(p0).static||q.useLayoutEffect(o)}function xl(){let{isDataRoute:o}=q.useContext(SE);return o?Eue():sue()}function sue(){Os(kP(),"useNavigate() may be used only in the context of a <Router> component.");let o=q.useContext(MP),{basename:d,navigator:h}=q.useContext(p0),{matches:g}=q.useContext(SE),{pathname:T}=Sy(),I=JSON.stringify(SQ(g)),N=q.useRef(!1);return eae(()=>{N.current=!0}),q.useCallback((k,x={})=>{if(h0(N.current,$ie),!N.current)return;if(typeof k=="number"){h.go(k);return}let V=yQ(k,JSON.parse(I),T,x.relative==="path");o==null&&d!=="/"&&(V.pathname=V.pathname==="/"?d:fy([d,V.pathname])),(x.replace?h.replace:h.push)(V,x.state,x)},[d,h,I,T,o])}q.createContext(null);function P5(o,{relative:d}={}){let{matches:h}=q.useContext(SE),{pathname:g}=Sy(),T=JSON.stringify(SQ(h));return q.useMemo(()=>yQ(o,JSON.parse(T),g,d==="path"),[o,T,g,d])}function oue(o,d){return tae(o,d)}function tae(o,d,h,g){var le;Os(kP(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:T}=q.useContext(p0),{matches:I}=q.useContext(SE),N=I[I.length-1],M=N?N.params:{},k=N?N.pathname:"/",x=N?N.pathnameBase:"/",V=N&&N.route;{let fe=V&&V.path||"";nae(k,!V||fe.endsWith("*")||fe.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${k}" (under <Route path="${fe}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${fe}"> to <Route path="${fe==="/"?"*":`${fe}/*`}">.`)}let K=Sy(),Q;if(d){let fe=typeof d=="string"?PP(d):d;Os(x==="/"||((le=fe.pathname)==null?void 0:le.startsWith(x)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${x}" but pathname "${fe.pathname}" was given in the \`location\` prop.`),Q=fe}else Q=K;let ie=Q.pathname||"/",X=ie;if(x!=="/"){let fe=x.replace(/^\//,"").split("/");X="/"+ie.replace(/^\//,"").split("/").slice(fe.length).join("/")}let Z=qie(o,{pathname:X});h0(V||Z!=null,`No routes matched location "${Q.pathname}${Q.search}${Q.hash}" `),h0(Z==null||Z[Z.length-1].route.element!==void 0||Z[Z.length-1].route.Component!==void 0||Z[Z.length-1].route.lazy!==void 0,`Matched leaf route at location "${Q.pathname}${Q.search}${Q.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let ae=fue(Z&&Z.map(fe=>Object.assign({},fe,{params:Object.assign({},M,fe.params),pathname:fy([x,T.encodeLocation?T.encodeLocation(fe.pathname).pathname:fe.pathname]),pathnameBase:fe.pathnameBase==="/"?x:fy([x,T.encodeLocation?T.encodeLocation(fe.pathnameBase).pathname:fe.pathnameBase])})),I,h,g);return d&&ae?q.createElement(D5.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...Q},navigationType:"POP"}},ae):ae}function cue(){let o=_ue(),d=tue(o)?`${o.status} ${o.statusText}`:o instanceof Error?o.message:JSON.stringify(o),h=o instanceof Error?o.stack:null,g="rgba(200,200,200, 0.5)",T={padding:"0.5rem",backgroundColor:g},I={padding:"2px 4px",backgroundColor:g},N=null;return console.error("Error handled by React Router default ErrorBoundary:",o),N=q.createElement(q.Fragment,null,q.createElement("p",null," Hey developer "),q.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",q.createElement("code",{style:I},"ErrorBoundary")," or"," ",q.createElement("code",{style:I},"errorElement")," prop on your route.")),q.createElement(q.Fragment,null,q.createElement("h2",null,"Unexpected Application Error!"),q.createElement("h3",{style:{fontStyle:"italic"}},d),h?q.createElement("pre",{style:T},h):null,N)}var lue=q.createElement(cue,null),due=class extends q.Component{constructor(o){super(o),this.state={location:o.location,revalidation:o.revalidation,error:o.error}}static getDerivedStateFromError(o){return{error:o}}static getDerivedStateFromProps(o,d){return d.location!==o.location||d.revalidation!=="idle"&&o.revalidation==="idle"?{error:o.error,location:o.location,revalidation:o.revalidation}:{error:o.error!==void 0?o.error:d.error,location:d.location,revalidation:o.revalidation||d.revalidation}}componentDidCatch(o,d){console.error("React Router caught the following error during render",o,d)}render(){return this.state.error!==void 0?q.createElement(SE.Provider,{value:this.props.routeContext},q.createElement(TQ.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function uue({routeContext:o,match:d,children:h}){let g=q.useContext(MP);return g&&g.static&&g.staticContext&&(d.route.errorElement||d.route.ErrorBoundary)&&(g.staticContext._deepestRenderedBoundaryId=d.route.id),q.createElement(SE.Provider,{value:o},h)}function fue(o,d=[],h=null,g=null){if(o==null){if(!h)return null;if(h.errors)o=h.matches;else if(d.length===0&&!h.initialized&&h.matches.length>0)o=h.matches;else return null}let T=o,I=h==null?void 0:h.errors;if(I!=null){let k=T.findIndex(x=>x.route.id&&(I==null?void 0:I[x.route.id])!==void 0);Os(k>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(I).join(",")}`),T=T.slice(0,Math.min(T.length,k+1))}let N=!1,M=-1;if(h)for(let k=0;k<T.length;k++){let x=T[k];if((x.route.HydrateFallback||x.route.hydrateFallbackElement)&&(M=k),x.route.id){let{loaderData:V,errors:K}=h,Q=x.route.loader&&!V.hasOwnProperty(x.route.id)&&(!K||K[x.route.id]===void 0);if(x.route.lazy||Q){N=!0,M>=0?T=T.slice(0,M+1):T=[T[0]];break}}}return T.reduceRight((k,x,V)=>{let K,Q=!1,ie=null,X=null;h&&(K=I&&x.route.id?I[x.route.id]:void 0,ie=x.route.errorElement||lue,N&&(M<0&&V===0?(nae("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),Q=!0,X=null):M===V&&(Q=!0,X=x.route.hydrateFallbackElement||null)));let Z=d.concat(T.slice(0,V+1)),ae=()=>{let le;return K?le=ie:Q?le=X:x.route.Component?le=q.createElement(x.route.Component,null):x.route.element?le=x.route.element:le=k,q.createElement(uue,{match:x,routeContext:{outlet:k,matches:Z,isDataRoute:h!=null},children:le})};return h&&(x.route.ErrorBoundary||x.route.errorElement||V===0)?q.createElement(due,{location:h.location,revalidation:h.revalidation,component:ie,error:K,children:ae(),routeContext:{outlet:null,matches:Z,isDataRoute:!0}}):ae()},null)}function bQ(o){return`${o} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function hue(o){let d=q.useContext(MP);return Os(d,bQ(o)),d}function pue(o){let d=q.useContext(vG);return Os(d,bQ(o)),d}function mue(o){let d=q.useContext(SE);return Os(d,bQ(o)),d}function CQ(o){let d=mue(o),h=d.matches[d.matches.length-1];return Os(h.route.id,`${o} can only be used on routes that contain a unique "id"`),h.route.id}function gue(){return CQ("useRouteId")}function _ue(){var g;let o=q.useContext(TQ),d=pue("useRouteError"),h=CQ("useRouteError");return o!==void 0?o:(g=d.errors)==null?void 0:g[h]}function Eue(){let{router:o}=hue("useNavigate"),d=CQ("useNavigate"),h=q.useRef(!1);return eae(()=>{h.current=!0}),q.useCallback(async(T,I={})=>{h0(h.current,$ie),h.current&&(typeof T=="number"?o.navigate(T):await o.navigate(T,{fromRouteId:d,...I}))},[o,d])}var R$={};function nae(o,d,h){!d&&!R$[o]&&(R$[o]=!0,h0(!1,h))}q.memo(vue);function vue({routes:o,future:d,state:h}){return tae(o,void 0,h,d)}function Sue({to:o,replace:d,state:h,relative:g}){Os(kP(),"<Navigate> may be used only in the context of a <Router> component.");let{static:T}=q.useContext(p0);h0(!T,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:I}=q.useContext(SE),{pathname:N}=Sy(),M=xl(),k=yQ(o,SQ(I),N,g==="path"),x=JSON.stringify(k);return q.useEffect(()=>{M(JSON.parse(x),{replace:d,state:h,relative:g})},[M,x,g,d,h]),null}function Lo(o){Os(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function yue({basename:o="/",children:d=null,location:h,navigationType:g="POP",navigator:T,static:I=!1}){Os(!kP(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let N=o.replace(/^\/*/,"/"),M=q.useMemo(()=>({basename:N,navigator:T,static:I,future:{}}),[N,T,I]);typeof h=="string"&&(h=PP(h));let{pathname:k="/",search:x="",hash:V="",state:K=null,key:Q="default"}=h,ie=q.useMemo(()=>{let X=py(k,N);return X==null?null:{location:{pathname:X,search:x,hash:V,state:K,key:Q},navigationType:g}},[N,k,x,V,K,Q,g]);return h0(ie!=null,`<Router basename="${N}"> is not able to match the URL "${k}${x}${V}" because it does not start with the basename, so the <Router> won't render anything.`),ie==null?null:q.createElement(p0.Provider,{value:M},q.createElement(D5.Provider,{children:d,value:ie}))}function Tue({children:o,location:d}){return oue(NX(o),d)}function NX(o,d=[]){let h=[];return q.Children.forEach(o,(g,T)=>{if(!q.isValidElement(g))return;let I=[...d,T];if(g.type===q.Fragment){h.push.apply(h,NX(g.props.children,I));return}Os(g.type===Lo,`[${typeof g.type=="string"?g.type:g.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Os(!g.props.index||!g.props.children,"An index route cannot have child routes.");let N={id:g.props.id||I.join("-"),caseSensitive:g.props.caseSensitive,element:g.props.element,Component:g.props.Component,index:g.props.index,path:g.props.path,loader:g.props.loader,action:g.props.action,hydrateFallbackElement:g.props.hydrateFallbackElement,HydrateFallback:g.props.HydrateFallback,errorElement:g.props.errorElement,ErrorBoundary:g.props.ErrorBoundary,hasErrorBoundary:g.props.hasErrorBoundary===!0||g.props.ErrorBoundary!=null||g.props.errorElement!=null,shouldRevalidate:g.props.shouldRevalidate,handle:g.props.handle,lazy:g.props.lazy};g.props.children&&(N.children=NX(g.props.children,I)),h.push(N)}),h}var C7="get",w7="application/x-www-form-urlencoded";function SG(o){return o!=null&&typeof o.tagName=="string"}function bue(o){return SG(o)&&o.tagName.toLowerCase()==="button"}function Cue(o){return SG(o)&&o.tagName.toLowerCase()==="form"}function wue(o){return SG(o)&&o.tagName.toLowerCase()==="input"}function Rue(o){return!!(o.metaKey||o.altKey||o.ctrlKey||o.shiftKey)}function Iue(o,d){return o.button===0&&(!d||d==="_self")&&!Rue(o)}var d7=null;function Aue(){if(d7===null)try{new FormData(document.createElement("form"),0),d7=!1}catch{d7=!0}return d7}var Oue=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function NK(o){return o!=null&&!Oue.has(o)?(h0(!1,`"${o}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${w7}"`),null):o}function Nue(o,d){let h,g,T,I,N;if(Cue(o)){let M=o.getAttribute("action");g=M?py(M,d):null,h=o.getAttribute("method")||C7,T=NK(o.getAttribute("enctype"))||w7,I=new FormData(o)}else if(bue(o)||wue(o)&&(o.type==="submit"||o.type==="image")){let M=o.form;if(M==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let k=o.getAttribute("formaction")||M.getAttribute("action");if(g=k?py(k,d):null,h=o.getAttribute("formmethod")||M.getAttribute("method")||C7,T=NK(o.getAttribute("formenctype"))||NK(M.getAttribute("enctype"))||w7,I=new FormData(M,o),!Aue()){let{name:x,type:V,value:K}=o;if(V==="image"){let Q=x?`${x}.`:"";I.append(`${Q}x`,"0"),I.append(`${Q}y`,"0")}else x&&I.append(x,K)}}else{if(SG(o))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');h=C7,g=null,T=w7,N=o}return I&&T==="text/plain"&&(N=I,I=void 0),{action:g,method:h.toLowerCase(),encType:T,formData:I,body:N}}function wQ(o,d){if(o===!1||o===null||typeof o>"u")throw new Error(d)}async function Lue(o,d){if(o.id in d)return d[o.id];try{let h=await import(o.module);return d[o.id]=h,h}catch(h){return console.error(`Error loading route module \`${o.module}\`, reloading page...`),console.error(h),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function Due(o){return o==null?!1:o.href==null?o.rel==="preload"&&typeof o.imageSrcSet=="string"&&typeof o.imageSizes=="string":typeof o.rel=="string"&&typeof o.href=="string"}async function Pue(o,d,h){let g=await Promise.all(o.map(async T=>{let I=d.routes[T.route.id];if(I){let N=await Lue(I,h);return N.links?N.links():[]}return[]}));return Uue(g.flat(1).filter(Due).filter(T=>T.rel==="stylesheet"||T.rel==="preload").map(T=>T.rel==="stylesheet"?{...T,rel:"prefetch",as:"style"}:{...T,rel:"prefetch"}))}function I$(o,d,h,g,T,I){let N=(k,x)=>h[x]?k.route.id!==h[x].route.id:!0,M=(k,x)=>{var V;return h[x].pathname!==k.pathname||((V=h[x].route.path)==null?void 0:V.endsWith("*"))&&h[x].params["*"]!==k.params["*"]};return I==="assets"?d.filter((k,x)=>N(k,x)||M(k,x)):I==="data"?d.filter((k,x)=>{var K;let V=g.routes[k.route.id];if(!V||!V.hasLoader)return!1;if(N(k,x)||M(k,x))return!0;if(k.route.shouldRevalidate){let Q=k.route.shouldRevalidate({currentUrl:new URL(T.pathname+T.search+T.hash,window.origin),currentParams:((K=h[0])==null?void 0:K.params)||{},nextUrl:new URL(o,window.origin),nextParams:k.params,defaultShouldRevalidate:!0});if(typeof Q=="boolean")return Q}return!0}):[]}function Mue(o,d,{includeHydrateFallback:h}={}){return kue(o.map(g=>{let T=d.routes[g.route.id];if(!T)return[];let I=[T.module];return T.clientActionModule&&(I=I.concat(T.clientActionModule)),T.clientLoaderModule&&(I=I.concat(T.clientLoaderModule)),h&&T.hydrateFallbackModule&&(I=I.concat(T.hydrateFallbackModule)),T.imports&&(I=I.concat(T.imports)),I}).flat(1))}function kue(o){return[...new Set(o)]}function xue(o){let d={},h=Object.keys(o).sort();for(let g of h)d[g]=o[g];return d}function Uue(o,d){let h=new Set;return new Set(d),o.reduce((g,T)=>{let I=JSON.stringify(xue(T));return h.has(I)||(h.add(I),g.push({key:I,link:T})),g},[])}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var jue=new Set([100,101,204,205]);function Vue(o,d){let h=typeof o=="string"?new URL(o,typeof window>"u"?"server://singlefetch/":window.location.origin):o;return h.pathname==="/"?h.pathname="_root.data":d&&py(h.pathname,d)==="/"?h.pathname=`${d.replace(/\/$/,"")}/_root.data`:h.pathname=`${h.pathname.replace(/\/$/,"")}.data`,h}function rae(){let o=q.useContext(MP);return wQ(o,"You must render this element inside a <DataRouterContext.Provider> element"),o}function Bue(){let o=q.useContext(vG);return wQ(o,"You must render this element inside a <DataRouterStateContext.Provider> element"),o}var RQ=q.createContext(void 0);RQ.displayName="FrameworkContext";function iae(){let o=q.useContext(RQ);return wQ(o,"You must render this element inside a <HydratedRouter> element"),o}function Fue(o,d){let h=q.useContext(RQ),[g,T]=q.useState(!1),[I,N]=q.useState(!1),{onFocus:M,onBlur:k,onMouseEnter:x,onMouseLeave:V,onTouchStart:K}=d,Q=q.useRef(null);q.useEffect(()=>{if(o==="render"&&N(!0),o==="viewport"){let Z=le=>{le.forEach(fe=>{N(fe.isIntersecting)})},ae=new IntersectionObserver(Z,{threshold:.5});return Q.current&&ae.observe(Q.current),()=>{ae.disconnect()}}},[o]),q.useEffect(()=>{if(g){let Z=setTimeout(()=>{N(!0)},100);return()=>{clearTimeout(Z)}}},[g]);let ie=()=>{T(!0)},X=()=>{T(!1),N(!1)};return h?o!=="intent"?[I,Q,{}]:[I,Q,{onFocus:jj(M,ie),onBlur:jj(k,X),onMouseEnter:jj(x,ie),onMouseLeave:jj(V,X),onTouchStart:jj(K,ie)}]:[!1,Q,{}]}function jj(o,d){return h=>{o&&o(h),h.defaultPrevented||d(h)}}function Gue({page:o,...d}){let{router:h}=rae(),g=q.useMemo(()=>qie(h.routes,o,h.basename),[h.routes,o,h.basename]);return g?q.createElement(Hue,{page:o,matches:g,...d}):null}function zue(o){let{manifest:d,routeModules:h}=iae(),[g,T]=q.useState([]);return q.useEffect(()=>{let I=!1;return Pue(o,d,h).then(N=>{I||T(N)}),()=>{I=!0}},[o,d,h]),g}function Hue({page:o,matches:d,...h}){let g=Sy(),{manifest:T,routeModules:I}=iae(),{basename:N}=rae(),{loaderData:M,matches:k}=Bue(),x=q.useMemo(()=>I$(o,d,k,T,g,"data"),[o,d,k,T,g]),V=q.useMemo(()=>I$(o,d,k,T,g,"assets"),[o,d,k,T,g]),K=q.useMemo(()=>{if(o===g.pathname+g.search+g.hash)return[];let X=new Set,Z=!1;if(d.forEach(le=>{var ue;let fe=T.routes[le.route.id];!fe||!fe.hasLoader||(!x.some(de=>de.route.id===le.route.id)&&le.route.id in M&&((ue=I[le.route.id])!=null&&ue.shouldRevalidate)||fe.hasClientLoader?Z=!0:X.add(le.route.id))}),X.size===0)return[];let ae=Vue(o,N);return Z&&X.size>0&&ae.searchParams.set("_routes",d.filter(le=>X.has(le.route.id)).map(le=>le.route.id).join(",")),[ae.pathname+ae.search]},[N,M,g,T,x,d,o,I]),Q=q.useMemo(()=>Mue(V,T),[V,T]),ie=zue(V);return q.createElement(q.Fragment,null,K.map(X=>q.createElement("link",{key:X,rel:"prefetch",as:"fetch",href:X,...h})),Q.map(X=>q.createElement("link",{key:X,rel:"modulepreload",href:X,...h})),ie.map(({key:X,link:Z})=>q.createElement("link",{key:X,...Z})))}function Wue(...o){return d=>{o.forEach(h=>{typeof h=="function"?h(d):h!=null&&(h.current=d)})}}var aae=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{aae&&(window.__reactRouterVersion="7.6.2")}catch{}function Yue({basename:o,children:d,window:h}){let g=q.useRef();g.current==null&&(g.current=Dde({window:h,v5Compat:!0}));let T=g.current,[I,N]=q.useState({action:T.action,location:T.location}),M=q.useCallback(k=>{q.startTransition(()=>N(k))},[N]);return q.useLayoutEffect(()=>T.listen(M),[T,M]),q.createElement(yue,{basename:o,children:d,location:I.location,navigationType:I.action,navigator:T})}var sae=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,oae=q.forwardRef(function({onClick:d,discover:h="render",prefetch:g="none",relative:T,reloadDocument:I,replace:N,state:M,target:k,to:x,preventScrollReset:V,viewTransition:K,...Q},ie){let{basename:X}=q.useContext(p0),Z=typeof x=="string"&&sae.test(x),ae,le=!1;if(typeof x=="string"&&Z&&(ae=x,aae))try{let je=new URL(window.location.href),he=x.startsWith("//")?new URL(je.protocol+x):new URL(x),ke=py(he.pathname,X);he.origin===je.origin&&ke!=null?x=ke+he.search+he.hash:le=!0}catch{h0(!1,`<Link to="${x}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let fe=aue(x,{relative:T}),[ue,de,te]=Fue(g,Q),ye=Xue(x,{replace:N,state:M,target:k,preventScrollReset:V,relative:T,viewTransition:K});function Te(je){d&&d(je),je.defaultPrevented||ye(je)}let Le=q.createElement("a",{...Q,...te,href:ae||fe,onClick:le||I?d:Te,ref:Wue(ie,de),target:k,"data-discover":!Z&&h==="render"?"true":void 0});return ue&&!Z?q.createElement(q.Fragment,null,Le,q.createElement(Gue,{page:fe})):Le});oae.displayName="Link";var Kue=q.forwardRef(function({"aria-current":d="page",caseSensitive:h=!1,className:g="",end:T=!1,style:I,to:N,viewTransition:M,children:k,...x},V){let K=P5(N,{relative:x.relative}),Q=Sy(),ie=q.useContext(vG),{navigator:X,basename:Z}=q.useContext(p0),ae=ie!=null&&tfe(K)&&M===!0,le=X.encodeLocation?X.encodeLocation(K).pathname:K.pathname,fe=Q.pathname,ue=ie&&ie.navigation&&ie.navigation.location?ie.navigation.location.pathname:null;h||(fe=fe.toLowerCase(),ue=ue?ue.toLowerCase():null,le=le.toLowerCase()),ue&&Z&&(ue=py(ue,Z)||ue);const de=le!=="/"&&le.endsWith("/")?le.length-1:le.length;let te=fe===le||!T&&fe.startsWith(le)&&fe.charAt(de)==="/",ye=ue!=null&&(ue===le||!T&&ue.startsWith(le)&&ue.charAt(le.length)==="/"),Te={isActive:te,isPending:ye,isTransitioning:ae},Le=te?d:void 0,je;typeof g=="function"?je=g(Te):je=[g,te?"active":null,ye?"pending":null,ae?"transitioning":null].filter(Boolean).join(" ");let he=typeof I=="function"?I(Te):I;return q.createElement(oae,{...x,"aria-current":Le,className:je,ref:V,style:he,to:N,viewTransition:M},typeof k=="function"?k(Te):k)});Kue.displayName="NavLink";var que=q.forwardRef(({discover:o="render",fetcherKey:d,navigate:h,reloadDocument:g,replace:T,state:I,method:N=C7,action:M,onSubmit:k,relative:x,preventScrollReset:V,viewTransition:K,...Q},ie)=>{let X=$ue(),Z=efe(M,{relative:x}),ae=N.toLowerCase()==="get"?"get":"post",le=typeof M=="string"&&sae.test(M),fe=ue=>{if(k&&k(ue),ue.defaultPrevented)return;ue.preventDefault();let de=ue.nativeEvent.submitter,te=(de==null?void 0:de.getAttribute("formmethod"))||N;X(de||ue.currentTarget,{fetcherKey:d,method:te,navigate:h,replace:T,state:I,relative:x,preventScrollReset:V,viewTransition:K})};return q.createElement("form",{ref:ie,method:ae,action:Z,onSubmit:g?k:fe,...Q,"data-discover":!le&&o==="render"?"true":void 0})});que.displayName="Form";function Jue(o){return`${o} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function cae(o){let d=q.useContext(MP);return Os(d,Jue(o)),d}function Xue(o,{target:d,replace:h,state:g,preventScrollReset:T,relative:I,viewTransition:N}={}){let M=xl(),k=Sy(),x=P5(o,{relative:I});return q.useCallback(V=>{if(Iue(V,d)){V.preventDefault();let K=h!==void 0?h:u5(k)===u5(x);M(o,{replace:K,state:g,preventScrollReset:T,relative:I,viewTransition:N})}},[k,M,x,h,g,d,o,T,I,N])}var Que=0,Zue=()=>`__${String(++Que)}__`;function $ue(){let{router:o}=cae("useSubmit"),{basename:d}=q.useContext(p0),h=gue();return q.useCallback(async(g,T={})=>{let{action:I,method:N,encType:M,formData:k,body:x}=Nue(g,d);if(T.navigate===!1){let V=T.fetcherKey||Zue();await o.fetch(V,h,T.action||I,{preventScrollReset:T.preventScrollReset,formData:k,body:x,formMethod:T.method||N,formEncType:T.encType||M,flushSync:T.flushSync})}else await o.navigate(T.action||I,{preventScrollReset:T.preventScrollReset,formData:k,body:x,formMethod:T.method||N,formEncType:T.encType||M,replace:T.replace,state:T.state,fromRouteId:h,flushSync:T.flushSync,viewTransition:T.viewTransition})},[o,d,h])}function efe(o,{relative:d}={}){let{basename:h}=q.useContext(p0),g=q.useContext(SE);Os(g,"useFormAction must be used inside a RouteContext");let[T]=g.matches.slice(-1),I={...P5(o||".",{relative:d})},N=Sy();if(o==null){I.search=N.search;let M=new URLSearchParams(I.search),k=M.getAll("index");if(k.some(V=>V==="")){M.delete("index"),k.filter(K=>K).forEach(K=>M.append("index",K));let V=M.toString();I.search=V?`?${V}`:""}}return(!o||o===".")&&T.route.index&&(I.search=I.search?I.search.replace(/^\?/,"?index&"):"?index"),h!=="/"&&(I.pathname=I.pathname==="/"?h:fy([h,I.pathname])),u5(I)}function tfe(o,d={}){let h=q.useContext(Zie);Os(h!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:g}=cae("useViewTransitionState"),T=P5(o,{relative:d.relative});if(!h.isTransitioning)return!1;let I=py(h.currentLocation.pathname,g)||h.currentLocation.pathname,N=py(h.nextLocation.pathname,g)||h.nextLocation.pathname;return H7(T.pathname,N)!=null||H7(T.pathname,I)!=null}[...jue];var lae=Kie();const u7=_G(lae),yP="/assets/bgImage-eisf-1Pf.png",nfe="/assets/bgCouplePhoto-BvE6h9OX.png",rfe="/assets/logoFull-C8RTxQFw.png";function yE({children:o,titleText:d,text:h,hasButton:g,buttonText:T="NEXT",hasSkip:I,onButtonClick:N,onSkipClick:M}){return j.jsx("div",{className:"min-h-screen flex items-center justify-center bg-cover bg-center",style:{backgroundImage:`url(${yP})`},children:j.jsxs("div",{className:"w-full max-w-4xl bg-white rounded-2xl shadow-lg overflow-hidden flex flex-col md:flex-row",children:[j.jsxs("div",{className:"md:w-1/2 relative flex items-center justify-center bg-cover bg-center rounded-l-2xl",style:{backgroundImage:`url(${nfe})`},children:[j.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-[#00A3E0]/70 to-[#00D4FF]/70 z-0 rounded-l-xl"}),j.jsxs("div",{className:"relative z-10 text-center text-white flex flex-col items-center justify-center p-8 space-y-4",children:[j.jsx("img",{src:rfe,alt:"Logo",style:{filter:"brightness(0) invert(1)",width:"70%"},className:"mb-4"}),j.jsx("h1",{className:"text-xl md:text-2xl font-bold max-w-xs md:max-w-sm leading-snug text-balance",children:d||"Your Missing Piece is Here"}),j.jsx("p",{className:"text-sm md:text-base max-w-xs md:max-w-sm leading-relaxed text-balance",children:h||"Create your profile and dive in."}),j.jsxs("div",{className:"flex gap-x-4 justify-between",children:[g&&j.jsx("button",{type:"button",onClick:N,className:"mt-4 px-5 py-2 rounded-lg bg-white shadow-md hover:shadow-lg transition",children:j.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-[#00A3E0] to-[#00D4FF] font-semibold",children:T})}),I&&j.jsx("button",{type:"button",onClick:M,className:"mt-4 px-5 py-2 rounded-lg transition",children:j.jsx("span",{className:"text-transparent bg-clip-text font-semibold bg-white",children:"SKIP FOR NOW"})})]})]})]}),j.jsx("div",{className:"md:w-4/5 bg-gradient-to-br from-[#00A3E0]/70 to-[#00A3E0]",children:j.jsx("div",{className:"rounded-xl p-10 bg-white",children:o})})]})})}function dae(o,d){return function(){return o.apply(d,arguments)}}const{toString:ife}=Object.prototype,{getPrototypeOf:IQ}=Object,{iterator:yG,toStringTag:uae}=Symbol,TG=(o=>d=>{const h=ife.call(d);return o[h]||(o[h]=h.slice(8,-1).toLowerCase())})(Object.create(null)),m0=o=>(o=o.toLowerCase(),d=>TG(d)===o),bG=o=>d=>typeof d===o,{isArray:xP}=Array,f5=bG("undefined");function afe(o){return o!==null&&!f5(o)&&o.constructor!==null&&!f5(o.constructor)&&vf(o.constructor.isBuffer)&&o.constructor.isBuffer(o)}const fae=m0("ArrayBuffer");function sfe(o){let d;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?d=ArrayBuffer.isView(o):d=o&&o.buffer&&fae(o.buffer),d}const ofe=bG("string"),vf=bG("function"),hae=bG("number"),CG=o=>o!==null&&typeof o=="object",cfe=o=>o===!0||o===!1,R7=o=>{if(TG(o)!=="object")return!1;const d=IQ(o);return(d===null||d===Object.prototype||Object.getPrototypeOf(d)===null)&&!(uae in o)&&!(yG in o)},lfe=m0("Date"),dfe=m0("File"),ufe=m0("Blob"),ffe=m0("FileList"),hfe=o=>CG(o)&&vf(o.pipe),pfe=o=>{let d;return o&&(typeof FormData=="function"&&o instanceof FormData||vf(o.append)&&((d=TG(o))==="formdata"||d==="object"&&vf(o.toString)&&o.toString()==="[object FormData]"))},mfe=m0("URLSearchParams"),[gfe,_fe,Efe,vfe]=["ReadableStream","Request","Response","Headers"].map(m0),Sfe=o=>o.trim?o.trim():o.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function M5(o,d,{allOwnKeys:h=!1}={}){if(o===null||typeof o>"u")return;let g,T;if(typeof o!="object"&&(o=[o]),xP(o))for(g=0,T=o.length;g<T;g++)d.call(null,o[g],g,o);else{const I=h?Object.getOwnPropertyNames(o):Object.keys(o),N=I.length;let M;for(g=0;g<N;g++)M=I[g],d.call(null,o[M],M,o)}}function pae(o,d){d=d.toLowerCase();const h=Object.keys(o);let g=h.length,T;for(;g-- >0;)if(T=h[g],d===T.toLowerCase())return T;return null}const NA=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,mae=o=>!f5(o)&&o!==NA;function LX(){const{caseless:o}=mae(this)&&this||{},d={},h=(g,T)=>{const I=o&&pae(d,T)||T;R7(d[I])&&R7(g)?d[I]=LX(d[I],g):R7(g)?d[I]=LX({},g):xP(g)?d[I]=g.slice():d[I]=g};for(let g=0,T=arguments.length;g<T;g++)arguments[g]&&M5(arguments[g],h);return d}const yfe=(o,d,h,{allOwnKeys:g}={})=>(M5(d,(T,I)=>{h&&vf(T)?o[I]=dae(T,h):o[I]=T},{allOwnKeys:g}),o),Tfe=o=>(o.charCodeAt(0)===65279&&(o=o.slice(1)),o),bfe=(o,d,h,g)=>{o.prototype=Object.create(d.prototype,g),o.prototype.constructor=o,Object.defineProperty(o,"super",{value:d.prototype}),h&&Object.assign(o.prototype,h)},Cfe=(o,d,h,g)=>{let T,I,N;const M={};if(d=d||{},o==null)return d;do{for(T=Object.getOwnPropertyNames(o),I=T.length;I-- >0;)N=T[I],(!g||g(N,o,d))&&!M[N]&&(d[N]=o[N],M[N]=!0);o=h!==!1&&IQ(o)}while(o&&(!h||h(o,d))&&o!==Object.prototype);return d},wfe=(o,d,h)=>{o=String(o),(h===void 0||h>o.length)&&(h=o.length),h-=d.length;const g=o.indexOf(d,h);return g!==-1&&g===h},Rfe=o=>{if(!o)return null;if(xP(o))return o;let d=o.length;if(!hae(d))return null;const h=new Array(d);for(;d-- >0;)h[d]=o[d];return h},Ife=(o=>d=>o&&d instanceof o)(typeof Uint8Array<"u"&&IQ(Uint8Array)),Afe=(o,d)=>{const g=(o&&o[yG]).call(o);let T;for(;(T=g.next())&&!T.done;){const I=T.value;d.call(o,I[0],I[1])}},Ofe=(o,d)=>{let h;const g=[];for(;(h=o.exec(d))!==null;)g.push(h);return g},Nfe=m0("HTMLFormElement"),Lfe=o=>o.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(h,g,T){return g.toUpperCase()+T}),A$=(({hasOwnProperty:o})=>(d,h)=>o.call(d,h))(Object.prototype),Dfe=m0("RegExp"),gae=(o,d)=>{const h=Object.getOwnPropertyDescriptors(o),g={};M5(h,(T,I)=>{let N;(N=d(T,I,o))!==!1&&(g[I]=N||T)}),Object.defineProperties(o,g)},Pfe=o=>{gae(o,(d,h)=>{if(vf(o)&&["arguments","caller","callee"].indexOf(h)!==-1)return!1;const g=o[h];if(vf(g)){if(d.enumerable=!1,"writable"in d){d.writable=!1;return}d.set||(d.set=()=>{throw Error("Can not rewrite read-only method '"+h+"'")})}})},Mfe=(o,d)=>{const h={},g=T=>{T.forEach(I=>{h[I]=!0})};return xP(o)?g(o):g(String(o).split(d)),h},kfe=()=>{},xfe=(o,d)=>o!=null&&Number.isFinite(o=+o)?o:d;function Ufe(o){return!!(o&&vf(o.append)&&o[uae]==="FormData"&&o[yG])}const jfe=o=>{const d=new Array(10),h=(g,T)=>{if(CG(g)){if(d.indexOf(g)>=0)return;if(!("toJSON"in g)){d[T]=g;const I=xP(g)?[]:{};return M5(g,(N,M)=>{const k=h(N,T+1);!f5(k)&&(I[M]=k)}),d[T]=void 0,I}}return g};return h(o,0)},Vfe=m0("AsyncFunction"),Bfe=o=>o&&(CG(o)||vf(o))&&vf(o.then)&&vf(o.catch),_ae=((o,d)=>o?setImmediate:d?((h,g)=>(NA.addEventListener("message",({source:T,data:I})=>{T===NA&&I===h&&g.length&&g.shift()()},!1),T=>{g.push(T),NA.postMessage(h,"*")}))(`axios@${Math.random()}`,[]):h=>setTimeout(h))(typeof setImmediate=="function",vf(NA.postMessage)),Ffe=typeof queueMicrotask<"u"?queueMicrotask.bind(NA):typeof process<"u"&&process.nextTick||_ae,Gfe=o=>o!=null&&vf(o[yG]),vt={isArray:xP,isArrayBuffer:fae,isBuffer:afe,isFormData:pfe,isArrayBufferView:sfe,isString:ofe,isNumber:hae,isBoolean:cfe,isObject:CG,isPlainObject:R7,isReadableStream:gfe,isRequest:_fe,isResponse:Efe,isHeaders:vfe,isUndefined:f5,isDate:lfe,isFile:dfe,isBlob:ufe,isRegExp:Dfe,isFunction:vf,isStream:hfe,isURLSearchParams:mfe,isTypedArray:Ife,isFileList:ffe,forEach:M5,merge:LX,extend:yfe,trim:Sfe,stripBOM:Tfe,inherits:bfe,toFlatObject:Cfe,kindOf:TG,kindOfTest:m0,endsWith:wfe,toArray:Rfe,forEachEntry:Afe,matchAll:Ofe,isHTMLForm:Nfe,hasOwnProperty:A$,hasOwnProp:A$,reduceDescriptors:gae,freezeMethods:Pfe,toObjectSet:Mfe,toCamelCase:Lfe,noop:kfe,toFiniteNumber:xfe,findKey:pae,global:NA,isContextDefined:mae,isSpecCompliantForm:Ufe,toJSONObject:jfe,isAsyncFn:Vfe,isThenable:Bfe,setImmediate:_ae,asap:Ffe,isIterable:Gfe};function Yr(o,d,h,g,T){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=o,this.name="AxiosError",d&&(this.code=d),h&&(this.config=h),g&&(this.request=g),T&&(this.response=T,this.status=T.status?T.status:null)}vt.inherits(Yr,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:vt.toJSONObject(this.config),code:this.code,status:this.status}}});const Eae=Yr.prototype,vae={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(o=>{vae[o]={value:o}});Object.defineProperties(Yr,vae);Object.defineProperty(Eae,"isAxiosError",{value:!0});Yr.from=(o,d,h,g,T,I)=>{const N=Object.create(Eae);return vt.toFlatObject(o,N,function(k){return k!==Error.prototype},M=>M!=="isAxiosError"),Yr.call(N,o.message,d,h,g,T),N.cause=o,N.name=o.name,I&&Object.assign(N,I),N};const zfe=null;function DX(o){return vt.isPlainObject(o)||vt.isArray(o)}function Sae(o){return vt.endsWith(o,"[]")?o.slice(0,-2):o}function O$(o,d,h){return o?o.concat(d).map(function(T,I){return T=Sae(T),!h&&I?"["+T+"]":T}).join(h?".":""):d}function Hfe(o){return vt.isArray(o)&&!o.some(DX)}const Wfe=vt.toFlatObject(vt,{},null,function(d){return/^is[A-Z]/.test(d)});function wG(o,d,h){if(!vt.isObject(o))throw new TypeError("target must be an object");d=d||new FormData,h=vt.toFlatObject(h,{metaTokens:!0,dots:!1,indexes:!1},!1,function(Z,ae){return!vt.isUndefined(ae[Z])});const g=h.metaTokens,T=h.visitor||V,I=h.dots,N=h.indexes,k=(h.Blob||typeof Blob<"u"&&Blob)&&vt.isSpecCompliantForm(d);if(!vt.isFunction(T))throw new TypeError("visitor must be a function");function x(X){if(X===null)return"";if(vt.isDate(X))return X.toISOString();if(vt.isBoolean(X))return X.toString();if(!k&&vt.isBlob(X))throw new Yr("Blob is not supported. Use a Buffer instead.");return vt.isArrayBuffer(X)||vt.isTypedArray(X)?k&&typeof Blob=="function"?new Blob([X]):Buffer.from(X):X}function V(X,Z,ae){let le=X;if(X&&!ae&&typeof X=="object"){if(vt.endsWith(Z,"{}"))Z=g?Z:Z.slice(0,-2),X=JSON.stringify(X);else if(vt.isArray(X)&&Hfe(X)||(vt.isFileList(X)||vt.endsWith(Z,"[]"))&&(le=vt.toArray(X)))return Z=Sae(Z),le.forEach(function(ue,de){!(vt.isUndefined(ue)||ue===null)&&d.append(N===!0?O$([Z],de,I):N===null?Z:Z+"[]",x(ue))}),!1}return DX(X)?!0:(d.append(O$(ae,Z,I),x(X)),!1)}const K=[],Q=Object.assign(Wfe,{defaultVisitor:V,convertValue:x,isVisitable:DX});function ie(X,Z){if(!vt.isUndefined(X)){if(K.indexOf(X)!==-1)throw Error("Circular reference detected in "+Z.join("."));K.push(X),vt.forEach(X,function(le,fe){(!(vt.isUndefined(le)||le===null)&&T.call(d,le,vt.isString(fe)?fe.trim():fe,Z,Q))===!0&&ie(le,Z?Z.concat(fe):[fe])}),K.pop()}}if(!vt.isObject(o))throw new TypeError("data must be an object");return ie(o),d}function N$(o){const d={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(o).replace(/[!'()~]|%20|%00/g,function(g){return d[g]})}function AQ(o,d){this._pairs=[],o&&wG(o,this,d)}const yae=AQ.prototype;yae.append=function(d,h){this._pairs.push([d,h])};yae.toString=function(d){const h=d?function(g){return d.call(this,g,N$)}:N$;return this._pairs.map(function(T){return h(T[0])+"="+h(T[1])},"").join("&")};function Yfe(o){return encodeURIComponent(o).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Tae(o,d,h){if(!d)return o;const g=h&&h.encode||Yfe;vt.isFunction(h)&&(h={serialize:h});const T=h&&h.serialize;let I;if(T?I=T(d,h):I=vt.isURLSearchParams(d)?d.toString():new AQ(d,h).toString(g),I){const N=o.indexOf("#");N!==-1&&(o=o.slice(0,N)),o+=(o.indexOf("?")===-1?"?":"&")+I}return o}class L${constructor(){this.handlers=[]}use(d,h,g){return this.handlers.push({fulfilled:d,rejected:h,synchronous:g?g.synchronous:!1,runWhen:g?g.runWhen:null}),this.handlers.length-1}eject(d){this.handlers[d]&&(this.handlers[d]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(d){vt.forEach(this.handlers,function(g){g!==null&&d(g)})}}const bae={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Kfe=typeof URLSearchParams<"u"?URLSearchParams:AQ,qfe=typeof FormData<"u"?FormData:null,Jfe=typeof Blob<"u"?Blob:null,Xfe={isBrowser:!0,classes:{URLSearchParams:Kfe,FormData:qfe,Blob:Jfe},protocols:["http","https","file","blob","url","data"]},OQ=typeof window<"u"&&typeof document<"u",PX=typeof navigator=="object"&&navigator||void 0,Qfe=OQ&&(!PX||["ReactNative","NativeScript","NS"].indexOf(PX.product)<0),Zfe=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",$fe=OQ&&window.location.href||"http://localhost",ehe=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:OQ,hasStandardBrowserEnv:Qfe,hasStandardBrowserWebWorkerEnv:Zfe,navigator:PX,origin:$fe},Symbol.toStringTag,{value:"Module"})),Ed={...ehe,...Xfe};function the(o,d){return wG(o,new Ed.classes.URLSearchParams,Object.assign({visitor:function(h,g,T,I){return Ed.isNode&&vt.isBuffer(h)?(this.append(g,h.toString("base64")),!1):I.defaultVisitor.apply(this,arguments)}},d))}function nhe(o){return vt.matchAll(/\w+|\[(\w*)]/g,o).map(d=>d[0]==="[]"?"":d[1]||d[0])}function rhe(o){const d={},h=Object.keys(o);let g;const T=h.length;let I;for(g=0;g<T;g++)I=h[g],d[I]=o[I];return d}function Cae(o){function d(h,g,T,I){let N=h[I++];if(N==="__proto__")return!0;const M=Number.isFinite(+N),k=I>=h.length;return N=!N&&vt.isArray(T)?T.length:N,k?(vt.hasOwnProp(T,N)?T[N]=[T[N],g]:T[N]=g,!M):((!T[N]||!vt.isObject(T[N]))&&(T[N]=[]),d(h,g,T[N],I)&&vt.isArray(T[N])&&(T[N]=rhe(T[N])),!M)}if(vt.isFormData(o)&&vt.isFunction(o.entries)){const h={};return vt.forEachEntry(o,(g,T)=>{d(nhe(g),T,h,0)}),h}return null}function ihe(o,d,h){if(vt.isString(o))try{return(d||JSON.parse)(o),vt.trim(o)}catch(g){if(g.name!=="SyntaxError")throw g}return(h||JSON.stringify)(o)}const k5={transitional:bae,adapter:["xhr","http","fetch"],transformRequest:[function(d,h){const g=h.getContentType()||"",T=g.indexOf("application/json")>-1,I=vt.isObject(d);if(I&&vt.isHTMLForm(d)&&(d=new FormData(d)),vt.isFormData(d))return T?JSON.stringify(Cae(d)):d;if(vt.isArrayBuffer(d)||vt.isBuffer(d)||vt.isStream(d)||vt.isFile(d)||vt.isBlob(d)||vt.isReadableStream(d))return d;if(vt.isArrayBufferView(d))return d.buffer;if(vt.isURLSearchParams(d))return h.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),d.toString();let M;if(I){if(g.indexOf("application/x-www-form-urlencoded")>-1)return the(d,this.formSerializer).toString();if((M=vt.isFileList(d))||g.indexOf("multipart/form-data")>-1){const k=this.env&&this.env.FormData;return wG(M?{"files[]":d}:d,k&&new k,this.formSerializer)}}return I||T?(h.setContentType("application/json",!1),ihe(d)):d}],transformResponse:[function(d){const h=this.transitional||k5.transitional,g=h&&h.forcedJSONParsing,T=this.responseType==="json";if(vt.isResponse(d)||vt.isReadableStream(d))return d;if(d&&vt.isString(d)&&(g&&!this.responseType||T)){const N=!(h&&h.silentJSONParsing)&&T;try{return JSON.parse(d)}catch(M){if(N)throw M.name==="SyntaxError"?Yr.from(M,Yr.ERR_BAD_RESPONSE,this,null,this.response):M}}return d}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Ed.classes.FormData,Blob:Ed.classes.Blob},validateStatus:function(d){return d>=200&&d<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};vt.forEach(["delete","get","head","post","put","patch"],o=>{k5.headers[o]={}});const ahe=vt.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),she=o=>{const d={};let h,g,T;return o&&o.split(`
`).forEach(function(N){T=N.indexOf(":"),h=N.substring(0,T).trim().toLowerCase(),g=N.substring(T+1).trim(),!(!h||d[h]&&ahe[h])&&(h==="set-cookie"?d[h]?d[h].push(g):d[h]=[g]:d[h]=d[h]?d[h]+", "+g:g)}),d},D$=Symbol("internals");function Vj(o){return o&&String(o).trim().toLowerCase()}function I7(o){return o===!1||o==null?o:vt.isArray(o)?o.map(I7):String(o)}function ohe(o){const d=Object.create(null),h=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let g;for(;g=h.exec(o);)d[g[1]]=g[2];return d}const che=o=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(o.trim());function LK(o,d,h,g,T){if(vt.isFunction(g))return g.call(this,d,h);if(T&&(d=h),!!vt.isString(d)){if(vt.isString(g))return d.indexOf(g)!==-1;if(vt.isRegExp(g))return g.test(d)}}function lhe(o){return o.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(d,h,g)=>h.toUpperCase()+g)}function dhe(o,d){const h=vt.toCamelCase(" "+d);["get","set","has"].forEach(g=>{Object.defineProperty(o,g+h,{value:function(T,I,N){return this[g].call(this,d,T,I,N)},configurable:!0})})}let Sf=class{constructor(d){d&&this.set(d)}set(d,h,g){const T=this;function I(M,k,x){const V=Vj(k);if(!V)throw new Error("header name must be a non-empty string");const K=vt.findKey(T,V);(!K||T[K]===void 0||x===!0||x===void 0&&T[K]!==!1)&&(T[K||k]=I7(M))}const N=(M,k)=>vt.forEach(M,(x,V)=>I(x,V,k));if(vt.isPlainObject(d)||d instanceof this.constructor)N(d,h);else if(vt.isString(d)&&(d=d.trim())&&!che(d))N(she(d),h);else if(vt.isObject(d)&&vt.isIterable(d)){let M={},k,x;for(const V of d){if(!vt.isArray(V))throw TypeError("Object iterator must return a key-value pair");M[x=V[0]]=(k=M[x])?vt.isArray(k)?[...k,V[1]]:[k,V[1]]:V[1]}N(M,h)}else d!=null&&I(h,d,g);return this}get(d,h){if(d=Vj(d),d){const g=vt.findKey(this,d);if(g){const T=this[g];if(!h)return T;if(h===!0)return ohe(T);if(vt.isFunction(h))return h.call(this,T,g);if(vt.isRegExp(h))return h.exec(T);throw new TypeError("parser must be boolean|regexp|function")}}}has(d,h){if(d=Vj(d),d){const g=vt.findKey(this,d);return!!(g&&this[g]!==void 0&&(!h||LK(this,this[g],g,h)))}return!1}delete(d,h){const g=this;let T=!1;function I(N){if(N=Vj(N),N){const M=vt.findKey(g,N);M&&(!h||LK(g,g[M],M,h))&&(delete g[M],T=!0)}}return vt.isArray(d)?d.forEach(I):I(d),T}clear(d){const h=Object.keys(this);let g=h.length,T=!1;for(;g--;){const I=h[g];(!d||LK(this,this[I],I,d,!0))&&(delete this[I],T=!0)}return T}normalize(d){const h=this,g={};return vt.forEach(this,(T,I)=>{const N=vt.findKey(g,I);if(N){h[N]=I7(T),delete h[I];return}const M=d?lhe(I):String(I).trim();M!==I&&delete h[I],h[M]=I7(T),g[M]=!0}),this}concat(...d){return this.constructor.concat(this,...d)}toJSON(d){const h=Object.create(null);return vt.forEach(this,(g,T)=>{g!=null&&g!==!1&&(h[T]=d&&vt.isArray(g)?g.join(", "):g)}),h}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([d,h])=>d+": "+h).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(d){return d instanceof this?d:new this(d)}static concat(d,...h){const g=new this(d);return h.forEach(T=>g.set(T)),g}static accessor(d){const g=(this[D$]=this[D$]={accessors:{}}).accessors,T=this.prototype;function I(N){const M=Vj(N);g[M]||(dhe(T,N),g[M]=!0)}return vt.isArray(d)?d.forEach(I):I(d),this}};Sf.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);vt.reduceDescriptors(Sf.prototype,({value:o},d)=>{let h=d[0].toUpperCase()+d.slice(1);return{get:()=>o,set(g){this[h]=g}}});vt.freezeMethods(Sf);function DK(o,d){const h=this||k5,g=d||h,T=Sf.from(g.headers);let I=g.data;return vt.forEach(o,function(M){I=M.call(h,I,T.normalize(),d?d.status:void 0)}),T.normalize(),I}function wae(o){return!!(o&&o.__CANCEL__)}function UP(o,d,h){Yr.call(this,o??"canceled",Yr.ERR_CANCELED,d,h),this.name="CanceledError"}vt.inherits(UP,Yr,{__CANCEL__:!0});function Rae(o,d,h){const g=h.config.validateStatus;!h.status||!g||g(h.status)?o(h):d(new Yr("Request failed with status code "+h.status,[Yr.ERR_BAD_REQUEST,Yr.ERR_BAD_RESPONSE][Math.floor(h.status/100)-4],h.config,h.request,h))}function uhe(o){const d=/^([-+\w]{1,25})(:?\/\/|:)/.exec(o);return d&&d[1]||""}function fhe(o,d){o=o||10;const h=new Array(o),g=new Array(o);let T=0,I=0,N;return d=d!==void 0?d:1e3,function(k){const x=Date.now(),V=g[I];N||(N=x),h[T]=k,g[T]=x;let K=I,Q=0;for(;K!==T;)Q+=h[K++],K=K%o;if(T=(T+1)%o,T===I&&(I=(I+1)%o),x-N<d)return;const ie=V&&x-V;return ie?Math.round(Q*1e3/ie):void 0}}function hhe(o,d){let h=0,g=1e3/d,T,I;const N=(x,V=Date.now())=>{h=V,T=null,I&&(clearTimeout(I),I=null),o.apply(null,x)};return[(...x)=>{const V=Date.now(),K=V-h;K>=g?N(x,V):(T=x,I||(I=setTimeout(()=>{I=null,N(T)},g-K)))},()=>T&&N(T)]}const W7=(o,d,h=3)=>{let g=0;const T=fhe(50,250);return hhe(I=>{const N=I.loaded,M=I.lengthComputable?I.total:void 0,k=N-g,x=T(k),V=N<=M;g=N;const K={loaded:N,total:M,progress:M?N/M:void 0,bytes:k,rate:x||void 0,estimated:x&&M&&V?(M-N)/x:void 0,event:I,lengthComputable:M!=null,[d?"download":"upload"]:!0};o(K)},h)},P$=(o,d)=>{const h=o!=null;return[g=>d[0]({lengthComputable:h,total:o,loaded:g}),d[1]]},M$=o=>(...d)=>vt.asap(()=>o(...d)),phe=Ed.hasStandardBrowserEnv?((o,d)=>h=>(h=new URL(h,Ed.origin),o.protocol===h.protocol&&o.host===h.host&&(d||o.port===h.port)))(new URL(Ed.origin),Ed.navigator&&/(msie|trident)/i.test(Ed.navigator.userAgent)):()=>!0,mhe=Ed.hasStandardBrowserEnv?{write(o,d,h,g,T,I){const N=[o+"="+encodeURIComponent(d)];vt.isNumber(h)&&N.push("expires="+new Date(h).toGMTString()),vt.isString(g)&&N.push("path="+g),vt.isString(T)&&N.push("domain="+T),I===!0&&N.push("secure"),document.cookie=N.join("; ")},read(o){const d=document.cookie.match(new RegExp("(^|;\\s*)("+o+")=([^;]*)"));return d?decodeURIComponent(d[3]):null},remove(o){this.write(o,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function ghe(o){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(o)}function _he(o,d){return d?o.replace(/\/?\/$/,"")+"/"+d.replace(/^\/+/,""):o}function Iae(o,d,h){let g=!ghe(d);return o&&(g||h==!1)?_he(o,d):d}const k$=o=>o instanceof Sf?{...o}:o;function VA(o,d){d=d||{};const h={};function g(x,V,K,Q){return vt.isPlainObject(x)&&vt.isPlainObject(V)?vt.merge.call({caseless:Q},x,V):vt.isPlainObject(V)?vt.merge({},V):vt.isArray(V)?V.slice():V}function T(x,V,K,Q){if(vt.isUndefined(V)){if(!vt.isUndefined(x))return g(void 0,x,K,Q)}else return g(x,V,K,Q)}function I(x,V){if(!vt.isUndefined(V))return g(void 0,V)}function N(x,V){if(vt.isUndefined(V)){if(!vt.isUndefined(x))return g(void 0,x)}else return g(void 0,V)}function M(x,V,K){if(K in d)return g(x,V);if(K in o)return g(void 0,x)}const k={url:I,method:I,data:I,baseURL:N,transformRequest:N,transformResponse:N,paramsSerializer:N,timeout:N,timeoutMessage:N,withCredentials:N,withXSRFToken:N,adapter:N,responseType:N,xsrfCookieName:N,xsrfHeaderName:N,onUploadProgress:N,onDownloadProgress:N,decompress:N,maxContentLength:N,maxBodyLength:N,beforeRedirect:N,transport:N,httpAgent:N,httpsAgent:N,cancelToken:N,socketPath:N,responseEncoding:N,validateStatus:M,headers:(x,V,K)=>T(k$(x),k$(V),K,!0)};return vt.forEach(Object.keys(Object.assign({},o,d)),function(V){const K=k[V]||T,Q=K(o[V],d[V],V);vt.isUndefined(Q)&&K!==M||(h[V]=Q)}),h}const Aae=o=>{const d=VA({},o);let{data:h,withXSRFToken:g,xsrfHeaderName:T,xsrfCookieName:I,headers:N,auth:M}=d;d.headers=N=Sf.from(N),d.url=Tae(Iae(d.baseURL,d.url,d.allowAbsoluteUrls),o.params,o.paramsSerializer),M&&N.set("Authorization","Basic "+btoa((M.username||"")+":"+(M.password?unescape(encodeURIComponent(M.password)):"")));let k;if(vt.isFormData(h)){if(Ed.hasStandardBrowserEnv||Ed.hasStandardBrowserWebWorkerEnv)N.setContentType(void 0);else if((k=N.getContentType())!==!1){const[x,...V]=k?k.split(";").map(K=>K.trim()).filter(Boolean):[];N.setContentType([x||"multipart/form-data",...V].join("; "))}}if(Ed.hasStandardBrowserEnv&&(g&&vt.isFunction(g)&&(g=g(d)),g||g!==!1&&phe(d.url))){const x=T&&I&&mhe.read(I);x&&N.set(T,x)}return d},Ehe=typeof XMLHttpRequest<"u",vhe=Ehe&&function(o){return new Promise(function(h,g){const T=Aae(o);let I=T.data;const N=Sf.from(T.headers).normalize();let{responseType:M,onUploadProgress:k,onDownloadProgress:x}=T,V,K,Q,ie,X;function Z(){ie&&ie(),X&&X(),T.cancelToken&&T.cancelToken.unsubscribe(V),T.signal&&T.signal.removeEventListener("abort",V)}let ae=new XMLHttpRequest;ae.open(T.method.toUpperCase(),T.url,!0),ae.timeout=T.timeout;function le(){if(!ae)return;const ue=Sf.from("getAllResponseHeaders"in ae&&ae.getAllResponseHeaders()),te={data:!M||M==="text"||M==="json"?ae.responseText:ae.response,status:ae.status,statusText:ae.statusText,headers:ue,config:o,request:ae};Rae(function(Te){h(Te),Z()},function(Te){g(Te),Z()},te),ae=null}"onloadend"in ae?ae.onloadend=le:ae.onreadystatechange=function(){!ae||ae.readyState!==4||ae.status===0&&!(ae.responseURL&&ae.responseURL.indexOf("file:")===0)||setTimeout(le)},ae.onabort=function(){ae&&(g(new Yr("Request aborted",Yr.ECONNABORTED,o,ae)),ae=null)},ae.onerror=function(){g(new Yr("Network Error",Yr.ERR_NETWORK,o,ae)),ae=null},ae.ontimeout=function(){let de=T.timeout?"timeout of "+T.timeout+"ms exceeded":"timeout exceeded";const te=T.transitional||bae;T.timeoutErrorMessage&&(de=T.timeoutErrorMessage),g(new Yr(de,te.clarifyTimeoutError?Yr.ETIMEDOUT:Yr.ECONNABORTED,o,ae)),ae=null},I===void 0&&N.setContentType(null),"setRequestHeader"in ae&&vt.forEach(N.toJSON(),function(de,te){ae.setRequestHeader(te,de)}),vt.isUndefined(T.withCredentials)||(ae.withCredentials=!!T.withCredentials),M&&M!=="json"&&(ae.responseType=T.responseType),x&&([Q,X]=W7(x,!0),ae.addEventListener("progress",Q)),k&&ae.upload&&([K,ie]=W7(k),ae.upload.addEventListener("progress",K),ae.upload.addEventListener("loadend",ie)),(T.cancelToken||T.signal)&&(V=ue=>{ae&&(g(!ue||ue.type?new UP(null,o,ae):ue),ae.abort(),ae=null)},T.cancelToken&&T.cancelToken.subscribe(V),T.signal&&(T.signal.aborted?V():T.signal.addEventListener("abort",V)));const fe=uhe(T.url);if(fe&&Ed.protocols.indexOf(fe)===-1){g(new Yr("Unsupported protocol "+fe+":",Yr.ERR_BAD_REQUEST,o));return}ae.send(I||null)})},She=(o,d)=>{const{length:h}=o=o?o.filter(Boolean):[];if(d||h){let g=new AbortController,T;const I=function(x){if(!T){T=!0,M();const V=x instanceof Error?x:this.reason;g.abort(V instanceof Yr?V:new UP(V instanceof Error?V.message:V))}};let N=d&&setTimeout(()=>{N=null,I(new Yr(`timeout ${d} of ms exceeded`,Yr.ETIMEDOUT))},d);const M=()=>{o&&(N&&clearTimeout(N),N=null,o.forEach(x=>{x.unsubscribe?x.unsubscribe(I):x.removeEventListener("abort",I)}),o=null)};o.forEach(x=>x.addEventListener("abort",I));const{signal:k}=g;return k.unsubscribe=()=>vt.asap(M),k}},yhe=function*(o,d){let h=o.byteLength;if(h<d){yield o;return}let g=0,T;for(;g<h;)T=g+d,yield o.slice(g,T),g=T},The=async function*(o,d){for await(const h of bhe(o))yield*yhe(h,d)},bhe=async function*(o){if(o[Symbol.asyncIterator]){yield*o;return}const d=o.getReader();try{for(;;){const{done:h,value:g}=await d.read();if(h)break;yield g}}finally{await d.cancel()}},x$=(o,d,h,g)=>{const T=The(o,d);let I=0,N,M=k=>{N||(N=!0,g&&g(k))};return new ReadableStream({async pull(k){try{const{done:x,value:V}=await T.next();if(x){M(),k.close();return}let K=V.byteLength;if(h){let Q=I+=K;h(Q)}k.enqueue(new Uint8Array(V))}catch(x){throw M(x),x}},cancel(k){return M(k),T.return()}},{highWaterMark:2})},RG=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",Oae=RG&&typeof ReadableStream=="function",Che=RG&&(typeof TextEncoder=="function"?(o=>d=>o.encode(d))(new TextEncoder):async o=>new Uint8Array(await new Response(o).arrayBuffer())),Nae=(o,...d)=>{try{return!!o(...d)}catch{return!1}},whe=Oae&&Nae(()=>{let o=!1;const d=new Request(Ed.origin,{body:new ReadableStream,method:"POST",get duplex(){return o=!0,"half"}}).headers.has("Content-Type");return o&&!d}),U$=64*1024,MX=Oae&&Nae(()=>vt.isReadableStream(new Response("").body)),Y7={stream:MX&&(o=>o.body)};RG&&(o=>{["text","arrayBuffer","blob","formData","stream"].forEach(d=>{!Y7[d]&&(Y7[d]=vt.isFunction(o[d])?h=>h[d]():(h,g)=>{throw new Yr(`Response type '${d}' is not supported`,Yr.ERR_NOT_SUPPORT,g)})})})(new Response);const Rhe=async o=>{if(o==null)return 0;if(vt.isBlob(o))return o.size;if(vt.isSpecCompliantForm(o))return(await new Request(Ed.origin,{method:"POST",body:o}).arrayBuffer()).byteLength;if(vt.isArrayBufferView(o)||vt.isArrayBuffer(o))return o.byteLength;if(vt.isURLSearchParams(o)&&(o=o+""),vt.isString(o))return(await Che(o)).byteLength},Ihe=async(o,d)=>{const h=vt.toFiniteNumber(o.getContentLength());return h??Rhe(d)},Ahe=RG&&(async o=>{let{url:d,method:h,data:g,signal:T,cancelToken:I,timeout:N,onDownloadProgress:M,onUploadProgress:k,responseType:x,headers:V,withCredentials:K="same-origin",fetchOptions:Q}=Aae(o);x=x?(x+"").toLowerCase():"text";let ie=She([T,I&&I.toAbortSignal()],N),X;const Z=ie&&ie.unsubscribe&&(()=>{ie.unsubscribe()});let ae;try{if(k&&whe&&h!=="get"&&h!=="head"&&(ae=await Ihe(V,g))!==0){let te=new Request(d,{method:"POST",body:g,duplex:"half"}),ye;if(vt.isFormData(g)&&(ye=te.headers.get("content-type"))&&V.setContentType(ye),te.body){const[Te,Le]=P$(ae,W7(M$(k)));g=x$(te.body,U$,Te,Le)}}vt.isString(K)||(K=K?"include":"omit");const le="credentials"in Request.prototype;X=new Request(d,{...Q,signal:ie,method:h.toUpperCase(),headers:V.normalize().toJSON(),body:g,duplex:"half",credentials:le?K:void 0});let fe=await fetch(X,Q);const ue=MX&&(x==="stream"||x==="response");if(MX&&(M||ue&&Z)){const te={};["status","statusText","headers"].forEach(je=>{te[je]=fe[je]});const ye=vt.toFiniteNumber(fe.headers.get("content-length")),[Te,Le]=M&&P$(ye,W7(M$(M),!0))||[];fe=new Response(x$(fe.body,U$,Te,()=>{Le&&Le(),Z&&Z()}),te)}x=x||"text";let de=await Y7[vt.findKey(Y7,x)||"text"](fe,o);return!ue&&Z&&Z(),await new Promise((te,ye)=>{Rae(te,ye,{data:de,headers:Sf.from(fe.headers),status:fe.status,statusText:fe.statusText,config:o,request:X})})}catch(le){throw Z&&Z(),le&&le.name==="TypeError"&&/Load failed|fetch/i.test(le.message)?Object.assign(new Yr("Network Error",Yr.ERR_NETWORK,o,X),{cause:le.cause||le}):Yr.from(le,le&&le.code,o,X)}}),kX={http:zfe,xhr:vhe,fetch:Ahe};vt.forEach(kX,(o,d)=>{if(o){try{Object.defineProperty(o,"name",{value:d})}catch{}Object.defineProperty(o,"adapterName",{value:d})}});const j$=o=>`- ${o}`,Ohe=o=>vt.isFunction(o)||o===null||o===!1,Lae={getAdapter:o=>{o=vt.isArray(o)?o:[o];const{length:d}=o;let h,g;const T={};for(let I=0;I<d;I++){h=o[I];let N;if(g=h,!Ohe(h)&&(g=kX[(N=String(h)).toLowerCase()],g===void 0))throw new Yr(`Unknown adapter '${N}'`);if(g)break;T[N||"#"+I]=g}if(!g){const I=Object.entries(T).map(([M,k])=>`adapter ${M} `+(k===!1?"is not supported by the environment":"is not available in the build"));let N=d?I.length>1?`since :
`+I.map(j$).join(`
`):" "+j$(I[0]):"as no adapter specified";throw new Yr("There is no suitable adapter to dispatch the request "+N,"ERR_NOT_SUPPORT")}return g},adapters:kX};function PK(o){if(o.cancelToken&&o.cancelToken.throwIfRequested(),o.signal&&o.signal.aborted)throw new UP(null,o)}function V$(o){return PK(o),o.headers=Sf.from(o.headers),o.data=DK.call(o,o.transformRequest),["post","put","patch"].indexOf(o.method)!==-1&&o.headers.setContentType("application/x-www-form-urlencoded",!1),Lae.getAdapter(o.adapter||k5.adapter)(o).then(function(g){return PK(o),g.data=DK.call(o,o.transformResponse,g),g.headers=Sf.from(g.headers),g},function(g){return wae(g)||(PK(o),g&&g.response&&(g.response.data=DK.call(o,o.transformResponse,g.response),g.response.headers=Sf.from(g.response.headers))),Promise.reject(g)})}const Dae="1.10.0",IG={};["object","boolean","number","function","string","symbol"].forEach((o,d)=>{IG[o]=function(g){return typeof g===o||"a"+(d<1?"n ":" ")+o}});const B$={};IG.transitional=function(d,h,g){function T(I,N){return"[Axios v"+Dae+"] Transitional option '"+I+"'"+N+(g?". "+g:"")}return(I,N,M)=>{if(d===!1)throw new Yr(T(N," has been removed"+(h?" in "+h:"")),Yr.ERR_DEPRECATED);return h&&!B$[N]&&(B$[N]=!0,console.warn(T(N," has been deprecated since v"+h+" and will be removed in the near future"))),d?d(I,N,M):!0}};IG.spelling=function(d){return(h,g)=>(console.warn(`${g} is likely a misspelling of ${d}`),!0)};function Nhe(o,d,h){if(typeof o!="object")throw new Yr("options must be an object",Yr.ERR_BAD_OPTION_VALUE);const g=Object.keys(o);let T=g.length;for(;T-- >0;){const I=g[T],N=d[I];if(N){const M=o[I],k=M===void 0||N(M,I,o);if(k!==!0)throw new Yr("option "+I+" must be "+k,Yr.ERR_BAD_OPTION_VALUE);continue}if(h!==!0)throw new Yr("Unknown option "+I,Yr.ERR_BAD_OPTION)}}const A7={assertOptions:Nhe,validators:IG},cE=A7.validators;let kA=class{constructor(d){this.defaults=d||{},this.interceptors={request:new L$,response:new L$}}async request(d,h){try{return await this._request(d,h)}catch(g){if(g instanceof Error){let T={};Error.captureStackTrace?Error.captureStackTrace(T):T=new Error;const I=T.stack?T.stack.replace(/^.+\n/,""):"";try{g.stack?I&&!String(g.stack).endsWith(I.replace(/^.+\n.+\n/,""))&&(g.stack+=`
`+I):g.stack=I}catch{}}throw g}}_request(d,h){typeof d=="string"?(h=h||{},h.url=d):h=d||{},h=VA(this.defaults,h);const{transitional:g,paramsSerializer:T,headers:I}=h;g!==void 0&&A7.assertOptions(g,{silentJSONParsing:cE.transitional(cE.boolean),forcedJSONParsing:cE.transitional(cE.boolean),clarifyTimeoutError:cE.transitional(cE.boolean)},!1),T!=null&&(vt.isFunction(T)?h.paramsSerializer={serialize:T}:A7.assertOptions(T,{encode:cE.function,serialize:cE.function},!0)),h.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?h.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:h.allowAbsoluteUrls=!0),A7.assertOptions(h,{baseUrl:cE.spelling("baseURL"),withXsrfToken:cE.spelling("withXSRFToken")},!0),h.method=(h.method||this.defaults.method||"get").toLowerCase();let N=I&&vt.merge(I.common,I[h.method]);I&&vt.forEach(["delete","get","head","post","put","patch","common"],X=>{delete I[X]}),h.headers=Sf.concat(N,I);const M=[];let k=!0;this.interceptors.request.forEach(function(Z){typeof Z.runWhen=="function"&&Z.runWhen(h)===!1||(k=k&&Z.synchronous,M.unshift(Z.fulfilled,Z.rejected))});const x=[];this.interceptors.response.forEach(function(Z){x.push(Z.fulfilled,Z.rejected)});let V,K=0,Q;if(!k){const X=[V$.bind(this),void 0];for(X.unshift.apply(X,M),X.push.apply(X,x),Q=X.length,V=Promise.resolve(h);K<Q;)V=V.then(X[K++],X[K++]);return V}Q=M.length;let ie=h;for(K=0;K<Q;){const X=M[K++],Z=M[K++];try{ie=X(ie)}catch(ae){Z.call(this,ae);break}}try{V=V$.call(this,ie)}catch(X){return Promise.reject(X)}for(K=0,Q=x.length;K<Q;)V=V.then(x[K++],x[K++]);return V}getUri(d){d=VA(this.defaults,d);const h=Iae(d.baseURL,d.url,d.allowAbsoluteUrls);return Tae(h,d.params,d.paramsSerializer)}};vt.forEach(["delete","get","head","options"],function(d){kA.prototype[d]=function(h,g){return this.request(VA(g||{},{method:d,url:h,data:(g||{}).data}))}});vt.forEach(["post","put","patch"],function(d){function h(g){return function(I,N,M){return this.request(VA(M||{},{method:d,headers:g?{"Content-Type":"multipart/form-data"}:{},url:I,data:N}))}}kA.prototype[d]=h(),kA.prototype[d+"Form"]=h(!0)});let Lhe=class Pae{constructor(d){if(typeof d!="function")throw new TypeError("executor must be a function.");let h;this.promise=new Promise(function(I){h=I});const g=this;this.promise.then(T=>{if(!g._listeners)return;let I=g._listeners.length;for(;I-- >0;)g._listeners[I](T);g._listeners=null}),this.promise.then=T=>{let I;const N=new Promise(M=>{g.subscribe(M),I=M}).then(T);return N.cancel=function(){g.unsubscribe(I)},N},d(function(I,N,M){g.reason||(g.reason=new UP(I,N,M),h(g.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(d){if(this.reason){d(this.reason);return}this._listeners?this._listeners.push(d):this._listeners=[d]}unsubscribe(d){if(!this._listeners)return;const h=this._listeners.indexOf(d);h!==-1&&this._listeners.splice(h,1)}toAbortSignal(){const d=new AbortController,h=g=>{d.abort(g)};return this.subscribe(h),d.signal.unsubscribe=()=>this.unsubscribe(h),d.signal}static source(){let d;return{token:new Pae(function(T){d=T}),cancel:d}}};function Dhe(o){return function(h){return o.apply(null,h)}}function Phe(o){return vt.isObject(o)&&o.isAxiosError===!0}const xX={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(xX).forEach(([o,d])=>{xX[d]=o});function Mae(o){const d=new kA(o),h=dae(kA.prototype.request,d);return vt.extend(h,kA.prototype,d,{allOwnKeys:!0}),vt.extend(h,d,null,{allOwnKeys:!0}),h.create=function(T){return Mae(VA(o,T))},h}const Do=Mae(k5);Do.Axios=kA;Do.CanceledError=UP;Do.CancelToken=Lhe;Do.isCancel=wae;Do.VERSION=Dae;Do.toFormData=wG;Do.AxiosError=Yr;Do.Cancel=Do.CanceledError;Do.all=function(d){return Promise.all(d)};Do.spread=Dhe;Do.isAxiosError=Phe;Do.mergeConfig=VA;Do.AxiosHeaders=Sf;Do.formToJSON=o=>Cae(vt.isHTMLForm(o)?new FormData(o):o);Do.getAdapter=Lae.getAdapter;Do.HttpStatusCode=xX;Do.default=Do;const{Axios:LLe,AxiosError:DLe,CanceledError:PLe,isCancel:MLe,CancelToken:kLe,VERSION:xLe,all:ULe,Cancel:jLe,isAxiosError:VLe,spread:BLe,toFormData:FLe,AxiosHeaders:GLe,HttpStatusCode:zLe,formToJSON:HLe,getAdapter:WLe,mergeConfig:YLe}=Do,Ur=Do.create({baseURL:"https://loveai-api.vrajtechnosys.in",headers:{"Content-Type":"application/json"}});Ur.interceptors.request.use(o=>{var h;const d=((h=JSON.parse(localStorage.getItem("user_Data")))==null?void 0:h.token)||localStorage.getItem("authToken");return d&&(o.headers.token=d),console.groupCollapsed(`%c [${o.method.toUpperCase()}] ${o.baseURL}${o.url}`,"color: #00aaff; font-weight: bold;"),console.log("Headers:",o.headers),console.log("Payload:",o.data),console.groupEnd(),o},o=>(console.error(" [Request Error]",o),Promise.reject(o)));Ur.interceptors.response.use(o=>(console.groupCollapsed(`%c [${o.status}] ${o.config.baseURL}${o.config.url}`,"color: #22aa22; font-weight: bold;"),console.log("Data:",o.data),console.groupEnd(),o),o=>(o.response?(console.groupCollapsed(`%c [${o.response.status}] ${o.config.baseURL}${o.config.url}`,"color: #ff4444; font-weight: bold;"),console.error("Error Data:",o.response.data),console.error("Headers:",o.response.headers),console.groupEnd()):console.error(" [Network/Error]",o.message),Promise.reject(o)));function Mhe(){return j.jsx(yE,{children:j.jsx(khe,{})})}function khe(){const o=xl(),d=q.useRef(null),h=q.useRef(null),[g,T]=q.useState("+91"),[I,N]=q.useState(!1),[M,k]=q.useState(""),x=async()=>{var X,Z,ae;k("");const K=d.current.value.trim(),Q=h.current.value.trim();if(!K&&!Q){k("Please enter a mobile number or an email.");return}const ie=K?{country_code:g,number:K}:{email:Q};try{N(!0);const le=await Ur.post("/send-otp",ie);le.data.errors?k((X=le.data.errors)==null?void 0:X.at(0)):(k(" OTP sent! Check your inbox/SMS."),localStorage.setItem("userId",le.data),o("/signup/verify"))}catch(le){k(((ae=(Z=le.response)==null?void 0:Z.data)==null?void 0:ae.message)||" Something went wrong sending the OTP.")}finally{N(!1)}},V=K=>{localStorage.setItem("userEmail",K.target.value)};return j.jsxs("div",{children:[j.jsx("h2",{className:"text-2xl font-bold mb-6 text-center text-gray-800",children:"Sign Up"}),j.jsx("h6",{className:"text-sm mb-6 text-gray-800 text-center",children:"Enter your mobile number or email to get started."}),j.jsxs("form",{className:"space-y-4",onSubmit:K=>{K.preventDefault(),x()},children:[j.jsx("label",{className:"text-sm",children:"Mobile Number"}),j.jsxs("div",{className:"flex items-center border border-blue-300 rounded-lg focus-within:ring-2 focus-within:ring-blue-400 overflow-hidden",children:[j.jsxs("select",{value:g,onChange:K=>T(K.target.value),className:"bg-white border-r px-2 py-2 text-sm outline-none text-gray-700",children:[j.jsx("option",{value:"+91",children:"+91"}),j.jsx("option",{value:"+1",children:"+1"}),j.jsx("option",{value:"+44",children:"+44"}),j.jsx("option",{value:"+972",children:"+972"})]}),j.jsx("input",{type:"tel",ref:d,placeholder:"Enter your mobile number",className:"flex-1 px-4 py-2 outline-none text-sm"})]}),j.jsxs("div",{className:"flex items-center justify-between my-2",children:[j.jsx("hr",{className:"w-full border-gray-300"}),j.jsx("span",{className:"px-2 text-gray-500",children:"or"}),j.jsx("hr",{className:"w-full border-gray-300"})]}),j.jsx("label",{className:"text-sm",children:"Email"}),j.jsx("input",{type:"text",ref:h,placeholder:"Enter your email address",onChange:V,className:"w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),j.jsxs("div",{className:"flex items-center justify-between my-2",children:[j.jsx("hr",{className:"w-full border-gray-300"}),j.jsx("span",{className:"px-2 text-gray-500",children:"or"}),j.jsx("hr",{className:"w-full border-gray-300"})]}),j.jsxs("div",{className:"flex gap-5",children:[j.jsxs("button",{type:"button",className:"w-1/2 flex items-center justify-center bg-white border border-gray-300 p-2 rounded-lg hover:bg-gray-100",children:[j.jsx("img",{src:"https://www.svgrepo.com/show/355037/google.svg",alt:"Google",className:"w-5 h-5 mr-2"}),"Google"]}),j.jsxs("button",{type:"button",className:"w-1/2 flex items-center justify-center bg-white border border-gray-300 p-2 rounded-lg hover:bg-gray-100",children:[j.jsx("img",{src:"https://www.svgrepo.com/show/475647/facebook-color.svg",alt:"Facebook",className:"w-5 h-5 mr-2"}),"Facebook"]})]}),j.jsx("button",{type:"submit",disabled:I,className:`w-full py-2 text-white mb-5 font-semibold rounded-lg bg-gradient-to-r from-[#00D4FF] to-[#00A3E0] ${I?"opacity-50 cursor-not-allowed":"hover:opacity-90"} transition`,children:I?"Sending":"Sign Up"})]}),j.jsx("div",{className:"min-h-[20px] mt-4 text-center text-sm transition-all duration-200",children:j.jsx("p",{className:`transition-opacity duration-200 ${M?M.startsWith("")?"text-green-600 opacity-100":"text-red-600 opacity-100":"opacity-0"}`,children:M||""})}),j.jsxs("div",{className:"text-center text-sm",children:["Already have an account?"," ",j.jsx("span",{className:"text-[#00A3E0] cursor-pointer",onClick:()=>o("/login"),children:"Sign In"})]}),j.jsx("div",{className:"text-[#00A3E0] text-center text-sm mt-1 cursor-pointer",children:"Forgot your password? Reset it here."})]})}function xhe(){return j.jsx(yE,{children:j.jsx(Uhe,{})})}function Uhe(){const[o,d]=q.useState(["","","","","",""]),[h,g]=q.useState(30),[T,I]=q.useState(!1),[N,M]=q.useState(""),k=xl();q.useEffect(()=>{if(h===0)return;const Q=setInterval(()=>{g(ie=>ie-1)},1e3);return()=>clearInterval(Q)},[h]);const x=(Q,ie)=>{var ae;const X=Q.target.value.slice(0,1),Z=[...o];Z[ie]=X,d(Z),X&&ie<6&&((ae=document.getElementById(`otp-${ie+1}`))==null||ae.focus())},V=(Q,ie)=>{var X;if(Q.key==="Backspace"){Q.preventDefault();const Z=[...o];Z[ie]="",d(Z),ie>0&&((X=document.getElementById(`otp-${ie-1}`))==null||X.focus())}},K=async()=>{var X,Z;const Q=o.join("");if(Q.length<4){M("Please enter all 4 digits.");return}const ie=localStorage.getItem("userId")||"<USER_ID>";I(!0),M("");try{await Ur.post("/verify-otp",{user_id:ie,otp:Q}),k("/signup/confirm-password"),M(" Verification successful!")}catch(ae){M(((Z=(X=ae.response)==null?void 0:X.data)==null?void 0:Z.message)||" OTP verification failed.")}finally{I(!1)}};return j.jsx("div",{className:"flex items-center justify-center px-4 py-16 bg-gray-50",children:j.jsxs("div",{className:"max-w-md w-full p-8 rounded-lg",children:[j.jsx("h2",{className:"text-2xl font-bold mb-2 text-center text-gray-800",children:"Verification Code"}),j.jsx("h6",{className:"text-sm mb-6 text-gray-600 text-center",children:"Enter the code sent to your mobile number."}),j.jsx("div",{className:"flex justify-center gap-4 mb-6",children:o.map((Q,ie)=>j.jsx("input",{id:`otp-${ie}`,type:"text",value:Q,onChange:X=>x(X,ie),onKeyDown:X=>V(X,ie),className:"w-12 text-center border-b-2 border-gray-400 text-xl bg-transparent focus:outline-none focus:border-blue-500",maxLength:1},ie))}),j.jsx("div",{className:"text-center text-sm text-gray-500 mb-4",children:h>0?j.jsxs(j.Fragment,{children:["Resend code in ",j.jsxs("span",{className:"font-semibold",children:[h,"s"]})]}):j.jsx("button",{onClick:()=>{g(30),M("")},className:"text-blue-600 hover:underline font-medium",children:"Resend Code"})}),j.jsx("button",{onClick:K,disabled:T,className:`w-full py-2 text-white font-semibold rounded-lg bg-gradient-to-r from-[#00D4FF] to-[#00A3E0] ${T?"opacity-50 cursor-not-allowed":"hover:opacity-90"} transition`,children:T?"Verifying":"Submit"}),j.jsx("div",{className:"min-h-[20px] mt-4 text-center text-sm transition-all duration-200",children:j.jsx("p",{className:`transition-opacity duration-200 ${N?N.startsWith("")?"text-green-600 opacity-100":"text-red-600 opacity-100":"opacity-0"}`,children:N||""})})]})})}function jhe(){return j.jsx(yE,{children:j.jsx(Vhe,{})})}function Vhe(){const[o,d]=q.useState(""),[h,g]=q.useState(""),[T,I]=q.useState(!1),[N,M]=q.useState(""),[k,x]=q.useState({}),[V,K]=q.useState(null),Q=xl();useEffect(()=>{(async()=>{try{const ue=await requestFCMToken();K(ue),console.log("firebase token",ue)}catch(ue){console.error("Error getting FCM Token :",ue)}})()},[]);const ie=fe=>{const ue={};return fe.match(/[A-Z]/)||(ue.uppercase="At least one uppercase letter required"),fe.length<8&&(ue.length="Minimum 8 characters required"),ue},Z=(fe=>{if(fe.length===0)return"";const ue=ie(fe);return Object.keys(ue).length===0?"Strong":fe.length>=6?"Moderate":"Weak"})(o),ae=Z==="Strong"?"bg-green-500":Z==="Moderate"?"bg-yellow-400":Z==="Weak"?"bg-red-500":"bg-gray-300",le=async()=>{var de,te;M("");const fe=ie(o);if(Object.keys(fe).length>0){x(fe);return}if(o!==h){M(" Passwords do not match.");return}const ue=localStorage.getItem("userId")||"<USER_ID>";I(!0);try{await Ur.post("/profile-activate",{user_id:ue,password:o,fcm:V}),M(" Password set! Your profile is now active."),Q("/login")}catch(ye){console.error(ye),M(((te=(de=ye.response)==null?void 0:de.data)==null?void 0:te.message)||" Something went wrong.")}finally{I(!1)}};return j.jsx("div",{className:"flex items-center justify-center px-4 py-12 bg-gray-50",children:j.jsxs("div",{className:"max-w-md w-full p-8 rounded-lg",children:[j.jsx("h2",{className:"text-2xl font-bold mb-6 text-center text-gray-800",children:"Create Password"}),j.jsxs("div",{className:"mb-4",children:[j.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),j.jsx("input",{type:"password",placeholder:"Enter password",value:o,onChange:fe=>{d(fe.target.value),x(ie(fe.target.value)),M("")},className:"w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),j.jsxs("div",{className:"min-h-[42px] mt-1 text-sm text-red-500 transition-all duration-200 space-y-1",children:[j.jsx("p",{className:`transition-opacity duration-200 ${k.length?"opacity-100":"opacity-0"}`,children:k.length||""}),j.jsx("p",{className:`transition-opacity duration-200 ${k.uppercase?"opacity-100":"opacity-0"}`,children:k.uppercase||""})]})]}),j.jsxs("div",{className:"mt-6 mb-6",children:[j.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm Password"}),j.jsx("input",{type:"password",placeholder:"Re-enter password",value:h,onChange:fe=>{g(fe.target.value),M("")},className:"w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),j.jsxs("div",{className:"flex items-center gap-3 my-2",children:[j.jsx("div",{className:`h-1 rounded ${ae} w-[50%]`}),j.jsx("span",{className:`text-sm font-medium ${Z==="Strong"?"text-green-600":Z==="Moderate"?"text-yellow-600":"text-red-600"}`,children:Z})]}),j.jsx("button",{onClick:le,disabled:T,className:`w-full py-2 text-white font-semibold rounded-lg bg-gradient-to-r from-[#00D4FF] to-[#00A3E0] hover:opacity-90 transition ${T?"opacity-50 cursor-not-allowed":""}`,children:T?"Setting":"Submit"}),j.jsx("div",{className:"min-h-[24px] mt-4 text-center text-sm transition-all duration-200 ease-in-out",children:j.jsx("p",{className:`transition-opacity duration-200 ${N?N.startsWith("")?"text-green-600 opacity-100":"text-red-600 opacity-100":"opacity-0"}`,children:N||""})})]})})}const Bhe=()=>{};var F$={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kae=function(o){const d=[];let h=0;for(let g=0;g<o.length;g++){let T=o.charCodeAt(g);T<128?d[h++]=T:T<2048?(d[h++]=T>>6|192,d[h++]=T&63|128):(T&64512)===55296&&g+1<o.length&&(o.charCodeAt(g+1)&64512)===56320?(T=65536+((T&1023)<<10)+(o.charCodeAt(++g)&1023),d[h++]=T>>18|240,d[h++]=T>>12&63|128,d[h++]=T>>6&63|128,d[h++]=T&63|128):(d[h++]=T>>12|224,d[h++]=T>>6&63|128,d[h++]=T&63|128)}return d},Fhe=function(o){const d=[];let h=0,g=0;for(;h<o.length;){const T=o[h++];if(T<128)d[g++]=String.fromCharCode(T);else if(T>191&&T<224){const I=o[h++];d[g++]=String.fromCharCode((T&31)<<6|I&63)}else if(T>239&&T<365){const I=o[h++],N=o[h++],M=o[h++],k=((T&7)<<18|(I&63)<<12|(N&63)<<6|M&63)-65536;d[g++]=String.fromCharCode(55296+(k>>10)),d[g++]=String.fromCharCode(56320+(k&1023))}else{const I=o[h++],N=o[h++];d[g++]=String.fromCharCode((T&15)<<12|(I&63)<<6|N&63)}}return d.join("")},xae={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(o,d){if(!Array.isArray(o))throw Error("encodeByteArray takes an array as a parameter");this.init_();const h=d?this.byteToCharMapWebSafe_:this.byteToCharMap_,g=[];for(let T=0;T<o.length;T+=3){const I=o[T],N=T+1<o.length,M=N?o[T+1]:0,k=T+2<o.length,x=k?o[T+2]:0,V=I>>2,K=(I&3)<<4|M>>4;let Q=(M&15)<<2|x>>6,ie=x&63;k||(ie=64,N||(Q=64)),g.push(h[V],h[K],h[Q],h[ie])}return g.join("")},encodeString(o,d){return this.HAS_NATIVE_SUPPORT&&!d?btoa(o):this.encodeByteArray(kae(o),d)},decodeString(o,d){return this.HAS_NATIVE_SUPPORT&&!d?atob(o):Fhe(this.decodeStringToByteArray(o,d))},decodeStringToByteArray(o,d){this.init_();const h=d?this.charToByteMapWebSafe_:this.charToByteMap_,g=[];for(let T=0;T<o.length;){const I=h[o.charAt(T++)],M=T<o.length?h[o.charAt(T)]:0;++T;const x=T<o.length?h[o.charAt(T)]:64;++T;const K=T<o.length?h[o.charAt(T)]:64;if(++T,I==null||M==null||x==null||K==null)throw new Ghe;const Q=I<<2|M>>4;if(g.push(Q),x!==64){const ie=M<<4&240|x>>2;if(g.push(ie),K!==64){const X=x<<6&192|K;g.push(X)}}}return g},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let o=0;o<this.ENCODED_VALS.length;o++)this.byteToCharMap_[o]=this.ENCODED_VALS.charAt(o),this.charToByteMap_[this.byteToCharMap_[o]]=o,this.byteToCharMapWebSafe_[o]=this.ENCODED_VALS_WEBSAFE.charAt(o),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[o]]=o,o>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(o)]=o,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(o)]=o)}}};class Ghe extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const zhe=function(o){const d=kae(o);return xae.encodeByteArray(d,!0)},Uae=function(o){return zhe(o).replace(/\./g,"")},jae=function(o){try{return xae.decodeString(o,!0)}catch(d){console.error("base64Decode failed: ",d)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hhe(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Whe=()=>Hhe().__FIREBASE_DEFAULTS__,Yhe=()=>{if(typeof process>"u"||typeof F$>"u")return;const o=F$.__FIREBASE_DEFAULTS__;if(o)return JSON.parse(o)},Khe=()=>{if(typeof document>"u")return;let o;try{o=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const d=o&&jae(o[1]);return d&&JSON.parse(d)},NQ=()=>{try{return Bhe()||Whe()||Yhe()||Khe()}catch(o){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${o}`);return}},qhe=o=>{var d,h;return(h=(d=NQ())===null||d===void 0?void 0:d.emulatorHosts)===null||h===void 0?void 0:h[o]},Vae=()=>{var o;return(o=NQ())===null||o===void 0?void 0:o.config},Bae=o=>{var d;return(d=NQ())===null||d===void 0?void 0:d[`_${o}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jhe{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((d,h)=>{this.resolve=d,this.reject=h})}wrapCallback(d){return(h,g)=>{h?this.reject(h):this.resolve(g),typeof d=="function"&&(this.promise.catch(()=>{}),d.length===1?d(h):d(h,g))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AG(o){return o.endsWith(".cloudworkstations.dev")}async function Xhe(o){return(await fetch(o,{credentials:"include"})).ok}const i5={};function Qhe(){const o={prod:[],emulator:[]};for(const d of Object.keys(i5))i5[d]?o.emulator.push(d):o.prod.push(d);return o}function Zhe(o){let d=document.getElementById(o),h=!1;return d||(d=document.createElement("div"),d.setAttribute("id",o),h=!0),{created:h,element:d}}let G$=!1;function $he(o,d){if(typeof window>"u"||typeof document>"u"||!AG(window.location.host)||i5[o]===d||i5[o]||G$)return;i5[o]=d;function h(Q){return`__firebase__banner__${Q}`}const g="__firebase__banner",I=Qhe().prod.length>0;function N(){const Q=document.getElementById(g);Q&&Q.remove()}function M(Q){Q.style.display="flex",Q.style.background="#7faaf0",Q.style.position="fixed",Q.style.bottom="5px",Q.style.left="5px",Q.style.padding=".5em",Q.style.borderRadius="5px",Q.style.alignItems="center"}function k(Q,ie){Q.setAttribute("width","24"),Q.setAttribute("id",ie),Q.setAttribute("height","24"),Q.setAttribute("viewBox","0 0 24 24"),Q.setAttribute("fill","none"),Q.style.marginLeft="-6px"}function x(){const Q=document.createElement("span");return Q.style.cursor="pointer",Q.style.marginLeft="16px",Q.style.fontSize="24px",Q.innerHTML=" &times;",Q.onclick=()=>{G$=!0,N()},Q}function V(Q,ie){Q.setAttribute("id",ie),Q.innerText="Learn more",Q.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",Q.setAttribute("target","__blank"),Q.style.paddingLeft="5px",Q.style.textDecoration="underline"}function K(){const Q=Zhe(g),ie=h("text"),X=document.getElementById(ie)||document.createElement("span"),Z=h("learnmore"),ae=document.getElementById(Z)||document.createElement("a"),le=h("preprendIcon"),fe=document.getElementById(le)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(Q.created){const ue=Q.element;M(ue),V(ae,Z);const de=x();k(fe,le),ue.append(fe,X,ae,de),document.body.appendChild(ue)}I?(X.innerText="Preview backend disconnected.",fe.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(fe.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,X.innerText="Preview backend running in this workspace."),X.setAttribute("id",ie)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",K):K()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _u(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function epe(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(_u())}function tpe(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function npe(){const o=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof o=="object"&&o.id!==void 0}function rpe(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function ipe(){const o=_u();return o.indexOf("MSIE ")>=0||o.indexOf("Trident/")>=0}function Fae(){try{return typeof indexedDB=="object"}catch{return!1}}function Gae(){return new Promise((o,d)=>{try{let h=!0;const g="validate-browser-context-for-indexeddb-analytics-module",T=self.indexedDB.open(g);T.onsuccess=()=>{T.result.close(),h||self.indexedDB.deleteDatabase(g),o(!0)},T.onupgradeneeded=()=>{h=!1},T.onerror=()=>{var I;d(((I=T.error)===null||I===void 0?void 0:I.message)||"")}}catch(h){d(h)}})}function ape(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const spe="FirebaseError";class yy extends Error{constructor(d,h,g){super(h),this.code=d,this.customData=g,this.name=spe,Object.setPrototypeOf(this,yy.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,KA.prototype.create)}}class KA{constructor(d,h,g){this.service=d,this.serviceName=h,this.errors=g}create(d,...h){const g=h[0]||{},T=`${this.service}/${d}`,I=this.errors[d],N=I?ope(I,g):"Error",M=`${this.serviceName}: ${N} (${T}).`;return new yy(T,M,g)}}function ope(o,d){return o.replace(cpe,(h,g)=>{const T=d[g];return T!=null?String(T):`<${g}?>`})}const cpe=/\{\$([^}]+)}/g;function lpe(o){for(const d in o)if(Object.prototype.hasOwnProperty.call(o,d))return!1;return!0}function TP(o,d){if(o===d)return!0;const h=Object.keys(o),g=Object.keys(d);for(const T of h){if(!g.includes(T))return!1;const I=o[T],N=d[T];if(z$(I)&&z$(N)){if(!TP(I,N))return!1}else if(I!==N)return!1}for(const T of g)if(!h.includes(T))return!1;return!0}function z$(o){return o!==null&&typeof o=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x5(o){const d=[];for(const[h,g]of Object.entries(o))Array.isArray(g)?g.forEach(T=>{d.push(encodeURIComponent(h)+"="+encodeURIComponent(T))}):d.push(encodeURIComponent(h)+"="+encodeURIComponent(g));return d.length?"&"+d.join("&"):""}function dpe(o,d){const h=new upe(o,d);return h.subscribe.bind(h)}class upe{constructor(d,h){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=h,this.task.then(()=>{d(this)}).catch(g=>{this.error(g)})}next(d){this.forEachObserver(h=>{h.next(d)})}error(d){this.forEachObserver(h=>{h.error(d)}),this.close(d)}complete(){this.forEachObserver(d=>{d.complete()}),this.close()}subscribe(d,h,g){let T;if(d===void 0&&h===void 0&&g===void 0)throw new Error("Missing Observer.");fpe(d,["next","error","complete"])?T=d:T={next:d,error:h,complete:g},T.next===void 0&&(T.next=MK),T.error===void 0&&(T.error=MK),T.complete===void 0&&(T.complete=MK);const I=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?T.error(this.finalError):T.complete()}catch{}}),this.observers.push(T),I}unsubscribeOne(d){this.observers===void 0||this.observers[d]===void 0||(delete this.observers[d],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(d){if(!this.finalized)for(let h=0;h<this.observers.length;h++)this.sendOne(h,d)}sendOne(d,h){this.task.then(()=>{if(this.observers!==void 0&&this.observers[d]!==void 0)try{h(this.observers[d])}catch(g){typeof console<"u"&&console.error&&console.error(g)}})}close(d){this.finalized||(this.finalized=!0,d!==void 0&&(this.finalError=d),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function fpe(o,d){if(typeof o!="object"||o===null)return!1;for(const h of d)if(h in o&&typeof o[h]=="function")return!0;return!1}function MK(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iC(o){return o&&o._delegate?o._delegate:o}class _E{constructor(d,h,g){this.name=d,this.instanceFactory=h,this.type=g,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(d){return this.instantiationMode=d,this}setMultipleInstances(d){return this.multipleInstances=d,this}setServiceProps(d){return this.serviceProps=d,this}setInstanceCreatedCallback(d){return this.onInstanceCreated=d,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CA="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hpe{constructor(d,h){this.name=d,this.container=h,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(d){const h=this.normalizeInstanceIdentifier(d);if(!this.instancesDeferred.has(h)){const g=new Jhe;if(this.instancesDeferred.set(h,g),this.isInitialized(h)||this.shouldAutoInitialize())try{const T=this.getOrInitializeService({instanceIdentifier:h});T&&g.resolve(T)}catch{}}return this.instancesDeferred.get(h).promise}getImmediate(d){var h;const g=this.normalizeInstanceIdentifier(d==null?void 0:d.identifier),T=(h=d==null?void 0:d.optional)!==null&&h!==void 0?h:!1;if(this.isInitialized(g)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:g})}catch(I){if(T)return null;throw I}else{if(T)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(d){if(d.name!==this.name)throw Error(`Mismatching Component ${d.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=d,!!this.shouldAutoInitialize()){if(mpe(d))try{this.getOrInitializeService({instanceIdentifier:CA})}catch{}for(const[h,g]of this.instancesDeferred.entries()){const T=this.normalizeInstanceIdentifier(h);try{const I=this.getOrInitializeService({instanceIdentifier:T});g.resolve(I)}catch{}}}}clearInstance(d=CA){this.instancesDeferred.delete(d),this.instancesOptions.delete(d),this.instances.delete(d)}async delete(){const d=Array.from(this.instances.values());await Promise.all([...d.filter(h=>"INTERNAL"in h).map(h=>h.INTERNAL.delete()),...d.filter(h=>"_delete"in h).map(h=>h._delete())])}isComponentSet(){return this.component!=null}isInitialized(d=CA){return this.instances.has(d)}getOptions(d=CA){return this.instancesOptions.get(d)||{}}initialize(d={}){const{options:h={}}=d,g=this.normalizeInstanceIdentifier(d.instanceIdentifier);if(this.isInitialized(g))throw Error(`${this.name}(${g}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const T=this.getOrInitializeService({instanceIdentifier:g,options:h});for(const[I,N]of this.instancesDeferred.entries()){const M=this.normalizeInstanceIdentifier(I);g===M&&N.resolve(T)}return T}onInit(d,h){var g;const T=this.normalizeInstanceIdentifier(h),I=(g=this.onInitCallbacks.get(T))!==null&&g!==void 0?g:new Set;I.add(d),this.onInitCallbacks.set(T,I);const N=this.instances.get(T);return N&&d(N,T),()=>{I.delete(d)}}invokeOnInitCallbacks(d,h){const g=this.onInitCallbacks.get(h);if(g)for(const T of g)try{T(d,h)}catch{}}getOrInitializeService({instanceIdentifier:d,options:h={}}){let g=this.instances.get(d);if(!g&&this.component&&(g=this.component.instanceFactory(this.container,{instanceIdentifier:ppe(d),options:h}),this.instances.set(d,g),this.instancesOptions.set(d,h),this.invokeOnInitCallbacks(g,d),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,d,g)}catch{}return g||null}normalizeInstanceIdentifier(d=CA){return this.component?this.component.multipleInstances?d:CA:d}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function ppe(o){return o===CA?void 0:o}function mpe(o){return o.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gpe{constructor(d){this.name=d,this.providers=new Map}addComponent(d){const h=this.getProvider(d.name);if(h.isComponentSet())throw new Error(`Component ${d.name} has already been registered with ${this.name}`);h.setComponent(d)}addOrOverwriteComponent(d){this.getProvider(d.name).isComponentSet()&&this.providers.delete(d.name),this.addComponent(d)}getProvider(d){if(this.providers.has(d))return this.providers.get(d);const h=new hpe(d,this);return this.providers.set(d,h),h}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Xa;(function(o){o[o.DEBUG=0]="DEBUG",o[o.VERBOSE=1]="VERBOSE",o[o.INFO=2]="INFO",o[o.WARN=3]="WARN",o[o.ERROR=4]="ERROR",o[o.SILENT=5]="SILENT"})(Xa||(Xa={}));const _pe={debug:Xa.DEBUG,verbose:Xa.VERBOSE,info:Xa.INFO,warn:Xa.WARN,error:Xa.ERROR,silent:Xa.SILENT},Epe=Xa.INFO,vpe={[Xa.DEBUG]:"log",[Xa.VERBOSE]:"log",[Xa.INFO]:"info",[Xa.WARN]:"warn",[Xa.ERROR]:"error"},Spe=(o,d,...h)=>{if(d<o.logLevel)return;const g=new Date().toISOString(),T=vpe[d];if(T)console[T](`[${g}]  ${o.name}:`,...h);else throw new Error(`Attempted to log a message with an invalid logType (value: ${d})`)};class zae{constructor(d){this.name=d,this._logLevel=Epe,this._logHandler=Spe,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(d){if(!(d in Xa))throw new TypeError(`Invalid value "${d}" assigned to \`logLevel\``);this._logLevel=d}setLogLevel(d){this._logLevel=typeof d=="string"?_pe[d]:d}get logHandler(){return this._logHandler}set logHandler(d){if(typeof d!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=d}get userLogHandler(){return this._userLogHandler}set userLogHandler(d){this._userLogHandler=d}debug(...d){this._userLogHandler&&this._userLogHandler(this,Xa.DEBUG,...d),this._logHandler(this,Xa.DEBUG,...d)}log(...d){this._userLogHandler&&this._userLogHandler(this,Xa.VERBOSE,...d),this._logHandler(this,Xa.VERBOSE,...d)}info(...d){this._userLogHandler&&this._userLogHandler(this,Xa.INFO,...d),this._logHandler(this,Xa.INFO,...d)}warn(...d){this._userLogHandler&&this._userLogHandler(this,Xa.WARN,...d),this._logHandler(this,Xa.WARN,...d)}error(...d){this._userLogHandler&&this._userLogHandler(this,Xa.ERROR,...d),this._logHandler(this,Xa.ERROR,...d)}}const ype=(o,d)=>d.some(h=>o instanceof h);let H$,W$;function Tpe(){return H$||(H$=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function bpe(){return W$||(W$=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Hae=new WeakMap,UX=new WeakMap,Wae=new WeakMap,kK=new WeakMap,LQ=new WeakMap;function Cpe(o){const d=new Promise((h,g)=>{const T=()=>{o.removeEventListener("success",I),o.removeEventListener("error",N)},I=()=>{h(hy(o.result)),T()},N=()=>{g(o.error),T()};o.addEventListener("success",I),o.addEventListener("error",N)});return d.then(h=>{h instanceof IDBCursor&&Hae.set(h,o)}).catch(()=>{}),LQ.set(d,o),d}function wpe(o){if(UX.has(o))return;const d=new Promise((h,g)=>{const T=()=>{o.removeEventListener("complete",I),o.removeEventListener("error",N),o.removeEventListener("abort",N)},I=()=>{h(),T()},N=()=>{g(o.error||new DOMException("AbortError","AbortError")),T()};o.addEventListener("complete",I),o.addEventListener("error",N),o.addEventListener("abort",N)});UX.set(o,d)}let jX={get(o,d,h){if(o instanceof IDBTransaction){if(d==="done")return UX.get(o);if(d==="objectStoreNames")return o.objectStoreNames||Wae.get(o);if(d==="store")return h.objectStoreNames[1]?void 0:h.objectStore(h.objectStoreNames[0])}return hy(o[d])},set(o,d,h){return o[d]=h,!0},has(o,d){return o instanceof IDBTransaction&&(d==="done"||d==="store")?!0:d in o}};function Rpe(o){jX=o(jX)}function Ipe(o){return o===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(d,...h){const g=o.call(xK(this),d,...h);return Wae.set(g,d.sort?d.sort():[d]),hy(g)}:bpe().includes(o)?function(...d){return o.apply(xK(this),d),hy(Hae.get(this))}:function(...d){return hy(o.apply(xK(this),d))}}function Ape(o){return typeof o=="function"?Ipe(o):(o instanceof IDBTransaction&&wpe(o),ype(o,Tpe())?new Proxy(o,jX):o)}function hy(o){if(o instanceof IDBRequest)return Cpe(o);if(kK.has(o))return kK.get(o);const d=Ape(o);return d!==o&&(kK.set(o,d),LQ.set(d,o)),d}const xK=o=>LQ.get(o);function OG(o,d,{blocked:h,upgrade:g,blocking:T,terminated:I}={}){const N=indexedDB.open(o,d),M=hy(N);return g&&N.addEventListener("upgradeneeded",k=>{g(hy(N.result),k.oldVersion,k.newVersion,hy(N.transaction),k)}),h&&N.addEventListener("blocked",k=>h(k.oldVersion,k.newVersion,k)),M.then(k=>{I&&k.addEventListener("close",()=>I()),T&&k.addEventListener("versionchange",x=>T(x.oldVersion,x.newVersion,x))}).catch(()=>{}),M}function UK(o,{blocked:d}={}){const h=indexedDB.deleteDatabase(o);return d&&h.addEventListener("blocked",g=>d(g.oldVersion,g)),hy(h).then(()=>{})}const Ope=["get","getKey","getAll","getAllKeys","count"],Npe=["put","add","delete","clear"],jK=new Map;function Y$(o,d){if(!(o instanceof IDBDatabase&&!(d in o)&&typeof d=="string"))return;if(jK.get(d))return jK.get(d);const h=d.replace(/FromIndex$/,""),g=d!==h,T=Npe.includes(h);if(!(h in(g?IDBIndex:IDBObjectStore).prototype)||!(T||Ope.includes(h)))return;const I=async function(N,...M){const k=this.transaction(N,T?"readwrite":"readonly");let x=k.store;return g&&(x=x.index(M.shift())),(await Promise.all([x[h](...M),T&&k.done]))[0]};return jK.set(d,I),I}Rpe(o=>({...o,get:(d,h,g)=>Y$(d,h)||o.get(d,h,g),has:(d,h)=>!!Y$(d,h)||o.has(d,h)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lpe{constructor(d){this.container=d}getPlatformInfoString(){return this.container.getProviders().map(h=>{if(Dpe(h)){const g=h.getImmediate();return`${g.library}/${g.version}`}else return null}).filter(h=>h).join(" ")}}function Dpe(o){const d=o.getComponent();return(d==null?void 0:d.type)==="VERSION"}const VX="@firebase/app",K$="0.13.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const my=new zae("@firebase/app"),Ppe="@firebase/app-compat",Mpe="@firebase/analytics-compat",kpe="@firebase/analytics",xpe="@firebase/app-check-compat",Upe="@firebase/app-check",jpe="@firebase/auth",Vpe="@firebase/auth-compat",Bpe="@firebase/database",Fpe="@firebase/data-connect",Gpe="@firebase/database-compat",zpe="@firebase/functions",Hpe="@firebase/functions-compat",Wpe="@firebase/installations",Ype="@firebase/installations-compat",Kpe="@firebase/messaging",qpe="@firebase/messaging-compat",Jpe="@firebase/performance",Xpe="@firebase/performance-compat",Qpe="@firebase/remote-config",Zpe="@firebase/remote-config-compat",$pe="@firebase/storage",eme="@firebase/storage-compat",tme="@firebase/firestore",nme="@firebase/ai",rme="@firebase/firestore-compat",ime="firebase",ame="11.9.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BX="[DEFAULT]",sme={[VX]:"fire-core",[Ppe]:"fire-core-compat",[kpe]:"fire-analytics",[Mpe]:"fire-analytics-compat",[Upe]:"fire-app-check",[xpe]:"fire-app-check-compat",[jpe]:"fire-auth",[Vpe]:"fire-auth-compat",[Bpe]:"fire-rtdb",[Fpe]:"fire-data-connect",[Gpe]:"fire-rtdb-compat",[zpe]:"fire-fn",[Hpe]:"fire-fn-compat",[Wpe]:"fire-iid",[Ype]:"fire-iid-compat",[Kpe]:"fire-fcm",[qpe]:"fire-fcm-compat",[Jpe]:"fire-perf",[Xpe]:"fire-perf-compat",[Qpe]:"fire-rc",[Zpe]:"fire-rc-compat",[$pe]:"fire-gcs",[eme]:"fire-gcs-compat",[tme]:"fire-fst",[rme]:"fire-fst-compat",[nme]:"fire-vertex","fire-js":"fire-js",[ime]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K7=new Map,ome=new Map,FX=new Map;function q$(o,d){try{o.container.addComponent(d)}catch(h){my.debug(`Component ${d.name} failed to register with FirebaseApp ${o.name}`,h)}}function gy(o){const d=o.name;if(FX.has(d))return my.debug(`There were multiple attempts to register component ${d}.`),!1;FX.set(d,o);for(const h of K7.values())q$(h,o);for(const h of ome.values())q$(h,o);return!0}function U5(o,d){const h=o.container.getProvider("heartbeat").getImmediate({optional:!0});return h&&h.triggerHeartbeat(),o.container.getProvider(d)}function fE(o){return o==null?!1:o.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cme={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},eC=new KA("app","Firebase",cme);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lme{constructor(d,h,g){this._isDeleted=!1,this._options=Object.assign({},d),this._config=Object.assign({},h),this._name=h.name,this._automaticDataCollectionEnabled=h.automaticDataCollectionEnabled,this._container=g,this.container.addComponent(new _E("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(d){this.checkDestroyed(),this._automaticDataCollectionEnabled=d}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(d){this._isDeleted=d}checkDestroyed(){if(this.isDeleted)throw eC.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j5=ame;function Yae(o,d={}){let h=o;typeof d!="object"&&(d={name:d});const g=Object.assign({name:BX,automaticDataCollectionEnabled:!0},d),T=g.name;if(typeof T!="string"||!T)throw eC.create("bad-app-name",{appName:String(T)});if(h||(h=Vae()),!h)throw eC.create("no-options");const I=K7.get(T);if(I){if(TP(h,I.options)&&TP(g,I.config))return I;throw eC.create("duplicate-app",{appName:T})}const N=new gpe(T);for(const k of FX.values())N.addComponent(k);const M=new lme(h,g,N);return K7.set(T,M),M}function Kae(o=BX){const d=K7.get(o);if(!d&&o===BX&&Vae())return Yae();if(!d)throw eC.create("no-app",{appName:o});return d}function hE(o,d,h){var g;let T=(g=sme[o])!==null&&g!==void 0?g:o;h&&(T+=`-${h}`);const I=T.match(/\s|\//),N=d.match(/\s|\//);if(I||N){const M=[`Unable to register library "${T}" with version "${d}":`];I&&M.push(`library name "${T}" contains illegal characters (whitespace or "/")`),I&&N&&M.push("and"),N&&M.push(`version name "${d}" contains illegal characters (whitespace or "/")`),my.warn(M.join(" "));return}gy(new _E(`${T}-version`,()=>({library:T,version:d}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dme="firebase-heartbeat-database",ume=1,h5="firebase-heartbeat-store";let VK=null;function qae(){return VK||(VK=OG(dme,ume,{upgrade:(o,d)=>{switch(d){case 0:try{o.createObjectStore(h5)}catch(h){console.warn(h)}}}}).catch(o=>{throw eC.create("idb-open",{originalErrorMessage:o.message})})),VK}async function fme(o){try{const h=(await qae()).transaction(h5),g=await h.objectStore(h5).get(Jae(o));return await h.done,g}catch(d){if(d instanceof yy)my.warn(d.message);else{const h=eC.create("idb-get",{originalErrorMessage:d==null?void 0:d.message});my.warn(h.message)}}}async function J$(o,d){try{const g=(await qae()).transaction(h5,"readwrite");await g.objectStore(h5).put(d,Jae(o)),await g.done}catch(h){if(h instanceof yy)my.warn(h.message);else{const g=eC.create("idb-set",{originalErrorMessage:h==null?void 0:h.message});my.warn(g.message)}}}function Jae(o){return`${o.name}!${o.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hme=1024,pme=30;class mme{constructor(d){this.container=d,this._heartbeatsCache=null;const h=this.container.getProvider("app").getImmediate();this._storage=new _me(h),this._heartbeatsCachePromise=this._storage.read().then(g=>(this._heartbeatsCache=g,g))}async triggerHeartbeat(){var d,h;try{const T=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),I=X$();if(((d=this._heartbeatsCache)===null||d===void 0?void 0:d.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((h=this._heartbeatsCache)===null||h===void 0?void 0:h.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===I||this._heartbeatsCache.heartbeats.some(N=>N.date===I))return;if(this._heartbeatsCache.heartbeats.push({date:I,agent:T}),this._heartbeatsCache.heartbeats.length>pme){const N=Eme(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(N,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(g){my.warn(g)}}async getHeartbeatsHeader(){var d;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((d=this._heartbeatsCache)===null||d===void 0?void 0:d.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const h=X$(),{heartbeatsToSend:g,unsentEntries:T}=gme(this._heartbeatsCache.heartbeats),I=Uae(JSON.stringify({version:2,heartbeats:g}));return this._heartbeatsCache.lastSentHeartbeatDate=h,T.length>0?(this._heartbeatsCache.heartbeats=T,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),I}catch(h){return my.warn(h),""}}}function X$(){return new Date().toISOString().substring(0,10)}function gme(o,d=hme){const h=[];let g=o.slice();for(const T of o){const I=h.find(N=>N.agent===T.agent);if(I){if(I.dates.push(T.date),Q$(h)>d){I.dates.pop();break}}else if(h.push({agent:T.agent,dates:[T.date]}),Q$(h)>d){h.pop();break}g=g.slice(1)}return{heartbeatsToSend:h,unsentEntries:g}}class _me{constructor(d){this.app=d,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Fae()?Gae().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const h=await fme(this.app);return h!=null&&h.heartbeats?h:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(d){var h;if(await this._canUseIndexedDBPromise){const T=await this.read();return J$(this.app,{lastSentHeartbeatDate:(h=d.lastSentHeartbeatDate)!==null&&h!==void 0?h:T.lastSentHeartbeatDate,heartbeats:d.heartbeats})}else return}async add(d){var h;if(await this._canUseIndexedDBPromise){const T=await this.read();return J$(this.app,{lastSentHeartbeatDate:(h=d.lastSentHeartbeatDate)!==null&&h!==void 0?h:T.lastSentHeartbeatDate,heartbeats:[...T.heartbeats,...d.heartbeats]})}else return}}function Q$(o){return Uae(JSON.stringify({version:2,heartbeats:o})).length}function Eme(o){if(o.length===0)return-1;let d=0,h=o[0].date;for(let g=1;g<o.length;g++)o[g].date<h&&(h=o[g].date,d=g);return d}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vme(o){gy(new _E("platform-logger",d=>new Lpe(d),"PRIVATE")),gy(new _E("heartbeat",d=>new mme(d),"PRIVATE")),hE(VX,K$,o),hE(VX,K$,"esm2017"),hE("fire-js","")}vme("");var Sme="firebase",yme="11.9.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */hE(Sme,yme,"app");function DQ(o,d){var h={};for(var g in o)Object.prototype.hasOwnProperty.call(o,g)&&d.indexOf(g)<0&&(h[g]=o[g]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function")for(var T=0,g=Object.getOwnPropertySymbols(o);T<g.length;T++)d.indexOf(g[T])<0&&Object.prototype.propertyIsEnumerable.call(o,g[T])&&(h[g[T]]=o[g[T]]);return h}function Xae(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Tme=Xae,Qae=new KA("auth","Firebase",Xae());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q7=new zae("@firebase/auth");function bme(o,...d){q7.logLevel<=Xa.WARN&&q7.warn(`Auth (${j5}): ${o}`,...d)}function O7(o,...d){q7.logLevel<=Xa.ERROR&&q7.error(`Auth (${j5}): ${o}`,...d)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EE(o,...d){throw MQ(o,...d)}function u0(o,...d){return MQ(o,...d)}function PQ(o,d,h){const g=Object.assign(Object.assign({},Tme()),{[d]:h});return new KA("auth","Firebase",g).create(d,{appName:o.name})}function xA(o){return PQ(o,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Cme(o,d,h){const g=h;if(!(d instanceof g))throw g.name!==d.constructor.name&&EE(o,"argument-error"),PQ(o,"argument-error",`Type of ${d.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function MQ(o,...d){if(typeof o!="string"){const h=d[0],g=[...d.slice(1)];return g[0]&&(g[0].appName=o.name),o._errorFactory.create(h,...g)}return Qae.create(o,...d)}function yr(o,d,...h){if(!o)throw MQ(d,...h)}function dy(o){const d="INTERNAL ASSERTION FAILED: "+o;throw O7(d),new Error(d)}function _y(o,d){o||dy(d)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GX(){var o;return typeof self<"u"&&((o=self.location)===null||o===void 0?void 0:o.href)||""}function wme(){return Z$()==="http:"||Z$()==="https:"}function Z$(){var o;return typeof self<"u"&&((o=self.location)===null||o===void 0?void 0:o.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rme(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(wme()||npe()||"connection"in navigator)?navigator.onLine:!0}function Ime(){if(typeof navigator>"u")return null;const o=navigator;return o.languages&&o.languages[0]||o.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V5{constructor(d,h){this.shortDelay=d,this.longDelay=h,_y(h>d,"Short delay should be less than long delay!"),this.isMobile=epe()||rpe()}get(){return Rme()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kQ(o,d){_y(o.emulator,"Emulator should always be set here");const{url:h}=o.emulator;return d?`${h}${d.startsWith("/")?d.slice(1):d}`:h}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zae{static initialize(d,h,g){this.fetchImpl=d,h&&(this.headersImpl=h),g&&(this.responseImpl=g)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;dy("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;dy("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;dy("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ame={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ome=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],Nme=new V5(3e4,6e4);function xQ(o,d){return o.tenantId&&!d.tenantId?Object.assign(Object.assign({},d),{tenantId:o.tenantId}):d}async function jP(o,d,h,g,T={}){return $ae(o,T,async()=>{let I={},N={};g&&(d==="GET"?N=g:I={body:JSON.stringify(g)});const M=x5(Object.assign({key:o.config.apiKey},N)).slice(1),k=await o._getAdditionalHeaders();k["Content-Type"]="application/json",o.languageCode&&(k["X-Firebase-Locale"]=o.languageCode);const x=Object.assign({method:d,headers:k},I);return tpe()||(x.referrerPolicy="no-referrer"),o.emulatorConfig&&AG(o.emulatorConfig.host)&&(x.credentials="include"),Zae.fetch()(await ese(o,o.config.apiHost,h,M),x)})}async function $ae(o,d,h){o._canInitEmulator=!1;const g=Object.assign(Object.assign({},Ame),d);try{const T=new Dme(o),I=await Promise.race([h(),T.promise]);T.clearNetworkTimeout();const N=await I.json();if("needConfirmation"in N)throw f7(o,"account-exists-with-different-credential",N);if(I.ok&&!("errorMessage"in N))return N;{const M=I.ok?N.errorMessage:N.error.message,[k,x]=M.split(" : ");if(k==="FEDERATED_USER_ID_ALREADY_LINKED")throw f7(o,"credential-already-in-use",N);if(k==="EMAIL_EXISTS")throw f7(o,"email-already-in-use",N);if(k==="USER_DISABLED")throw f7(o,"user-disabled",N);const V=g[k]||k.toLowerCase().replace(/[_\s]+/g,"-");if(x)throw PQ(o,V,x);EE(o,V)}}catch(T){if(T instanceof yy)throw T;EE(o,"network-request-failed",{message:String(T)})}}async function Lme(o,d,h,g,T={}){const I=await jP(o,d,h,g,T);return"mfaPendingCredential"in I&&EE(o,"multi-factor-auth-required",{_serverResponse:I}),I}async function ese(o,d,h,g){const T=`${d}${h}?${g}`,I=o,N=I.config.emulator?kQ(o.config,T):`${o.config.apiScheme}://${T}`;return Ome.includes(h)&&(await I._persistenceManagerAvailable,I._getPersistenceType()==="COOKIE")?I._getPersistence()._getFinalTarget(N).toString():N}class Dme{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(d){this.auth=d,this.timer=null,this.promise=new Promise((h,g)=>{this.timer=setTimeout(()=>g(u0(this.auth,"network-request-failed")),Nme.get())})}}function f7(o,d,h){const g={appName:o.name};h.email&&(g.email=h.email),h.phoneNumber&&(g.phoneNumber=h.phoneNumber);const T=u0(o,d,g);return T.customData._tokenResponse=h,T}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Pme(o,d){return jP(o,"POST","/v1/accounts:delete",d)}async function J7(o,d){return jP(o,"POST","/v1/accounts:lookup",d)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function a5(o){if(o)try{const d=new Date(Number(o));if(!isNaN(d.getTime()))return d.toUTCString()}catch{}}async function Mme(o,d=!1){const h=iC(o),g=await h.getIdToken(d),T=UQ(g);yr(T&&T.exp&&T.auth_time&&T.iat,h.auth,"internal-error");const I=typeof T.firebase=="object"?T.firebase:void 0,N=I==null?void 0:I.sign_in_provider;return{claims:T,token:g,authTime:a5(BK(T.auth_time)),issuedAtTime:a5(BK(T.iat)),expirationTime:a5(BK(T.exp)),signInProvider:N||null,signInSecondFactor:(I==null?void 0:I.sign_in_second_factor)||null}}function BK(o){return Number(o)*1e3}function UQ(o){const[d,h,g]=o.split(".");if(d===void 0||h===void 0||g===void 0)return O7("JWT malformed, contained fewer than 3 sections"),null;try{const T=jae(h);return T?JSON.parse(T):(O7("Failed to decode base64 JWT payload"),null)}catch(T){return O7("Caught error parsing JWT payload as JSON",T==null?void 0:T.toString()),null}}function $$(o){const d=UQ(o);return yr(d,"internal-error"),yr(typeof d.exp<"u","internal-error"),yr(typeof d.iat<"u","internal-error"),Number(d.exp)-Number(d.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function p5(o,d,h=!1){if(h)return d;try{return await d}catch(g){throw g instanceof yy&&kme(g)&&o.auth.currentUser===o&&await o.auth.signOut(),g}}function kme({code:o}){return o==="auth/user-disabled"||o==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xme{constructor(d){this.user=d,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(d){var h;if(d){const g=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),g}else{this.errorBackoff=3e4;const T=((h=this.user.stsTokenManager.expirationTime)!==null&&h!==void 0?h:0)-Date.now()-3e5;return Math.max(0,T)}}schedule(d=!1){if(!this.isRunning)return;const h=this.getInterval(d);this.timerId=setTimeout(async()=>{await this.iteration()},h)}async iteration(){try{await this.user.getIdToken(!0)}catch(d){(d==null?void 0:d.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zX{constructor(d,h){this.createdAt=d,this.lastLoginAt=h,this._initializeTime()}_initializeTime(){this.lastSignInTime=a5(this.lastLoginAt),this.creationTime=a5(this.createdAt)}_copy(d){this.createdAt=d.createdAt,this.lastLoginAt=d.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function X7(o){var d;const h=o.auth,g=await o.getIdToken(),T=await p5(o,J7(h,{idToken:g}));yr(T==null?void 0:T.users.length,h,"internal-error");const I=T.users[0];o._notifyReloadListener(I);const N=!((d=I.providerUserInfo)===null||d===void 0)&&d.length?tse(I.providerUserInfo):[],M=jme(o.providerData,N),k=o.isAnonymous,x=!(o.email&&I.passwordHash)&&!(M!=null&&M.length),V=k?x:!1,K={uid:I.localId,displayName:I.displayName||null,photoURL:I.photoUrl||null,email:I.email||null,emailVerified:I.emailVerified||!1,phoneNumber:I.phoneNumber||null,tenantId:I.tenantId||null,providerData:M,metadata:new zX(I.createdAt,I.lastLoginAt),isAnonymous:V};Object.assign(o,K)}async function Ume(o){const d=iC(o);await X7(d),await d.auth._persistUserIfCurrent(d),d.auth._notifyListenersIfCurrent(d)}function jme(o,d){return[...o.filter(g=>!d.some(T=>T.providerId===g.providerId)),...d]}function tse(o){return o.map(d=>{var{providerId:h}=d,g=DQ(d,["providerId"]);return{providerId:h,uid:g.rawId||"",displayName:g.displayName||null,email:g.email||null,phoneNumber:g.phoneNumber||null,photoURL:g.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Vme(o,d){const h=await $ae(o,{},async()=>{const g=x5({grant_type:"refresh_token",refresh_token:d}).slice(1),{tokenApiHost:T,apiKey:I}=o.config,N=await ese(o,T,"/v1/token",`key=${I}`),M=await o._getAdditionalHeaders();M["Content-Type"]="application/x-www-form-urlencoded";const k={method:"POST",headers:M,body:g};return o.emulatorConfig&&AG(o.emulatorConfig.host)&&(k.credentials="include"),Zae.fetch()(N,k)});return{accessToken:h.access_token,expiresIn:h.expires_in,refreshToken:h.refresh_token}}async function Bme(o,d){return jP(o,"POST","/v2/accounts:revokeToken",xQ(o,d))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pP{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(d){yr(d.idToken,"internal-error"),yr(typeof d.idToken<"u","internal-error"),yr(typeof d.refreshToken<"u","internal-error");const h="expiresIn"in d&&typeof d.expiresIn<"u"?Number(d.expiresIn):$$(d.idToken);this.updateTokensAndExpiration(d.idToken,d.refreshToken,h)}updateFromIdToken(d){yr(d.length!==0,"internal-error");const h=$$(d);this.updateTokensAndExpiration(d,null,h)}async getToken(d,h=!1){return!h&&this.accessToken&&!this.isExpired?this.accessToken:(yr(this.refreshToken,d,"user-token-expired"),this.refreshToken?(await this.refresh(d,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(d,h){const{accessToken:g,refreshToken:T,expiresIn:I}=await Vme(d,h);this.updateTokensAndExpiration(g,T,Number(I))}updateTokensAndExpiration(d,h,g){this.refreshToken=h||null,this.accessToken=d||null,this.expirationTime=Date.now()+g*1e3}static fromJSON(d,h){const{refreshToken:g,accessToken:T,expirationTime:I}=h,N=new pP;return g&&(yr(typeof g=="string","internal-error",{appName:d}),N.refreshToken=g),T&&(yr(typeof T=="string","internal-error",{appName:d}),N.accessToken=T),I&&(yr(typeof I=="number","internal-error",{appName:d}),N.expirationTime=I),N}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(d){this.accessToken=d.accessToken,this.refreshToken=d.refreshToken,this.expirationTime=d.expirationTime}_clone(){return Object.assign(new pP,this.toJSON())}_performRefresh(){return dy("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q1(o,d){yr(typeof o=="string"||typeof o>"u","internal-error",{appName:d})}class d0{constructor(d){var{uid:h,auth:g,stsTokenManager:T}=d,I=DQ(d,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new xme(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=h,this.auth=g,this.stsTokenManager=T,this.accessToken=T.accessToken,this.displayName=I.displayName||null,this.email=I.email||null,this.emailVerified=I.emailVerified||!1,this.phoneNumber=I.phoneNumber||null,this.photoURL=I.photoURL||null,this.isAnonymous=I.isAnonymous||!1,this.tenantId=I.tenantId||null,this.providerData=I.providerData?[...I.providerData]:[],this.metadata=new zX(I.createdAt||void 0,I.lastLoginAt||void 0)}async getIdToken(d){const h=await p5(this,this.stsTokenManager.getToken(this.auth,d));return yr(h,this.auth,"internal-error"),this.accessToken!==h&&(this.accessToken=h,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),h}getIdTokenResult(d){return Mme(this,d)}reload(){return Ume(this)}_assign(d){this!==d&&(yr(this.uid===d.uid,this.auth,"internal-error"),this.displayName=d.displayName,this.photoURL=d.photoURL,this.email=d.email,this.emailVerified=d.emailVerified,this.phoneNumber=d.phoneNumber,this.isAnonymous=d.isAnonymous,this.tenantId=d.tenantId,this.providerData=d.providerData.map(h=>Object.assign({},h)),this.metadata._copy(d.metadata),this.stsTokenManager._assign(d.stsTokenManager))}_clone(d){const h=new d0(Object.assign(Object.assign({},this),{auth:d,stsTokenManager:this.stsTokenManager._clone()}));return h.metadata._copy(this.metadata),h}_onReload(d){yr(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=d,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(d){this.reloadListener?this.reloadListener(d):this.reloadUserInfo=d}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(d,h=!1){let g=!1;d.idToken&&d.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(d),g=!0),h&&await X7(this),await this.auth._persistUserIfCurrent(this),g&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(fE(this.auth.app))return Promise.reject(xA(this.auth));const d=await this.getIdToken();return await p5(this,Pme(this.auth,{idToken:d})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(d=>Object.assign({},d)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(d,h){var g,T,I,N,M,k,x,V;const K=(g=h.displayName)!==null&&g!==void 0?g:void 0,Q=(T=h.email)!==null&&T!==void 0?T:void 0,ie=(I=h.phoneNumber)!==null&&I!==void 0?I:void 0,X=(N=h.photoURL)!==null&&N!==void 0?N:void 0,Z=(M=h.tenantId)!==null&&M!==void 0?M:void 0,ae=(k=h._redirectEventId)!==null&&k!==void 0?k:void 0,le=(x=h.createdAt)!==null&&x!==void 0?x:void 0,fe=(V=h.lastLoginAt)!==null&&V!==void 0?V:void 0,{uid:ue,emailVerified:de,isAnonymous:te,providerData:ye,stsTokenManager:Te}=h;yr(ue&&Te,d,"internal-error");const Le=pP.fromJSON(this.name,Te);yr(typeof ue=="string",d,"internal-error"),q1(K,d.name),q1(Q,d.name),yr(typeof de=="boolean",d,"internal-error"),yr(typeof te=="boolean",d,"internal-error"),q1(ie,d.name),q1(X,d.name),q1(Z,d.name),q1(ae,d.name),q1(le,d.name),q1(fe,d.name);const je=new d0({uid:ue,auth:d,email:Q,emailVerified:de,displayName:K,isAnonymous:te,photoURL:X,phoneNumber:ie,tenantId:Z,stsTokenManager:Le,createdAt:le,lastLoginAt:fe});return ye&&Array.isArray(ye)&&(je.providerData=ye.map(he=>Object.assign({},he))),ae&&(je._redirectEventId=ae),je}static async _fromIdTokenResponse(d,h,g=!1){const T=new pP;T.updateFromServerResponse(h);const I=new d0({uid:h.localId,auth:d,stsTokenManager:T,isAnonymous:g});return await X7(I),I}static async _fromGetAccountInfoResponse(d,h,g){const T=h.users[0];yr(T.localId!==void 0,"internal-error");const I=T.providerUserInfo!==void 0?tse(T.providerUserInfo):[],N=!(T.email&&T.passwordHash)&&!(I!=null&&I.length),M=new pP;M.updateFromIdToken(g);const k=new d0({uid:T.localId,auth:d,stsTokenManager:M,isAnonymous:N}),x={uid:T.localId,displayName:T.displayName||null,photoURL:T.photoUrl||null,email:T.email||null,emailVerified:T.emailVerified||!1,phoneNumber:T.phoneNumber||null,tenantId:T.tenantId||null,providerData:I,metadata:new zX(T.createdAt,T.lastLoginAt),isAnonymous:!(T.email&&T.passwordHash)&&!(I!=null&&I.length)};return Object.assign(k,x),k}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eee=new Map;function uy(o){_y(o instanceof Function,"Expected a class definition");let d=eee.get(o);return d?(_y(d instanceof o,"Instance stored in cache mismatched with class"),d):(d=new o,eee.set(o,d),d)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nse{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(d,h){this.storage[d]=h}async _get(d){const h=this.storage[d];return h===void 0?null:h}async _remove(d){delete this.storage[d]}_addListener(d,h){}_removeListener(d,h){}}nse.type="NONE";const tee=nse;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function N7(o,d,h){return`firebase:${o}:${d}:${h}`}class mP{constructor(d,h,g){this.persistence=d,this.auth=h,this.userKey=g;const{config:T,name:I}=this.auth;this.fullUserKey=N7(this.userKey,T.apiKey,I),this.fullPersistenceKey=N7("persistence",T.apiKey,I),this.boundEventHandler=h._onStorageEvent.bind(h),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(d){return this.persistence._set(this.fullUserKey,d.toJSON())}async getCurrentUser(){const d=await this.persistence._get(this.fullUserKey);if(!d)return null;if(typeof d=="string"){const h=await J7(this.auth,{idToken:d}).catch(()=>{});return h?d0._fromGetAccountInfoResponse(this.auth,h,d):null}return d0._fromJSON(this.auth,d)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(d){if(this.persistence===d)return;const h=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=d,h)return this.setCurrentUser(h)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(d,h,g="authUser"){if(!h.length)return new mP(uy(tee),d,g);const T=(await Promise.all(h.map(async x=>{if(await x._isAvailable())return x}))).filter(x=>x);let I=T[0]||uy(tee);const N=N7(g,d.config.apiKey,d.name);let M=null;for(const x of h)try{const V=await x._get(N);if(V){let K;if(typeof V=="string"){const Q=await J7(d,{idToken:V}).catch(()=>{});if(!Q)break;K=await d0._fromGetAccountInfoResponse(d,Q,V)}else K=d0._fromJSON(d,V);x!==I&&(M=K),I=x;break}}catch{}const k=T.filter(x=>x._shouldAllowMigration);return!I._shouldAllowMigration||!k.length?new mP(I,d,g):(I=k[0],M&&await I._set(N,M.toJSON()),await Promise.all(h.map(async x=>{if(x!==I)try{await x._remove(N)}catch{}})),new mP(I,d,g))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nee(o){const d=o.toLowerCase();if(d.includes("opera/")||d.includes("opr/")||d.includes("opios/"))return"Opera";if(sse(d))return"IEMobile";if(d.includes("msie")||d.includes("trident/"))return"IE";if(d.includes("edge/"))return"Edge";if(rse(d))return"Firefox";if(d.includes("silk/"))return"Silk";if(cse(d))return"Blackberry";if(lse(d))return"Webos";if(ise(d))return"Safari";if((d.includes("chrome/")||ase(d))&&!d.includes("edge/"))return"Chrome";if(ose(d))return"Android";{const h=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,g=o.match(h);if((g==null?void 0:g.length)===2)return g[1]}return"Other"}function rse(o=_u()){return/firefox\//i.test(o)}function ise(o=_u()){const d=o.toLowerCase();return d.includes("safari/")&&!d.includes("chrome/")&&!d.includes("crios/")&&!d.includes("android")}function ase(o=_u()){return/crios\//i.test(o)}function sse(o=_u()){return/iemobile/i.test(o)}function ose(o=_u()){return/android/i.test(o)}function cse(o=_u()){return/blackberry/i.test(o)}function lse(o=_u()){return/webos/i.test(o)}function jQ(o=_u()){return/iphone|ipad|ipod/i.test(o)||/macintosh/i.test(o)&&/mobile/i.test(o)}function Fme(o=_u()){var d;return jQ(o)&&!!(!((d=window.navigator)===null||d===void 0)&&d.standalone)}function Gme(){return ipe()&&document.documentMode===10}function dse(o=_u()){return jQ(o)||ose(o)||lse(o)||cse(o)||/windows phone/i.test(o)||sse(o)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function use(o,d=[]){let h;switch(o){case"Browser":h=nee(_u());break;case"Worker":h=`${nee(_u())}-${o}`;break;default:h=o}const g=d.length?d.join(","):"FirebaseCore-web";return`${h}/JsCore/${j5}/${g}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zme{constructor(d){this.auth=d,this.queue=[]}pushCallback(d,h){const g=I=>new Promise((N,M)=>{try{const k=d(I);N(k)}catch(k){M(k)}});g.onAbort=h,this.queue.push(g);const T=this.queue.length-1;return()=>{this.queue[T]=()=>Promise.resolve()}}async runMiddleware(d){if(this.auth.currentUser===d)return;const h=[];try{for(const g of this.queue)await g(d),g.onAbort&&h.push(g.onAbort)}catch(g){h.reverse();for(const T of h)try{T()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:g==null?void 0:g.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Hme(o,d={}){return jP(o,"GET","/v2/passwordPolicy",xQ(o,d))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wme=6;class Yme{constructor(d){var h,g,T,I;const N=d.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(h=N.minPasswordLength)!==null&&h!==void 0?h:Wme,N.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=N.maxPasswordLength),N.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=N.containsLowercaseCharacter),N.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=N.containsUppercaseCharacter),N.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=N.containsNumericCharacter),N.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=N.containsNonAlphanumericCharacter),this.enforcementState=d.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(T=(g=d.allowedNonAlphanumericCharacters)===null||g===void 0?void 0:g.join(""))!==null&&T!==void 0?T:"",this.forceUpgradeOnSignin=(I=d.forceUpgradeOnSignin)!==null&&I!==void 0?I:!1,this.schemaVersion=d.schemaVersion}validatePassword(d){var h,g,T,I,N,M;const k={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(d,k),this.validatePasswordCharacterOptions(d,k),k.isValid&&(k.isValid=(h=k.meetsMinPasswordLength)!==null&&h!==void 0?h:!0),k.isValid&&(k.isValid=(g=k.meetsMaxPasswordLength)!==null&&g!==void 0?g:!0),k.isValid&&(k.isValid=(T=k.containsLowercaseLetter)!==null&&T!==void 0?T:!0),k.isValid&&(k.isValid=(I=k.containsUppercaseLetter)!==null&&I!==void 0?I:!0),k.isValid&&(k.isValid=(N=k.containsNumericCharacter)!==null&&N!==void 0?N:!0),k.isValid&&(k.isValid=(M=k.containsNonAlphanumericCharacter)!==null&&M!==void 0?M:!0),k}validatePasswordLengthOptions(d,h){const g=this.customStrengthOptions.minPasswordLength,T=this.customStrengthOptions.maxPasswordLength;g&&(h.meetsMinPasswordLength=d.length>=g),T&&(h.meetsMaxPasswordLength=d.length<=T)}validatePasswordCharacterOptions(d,h){this.updatePasswordCharacterOptionsStatuses(h,!1,!1,!1,!1);let g;for(let T=0;T<d.length;T++)g=d.charAt(T),this.updatePasswordCharacterOptionsStatuses(h,g>="a"&&g<="z",g>="A"&&g<="Z",g>="0"&&g<="9",this.allowedNonAlphanumericCharacters.includes(g))}updatePasswordCharacterOptionsStatuses(d,h,g,T,I){this.customStrengthOptions.containsLowercaseLetter&&(d.containsLowercaseLetter||(d.containsLowercaseLetter=h)),this.customStrengthOptions.containsUppercaseLetter&&(d.containsUppercaseLetter||(d.containsUppercaseLetter=g)),this.customStrengthOptions.containsNumericCharacter&&(d.containsNumericCharacter||(d.containsNumericCharacter=T)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(d.containsNonAlphanumericCharacter||(d.containsNonAlphanumericCharacter=I))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kme{constructor(d,h,g,T){this.app=d,this.heartbeatServiceProvider=h,this.appCheckServiceProvider=g,this.config=T,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new ree(this),this.idTokenSubscription=new ree(this),this.beforeStateQueue=new zme(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Qae,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=d.name,this.clientVersion=T.sdkClientVersion,this._persistenceManagerAvailable=new Promise(I=>this._resolvePersistenceManagerAvailable=I)}_initializeWithPersistence(d,h){return h&&(this._popupRedirectResolver=uy(h)),this._initializationPromise=this.queue(async()=>{var g,T,I;if(!this._deleted&&(this.persistenceManager=await mP.create(this,d),(g=this._resolvePersistenceManagerAvailable)===null||g===void 0||g.call(this),!this._deleted)){if(!((T=this._popupRedirectResolver)===null||T===void 0)&&T._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(h),this.lastNotifiedUid=((I=this.currentUser)===null||I===void 0?void 0:I.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const d=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!d)){if(this.currentUser&&d&&this.currentUser.uid===d.uid){this._currentUser._assign(d),await this.currentUser.getIdToken();return}await this._updateCurrentUser(d,!0)}}async initializeCurrentUserFromIdToken(d){try{const h=await J7(this,{idToken:d}),g=await d0._fromGetAccountInfoResponse(this,h,d);await this.directlySetCurrentUser(g)}catch(h){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",h),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(d){var h;if(fE(this.app)){const N=this.app.settings.authIdToken;return N?new Promise(M=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(N).then(M,M))}):this.directlySetCurrentUser(null)}const g=await this.assertedPersistence.getCurrentUser();let T=g,I=!1;if(d&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const N=(h=this.redirectUser)===null||h===void 0?void 0:h._redirectEventId,M=T==null?void 0:T._redirectEventId,k=await this.tryRedirectSignIn(d);(!N||N===M)&&(k!=null&&k.user)&&(T=k.user,I=!0)}if(!T)return this.directlySetCurrentUser(null);if(!T._redirectEventId){if(I)try{await this.beforeStateQueue.runMiddleware(T)}catch(N){T=g,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(N))}return T?this.reloadAndSetCurrentUserOrClear(T):this.directlySetCurrentUser(null)}return yr(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===T._redirectEventId?this.directlySetCurrentUser(T):this.reloadAndSetCurrentUserOrClear(T)}async tryRedirectSignIn(d){let h=null;try{h=await this._popupRedirectResolver._completeRedirectFn(this,d,!0)}catch{await this._setRedirectUser(null)}return h}async reloadAndSetCurrentUserOrClear(d){try{await X7(d)}catch(h){if((h==null?void 0:h.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(d)}useDeviceLanguage(){this.languageCode=Ime()}async _delete(){this._deleted=!0}async updateCurrentUser(d){if(fE(this.app))return Promise.reject(xA(this));const h=d?iC(d):null;return h&&yr(h.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(h&&h._clone(this))}async _updateCurrentUser(d,h=!1){if(!this._deleted)return d&&yr(this.tenantId===d.tenantId,this,"tenant-id-mismatch"),h||await this.beforeStateQueue.runMiddleware(d),this.queue(async()=>{await this.directlySetCurrentUser(d),this.notifyAuthListeners()})}async signOut(){return fE(this.app)?Promise.reject(xA(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(d){return fE(this.app)?Promise.reject(xA(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(uy(d))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(d){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const h=this._getPasswordPolicyInternal();return h.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):h.validatePassword(d)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const d=await Hme(this),h=new Yme(d);this.tenantId===null?this._projectPasswordPolicy=h:this._tenantPasswordPolicies[this.tenantId]=h}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(d){this._errorFactory=new KA("auth","Firebase",d())}onAuthStateChanged(d,h,g){return this.registerStateListener(this.authStateSubscription,d,h,g)}beforeAuthStateChanged(d,h){return this.beforeStateQueue.pushCallback(d,h)}onIdTokenChanged(d,h,g){return this.registerStateListener(this.idTokenSubscription,d,h,g)}authStateReady(){return new Promise((d,h)=>{if(this.currentUser)d();else{const g=this.onAuthStateChanged(()=>{g(),d()},h)}})}async revokeAccessToken(d){if(this.currentUser){const h=await this.currentUser.getIdToken(),g={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:d,idToken:h};this.tenantId!=null&&(g.tenantId=this.tenantId),await Bme(this,g)}}toJSON(){var d;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(d=this._currentUser)===null||d===void 0?void 0:d.toJSON()}}async _setRedirectUser(d,h){const g=await this.getOrInitRedirectPersistenceManager(h);return d===null?g.removeCurrentUser():g.setCurrentUser(d)}async getOrInitRedirectPersistenceManager(d){if(!this.redirectPersistenceManager){const h=d&&uy(d)||this._popupRedirectResolver;yr(h,this,"argument-error"),this.redirectPersistenceManager=await mP.create(this,[uy(h._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(d){var h,g;return this._isInitialized&&await this.queue(async()=>{}),((h=this._currentUser)===null||h===void 0?void 0:h._redirectEventId)===d?this._currentUser:((g=this.redirectUser)===null||g===void 0?void 0:g._redirectEventId)===d?this.redirectUser:null}async _persistUserIfCurrent(d){if(d===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(d))}_notifyListenersIfCurrent(d){d===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var d,h;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const g=(h=(d=this.currentUser)===null||d===void 0?void 0:d.uid)!==null&&h!==void 0?h:null;this.lastNotifiedUid!==g&&(this.lastNotifiedUid=g,this.authStateSubscription.next(this.currentUser))}registerStateListener(d,h,g,T){if(this._deleted)return()=>{};const I=typeof h=="function"?h:h.next.bind(h);let N=!1;const M=this._isInitialized?Promise.resolve():this._initializationPromise;if(yr(M,this,"internal-error"),M.then(()=>{N||I(this.currentUser)}),typeof h=="function"){const k=d.addObserver(h,g,T);return()=>{N=!0,k()}}else{const k=d.addObserver(h);return()=>{N=!0,k()}}}async directlySetCurrentUser(d){this.currentUser&&this.currentUser!==d&&this._currentUser._stopProactiveRefresh(),d&&this.isProactiveRefreshEnabled&&d._startProactiveRefresh(),this.currentUser=d,d?await this.assertedPersistence.setCurrentUser(d):await this.assertedPersistence.removeCurrentUser()}queue(d){return this.operations=this.operations.then(d,d),this.operations}get assertedPersistence(){return yr(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(d){!d||this.frameworks.includes(d)||(this.frameworks.push(d),this.frameworks.sort(),this.clientVersion=use(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var d;const h={"X-Client-Version":this.clientVersion};this.app.options.appId&&(h["X-Firebase-gmpid"]=this.app.options.appId);const g=await((d=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||d===void 0?void 0:d.getHeartbeatsHeader());g&&(h["X-Firebase-Client"]=g);const T=await this._getAppCheckToken();return T&&(h["X-Firebase-AppCheck"]=T),h}async _getAppCheckToken(){var d;if(fE(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const h=await((d=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||d===void 0?void 0:d.getToken());return h!=null&&h.error&&bme(`Error while retrieving App Check token: ${h.error}`),h==null?void 0:h.token}}function NG(o){return iC(o)}class ree{constructor(d){this.auth=d,this.observer=null,this.addObserver=dpe(h=>this.observer=h)}get next(){return yr(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let VQ={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function qme(o){VQ=o}function Jme(o){return VQ.loadJS(o)}function Xme(){return VQ.gapiScript}function Qme(o){return`__${o}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zme(o,d){const h=U5(o,"auth");if(h.isInitialized()){const T=h.getImmediate(),I=h.getOptions();if(TP(I,d??{}))return T;EE(T,"already-initialized")}return h.initialize({options:d})}function $me(o,d){const h=(d==null?void 0:d.persistence)||[],g=(Array.isArray(h)?h:[h]).map(uy);d!=null&&d.errorMap&&o._updateErrorMap(d.errorMap),o._initializeWithPersistence(g,d==null?void 0:d.popupRedirectResolver)}function ege(o,d,h){const g=NG(o);yr(/^https?:\/\//.test(d),g,"invalid-emulator-scheme");const T=!1,I=fse(d),{host:N,port:M}=tge(d),k=M===null?"":`:${M}`,x={url:`${I}//${N}${k}/`},V=Object.freeze({host:N,port:M,protocol:I.replace(":",""),options:Object.freeze({disableWarnings:T})});if(!g._canInitEmulator){yr(g.config.emulator&&g.emulatorConfig,g,"emulator-config-failed"),yr(TP(x,g.config.emulator)&&TP(V,g.emulatorConfig),g,"emulator-config-failed");return}g.config.emulator=x,g.emulatorConfig=V,g.settings.appVerificationDisabledForTesting=!0,AG(N)?(Xhe(`${I}//${N}${k}`),$he("Auth",!0)):nge()}function fse(o){const d=o.indexOf(":");return d<0?"":o.substr(0,d+1)}function tge(o){const d=fse(o),h=/(\/\/)?([^?#/]+)/.exec(o.substr(d.length));if(!h)return{host:"",port:null};const g=h[2].split("@").pop()||"",T=/^(\[[^\]]+\])(:|$)/.exec(g);if(T){const I=T[1];return{host:I,port:iee(g.substr(I.length+1))}}else{const[I,N]=g.split(":");return{host:I,port:iee(N)}}}function iee(o){if(!o)return null;const d=Number(o);return isNaN(d)?null:d}function nge(){function o(){const d=document.createElement("p"),h=d.style;d.innerText="Running in emulator mode. Do not use with production credentials.",h.position="fixed",h.width="100%",h.backgroundColor="#ffffff",h.border=".1em solid #000000",h.color="#b50000",h.bottom="0px",h.left="0px",h.margin="0px",h.zIndex="10000",h.textAlign="center",d.classList.add("firebase-emulator-warning"),document.body.appendChild(d)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",o):o())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hse{constructor(d,h){this.providerId=d,this.signInMethod=h}toJSON(){return dy("not implemented")}_getIdTokenResponse(d){return dy("not implemented")}_linkToIdToken(d,h){return dy("not implemented")}_getReauthenticationResolver(d){return dy("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gP(o,d){return Lme(o,"POST","/v1/accounts:signInWithIdp",xQ(o,d))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rge="http://localhost";class BA extends hse{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(d){const h=new BA(d.providerId,d.signInMethod);return d.idToken||d.accessToken?(d.idToken&&(h.idToken=d.idToken),d.accessToken&&(h.accessToken=d.accessToken),d.nonce&&!d.pendingToken&&(h.nonce=d.nonce),d.pendingToken&&(h.pendingToken=d.pendingToken)):d.oauthToken&&d.oauthTokenSecret?(h.accessToken=d.oauthToken,h.secret=d.oauthTokenSecret):EE("argument-error"),h}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(d){const h=typeof d=="string"?JSON.parse(d):d,{providerId:g,signInMethod:T}=h,I=DQ(h,["providerId","signInMethod"]);if(!g||!T)return null;const N=new BA(g,T);return N.idToken=I.idToken||void 0,N.accessToken=I.accessToken||void 0,N.secret=I.secret,N.nonce=I.nonce,N.pendingToken=I.pendingToken||null,N}_getIdTokenResponse(d){const h=this.buildRequest();return gP(d,h)}_linkToIdToken(d,h){const g=this.buildRequest();return g.idToken=h,gP(d,g)}_getReauthenticationResolver(d){const h=this.buildRequest();return h.autoCreate=!1,gP(d,h)}buildRequest(){const d={requestUri:rge,returnSecureToken:!0};if(this.pendingToken)d.pendingToken=this.pendingToken;else{const h={};this.idToken&&(h.id_token=this.idToken),this.accessToken&&(h.access_token=this.accessToken),this.secret&&(h.oauth_token_secret=this.secret),h.providerId=this.providerId,this.nonce&&!this.pendingToken&&(h.nonce=this.nonce),d.postBody=x5(h)}return d}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BQ{constructor(d){this.providerId=d,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(d){this.defaultLanguageCode=d}setCustomParameters(d){return this.customParameters=d,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B5 extends BQ{constructor(){super(...arguments),this.scopes=[]}addScope(d){return this.scopes.includes(d)||this.scopes.push(d),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X1 extends B5{constructor(){super("facebook.com")}static credential(d){return BA._fromParams({providerId:X1.PROVIDER_ID,signInMethod:X1.FACEBOOK_SIGN_IN_METHOD,accessToken:d})}static credentialFromResult(d){return X1.credentialFromTaggedObject(d)}static credentialFromError(d){return X1.credentialFromTaggedObject(d.customData||{})}static credentialFromTaggedObject({_tokenResponse:d}){if(!d||!("oauthAccessToken"in d)||!d.oauthAccessToken)return null;try{return X1.credential(d.oauthAccessToken)}catch{return null}}}X1.FACEBOOK_SIGN_IN_METHOD="facebook.com";X1.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cy extends B5{constructor(){super("google.com"),this.addScope("profile")}static credential(d,h){return BA._fromParams({providerId:cy.PROVIDER_ID,signInMethod:cy.GOOGLE_SIGN_IN_METHOD,idToken:d,accessToken:h})}static credentialFromResult(d){return cy.credentialFromTaggedObject(d)}static credentialFromError(d){return cy.credentialFromTaggedObject(d.customData||{})}static credentialFromTaggedObject({_tokenResponse:d}){if(!d)return null;const{oauthIdToken:h,oauthAccessToken:g}=d;if(!h&&!g)return null;try{return cy.credential(h,g)}catch{return null}}}cy.GOOGLE_SIGN_IN_METHOD="google.com";cy.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q1 extends B5{constructor(){super("github.com")}static credential(d){return BA._fromParams({providerId:Q1.PROVIDER_ID,signInMethod:Q1.GITHUB_SIGN_IN_METHOD,accessToken:d})}static credentialFromResult(d){return Q1.credentialFromTaggedObject(d)}static credentialFromError(d){return Q1.credentialFromTaggedObject(d.customData||{})}static credentialFromTaggedObject({_tokenResponse:d}){if(!d||!("oauthAccessToken"in d)||!d.oauthAccessToken)return null;try{return Q1.credential(d.oauthAccessToken)}catch{return null}}}Q1.GITHUB_SIGN_IN_METHOD="github.com";Q1.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z1 extends B5{constructor(){super("twitter.com")}static credential(d,h){return BA._fromParams({providerId:Z1.PROVIDER_ID,signInMethod:Z1.TWITTER_SIGN_IN_METHOD,oauthToken:d,oauthTokenSecret:h})}static credentialFromResult(d){return Z1.credentialFromTaggedObject(d)}static credentialFromError(d){return Z1.credentialFromTaggedObject(d.customData||{})}static credentialFromTaggedObject({_tokenResponse:d}){if(!d)return null;const{oauthAccessToken:h,oauthTokenSecret:g}=d;if(!h||!g)return null;try{return Z1.credential(h,g)}catch{return null}}}Z1.TWITTER_SIGN_IN_METHOD="twitter.com";Z1.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bP{constructor(d){this.user=d.user,this.providerId=d.providerId,this._tokenResponse=d._tokenResponse,this.operationType=d.operationType}static async _fromIdTokenResponse(d,h,g,T=!1){const I=await d0._fromIdTokenResponse(d,g,T),N=aee(g);return new bP({user:I,providerId:N,_tokenResponse:g,operationType:h})}static async _forOperation(d,h,g){await d._updateTokensIfNecessary(g,!0);const T=aee(g);return new bP({user:d,providerId:T,_tokenResponse:g,operationType:h})}}function aee(o){return o.providerId?o.providerId:"phoneNumber"in o?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q7 extends yy{constructor(d,h,g,T){var I;super(h.code,h.message),this.operationType=g,this.user=T,Object.setPrototypeOf(this,Q7.prototype),this.customData={appName:d.name,tenantId:(I=d.tenantId)!==null&&I!==void 0?I:void 0,_serverResponse:h.customData._serverResponse,operationType:g}}static _fromErrorAndOperation(d,h,g,T){return new Q7(d,h,g,T)}}function pse(o,d,h,g){return(d==="reauthenticate"?h._getReauthenticationResolver(o):h._getIdTokenResponse(o)).catch(I=>{throw I.code==="auth/multi-factor-auth-required"?Q7._fromErrorAndOperation(o,I,d,g):I})}async function ige(o,d,h=!1){const g=await p5(o,d._linkToIdToken(o.auth,await o.getIdToken()),h);return bP._forOperation(o,"link",g)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function age(o,d,h=!1){const{auth:g}=o;if(fE(g.app))return Promise.reject(xA(g));const T="reauthenticate";try{const I=await p5(o,pse(g,T,d,o),h);yr(I.idToken,g,"internal-error");const N=UQ(I.idToken);yr(N,g,"internal-error");const{sub:M}=N;return yr(o.uid===M,g,"user-mismatch"),bP._forOperation(o,T,I)}catch(I){throw(I==null?void 0:I.code)==="auth/user-not-found"&&EE(g,"user-mismatch"),I}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sge(o,d,h=!1){if(fE(o.app))return Promise.reject(xA(o));const g="signIn",T=await pse(o,g,d),I=await bP._fromIdTokenResponse(o,g,T);return h||await o._updateCurrentUser(I.user),I}function oge(o,d,h,g){return iC(o).onIdTokenChanged(d,h,g)}function cge(o,d,h){return iC(o).beforeAuthStateChanged(d,h)}const Z7="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mse{constructor(d,h){this.storageRetriever=d,this.type=h}_isAvailable(){try{return this.storage?(this.storage.setItem(Z7,"1"),this.storage.removeItem(Z7),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(d,h){return this.storage.setItem(d,JSON.stringify(h)),Promise.resolve()}_get(d){const h=this.storage.getItem(d);return Promise.resolve(h?JSON.parse(h):null)}_remove(d){return this.storage.removeItem(d),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lge=1e3,dge=10;class gse extends mse{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(d,h)=>this.onStorageEvent(d,h),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=dse(),this._shouldAllowMigration=!0}forAllChangedKeys(d){for(const h of Object.keys(this.listeners)){const g=this.storage.getItem(h),T=this.localCache[h];g!==T&&d(h,T,g)}}onStorageEvent(d,h=!1){if(!d.key){this.forAllChangedKeys((N,M,k)=>{this.notifyListeners(N,k)});return}const g=d.key;h?this.detachListener():this.stopPolling();const T=()=>{const N=this.storage.getItem(g);!h&&this.localCache[g]===N||this.notifyListeners(g,N)},I=this.storage.getItem(g);Gme()&&I!==d.newValue&&d.newValue!==d.oldValue?setTimeout(T,dge):T()}notifyListeners(d,h){this.localCache[d]=h;const g=this.listeners[d];if(g)for(const T of Array.from(g))T(h&&JSON.parse(h))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((d,h,g)=>{this.onStorageEvent(new StorageEvent("storage",{key:d,oldValue:h,newValue:g}),!0)})},lge)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(d,h){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[d]||(this.listeners[d]=new Set,this.localCache[d]=this.storage.getItem(d)),this.listeners[d].add(h)}_removeListener(d,h){this.listeners[d]&&(this.listeners[d].delete(h),this.listeners[d].size===0&&delete this.listeners[d]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(d,h){await super._set(d,h),this.localCache[d]=JSON.stringify(h)}async _get(d){const h=await super._get(d);return this.localCache[d]=JSON.stringify(h),h}async _remove(d){await super._remove(d),delete this.localCache[d]}}gse.type="LOCAL";const uge=gse;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _se extends mse{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(d,h){}_removeListener(d,h){}}_se.type="SESSION";const Ese=_se;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fge(o){return Promise.all(o.map(async d=>{try{return{fulfilled:!0,value:await d}}catch(h){return{fulfilled:!1,reason:h}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LG{constructor(d){this.eventTarget=d,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(d){const h=this.receivers.find(T=>T.isListeningto(d));if(h)return h;const g=new LG(d);return this.receivers.push(g),g}isListeningto(d){return this.eventTarget===d}async handleEvent(d){const h=d,{eventId:g,eventType:T,data:I}=h.data,N=this.handlersMap[T];if(!(N!=null&&N.size))return;h.ports[0].postMessage({status:"ack",eventId:g,eventType:T});const M=Array.from(N).map(async x=>x(h.origin,I)),k=await fge(M);h.ports[0].postMessage({status:"done",eventId:g,eventType:T,response:k})}_subscribe(d,h){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[d]||(this.handlersMap[d]=new Set),this.handlersMap[d].add(h)}_unsubscribe(d,h){this.handlersMap[d]&&h&&this.handlersMap[d].delete(h),(!h||this.handlersMap[d].size===0)&&delete this.handlersMap[d],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}LG.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FQ(o="",d=10){let h="";for(let g=0;g<d;g++)h+=Math.floor(Math.random()*10);return o+h}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hge{constructor(d){this.target=d,this.handlers=new Set}removeMessageHandler(d){d.messageChannel&&(d.messageChannel.port1.removeEventListener("message",d.onMessage),d.messageChannel.port1.close()),this.handlers.delete(d)}async _send(d,h,g=50){const T=typeof MessageChannel<"u"?new MessageChannel:null;if(!T)throw new Error("connection_unavailable");let I,N;return new Promise((M,k)=>{const x=FQ("",20);T.port1.start();const V=setTimeout(()=>{k(new Error("unsupported_event"))},g);N={messageChannel:T,onMessage(K){const Q=K;if(Q.data.eventId===x)switch(Q.data.status){case"ack":clearTimeout(V),I=setTimeout(()=>{k(new Error("timeout"))},3e3);break;case"done":clearTimeout(I),M(Q.data.response);break;default:clearTimeout(V),clearTimeout(I),k(new Error("invalid_response"));break}}},this.handlers.add(N),T.port1.addEventListener("message",N.onMessage),this.target.postMessage({eventType:d,eventId:x,data:h},[T.port2])}).finally(()=>{N&&this.removeMessageHandler(N)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pE(){return window}function pge(o){pE().location.href=o}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vse(){return typeof pE().WorkerGlobalScope<"u"&&typeof pE().importScripts=="function"}async function mge(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function gge(){var o;return((o=navigator==null?void 0:navigator.serviceWorker)===null||o===void 0?void 0:o.controller)||null}function _ge(){return vse()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sse="firebaseLocalStorageDb",Ege=1,$7="firebaseLocalStorage",yse="fbase_key";class F5{constructor(d){this.request=d}toPromise(){return new Promise((d,h)=>{this.request.addEventListener("success",()=>{d(this.request.result)}),this.request.addEventListener("error",()=>{h(this.request.error)})})}}function DG(o,d){return o.transaction([$7],d?"readwrite":"readonly").objectStore($7)}function vge(){const o=indexedDB.deleteDatabase(Sse);return new F5(o).toPromise()}function HX(){const o=indexedDB.open(Sse,Ege);return new Promise((d,h)=>{o.addEventListener("error",()=>{h(o.error)}),o.addEventListener("upgradeneeded",()=>{const g=o.result;try{g.createObjectStore($7,{keyPath:yse})}catch(T){h(T)}}),o.addEventListener("success",async()=>{const g=o.result;g.objectStoreNames.contains($7)?d(g):(g.close(),await vge(),d(await HX()))})})}async function see(o,d,h){const g=DG(o,!0).put({[yse]:d,value:h});return new F5(g).toPromise()}async function Sge(o,d){const h=DG(o,!1).get(d),g=await new F5(h).toPromise();return g===void 0?null:g.value}function oee(o,d){const h=DG(o,!0).delete(d);return new F5(h).toPromise()}const yge=800,Tge=3;class Tse{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await HX(),this.db)}async _withRetries(d){let h=0;for(;;)try{const g=await this._openDb();return await d(g)}catch(g){if(h++>Tge)throw g;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return vse()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=LG._getInstance(_ge()),this.receiver._subscribe("keyChanged",async(d,h)=>({keyProcessed:(await this._poll()).includes(h.key)})),this.receiver._subscribe("ping",async(d,h)=>["keyChanged"])}async initializeSender(){var d,h;if(this.activeServiceWorker=await mge(),!this.activeServiceWorker)return;this.sender=new hge(this.activeServiceWorker);const g=await this.sender._send("ping",{},800);g&&!((d=g[0])===null||d===void 0)&&d.fulfilled&&!((h=g[0])===null||h===void 0)&&h.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(d){if(!(!this.sender||!this.activeServiceWorker||gge()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:d},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const d=await HX();return await see(d,Z7,"1"),await oee(d,Z7),!0}catch{}return!1}async _withPendingWrite(d){this.pendingWrites++;try{await d()}finally{this.pendingWrites--}}async _set(d,h){return this._withPendingWrite(async()=>(await this._withRetries(g=>see(g,d,h)),this.localCache[d]=h,this.notifyServiceWorker(d)))}async _get(d){const h=await this._withRetries(g=>Sge(g,d));return this.localCache[d]=h,h}async _remove(d){return this._withPendingWrite(async()=>(await this._withRetries(h=>oee(h,d)),delete this.localCache[d],this.notifyServiceWorker(d)))}async _poll(){const d=await this._withRetries(T=>{const I=DG(T,!1).getAll();return new F5(I).toPromise()});if(!d)return[];if(this.pendingWrites!==0)return[];const h=[],g=new Set;if(d.length!==0)for(const{fbase_key:T,value:I}of d)g.add(T),JSON.stringify(this.localCache[T])!==JSON.stringify(I)&&(this.notifyListeners(T,I),h.push(T));for(const T of Object.keys(this.localCache))this.localCache[T]&&!g.has(T)&&(this.notifyListeners(T,null),h.push(T));return h}notifyListeners(d,h){this.localCache[d]=h;const g=this.listeners[d];if(g)for(const T of Array.from(g))T(h)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),yge)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(d,h){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[d]||(this.listeners[d]=new Set,this._get(d)),this.listeners[d].add(h)}_removeListener(d,h){this.listeners[d]&&(this.listeners[d].delete(h),this.listeners[d].size===0&&delete this.listeners[d]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Tse.type="LOCAL";const bge=Tse;new V5(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bse(o,d){return d?uy(d):(yr(o._popupRedirectResolver,o,"argument-error"),o._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GQ extends hse{constructor(d){super("custom","custom"),this.params=d}_getIdTokenResponse(d){return gP(d,this._buildIdpRequest())}_linkToIdToken(d,h){return gP(d,this._buildIdpRequest(h))}_getReauthenticationResolver(d){return gP(d,this._buildIdpRequest())}_buildIdpRequest(d){const h={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return d&&(h.idToken=d),h}}function Cge(o){return sge(o.auth,new GQ(o),o.bypassAuthState)}function wge(o){const{auth:d,user:h}=o;return yr(h,d,"internal-error"),age(h,new GQ(o),o.bypassAuthState)}async function Rge(o){const{auth:d,user:h}=o;return yr(h,d,"internal-error"),ige(h,new GQ(o),o.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cse{constructor(d,h,g,T,I=!1){this.auth=d,this.resolver=g,this.user=T,this.bypassAuthState=I,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(h)?h:[h]}execute(){return new Promise(async(d,h)=>{this.pendingPromise={resolve:d,reject:h};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(g){this.reject(g)}})}async onAuthEvent(d){const{urlResponse:h,sessionId:g,postBody:T,tenantId:I,error:N,type:M}=d;if(N){this.reject(N);return}const k={auth:this.auth,requestUri:h,sessionId:g,tenantId:I||void 0,postBody:T||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(M)(k))}catch(x){this.reject(x)}}onError(d){this.reject(d)}getIdpTask(d){switch(d){case"signInViaPopup":case"signInViaRedirect":return Cge;case"linkViaPopup":case"linkViaRedirect":return Rge;case"reauthViaPopup":case"reauthViaRedirect":return wge;default:EE(this.auth,"internal-error")}}resolve(d){_y(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(d),this.unregisterAndCleanUp()}reject(d){_y(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(d),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ige=new V5(2e3,1e4);async function Age(o,d,h){if(fE(o.app))return Promise.reject(u0(o,"operation-not-supported-in-this-environment"));const g=NG(o);Cme(o,d,BQ);const T=bse(g,h);return new LA(g,"signInViaPopup",d,T).executeNotNull()}class LA extends Cse{constructor(d,h,g,T,I){super(d,h,T,I),this.provider=g,this.authWindow=null,this.pollId=null,LA.currentPopupAction&&LA.currentPopupAction.cancel(),LA.currentPopupAction=this}async executeNotNull(){const d=await this.execute();return yr(d,this.auth,"internal-error"),d}async onExecution(){_y(this.filter.length===1,"Popup operations only handle one event");const d=FQ();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],d),this.authWindow.associatedEvent=d,this.resolver._originValidation(this.auth).catch(h=>{this.reject(h)}),this.resolver._isIframeWebStorageSupported(this.auth,h=>{h||this.reject(u0(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var d;return((d=this.authWindow)===null||d===void 0?void 0:d.associatedEvent)||null}cancel(){this.reject(u0(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,LA.currentPopupAction=null}pollUserCancellation(){const d=()=>{var h,g;if(!((g=(h=this.authWindow)===null||h===void 0?void 0:h.window)===null||g===void 0)&&g.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(u0(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(d,Ige.get())};d()}}LA.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oge="pendingRedirect",L7=new Map;class Nge extends Cse{constructor(d,h,g=!1){super(d,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],h,void 0,g),this.eventId=null}async execute(){let d=L7.get(this.auth._key());if(!d){try{const g=await Lge(this.resolver,this.auth)?await super.execute():null;d=()=>Promise.resolve(g)}catch(h){d=()=>Promise.reject(h)}L7.set(this.auth._key(),d)}return this.bypassAuthState||L7.set(this.auth._key(),()=>Promise.resolve(null)),d()}async onAuthEvent(d){if(d.type==="signInViaRedirect")return super.onAuthEvent(d);if(d.type==="unknown"){this.resolve(null);return}if(d.eventId){const h=await this.auth._redirectUserForId(d.eventId);if(h)return this.user=h,super.onAuthEvent(d);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function Lge(o,d){const h=Mge(d),g=Pge(o);if(!await g._isAvailable())return!1;const T=await g._get(h)==="true";return await g._remove(h),T}function Dge(o,d){L7.set(o._key(),d)}function Pge(o){return uy(o._redirectPersistence)}function Mge(o){return N7(Oge,o.config.apiKey,o.name)}async function kge(o,d,h=!1){if(fE(o.app))return Promise.reject(xA(o));const g=NG(o),T=bse(g,d),N=await new Nge(g,T,h).execute();return N&&!h&&(delete N.user._redirectEventId,await g._persistUserIfCurrent(N.user),await g._setRedirectUser(null,d)),N}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xge=10*60*1e3;class Uge{constructor(d){this.auth=d,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(d){this.consumers.add(d),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,d)&&(this.sendToConsumer(this.queuedRedirectEvent,d),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(d){this.consumers.delete(d)}onEvent(d){if(this.hasEventBeenHandled(d))return!1;let h=!1;return this.consumers.forEach(g=>{this.isEventForConsumer(d,g)&&(h=!0,this.sendToConsumer(d,g),this.saveEventToCache(d))}),this.hasHandledPotentialRedirect||!jge(d)||(this.hasHandledPotentialRedirect=!0,h||(this.queuedRedirectEvent=d,h=!0)),h}sendToConsumer(d,h){var g;if(d.error&&!wse(d)){const T=((g=d.error.code)===null||g===void 0?void 0:g.split("auth/")[1])||"internal-error";h.onError(u0(this.auth,T))}else h.onAuthEvent(d)}isEventForConsumer(d,h){const g=h.eventId===null||!!d.eventId&&d.eventId===h.eventId;return h.filter.includes(d.type)&&g}hasEventBeenHandled(d){return Date.now()-this.lastProcessedEventTime>=xge&&this.cachedEventUids.clear(),this.cachedEventUids.has(cee(d))}saveEventToCache(d){this.cachedEventUids.add(cee(d)),this.lastProcessedEventTime=Date.now()}}function cee(o){return[o.type,o.eventId,o.sessionId,o.tenantId].filter(d=>d).join("-")}function wse({type:o,error:d}){return o==="unknown"&&(d==null?void 0:d.code)==="auth/no-auth-event"}function jge(o){switch(o.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return wse(o);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Vge(o,d={}){return jP(o,"GET","/v1/projects",d)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bge=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Fge=/^https?/;async function Gge(o){if(o.config.emulator)return;const{authorizedDomains:d}=await Vge(o);for(const h of d)try{if(zge(h))return}catch{}EE(o,"unauthorized-domain")}function zge(o){const d=GX(),{protocol:h,hostname:g}=new URL(d);if(o.startsWith("chrome-extension://")){const N=new URL(o);return N.hostname===""&&g===""?h==="chrome-extension:"&&o.replace("chrome-extension://","")===d.replace("chrome-extension://",""):h==="chrome-extension:"&&N.hostname===g}if(!Fge.test(h))return!1;if(Bge.test(o))return g===o;const T=o.replace(/\./g,"\\.");return new RegExp("^(.+\\."+T+"|"+T+")$","i").test(g)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hge=new V5(3e4,6e4);function lee(){const o=pE().___jsl;if(o!=null&&o.H){for(const d of Object.keys(o.H))if(o.H[d].r=o.H[d].r||[],o.H[d].L=o.H[d].L||[],o.H[d].r=[...o.H[d].L],o.CP)for(let h=0;h<o.CP.length;h++)o.CP[h]=null}}function Wge(o){return new Promise((d,h)=>{var g,T,I;function N(){lee(),gapi.load("gapi.iframes",{callback:()=>{d(gapi.iframes.getContext())},ontimeout:()=>{lee(),h(u0(o,"network-request-failed"))},timeout:Hge.get()})}if(!((T=(g=pE().gapi)===null||g===void 0?void 0:g.iframes)===null||T===void 0)&&T.Iframe)d(gapi.iframes.getContext());else if(!((I=pE().gapi)===null||I===void 0)&&I.load)N();else{const M=Qme("iframefcb");return pE()[M]=()=>{gapi.load?N():h(u0(o,"network-request-failed"))},Jme(`${Xme()}?onload=${M}`).catch(k=>h(k))}}).catch(d=>{throw D7=null,d})}let D7=null;function Yge(o){return D7=D7||Wge(o),D7}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kge=new V5(5e3,15e3),qge="__/auth/iframe",Jge="emulator/auth/iframe",Xge={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Qge=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Zge(o){const d=o.config;yr(d.authDomain,o,"auth-domain-config-required");const h=d.emulator?kQ(d,Jge):`https://${o.config.authDomain}/${qge}`,g={apiKey:d.apiKey,appName:o.name,v:j5},T=Qge.get(o.config.apiHost);T&&(g.eid=T);const I=o._getFrameworks();return I.length&&(g.fw=I.join(",")),`${h}?${x5(g).slice(1)}`}async function $ge(o){const d=await Yge(o),h=pE().gapi;return yr(h,o,"internal-error"),d.open({where:document.body,url:Zge(o),messageHandlersFilter:h.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Xge,dontclear:!0},g=>new Promise(async(T,I)=>{await g.restyle({setHideOnLeave:!1});const N=u0(o,"network-request-failed"),M=pE().setTimeout(()=>{I(N)},Kge.get());function k(){pE().clearTimeout(M),T(g)}g.ping(k).then(k,()=>{I(N)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e0e={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},t0e=500,n0e=600,r0e="_blank",i0e="http://localhost";class dee{constructor(d){this.window=d,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function a0e(o,d,h,g=t0e,T=n0e){const I=Math.max((window.screen.availHeight-T)/2,0).toString(),N=Math.max((window.screen.availWidth-g)/2,0).toString();let M="";const k=Object.assign(Object.assign({},e0e),{width:g.toString(),height:T.toString(),top:I,left:N}),x=_u().toLowerCase();h&&(M=ase(x)?r0e:h),rse(x)&&(d=d||i0e,k.scrollbars="yes");const V=Object.entries(k).reduce((Q,[ie,X])=>`${Q}${ie}=${X},`,"");if(Fme(x)&&M!=="_self")return s0e(d||"",M),new dee(null);const K=window.open(d||"",M,V);yr(K,o,"popup-blocked");try{K.focus()}catch{}return new dee(K)}function s0e(o,d){const h=document.createElement("a");h.href=o,h.target=d;const g=document.createEvent("MouseEvent");g.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),h.dispatchEvent(g)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o0e="__/auth/handler",c0e="emulator/auth/handler",l0e=encodeURIComponent("fac");async function uee(o,d,h,g,T,I){yr(o.config.authDomain,o,"auth-domain-config-required"),yr(o.config.apiKey,o,"invalid-api-key");const N={apiKey:o.config.apiKey,appName:o.name,authType:h,redirectUrl:g,v:j5,eventId:T};if(d instanceof BQ){d.setDefaultLanguage(o.languageCode),N.providerId=d.providerId||"",lpe(d.getCustomParameters())||(N.customParameters=JSON.stringify(d.getCustomParameters()));for(const[V,K]of Object.entries({}))N[V]=K}if(d instanceof B5){const V=d.getScopes().filter(K=>K!=="");V.length>0&&(N.scopes=V.join(","))}o.tenantId&&(N.tid=o.tenantId);const M=N;for(const V of Object.keys(M))M[V]===void 0&&delete M[V];const k=await o._getAppCheckToken(),x=k?`#${l0e}=${encodeURIComponent(k)}`:"";return`${d0e(o)}?${x5(M).slice(1)}${x}`}function d0e({config:o}){return o.emulator?kQ(o,c0e):`https://${o.authDomain}/${o0e}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FK="webStorageSupport";class u0e{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Ese,this._completeRedirectFn=kge,this._overrideRedirectResult=Dge}async _openPopup(d,h,g,T){var I;_y((I=this.eventManagers[d._key()])===null||I===void 0?void 0:I.manager,"_initialize() not called before _openPopup()");const N=await uee(d,h,g,GX(),T);return a0e(d,N,FQ())}async _openRedirect(d,h,g,T){await this._originValidation(d);const I=await uee(d,h,g,GX(),T);return pge(I),new Promise(()=>{})}_initialize(d){const h=d._key();if(this.eventManagers[h]){const{manager:T,promise:I}=this.eventManagers[h];return T?Promise.resolve(T):(_y(I,"If manager is not set, promise should be"),I)}const g=this.initAndGetManager(d);return this.eventManagers[h]={promise:g},g.catch(()=>{delete this.eventManagers[h]}),g}async initAndGetManager(d){const h=await $ge(d),g=new Uge(d);return h.register("authEvent",T=>(yr(T==null?void 0:T.authEvent,d,"invalid-auth-event"),{status:g.onEvent(T.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[d._key()]={manager:g},this.iframes[d._key()]=h,g}_isIframeWebStorageSupported(d,h){this.iframes[d._key()].send(FK,{type:FK},T=>{var I;const N=(I=T==null?void 0:T[0])===null||I===void 0?void 0:I[FK];N!==void 0&&h(!!N),EE(d,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(d){const h=d._key();return this.originValidationPromises[h]||(this.originValidationPromises[h]=Gge(d)),this.originValidationPromises[h]}get _shouldInitProactively(){return dse()||ise()||jQ()}}const f0e=u0e;var fee="@firebase/auth",hee="1.10.7";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h0e{constructor(d){this.auth=d,this.internalListeners=new Map}getUid(){var d;return this.assertAuthConfigured(),((d=this.auth.currentUser)===null||d===void 0?void 0:d.uid)||null}async getToken(d){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(d)}:null}addAuthTokenListener(d){if(this.assertAuthConfigured(),this.internalListeners.has(d))return;const h=this.auth.onIdTokenChanged(g=>{d((g==null?void 0:g.stsTokenManager.accessToken)||null)});this.internalListeners.set(d,h),this.updateProactiveRefresh()}removeAuthTokenListener(d){this.assertAuthConfigured();const h=this.internalListeners.get(d);h&&(this.internalListeners.delete(d),h(),this.updateProactiveRefresh())}assertAuthConfigured(){yr(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p0e(o){switch(o){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function m0e(o){gy(new _E("auth",(d,{options:h})=>{const g=d.getProvider("app").getImmediate(),T=d.getProvider("heartbeat"),I=d.getProvider("app-check-internal"),{apiKey:N,authDomain:M}=g.options;yr(N&&!N.includes(":"),"invalid-api-key",{appName:g.name});const k={apiKey:N,authDomain:M,clientPlatform:o,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:use(o)},x=new Kme(g,T,I,k);return $me(x,h),x},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((d,h,g)=>{d.getProvider("auth-internal").initialize()})),gy(new _E("auth-internal",d=>{const h=NG(d.getProvider("auth").getImmediate());return(g=>new h0e(g))(h)},"PRIVATE").setInstantiationMode("EXPLICIT")),hE(fee,hee,p0e(o)),hE(fee,hee,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g0e=5*60,_0e=Bae("authIdTokenMaxAge")||g0e;let pee=null;const E0e=o=>async d=>{const h=d&&await d.getIdTokenResult(),g=h&&(new Date().getTime()-Date.parse(h.issuedAtTime))/1e3;if(g&&g>_0e)return;const T=h==null?void 0:h.token;pee!==T&&(pee=T,await fetch(o,{method:T?"POST":"DELETE",headers:T?{Authorization:`Bearer ${T}`}:{}}))};function v0e(o=Kae()){const d=U5(o,"auth");if(d.isInitialized())return d.getImmediate();const h=Zme(o,{popupRedirectResolver:f0e,persistence:[bge,uge,Ese]}),g=Bae("authTokenSyncURL");if(g&&typeof isSecureContext=="boolean"&&isSecureContext){const I=new URL(g,location.origin);if(location.origin===I.origin){const N=E0e(I.toString());cge(h,N,()=>N(h.currentUser)),oge(h,M=>N(M))}}const T=qhe("auth");return T&&ege(h,`http://${T}`),h}function S0e(){var o,d;return(d=(o=document.getElementsByTagName("head"))===null||o===void 0?void 0:o[0])!==null&&d!==void 0?d:document}qme({loadJS(o){return new Promise((d,h)=>{const g=document.createElement("script");g.setAttribute("src",o),g.onload=d,g.onerror=T=>{const I=u0("internal-error");I.customData=T,h(I)},g.type="text/javascript",g.charset="UTF-8",S0e().appendChild(g)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});m0e("Browser");const Rse="@firebase/installations",zQ="0.6.17";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ise=1e4,Ase=`w:${zQ}`,Ose="FIS_v2",y0e="https://firebaseinstallations.googleapis.com/v1",T0e=60*60*1e3,b0e="installations",C0e="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w0e={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},FA=new KA(b0e,C0e,w0e);function Nse(o){return o instanceof yy&&o.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lse({projectId:o}){return`${y0e}/projects/${o}/installations`}function Dse(o){return{token:o.token,requestStatus:2,expiresIn:I0e(o.expiresIn),creationTime:Date.now()}}async function Pse(o,d){const g=(await d.json()).error;return FA.create("request-failed",{requestName:o,serverCode:g.code,serverMessage:g.message,serverStatus:g.status})}function Mse({apiKey:o}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":o})}function R0e(o,{refreshToken:d}){const h=Mse(o);return h.append("Authorization",A0e(d)),h}async function kse(o){const d=await o();return d.status>=500&&d.status<600?o():d}function I0e(o){return Number(o.replace("s","000"))}function A0e(o){return`${Ose} ${o}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function O0e({appConfig:o,heartbeatServiceProvider:d},{fid:h}){const g=Lse(o),T=Mse(o),I=d.getImmediate({optional:!0});if(I){const x=await I.getHeartbeatsHeader();x&&T.append("x-firebase-client",x)}const N={fid:h,authVersion:Ose,appId:o.appId,sdkVersion:Ase},M={method:"POST",headers:T,body:JSON.stringify(N)},k=await kse(()=>fetch(g,M));if(k.ok){const x=await k.json();return{fid:x.fid||h,registrationStatus:2,refreshToken:x.refreshToken,authToken:Dse(x.authToken)}}else throw await Pse("Create Installation",k)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xse(o){return new Promise(d=>{setTimeout(d,o)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function N0e(o){return btoa(String.fromCharCode(...o)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L0e=/^[cdef][\w-]{21}$/,WX="";function D0e(){try{const o=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(o),o[0]=112+o[0]%16;const h=P0e(o);return L0e.test(h)?h:WX}catch{return WX}}function P0e(o){return N0e(o).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PG(o){return`${o.appName}!${o.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Use=new Map;function jse(o,d){const h=PG(o);Vse(h,d),M0e(h,d)}function Vse(o,d){const h=Use.get(o);if(h)for(const g of h)g(d)}function M0e(o,d){const h=k0e();h&&h.postMessage({key:o,fid:d}),x0e()}let DA=null;function k0e(){return!DA&&"BroadcastChannel"in self&&(DA=new BroadcastChannel("[Firebase] FID Change"),DA.onmessage=o=>{Vse(o.data.key,o.data.fid)}),DA}function x0e(){Use.size===0&&DA&&(DA.close(),DA=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U0e="firebase-installations-database",j0e=1,GA="firebase-installations-store";let GK=null;function HQ(){return GK||(GK=OG(U0e,j0e,{upgrade:(o,d)=>{switch(d){case 0:o.createObjectStore(GA)}}})),GK}async function eG(o,d){const h=PG(o),T=(await HQ()).transaction(GA,"readwrite"),I=T.objectStore(GA),N=await I.get(h);return await I.put(d,h),await T.done,(!N||N.fid!==d.fid)&&jse(o,d.fid),d}async function Bse(o){const d=PG(o),g=(await HQ()).transaction(GA,"readwrite");await g.objectStore(GA).delete(d),await g.done}async function MG(o,d){const h=PG(o),T=(await HQ()).transaction(GA,"readwrite"),I=T.objectStore(GA),N=await I.get(h),M=d(N);return M===void 0?await I.delete(h):await I.put(M,h),await T.done,M&&(!N||N.fid!==M.fid)&&jse(o,M.fid),M}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function WQ(o){let d;const h=await MG(o.appConfig,g=>{const T=V0e(g),I=B0e(o,T);return d=I.registrationPromise,I.installationEntry});return h.fid===WX?{installationEntry:await d}:{installationEntry:h,registrationPromise:d}}function V0e(o){const d=o||{fid:D0e(),registrationStatus:0};return Fse(d)}function B0e(o,d){if(d.registrationStatus===0){if(!navigator.onLine){const T=Promise.reject(FA.create("app-offline"));return{installationEntry:d,registrationPromise:T}}const h={fid:d.fid,registrationStatus:1,registrationTime:Date.now()},g=F0e(o,h);return{installationEntry:h,registrationPromise:g}}else return d.registrationStatus===1?{installationEntry:d,registrationPromise:G0e(o)}:{installationEntry:d}}async function F0e(o,d){try{const h=await O0e(o,d);return eG(o.appConfig,h)}catch(h){throw Nse(h)&&h.customData.serverCode===409?await Bse(o.appConfig):await eG(o.appConfig,{fid:d.fid,registrationStatus:0}),h}}async function G0e(o){let d=await mee(o.appConfig);for(;d.registrationStatus===1;)await xse(100),d=await mee(o.appConfig);if(d.registrationStatus===0){const{installationEntry:h,registrationPromise:g}=await WQ(o);return g||h}return d}function mee(o){return MG(o,d=>{if(!d)throw FA.create("installation-not-found");return Fse(d)})}function Fse(o){return z0e(o)?{fid:o.fid,registrationStatus:0}:o}function z0e(o){return o.registrationStatus===1&&o.registrationTime+Ise<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function H0e({appConfig:o,heartbeatServiceProvider:d},h){const g=W0e(o,h),T=R0e(o,h),I=d.getImmediate({optional:!0});if(I){const x=await I.getHeartbeatsHeader();x&&T.append("x-firebase-client",x)}const N={installation:{sdkVersion:Ase,appId:o.appId}},M={method:"POST",headers:T,body:JSON.stringify(N)},k=await kse(()=>fetch(g,M));if(k.ok){const x=await k.json();return Dse(x)}else throw await Pse("Generate Auth Token",k)}function W0e(o,{fid:d}){return`${Lse(o)}/${d}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function YQ(o,d=!1){let h;const g=await MG(o.appConfig,I=>{if(!Gse(I))throw FA.create("not-registered");const N=I.authToken;if(!d&&q0e(N))return I;if(N.requestStatus===1)return h=Y0e(o,d),I;{if(!navigator.onLine)throw FA.create("app-offline");const M=X0e(I);return h=K0e(o,M),M}});return h?await h:g.authToken}async function Y0e(o,d){let h=await gee(o.appConfig);for(;h.authToken.requestStatus===1;)await xse(100),h=await gee(o.appConfig);const g=h.authToken;return g.requestStatus===0?YQ(o,d):g}function gee(o){return MG(o,d=>{if(!Gse(d))throw FA.create("not-registered");const h=d.authToken;return Q0e(h)?Object.assign(Object.assign({},d),{authToken:{requestStatus:0}}):d})}async function K0e(o,d){try{const h=await H0e(o,d),g=Object.assign(Object.assign({},d),{authToken:h});return await eG(o.appConfig,g),h}catch(h){if(Nse(h)&&(h.customData.serverCode===401||h.customData.serverCode===404))await Bse(o.appConfig);else{const g=Object.assign(Object.assign({},d),{authToken:{requestStatus:0}});await eG(o.appConfig,g)}throw h}}function Gse(o){return o!==void 0&&o.registrationStatus===2}function q0e(o){return o.requestStatus===2&&!J0e(o)}function J0e(o){const d=Date.now();return d<o.creationTime||o.creationTime+o.expiresIn<d+T0e}function X0e(o){const d={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},o),{authToken:d})}function Q0e(o){return o.requestStatus===1&&o.requestTime+Ise<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Z0e(o){const d=o,{installationEntry:h,registrationPromise:g}=await WQ(d);return g?g.catch(console.error):YQ(d).catch(console.error),h.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $0e(o,d=!1){const h=o;return await e_e(h),(await YQ(h,d)).token}async function e_e(o){const{registrationPromise:d}=await WQ(o);d&&await d}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t_e(o){if(!o||!o.options)throw zK("App Configuration");if(!o.name)throw zK("App Name");const d=["projectId","apiKey","appId"];for(const h of d)if(!o.options[h])throw zK(h);return{appName:o.name,projectId:o.options.projectId,apiKey:o.options.apiKey,appId:o.options.appId}}function zK(o){return FA.create("missing-app-config-values",{valueName:o})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zse="installations",n_e="installations-internal",r_e=o=>{const d=o.getProvider("app").getImmediate(),h=t_e(d),g=U5(d,"heartbeat");return{app:d,appConfig:h,heartbeatServiceProvider:g,_delete:()=>Promise.resolve()}},i_e=o=>{const d=o.getProvider("app").getImmediate(),h=U5(d,zse).getImmediate();return{getId:()=>Z0e(h),getToken:T=>$0e(h,T)}};function a_e(){gy(new _E(zse,r_e,"PUBLIC")),gy(new _E(n_e,i_e,"PRIVATE"))}a_e();hE(Rse,zQ);hE(Rse,zQ,"esm2017");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s_e="/firebase-messaging-sw.js",o_e="/firebase-cloud-messaging-push-scope",Hse="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",c_e="https://fcmregistrations.googleapis.com/v1",Wse="google.c.a.c_id",l_e="google.c.a.c_l",d_e="google.c.a.ts",u_e="google.c.a.e",_ee=1e4;var Eee;(function(o){o[o.DATA_MESSAGE=1]="DATA_MESSAGE",o[o.DISPLAY_NOTIFICATION=3]="DISPLAY_NOTIFICATION"})(Eee||(Eee={}));/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except
 * in compliance with the License. You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under the License
 * is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express
 * or implied. See the License for the specific language governing permissions and limitations under
 * the License.
 */var m5;(function(o){o.PUSH_RECEIVED="push-received",o.NOTIFICATION_CLICKED="notification-clicked"})(m5||(m5={}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oy(o){const d=new Uint8Array(o);return btoa(String.fromCharCode(...d)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function f_e(o){const d="=".repeat((4-o.length%4)%4),h=(o+d).replace(/\-/g,"+").replace(/_/g,"/"),g=atob(h),T=new Uint8Array(g.length);for(let I=0;I<g.length;++I)T[I]=g.charCodeAt(I);return T}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HK="fcm_token_details_db",h_e=5,vee="fcm_token_object_Store";async function p_e(o){if("databases"in indexedDB&&!(await indexedDB.databases()).map(I=>I.name).includes(HK))return null;let d=null;return(await OG(HK,h_e,{upgrade:async(g,T,I,N)=>{var M;if(T<2||!g.objectStoreNames.contains(vee))return;const k=N.objectStore(vee),x=await k.index("fcmSenderId").get(o);if(await k.clear(),!!x){if(T===2){const V=x;if(!V.auth||!V.p256dh||!V.endpoint)return;d={token:V.fcmToken,createTime:(M=V.createTime)!==null&&M!==void 0?M:Date.now(),subscriptionOptions:{auth:V.auth,p256dh:V.p256dh,endpoint:V.endpoint,swScope:V.swScope,vapidKey:typeof V.vapidKey=="string"?V.vapidKey:oy(V.vapidKey)}}}else if(T===3){const V=x;d={token:V.fcmToken,createTime:V.createTime,subscriptionOptions:{auth:oy(V.auth),p256dh:oy(V.p256dh),endpoint:V.endpoint,swScope:V.swScope,vapidKey:oy(V.vapidKey)}}}else if(T===4){const V=x;d={token:V.fcmToken,createTime:V.createTime,subscriptionOptions:{auth:oy(V.auth),p256dh:oy(V.p256dh),endpoint:V.endpoint,swScope:V.swScope,vapidKey:oy(V.vapidKey)}}}}}})).close(),await UK(HK),await UK("fcm_vapid_details_db"),await UK("undefined"),m_e(d)?d:null}function m_e(o){if(!o||!o.subscriptionOptions)return!1;const{subscriptionOptions:d}=o;return typeof o.createTime=="number"&&o.createTime>0&&typeof o.token=="string"&&o.token.length>0&&typeof d.auth=="string"&&d.auth.length>0&&typeof d.p256dh=="string"&&d.p256dh.length>0&&typeof d.endpoint=="string"&&d.endpoint.length>0&&typeof d.swScope=="string"&&d.swScope.length>0&&typeof d.vapidKey=="string"&&d.vapidKey.length>0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g_e="firebase-messaging-database",__e=1,g5="firebase-messaging-store";let WK=null;function Yse(){return WK||(WK=OG(g_e,__e,{upgrade:(o,d)=>{switch(d){case 0:o.createObjectStore(g5)}}})),WK}async function E_e(o){const d=Kse(o),g=await(await Yse()).transaction(g5).objectStore(g5).get(d);if(g)return g;{const T=await p_e(o.appConfig.senderId);if(T)return await KQ(o,T),T}}async function KQ(o,d){const h=Kse(o),T=(await Yse()).transaction(g5,"readwrite");return await T.objectStore(g5).put(d,h),await T.done,d}function Kse({appConfig:o}){return o.appId}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v_e={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."},pu=new KA("messaging","Messaging",v_e);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function S_e(o,d){const h=await JQ(o),g=qse(d),T={method:"POST",headers:h,body:JSON.stringify(g)};let I;try{I=await(await fetch(qQ(o.appConfig),T)).json()}catch(N){throw pu.create("token-subscribe-failed",{errorInfo:N==null?void 0:N.toString()})}if(I.error){const N=I.error.message;throw pu.create("token-subscribe-failed",{errorInfo:N})}if(!I.token)throw pu.create("token-subscribe-no-token");return I.token}async function y_e(o,d){const h=await JQ(o),g=qse(d.subscriptionOptions),T={method:"PATCH",headers:h,body:JSON.stringify(g)};let I;try{I=await(await fetch(`${qQ(o.appConfig)}/${d.token}`,T)).json()}catch(N){throw pu.create("token-update-failed",{errorInfo:N==null?void 0:N.toString()})}if(I.error){const N=I.error.message;throw pu.create("token-update-failed",{errorInfo:N})}if(!I.token)throw pu.create("token-update-no-token");return I.token}async function T_e(o,d){const g={method:"DELETE",headers:await JQ(o)};try{const I=await(await fetch(`${qQ(o.appConfig)}/${d}`,g)).json();if(I.error){const N=I.error.message;throw pu.create("token-unsubscribe-failed",{errorInfo:N})}}catch(T){throw pu.create("token-unsubscribe-failed",{errorInfo:T==null?void 0:T.toString()})}}function qQ({projectId:o}){return`${c_e}/projects/${o}/registrations`}async function JQ({appConfig:o,installations:d}){const h=await d.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":o.apiKey,"x-goog-firebase-installations-auth":`FIS ${h}`})}function qse({p256dh:o,auth:d,endpoint:h,vapidKey:g}){const T={web:{endpoint:h,auth:d,p256dh:o}};return g!==Hse&&(T.web.applicationPubKey=g),T}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b_e=7*24*60*60*1e3;async function C_e(o){const d=await R_e(o.swRegistration,o.vapidKey),h={vapidKey:o.vapidKey,swScope:o.swRegistration.scope,endpoint:d.endpoint,auth:oy(d.getKey("auth")),p256dh:oy(d.getKey("p256dh"))},g=await E_e(o.firebaseDependencies);if(g){if(I_e(g.subscriptionOptions,h))return Date.now()>=g.createTime+b_e?w_e(o,{token:g.token,createTime:Date.now(),subscriptionOptions:h}):g.token;try{await T_e(o.firebaseDependencies,g.token)}catch(T){console.warn(T)}return See(o.firebaseDependencies,h)}else return See(o.firebaseDependencies,h)}async function w_e(o,d){try{const h=await y_e(o.firebaseDependencies,d),g=Object.assign(Object.assign({},d),{token:h,createTime:Date.now()});return await KQ(o.firebaseDependencies,g),h}catch(h){throw h}}async function See(o,d){const g={token:await S_e(o,d),createTime:Date.now(),subscriptionOptions:d};return await KQ(o,g),g.token}async function R_e(o,d){const h=await o.pushManager.getSubscription();return h||o.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:f_e(d)})}function I_e(o,d){const h=d.vapidKey===o.vapidKey,g=d.endpoint===o.endpoint,T=d.auth===o.auth,I=d.p256dh===o.p256dh;return h&&g&&T&&I}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yee(o){const d={from:o.from,collapseKey:o.collapse_key,messageId:o.fcmMessageId};return A_e(d,o),O_e(d,o),N_e(d,o),d}function A_e(o,d){if(!d.notification)return;o.notification={};const h=d.notification.title;h&&(o.notification.title=h);const g=d.notification.body;g&&(o.notification.body=g);const T=d.notification.image;T&&(o.notification.image=T);const I=d.notification.icon;I&&(o.notification.icon=I)}function O_e(o,d){d.data&&(o.data=d.data)}function N_e(o,d){var h,g,T,I,N;if(!d.fcmOptions&&!(!((h=d.notification)===null||h===void 0)&&h.click_action))return;o.fcmOptions={};const M=(T=(g=d.fcmOptions)===null||g===void 0?void 0:g.link)!==null&&T!==void 0?T:(I=d.notification)===null||I===void 0?void 0:I.click_action;M&&(o.fcmOptions.link=M);const k=(N=d.fcmOptions)===null||N===void 0?void 0:N.analytics_label;k&&(o.fcmOptions.analyticsLabel=k)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L_e(o){return typeof o=="object"&&!!o&&Wse in o}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function D_e(o){if(!o||!o.options)throw YK("App Configuration Object");if(!o.name)throw YK("App Name");const d=["projectId","apiKey","appId","messagingSenderId"],{options:h}=o;for(const g of d)if(!h[g])throw YK(g);return{appName:o.name,projectId:h.projectId,apiKey:h.apiKey,appId:h.appId,senderId:h.messagingSenderId}}function YK(o){return pu.create("missing-app-config-values",{valueName:o})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P_e{constructor(d,h,g){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const T=D_e(d);this.firebaseDependencies={app:d,appConfig:T,installations:h,analyticsProvider:g}}_delete(){return Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function M_e(o){try{o.swRegistration=await navigator.serviceWorker.register(s_e,{scope:o_e}),o.swRegistration.update().catch(()=>{}),await k_e(o.swRegistration)}catch(d){throw pu.create("failed-service-worker-registration",{browserErrorMessage:d==null?void 0:d.message})}}async function k_e(o){return new Promise((d,h)=>{const g=setTimeout(()=>h(new Error(`Service worker not registered after ${_ee} ms`)),_ee),T=o.installing||o.waiting;o.active?(clearTimeout(g),d()):T?T.onstatechange=I=>{var N;((N=I.target)===null||N===void 0?void 0:N.state)==="activated"&&(T.onstatechange=null,clearTimeout(g),d())}:(clearTimeout(g),h(new Error("No incoming service worker found.")))})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function x_e(o,d){if(!d&&!o.swRegistration&&await M_e(o),!(!d&&o.swRegistration)){if(!(d instanceof ServiceWorkerRegistration))throw pu.create("invalid-sw-registration");o.swRegistration=d}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function U_e(o,d){d?o.vapidKey=d:o.vapidKey||(o.vapidKey=Hse)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Jse(o,d){if(!navigator)throw pu.create("only-available-in-window");if(Notification.permission==="default"&&await Notification.requestPermission(),Notification.permission!=="granted")throw pu.create("permission-blocked");return await U_e(o,d==null?void 0:d.vapidKey),await x_e(o,d==null?void 0:d.serviceWorkerRegistration),C_e(o)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function j_e(o,d,h){const g=V_e(d);(await o.firebaseDependencies.analyticsProvider.get()).logEvent(g,{message_id:h[Wse],message_name:h[l_e],message_time:h[d_e],message_device_time:Math.floor(Date.now()/1e3)})}function V_e(o){switch(o){case m5.NOTIFICATION_CLICKED:return"notification_open";case m5.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function B_e(o,d){const h=d.data;if(!h.isFirebaseMessaging)return;o.onMessageHandler&&h.messageType===m5.PUSH_RECEIVED&&(typeof o.onMessageHandler=="function"?o.onMessageHandler(yee(h)):o.onMessageHandler.next(yee(h)));const g=h.data;L_e(g)&&g[u_e]==="1"&&await j_e(o,h.messageType,g)}const Tee="@firebase/messaging",bee="0.12.21";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F_e=o=>{const d=new P_e(o.getProvider("app").getImmediate(),o.getProvider("installations-internal").getImmediate(),o.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",h=>B_e(d,h)),d},G_e=o=>{const d=o.getProvider("messaging").getImmediate();return{getToken:g=>Jse(d,g)}};function z_e(){gy(new _E("messaging",F_e,"PUBLIC")),gy(new _E("messaging-internal",G_e,"PRIVATE")),hE(Tee,bee),hE(Tee,bee,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function H_e(){try{await Gae()}catch{return!1}return typeof window<"u"&&Fae()&&ape()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function W_e(o=Kae()){return H_e().then(d=>{if(!d)throw pu.create("unsupported-browser")},d=>{throw pu.create("indexed-db-unsupported")}),U5(iC(o),"messaging").getImmediate()}async function Y_e(o,d){return o=iC(o),Jse(o,d)}z_e();const K_e={apiKey:"AIzaSyBnGxp5ErRizhT_frG7lHkanv3bkM8XYiE",authDomain:"loveai-e3be0.firebaseapp.com",projectId:"loveai-e3be0",storageBucket:"loveai-e3be0.appspot.com",messagingSenderId:"736402090832",appId:"1:736402090832:web:f1467eca01dbfa18bd1a55"},Xse=Yae(K_e),q_e=v0e(Xse),J_e=new cy,X_e="BEPvvywK-3Z1M4A6ORbppBJTNFcJBe3IiTa5HCxePM8yRKrHaGQhxU4_clTZ8TF1z9_WtRHigHWJx6EV_clE7N8",Q_e=W_e(Xse),Z_e=async()=>Notification.requestPermission().then(o=>{if(o==="granted")return Y_e(Q_e,{vapidKey:X_e});throw new Error("Notification permission not granted!")}).catch(o=>{throw console.error("Error getting FCM Token: ",o),o}),$_e="data:image/svg+xml,%3csvg%20width='512'%20height='360'%20viewBox='0%200%20512%20360'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M505.409%20169.423C485.796%20137.947%20385.989%200%20256%200C126.04%200%2026.206%20137.945%206.591%20169.423L0%20180L6.591%20190.577C26.204%20222.053%20126.011%20360%20256%20360C385.96%20360%20485.794%20222.056%20505.409%20190.577L512%20180L505.409%20169.423ZM256%20320C155.164%20320%2072.138%20214.246%2047.892%20179.984C72.093%20145.694%20154.906%2040%20256%2040C356.829%2040%20439.851%20145.739%20464.108%20180.016C439.907%20214.307%20357.094%20320%20256%20320ZM256%2080C200.859%2080%20156%20124.86%20156%20180C156%20235.14%20200.859%20280%20256%20280C311.141%20280%20356%20235.14%20356%20180C356%20124.86%20311.141%2080%20256%2080ZM256%20240C222.916%20240%20196%20213.084%20196%20180C196%20146.916%20222.916%20120%20256%20120C289.084%20120%20316%20146.916%20316%20180C316%20213.084%20289.084%20240%20256%20240Z'%20fill='url(%23paint0_linear_5474_143)'/%3e%3cdefs%3e%3clinearGradient%20id='paint0_linear_5474_143'%20x1='511'%20y1='169'%20x2='-4.5'%20y2='166'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20stop-color='%2300D4FF'/%3e%3cstop%20offset='1'%20stop-color='%2300A3E0'/%3e%3c/linearGradient%3e%3c/defs%3e%3c/svg%3e",eEe="data:image/svg+xml,%3csvg%20width='18'%20height='13'%20viewBox='0%200%2018%2013'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M10.9271%206.51821L11.909%205.55266C11.9804%205.81549%2012.0223%206.09028%2012.0223%206.37503C12.0223%208.13267%2010.5682%209.56253%208.78077%209.56253C8.49119%209.56253%208.21175%209.52136%207.94446%209.4511L8.92637%208.48556C9.44537%208.45089%209.93403%208.23249%2010.3019%207.87078C10.6697%207.50907%2010.8918%207.02856%2010.9271%206.51821ZM17.3568%206.11698C17.2903%205.99944%2016.3478%204.37554%2014.5056%202.99934L13.7194%203.77244C15.0627%204.7437%2015.9139%205.87645%2016.249%206.37583C15.6086%207.3346%2013.0967%2010.625%208.78077%2010.625C8.13354%2010.625%207.5317%2010.5436%206.96538%2010.4137L6.07761%2011.2867C6.8938%2011.5328%207.79089%2011.6875%208.78077%2011.6875C14.4363%2011.6875%2017.2402%206.83935%2017.3568%206.63309C17.4014%206.55416%2017.4248%206.46534%2017.4248%206.37503C17.4248%206.28472%2017.4014%206.1959%2017.3568%206.11698ZM15.1055%200.906877L3.21993%2012.5944C3.11445%2012.6981%202.97614%2012.75%202.83797%2012.75C2.6998%2012.75%202.5615%2012.6981%202.45601%2012.5944C2.40582%2012.5451%202.36599%2012.4865%202.33882%2012.4221C2.31165%2012.3576%202.29767%2012.2885%202.29767%2012.2188C2.29767%2012.149%202.31165%2012.0799%202.33882%2012.0155C2.36599%2011.951%202.40582%2011.8925%202.45601%2011.8432L3.96819%2010.3562C1.52354%208.90498%200.281356%206.76869%200.204775%206.63309C0.160142%206.55414%200.136719%206.4653%200.136719%206.37497C0.136719%206.28464%200.160142%206.1958%200.204775%206.11685C0.321335%205.91072%203.12525%201.06253%208.78077%201.06253C10.2431%201.06253%2011.5097%201.39058%2012.5925%201.87561L14.3416%200.155689C14.5527%20-0.0518965%2014.8946%20-0.0518965%2015.1055%200.155689C15.3165%200.363275%2015.3166%200.699424%2015.1055%200.906877ZM4.77384%209.56399L6.14163%208.219C5.76385%207.69785%205.53924%207.06234%205.53924%206.37503C5.53924%204.61739%206.99334%203.18753%208.78077%203.18753C9.47972%203.18753%2010.126%203.4084%2010.656%203.77974L11.762%202.69214C10.8882%202.34803%209.89518%202.12503%208.78077%202.12503C4.46481%202.12503%201.9529%205.41546%201.3127%206.37424C1.71924%206.98013%202.88781%208.51385%204.77384%209.56399ZM6.92594%207.44763L9.87154%204.55112C9.55023%204.36452%209.18029%204.25003%208.78077%204.25003C7.58924%204.25003%206.61975%205.20336%206.61975%206.37503C6.61975%206.76789%206.73618%207.13167%206.92594%207.44763Z'%20fill='url(%23paint0_linear_4796_3725)'/%3e%3cdefs%3e%3clinearGradient%20id='paint0_linear_4796_3725'%20x1='0.104503'%20y1='1.275'%20x2='16.5613'%20y2='0.148898'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20offset='0.145353'%20stop-color='%2300D4FF'/%3e%3cstop%20offset='1'%20stop-color='%2300A3E0'/%3e%3c/linearGradient%3e%3c/defs%3e%3c/svg%3e",tEe="data:image/svg+xml,%3csvg%20width='25'%20height='24'%20viewBox='0%200%2025%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M24.127%2012C24.127%205.37258%2018.7544%200%2012.127%200C5.49954%200%200.126953%205.37258%200.126953%2012C0.126953%2018.6274%205.49954%2024%2012.127%2024C18.7544%2024%2024.127%2018.6274%2024.127%2012Z'%20fill='white'/%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M21.1271%2012.2088C21.1271%2011.5571%2021.0686%2010.9304%2020.96%2010.3287H12.3032V13.8842H17.2499C17.0369%2015.0331%2016.3893%2016.0066%2015.4158%2016.6584V18.9646H18.3863C20.1244%2017.3644%2021.1271%2015.0081%2021.1271%2012.2088Z'%20fill='%234285F4'/%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M12.3032%2021.1915C14.785%2021.1915%2016.8656%2020.3685%2018.3864%2018.9647L15.4158%2016.6584C14.5928%2017.2099%2013.5399%2017.5358%2012.3032%2017.5358C9.90926%2017.5358%207.88295%2015.9189%207.16016%2013.7464H4.08936V16.1278C5.60178%2019.1318%208.71019%2021.1915%2012.3032%2021.1915Z'%20fill='%2334A853'/%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M7.16027%2013.7464C6.97644%2013.1949%206.87199%2012.6058%206.87199%2012C6.87199%2011.3942%206.97644%2010.8051%207.16027%2010.2536V7.87213H4.08946C3.46694%209.11299%203.11182%2010.5168%203.11182%2012C3.11182%2013.4831%203.46694%2014.8869%204.08946%2016.1278L7.16027%2013.7464Z'%20fill='%23FBBC05'/%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M12.3032%206.46419C13.6527%206.46419%2014.8643%206.92795%2015.8169%207.83875L18.4532%205.20245C16.8614%203.71927%2014.7808%202.80847%2012.3032%202.80847C8.71019%202.80847%205.60178%204.86821%204.08936%207.87217L7.16016%2010.2536C7.88295%208.08107%209.90926%206.46419%2012.3032%206.46419Z'%20fill='%23EA4335'/%3e%3c/svg%3e",nEe="data:image/svg+xml,%3csvg%20width='25'%20height='24'%20viewBox='0%200%2025%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M0.556641%2012C0.556641%2018.6274%205.92922%2024%2012.5566%2024C19.1841%2024%2024.5566%2018.6274%2024.5566%2012C24.5566%205.37258%2019.1841%200%2012.5566%200C5.92922%200%200.556641%205.37258%200.556641%2012Z'%20fill='%231877F2'/%3e%3cpath%20d='M18.5566%2012C18.5566%208.7%2015.8566%206%2012.5566%206C9.25664%206%206.55664%208.7%206.55664%2012C6.55664%2015%208.73164%2017.475%2011.5816%2017.925V13.725H10.0816V12H11.5816V10.65C11.5816%209.15%2012.4816%208.325%2013.8316%208.325C14.5066%208.325%2015.1816%208.475%2015.1816%208.475V9.975H14.4316C13.6816%209.975%2013.4566%2010.425%2013.4566%2010.875V12H15.1066L14.8066%2013.725H13.3816V18C16.3816%2017.55%2018.5566%2015%2018.5566%2012Z'%20fill='white'/%3e%3c/svg%3e";/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rEe=o=>o.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),iEe=o=>o.replace(/^([A-Z])|[\s-_]+(\w)/g,(d,h,g)=>g?g.toUpperCase():h.toLowerCase()),Cee=o=>{const d=iEe(o);return d.charAt(0).toUpperCase()+d.slice(1)},Qse=(...o)=>o.filter((d,h,g)=>!!d&&d.trim()!==""&&g.indexOf(d)===h).join(" ").trim(),aEe=o=>{for(const d in o)if(d.startsWith("aria-")||d==="role"||d==="title")return!0};/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var sEe={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oEe=q.forwardRef(({color:o="currentColor",size:d=24,strokeWidth:h=2,absoluteStrokeWidth:g,className:T="",children:I,iconNode:N,...M},k)=>q.createElement("svg",{ref:k,...sEe,width:d,height:d,stroke:o,strokeWidth:g?Number(h)*24/Number(d):h,className:Qse("lucide",T),...!I&&!aEe(M)&&{"aria-hidden":"true"},...M},[...N.map(([x,V])=>q.createElement(x,V)),...Array.isArray(I)?I:[I]]));/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qr=(o,d)=>{const h=q.forwardRef(({className:g,...T},I)=>q.createElement(oEe,{ref:I,iconNode:d,className:Qse(`lucide-${rEe(Cee(o))}`,`lucide-${o}`,g),...T}));return h.displayName=Cee(o),h};/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cEe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]],lEe=Qr("ban",cEe);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dEe=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],uEe=Qr("bell",dEe);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fEe=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],hEe=Qr("chevron-down",fEe);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pEe=[["path",{d:"M12 12H3a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h13",key:"1gdiyg"}],["path",{d:"M18 8c0-2.5-2-2.5-2-5",key:"1il607"}],["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M21 12a1 1 0 0 1 1 1v2a1 1 0 0 1-.5.866",key:"166zjj"}],["path",{d:"M22 8c0-2.5-2-2.5-2-5",key:"1gah44"}],["path",{d:"M7 12v4",key:"jqww69"}]],mEe=Qr("cigarette-off",pEe);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gEe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]],_Ee=Qr("circle-plus",gEe);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EEe=[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]],vEe=Qr("crown",EEe);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SEe=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],yEe=Qr("database",SEe);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TEe=[["path",{d:"M15.4 15.63a7.875 6 135 1 1 6.23-6.23 4.5 3.43 135 0 0-6.23 6.23",key:"1dtqwm"}],["path",{d:"m8.29 12.71-2.6 2.6a2.5 2.5 0 1 0-1.65 4.65A2.5 2.5 0 1 0 8.7 18.3l2.59-2.59",key:"1oq1fw"}]],bEe=Qr("drumstick",TEe);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CEe=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]],wEe=Qr("ellipsis-vertical",CEe);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const REe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],IEe=Qr("globe",REe);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AEe=[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}],["path",{d:"M12 5 9.04 7.96a2.17 2.17 0 0 0 0 3.08c.82.82 2.13.85 3 .07l2.07-1.9a2.82 2.82 0 0 1 3.79 0l2.96 2.66",key:"4oyue0"}],["path",{d:"m18 15-2-2",key:"60u0ii"}],["path",{d:"m15 18-2-2",key:"6p76be"}]],OEe=Qr("heart-handshake",AEe);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NEe=[["path",{d:"M13.5 19.5 12 21l-7-7c-1.5-1.45-3-3.2-3-5.5A5.5 5.5 0 0 1 7.5 3c1.76 0 3 .5 4.5 2 1.5-1.5 2.74-2 4.5-2a5.5 5.5 0 0 1 5.402 6.5",key:"vd0vy5"}],["path",{d:"M15 15h6",key:"1u4692"}],["path",{d:"M18 12v6",key:"1houu1"}]],LEe=Qr("heart-plus",NEe);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DEe=[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]],PEe=Qr("heart",DEe);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MEe=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]],kEe=Qr("house",MEe);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xEe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],Zse=Qr("info",xEe);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UEe=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],jEe=Qr("lock",UEe);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VEe=[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]],BEe=Qr("log-out",VEe);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FEe=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],GEe=Qr("mail",FEe);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zEe=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],wee=Qr("map-pin",zEe);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HEe=[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]],WEe=Qr("message-circle",HEe);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YEe=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]],KEe=Qr("message-square",YEe);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qEe=[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]],JEe=Qr("mic",qEe);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XEe=[["path",{d:"M13.234 20.252 21 12.3",key:"1cbrk9"}],["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 0 2.828 2 2 0 0 0 2.828 0l8.414-8.586a4 4 0 0 0 0-5.656 4 4 0 0 0-5.656 0l-8.415 8.585a6 6 0 1 0 8.486 8.486",key:"1pkts6"}]],QEe=Qr("paperclip",XEe);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZEe=[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}],["path",{d:"M14.05 2a9 9 0 0 1 8 7.94",key:"vmijpz"}],["path",{d:"M14.05 6A5 5 0 0 1 18 10",key:"13nbpp"}]],Ree=Qr("phone-call",ZEe);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $Ee=[["line",{x1:"22",x2:"16",y1:"2",y2:"8",key:"1xzwqn"}],["line",{x1:"16",x2:"22",y1:"2",y2:"8",key:"13zxdn"}],["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]],eve=Qr("phone-missed",$Ee);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tve=[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]],nve=Qr("phone",tve);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rve=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],ive=Qr("plus",rve);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ave=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],sve=Qr("search",ave);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ove=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],cve=Qr("send",ove);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lve=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m4.243 5.21 14.39 12.472",key:"1c9a7c"}]],dve=Qr("shield-ban",lve);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uve=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],fve=Qr("shield",uve);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hve=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],pve=Qr("square-pen",hve);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mve=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],gve=Qr("star",mve);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _ve=[["path",{d:"M3.5 21 14 3",key:"1szst5"}],["path",{d:"M20.5 21 10 3",key:"1310c3"}],["path",{d:"M15.5 21 12 15l-3.5 6",key:"1ddtfw"}],["path",{d:"M2 21h20",key:"1nyx9w"}]],Iee=Qr("tent",_ve);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eve=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],vve=Qr("trash-2",Eve);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sve=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],yve=Qr("triangle-alert",Sve);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tve=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],OA=Qr("user",Tve);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bve=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],Cve=Qr("users",bve);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wve=[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]],Rve=Qr("video",wve);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ive=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}]],Ave=Qr("volume-1",Ive);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ove=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],YX=Qr("x",Ove);function Aee(){return j.jsx(yE,{titleText:"Welcome Back!",text:"Ready to pick up where you left off?",children:j.jsx(Nve,{})})}function Nve(){const o=xl(),[d,h]=q.useState(""),[g,T]=q.useState(""),[I,N]=q.useState(""),[M,k]=q.useState(!1),[x,V]=q.useState(!1),[K,Q]=q.useState(""),[ie,X]=q.useState([]),[Z,ae]=q.useState("+91"),[le,fe]=q.useState("https://flagcdn.com/w40/in.png"),[ue,de]=q.useState(null);q.useEffect(()=>{const Te=async()=>{try{const he=(await Ur.get("https://restcountries.com/v3.1/all?fields=name,flags,idd,cca2")).data.map(ke=>{var ze,$e,et,Oe,qe;const We=((ze=ke.idd)==null?void 0:ze.root)+(((et=($e=ke.idd)==null?void 0:$e.suffixes)==null?void 0:et[0])||"");return We?{name:ke.name.common,code:We,flag:((Oe=ke.flags)==null?void 0:Oe.png)||"",iso:(qe=ke.cca2)==null?void 0:qe.toLowerCase()}:null}).filter(Boolean).sort((ke,We)=>ke.name.localeCompare(We.name));X(he)}catch(je){console.error("Failed to fetch country data:",je)}},Le=async()=>{try{const je=await Z_e();de(je),console.log("firebase token",je)}catch(je){console.error("Error getting FCM Token :",je)}};Te(),Le()},[]);const te=async Te=>{var je,he;if(Te.preventDefault(),Q(""),!I.trim()){Q("Please enter your password.");return}const Le={password:I,fcm:ue};if(g.trim())Le.country_code=Z,Le.number=g.trim();else if(d.trim()){const ke=d.trim();/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(ke)?Le.email=ke:Le.username=ke}else{Q("Please enter either mobile number or email/username.");return}try{V(!0);const We=(await Ur.post("/login",Le)).data;localStorage.setItem("authToken",We.token),localStorage.setItem("user_Data",JSON.stringify(We));const $e=["dob","email","gender","name","username"].some(et=>!We[et]);o($e?"/profile/data":"/dashboard/home")}catch(ke){console.error(ke),Q(((he=(je=ke.response)==null?void 0:je.data)==null?void 0:he.message)||"Login failed. Please try again.")}finally{V(!1)}},ye=async()=>{try{const Le=(await Age(q_e,J_e)).user;console.log("Google user:",Le),localStorage.setItem("authToken",await Le.getIdToken()),localStorage.setItem("user_Data",JSON.stringify(Le)),o("/dashboard/home")}catch(Te){console.error("Google login error:",Te),Q("Google sign-in failed. Please try again.")}};return j.jsxs("div",{className:"max-w-md mx-auto mt-10 p-4 rounded-xl",children:[j.jsx("h2",{className:"text-3xl font-bold text-center mb-6 text-gray-800",children:"Login"}),j.jsx("p",{className:"mb-4 text-center",style:{color:"#111111",fontWeight:"400",fontSize:"14px",fontFamily:"Rubik,sans-serif"},children:"Email or Phone Number"}),j.jsxs("form",{onSubmit:te,children:[j.jsxs("div",{className:"mb-4",children:[j.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center gap-1",children:[j.jsx(nve,{color:"#00A3E0",size:15}),"Mobile Number"]}),j.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg focus-within:ring-2 focus-within:ring-blue-400 overflow-hidden",children:[j.jsx("select",{value:Z,onChange:Te=>{const Le=ie.find(je=>je.code===Te.target.value);ae(Le.code),fe(Le.flag)},className:"bg-white border-r px-2 py-2 text-sm outline-none text-gray-700 max-w-[80px]",children:ie.map(Te=>j.jsx("option",{value:Te.code,children:Z===Te.code?`${Te.code}`:`${Te.name} (${Te.code})`},Te.code))}),j.jsx("input",{type:"tel",value:g,onChange:Te=>T(Te.target.value),placeholder:"Enter your Mobile Number",className:"flex-1 px-3 py-2 outline-none text-sm"})]})]}),j.jsxs("div",{className:"flex items-center my-4",children:[j.jsx("div",{className:"flex-grow border-t border-gray-300"}),j.jsx("span",{className:"px-2 text-gray-400 text-sm",children:"Or"}),j.jsx("div",{className:"flex-grow border-t border-gray-300"})]}),j.jsxs("div",{className:"mb-4",children:[j.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center gap-1",children:[j.jsx(GEe,{color:"#00A3E0",size:15}),"Email"]}),j.jsx("input",{type:"text",value:d,onChange:Te=>h(Te.target.value),placeholder:"Enter your email address",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-[#00D4FF] transition duration-200"})]}),j.jsxs("div",{className:"mb-4",children:[j.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),j.jsxs("div",{className:"relative",children:[j.jsx("input",{type:M?"text":"password",value:I,onChange:Te=>N(Te.target.value),placeholder:"Enter your password",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-[#00D4FF] transition duration-200 pr-10"}),j.jsx("button",{type:"button",onClick:()=>k(!M),className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:M?j.jsx("img",{src:$_e,alt:"showPassword",className:"w-5 h-5"}):j.jsx("img",{src:eEe,alt:"HidePassword",className:"w-5 h-5"})})]})]}),j.jsxs("div",{className:"flex items-center my-4",children:[j.jsx("div",{className:"flex-grow border-t border-gray-300"}),j.jsx("span",{className:"px-2 text-gray-400 text-sm",children:"Or"}),j.jsx("div",{className:"flex-grow border-t border-gray-300"})]}),j.jsxs("div",{className:"flex justify-center gap-6 mb-4",children:[j.jsxs("button",{type:"button",className:"w-32 flex items-center border rounded-lg px-4 py-2 text-sm text-gray-700  transition",onClick:ye,style:{border:"1px solid #98939433"},children:[j.jsx("img",{src:tEe,alt:"Google",className:"w-5 h-5 mr-2"}),"Google"]}),j.jsxs("button",{type:"button",className:"w-32 flex items-center border rounded-lg px-4 py-2 text-sm text-gray-700 transition",onClick:()=>{console.log("Facebook Login")},style:{border:"1px solid #98939433"},children:[j.jsx("img",{src:nEe,alt:"Facebook",className:"w-5 h-5 mr-2 rounded-full"}),"Facebook"]})]}),K&&j.jsx("p",{className:"text-red-600 text-sm mb-4 text-center",children:K}),j.jsx("button",{type:"submit",disabled:x,className:`w-full py-2 text-white font-semibold rounded-lg bg-gradient-to-r from-[#00D4FF] to-[#00A3E0] hover:opacity-90 transition ${x?"opacity-50 cursor-not-allowed":""}`,children:x?"Logging in":"Login"})]}),j.jsxs("div",{className:"text-center text-sm mt-4",children:["Dont have an account?"," ",j.jsx("span",{className:"text-[#00A3E0] cursor-pointer",onClick:()=>o("/signup"),children:"Sign Up"})]}),j.jsx("div",{className:"text-[#00A3E0] text-center text-sm cursor-pointer mt-1",onClick:()=>o("/forgot-password"),children:"Forgot your password? Reset it here."})]})}function Lve(){const o=q.useRef();return j.jsx(yE,{titleText:"Can You elaborate on your identity?",text:"It will Display on your Profile and you will not able to change it later",hasButton:!0,onButtonClick:()=>{var d;return(d=o.current)==null?void 0:d.requestSubmit()},children:j.jsx(Dve,{formRef:o})})}function Dve({formRef:o}){const d=xl(),[h,g]=q.useState(""),[T,I]=q.useState(""),[N,M]=q.useState(""),[k,x]=q.useState(""),[V,K]=q.useState(""),[Q,ie]=q.useState(!1),[X,Z]=q.useState(""),[ae,le]=q.useState(!1),fe=async de=>{var ye,Te;if(de.preventDefault(),Z(""),!h||!T||!N||!k||!V){Z("Please fill out all required fields.");return}const te=localStorage.getItem("authToken");try{ie(!0),await Ur.post("/profile",{name:h,username:T,email:N,dob:k,gender:V},{headers:{token:te}}),Z(" Profile saved!"),d("/profile/general-info")}catch(Le){console.error(Le),Z(((Te=(ye=Le.response)==null?void 0:ye.data)==null?void 0:Te.message)||" Something went wrong.")}finally{ie(!1)}};q.useEffect(()=>{const de=localStorage.getItem("userEmail");de&&(M(de),le(!0))},[]);const ue=de=>{const te=de.target.value;M(te),localStorage.setItem("userEmail",te)};return j.jsxs("form",{className:"space-y-5 w-full text-sm",onSubmit:fe,onKeyDown:de=>{var te;de.key==="Enter"&&(de.preventDefault(),(te=o.current)==null||te.requestSubmit())},ref:o,children:[j.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"Fill Your Profile"}),j.jsxs("div",{className:"flex flex-col",children:[j.jsxs("label",{className:"mb-1 font-medium text-gray-600",children:["Full Name",j.jsx("span",{className:"text-red-500",children:"*"})]}),j.jsx("input",{type:"text",value:h,onChange:de=>g(de.target.value),placeholder:"As per your ID",className:"px-3 py-2 rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-400 text-sm shadow-sm"})]}),j.jsxs("div",{className:"flex flex-col",children:[j.jsxs("label",{className:"mb-1 font-medium text-gray-600",children:["Username",j.jsx("span",{className:"text-red-500",children:"*"})]}),j.jsx("input",{type:"text",value:T,onChange:de=>I(de.target.value),placeholder:"Create your unique username",className:"px-3 py-2 rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-400 text-sm shadow-sm"})]}),j.jsxs("div",{className:"flex flex-col",children:[j.jsxs("label",{className:"mb-1 font-medium text-gray-600",children:["Email",j.jsx("span",{className:"text-red-500",children:"*"})]}),j.jsx("input",{type:"email",value:N,onChange:ue,placeholder:"Enter your email",disabled:ae,className:"px-3 py-2 rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-400 text-sm shadow-sm"})]}),j.jsxs("div",{className:"flex flex-col",children:[j.jsxs("label",{className:"mb-1 font-medium text-gray-600",children:["Date of Birth",j.jsx("span",{className:"text-red-500",children:"*"})]}),j.jsx("input",{type:"date",value:k,onChange:de=>x(de.target.value),className:"px-3 py-2 rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-400 text-sm shadow-sm"})]}),j.jsxs("div",{className:"flex flex-col",children:[j.jsxs("label",{className:"mb-2 font-medium text-gray-600",children:["Gender",j.jsx("span",{className:"text-red-500",children:"*"})]}),j.jsx("div",{className:"flex items-center gap-5",children:["Female","Male","Prefer not to say"].map(de=>j.jsxs("label",{className:"flex items-center space-x-2 text-gray-700",children:[j.jsx("input",{type:"radio",name:"gender",value:de,checked:V===de,onChange:()=>K(de),className:"accent-blue-500"}),j.jsx("span",{children:de})]},de))})]}),j.jsx("div",{className:"min-h-[20px] mt-4 text-center text-sm transition-all duration-200",children:j.jsx("p",{className:`transition-opacity duration-200 ${X?X.startsWith("")?"text-green-600 opacity-100":"text-red-600 opacity-100":"opacity-0"}`,children:X||""})})]})}function Pve(){const o=q.useRef();return j.jsx(yE,{titleText:"Can You elaborate on your identity?",text:"It will Display on your Profile and you will not able to change it later",hasButton:!0,buttonText:"NEXT",onButtonClick:()=>{var d;return(d=o.current)==null?void 0:d.requestSubmit()},children:j.jsx(Mve,{formRef:o})})}function Mve({formRef:o}){const d=xl(),[h,g]=q.useState([]),[T,I]=q.useState([]),[N,M]=q.useState({education_id:"",profession_id:"",language_id:"",status_id:"",religion_id:"",city_id:"",match_intent:"LoveCommitment"}),[k,x]=q.useState(!1),[V,K]=q.useState("");q.useEffect(()=>{Ur.get("/dropdowns").then(Z=>{g(Z.data),localStorage.setItem("dropdowns",JSON.stringify(Z.data))}).catch(Z=>console.error("Dropdown fetch error:",Z)),Ur.get("/locations").then(Z=>{I(Z.data)}).catch(Z=>console.error("Location fetch error:",Z))},[]);const Q=Z=>{const ae=h.find(le=>le.name.toLowerCase().includes(Z));return(ae==null?void 0:ae.sub_categories)||[]},ie=Z=>{M(ae=>({...ae,[Z.target.name]:Z.target.value}))},X=async Z=>{var ae,le;Z.preventDefault(),K("");for(let fe of Object.keys(N))if(!N[fe]){K("Please select every option before continuing.");return}x(!0);try{localStorage.setItem("generalInformation",JSON.stringify({...N})),d("/profile/lifestyle")}catch(fe){console.error(fe),K(((le=(ae=fe.response)==null?void 0:ae.data)==null?void 0:le.message)||" Something went wrong.")}finally{x(!1)}};return j.jsxs("form",{className:"space-y-5 w-full text-sm",onSubmit:X,onKeyDown:Z=>{var ae;Z.key==="Enter"&&(Z.preventDefault(),(ae=o.current)==null||ae.requestSubmit())},ref:o,children:[j.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"General Information"}),[{label:"Education",name:"education_id",key:"education"},{label:"Profession",name:"profession_id",key:"profession"},{label:"Language",name:"language_id",key:"language"},{label:"Status",name:"status_id",key:"status"},{label:"Religion",name:"religion_id",key:"religion"},{label:"Location",name:"city_id",key:"city"}].map(({label:Z,name:ae,key:le})=>j.jsxs("div",{className:"flex flex-col",children:[j.jsxs("label",{className:"mb-1 font-medium text-gray-600",children:[Z,j.jsx("span",{className:"text-red-500",children:"*"})]}),j.jsxs("select",{name:ae,value:N[ae],onChange:ie,className:"px-3 py-2 rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-400 text-sm shadow-sm",children:[j.jsxs("option",{value:"",children:["Select Your ",Z]}),le==="city"?T.map(fe=>j.jsx("option",{value:fe.id,children:fe.e_name},fe.id)):Q(le).map(fe=>j.jsx("option",{value:fe.id,children:fe.e_name},fe.id))]})]},ae)),j.jsx("div",{className:"min-h-[24px] mt-2 text-center text-sm transition-all duration-200 ease-in-out",children:j.jsx("p",{className:`transition-opacity duration-200 ${V?V.startsWith("")?"text-red-600 opacity-100":"text-green-600 opacity-100":"opacity-0"}`,children:V||""})})]})}function kve(){const o=q.useRef();return j.jsx(yE,{titleText:"Can You elaborate on your identity?",text:"It will Display on your Profile and you will not able to change it later",hasButton:!0,buttonText:"NEXT",onButtonClick:()=>{var d;return(d=o.current)==null?void 0:d.requestSubmit()},children:j.jsx(xve,{formRef:o})})}function xve({formRef:o}){const[d,h]=q.useState([]),[g,T]=q.useState({drinking_id:"",smoking_id:"",eating_id:"",about:""}),I=xl();q.useEffect(()=>{const x=localStorage.getItem("dropdowns");x?h(JSON.parse(x)):Ur.get("/dropdowns").then(V=>{h(V.data),localStorage.setItem("dropdowns",JSON.stringify(V.data))}).catch(V=>console.error("Dropdown fetch error:",V))},[]);const N=x=>{var V;return((V=d.find(K=>{var Q;return((Q=K.name)==null?void 0:Q.toLowerCase())===x.toLowerCase()}))==null?void 0:V.sub_categories)||[]},M=x=>{const{name:V,value:K}=x.target;T(Q=>({...Q,[V]:K}))},k=async x=>{x.preventDefault();try{await Ur.post("/personalise",{...JSON.parse(localStorage.getItem("generalInformation")),...g},{headers:{token:localStorage.getItem("authToken")}}),I("/profile/interests")}catch(V){console.error(V)}finally{}};return j.jsxs("form",{className:"space-y-5 w-full text-sm",onSubmit:k,onKeyDown:x=>{var V;x.key==="Enter"&&(x.preventDefault(),(V=o.current)==null||V.requestSubmit())},ref:o,children:[j.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"Lifestyle Information"}),j.jsxs("div",{className:"flex flex-col",children:[j.jsxs("label",{className:"mb-1 font-medium text-gray-600",children:["Drinking",j.jsx("span",{className:"text-red-500",children:"*"})]}),j.jsxs("select",{name:"drinking_id",value:g.drinking_id,onChange:M,className:"px-3 py-2 rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-400 text-sm shadow-sm",children:[j.jsx("option",{value:"",children:"Select an option"}),N("drinking").map(x=>j.jsx("option",{value:x.id,children:x.e_name},x.id))]})]}),j.jsxs("div",{className:"flex flex-col",children:[j.jsxs("label",{className:"mb-1 font-medium text-gray-600",children:["Smoking",j.jsx("span",{className:"text-red-500",children:"*"})]}),j.jsxs("select",{name:"smoking_id",value:g.smoking_id,onChange:M,className:"px-3 py-2 rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-400 text-sm shadow-sm",children:[j.jsx("option",{value:"",children:"Select an option"}),N("smoking").map(x=>j.jsx("option",{value:x.id,children:x.e_name},x.id))]})]}),j.jsxs("div",{className:"flex flex-col",children:[j.jsxs("label",{className:"mb-1 font-medium text-gray-600",children:["Eating",j.jsx("span",{className:"text-red-500",children:"*"})]}),j.jsxs("select",{name:"eating_id",value:g.eating_id,onChange:M,className:"px-3 py-2 rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-400 text-sm shadow-sm",children:[j.jsx("option",{value:"",children:"Select an option"}),N("eating").map(x=>j.jsx("option",{value:x.id,children:x.e_name},x.id))]})]}),j.jsxs("div",{className:"flex flex-col",children:[j.jsxs("label",{className:"mb-1 font-medium text-gray-600",children:["About",j.jsx("span",{className:"text-red-500",children:"*"})]}),j.jsx("textarea",{name:"about",value:g.about,onChange:M,maxLength:300,placeholder:"Write a brief description about yourself (max 300 characters)",className:"px-3 py-2 rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-400 text-sm shadow-sm resize-none h-28"})]})]})}function Uve(){const o=q.useRef();return j.jsx(yE,{titleText:"Choose your interests to match with someone who shares similar passions",text:"It will Display on your Profile and you will not able to change it later",hasButton:!0,onButtonClick:()=>{var d;return(d=o.current)==null?void 0:d.requestSubmit()},children:j.jsx(Vve,{formRef:o})})}const jve=5;function Vve({formRef:o}){const[d,h]=q.useState([]),[g,T]=q.useState([{id:"0de56c51-1d78-4315-be3a-7a0a44e5b58b",e_name:"Wellness",h_name:null,url:"https://s3.ap-south-1.amazonaws.com/loveai-media/interests/icons/224db579-2d79-49b0-9f0d-8cfcee674eb1.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIARHWSHFT7V65SDPET%2F20250516%2Fap-south-1%2Fs3%2Faws4_request&X-Amz-Date=20250516T151639Z&X-Amz-Expires=3600&X-Amz-SignedHeaders=host&X-Amz-Signature=310a5b49d475241af19449ab5bb4b928f5115c3a6a464422b4226dec57c7ae42",category:[{id:"5431dbd9-fd09-4a94-b04d-fd6a799fef70",e_name:"Weights",h_name:null,url:"https://s3.ap-south-1.amazonaws.com/loveai-media/interests/icons/3cd294bd-cfbc-46b1-8637-beef229c9a54.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIARHWSHFT7V65SDPET%2F20250516%2Fap-south-1%2Fs3%2Faws4_request&X-Amz-Date=20250516T151639Z&X-Amz-Expires=3600&X-Amz-SignedHeaders=host&X-Amz-Signature=988b2d64dfb5b28cbdaed9cd5e5800e486da5480f266807624384a46896c91ad"},{id:"87cb5603-2790-4d4c-8559-6aea1d7744b6",e_name:"Outdoors",h_name:null,url:"https://s3.ap-south-1.amazonaws.com/loveai-media/interests/icons/f4fe295d-d655-4244-a410-03a1dfc83ccd.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIARHWSHFT7V65SDPET%2F20250516%2Fap-south-1%2Fs3%2Faws4_request&X-Amz-Date=20250516T151640Z&X-Amz-Expires=3600&X-Amz-SignedHeaders=host&X-Amz-Signature=6bf55717ee22884c323a4447cc2668ac832286736e6bd0e15d4f30fdbacb2ada"},{id:"99f453bd-5917-43f2-bfad-8238b317bcba",e_name:"Fitness",h_name:null,url:"https://s3.ap-south-1.amazonaws.com/loveai-media/interests/icons/e10667fe-1479-4902-b78b-1d32ddc2e448.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIARHWSHFT7V65SDPET%2F20250516%2Fap-south-1%2Fs3%2Faws4_request&X-Amz-Date=20250516T151640Z&X-Amz-Expires=3600&X-Amz-SignedHeaders=host&X-Amz-Signature=61916bceba6f5d48e864cb91fd335e0a22fa967573c840b94845b0808cda0e96"},{id:"e2abffd6-c94a-4dab-ad61-16182e1e282f",e_name:"Meditation",h_name:null,url:"https://s3.ap-south-1.amazonaws.com/loveai-media/interests/icons/5a5c8001-8bdb-4ce0-877a-26f11488e262.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIARHWSHFT7V65SDPET%2F20250516%2Fap-south-1%2Fs3%2Faws4_request&X-Amz-Date=20250516T151640Z&X-Amz-Expires=3600&X-Amz-SignedHeaders=host&X-Amz-Signature=5d607f3ec21b71f747a5d0c1149a878a2bf84bcc3e5a586022a81d757bb0b9fa"}]},{id:"16e3a19e-3230-479a-b633-edc5186e5a06",e_name:"Sports",h_name:null,url:"https://s3.ap-south-1.amazonaws.com/loveai-media/interests/icons/941eba31-c849-400a-9ae1-a3e6aea1ac99.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIARHWSHFT7V65SDPET%2F20250516%2Fap-south-1%2Fs3%2Faws4_request&X-Amz-Date=20250516T151640Z&X-Amz-Expires=3600&X-Amz-SignedHeaders=host&X-Amz-Signature=8a147a68f5f1fd3eb9a15bf4886b5d1509518a6b3c47fc1f970955683296229b",category:[{id:"1314bef1-73bd-409c-9cd5-a58ea9a530f4",e_name:"Swimming",h_name:null,url:"https://s3.ap-south-1.amazonaws.com/loveai-media/interests/icons/7107d253-af32-4565-a7d9-7e4e8112d000.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIARHWSHFT7V65SDPET%2F20250516%2Fap-south-1%2Fs3%2Faws4_request&X-Amz-Date=20250516T151640Z&X-Amz-Expires=3600&X-Amz-SignedHeaders=host&X-Amz-Signature=b5bae29bcd2e9d2753287739ac653389d34c865257d607d6a805d604264185a7"},{id:"bab34f44-6567-497a-9098-2787107482c4",e_name:"Football",h_name:null,url:"https://s3.ap-south-1.amazonaws.com/loveai-media/interests/icons/ec7636d2-101a-4290-86df-c7370eed4fb0.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIARHWSHFT7V65SDPET%2F20250516%2Fap-south-1%2Fs3%2Faws4_request&X-Amz-Date=20250516T151640Z&X-Amz-Expires=3600&X-Amz-SignedHeaders=host&X-Amz-Signature=049df37b3b954191da24a2b9617b449801440f6083fc1270f4064eaec29ea7ad"},{id:"e91ad08f-8c6a-47d7-84d0-d7ee65b4c71a",e_name:"Cricket",h_name:null,url:"https://s3.ap-south-1.amazonaws.com/loveai-media/interests/icons/79f25e6c-d8d6-4641-8ea1-a4bf28427ce9.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIARHWSHFT7V65SDPET%2F20250516%2Fap-south-1%2Fs3%2Faws4_request&X-Amz-Date=20250516T151640Z&X-Amz-Expires=3600&X-Amz-SignedHeaders=host&X-Amz-Signature=33293f51274f7d49394e8e9f9ba6f1cb63047fb93bff4ced63d8e593e023c501"}]},{id:"599d269b-38c0-41ca-af58-154aa9101c51",e_name:"Entertainment",h_name:null,url:"https://s3.ap-south-1.amazonaws.com/loveai-media/interests/icons/8b107ce7-1f18-47c6-b9bd-bf639b03217f.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIARHWSHFT7V65SDPET%2F20250516%2Fap-south-1%2Fs3%2Faws4_request&X-Amz-Date=20250516T151640Z&X-Amz-Expires=3600&X-Amz-SignedHeaders=host&X-Amz-Signature=55cf819303d57efacfff803c9d44533d89228114f2112acfc7d0a929fc0139e8",category:[{id:"0ff4d1b8-00eb-4013-a9e7-1190ac8a1333",e_name:"Movies",h_name:null,url:"https://s3.ap-south-1.amazonaws.com/loveai-media/interests/icons/920f2337-be53-4492-bbb5-620367667702.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIARHWSHFT7V65SDPET%2F20250516%2Fap-south-1%2Fs3%2Faws4_request&X-Amz-Date=20250516T151640Z&X-Amz-Expires=3600&X-Amz-SignedHeaders=host&X-Amz-Signature=1165f16125a1359da835aed96665f502d5048ae3ad9c9389aac5ba1f92d8da19"},{id:"cb93961d-07e8-4844-bd02-82756fcb0ee8",e_name:"Comedy",h_name:null,url:"https://s3.ap-south-1.amazonaws.com/loveai-media/interests/icons/772a509c-840b-404f-af21-3c6c91bfe506.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIARHWSHFT7V65SDPET%2F20250516%2Fap-south-1%2Fs3%2Faws4_request&X-Amz-Date=20250516T151641Z&X-Amz-Expires=3600&X-Amz-SignedHeaders=host&X-Amz-Signature=30f0b611056ebff51c67e2b23441b7c81d375154be232ec307a4bb6b54c655b5"},{id:"fdaff24b-ec9a-433a-ab68-6eaf251166cf",e_name:"Music",h_name:null,url:"https://s3.ap-south-1.amazonaws.com/loveai-media/interests/icons/c2958b7c-fae8-41aa-965d-641d315de938.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIARHWSHFT7V65SDPET%2F20250516%2Fap-south-1%2Fs3%2Faws4_request&X-Amz-Date=20250516T151641Z&X-Amz-Expires=3600&X-Amz-SignedHeaders=host&X-Amz-Signature=1c34addea2b1441094c6d1c9ffd00bcd1095736153eb5352f2018ed52576d014"}]}]),[I,N]=q.useState(""),M=xl();q.useEffect(()=>{Ur.get("/interests").then(V=>T(V.data)).catch(V=>console.error("Failed to fetch interests:",V))},[]);const k=V=>{N("");const K=V.id;if(d.includes(K))h(d.filter(ie=>ie!==K));else{if(d.length>=jve){N("You can only select up to 5 interests.");return}h([...d,K])}},x=async V=>{if(V.preventDefault(),d.length===0){N(" Please select at least one interest.");return}try{await Ur.post("/users/interests",{interest_ids:d},{headers:{token:localStorage.getItem("authToken")}}),M("/profile/photos"),N(" Interests saved successfully!")}catch(K){console.error(K),N(" Failed to save interests.")}};return j.jsxs("form",{ref:o,onSubmit:x,onKeyDown:V=>{var K;V.key==="Enter"&&(V.preventDefault(),(K=o.current)==null||K.requestSubmit())},className:"space-y-5 w-full text-sm h-full",children:[j.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-1",children:"Tell Your Interest"}),j.jsx("p",{className:"text-gray-500 text-sm mb-4 font-semibold",children:"Select up to 5 interests"}),g.map(V=>j.jsxs("div",{children:[j.jsxs("h3",{className:"text-gray-700 font-semibold flex items-center gap-2 mb-2",children:[V.url&&j.jsx("img",{src:V.url,alt:V.e_name,className:"w-5 h-5 rounded-full"}),V.e_name]}),j.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:V.category.map(K=>j.jsxs("button",{type:"button",onClick:()=>k({...K}),className:`px-4 py-2 rounded-full text-sm font-medium transition-all flex items-center gap-2
                ${d.includes(K.id)?"bg-gradient-to-r from-[#00D4FF] to-[#00A3E0] text-white":"bg-gradient-to-r from-[#FF9999] to-[#FF999980] text-white"}
              `,children:[K.url&&j.jsx("img",{src:K.url,alt:K.e_name,className:"w-4 h-4 rounded-full"}),K.e_name]},K.id))})]},V.id)),j.jsx("div",{className:"min-h-[24px] pt-2 transition-all duration-200 ease-in-out",children:j.jsxs("p",{className:`text-center text-sm transition-opacity duration-200 ${I?I.startsWith("")?"text-green-600 opacity-100":"text-red-600 opacity-100":"opacity-0"}`,children:[I||""," "]})})]})}function Bve(){const o=q.useRef(),d=xl(),[h,g]=q.useState(!1);return j.jsx(yE,{titleText:"You can add up to 10 photos or skip and add later",text:"It will Display on your Profile and you will not be able to change it later",hasButton:!0,hasSkip:!1,onSkipClick:()=>d("/profile/ideal-match"),onButtonClick:()=>{var T;return(T=o.current)==null?void 0:T.requestSubmit()},buttonText:h?"Loading...":"NEXT",children:j.jsx(Fve,{formRef:o,setIsLoding:g})})}function Fve({formRef:o,setIsLoding:d}){const[h,g]=q.useState([]),T=q.useRef(null),I=xl(),N=10,[M,k]=q.useState(""),x=X=>{const Z=Array.from(X.target.files||[]),ae=N-h.length;Z.length>ae&&alert(`You can only upload ${ae} more photo(s).`),Z.slice(0,ae).forEach(fe=>{const ue=new FileReader;ue.onloadend=()=>{g(de=>[...de,{id:Date.now()+Math.random(),url:ue.result,file:fe}])},ue.readAsDataURL(fe)})},V=()=>{k(""),T.current.click()},K=X=>{const Z=document.createElement("input");Z.type="file",Z.accept="image/*",Z.onchange=ae=>{var fe;const le=(fe=ae.target.files)==null?void 0:fe[0];if(le){const ue=new FileReader;ue.onloadend=()=>{g(de=>de.map(te=>te.id===X?{...te,url:ue.result,file:le}:te))},ue.readAsDataURL(le)}},Z.click()},Q=X=>{g(Z=>Z.filter(ae=>ae.id!==X))},ie=async X=>{var fe,ue;if(X.preventDefault(),h.length<2){k("Please upload at least 2 photos to continue.");return}k(""),d(!0);const Z=((fe=JSON.parse(localStorage.getItem("user_Data")))==null?void 0:fe.token)||localStorage.getItem("authToken"),ae=((ue=JSON.parse(localStorage.getItem("user_Data")))==null?void 0:ue.id)||localStorage.getItem("userId");if(!Z||!ae){alert("Missing token or user ID.");return}const le=new FormData;h.forEach(de=>{de.file&&le.append("files",de.file)});try{const de=await Ur.post(`/users/${ae}/gallary`,le,{headers:{"Content-Type":"multipart/form-data",token:Z}});console.log(" Upload Success",de.data),de.data&&d(!0),I("/profile/ideal-match")}catch(de){console.error(" Upload Error",de),alert("Upload failed.")}};return j.jsxs("form",{tabIndex:-1,onKeyDown:X=>{var Z;X.key==="Enter"&&(X.preventDefault(),(Z=o.current)==null||Z.requestSubmit())},ref:o,onSubmit:ie,className:"bg-white p-6 rounded-xl w-full min-h-[400px] max-h-[600px]",children:[j.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-1",children:"Add Photo and Complete Profile"}),j.jsx("p",{className:"text-sm text-gray-500 mb-5",children:"Add high-quality images to showcase yourself."}),j.jsx("input",{ref:T,type:"file",accept:"image/*",multiple:!0,onChange:x,className:"hidden"}),j.jsx("div",{className:"overflow-y-auto max-h-[320px] pr-1",children:j.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[h.map(X=>j.jsxs("div",{className:"relative rounded-3xl overflow-hidden shadow-md group",children:[j.jsx("img",{src:X.url,alt:"Uploaded",className:"w-full h-40 object-cover"}),j.jsxs("div",{className:"absolute bottom-2 left-1/2 transform -translate-x-1/2 flex items-center gap-3 bg-white px-4 py-2 rounded-full shadow-md",children:[j.jsx("button",{type:"button",onClick:()=>K(X.id),className:"bg-pink-100 text-pink-600 p-2 rounded-full hover:bg-pink-200 transition-all",children:j.jsx(pve,{size:16})}),j.jsx("button",{type:"button",onClick:()=>Q(X.id),className:"bg-pink-100 text-pink-600 p-2 rounded-full hover:bg-pink-200 transition-all",children:j.jsx(vve,{size:16})})]})]},X.id)),h.length<N&&j.jsx("div",{onClick:V,className:"flex items-center justify-center rounded-xl h-32 transition cursor-pointer bg-gradient-to-br from-[#FF999980] to-[#FF9999] text-white hover:opacity-90",children:j.jsx(ive,{size:32})})]})}),M&&j.jsx("div",{className:"text-center text-red-600 mt-35 font-small",style:{fontSize:"14px"},children:M})]})}const Gve="/assets/secondBG-DfsBLCMz.png",zve="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAAwCAYAAABNPhkJAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAtRSURBVHgBzVpvb1tXGf+dc+2usI04QkLbC6i7t2zE5cUkJNTaQxrsVZIhJN6gpF+ApHyBZPsC7fgAS6IxJgQsKQj2pwI70tjagep0m3iJnRatGwycokLbxL4Pv+ecc+3YiZ3rxqn2SLbvvb73nPN7/j/PuQaHpdVaDjiec8fTj9fxOSeD+yEFmfninBHMirUn3Dg6kuGXtRX+LuO74ys4DFUlh2ZzDkaKHDMPSJ7j1jkPP9EyYqzjFM+HpOEBr/6jABOvwpoTDqCOYQnd8MTobxhTFxebEp4br2NYunx3jt+LiEzOzeE+cFOITsP5BNjiyYuYMBeGGXo4wKs38xRhlbhynHgLiF+CzVQoiTqORVwcJWEwyZXNkgk6fAMtfHMo0FfuLVCaiwQnYnCLYyxzzGsEV0fGMWCSd1HqJu94bLEYf928kHb44QC/frNG7p4gdzchUuprs2808rAoc3T+cqGRnEJpfOvA8d+5PYsoWnLMUrPIHjtHtd37XJXqHcl5Ap4URSB4Bk+ZClKQRVpa/UTVLC/K90FglVSiZmfaaSBwAk3MHzh+WZlkF1SyPFvD0w+dbYP9807RgUxIbfcbdpo3rsNr+stISekBxzIPtRxVsX5g3/zXHN74dw1vNibx7Fc2ePdL4qzazB04fjZb5Mo9Q2M5175OsFTbP0KaVVS3C13PNHHWCxgn8SGdWwpKB/iXN4pOUt5J5fb8r15bwcZCBxLTjuNlvNWY4kqm3HL0mUuN4qApjLEzunaCruFbX6i7i+/fJsB4yTEBGOO/VWw0BdfimgPvvXTDD4AZpKAMUpEtdo5lyqx9uioSX6O9kQkMH/p/K/aMMMpDM8b7Vp3j6Tyo0qnsO3y5QWeEovi7T+LyHdqxVRCzcM5f1Zz2gWQ0teGoig/iOh8Z93Lg8xgVYBNs143sJp7igqbcoV60aqvOq67zR8NFQRcV1NnZAe+f6L+KTMFbS+JD6eXFD+2fFv2R7iW5+fLqJ8IfeYwMsM2cR9yaQUdeWwSwBonhJAG7Idv/WcH0yY5HfeszqrM9z0XnudQNRHH/0MEQp1jFMTCJ49SGlqyJ3VlnaOP5Q0x2hEwzNBXZ4lK2GKdnlKlUKq8cmqzs59Xvi371cRW//lgYi2s+Hh9M5lKjTNsVfhYPvPlPTDbe/Z+Y9+4ILt9bQhr6kA7to1josAQfSapn0ntplaqKIcZK6pw50QiLg83LykX3iDs2LyENNTN158+8q06VyqYG3MlQWjmkJjovRRDfZ85+MOXaIzeZY6eg1IAF9MpOYtFEqgc02zIoGG+XlQPv11CkdqnU2plCGopaBXil2EpbSKRXaZE1/WFqeYY2XDzwfttaFO9a00tX4hW//mjOOaBB5P63C/DjryElpQf8g69WGAoqIQlYGuS47FsNLsSqV/dgMziBNBRFF4wWHBrbt++V+4LW65EsUXtOOK3bQeriYRinBbE4S34yhGhpaKvMr+e7gP+OpePvP1uO43gRLl4EZ9VkXE1DVGumWsniC2huX8Vfmt0ZVJV5tYnLjMJB7c3iMHXxYHX7xfUpY6Ifu1xVC/uoSZXLzvGhKQkFv69NzS3jin+mf8YlG5oj+lQisg40vy5SKup9t1g5bQyct1MikslJ4qJOyZeEEupj0guYiBYxBO0P+LVanvpVdp0GHdtaggqZlgfpMwRXsxp/3YasS0fkIo1vDEAQinfPGBOO6ZzMBsFsUH3rvLyObz/SzYQrd6v8LhifYrqyy69jV3cltieH7Xr0AXyDeTAm/eCsM63WmlrUQ9ssGo9z7UlBqRnLTCoaMyaeF1V3l26yCIjjF5GhV/fVkkk6F745EJ4PDPQpqFlnEskc3TR4dUF8qnmtHZcjahDsfKjJb1G64xiS9gf88+ta6Ocp1Qv44dd8qbbEiijHZp0mHaufaItnknZ6EVOPTbefe4P2LNkqnx3jgn6C733Zt18uNao+l5ZNJhjnyBxh2ngKkZ0gZyYCI71HT5hhjW/pwJzC08c60r8qZ2DjspOzjUt4KlvBEGT7XF2DS9sp1deCUzqrefLdLReSRArwxUS3Gj73eJ3LrXtPbmbwdqPgPgY5J1th/6k0vobTX7qI0tgiTj86LacffkJ27BPSaj7PMVfa2Vny2+pJdMzOrfax2LLVlFJr4YPCWPL4vldf3WQDzcW4dieSP2MqCXLcl2NqTyKajEy3U83f/rNItSu7YRMJJarvPxfwnbFzA1f03h31Gwu8dyZxgBxrmaJeh9bEUTSrCU3wBTq4Y31Y6obofUKB9Wn59LHh6zVouUWHETqEfrzI+mNtrhnb9siudQrataUkje9ginNM/lw6C1ez3BRLz3rmkRUMBs7+lllQz4xORPDO0jEbPyVzVQsLmgxJklEnuBR0E+d6ndpewK/dcCHBHXsOqopXoNJ0oWm74srAi5/qfbNa/pkQcAND1umozuFZhp63GZdhCywvtdNYcK3d4Ly4yJrEzWeo4nUMovcJ3EYzriHo1hRV6J5XcKrHdn2Lp8j7zuhvQK9ML+HJjul1A351c8FoP9i6GFPXzAf/vbfi7bcPqU1HETsQPN5uVQZWUtqoE7uo6mpcfDWbEu+UDgQ9LH0gGlEUS96B3sGpRNIdwEuMvVlb82GDYeZuszQQ6GGozP6WybzOuRhWaGtnHilh1KRdzizKmn46u37SuDk6Xjpjyt7+KNmjBKtUGqeJ4Hl/QlV85/YMRk0qUcFZn+1Q1f8qquoB8Cu1oubHbMwZNuPOHinYhEqPql9YdsuRFH3r+yHvqSuuaAtzeMBiJ0PsrOFHJyt4UMRwEyJXAWWGo6OgFi46uxVKGQlgI77BLfFv8CDp9KPrZPQtF0uyrTM4CrJQD62Yc/60m45elfeQeRBz+vjMbMwBbrtqa9P0skdOzorj2OCIaBcoD7h94QgnHURDtYGGJd/c68hUv+g4cn7eHglrhaSfUZE29nrJ56oyEu3SAqK3iDjuf5LuS/DSDrBW1N2cPp6p4uFsbSSgLzXmzTH7N/yh0R2CggtliDqJw5ACzaBmsrjaBfqu+5ZOixxtldZYVe8ZJu+YcTxTwGHJ2AnXNUH3HpPR3T/XFjmkhDOuglKgefTscIY+jGOt7Z67d5EYIcXYd/+BYcnvz8mhtcj4KtrsncLNvEulw837DQAZkeOOO3uDe+dxNfdhtWjQBkG3hEMptR9nRidjdUpmL1M9650NF90+8f2S0c13GGPQX0LZJCxJ0kntHWOEWs2QJ/tANl6PPPez2QXcD1W5SR82xAcKSQJgo13IPthGlomYsPtgesf3M6hkqPXzePfOcCmme6MH5zsbyz1L7ul4JF7aq1JvLAxtZd51uDy37OJvEQdqkap2vMZyMZ09K1gr7GCGN3x2b6jvnUe0JdSdS0vciYWv/r2ARAXFzKfdBN9Dq7TLHZwPwEx7ccmU0HYwkgREv3Imiq7iyp0F19DrR9XtWW65VP14xg8hwR1l0HkuvN3jfFQreXfwlXrs53OOfYV9I90RmHd9pF2v/rnuYSzryEbdrZzVm7PQLdHkmoI81pricxNsLMyq7YQtF+Ob6xzHttbZ9ZjhaTG8shhen3C7DJ1dDmPWRCse41RT3/Zjb8w5qFzXjog1u8PSFudchNdcxTHmoMV4xgP+2WYsyU4f2s04k3Qcd+/n+GO7hu+HBjzBUiIvi5aWk4/5DS59hUlwHsmz8C1VCbsy2LXQPdsnHeZ69UzOO63eznl7x0Lf8zBdMThEHnSdC0qZIG7dyphK3pwR7PpNDFlfYEneXbCyaz820l6wdjTL7UstlZ69pq3bRFP9WzrSGStEZYn12PasLHx6I3eShhq7B1HHIvyJ7P2/roXE/wEfMYyhNpu+lAAAAABJRU5ErkJggg==",Hve="/assets/relationshipIcon-e-Kx0qJ8.png";function Wve(){const o=xl();return j.jsx(yE,{titleText:" ",text:"It will display on your profile and you will not be able to change it later",hasButton:!0,buttonText:"Find Your Match",onButtonClick:()=>o("/dashboard/home"),children:j.jsx(Kve,{})})}const Yve=[{label:"Relationship",emoji:j.jsx(OEe,{size:36,className:"text-pink-500"}),value:"LoveCommitment",label2:"Looking for love and commitment",color1:"from-[#F4585A]",color2:"to-[#CF2D2F]/80",icon:Hve},{label:"Friendship",emoji:j.jsx(Cve,{size:36,className:"text-blue-500"}),value:"CasualFun",label2:"Looking for casual connections and fun",color1:"from-[#00A3E0]",color2:"to-[#00D4FF]",icon:zve}];function Kve(){const[o,d]=q.useState("");return j.jsx("div",{className:"w-full min-h-[60vh] bg-cover bg-center p-6 flex flex-col items-center justify-center rounded-xl",style:{backgroundImage:`url(${Gve})`},children:j.jsxs("div",{className:"max-w-xl w-full bg-white bg-opacity-90 p-6 rounded-2xl backdrop-blur-md",children:[j.jsx("h2",{className:"text-xl md:text-2xl font-bold text-center text-gray-800 mb-6",children:"Select Your Ideal Match"}),j.jsxs("div",{className:"mb-8",children:[j.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-3 text-center",children:"What are you looking for?"}),j.jsx("div",{className:"flex justify-center gap-5",children:Yve.map(h=>j.jsxs("div",{className:"text-center",children:[j.jsx("div",{onClick:()=>d(h.value),className:`relative bg-gradient-to-b ${h.color1} ${h.color2} rounded-2xl p-5 h-44 w-44 cursor-pointer transition-all duration-300 ${o===h.value?"scale-105 shadow-lg":"opacity-90"}`,children:j.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:j.jsx("div",{className:"bg-white rounded-full w-24 h-24 flex items-center justify-center shadow-lg",children:j.jsx("img",{src:h.icon,alt:`${h.label} Icon`,className:"w-12 h-12 object-contain"})})})}),j.jsx("p",{className:"mt-3 text-md font-semibold text-gray-800",children:h.label}),j.jsx("p",{className:"text-sm text-gray-600 max-w-xs mx-auto",children:h.label2})]},h.value))})]})]})})}const Oee="/assets/null%20image-QMsiHl6L.png",qve="data:image/svg+xml,%3csvg%20width='56'%20height='44'%20viewBox='0%200%2056%2044'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3crect%20width='56'%20height='44'%20rx='8'%20fill='url(%23paint0_linear_4754_5429)'%20fill-opacity='0.2'/%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M21%2015C20.2044%2015%2019.4413%2015.3161%2018.8787%2015.8787C18.3161%2016.4413%2018%2017.2044%2018%2018V26C18%2026.7956%2018.3161%2027.5587%2018.8787%2028.1213C19.4413%2028.6839%2020.2044%2029%2021%2029H31C31.7956%2029%2032.5587%2028.6839%2033.1213%2028.1213C33.6839%2027.5587%2034%2026.7956%2034%2026V24.414L36.293%2026.707C36.4329%2026.8468%2036.611%2026.942%2036.805%2026.9806C36.9989%2027.0192%2037.2%2026.9993%2037.3827%2026.9237C37.5654%2026.848%2037.7215%2026.7199%2037.8314%2026.5555C37.9413%2026.391%2038%2026.1978%2038%2026V18C38%2017.8022%2037.9413%2017.609%2037.8314%2017.4445C37.7215%2017.2801%2037.5654%2017.152%2037.3827%2017.0763C37.2%2017.0007%2036.9989%2016.9808%2036.805%2017.0194C36.611%2017.058%2036.4329%2017.1532%2036.293%2017.293L34%2019.586V18C34%2017.2044%2033.6839%2016.4413%2033.1213%2015.8787C32.5587%2015.3161%2031.7956%2015%2031%2015H21Z'%20fill='url(%23paint1_linear_4754_5429)'/%3e%3cdefs%3e%3clinearGradient%20id='paint0_linear_4754_5429'%20x1='-0.979019'%20y1='-2.50001'%20x2='63.659'%20y2='5.96553'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20stop-color='%23FFC5C5'/%3e%3cstop%20offset='1'%20stop-color='%23FF9999'/%3e%3c/linearGradient%3e%3clinearGradient%20id='paint1_linear_4754_5429'%20x1='28'%20y1='15'%20x2='28'%20y2='29'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20stop-color='%23FFC5C5'/%3e%3cstop%20offset='1'%20stop-color='%23FF9999'/%3e%3c/linearGradient%3e%3c/defs%3e%3c/svg%3e",Jve="data:image/svg+xml,%3csvg%20width='56'%20height='44'%20viewBox='0%200%2056%2044'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3crect%20width='56'%20height='44'%20rx='8'%20fill='url(%23paint0_linear_4754_5434)'%20fill-opacity='0.2'/%3e%3cpath%20d='M27.05%2024.95L25.2%2026.8C24.81%2027.19%2024.19%2027.19%2023.79%2026.81C23.68%2026.7%2023.57%2026.6%2023.46%2026.49C22.4488%2025.472%2021.5161%2024.3789%2020.67%2023.22C19.85%2022.08%2019.19%2020.94%2018.71%2019.81C18.24%2018.67%2018%2017.58%2018%2016.54C18%2015.86%2018.12%2015.21%2018.36%2014.61C18.6%2014%2018.98%2013.44%2019.51%2012.94C20.15%2012.31%2020.85%2012%2021.59%2012C21.87%2012%2022.15%2012.06%2022.4%2012.18C22.66%2012.3%2022.89%2012.48%2023.07%2012.74L25.39%2016.01C25.57%2016.26%2025.7%2016.49%2025.79%2016.71C25.88%2016.92%2025.93%2017.13%2025.93%2017.32C25.93%2017.56%2025.86%2017.8%2025.72%2018.03C25.59%2018.26%2025.4%2018.5%2025.16%2018.74L24.4%2019.53C24.29%2019.64%2024.24%2019.77%2024.24%2019.93C24.24%2020.01%2024.25%2020.08%2024.27%2020.16C24.3%2020.24%2024.33%2020.3%2024.35%2020.36C24.53%2020.69%2024.84%2021.12%2025.28%2021.64C25.73%2022.16%2026.21%2022.69%2026.73%2023.22C26.83%2023.32%2026.94%2023.42%2027.04%2023.52C27.44%2023.91%2027.45%2024.55%2027.05%2024.95ZM37.97%2028.33C37.9687%2028.7074%2037.8833%2029.0798%2037.72%2029.42C37.55%2029.78%2037.33%2030.12%2037.04%2030.44C36.55%2030.98%2036.01%2031.37%2035.4%2031.62C35.39%2031.62%2035.38%2031.63%2035.37%2031.63C34.78%2031.87%2034.14%2032%2033.45%2032C32.43%2032%2031.34%2031.76%2030.19%2031.27C29.04%2030.78%2027.89%2030.12%2026.75%2029.29C26.36%2029%2025.97%2028.71%2025.6%2028.4L28.87%2025.13C29.15%2025.34%2029.4%2025.5%2029.61%2025.61C29.66%2025.63%2029.72%2025.66%2029.79%2025.69C29.87%2025.72%2029.95%2025.73%2030.04%2025.73C30.21%2025.73%2030.34%2025.67%2030.45%2025.56L31.21%2024.81C31.46%2024.56%2031.7%2024.37%2031.93%2024.25C32.16%2024.11%2032.39%2024.04%2032.64%2024.04C32.83%2024.04%2033.03%2024.08%2033.25%2024.17C33.47%2024.26%2033.7%2024.39%2033.95%2024.56L37.26%2026.91C37.52%2027.09%2037.7%2027.3%2037.81%2027.55C37.91%2027.8%2037.97%2028.05%2037.97%2028.33Z'%20fill='url(%23paint1_linear_4754_5434)'/%3e%3cdefs%3e%3clinearGradient%20id='paint0_linear_4754_5434'%20x1='-4.30769'%20y1='7.61538'%20x2='66.9166'%20y2='38.7327'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20stop-color='%234CC82A'%20stop-opacity='0.8'/%3e%3cstop%20offset='0.56'%20stop-color='%23118206'/%3e%3c/linearGradient%3e%3clinearGradient%20id='paint1_linear_4754_5434'%20x1='16.4638'%20y1='15.4615'%20x2='43.5311'%20y2='24.739'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20stop-color='%2331E000'%20stop-opacity='0.8'/%3e%3cstop%20offset='0.56'%20stop-color='%23118206'/%3e%3c/linearGradient%3e%3c/defs%3e%3c/svg%3e";function KX(o){return[].concat(o)}function XQ(o){return o.startsWith(":")}function $se(o){return kG(o)&&(o==="*"||o.length>1&&":>~.+*".includes(o.slice(0,1))||roe(o))}function eoe(o,d){return(kG(d)||typeof d=="number")&&!noe(o)&&!XQ(o)&&!toe(o)}function toe(o){return o.startsWith("@media")}function Xve(o){return o==="."}function noe(o){return o==="--"}function kG(o){return o+""===o}function roe(o){return kG(o)&&(o.startsWith("&")||XQ(o))}function tG(o,d=""){return o.filter(Boolean).join(d)}function ioe(o,d){let h=0;if(d.length===0)return h.toString();for(let g=0;g<d.length;g++){const T=d.charCodeAt(g);h=(h<<5)-h+T,h=h&h}return`${o??"cl"}_${h.toString(36)}`}function Qve(o,d){return o==="content"?`"${d}"`:d}function Zve(o){return o.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function Nee(o,d){return`${o}:${d}`}function $ve(o){return o?`.${o}`:""}function eSe(o,d){return o?`${o}
${d}`:d}var aoe=class soe{constructor(d,h,g,T){this.sheet=d,this.property=h,this.value=g,this.selector=T,this.property=h,this.value=g,this.joined=Nee(h,g);const I=this.selector.preconditions.concat(this.selector.postconditions);this.hash=this.selector.hasConditions?this.selector.scopeClassName:ioe(this.sheet.name,this.joined),this.key=tG([this.joined,I,this.hash])}toString(){let d=qX(this.selector.preconditions,{right:this.hash});return d=qX(this.selector.postconditions,{left:d}),`${d} {${soe.genRule(this.property,this.value)}}`}static genRule(d,h){const g=Zve(d);return Nee(g,Qve(d,h))+";"}};function qX(o,{left:d="",right:h=""}={}){const g=o.reduce((T,I)=>XQ(I)?T+I:roe(I)?T+I.slice(1):tG([T,I]," "),d);return tG([g,$ve(h)]," ")}var tSe=class P7{constructor(d,h=null,{preconditions:g,postconditions:T}={}){this.sheet=d,this.preconditions=[],this.scopeClassName=null,this.scopeName=null,this.postconditions=[],this.preconditions=g?KX(g):[],this.postconditions=T?KX(T):[],this.setScope(h)}setScope(d){return d?(this.scopeClassName||(this.scopeName=d,this.scopeClassName=ioe(this.sheet.name,d+this.sheet.count)),this):this}get hasConditions(){return this.preconditions.length>0||this.postconditions.length>0}addScope(d){return new P7(this.sheet,d,{preconditions:this.preconditions,postconditions:this.postconditions})}addPrecondition(d){return new P7(this.sheet,this.scopeClassName,{postconditions:this.postconditions,preconditions:this.preconditions.concat(d)})}addPostcondition(d){return new P7(this.sheet,this.scopeClassName,{preconditions:this.preconditions,postconditions:this.postconditions.concat(d)})}createRule(d,h){return new aoe(this.sheet,d,h,this)}},nSe=class{constructor(o,d){this.name=o,this.rootNode=d,this.storedStyles={},this.storedClasses={},this.style="",this.count=0,this.id=`flairup-${o}`,this.styleTag=this.createStyleTag()}getStyle(){return this.style}append(o){this.style=eSe(this.style,o)}apply(){this.count++,this.styleTag&&(this.styleTag.innerHTML=this.style)}isApplied(){return!!this.styleTag}createStyleTag(){if(typeof document>"u"||this.isApplied()||this.rootNode===null)return this.styleTag;const o=document.createElement("style");return o.type="text/css",o.id=this.id,(this.rootNode??document.head).appendChild(o),o}addRule(o){const d=this.storedClasses[o.key];return kG(d)?d:(this.storedClasses[o.key]=o.hash,this.storedStyles[o.hash]=[o.property,o.value],this.append(o.toString()),o.hash)}};function QQ(o,d){for(const h in o)d(h.trim(),o[h])}function Mi(...o){const d=o.reduce((h,g)=>(g instanceof Set?h.push(...g):typeof g=="string"?h.push(g):Array.isArray(g)?h.push(Mi(...g)):typeof g=="object"&&Object.entries(g).forEach(([T,I])=>{I&&h.push(T)}),h),[]);return tG(d," ").trim()}function rSe(o,d){const h=new nSe(o,d);return{create:g,getStyle:h.getStyle.bind(h),isApplied:h.isApplied.bind(h)};function g(T){const I={};return ooe(h,T,new tSe(h)).forEach(([M,k,x])=>{xG(h,k,x).forEach(V=>{N(M,V)})}),h.apply(),I;function N(M,k){I[M]=I[M]??new Set,I[M].add(k)}}}function ooe(o,d,h){const g=[];return QQ(d,(T,I)=>{if($se(T))return ooe(o,I,h.addPrecondition(T)).forEach(N=>g.push(N));g.push([T,d[T],h.addScope(T)])}),g}function xG(o,d,h){const g=new Set;return QQ(d,(T,I)=>{let N=[];if($se(T))N=xG(o,I,h.addPostcondition(T));else if(Xve(T))N=KX(I);else if(toe(T))N=aSe(o,I,T,h);else if(noe(T))N=iSe(o,I,h);else if(eoe(T,I)){const M=h.createRule(T,I);o.addRule(M),g.add(M.hash)}return coe(N,g)}),g}function coe(o,d){return o.forEach(h=>d.add(h)),d}function iSe(o,d,h){const g=new Set,T=[];if(QQ(d,(I,N)=>{if(eoe(I,N)){T.push(aoe.genRule(I,N));return}const M=xG(o,N??{},h);coe(M,g)}),!h.scopeClassName)return g;if(T.length){const I=T.join(" ");o.append(`${qX(h.preconditions,{right:h.scopeClassName})} {${I}}`)}return g.add(h.scopeClassName),g}function aSe(o,d,h,g){o.append(h+" {");const T=xG(o,d,g);return o.append("}"),T}function Ys(){return Ys=Object.assign?Object.assign.bind():function(o){for(var d=1;d<arguments.length;d++){var h=arguments[d];for(var g in h)Object.prototype.hasOwnProperty.call(h,g)&&(o[g]=h[g])}return o},Ys.apply(this,arguments)}function sSe(o,d){o.prototype=Object.create(d.prototype),o.prototype.constructor=o,JX(o,d)}function JX(o,d){return JX=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(g,T){return g.__proto__=T,g},JX(o,d)}function loe(o,d){if(o==null)return{};var h={},g=Object.keys(o),T,I;for(I=0;I<g.length;I++)T=g[I],!(d.indexOf(T)>=0)&&(h[T]=o[T]);return h}function oSe(o,d){if(o){if(typeof o=="string")return Lee(o,d);var h=Object.prototype.toString.call(o).slice(8,-1);if(h==="Object"&&o.constructor&&(h=o.constructor.name),h==="Map"||h==="Set")return Array.from(o);if(h==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(h))return Lee(o,d)}}function Lee(o,d){(d==null||d>o.length)&&(d=o.length);for(var h=0,g=new Array(d);h<d;h++)g[h]=o[h];return g}function cSe(o,d){var h=typeof Symbol<"u"&&o[Symbol.iterator]||o["@@iterator"];if(h)return(h=h.call(o)).next.bind(h);if(Array.isArray(o)||(h=oSe(o))||d){h&&(o=h);var g=0;return function(){return g>=o.length?{done:!0}:{done:!1,value:o[g++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var vi;(function(o){o.hiddenOnSearch="epr-hidden-on-search",o.searchActive="epr-search-active",o.hidden="epr-hidden",o.visible="epr-visible",o.active="epr-active",o.emoji="epr-emoji",o.category="epr-emoji-category",o.label="epr-emoji-category-label",o.categoryContent="epr-emoji-category-content",o.emojiHasVariations="epr-emoji-has-variations",o.scrollBody="epr-body",o.emojiList="epr-emoji-list",o.external="__EmojiPicker__",o.emojiPicker="EmojiPickerReact",o.open="epr-open",o.vertical="epr-vertical",o.horizontal="epr-horizontal",o.variationPicker="epr-emoji-variation-picker",o.darkTheme="epr-dark-theme",o.autoTheme="epr-auto-theme"})(vi||(vi={}));function Sd(){for(var o=arguments.length,d=new Array(o),h=0;h<o;h++)d[h]=arguments[h];return d.map(function(g){return"."+g}).join("")}var Ns=rSe("epr",null),M7={display:"none",opacity:"0",pointerEvents:"none",visibility:"hidden",overflow:"hidden"},ZQ=Ns.create({hidden:Ys({".":vi.hidden},M7)}),lSe=q.memo(function(){return q.createElement("style",{suppressHydrationWarning:!0,dangerouslySetInnerHTML:{__html:Ns.getStyle()}})}),qA=Ns.create({".epr-main":{":has(input:not(:placeholder-shown))":{categoryBtn:{":hover":{opacity:"1",backgroundPositionY:"var(--epr-category-navigation-button-size)"}},hiddenOnSearch:Ys({".":vi.hiddenOnSearch},M7)},":has(input(:placeholder-shown))":{visibleOnSearchOnly:M7}},hiddenOnReactions:{transition:"all 0.5s ease-in-out"},".epr-reactions":{hiddenOnReactions:{height:"0px",width:"0px",opacity:"0",pointerEvents:"none",overflow:"hidden"}},".EmojiPickerReact:not(.epr-search-active)":{categoryBtn:{":hover":{opacity:"1",backgroundPositionY:"var(--epr-category-navigation-button-size)"},"&.epr-active":{opacity:"1",backgroundPositionY:"var(--epr-category-navigation-button-size)"}},visibleOnSearchOnly:Ys({".":"epr-visible-on-search-only"},M7)}});function nC(o,d){var h,g;return{".epr-dark-theme":(h={},h[o]=d,h),".epr-auto-theme":(g={},g[o]={"@media (prefers-color-scheme: dark)":d},g)}}function doe(o,d){var h,g,T=(h=o.customEmojis)!=null?h:[],I=(g=d.customEmojis)!=null?g:[];return o.open===d.open&&o.emojiVersion===d.emojiVersion&&o.reactionsDefaultOpen===d.reactionsDefaultOpen&&o.searchPlaceHolder===d.searchPlaceHolder&&o.searchPlaceholder===d.searchPlaceholder&&o.defaultSkinTone===d.defaultSkinTone&&o.skinTonesDisabled===d.skinTonesDisabled&&o.autoFocusSearch===d.autoFocusSearch&&o.emojiStyle===d.emojiStyle&&o.theme===d.theme&&o.suggestedEmojisMode===d.suggestedEmojisMode&&o.lazyLoadEmojis===d.lazyLoadEmojis&&o.className===d.className&&o.height===d.height&&o.width===d.width&&o.style===d.style&&o.searchDisabled===d.searchDisabled&&o.skinTonePickerLocation===d.skinTonePickerLocation&&T.length===I.length}var dSe=["1f44d","2764-fe0f","1f603","1f622","1f64f","1f44e","1f621"],_5;(function(o){o.RECENT="recent",o.FREQUENT="frequent"})(_5||(_5={}));var Ph;(function(o){o.NATIVE="native",o.APPLE="apple",o.TWITTER="twitter",o.GOOGLE="google",o.FACEBOOK="facebook"})(Ph||(Ph={}));var E5;(function(o){o.DARK="dark",o.LIGHT="light",o.AUTO="auto"})(E5||(E5={}));var c0;(function(o){o.NEUTRAL="neutral",o.LIGHT="1f3fb",o.MEDIUM_LIGHT="1f3fc",o.MEDIUM="1f3fd",o.MEDIUM_DARK="1f3fe",o.DARK="1f3ff"})(c0||(c0={}));var Ei;(function(o){o.SUGGESTED="suggested",o.CUSTOM="custom",o.SMILEYS_PEOPLE="smileys_people",o.ANIMALS_NATURE="animals_nature",o.FOOD_DRINK="food_drink",o.TRAVEL_PLACES="travel_places",o.ACTIVITIES="activities",o.OBJECTS="objects",o.SYMBOLS="symbols",o.FLAGS="flags"})(Ei||(Ei={}));var CP;(function(o){o.SEARCH="SEARCH",o.PREVIEW="PREVIEW"})(CP||(CP={}));var dm,uSe=[Ei.SUGGESTED,Ei.CUSTOM,Ei.SMILEYS_PEOPLE,Ei.ANIMALS_NATURE,Ei.FOOD_DRINK,Ei.TRAVEL_PLACES,Ei.ACTIVITIES,Ei.OBJECTS,Ei.SYMBOLS,Ei.FLAGS],fSe={name:"Recently Used",category:Ei.SUGGESTED},uoe=(dm={},dm[Ei.SUGGESTED]={category:Ei.SUGGESTED,name:"Frequently Used"},dm[Ei.CUSTOM]={category:Ei.CUSTOM,name:"Custom Emojis"},dm[Ei.SMILEYS_PEOPLE]={category:Ei.SMILEYS_PEOPLE,name:"Smileys & People"},dm[Ei.ANIMALS_NATURE]={category:Ei.ANIMALS_NATURE,name:"Animals & Nature"},dm[Ei.FOOD_DRINK]={category:Ei.FOOD_DRINK,name:"Food & Drink"},dm[Ei.TRAVEL_PLACES]={category:Ei.TRAVEL_PLACES,name:"Travel & Places"},dm[Ei.ACTIVITIES]={category:Ei.ACTIVITIES,name:"Activities"},dm[Ei.OBJECTS]={category:Ei.OBJECTS,name:"Objects"},dm[Ei.SYMBOLS]={category:Ei.SYMBOLS,name:"Symbols"},dm[Ei.FLAGS]={category:Ei.FLAGS,name:"Flags"},dm);function foe(o){return uSe.map(function(d){return Ys({},uoe[d],o&&o[d]&&o[d])})}function $Q(o){return o.category}function hoe(o){return o.name}function hSe(o,d){var h;o===void 0&&(o=[]),d===void 0&&(d={});var g={};d.suggestionMode===_5.RECENT&&(g[Ei.SUGGESTED]=fSe);var T=foe(g);return(h=o)!=null&&h.length?o.map(function(I){return typeof I=="string"?Dee(I,g[I]):Ys({},Dee(I.category,g[I.category]),I)}):T}function Dee(o,d){return d===void 0&&(d={}),Object.assign(uoe[o],d)}var pSe="https://cdn.jsdelivr.net/npm/emoji-datasource-apple/img/apple/64/",mSe="https://cdn.jsdelivr.net/npm/emoji-datasource-facebook/img/facebook/64/",gSe="https://cdn.jsdelivr.net/npm/emoji-datasource-twitter/img/twitter/64/",_Se="https://cdn.jsdelivr.net/npm/emoji-datasource-google/img/google/64/";function ESe(o){switch(o){case Ph.TWITTER:return gSe;case Ph.GOOGLE:return _Se;case Ph.FACEBOOK:return mSe;case Ph.APPLE:default:return pSe}}var vSe=[],SSe=[{n:["grinning","grinning face"],u:"1f600",a:"1.0"},{n:["smiley","smiling face with open mouth"],u:"1f603",a:"0.6"},{n:["smile","smiling face with open mouth and smiling eyes"],u:"1f604",a:"0.6"},{n:["grin","grinning face with smiling eyes"],u:"1f601",a:"0.6"},{n:["laughing","satisfied","smiling face with open mouth and tightly-closed eyes"],u:"1f606",a:"0.6"},{n:["sweat smile","smiling face with open mouth and cold sweat"],u:"1f605",a:"0.6"},{n:["rolling on the floor laughing"],u:"1f923",a:"3.0"},{n:["joy","face with tears of joy"],u:"1f602",a:"0.6"},{n:["slightly smiling face"],u:"1f642",a:"1.0"},{n:["upside-down face","upside down face"],u:"1f643",a:"1.0"},{n:["melting face"],u:"1fae0",a:"14.0"},{n:["wink","winking face"],u:"1f609",a:"0.6"},{n:["blush","smiling face with smiling eyes"],u:"1f60a",a:"0.6"},{n:["innocent","smiling face with halo"],u:"1f607",a:"1.0"},{n:["smiling face with 3 hearts","smiling face with smiling eyes and three hearts"],u:"1f970",a:"11.0"},{n:["heart eyes","smiling face with heart-shaped eyes"],u:"1f60d",a:"0.6"},{n:["star-struck","grinning face with star eyes"],u:"1f929",a:"5.0"},{n:["kissing heart","face throwing a kiss"],u:"1f618",a:"0.6"},{n:["kissing","kissing face"],u:"1f617",a:"1.0"},{n:["relaxed","white smiling face"],u:"263a-fe0f",a:"0.6"},{n:["kissing closed eyes","kissing face with closed eyes"],u:"1f61a",a:"0.6"},{n:["kissing smiling eyes","kissing face with smiling eyes"],u:"1f619",a:"1.0"},{n:["smiling face with tear"],u:"1f972",a:"13.0"},{n:["yum","face savouring delicious food"],u:"1f60b",a:"0.6"},{n:["stuck out tongue","face with stuck-out tongue"],u:"1f61b",a:"1.0"},{n:["stuck out tongue winking eye","face with stuck-out tongue and winking eye"],u:"1f61c",a:"0.6"},{n:["zany face","grinning face with one large and one small eye"],u:"1f92a",a:"5.0"},{n:["stuck out tongue closed eyes","face with stuck-out tongue and tightly-closed eyes"],u:"1f61d",a:"0.6"},{n:["money-mouth face","money mouth face"],u:"1f911",a:"1.0"},{n:["hugging face"],u:"1f917",a:"1.0"},{n:["face with hand over mouth","smiling face with smiling eyes and hand covering mouth"],u:"1f92d",a:"5.0"},{n:["face with open eyes and hand over mouth"],u:"1fae2",a:"14.0"},{n:["face with peeking eye"],u:"1fae3",a:"14.0"},{n:["shushing face","face with finger covering closed lips"],u:"1f92b",a:"5.0"},{n:["thinking face"],u:"1f914",a:"1.0"},{n:["saluting face"],u:"1fae1",a:"14.0"},{n:["zipper-mouth face","zipper mouth face"],u:"1f910",a:"1.0"},{n:["face with raised eyebrow","face with one eyebrow raised"],u:"1f928",a:"5.0"},{n:["neutral face"],u:"1f610",a:"0.7"},{n:["expressionless","expressionless face"],u:"1f611",a:"1.0"},{n:["no mouth","face without mouth"],u:"1f636",a:"1.0"},{n:["dotted line face"],u:"1fae5",a:"14.0"},{n:["face in clouds"],u:"1f636-200d-1f32b-fe0f",a:"13.1"},{n:["smirk","smirking face"],u:"1f60f",a:"0.6"},{n:["unamused","unamused face"],u:"1f612",a:"0.6"},{n:["face with rolling eyes"],u:"1f644",a:"1.0"},{n:["grimacing","grimacing face"],u:"1f62c",a:"1.0"},{n:["face exhaling"],u:"1f62e-200d-1f4a8",a:"13.1"},{n:["lying face"],u:"1f925",a:"3.0"},{n:["relieved","relieved face"],u:"1f60c",a:"0.6"},{n:["pensive","pensive face"],u:"1f614",a:"0.6"},{n:["sleepy","sleepy face"],u:"1f62a",a:"0.6"},{n:["drooling face"],u:"1f924",a:"3.0"},{n:["sleeping","sleeping face"],u:"1f634",a:"1.0"},{n:["mask","face with medical mask"],u:"1f637",a:"0.6"},{n:["face with thermometer"],u:"1f912",a:"1.0"},{n:["face with head-bandage","face with head bandage"],u:"1f915",a:"1.0"},{n:["nauseated face"],u:"1f922",a:"3.0"},{n:["face vomiting","face with open mouth vomiting"],u:"1f92e",a:"5.0"},{n:["sneezing face"],u:"1f927",a:"3.0"},{n:["hot face","overheated face"],u:"1f975",a:"11.0"},{n:["cold face","freezing face"],u:"1f976",a:"11.0"},{n:["woozy face","face with uneven eyes and wavy mouth"],u:"1f974",a:"11.0"},{n:["dizzy face"],u:"1f635",a:"0.6"},{n:["face with spiral eyes"],u:"1f635-200d-1f4ab",a:"13.1"},{n:["exploding head","shocked face with exploding head"],u:"1f92f",a:"5.0"},{n:["face with cowboy hat"],u:"1f920",a:"3.0"},{n:["partying face","face with party horn and party hat"],u:"1f973",a:"11.0"},{n:["disguised face"],u:"1f978",a:"13.0"},{n:["sunglasses","smiling face with sunglasses"],u:"1f60e",a:"1.0"},{n:["nerd face"],u:"1f913",a:"1.0"},{n:["face with monocle"],u:"1f9d0",a:"5.0"},{n:["confused","confused face"],u:"1f615",a:"1.0"},{n:["face with diagonal mouth"],u:"1fae4",a:"14.0"},{n:["worried","worried face"],u:"1f61f",a:"1.0"},{n:["slightly frowning face"],u:"1f641",a:"1.0"},{n:["frowning face","white frowning face"],u:"2639-fe0f",a:"0.7"},{n:["open mouth","face with open mouth"],u:"1f62e",a:"1.0"},{n:["hushed","hushed face"],u:"1f62f",a:"1.0"},{n:["astonished","astonished face"],u:"1f632",a:"0.6"},{n:["flushed","flushed face"],u:"1f633",a:"0.6"},{n:["pleading face","face with pleading eyes"],u:"1f97a",a:"11.0"},{n:["face holding back tears"],u:"1f979",a:"14.0"},{n:["frowning","frowning face with open mouth"],u:"1f626",a:"1.0"},{n:["anguished","anguished face"],u:"1f627",a:"1.0"},{n:["fearful","fearful face"],u:"1f628",a:"0.6"},{n:["cold sweat","face with open mouth and cold sweat"],u:"1f630",a:"0.6"},{n:["disappointed relieved","disappointed but relieved face"],u:"1f625",a:"0.6"},{n:["cry","crying face"],u:"1f622",a:"0.6"},{n:["sob","loudly crying face"],u:"1f62d",a:"0.6"},{n:["scream","face screaming in fear"],u:"1f631",a:"0.6"},{n:["confounded","confounded face"],u:"1f616",a:"0.6"},{n:["persevere","persevering face"],u:"1f623",a:"0.6"},{n:["disappointed","disappointed face"],u:"1f61e",a:"0.6"},{n:["sweat","face with cold sweat"],u:"1f613",a:"0.6"},{n:["weary","weary face"],u:"1f629",a:"0.6"},{n:["tired face"],u:"1f62b",a:"0.6"},{n:["yawning face"],u:"1f971",a:"12.0"},{n:["triumph","face with look of triumph"],u:"1f624",a:"0.6"},{n:["rage","pouting face"],u:"1f621",a:"0.6"},{n:["angry","angry face"],u:"1f620",a:"0.6"},{n:["face with symbols on mouth","serious face with symbols covering mouth"],u:"1f92c",a:"5.0"},{n:["smiling imp","smiling face with horns"],u:"1f608",a:"1.0"},{n:["imp"],u:"1f47f",a:"0.6"},{n:["skull"],u:"1f480",a:"0.6"},{n:["skull and crossbones"],u:"2620-fe0f",a:"1.0"},{n:["poop","shit","hankey","pile of poo"],u:"1f4a9",a:"0.6"},{n:["clown face"],u:"1f921",a:"3.0"},{n:["japanese ogre"],u:"1f479",a:"0.6"},{n:["japanese goblin"],u:"1f47a",a:"0.6"},{n:["ghost"],u:"1f47b",a:"0.6"},{n:["alien","extraterrestrial alien"],u:"1f47d",a:"0.6"},{n:["alien monster","space invader"],u:"1f47e",a:"0.6"},{n:["robot face"],u:"1f916",a:"1.0"},{n:["smiley cat","smiling cat face with open mouth"],u:"1f63a",a:"0.6"},{n:["smile cat","grinning cat face with smiling eyes"],u:"1f638",a:"0.6"},{n:["joy cat","cat face with tears of joy"],u:"1f639",a:"0.6"},{n:["heart eyes cat","smiling cat face with heart-shaped eyes"],u:"1f63b",a:"0.6"},{n:["smirk cat","cat face with wry smile"],u:"1f63c",a:"0.6"},{n:["kissing cat","kissing cat face with closed eyes"],u:"1f63d",a:"0.6"},{n:["scream cat","weary cat face"],u:"1f640",a:"0.6"},{n:["crying cat face"],u:"1f63f",a:"0.6"},{n:["pouting cat","pouting cat face"],u:"1f63e",a:"0.6"},{n:["see no evil","see-no-evil monkey"],u:"1f648",a:"0.6"},{n:["hear no evil","hear-no-evil monkey"],u:"1f649",a:"0.6"},{n:["speak no evil","speak-no-evil monkey"],u:"1f64a",a:"0.6"},{n:["kiss","kiss mark"],u:"1f48b",a:"0.6"},{n:["love letter"],u:"1f48c",a:"0.6"},{n:["cupid","heart with arrow"],u:"1f498",a:"0.6"},{n:["gift heart","heart with ribbon"],u:"1f49d",a:"0.6"},{n:["sparkling heart"],u:"1f496",a:"0.6"},{n:["heartpulse","growing heart"],u:"1f497",a:"0.6"},{n:["heartbeat","beating heart"],u:"1f493",a:"0.6"},{n:["revolving hearts"],u:"1f49e",a:"0.6"},{n:["two hearts"],u:"1f495",a:"0.6"},{n:["heart decoration"],u:"1f49f",a:"0.6"},{n:["heart exclamation","heavy heart exclamation mark ornament"],u:"2763-fe0f",a:"1.0"},{n:["broken heart"],u:"1f494",a:"0.6"},{n:["heart on fire"],u:"2764-fe0f-200d-1f525",a:"13.1"},{n:["mending heart"],u:"2764-fe0f-200d-1fa79",a:"13.1"},{n:["heart","heavy black heart"],u:"2764-fe0f",a:"0.6"},{n:["orange heart"],u:"1f9e1",a:"5.0"},{n:["yellow heart"],u:"1f49b",a:"0.6"},{n:["green heart"],u:"1f49a",a:"0.6"},{n:["blue heart"],u:"1f499",a:"0.6"},{n:["purple heart"],u:"1f49c",a:"0.6"},{n:["brown heart"],u:"1f90e",a:"12.0"},{n:["black heart"],u:"1f5a4",a:"3.0"},{n:["white heart"],u:"1f90d",a:"12.0"},{n:["100","hundred points symbol"],u:"1f4af",a:"0.6"},{n:["anger","anger symbol"],u:"1f4a2",a:"0.6"},{n:["boom","collision","collision symbol"],u:"1f4a5",a:"0.6"},{n:["dizzy","dizzy symbol"],u:"1f4ab",a:"0.6"},{n:["sweat drops","splashing sweat symbol"],u:"1f4a6",a:"0.6"},{n:["dash","dash symbol"],u:"1f4a8",a:"0.6"},{n:["hole"],u:"1f573-fe0f",a:"0.7"},{n:["bomb"],u:"1f4a3",a:"0.6"},{n:["speech balloon"],u:"1f4ac",a:"0.6"},{n:["eye in speech bubble","eye-in-speech-bubble"],u:"1f441-fe0f-200d-1f5e8-fe0f",a:"2.0"},{n:["left speech bubble"],u:"1f5e8-fe0f",a:"2.0"},{n:["right anger bubble"],u:"1f5ef-fe0f",a:"0.7"},{n:["thought balloon"],u:"1f4ad",a:"1.0"},{n:["zzz","sleeping symbol"],u:"1f4a4",a:"0.6"},{n:["wave","waving hand sign"],u:"1f44b",v:["1f44b-1f3fb","1f44b-1f3fc","1f44b-1f3fd","1f44b-1f3fe","1f44b-1f3ff"],a:"0.6"},{n:["raised back of hand"],u:"1f91a",v:["1f91a-1f3fb","1f91a-1f3fc","1f91a-1f3fd","1f91a-1f3fe","1f91a-1f3ff"],a:"3.0"},{n:["hand with fingers splayed","raised hand with fingers splayed"],u:"1f590-fe0f",v:["1f590-1f3fb","1f590-1f3fc","1f590-1f3fd","1f590-1f3fe","1f590-1f3ff"],a:"0.7"},{n:["hand","raised hand"],u:"270b",v:["270b-1f3fb","270b-1f3fc","270b-1f3fd","270b-1f3fe","270b-1f3ff"],a:"0.6"},{n:["spock-hand","raised hand with part between middle and ring fingers"],u:"1f596",v:["1f596-1f3fb","1f596-1f3fc","1f596-1f3fd","1f596-1f3fe","1f596-1f3ff"],a:"1.0"},{n:["rightwards hand"],u:"1faf1",v:["1faf1-1f3fb","1faf1-1f3fc","1faf1-1f3fd","1faf1-1f3fe","1faf1-1f3ff"],a:"14.0"},{n:["leftwards hand"],u:"1faf2",v:["1faf2-1f3fb","1faf2-1f3fc","1faf2-1f3fd","1faf2-1f3fe","1faf2-1f3ff"],a:"14.0"},{n:["palm down hand"],u:"1faf3",v:["1faf3-1f3fb","1faf3-1f3fc","1faf3-1f3fd","1faf3-1f3fe","1faf3-1f3ff"],a:"14.0"},{n:["palm up hand"],u:"1faf4",v:["1faf4-1f3fb","1faf4-1f3fc","1faf4-1f3fd","1faf4-1f3fe","1faf4-1f3ff"],a:"14.0"},{n:["ok hand","ok hand sign"],u:"1f44c",v:["1f44c-1f3fb","1f44c-1f3fc","1f44c-1f3fd","1f44c-1f3fe","1f44c-1f3ff"],a:"0.6"},{n:["pinched fingers"],u:"1f90c",v:["1f90c-1f3fb","1f90c-1f3fc","1f90c-1f3fd","1f90c-1f3fe","1f90c-1f3ff"],a:"13.0"},{n:["pinching hand"],u:"1f90f",v:["1f90f-1f3fb","1f90f-1f3fc","1f90f-1f3fd","1f90f-1f3fe","1f90f-1f3ff"],a:"12.0"},{n:["v","victory hand"],u:"270c-fe0f",v:["270c-1f3fb","270c-1f3fc","270c-1f3fd","270c-1f3fe","270c-1f3ff"],a:"0.6"},{n:["crossed fingers","hand with index and middle fingers crossed"],u:"1f91e",v:["1f91e-1f3fb","1f91e-1f3fc","1f91e-1f3fd","1f91e-1f3fe","1f91e-1f3ff"],a:"3.0"},{n:["hand with index finger and thumb crossed"],u:"1faf0",v:["1faf0-1f3fb","1faf0-1f3fc","1faf0-1f3fd","1faf0-1f3fe","1faf0-1f3ff"],a:"14.0"},{n:["i love you hand sign"],u:"1f91f",v:["1f91f-1f3fb","1f91f-1f3fc","1f91f-1f3fd","1f91f-1f3fe","1f91f-1f3ff"],a:"5.0"},{n:["the horns","sign of the horns"],u:"1f918",v:["1f918-1f3fb","1f918-1f3fc","1f918-1f3fd","1f918-1f3fe","1f918-1f3ff"],a:"1.0"},{n:["call me hand"],u:"1f919",v:["1f919-1f3fb","1f919-1f3fc","1f919-1f3fd","1f919-1f3fe","1f919-1f3ff"],a:"3.0"},{n:["point left","white left pointing backhand index"],u:"1f448",v:["1f448-1f3fb","1f448-1f3fc","1f448-1f3fd","1f448-1f3fe","1f448-1f3ff"],a:"0.6"},{n:["point right","white right pointing backhand index"],u:"1f449",v:["1f449-1f3fb","1f449-1f3fc","1f449-1f3fd","1f449-1f3fe","1f449-1f3ff"],a:"0.6"},{n:["point up 2","white up pointing backhand index"],u:"1f446",v:["1f446-1f3fb","1f446-1f3fc","1f446-1f3fd","1f446-1f3fe","1f446-1f3ff"],a:"0.6"},{n:["middle finger","reversed hand with middle finger extended"],u:"1f595",v:["1f595-1f3fb","1f595-1f3fc","1f595-1f3fd","1f595-1f3fe","1f595-1f3ff"],a:"1.0"},{n:["point down","white down pointing backhand index"],u:"1f447",v:["1f447-1f3fb","1f447-1f3fc","1f447-1f3fd","1f447-1f3fe","1f447-1f3ff"],a:"0.6"},{n:["point up","white up pointing index"],u:"261d-fe0f",v:["261d-1f3fb","261d-1f3fc","261d-1f3fd","261d-1f3fe","261d-1f3ff"],a:"0.6"},{n:["index pointing at the viewer"],u:"1faf5",v:["1faf5-1f3fb","1faf5-1f3fc","1faf5-1f3fd","1faf5-1f3fe","1faf5-1f3ff"],a:"14.0"},{n:["+1","thumbsup","thumbs up sign"],u:"1f44d",v:["1f44d-1f3fb","1f44d-1f3fc","1f44d-1f3fd","1f44d-1f3fe","1f44d-1f3ff"],a:"0.6"},{n:["-1","thumbsdown","thumbs down sign"],u:"1f44e",v:["1f44e-1f3fb","1f44e-1f3fc","1f44e-1f3fd","1f44e-1f3fe","1f44e-1f3ff"],a:"0.6"},{n:["fist","raised fist"],u:"270a",v:["270a-1f3fb","270a-1f3fc","270a-1f3fd","270a-1f3fe","270a-1f3ff"],a:"0.6"},{n:["punch","facepunch","fisted hand sign"],u:"1f44a",v:["1f44a-1f3fb","1f44a-1f3fc","1f44a-1f3fd","1f44a-1f3fe","1f44a-1f3ff"],a:"0.6"},{n:["left-facing fist"],u:"1f91b",v:["1f91b-1f3fb","1f91b-1f3fc","1f91b-1f3fd","1f91b-1f3fe","1f91b-1f3ff"],a:"3.0"},{n:["right-facing fist"],u:"1f91c",v:["1f91c-1f3fb","1f91c-1f3fc","1f91c-1f3fd","1f91c-1f3fe","1f91c-1f3ff"],a:"3.0"},{n:["clap","clapping hands sign"],u:"1f44f",v:["1f44f-1f3fb","1f44f-1f3fc","1f44f-1f3fd","1f44f-1f3fe","1f44f-1f3ff"],a:"0.6"},{n:["raised hands","person raising both hands in celebration"],u:"1f64c",v:["1f64c-1f3fb","1f64c-1f3fc","1f64c-1f3fd","1f64c-1f3fe","1f64c-1f3ff"],a:"0.6"},{n:["heart hands"],u:"1faf6",v:["1faf6-1f3fb","1faf6-1f3fc","1faf6-1f3fd","1faf6-1f3fe","1faf6-1f3ff"],a:"14.0"},{n:["open hands","open hands sign"],u:"1f450",v:["1f450-1f3fb","1f450-1f3fc","1f450-1f3fd","1f450-1f3fe","1f450-1f3ff"],a:"0.6"},{n:["palms up together"],u:"1f932",v:["1f932-1f3fb","1f932-1f3fc","1f932-1f3fd","1f932-1f3fe","1f932-1f3ff"],a:"5.0"},{n:["handshake"],u:"1f91d",v:["1f91d-1f3fb","1f91d-1f3fc","1f91d-1f3fd","1f91d-1f3fe","1f91d-1f3ff","1faf1-1f3fb-200d-1faf2-1f3fc","1faf1-1f3fb-200d-1faf2-1f3fd","1faf1-1f3fb-200d-1faf2-1f3fe","1faf1-1f3fb-200d-1faf2-1f3ff","1faf1-1f3fc-200d-1faf2-1f3fb","1faf1-1f3fc-200d-1faf2-1f3fd","1faf1-1f3fc-200d-1faf2-1f3fe","1faf1-1f3fc-200d-1faf2-1f3ff","1faf1-1f3fd-200d-1faf2-1f3fb","1faf1-1f3fd-200d-1faf2-1f3fc","1faf1-1f3fd-200d-1faf2-1f3fe","1faf1-1f3fd-200d-1faf2-1f3ff","1faf1-1f3fe-200d-1faf2-1f3fb","1faf1-1f3fe-200d-1faf2-1f3fc","1faf1-1f3fe-200d-1faf2-1f3fd","1faf1-1f3fe-200d-1faf2-1f3ff","1faf1-1f3ff-200d-1faf2-1f3fb","1faf1-1f3ff-200d-1faf2-1f3fc","1faf1-1f3ff-200d-1faf2-1f3fd","1faf1-1f3ff-200d-1faf2-1f3fe"],a:"3.0"},{n:["pray","person with folded hands"],u:"1f64f",v:["1f64f-1f3fb","1f64f-1f3fc","1f64f-1f3fd","1f64f-1f3fe","1f64f-1f3ff"],a:"0.6"},{n:["writing hand"],u:"270d-fe0f",v:["270d-1f3fb","270d-1f3fc","270d-1f3fd","270d-1f3fe","270d-1f3ff"],a:"0.7"},{n:["nail care","nail polish"],u:"1f485",v:["1f485-1f3fb","1f485-1f3fc","1f485-1f3fd","1f485-1f3fe","1f485-1f3ff"],a:"0.6"},{n:["selfie"],u:"1f933",v:["1f933-1f3fb","1f933-1f3fc","1f933-1f3fd","1f933-1f3fe","1f933-1f3ff"],a:"3.0"},{n:["muscle","flexed biceps"],u:"1f4aa",v:["1f4aa-1f3fb","1f4aa-1f3fc","1f4aa-1f3fd","1f4aa-1f3fe","1f4aa-1f3ff"],a:"0.6"},{n:["mechanical arm"],u:"1f9be",a:"12.0"},{n:["mechanical leg"],u:"1f9bf",a:"12.0"},{n:["leg"],u:"1f9b5",v:["1f9b5-1f3fb","1f9b5-1f3fc","1f9b5-1f3fd","1f9b5-1f3fe","1f9b5-1f3ff"],a:"11.0"},{n:["foot"],u:"1f9b6",v:["1f9b6-1f3fb","1f9b6-1f3fc","1f9b6-1f3fd","1f9b6-1f3fe","1f9b6-1f3ff"],a:"11.0"},{n:["ear"],u:"1f442",v:["1f442-1f3fb","1f442-1f3fc","1f442-1f3fd","1f442-1f3fe","1f442-1f3ff"],a:"0.6"},{n:["ear with hearing aid"],u:"1f9bb",v:["1f9bb-1f3fb","1f9bb-1f3fc","1f9bb-1f3fd","1f9bb-1f3fe","1f9bb-1f3ff"],a:"12.0"},{n:["nose"],u:"1f443",v:["1f443-1f3fb","1f443-1f3fc","1f443-1f3fd","1f443-1f3fe","1f443-1f3ff"],a:"0.6"},{n:["brain"],u:"1f9e0",a:"5.0"},{n:["anatomical heart"],u:"1fac0",a:"13.0"},{n:["lungs"],u:"1fac1",a:"13.0"},{n:["tooth"],u:"1f9b7",a:"11.0"},{n:["bone"],u:"1f9b4",a:"11.0"},{n:["eyes"],u:"1f440",a:"0.6"},{n:["eye"],u:"1f441-fe0f",a:"0.7"},{n:["tongue"],u:"1f445",a:"0.6"},{n:["lips","mouth"],u:"1f444",a:"0.6"},{n:["biting lip"],u:"1fae6",a:"14.0"},{n:["baby"],u:"1f476",v:["1f476-1f3fb","1f476-1f3fc","1f476-1f3fd","1f476-1f3fe","1f476-1f3ff"],a:"0.6"},{n:["child"],u:"1f9d2",v:["1f9d2-1f3fb","1f9d2-1f3fc","1f9d2-1f3fd","1f9d2-1f3fe","1f9d2-1f3ff"],a:"5.0"},{n:["boy"],u:"1f466",v:["1f466-1f3fb","1f466-1f3fc","1f466-1f3fd","1f466-1f3fe","1f466-1f3ff"],a:"0.6"},{n:["girl"],u:"1f467",v:["1f467-1f3fb","1f467-1f3fc","1f467-1f3fd","1f467-1f3fe","1f467-1f3ff"],a:"0.6"},{n:["adult"],u:"1f9d1",v:["1f9d1-1f3fb","1f9d1-1f3fc","1f9d1-1f3fd","1f9d1-1f3fe","1f9d1-1f3ff"],a:"5.0"},{n:["person with blond hair"],u:"1f471",v:["1f471-1f3fb","1f471-1f3fc","1f471-1f3fd","1f471-1f3fe","1f471-1f3ff"],a:"0.6"},{n:["man"],u:"1f468",v:["1f468-1f3fb","1f468-1f3fc","1f468-1f3fd","1f468-1f3fe","1f468-1f3ff"],a:"0.6"},{n:["bearded person"],u:"1f9d4",v:["1f9d4-1f3fb","1f9d4-1f3fc","1f9d4-1f3fd","1f9d4-1f3fe","1f9d4-1f3ff"],a:"5.0"},{n:["man: beard","man with beard"],u:"1f9d4-200d-2642-fe0f",v:["1f9d4-1f3fb-200d-2642-fe0f","1f9d4-1f3fc-200d-2642-fe0f","1f9d4-1f3fd-200d-2642-fe0f","1f9d4-1f3fe-200d-2642-fe0f","1f9d4-1f3ff-200d-2642-fe0f"],a:"13.1"},{n:["woman: beard","woman with beard"],u:"1f9d4-200d-2640-fe0f",v:["1f9d4-1f3fb-200d-2640-fe0f","1f9d4-1f3fc-200d-2640-fe0f","1f9d4-1f3fd-200d-2640-fe0f","1f9d4-1f3fe-200d-2640-fe0f","1f9d4-1f3ff-200d-2640-fe0f"],a:"13.1"},{n:["man: red hair","red haired man"],u:"1f468-200d-1f9b0",v:["1f468-1f3fb-200d-1f9b0","1f468-1f3fc-200d-1f9b0","1f468-1f3fd-200d-1f9b0","1f468-1f3fe-200d-1f9b0","1f468-1f3ff-200d-1f9b0"],a:"11.0"},{n:["man: curly hair","curly haired man"],u:"1f468-200d-1f9b1",v:["1f468-1f3fb-200d-1f9b1","1f468-1f3fc-200d-1f9b1","1f468-1f3fd-200d-1f9b1","1f468-1f3fe-200d-1f9b1","1f468-1f3ff-200d-1f9b1"],a:"11.0"},{n:["man: white hair","white haired man"],u:"1f468-200d-1f9b3",v:["1f468-1f3fb-200d-1f9b3","1f468-1f3fc-200d-1f9b3","1f468-1f3fd-200d-1f9b3","1f468-1f3fe-200d-1f9b3","1f468-1f3ff-200d-1f9b3"],a:"11.0"},{n:["bald man","man: bald"],u:"1f468-200d-1f9b2",v:["1f468-1f3fb-200d-1f9b2","1f468-1f3fc-200d-1f9b2","1f468-1f3fd-200d-1f9b2","1f468-1f3fe-200d-1f9b2","1f468-1f3ff-200d-1f9b2"],a:"11.0"},{n:["woman"],u:"1f469",v:["1f469-1f3fb","1f469-1f3fc","1f469-1f3fd","1f469-1f3fe","1f469-1f3ff"],a:"0.6"},{n:["woman: red hair","red haired woman"],u:"1f469-200d-1f9b0",v:["1f469-1f3fb-200d-1f9b0","1f469-1f3fc-200d-1f9b0","1f469-1f3fd-200d-1f9b0","1f469-1f3fe-200d-1f9b0","1f469-1f3ff-200d-1f9b0"],a:"11.0"},{n:["person: red hair","red haired person"],u:"1f9d1-200d-1f9b0",v:["1f9d1-1f3fb-200d-1f9b0","1f9d1-1f3fc-200d-1f9b0","1f9d1-1f3fd-200d-1f9b0","1f9d1-1f3fe-200d-1f9b0","1f9d1-1f3ff-200d-1f9b0"],a:"12.1"},{n:["woman: curly hair","curly haired woman"],u:"1f469-200d-1f9b1",v:["1f469-1f3fb-200d-1f9b1","1f469-1f3fc-200d-1f9b1","1f469-1f3fd-200d-1f9b1","1f469-1f3fe-200d-1f9b1","1f469-1f3ff-200d-1f9b1"],a:"11.0"},{n:["person: curly hair","curly haired person"],u:"1f9d1-200d-1f9b1",v:["1f9d1-1f3fb-200d-1f9b1","1f9d1-1f3fc-200d-1f9b1","1f9d1-1f3fd-200d-1f9b1","1f9d1-1f3fe-200d-1f9b1","1f9d1-1f3ff-200d-1f9b1"],a:"12.1"},{n:["woman: white hair","white haired woman"],u:"1f469-200d-1f9b3",v:["1f469-1f3fb-200d-1f9b3","1f469-1f3fc-200d-1f9b3","1f469-1f3fd-200d-1f9b3","1f469-1f3fe-200d-1f9b3","1f469-1f3ff-200d-1f9b3"],a:"11.0"},{n:["person: white hair","white haired person"],u:"1f9d1-200d-1f9b3",v:["1f9d1-1f3fb-200d-1f9b3","1f9d1-1f3fc-200d-1f9b3","1f9d1-1f3fd-200d-1f9b3","1f9d1-1f3fe-200d-1f9b3","1f9d1-1f3ff-200d-1f9b3"],a:"12.1"},{n:["bald woman","woman: bald"],u:"1f469-200d-1f9b2",v:["1f469-1f3fb-200d-1f9b2","1f469-1f3fc-200d-1f9b2","1f469-1f3fd-200d-1f9b2","1f469-1f3fe-200d-1f9b2","1f469-1f3ff-200d-1f9b2"],a:"11.0"},{n:["bald person","person: bald"],u:"1f9d1-200d-1f9b2",v:["1f9d1-1f3fb-200d-1f9b2","1f9d1-1f3fc-200d-1f9b2","1f9d1-1f3fd-200d-1f9b2","1f9d1-1f3fe-200d-1f9b2","1f9d1-1f3ff-200d-1f9b2"],a:"12.1"},{n:["woman: blond hair","blond-haired-woman"],u:"1f471-200d-2640-fe0f",v:["1f471-1f3fb-200d-2640-fe0f","1f471-1f3fc-200d-2640-fe0f","1f471-1f3fd-200d-2640-fe0f","1f471-1f3fe-200d-2640-fe0f","1f471-1f3ff-200d-2640-fe0f"],a:"4.0"},{n:["man: blond hair","blond-haired-man"],u:"1f471-200d-2642-fe0f",v:["1f471-1f3fb-200d-2642-fe0f","1f471-1f3fc-200d-2642-fe0f","1f471-1f3fd-200d-2642-fe0f","1f471-1f3fe-200d-2642-fe0f","1f471-1f3ff-200d-2642-fe0f"],a:"4.0"},{n:["older adult"],u:"1f9d3",v:["1f9d3-1f3fb","1f9d3-1f3fc","1f9d3-1f3fd","1f9d3-1f3fe","1f9d3-1f3ff"],a:"5.0"},{n:["older man"],u:"1f474",v:["1f474-1f3fb","1f474-1f3fc","1f474-1f3fd","1f474-1f3fe","1f474-1f3ff"],a:"0.6"},{n:["older woman"],u:"1f475",v:["1f475-1f3fb","1f475-1f3fc","1f475-1f3fd","1f475-1f3fe","1f475-1f3ff"],a:"0.6"},{n:["person frowning"],u:"1f64d",v:["1f64d-1f3fb","1f64d-1f3fc","1f64d-1f3fd","1f64d-1f3fe","1f64d-1f3ff"],a:"0.6"},{n:["man frowning","man-frowning"],u:"1f64d-200d-2642-fe0f",v:["1f64d-1f3fb-200d-2642-fe0f","1f64d-1f3fc-200d-2642-fe0f","1f64d-1f3fd-200d-2642-fe0f","1f64d-1f3fe-200d-2642-fe0f","1f64d-1f3ff-200d-2642-fe0f"],a:"4.0"},{n:["woman frowning","woman-frowning"],u:"1f64d-200d-2640-fe0f",v:["1f64d-1f3fb-200d-2640-fe0f","1f64d-1f3fc-200d-2640-fe0f","1f64d-1f3fd-200d-2640-fe0f","1f64d-1f3fe-200d-2640-fe0f","1f64d-1f3ff-200d-2640-fe0f"],a:"4.0"},{n:["person with pouting face"],u:"1f64e",v:["1f64e-1f3fb","1f64e-1f3fc","1f64e-1f3fd","1f64e-1f3fe","1f64e-1f3ff"],a:"0.6"},{n:["man pouting","man-pouting"],u:"1f64e-200d-2642-fe0f",v:["1f64e-1f3fb-200d-2642-fe0f","1f64e-1f3fc-200d-2642-fe0f","1f64e-1f3fd-200d-2642-fe0f","1f64e-1f3fe-200d-2642-fe0f","1f64e-1f3ff-200d-2642-fe0f"],a:"4.0"},{n:["woman pouting","woman-pouting"],u:"1f64e-200d-2640-fe0f",v:["1f64e-1f3fb-200d-2640-fe0f","1f64e-1f3fc-200d-2640-fe0f","1f64e-1f3fd-200d-2640-fe0f","1f64e-1f3fe-200d-2640-fe0f","1f64e-1f3ff-200d-2640-fe0f"],a:"4.0"},{n:["no good","face with no good gesture"],u:"1f645",v:["1f645-1f3fb","1f645-1f3fc","1f645-1f3fd","1f645-1f3fe","1f645-1f3ff"],a:"0.6"},{n:["man gesturing no","man-gesturing-no"],u:"1f645-200d-2642-fe0f",v:["1f645-1f3fb-200d-2642-fe0f","1f645-1f3fc-200d-2642-fe0f","1f645-1f3fd-200d-2642-fe0f","1f645-1f3fe-200d-2642-fe0f","1f645-1f3ff-200d-2642-fe0f"],a:"4.0"},{n:["woman gesturing no","woman-gesturing-no"],u:"1f645-200d-2640-fe0f",v:["1f645-1f3fb-200d-2640-fe0f","1f645-1f3fc-200d-2640-fe0f","1f645-1f3fd-200d-2640-fe0f","1f645-1f3fe-200d-2640-fe0f","1f645-1f3ff-200d-2640-fe0f"],a:"4.0"},{n:["ok woman","face with ok gesture"],u:"1f646",v:["1f646-1f3fb","1f646-1f3fc","1f646-1f3fd","1f646-1f3fe","1f646-1f3ff"],a:"0.6"},{n:["man gesturing ok","man-gesturing-ok"],u:"1f646-200d-2642-fe0f",v:["1f646-1f3fb-200d-2642-fe0f","1f646-1f3fc-200d-2642-fe0f","1f646-1f3fd-200d-2642-fe0f","1f646-1f3fe-200d-2642-fe0f","1f646-1f3ff-200d-2642-fe0f"],a:"4.0"},{n:["woman gesturing ok","woman-gesturing-ok"],u:"1f646-200d-2640-fe0f",v:["1f646-1f3fb-200d-2640-fe0f","1f646-1f3fc-200d-2640-fe0f","1f646-1f3fd-200d-2640-fe0f","1f646-1f3fe-200d-2640-fe0f","1f646-1f3ff-200d-2640-fe0f"],a:"4.0"},{n:["information desk person"],u:"1f481",v:["1f481-1f3fb","1f481-1f3fc","1f481-1f3fd","1f481-1f3fe","1f481-1f3ff"],a:"0.6"},{n:["man tipping hand","man-tipping-hand"],u:"1f481-200d-2642-fe0f",v:["1f481-1f3fb-200d-2642-fe0f","1f481-1f3fc-200d-2642-fe0f","1f481-1f3fd-200d-2642-fe0f","1f481-1f3fe-200d-2642-fe0f","1f481-1f3ff-200d-2642-fe0f"],a:"4.0"},{n:["woman tipping hand","woman-tipping-hand"],u:"1f481-200d-2640-fe0f",v:["1f481-1f3fb-200d-2640-fe0f","1f481-1f3fc-200d-2640-fe0f","1f481-1f3fd-200d-2640-fe0f","1f481-1f3fe-200d-2640-fe0f","1f481-1f3ff-200d-2640-fe0f"],a:"4.0"},{n:["raising hand","happy person raising one hand"],u:"1f64b",v:["1f64b-1f3fb","1f64b-1f3fc","1f64b-1f3fd","1f64b-1f3fe","1f64b-1f3ff"],a:"0.6"},{n:["man raising hand","man-raising-hand"],u:"1f64b-200d-2642-fe0f",v:["1f64b-1f3fb-200d-2642-fe0f","1f64b-1f3fc-200d-2642-fe0f","1f64b-1f3fd-200d-2642-fe0f","1f64b-1f3fe-200d-2642-fe0f","1f64b-1f3ff-200d-2642-fe0f"],a:"4.0"},{n:["woman raising hand","woman-raising-hand"],u:"1f64b-200d-2640-fe0f",v:["1f64b-1f3fb-200d-2640-fe0f","1f64b-1f3fc-200d-2640-fe0f","1f64b-1f3fd-200d-2640-fe0f","1f64b-1f3fe-200d-2640-fe0f","1f64b-1f3ff-200d-2640-fe0f"],a:"4.0"},{n:["deaf person"],u:"1f9cf",v:["1f9cf-1f3fb","1f9cf-1f3fc","1f9cf-1f3fd","1f9cf-1f3fe","1f9cf-1f3ff"],a:"12.0"},{n:["deaf man"],u:"1f9cf-200d-2642-fe0f",v:["1f9cf-1f3fb-200d-2642-fe0f","1f9cf-1f3fc-200d-2642-fe0f","1f9cf-1f3fd-200d-2642-fe0f","1f9cf-1f3fe-200d-2642-fe0f","1f9cf-1f3ff-200d-2642-fe0f"],a:"12.0"},{n:["deaf woman"],u:"1f9cf-200d-2640-fe0f",v:["1f9cf-1f3fb-200d-2640-fe0f","1f9cf-1f3fc-200d-2640-fe0f","1f9cf-1f3fd-200d-2640-fe0f","1f9cf-1f3fe-200d-2640-fe0f","1f9cf-1f3ff-200d-2640-fe0f"],a:"12.0"},{n:["bow","person bowing deeply"],u:"1f647",v:["1f647-1f3fb","1f647-1f3fc","1f647-1f3fd","1f647-1f3fe","1f647-1f3ff"],a:"0.6"},{n:["man bowing","man-bowing"],u:"1f647-200d-2642-fe0f",v:["1f647-1f3fb-200d-2642-fe0f","1f647-1f3fc-200d-2642-fe0f","1f647-1f3fd-200d-2642-fe0f","1f647-1f3fe-200d-2642-fe0f","1f647-1f3ff-200d-2642-fe0f"],a:"4.0"},{n:["woman bowing","woman-bowing"],u:"1f647-200d-2640-fe0f",v:["1f647-1f3fb-200d-2640-fe0f","1f647-1f3fc-200d-2640-fe0f","1f647-1f3fd-200d-2640-fe0f","1f647-1f3fe-200d-2640-fe0f","1f647-1f3ff-200d-2640-fe0f"],a:"4.0"},{n:["face palm"],u:"1f926",v:["1f926-1f3fb","1f926-1f3fc","1f926-1f3fd","1f926-1f3fe","1f926-1f3ff"],a:"3.0"},{n:["man facepalming","man-facepalming"],u:"1f926-200d-2642-fe0f",v:["1f926-1f3fb-200d-2642-fe0f","1f926-1f3fc-200d-2642-fe0f","1f926-1f3fd-200d-2642-fe0f","1f926-1f3fe-200d-2642-fe0f","1f926-1f3ff-200d-2642-fe0f"],a:"4.0"},{n:["woman facepalming","woman-facepalming"],u:"1f926-200d-2640-fe0f",v:["1f926-1f3fb-200d-2640-fe0f","1f926-1f3fc-200d-2640-fe0f","1f926-1f3fd-200d-2640-fe0f","1f926-1f3fe-200d-2640-fe0f","1f926-1f3ff-200d-2640-fe0f"],a:"4.0"},{n:["shrug"],u:"1f937",v:["1f937-1f3fb","1f937-1f3fc","1f937-1f3fd","1f937-1f3fe","1f937-1f3ff"],a:"3.0"},{n:["man shrugging","man-shrugging"],u:"1f937-200d-2642-fe0f",v:["1f937-1f3fb-200d-2642-fe0f","1f937-1f3fc-200d-2642-fe0f","1f937-1f3fd-200d-2642-fe0f","1f937-1f3fe-200d-2642-fe0f","1f937-1f3ff-200d-2642-fe0f"],a:"4.0"},{n:["woman shrugging","woman-shrugging"],u:"1f937-200d-2640-fe0f",v:["1f937-1f3fb-200d-2640-fe0f","1f937-1f3fc-200d-2640-fe0f","1f937-1f3fd-200d-2640-fe0f","1f937-1f3fe-200d-2640-fe0f","1f937-1f3ff-200d-2640-fe0f"],a:"4.0"},{n:["health worker"],u:"1f9d1-200d-2695-fe0f",v:["1f9d1-1f3fb-200d-2695-fe0f","1f9d1-1f3fc-200d-2695-fe0f","1f9d1-1f3fd-200d-2695-fe0f","1f9d1-1f3fe-200d-2695-fe0f","1f9d1-1f3ff-200d-2695-fe0f"],a:"12.1"},{n:["male-doctor","man health worker"],u:"1f468-200d-2695-fe0f",v:["1f468-1f3fb-200d-2695-fe0f","1f468-1f3fc-200d-2695-fe0f","1f468-1f3fd-200d-2695-fe0f","1f468-1f3fe-200d-2695-fe0f","1f468-1f3ff-200d-2695-fe0f"],a:"4.0"},{n:["female-doctor","woman health worker"],u:"1f469-200d-2695-fe0f",v:["1f469-1f3fb-200d-2695-fe0f","1f469-1f3fc-200d-2695-fe0f","1f469-1f3fd-200d-2695-fe0f","1f469-1f3fe-200d-2695-fe0f","1f469-1f3ff-200d-2695-fe0f"],a:"4.0"},{n:["student"],u:"1f9d1-200d-1f393",v:["1f9d1-1f3fb-200d-1f393","1f9d1-1f3fc-200d-1f393","1f9d1-1f3fd-200d-1f393","1f9d1-1f3fe-200d-1f393","1f9d1-1f3ff-200d-1f393"],a:"12.1"},{n:["man student","male-student"],u:"1f468-200d-1f393",v:["1f468-1f3fb-200d-1f393","1f468-1f3fc-200d-1f393","1f468-1f3fd-200d-1f393","1f468-1f3fe-200d-1f393","1f468-1f3ff-200d-1f393"],a:"4.0"},{n:["woman student","female-student"],u:"1f469-200d-1f393",v:["1f469-1f3fb-200d-1f393","1f469-1f3fc-200d-1f393","1f469-1f3fd-200d-1f393","1f469-1f3fe-200d-1f393","1f469-1f3ff-200d-1f393"],a:"4.0"},{n:["teacher"],u:"1f9d1-200d-1f3eb",v:["1f9d1-1f3fb-200d-1f3eb","1f9d1-1f3fc-200d-1f3eb","1f9d1-1f3fd-200d-1f3eb","1f9d1-1f3fe-200d-1f3eb","1f9d1-1f3ff-200d-1f3eb"],a:"12.1"},{n:["man teacher","male-teacher"],u:"1f468-200d-1f3eb",v:["1f468-1f3fb-200d-1f3eb","1f468-1f3fc-200d-1f3eb","1f468-1f3fd-200d-1f3eb","1f468-1f3fe-200d-1f3eb","1f468-1f3ff-200d-1f3eb"],a:"4.0"},{n:["woman teacher","female-teacher"],u:"1f469-200d-1f3eb",v:["1f469-1f3fb-200d-1f3eb","1f469-1f3fc-200d-1f3eb","1f469-1f3fd-200d-1f3eb","1f469-1f3fe-200d-1f3eb","1f469-1f3ff-200d-1f3eb"],a:"4.0"},{n:["judge"],u:"1f9d1-200d-2696-fe0f",v:["1f9d1-1f3fb-200d-2696-fe0f","1f9d1-1f3fc-200d-2696-fe0f","1f9d1-1f3fd-200d-2696-fe0f","1f9d1-1f3fe-200d-2696-fe0f","1f9d1-1f3ff-200d-2696-fe0f"],a:"12.1"},{n:["man judge","male-judge"],u:"1f468-200d-2696-fe0f",v:["1f468-1f3fb-200d-2696-fe0f","1f468-1f3fc-200d-2696-fe0f","1f468-1f3fd-200d-2696-fe0f","1f468-1f3fe-200d-2696-fe0f","1f468-1f3ff-200d-2696-fe0f"],a:"4.0"},{n:["woman judge","female-judge"],u:"1f469-200d-2696-fe0f",v:["1f469-1f3fb-200d-2696-fe0f","1f469-1f3fc-200d-2696-fe0f","1f469-1f3fd-200d-2696-fe0f","1f469-1f3fe-200d-2696-fe0f","1f469-1f3ff-200d-2696-fe0f"],a:"4.0"},{n:["farmer"],u:"1f9d1-200d-1f33e",v:["1f9d1-1f3fb-200d-1f33e","1f9d1-1f3fc-200d-1f33e","1f9d1-1f3fd-200d-1f33e","1f9d1-1f3fe-200d-1f33e","1f9d1-1f3ff-200d-1f33e"],a:"12.1"},{n:["man farmer","male-farmer"],u:"1f468-200d-1f33e",v:["1f468-1f3fb-200d-1f33e","1f468-1f3fc-200d-1f33e","1f468-1f3fd-200d-1f33e","1f468-1f3fe-200d-1f33e","1f468-1f3ff-200d-1f33e"],a:"4.0"},{n:["woman farmer","female-farmer"],u:"1f469-200d-1f33e",v:["1f469-1f3fb-200d-1f33e","1f469-1f3fc-200d-1f33e","1f469-1f3fd-200d-1f33e","1f469-1f3fe-200d-1f33e","1f469-1f3ff-200d-1f33e"],a:"4.0"},{n:["cook"],u:"1f9d1-200d-1f373",v:["1f9d1-1f3fb-200d-1f373","1f9d1-1f3fc-200d-1f373","1f9d1-1f3fd-200d-1f373","1f9d1-1f3fe-200d-1f373","1f9d1-1f3ff-200d-1f373"],a:"12.1"},{n:["man cook","male-cook"],u:"1f468-200d-1f373",v:["1f468-1f3fb-200d-1f373","1f468-1f3fc-200d-1f373","1f468-1f3fd-200d-1f373","1f468-1f3fe-200d-1f373","1f468-1f3ff-200d-1f373"],a:"4.0"},{n:["woman cook","female-cook"],u:"1f469-200d-1f373",v:["1f469-1f3fb-200d-1f373","1f469-1f3fc-200d-1f373","1f469-1f3fd-200d-1f373","1f469-1f3fe-200d-1f373","1f469-1f3ff-200d-1f373"],a:"4.0"},{n:["mechanic"],u:"1f9d1-200d-1f527",v:["1f9d1-1f3fb-200d-1f527","1f9d1-1f3fc-200d-1f527","1f9d1-1f3fd-200d-1f527","1f9d1-1f3fe-200d-1f527","1f9d1-1f3ff-200d-1f527"],a:"12.1"},{n:["man mechanic","male-mechanic"],u:"1f468-200d-1f527",v:["1f468-1f3fb-200d-1f527","1f468-1f3fc-200d-1f527","1f468-1f3fd-200d-1f527","1f468-1f3fe-200d-1f527","1f468-1f3ff-200d-1f527"],a:"4.0"},{n:["woman mechanic","female-mechanic"],u:"1f469-200d-1f527",v:["1f469-1f3fb-200d-1f527","1f469-1f3fc-200d-1f527","1f469-1f3fd-200d-1f527","1f469-1f3fe-200d-1f527","1f469-1f3ff-200d-1f527"],a:"4.0"},{n:["factory worker"],u:"1f9d1-200d-1f3ed",v:["1f9d1-1f3fb-200d-1f3ed","1f9d1-1f3fc-200d-1f3ed","1f9d1-1f3fd-200d-1f3ed","1f9d1-1f3fe-200d-1f3ed","1f9d1-1f3ff-200d-1f3ed"],a:"12.1"},{n:["man factory worker","male-factory-worker"],u:"1f468-200d-1f3ed",v:["1f468-1f3fb-200d-1f3ed","1f468-1f3fc-200d-1f3ed","1f468-1f3fd-200d-1f3ed","1f468-1f3fe-200d-1f3ed","1f468-1f3ff-200d-1f3ed"],a:"4.0"},{n:["woman factory worker","female-factory-worker"],u:"1f469-200d-1f3ed",v:["1f469-1f3fb-200d-1f3ed","1f469-1f3fc-200d-1f3ed","1f469-1f3fd-200d-1f3ed","1f469-1f3fe-200d-1f3ed","1f469-1f3ff-200d-1f3ed"],a:"4.0"},{n:["office worker"],u:"1f9d1-200d-1f4bc",v:["1f9d1-1f3fb-200d-1f4bc","1f9d1-1f3fc-200d-1f4bc","1f9d1-1f3fd-200d-1f4bc","1f9d1-1f3fe-200d-1f4bc","1f9d1-1f3ff-200d-1f4bc"],a:"12.1"},{n:["man office worker","male-office-worker"],u:"1f468-200d-1f4bc",v:["1f468-1f3fb-200d-1f4bc","1f468-1f3fc-200d-1f4bc","1f468-1f3fd-200d-1f4bc","1f468-1f3fe-200d-1f4bc","1f468-1f3ff-200d-1f4bc"],a:"4.0"},{n:["woman office worker","female-office-worker"],u:"1f469-200d-1f4bc",v:["1f469-1f3fb-200d-1f4bc","1f469-1f3fc-200d-1f4bc","1f469-1f3fd-200d-1f4bc","1f469-1f3fe-200d-1f4bc","1f469-1f3ff-200d-1f4bc"],a:"4.0"},{n:["scientist"],u:"1f9d1-200d-1f52c",v:["1f9d1-1f3fb-200d-1f52c","1f9d1-1f3fc-200d-1f52c","1f9d1-1f3fd-200d-1f52c","1f9d1-1f3fe-200d-1f52c","1f9d1-1f3ff-200d-1f52c"],a:"12.1"},{n:["man scientist","male-scientist"],u:"1f468-200d-1f52c",v:["1f468-1f3fb-200d-1f52c","1f468-1f3fc-200d-1f52c","1f468-1f3fd-200d-1f52c","1f468-1f3fe-200d-1f52c","1f468-1f3ff-200d-1f52c"],a:"4.0"},{n:["woman scientist","female-scientist"],u:"1f469-200d-1f52c",v:["1f469-1f3fb-200d-1f52c","1f469-1f3fc-200d-1f52c","1f469-1f3fd-200d-1f52c","1f469-1f3fe-200d-1f52c","1f469-1f3ff-200d-1f52c"],a:"4.0"},{n:["technologist"],u:"1f9d1-200d-1f4bb",v:["1f9d1-1f3fb-200d-1f4bb","1f9d1-1f3fc-200d-1f4bb","1f9d1-1f3fd-200d-1f4bb","1f9d1-1f3fe-200d-1f4bb","1f9d1-1f3ff-200d-1f4bb"],a:"12.1"},{n:["man technologist","male-technologist"],u:"1f468-200d-1f4bb",v:["1f468-1f3fb-200d-1f4bb","1f468-1f3fc-200d-1f4bb","1f468-1f3fd-200d-1f4bb","1f468-1f3fe-200d-1f4bb","1f468-1f3ff-200d-1f4bb"],a:"4.0"},{n:["woman technologist","female-technologist"],u:"1f469-200d-1f4bb",v:["1f469-1f3fb-200d-1f4bb","1f469-1f3fc-200d-1f4bb","1f469-1f3fd-200d-1f4bb","1f469-1f3fe-200d-1f4bb","1f469-1f3ff-200d-1f4bb"],a:"4.0"},{n:["singer"],u:"1f9d1-200d-1f3a4",v:["1f9d1-1f3fb-200d-1f3a4","1f9d1-1f3fc-200d-1f3a4","1f9d1-1f3fd-200d-1f3a4","1f9d1-1f3fe-200d-1f3a4","1f9d1-1f3ff-200d-1f3a4"],a:"12.1"},{n:["man singer","male-singer"],u:"1f468-200d-1f3a4",v:["1f468-1f3fb-200d-1f3a4","1f468-1f3fc-200d-1f3a4","1f468-1f3fd-200d-1f3a4","1f468-1f3fe-200d-1f3a4","1f468-1f3ff-200d-1f3a4"],a:"4.0"},{n:["woman singer","female-singer"],u:"1f469-200d-1f3a4",v:["1f469-1f3fb-200d-1f3a4","1f469-1f3fc-200d-1f3a4","1f469-1f3fd-200d-1f3a4","1f469-1f3fe-200d-1f3a4","1f469-1f3ff-200d-1f3a4"],a:"4.0"},{n:["artist"],u:"1f9d1-200d-1f3a8",v:["1f9d1-1f3fb-200d-1f3a8","1f9d1-1f3fc-200d-1f3a8","1f9d1-1f3fd-200d-1f3a8","1f9d1-1f3fe-200d-1f3a8","1f9d1-1f3ff-200d-1f3a8"],a:"12.1"},{n:["man artist","male-artist"],u:"1f468-200d-1f3a8",v:["1f468-1f3fb-200d-1f3a8","1f468-1f3fc-200d-1f3a8","1f468-1f3fd-200d-1f3a8","1f468-1f3fe-200d-1f3a8","1f468-1f3ff-200d-1f3a8"],a:"4.0"},{n:["woman artist","female-artist"],u:"1f469-200d-1f3a8",v:["1f469-1f3fb-200d-1f3a8","1f469-1f3fc-200d-1f3a8","1f469-1f3fd-200d-1f3a8","1f469-1f3fe-200d-1f3a8","1f469-1f3ff-200d-1f3a8"],a:"4.0"},{n:["pilot"],u:"1f9d1-200d-2708-fe0f",v:["1f9d1-1f3fb-200d-2708-fe0f","1f9d1-1f3fc-200d-2708-fe0f","1f9d1-1f3fd-200d-2708-fe0f","1f9d1-1f3fe-200d-2708-fe0f","1f9d1-1f3ff-200d-2708-fe0f"],a:"12.1"},{n:["man pilot","male-pilot"],u:"1f468-200d-2708-fe0f",v:["1f468-1f3fb-200d-2708-fe0f","1f468-1f3fc-200d-2708-fe0f","1f468-1f3fd-200d-2708-fe0f","1f468-1f3fe-200d-2708-fe0f","1f468-1f3ff-200d-2708-fe0f"],a:"4.0"},{n:["woman pilot","female-pilot"],u:"1f469-200d-2708-fe0f",v:["1f469-1f3fb-200d-2708-fe0f","1f469-1f3fc-200d-2708-fe0f","1f469-1f3fd-200d-2708-fe0f","1f469-1f3fe-200d-2708-fe0f","1f469-1f3ff-200d-2708-fe0f"],a:"4.0"},{n:["astronaut"],u:"1f9d1-200d-1f680",v:["1f9d1-1f3fb-200d-1f680","1f9d1-1f3fc-200d-1f680","1f9d1-1f3fd-200d-1f680","1f9d1-1f3fe-200d-1f680","1f9d1-1f3ff-200d-1f680"],a:"12.1"},{n:["man astronaut","male-astronaut"],u:"1f468-200d-1f680",v:["1f468-1f3fb-200d-1f680","1f468-1f3fc-200d-1f680","1f468-1f3fd-200d-1f680","1f468-1f3fe-200d-1f680","1f468-1f3ff-200d-1f680"],a:"4.0"},{n:["woman astronaut","female-astronaut"],u:"1f469-200d-1f680",v:["1f469-1f3fb-200d-1f680","1f469-1f3fc-200d-1f680","1f469-1f3fd-200d-1f680","1f469-1f3fe-200d-1f680","1f469-1f3ff-200d-1f680"],a:"4.0"},{n:["firefighter"],u:"1f9d1-200d-1f692",v:["1f9d1-1f3fb-200d-1f692","1f9d1-1f3fc-200d-1f692","1f9d1-1f3fd-200d-1f692","1f9d1-1f3fe-200d-1f692","1f9d1-1f3ff-200d-1f692"],a:"12.1"},{n:["man firefighter","male-firefighter"],u:"1f468-200d-1f692",v:["1f468-1f3fb-200d-1f692","1f468-1f3fc-200d-1f692","1f468-1f3fd-200d-1f692","1f468-1f3fe-200d-1f692","1f468-1f3ff-200d-1f692"],a:"4.0"},{n:["woman firefighter","female-firefighter"],u:"1f469-200d-1f692",v:["1f469-1f3fb-200d-1f692","1f469-1f3fc-200d-1f692","1f469-1f3fd-200d-1f692","1f469-1f3fe-200d-1f692","1f469-1f3ff-200d-1f692"],a:"4.0"},{n:["cop","police officer"],u:"1f46e",v:["1f46e-1f3fb","1f46e-1f3fc","1f46e-1f3fd","1f46e-1f3fe","1f46e-1f3ff"],a:"0.6"},{n:["man police officer","male-police-officer"],u:"1f46e-200d-2642-fe0f",v:["1f46e-1f3fb-200d-2642-fe0f","1f46e-1f3fc-200d-2642-fe0f","1f46e-1f3fd-200d-2642-fe0f","1f46e-1f3fe-200d-2642-fe0f","1f46e-1f3ff-200d-2642-fe0f"],a:"4.0"},{n:["woman police officer","female-police-officer"],u:"1f46e-200d-2640-fe0f",v:["1f46e-1f3fb-200d-2640-fe0f","1f46e-1f3fc-200d-2640-fe0f","1f46e-1f3fd-200d-2640-fe0f","1f46e-1f3fe-200d-2640-fe0f","1f46e-1f3ff-200d-2640-fe0f"],a:"4.0"},{n:["detective","sleuth or spy"],u:"1f575-fe0f",v:["1f575-1f3fb","1f575-1f3fc","1f575-1f3fd","1f575-1f3fe","1f575-1f3ff"],a:"0.7"},{n:["man detective","male-detective"],u:"1f575-fe0f-200d-2642-fe0f",v:["1f575-1f3fb-200d-2642-fe0f","1f575-1f3fc-200d-2642-fe0f","1f575-1f3fd-200d-2642-fe0f","1f575-1f3fe-200d-2642-fe0f","1f575-1f3ff-200d-2642-fe0f"],a:"4.0"},{n:["woman detective","female-detective"],u:"1f575-fe0f-200d-2640-fe0f",v:["1f575-1f3fb-200d-2640-fe0f","1f575-1f3fc-200d-2640-fe0f","1f575-1f3fd-200d-2640-fe0f","1f575-1f3fe-200d-2640-fe0f","1f575-1f3ff-200d-2640-fe0f"],a:"4.0"},{n:["guardsman"],u:"1f482",v:["1f482-1f3fb","1f482-1f3fc","1f482-1f3fd","1f482-1f3fe","1f482-1f3ff"],a:"0.6"},{n:["man guard","male-guard"],u:"1f482-200d-2642-fe0f",v:["1f482-1f3fb-200d-2642-fe0f","1f482-1f3fc-200d-2642-fe0f","1f482-1f3fd-200d-2642-fe0f","1f482-1f3fe-200d-2642-fe0f","1f482-1f3ff-200d-2642-fe0f"],a:"4.0"},{n:["woman guard","female-guard"],u:"1f482-200d-2640-fe0f",v:["1f482-1f3fb-200d-2640-fe0f","1f482-1f3fc-200d-2640-fe0f","1f482-1f3fd-200d-2640-fe0f","1f482-1f3fe-200d-2640-fe0f","1f482-1f3ff-200d-2640-fe0f"],a:"4.0"},{n:["ninja"],u:"1f977",v:["1f977-1f3fb","1f977-1f3fc","1f977-1f3fd","1f977-1f3fe","1f977-1f3ff"],a:"13.0"},{n:["construction worker"],u:"1f477",v:["1f477-1f3fb","1f477-1f3fc","1f477-1f3fd","1f477-1f3fe","1f477-1f3ff"],a:"0.6"},{n:["man construction worker","male-construction-worker"],u:"1f477-200d-2642-fe0f",v:["1f477-1f3fb-200d-2642-fe0f","1f477-1f3fc-200d-2642-fe0f","1f477-1f3fd-200d-2642-fe0f","1f477-1f3fe-200d-2642-fe0f","1f477-1f3ff-200d-2642-fe0f"],a:"4.0"},{n:["woman construction worker","female-construction-worker"],u:"1f477-200d-2640-fe0f",v:["1f477-1f3fb-200d-2640-fe0f","1f477-1f3fc-200d-2640-fe0f","1f477-1f3fd-200d-2640-fe0f","1f477-1f3fe-200d-2640-fe0f","1f477-1f3ff-200d-2640-fe0f"],a:"4.0"},{n:["person with crown"],u:"1fac5",v:["1fac5-1f3fb","1fac5-1f3fc","1fac5-1f3fd","1fac5-1f3fe","1fac5-1f3ff"],a:"14.0"},{n:["prince"],u:"1f934",v:["1f934-1f3fb","1f934-1f3fc","1f934-1f3fd","1f934-1f3fe","1f934-1f3ff"],a:"3.0"},{n:["princess"],u:"1f478",v:["1f478-1f3fb","1f478-1f3fc","1f478-1f3fd","1f478-1f3fe","1f478-1f3ff"],a:"0.6"},{n:["man with turban"],u:"1f473",v:["1f473-1f3fb","1f473-1f3fc","1f473-1f3fd","1f473-1f3fe","1f473-1f3ff"],a:"0.6"},{n:["man wearing turban","man-wearing-turban"],u:"1f473-200d-2642-fe0f",v:["1f473-1f3fb-200d-2642-fe0f","1f473-1f3fc-200d-2642-fe0f","1f473-1f3fd-200d-2642-fe0f","1f473-1f3fe-200d-2642-fe0f","1f473-1f3ff-200d-2642-fe0f"],a:"4.0"},{n:["woman wearing turban","woman-wearing-turban"],u:"1f473-200d-2640-fe0f",v:["1f473-1f3fb-200d-2640-fe0f","1f473-1f3fc-200d-2640-fe0f","1f473-1f3fd-200d-2640-fe0f","1f473-1f3fe-200d-2640-fe0f","1f473-1f3ff-200d-2640-fe0f"],a:"4.0"},{n:["man with gua pi mao"],u:"1f472",v:["1f472-1f3fb","1f472-1f3fc","1f472-1f3fd","1f472-1f3fe","1f472-1f3ff"],a:"0.6"},{n:["person with headscarf"],u:"1f9d5",v:["1f9d5-1f3fb","1f9d5-1f3fc","1f9d5-1f3fd","1f9d5-1f3fe","1f9d5-1f3ff"],a:"5.0"},{n:["man in tuxedo","person in tuxedo"],u:"1f935",v:["1f935-1f3fb","1f935-1f3fc","1f935-1f3fd","1f935-1f3fe","1f935-1f3ff"],a:"3.0"},{n:["man in tuxedo"],u:"1f935-200d-2642-fe0f",v:["1f935-1f3fb-200d-2642-fe0f","1f935-1f3fc-200d-2642-fe0f","1f935-1f3fd-200d-2642-fe0f","1f935-1f3fe-200d-2642-fe0f","1f935-1f3ff-200d-2642-fe0f"],a:"13.0"},{n:["woman in tuxedo"],u:"1f935-200d-2640-fe0f",v:["1f935-1f3fb-200d-2640-fe0f","1f935-1f3fc-200d-2640-fe0f","1f935-1f3fd-200d-2640-fe0f","1f935-1f3fe-200d-2640-fe0f","1f935-1f3ff-200d-2640-fe0f"],a:"13.0"},{n:["bride with veil"],u:"1f470",v:["1f470-1f3fb","1f470-1f3fc","1f470-1f3fd","1f470-1f3fe","1f470-1f3ff"],a:"0.6"},{n:["man with veil"],u:"1f470-200d-2642-fe0f",v:["1f470-1f3fb-200d-2642-fe0f","1f470-1f3fc-200d-2642-fe0f","1f470-1f3fd-200d-2642-fe0f","1f470-1f3fe-200d-2642-fe0f","1f470-1f3ff-200d-2642-fe0f"],a:"13.0"},{n:["woman with veil"],u:"1f470-200d-2640-fe0f",v:["1f470-1f3fb-200d-2640-fe0f","1f470-1f3fc-200d-2640-fe0f","1f470-1f3fd-200d-2640-fe0f","1f470-1f3fe-200d-2640-fe0f","1f470-1f3ff-200d-2640-fe0f"],a:"13.0"},{n:["pregnant woman"],u:"1f930",v:["1f930-1f3fb","1f930-1f3fc","1f930-1f3fd","1f930-1f3fe","1f930-1f3ff"],a:"3.0"},{n:["pregnant man"],u:"1fac3",v:["1fac3-1f3fb","1fac3-1f3fc","1fac3-1f3fd","1fac3-1f3fe","1fac3-1f3ff"],a:"14.0"},{n:["pregnant person"],u:"1fac4",v:["1fac4-1f3fb","1fac4-1f3fc","1fac4-1f3fd","1fac4-1f3fe","1fac4-1f3ff"],a:"14.0"},{n:["breast-feeding"],u:"1f931",v:["1f931-1f3fb","1f931-1f3fc","1f931-1f3fd","1f931-1f3fe","1f931-1f3ff"],a:"5.0"},{n:["woman feeding baby"],u:"1f469-200d-1f37c",v:["1f469-1f3fb-200d-1f37c","1f469-1f3fc-200d-1f37c","1f469-1f3fd-200d-1f37c","1f469-1f3fe-200d-1f37c","1f469-1f3ff-200d-1f37c"],a:"13.0"},{n:["man feeding baby"],u:"1f468-200d-1f37c",v:["1f468-1f3fb-200d-1f37c","1f468-1f3fc-200d-1f37c","1f468-1f3fd-200d-1f37c","1f468-1f3fe-200d-1f37c","1f468-1f3ff-200d-1f37c"],a:"13.0"},{n:["person feeding baby"],u:"1f9d1-200d-1f37c",v:["1f9d1-1f3fb-200d-1f37c","1f9d1-1f3fc-200d-1f37c","1f9d1-1f3fd-200d-1f37c","1f9d1-1f3fe-200d-1f37c","1f9d1-1f3ff-200d-1f37c"],a:"13.0"},{n:["angel","baby angel"],u:"1f47c",v:["1f47c-1f3fb","1f47c-1f3fc","1f47c-1f3fd","1f47c-1f3fe","1f47c-1f3ff"],a:"0.6"},{n:["santa","father christmas"],u:"1f385",v:["1f385-1f3fb","1f385-1f3fc","1f385-1f3fd","1f385-1f3fe","1f385-1f3ff"],a:"0.6"},{n:["mrs claus","mother christmas"],u:"1f936",v:["1f936-1f3fb","1f936-1f3fc","1f936-1f3fd","1f936-1f3fe","1f936-1f3ff"],a:"3.0"},{n:["mx claus"],u:"1f9d1-200d-1f384",v:["1f9d1-1f3fb-200d-1f384","1f9d1-1f3fc-200d-1f384","1f9d1-1f3fd-200d-1f384","1f9d1-1f3fe-200d-1f384","1f9d1-1f3ff-200d-1f384"],a:"13.0"},{n:["superhero"],u:"1f9b8",v:["1f9b8-1f3fb","1f9b8-1f3fc","1f9b8-1f3fd","1f9b8-1f3fe","1f9b8-1f3ff"],a:"11.0"},{n:["man superhero","male superhero"],u:"1f9b8-200d-2642-fe0f",v:["1f9b8-1f3fb-200d-2642-fe0f","1f9b8-1f3fc-200d-2642-fe0f","1f9b8-1f3fd-200d-2642-fe0f","1f9b8-1f3fe-200d-2642-fe0f","1f9b8-1f3ff-200d-2642-fe0f"],a:"11.0"},{n:["woman superhero","female superhero"],u:"1f9b8-200d-2640-fe0f",v:["1f9b8-1f3fb-200d-2640-fe0f","1f9b8-1f3fc-200d-2640-fe0f","1f9b8-1f3fd-200d-2640-fe0f","1f9b8-1f3fe-200d-2640-fe0f","1f9b8-1f3ff-200d-2640-fe0f"],a:"11.0"},{n:["supervillain"],u:"1f9b9",v:["1f9b9-1f3fb","1f9b9-1f3fc","1f9b9-1f3fd","1f9b9-1f3fe","1f9b9-1f3ff"],a:"11.0"},{n:["man supervillain","male supervillain"],u:"1f9b9-200d-2642-fe0f",v:["1f9b9-1f3fb-200d-2642-fe0f","1f9b9-1f3fc-200d-2642-fe0f","1f9b9-1f3fd-200d-2642-fe0f","1f9b9-1f3fe-200d-2642-fe0f","1f9b9-1f3ff-200d-2642-fe0f"],a:"11.0"},{n:["woman supervillain","female supervillain"],u:"1f9b9-200d-2640-fe0f",v:["1f9b9-1f3fb-200d-2640-fe0f","1f9b9-1f3fc-200d-2640-fe0f","1f9b9-1f3fd-200d-2640-fe0f","1f9b9-1f3fe-200d-2640-fe0f","1f9b9-1f3ff-200d-2640-fe0f"],a:"11.0"},{n:["mage"],u:"1f9d9",v:["1f9d9-1f3fb","1f9d9-1f3fc","1f9d9-1f3fd","1f9d9-1f3fe","1f9d9-1f3ff"],a:"5.0"},{n:["man mage","male mage"],u:"1f9d9-200d-2642-fe0f",v:["1f9d9-1f3fb-200d-2642-fe0f","1f9d9-1f3fc-200d-2642-fe0f","1f9d9-1f3fd-200d-2642-fe0f","1f9d9-1f3fe-200d-2642-fe0f","1f9d9-1f3ff-200d-2642-fe0f"],a:"5.0"},{n:["woman mage","female mage"],u:"1f9d9-200d-2640-fe0f",v:["1f9d9-1f3fb-200d-2640-fe0f","1f9d9-1f3fc-200d-2640-fe0f","1f9d9-1f3fd-200d-2640-fe0f","1f9d9-1f3fe-200d-2640-fe0f","1f9d9-1f3ff-200d-2640-fe0f"],a:"5.0"},{n:["fairy"],u:"1f9da",v:["1f9da-1f3fb","1f9da-1f3fc","1f9da-1f3fd","1f9da-1f3fe","1f9da-1f3ff"],a:"5.0"},{n:["man fairy","male fairy"],u:"1f9da-200d-2642-fe0f",v:["1f9da-1f3fb-200d-2642-fe0f","1f9da-1f3fc-200d-2642-fe0f","1f9da-1f3fd-200d-2642-fe0f","1f9da-1f3fe-200d-2642-fe0f","1f9da-1f3ff-200d-2642-fe0f"],a:"5.0"},{n:["woman fairy","female fairy"],u:"1f9da-200d-2640-fe0f",v:["1f9da-1f3fb-200d-2640-fe0f","1f9da-1f3fc-200d-2640-fe0f","1f9da-1f3fd-200d-2640-fe0f","1f9da-1f3fe-200d-2640-fe0f","1f9da-1f3ff-200d-2640-fe0f"],a:"5.0"},{n:["vampire"],u:"1f9db",v:["1f9db-1f3fb","1f9db-1f3fc","1f9db-1f3fd","1f9db-1f3fe","1f9db-1f3ff"],a:"5.0"},{n:["man vampire","male vampire"],u:"1f9db-200d-2642-fe0f",v:["1f9db-1f3fb-200d-2642-fe0f","1f9db-1f3fc-200d-2642-fe0f","1f9db-1f3fd-200d-2642-fe0f","1f9db-1f3fe-200d-2642-fe0f","1f9db-1f3ff-200d-2642-fe0f"],a:"5.0"},{n:["woman vampire","female vampire"],u:"1f9db-200d-2640-fe0f",v:["1f9db-1f3fb-200d-2640-fe0f","1f9db-1f3fc-200d-2640-fe0f","1f9db-1f3fd-200d-2640-fe0f","1f9db-1f3fe-200d-2640-fe0f","1f9db-1f3ff-200d-2640-fe0f"],a:"5.0"},{n:["merperson"],u:"1f9dc",v:["1f9dc-1f3fb","1f9dc-1f3fc","1f9dc-1f3fd","1f9dc-1f3fe","1f9dc-1f3ff"],a:"5.0"},{n:["merman"],u:"1f9dc-200d-2642-fe0f",v:["1f9dc-1f3fb-200d-2642-fe0f","1f9dc-1f3fc-200d-2642-fe0f","1f9dc-1f3fd-200d-2642-fe0f","1f9dc-1f3fe-200d-2642-fe0f","1f9dc-1f3ff-200d-2642-fe0f"],a:"5.0"},{n:["mermaid"],u:"1f9dc-200d-2640-fe0f",v:["1f9dc-1f3fb-200d-2640-fe0f","1f9dc-1f3fc-200d-2640-fe0f","1f9dc-1f3fd-200d-2640-fe0f","1f9dc-1f3fe-200d-2640-fe0f","1f9dc-1f3ff-200d-2640-fe0f"],a:"5.0"},{n:["elf"],u:"1f9dd",v:["1f9dd-1f3fb","1f9dd-1f3fc","1f9dd-1f3fd","1f9dd-1f3fe","1f9dd-1f3ff"],a:"5.0"},{n:["man elf","male elf"],u:"1f9dd-200d-2642-fe0f",v:["1f9dd-1f3fb-200d-2642-fe0f","1f9dd-1f3fc-200d-2642-fe0f","1f9dd-1f3fd-200d-2642-fe0f","1f9dd-1f3fe-200d-2642-fe0f","1f9dd-1f3ff-200d-2642-fe0f"],a:"5.0"},{n:["woman elf","female elf"],u:"1f9dd-200d-2640-fe0f",v:["1f9dd-1f3fb-200d-2640-fe0f","1f9dd-1f3fc-200d-2640-fe0f","1f9dd-1f3fd-200d-2640-fe0f","1f9dd-1f3fe-200d-2640-fe0f","1f9dd-1f3ff-200d-2640-fe0f"],a:"5.0"},{n:["genie"],u:"1f9de",a:"5.0"},{n:["man genie","male genie"],u:"1f9de-200d-2642-fe0f",a:"5.0"},{n:["woman genie","female genie"],u:"1f9de-200d-2640-fe0f",a:"5.0"},{n:["zombie"],u:"1f9df",a:"5.0"},{n:["man zombie","male zombie"],u:"1f9df-200d-2642-fe0f",a:"5.0"},{n:["woman zombie","female zombie"],u:"1f9df-200d-2640-fe0f",a:"5.0"},{n:["troll"],u:"1f9cc",a:"14.0"},{n:["massage","face massage"],u:"1f486",v:["1f486-1f3fb","1f486-1f3fc","1f486-1f3fd","1f486-1f3fe","1f486-1f3ff"],a:"0.6"},{n:["man getting massage","man-getting-massage"],u:"1f486-200d-2642-fe0f",v:["1f486-1f3fb-200d-2642-fe0f","1f486-1f3fc-200d-2642-fe0f","1f486-1f3fd-200d-2642-fe0f","1f486-1f3fe-200d-2642-fe0f","1f486-1f3ff-200d-2642-fe0f"],a:"4.0"},{n:["woman getting massage","woman-getting-massage"],u:"1f486-200d-2640-fe0f",v:["1f486-1f3fb-200d-2640-fe0f","1f486-1f3fc-200d-2640-fe0f","1f486-1f3fd-200d-2640-fe0f","1f486-1f3fe-200d-2640-fe0f","1f486-1f3ff-200d-2640-fe0f"],a:"4.0"},{n:["haircut"],u:"1f487",v:["1f487-1f3fb","1f487-1f3fc","1f487-1f3fd","1f487-1f3fe","1f487-1f3ff"],a:"0.6"},{n:["man getting haircut","man-getting-haircut"],u:"1f487-200d-2642-fe0f",v:["1f487-1f3fb-200d-2642-fe0f","1f487-1f3fc-200d-2642-fe0f","1f487-1f3fd-200d-2642-fe0f","1f487-1f3fe-200d-2642-fe0f","1f487-1f3ff-200d-2642-fe0f"],a:"4.0"},{n:["woman getting haircut","woman-getting-haircut"],u:"1f487-200d-2640-fe0f",v:["1f487-1f3fb-200d-2640-fe0f","1f487-1f3fc-200d-2640-fe0f","1f487-1f3fd-200d-2640-fe0f","1f487-1f3fe-200d-2640-fe0f","1f487-1f3ff-200d-2640-fe0f"],a:"4.0"},{n:["walking","pedestrian"],u:"1f6b6",v:["1f6b6-1f3fb","1f6b6-1f3fc","1f6b6-1f3fd","1f6b6-1f3fe","1f6b6-1f3ff"],a:"0.6"},{n:["man walking","man-walking"],u:"1f6b6-200d-2642-fe0f",v:["1f6b6-1f3fb-200d-2642-fe0f","1f6b6-1f3fc-200d-2642-fe0f","1f6b6-1f3fd-200d-2642-fe0f","1f6b6-1f3fe-200d-2642-fe0f","1f6b6-1f3ff-200d-2642-fe0f"],a:"4.0"},{n:["woman walking","woman-walking"],u:"1f6b6-200d-2640-fe0f",v:["1f6b6-1f3fb-200d-2640-fe0f","1f6b6-1f3fc-200d-2640-fe0f","1f6b6-1f3fd-200d-2640-fe0f","1f6b6-1f3fe-200d-2640-fe0f","1f6b6-1f3ff-200d-2640-fe0f"],a:"4.0"},{n:["standing person"],u:"1f9cd",v:["1f9cd-1f3fb","1f9cd-1f3fc","1f9cd-1f3fd","1f9cd-1f3fe","1f9cd-1f3ff"],a:"12.0"},{n:["man standing"],u:"1f9cd-200d-2642-fe0f",v:["1f9cd-1f3fb-200d-2642-fe0f","1f9cd-1f3fc-200d-2642-fe0f","1f9cd-1f3fd-200d-2642-fe0f","1f9cd-1f3fe-200d-2642-fe0f","1f9cd-1f3ff-200d-2642-fe0f"],a:"12.0"},{n:["woman standing"],u:"1f9cd-200d-2640-fe0f",v:["1f9cd-1f3fb-200d-2640-fe0f","1f9cd-1f3fc-200d-2640-fe0f","1f9cd-1f3fd-200d-2640-fe0f","1f9cd-1f3fe-200d-2640-fe0f","1f9cd-1f3ff-200d-2640-fe0f"],a:"12.0"},{n:["kneeling person"],u:"1f9ce",v:["1f9ce-1f3fb","1f9ce-1f3fc","1f9ce-1f3fd","1f9ce-1f3fe","1f9ce-1f3ff"],a:"12.0"},{n:["man kneeling"],u:"1f9ce-200d-2642-fe0f",v:["1f9ce-1f3fb-200d-2642-fe0f","1f9ce-1f3fc-200d-2642-fe0f","1f9ce-1f3fd-200d-2642-fe0f","1f9ce-1f3fe-200d-2642-fe0f","1f9ce-1f3ff-200d-2642-fe0f"],a:"12.0"},{n:["woman kneeling"],u:"1f9ce-200d-2640-fe0f",v:["1f9ce-1f3fb-200d-2640-fe0f","1f9ce-1f3fc-200d-2640-fe0f","1f9ce-1f3fd-200d-2640-fe0f","1f9ce-1f3fe-200d-2640-fe0f","1f9ce-1f3ff-200d-2640-fe0f"],a:"12.0"},{n:["person with white cane","person with probing cane"],u:"1f9d1-200d-1f9af",v:["1f9d1-1f3fb-200d-1f9af","1f9d1-1f3fc-200d-1f9af","1f9d1-1f3fd-200d-1f9af","1f9d1-1f3fe-200d-1f9af","1f9d1-1f3ff-200d-1f9af"],a:"12.1"},{n:["man with white cane","man with probing cane"],u:"1f468-200d-1f9af",v:["1f468-1f3fb-200d-1f9af","1f468-1f3fc-200d-1f9af","1f468-1f3fd-200d-1f9af","1f468-1f3fe-200d-1f9af","1f468-1f3ff-200d-1f9af"],a:"12.0"},{n:["woman with white cane","woman with probing cane"],u:"1f469-200d-1f9af",v:["1f469-1f3fb-200d-1f9af","1f469-1f3fc-200d-1f9af","1f469-1f3fd-200d-1f9af","1f469-1f3fe-200d-1f9af","1f469-1f3ff-200d-1f9af"],a:"12.0"},{n:["person in motorized wheelchair"],u:"1f9d1-200d-1f9bc",v:["1f9d1-1f3fb-200d-1f9bc","1f9d1-1f3fc-200d-1f9bc","1f9d1-1f3fd-200d-1f9bc","1f9d1-1f3fe-200d-1f9bc","1f9d1-1f3ff-200d-1f9bc"],a:"12.1"},{n:["man in motorized wheelchair"],u:"1f468-200d-1f9bc",v:["1f468-1f3fb-200d-1f9bc","1f468-1f3fc-200d-1f9bc","1f468-1f3fd-200d-1f9bc","1f468-1f3fe-200d-1f9bc","1f468-1f3ff-200d-1f9bc"],a:"12.0"},{n:["woman in motorized wheelchair"],u:"1f469-200d-1f9bc",v:["1f469-1f3fb-200d-1f9bc","1f469-1f3fc-200d-1f9bc","1f469-1f3fd-200d-1f9bc","1f469-1f3fe-200d-1f9bc","1f469-1f3ff-200d-1f9bc"],a:"12.0"},{n:["person in manual wheelchair"],u:"1f9d1-200d-1f9bd",v:["1f9d1-1f3fb-200d-1f9bd","1f9d1-1f3fc-200d-1f9bd","1f9d1-1f3fd-200d-1f9bd","1f9d1-1f3fe-200d-1f9bd","1f9d1-1f3ff-200d-1f9bd"],a:"12.1"},{n:["man in manual wheelchair"],u:"1f468-200d-1f9bd",v:["1f468-1f3fb-200d-1f9bd","1f468-1f3fc-200d-1f9bd","1f468-1f3fd-200d-1f9bd","1f468-1f3fe-200d-1f9bd","1f468-1f3ff-200d-1f9bd"],a:"12.0"},{n:["woman in manual wheelchair"],u:"1f469-200d-1f9bd",v:["1f469-1f3fb-200d-1f9bd","1f469-1f3fc-200d-1f9bd","1f469-1f3fd-200d-1f9bd","1f469-1f3fe-200d-1f9bd","1f469-1f3ff-200d-1f9bd"],a:"12.0"},{n:["runner","running"],u:"1f3c3",v:["1f3c3-1f3fb","1f3c3-1f3fc","1f3c3-1f3fd","1f3c3-1f3fe","1f3c3-1f3ff"],a:"0.6"},{n:["man running","man-running"],u:"1f3c3-200d-2642-fe0f",v:["1f3c3-1f3fb-200d-2642-fe0f","1f3c3-1f3fc-200d-2642-fe0f","1f3c3-1f3fd-200d-2642-fe0f","1f3c3-1f3fe-200d-2642-fe0f","1f3c3-1f3ff-200d-2642-fe0f"],a:"4.0"},{n:["woman running","woman-running"],u:"1f3c3-200d-2640-fe0f",v:["1f3c3-1f3fb-200d-2640-fe0f","1f3c3-1f3fc-200d-2640-fe0f","1f3c3-1f3fd-200d-2640-fe0f","1f3c3-1f3fe-200d-2640-fe0f","1f3c3-1f3ff-200d-2640-fe0f"],a:"4.0"},{n:["dancer"],u:"1f483",v:["1f483-1f3fb","1f483-1f3fc","1f483-1f3fd","1f483-1f3fe","1f483-1f3ff"],a:"0.6"},{n:["man dancing"],u:"1f57a",v:["1f57a-1f3fb","1f57a-1f3fc","1f57a-1f3fd","1f57a-1f3fe","1f57a-1f3ff"],a:"3.0"},{n:["person in suit levitating","man in business suit levitating"],u:"1f574-fe0f",v:["1f574-1f3fb","1f574-1f3fc","1f574-1f3fd","1f574-1f3fe","1f574-1f3ff"],a:"0.7"},{n:["dancers","woman with bunny ears"],u:"1f46f",a:"0.6"},{n:["men with bunny ears","men-with-bunny-ears-partying","man-with-bunny-ears-partying"],u:"1f46f-200d-2642-fe0f",a:"4.0"},{n:["women with bunny ears","women-with-bunny-ears-partying","woman-with-bunny-ears-partying"],u:"1f46f-200d-2640-fe0f",a:"4.0"},{n:["person in steamy room"],u:"1f9d6",v:["1f9d6-1f3fb","1f9d6-1f3fc","1f9d6-1f3fd","1f9d6-1f3fe","1f9d6-1f3ff"],a:"5.0"},{n:["man in steamy room"],u:"1f9d6-200d-2642-fe0f",v:["1f9d6-1f3fb-200d-2642-fe0f","1f9d6-1f3fc-200d-2642-fe0f","1f9d6-1f3fd-200d-2642-fe0f","1f9d6-1f3fe-200d-2642-fe0f","1f9d6-1f3ff-200d-2642-fe0f"],a:"5.0"},{n:["woman in steamy room"],u:"1f9d6-200d-2640-fe0f",v:["1f9d6-1f3fb-200d-2640-fe0f","1f9d6-1f3fc-200d-2640-fe0f","1f9d6-1f3fd-200d-2640-fe0f","1f9d6-1f3fe-200d-2640-fe0f","1f9d6-1f3ff-200d-2640-fe0f"],a:"5.0"},{n:["person climbing"],u:"1f9d7",v:["1f9d7-1f3fb","1f9d7-1f3fc","1f9d7-1f3fd","1f9d7-1f3fe","1f9d7-1f3ff"],a:"5.0"},{n:["man climbing"],u:"1f9d7-200d-2642-fe0f",v:["1f9d7-1f3fb-200d-2642-fe0f","1f9d7-1f3fc-200d-2642-fe0f","1f9d7-1f3fd-200d-2642-fe0f","1f9d7-1f3fe-200d-2642-fe0f","1f9d7-1f3ff-200d-2642-fe0f"],a:"5.0"},{n:["woman climbing"],u:"1f9d7-200d-2640-fe0f",v:["1f9d7-1f3fb-200d-2640-fe0f","1f9d7-1f3fc-200d-2640-fe0f","1f9d7-1f3fd-200d-2640-fe0f","1f9d7-1f3fe-200d-2640-fe0f","1f9d7-1f3ff-200d-2640-fe0f"],a:"5.0"},{n:["fencer"],u:"1f93a",a:"3.0"},{n:["horse racing"],u:"1f3c7",v:["1f3c7-1f3fb","1f3c7-1f3fc","1f3c7-1f3fd","1f3c7-1f3fe","1f3c7-1f3ff"],a:"1.0"},{n:["skier"],u:"26f7-fe0f",a:"0.7"},{n:["snowboarder"],u:"1f3c2",v:["1f3c2-1f3fb","1f3c2-1f3fc","1f3c2-1f3fd","1f3c2-1f3fe","1f3c2-1f3ff"],a:"0.6"},{n:["golfer","person golfing"],u:"1f3cc-fe0f",v:["1f3cc-1f3fb","1f3cc-1f3fc","1f3cc-1f3fd","1f3cc-1f3fe","1f3cc-1f3ff"],a:"0.7"},{n:["man golfing","man-golfing"],u:"1f3cc-fe0f-200d-2642-fe0f",v:["1f3cc-1f3fb-200d-2642-fe0f","1f3cc-1f3fc-200d-2642-fe0f","1f3cc-1f3fd-200d-2642-fe0f","1f3cc-1f3fe-200d-2642-fe0f","1f3cc-1f3ff-200d-2642-fe0f"],a:"4.0"},{n:["woman golfing","woman-golfing"],u:"1f3cc-fe0f-200d-2640-fe0f",v:["1f3cc-1f3fb-200d-2640-fe0f","1f3cc-1f3fc-200d-2640-fe0f","1f3cc-1f3fd-200d-2640-fe0f","1f3cc-1f3fe-200d-2640-fe0f","1f3cc-1f3ff-200d-2640-fe0f"],a:"4.0"},{n:["surfer"],u:"1f3c4",v:["1f3c4-1f3fb","1f3c4-1f3fc","1f3c4-1f3fd","1f3c4-1f3fe","1f3c4-1f3ff"],a:"0.6"},{n:["man surfing","man-surfing"],u:"1f3c4-200d-2642-fe0f",v:["1f3c4-1f3fb-200d-2642-fe0f","1f3c4-1f3fc-200d-2642-fe0f","1f3c4-1f3fd-200d-2642-fe0f","1f3c4-1f3fe-200d-2642-fe0f","1f3c4-1f3ff-200d-2642-fe0f"],a:"4.0"},{n:["woman surfing","woman-surfing"],u:"1f3c4-200d-2640-fe0f",v:["1f3c4-1f3fb-200d-2640-fe0f","1f3c4-1f3fc-200d-2640-fe0f","1f3c4-1f3fd-200d-2640-fe0f","1f3c4-1f3fe-200d-2640-fe0f","1f3c4-1f3ff-200d-2640-fe0f"],a:"4.0"},{n:["rowboat"],u:"1f6a3",v:["1f6a3-1f3fb","1f6a3-1f3fc","1f6a3-1f3fd","1f6a3-1f3fe","1f6a3-1f3ff"],a:"1.0"},{n:["man rowing boat","man-rowing-boat"],u:"1f6a3-200d-2642-fe0f",v:["1f6a3-1f3fb-200d-2642-fe0f","1f6a3-1f3fc-200d-2642-fe0f","1f6a3-1f3fd-200d-2642-fe0f","1f6a3-1f3fe-200d-2642-fe0f","1f6a3-1f3ff-200d-2642-fe0f"],a:"4.0"},{n:["woman rowing boat","woman-rowing-boat"],u:"1f6a3-200d-2640-fe0f",v:["1f6a3-1f3fb-200d-2640-fe0f","1f6a3-1f3fc-200d-2640-fe0f","1f6a3-1f3fd-200d-2640-fe0f","1f6a3-1f3fe-200d-2640-fe0f","1f6a3-1f3ff-200d-2640-fe0f"],a:"4.0"},{n:["swimmer"],u:"1f3ca",v:["1f3ca-1f3fb","1f3ca-1f3fc","1f3ca-1f3fd","1f3ca-1f3fe","1f3ca-1f3ff"],a:"0.6"},{n:["man swimming","man-swimming"],u:"1f3ca-200d-2642-fe0f",v:["1f3ca-1f3fb-200d-2642-fe0f","1f3ca-1f3fc-200d-2642-fe0f","1f3ca-1f3fd-200d-2642-fe0f","1f3ca-1f3fe-200d-2642-fe0f","1f3ca-1f3ff-200d-2642-fe0f"],a:"4.0"},{n:["woman swimming","woman-swimming"],u:"1f3ca-200d-2640-fe0f",v:["1f3ca-1f3fb-200d-2640-fe0f","1f3ca-1f3fc-200d-2640-fe0f","1f3ca-1f3fd-200d-2640-fe0f","1f3ca-1f3fe-200d-2640-fe0f","1f3ca-1f3ff-200d-2640-fe0f"],a:"4.0"},{n:["person with ball","person bouncing ball"],u:"26f9-fe0f",v:["26f9-1f3fb","26f9-1f3fc","26f9-1f3fd","26f9-1f3fe","26f9-1f3ff"],a:"0.7"},{n:["man bouncing ball","man-bouncing-ball"],u:"26f9-fe0f-200d-2642-fe0f",v:["26f9-1f3fb-200d-2642-fe0f","26f9-1f3fc-200d-2642-fe0f","26f9-1f3fd-200d-2642-fe0f","26f9-1f3fe-200d-2642-fe0f","26f9-1f3ff-200d-2642-fe0f"],a:"4.0"},{n:["woman bouncing ball","woman-bouncing-ball"],u:"26f9-fe0f-200d-2640-fe0f",v:["26f9-1f3fb-200d-2640-fe0f","26f9-1f3fc-200d-2640-fe0f","26f9-1f3fd-200d-2640-fe0f","26f9-1f3fe-200d-2640-fe0f","26f9-1f3ff-200d-2640-fe0f"],a:"4.0"},{n:["weight lifter","person lifting weights"],u:"1f3cb-fe0f",v:["1f3cb-1f3fb","1f3cb-1f3fc","1f3cb-1f3fd","1f3cb-1f3fe","1f3cb-1f3ff"],a:"0.7"},{n:["man lifting weights","man-lifting-weights"],u:"1f3cb-fe0f-200d-2642-fe0f",v:["1f3cb-1f3fb-200d-2642-fe0f","1f3cb-1f3fc-200d-2642-fe0f","1f3cb-1f3fd-200d-2642-fe0f","1f3cb-1f3fe-200d-2642-fe0f","1f3cb-1f3ff-200d-2642-fe0f"],a:"4.0"},{n:["woman lifting weights","woman-lifting-weights"],u:"1f3cb-fe0f-200d-2640-fe0f",v:["1f3cb-1f3fb-200d-2640-fe0f","1f3cb-1f3fc-200d-2640-fe0f","1f3cb-1f3fd-200d-2640-fe0f","1f3cb-1f3fe-200d-2640-fe0f","1f3cb-1f3ff-200d-2640-fe0f"],a:"4.0"},{n:["bicyclist"],u:"1f6b4",v:["1f6b4-1f3fb","1f6b4-1f3fc","1f6b4-1f3fd","1f6b4-1f3fe","1f6b4-1f3ff"],a:"1.0"},{n:["man biking","man-biking"],u:"1f6b4-200d-2642-fe0f",v:["1f6b4-1f3fb-200d-2642-fe0f","1f6b4-1f3fc-200d-2642-fe0f","1f6b4-1f3fd-200d-2642-fe0f","1f6b4-1f3fe-200d-2642-fe0f","1f6b4-1f3ff-200d-2642-fe0f"],a:"4.0"},{n:["woman biking","woman-biking"],u:"1f6b4-200d-2640-fe0f",v:["1f6b4-1f3fb-200d-2640-fe0f","1f6b4-1f3fc-200d-2640-fe0f","1f6b4-1f3fd-200d-2640-fe0f","1f6b4-1f3fe-200d-2640-fe0f","1f6b4-1f3ff-200d-2640-fe0f"],a:"4.0"},{n:["mountain bicyclist"],u:"1f6b5",v:["1f6b5-1f3fb","1f6b5-1f3fc","1f6b5-1f3fd","1f6b5-1f3fe","1f6b5-1f3ff"],a:"1.0"},{n:["man mountain biking","man-mountain-biking"],u:"1f6b5-200d-2642-fe0f",v:["1f6b5-1f3fb-200d-2642-fe0f","1f6b5-1f3fc-200d-2642-fe0f","1f6b5-1f3fd-200d-2642-fe0f","1f6b5-1f3fe-200d-2642-fe0f","1f6b5-1f3ff-200d-2642-fe0f"],a:"4.0"},{n:["woman mountain biking","woman-mountain-biking"],u:"1f6b5-200d-2640-fe0f",v:["1f6b5-1f3fb-200d-2640-fe0f","1f6b5-1f3fc-200d-2640-fe0f","1f6b5-1f3fd-200d-2640-fe0f","1f6b5-1f3fe-200d-2640-fe0f","1f6b5-1f3ff-200d-2640-fe0f"],a:"4.0"},{n:["person doing cartwheel"],u:"1f938",v:["1f938-1f3fb","1f938-1f3fc","1f938-1f3fd","1f938-1f3fe","1f938-1f3ff"],a:"3.0"},{n:["man cartwheeling","man-cartwheeling"],u:"1f938-200d-2642-fe0f",v:["1f938-1f3fb-200d-2642-fe0f","1f938-1f3fc-200d-2642-fe0f","1f938-1f3fd-200d-2642-fe0f","1f938-1f3fe-200d-2642-fe0f","1f938-1f3ff-200d-2642-fe0f"],a:"4.0"},{n:["woman cartwheeling","woman-cartwheeling"],u:"1f938-200d-2640-fe0f",v:["1f938-1f3fb-200d-2640-fe0f","1f938-1f3fc-200d-2640-fe0f","1f938-1f3fd-200d-2640-fe0f","1f938-1f3fe-200d-2640-fe0f","1f938-1f3ff-200d-2640-fe0f"],a:"4.0"},{n:["wrestlers"],u:"1f93c",a:"3.0"},{n:["men wrestling","man-wrestling"],u:"1f93c-200d-2642-fe0f",a:"4.0"},{n:["women wrestling","woman-wrestling"],u:"1f93c-200d-2640-fe0f",a:"4.0"},{n:["water polo"],u:"1f93d",v:["1f93d-1f3fb","1f93d-1f3fc","1f93d-1f3fd","1f93d-1f3fe","1f93d-1f3ff"],a:"3.0"},{n:["man playing water polo","man-playing-water-polo"],u:"1f93d-200d-2642-fe0f",v:["1f93d-1f3fb-200d-2642-fe0f","1f93d-1f3fc-200d-2642-fe0f","1f93d-1f3fd-200d-2642-fe0f","1f93d-1f3fe-200d-2642-fe0f","1f93d-1f3ff-200d-2642-fe0f"],a:"4.0"},{n:["woman playing water polo","woman-playing-water-polo"],u:"1f93d-200d-2640-fe0f",v:["1f93d-1f3fb-200d-2640-fe0f","1f93d-1f3fc-200d-2640-fe0f","1f93d-1f3fd-200d-2640-fe0f","1f93d-1f3fe-200d-2640-fe0f","1f93d-1f3ff-200d-2640-fe0f"],a:"4.0"},{n:["handball"],u:"1f93e",v:["1f93e-1f3fb","1f93e-1f3fc","1f93e-1f3fd","1f93e-1f3fe","1f93e-1f3ff"],a:"3.0"},{n:["man playing handball","man-playing-handball"],u:"1f93e-200d-2642-fe0f",v:["1f93e-1f3fb-200d-2642-fe0f","1f93e-1f3fc-200d-2642-fe0f","1f93e-1f3fd-200d-2642-fe0f","1f93e-1f3fe-200d-2642-fe0f","1f93e-1f3ff-200d-2642-fe0f"],a:"4.0"},{n:["woman playing handball","woman-playing-handball"],u:"1f93e-200d-2640-fe0f",v:["1f93e-1f3fb-200d-2640-fe0f","1f93e-1f3fc-200d-2640-fe0f","1f93e-1f3fd-200d-2640-fe0f","1f93e-1f3fe-200d-2640-fe0f","1f93e-1f3ff-200d-2640-fe0f"],a:"4.0"},{n:["juggling"],u:"1f939",v:["1f939-1f3fb","1f939-1f3fc","1f939-1f3fd","1f939-1f3fe","1f939-1f3ff"],a:"3.0"},{n:["man juggling","man-juggling"],u:"1f939-200d-2642-fe0f",v:["1f939-1f3fb-200d-2642-fe0f","1f939-1f3fc-200d-2642-fe0f","1f939-1f3fd-200d-2642-fe0f","1f939-1f3fe-200d-2642-fe0f","1f939-1f3ff-200d-2642-fe0f"],a:"4.0"},{n:["woman juggling","woman-juggling"],u:"1f939-200d-2640-fe0f",v:["1f939-1f3fb-200d-2640-fe0f","1f939-1f3fc-200d-2640-fe0f","1f939-1f3fd-200d-2640-fe0f","1f939-1f3fe-200d-2640-fe0f","1f939-1f3ff-200d-2640-fe0f"],a:"4.0"},{n:["person in lotus position"],u:"1f9d8",v:["1f9d8-1f3fb","1f9d8-1f3fc","1f9d8-1f3fd","1f9d8-1f3fe","1f9d8-1f3ff"],a:"5.0"},{n:["man in lotus position"],u:"1f9d8-200d-2642-fe0f",v:["1f9d8-1f3fb-200d-2642-fe0f","1f9d8-1f3fc-200d-2642-fe0f","1f9d8-1f3fd-200d-2642-fe0f","1f9d8-1f3fe-200d-2642-fe0f","1f9d8-1f3ff-200d-2642-fe0f"],a:"5.0"},{n:["woman in lotus position"],u:"1f9d8-200d-2640-fe0f",v:["1f9d8-1f3fb-200d-2640-fe0f","1f9d8-1f3fc-200d-2640-fe0f","1f9d8-1f3fd-200d-2640-fe0f","1f9d8-1f3fe-200d-2640-fe0f","1f9d8-1f3ff-200d-2640-fe0f"],a:"5.0"},{n:["bath"],u:"1f6c0",v:["1f6c0-1f3fb","1f6c0-1f3fc","1f6c0-1f3fd","1f6c0-1f3fe","1f6c0-1f3ff"],a:"0.6"},{n:["sleeping accommodation"],u:"1f6cc",v:["1f6cc-1f3fb","1f6cc-1f3fc","1f6cc-1f3fd","1f6cc-1f3fe","1f6cc-1f3ff"],a:"1.0"},{n:["people holding hands"],u:"1f9d1-200d-1f91d-200d-1f9d1",v:["1f9d1-1f3fb-200d-1f91d-200d-1f9d1-1f3fb","1f9d1-1f3fb-200d-1f91d-200d-1f9d1-1f3fc","1f9d1-1f3fb-200d-1f91d-200d-1f9d1-1f3fd","1f9d1-1f3fb-200d-1f91d-200d-1f9d1-1f3fe","1f9d1-1f3fb-200d-1f91d-200d-1f9d1-1f3ff","1f9d1-1f3fc-200d-1f91d-200d-1f9d1-1f3fb","1f9d1-1f3fc-200d-1f91d-200d-1f9d1-1f3fc","1f9d1-1f3fc-200d-1f91d-200d-1f9d1-1f3fd","1f9d1-1f3fc-200d-1f91d-200d-1f9d1-1f3fe","1f9d1-1f3fc-200d-1f91d-200d-1f9d1-1f3ff","1f9d1-1f3fd-200d-1f91d-200d-1f9d1-1f3fb","1f9d1-1f3fd-200d-1f91d-200d-1f9d1-1f3fc","1f9d1-1f3fd-200d-1f91d-200d-1f9d1-1f3fd","1f9d1-1f3fd-200d-1f91d-200d-1f9d1-1f3fe","1f9d1-1f3fd-200d-1f91d-200d-1f9d1-1f3ff","1f9d1-1f3fe-200d-1f91d-200d-1f9d1-1f3fb","1f9d1-1f3fe-200d-1f91d-200d-1f9d1-1f3fc","1f9d1-1f3fe-200d-1f91d-200d-1f9d1-1f3fd","1f9d1-1f3fe-200d-1f91d-200d-1f9d1-1f3fe","1f9d1-1f3fe-200d-1f91d-200d-1f9d1-1f3ff","1f9d1-1f3ff-200d-1f91d-200d-1f9d1-1f3fb","1f9d1-1f3ff-200d-1f91d-200d-1f9d1-1f3fc","1f9d1-1f3ff-200d-1f91d-200d-1f9d1-1f3fd","1f9d1-1f3ff-200d-1f91d-200d-1f9d1-1f3fe","1f9d1-1f3ff-200d-1f91d-200d-1f9d1-1f3ff"],a:"12.0"},{n:["women holding hands","two women holding hands"],u:"1f46d",v:["1f46d-1f3fb","1f46d-1f3fc","1f46d-1f3fd","1f46d-1f3fe","1f46d-1f3ff","1f469-1f3fb-200d-1f91d-200d-1f469-1f3fc","1f469-1f3fb-200d-1f91d-200d-1f469-1f3fd","1f469-1f3fb-200d-1f91d-200d-1f469-1f3fe","1f469-1f3fb-200d-1f91d-200d-1f469-1f3ff","1f469-1f3fc-200d-1f91d-200d-1f469-1f3fb","1f469-1f3fc-200d-1f91d-200d-1f469-1f3fd","1f469-1f3fc-200d-1f91d-200d-1f469-1f3fe","1f469-1f3fc-200d-1f91d-200d-1f469-1f3ff","1f469-1f3fd-200d-1f91d-200d-1f469-1f3fb","1f469-1f3fd-200d-1f91d-200d-1f469-1f3fc","1f469-1f3fd-200d-1f91d-200d-1f469-1f3fe","1f469-1f3fd-200d-1f91d-200d-1f469-1f3ff","1f469-1f3fe-200d-1f91d-200d-1f469-1f3fb","1f469-1f3fe-200d-1f91d-200d-1f469-1f3fc","1f469-1f3fe-200d-1f91d-200d-1f469-1f3fd","1f469-1f3fe-200d-1f91d-200d-1f469-1f3ff","1f469-1f3ff-200d-1f91d-200d-1f469-1f3fb","1f469-1f3ff-200d-1f91d-200d-1f469-1f3fc","1f469-1f3ff-200d-1f91d-200d-1f469-1f3fd","1f469-1f3ff-200d-1f91d-200d-1f469-1f3fe"],a:"1.0"},{n:["couple","man and woman holding hands","woman and man holding hands"],u:"1f46b",v:["1f46b-1f3fb","1f46b-1f3fc","1f46b-1f3fd","1f46b-1f3fe","1f46b-1f3ff","1f469-1f3fb-200d-1f91d-200d-1f468-1f3fc","1f469-1f3fb-200d-1f91d-200d-1f468-1f3fd","1f469-1f3fb-200d-1f91d-200d-1f468-1f3fe","1f469-1f3fb-200d-1f91d-200d-1f468-1f3ff","1f469-1f3fc-200d-1f91d-200d-1f468-1f3fb","1f469-1f3fc-200d-1f91d-200d-1f468-1f3fd","1f469-1f3fc-200d-1f91d-200d-1f468-1f3fe","1f469-1f3fc-200d-1f91d-200d-1f468-1f3ff","1f469-1f3fd-200d-1f91d-200d-1f468-1f3fb","1f469-1f3fd-200d-1f91d-200d-1f468-1f3fc","1f469-1f3fd-200d-1f91d-200d-1f468-1f3fe","1f469-1f3fd-200d-1f91d-200d-1f468-1f3ff","1f469-1f3fe-200d-1f91d-200d-1f468-1f3fb","1f469-1f3fe-200d-1f91d-200d-1f468-1f3fc","1f469-1f3fe-200d-1f91d-200d-1f468-1f3fd","1f469-1f3fe-200d-1f91d-200d-1f468-1f3ff","1f469-1f3ff-200d-1f91d-200d-1f468-1f3fb","1f469-1f3ff-200d-1f91d-200d-1f468-1f3fc","1f469-1f3ff-200d-1f91d-200d-1f468-1f3fd","1f469-1f3ff-200d-1f91d-200d-1f468-1f3fe"],a:"0.6"},{n:["men holding hands","two men holding hands"],u:"1f46c",v:["1f46c-1f3fb","1f46c-1f3fc","1f46c-1f3fd","1f46c-1f3fe","1f46c-1f3ff","1f468-1f3fb-200d-1f91d-200d-1f468-1f3fc","1f468-1f3fb-200d-1f91d-200d-1f468-1f3fd","1f468-1f3fb-200d-1f91d-200d-1f468-1f3fe","1f468-1f3fb-200d-1f91d-200d-1f468-1f3ff","1f468-1f3fc-200d-1f91d-200d-1f468-1f3fb","1f468-1f3fc-200d-1f91d-200d-1f468-1f3fd","1f468-1f3fc-200d-1f91d-200d-1f468-1f3fe","1f468-1f3fc-200d-1f91d-200d-1f468-1f3ff","1f468-1f3fd-200d-1f91d-200d-1f468-1f3fb","1f468-1f3fd-200d-1f91d-200d-1f468-1f3fc","1f468-1f3fd-200d-1f91d-200d-1f468-1f3fe","1f468-1f3fd-200d-1f91d-200d-1f468-1f3ff","1f468-1f3fe-200d-1f91d-200d-1f468-1f3fb","1f468-1f3fe-200d-1f91d-200d-1f468-1f3fc","1f468-1f3fe-200d-1f91d-200d-1f468-1f3fd","1f468-1f3fe-200d-1f91d-200d-1f468-1f3ff","1f468-1f3ff-200d-1f91d-200d-1f468-1f3fb","1f468-1f3ff-200d-1f91d-200d-1f468-1f3fc","1f468-1f3ff-200d-1f91d-200d-1f468-1f3fd","1f468-1f3ff-200d-1f91d-200d-1f468-1f3fe"],a:"1.0"},{n:["kiss","couplekiss"],u:"1f48f",v:["1f48f-1f3fb","1f48f-1f3fc","1f48f-1f3fd","1f48f-1f3fe","1f48f-1f3ff","1f9d1-1f3fb-200d-2764-fe0f-200d-1f48b-200d-1f9d1-1f3fc","1f9d1-1f3fb-200d-2764-fe0f-200d-1f48b-200d-1f9d1-1f3fd","1f9d1-1f3fb-200d-2764-fe0f-200d-1f48b-200d-1f9d1-1f3fe","1f9d1-1f3fb-200d-2764-fe0f-200d-1f48b-200d-1f9d1-1f3ff","1f9d1-1f3fc-200d-2764-fe0f-200d-1f48b-200d-1f9d1-1f3fb","1f9d1-1f3fc-200d-2764-fe0f-200d-1f48b-200d-1f9d1-1f3fd","1f9d1-1f3fc-200d-2764-fe0f-200d-1f48b-200d-1f9d1-1f3fe","1f9d1-1f3fc-200d-2764-fe0f-200d-1f48b-200d-1f9d1-1f3ff","1f9d1-1f3fd-200d-2764-fe0f-200d-1f48b-200d-1f9d1-1f3fb","1f9d1-1f3fd-200d-2764-fe0f-200d-1f48b-200d-1f9d1-1f3fc","1f9d1-1f3fd-200d-2764-fe0f-200d-1f48b-200d-1f9d1-1f3fe","1f9d1-1f3fd-200d-2764-fe0f-200d-1f48b-200d-1f9d1-1f3ff","1f9d1-1f3fe-200d-2764-fe0f-200d-1f48b-200d-1f9d1-1f3fb","1f9d1-1f3fe-200d-2764-fe0f-200d-1f48b-200d-1f9d1-1f3fc","1f9d1-1f3fe-200d-2764-fe0f-200d-1f48b-200d-1f9d1-1f3fd","1f9d1-1f3fe-200d-2764-fe0f-200d-1f48b-200d-1f9d1-1f3ff","1f9d1-1f3ff-200d-2764-fe0f-200d-1f48b-200d-1f9d1-1f3fb","1f9d1-1f3ff-200d-2764-fe0f-200d-1f48b-200d-1f9d1-1f3fc","1f9d1-1f3ff-200d-2764-fe0f-200d-1f48b-200d-1f9d1-1f3fd","1f9d1-1f3ff-200d-2764-fe0f-200d-1f48b-200d-1f9d1-1f3fe"],a:"0.6"},{n:["woman-kiss-man","kiss: woman, man"],u:"1f469-200d-2764-fe0f-200d-1f48b-200d-1f468",v:["1f469-1f3fb-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fb","1f469-1f3fb-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fc","1f469-1f3fb-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fd","1f469-1f3fb-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fe","1f469-1f3fb-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3ff","1f469-1f3fc-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fb","1f469-1f3fc-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fc","1f469-1f3fc-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fd","1f469-1f3fc-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fe","1f469-1f3fc-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3ff","1f469-1f3fd-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fb","1f469-1f3fd-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fc","1f469-1f3fd-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fd","1f469-1f3fd-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fe","1f469-1f3fd-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3ff","1f469-1f3fe-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fb","1f469-1f3fe-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fc","1f469-1f3fe-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fd","1f469-1f3fe-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fe","1f469-1f3fe-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3ff","1f469-1f3ff-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fb","1f469-1f3ff-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fc","1f469-1f3ff-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fd","1f469-1f3ff-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fe","1f469-1f3ff-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3ff"],a:"2.0"},{n:["man-kiss-man","kiss: man, man"],u:"1f468-200d-2764-fe0f-200d-1f48b-200d-1f468",v:["1f468-1f3fb-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fb","1f468-1f3fb-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fc","1f468-1f3fb-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fd","1f468-1f3fb-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fe","1f468-1f3fb-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3ff","1f468-1f3fc-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fb","1f468-1f3fc-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fc","1f468-1f3fc-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fd","1f468-1f3fc-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fe","1f468-1f3fc-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3ff","1f468-1f3fd-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fb","1f468-1f3fd-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fc","1f468-1f3fd-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fd","1f468-1f3fd-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fe","1f468-1f3fd-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3ff","1f468-1f3fe-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fb","1f468-1f3fe-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fc","1f468-1f3fe-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fd","1f468-1f3fe-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fe","1f468-1f3fe-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3ff","1f468-1f3ff-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fb","1f468-1f3ff-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fc","1f468-1f3ff-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fd","1f468-1f3ff-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fe","1f468-1f3ff-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3ff"],a:"2.0"},{n:["woman-kiss-woman","kiss: woman, woman"],u:"1f469-200d-2764-fe0f-200d-1f48b-200d-1f469",v:["1f469-1f3fb-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3fb","1f469-1f3fb-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3fc","1f469-1f3fb-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3fd","1f469-1f3fb-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3fe","1f469-1f3fb-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3ff","1f469-1f3fc-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3fb","1f469-1f3fc-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3fc","1f469-1f3fc-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3fd","1f469-1f3fc-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3fe","1f469-1f3fc-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3ff","1f469-1f3fd-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3fb","1f469-1f3fd-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3fc","1f469-1f3fd-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3fd","1f469-1f3fd-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3fe","1f469-1f3fd-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3ff","1f469-1f3fe-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3fb","1f469-1f3fe-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3fc","1f469-1f3fe-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3fd","1f469-1f3fe-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3fe","1f469-1f3fe-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3ff","1f469-1f3ff-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3fb","1f469-1f3ff-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3fc","1f469-1f3ff-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3fd","1f469-1f3ff-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3fe","1f469-1f3ff-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3ff"],a:"2.0"},{n:["couple with heart"],u:"1f491",v:["1f491-1f3fb","1f491-1f3fc","1f491-1f3fd","1f491-1f3fe","1f491-1f3ff","1f9d1-1f3fb-200d-2764-fe0f-200d-1f9d1-1f3fc","1f9d1-1f3fb-200d-2764-fe0f-200d-1f9d1-1f3fd","1f9d1-1f3fb-200d-2764-fe0f-200d-1f9d1-1f3fe","1f9d1-1f3fb-200d-2764-fe0f-200d-1f9d1-1f3ff","1f9d1-1f3fc-200d-2764-fe0f-200d-1f9d1-1f3fb","1f9d1-1f3fc-200d-2764-fe0f-200d-1f9d1-1f3fd","1f9d1-1f3fc-200d-2764-fe0f-200d-1f9d1-1f3fe","1f9d1-1f3fc-200d-2764-fe0f-200d-1f9d1-1f3ff","1f9d1-1f3fd-200d-2764-fe0f-200d-1f9d1-1f3fb","1f9d1-1f3fd-200d-2764-fe0f-200d-1f9d1-1f3fc","1f9d1-1f3fd-200d-2764-fe0f-200d-1f9d1-1f3fe","1f9d1-1f3fd-200d-2764-fe0f-200d-1f9d1-1f3ff","1f9d1-1f3fe-200d-2764-fe0f-200d-1f9d1-1f3fb","1f9d1-1f3fe-200d-2764-fe0f-200d-1f9d1-1f3fc","1f9d1-1f3fe-200d-2764-fe0f-200d-1f9d1-1f3fd","1f9d1-1f3fe-200d-2764-fe0f-200d-1f9d1-1f3ff","1f9d1-1f3ff-200d-2764-fe0f-200d-1f9d1-1f3fb","1f9d1-1f3ff-200d-2764-fe0f-200d-1f9d1-1f3fc","1f9d1-1f3ff-200d-2764-fe0f-200d-1f9d1-1f3fd","1f9d1-1f3ff-200d-2764-fe0f-200d-1f9d1-1f3fe"],a:"0.6"},{n:["woman-heart-man","couple with heart: woman, man"],u:"1f469-200d-2764-fe0f-200d-1f468",v:["1f469-1f3fb-200d-2764-fe0f-200d-1f468-1f3fb","1f469-1f3fb-200d-2764-fe0f-200d-1f468-1f3fc","1f469-1f3fb-200d-2764-fe0f-200d-1f468-1f3fd","1f469-1f3fb-200d-2764-fe0f-200d-1f468-1f3fe","1f469-1f3fb-200d-2764-fe0f-200d-1f468-1f3ff","1f469-1f3fc-200d-2764-fe0f-200d-1f468-1f3fb","1f469-1f3fc-200d-2764-fe0f-200d-1f468-1f3fc","1f469-1f3fc-200d-2764-fe0f-200d-1f468-1f3fd","1f469-1f3fc-200d-2764-fe0f-200d-1f468-1f3fe","1f469-1f3fc-200d-2764-fe0f-200d-1f468-1f3ff","1f469-1f3fd-200d-2764-fe0f-200d-1f468-1f3fb","1f469-1f3fd-200d-2764-fe0f-200d-1f468-1f3fc","1f469-1f3fd-200d-2764-fe0f-200d-1f468-1f3fd","1f469-1f3fd-200d-2764-fe0f-200d-1f468-1f3fe","1f469-1f3fd-200d-2764-fe0f-200d-1f468-1f3ff","1f469-1f3fe-200d-2764-fe0f-200d-1f468-1f3fb","1f469-1f3fe-200d-2764-fe0f-200d-1f468-1f3fc","1f469-1f3fe-200d-2764-fe0f-200d-1f468-1f3fd","1f469-1f3fe-200d-2764-fe0f-200d-1f468-1f3fe","1f469-1f3fe-200d-2764-fe0f-200d-1f468-1f3ff","1f469-1f3ff-200d-2764-fe0f-200d-1f468-1f3fb","1f469-1f3ff-200d-2764-fe0f-200d-1f468-1f3fc","1f469-1f3ff-200d-2764-fe0f-200d-1f468-1f3fd","1f469-1f3ff-200d-2764-fe0f-200d-1f468-1f3fe","1f469-1f3ff-200d-2764-fe0f-200d-1f468-1f3ff"],a:"2.0"},{n:["man-heart-man","couple with heart: man, man"],u:"1f468-200d-2764-fe0f-200d-1f468",v:["1f468-1f3fb-200d-2764-fe0f-200d-1f468-1f3fb","1f468-1f3fb-200d-2764-fe0f-200d-1f468-1f3fc","1f468-1f3fb-200d-2764-fe0f-200d-1f468-1f3fd","1f468-1f3fb-200d-2764-fe0f-200d-1f468-1f3fe","1f468-1f3fb-200d-2764-fe0f-200d-1f468-1f3ff","1f468-1f3fc-200d-2764-fe0f-200d-1f468-1f3fb","1f468-1f3fc-200d-2764-fe0f-200d-1f468-1f3fc","1f468-1f3fc-200d-2764-fe0f-200d-1f468-1f3fd","1f468-1f3fc-200d-2764-fe0f-200d-1f468-1f3fe","1f468-1f3fc-200d-2764-fe0f-200d-1f468-1f3ff","1f468-1f3fd-200d-2764-fe0f-200d-1f468-1f3fb","1f468-1f3fd-200d-2764-fe0f-200d-1f468-1f3fc","1f468-1f3fd-200d-2764-fe0f-200d-1f468-1f3fd","1f468-1f3fd-200d-2764-fe0f-200d-1f468-1f3fe","1f468-1f3fd-200d-2764-fe0f-200d-1f468-1f3ff","1f468-1f3fe-200d-2764-fe0f-200d-1f468-1f3fb","1f468-1f3fe-200d-2764-fe0f-200d-1f468-1f3fc","1f468-1f3fe-200d-2764-fe0f-200d-1f468-1f3fd","1f468-1f3fe-200d-2764-fe0f-200d-1f468-1f3fe","1f468-1f3fe-200d-2764-fe0f-200d-1f468-1f3ff","1f468-1f3ff-200d-2764-fe0f-200d-1f468-1f3fb","1f468-1f3ff-200d-2764-fe0f-200d-1f468-1f3fc","1f468-1f3ff-200d-2764-fe0f-200d-1f468-1f3fd","1f468-1f3ff-200d-2764-fe0f-200d-1f468-1f3fe","1f468-1f3ff-200d-2764-fe0f-200d-1f468-1f3ff"],a:"2.0"},{n:["woman-heart-woman","couple with heart: woman, woman"],u:"1f469-200d-2764-fe0f-200d-1f469",v:["1f469-1f3fb-200d-2764-fe0f-200d-1f469-1f3fb","1f469-1f3fb-200d-2764-fe0f-200d-1f469-1f3fc","1f469-1f3fb-200d-2764-fe0f-200d-1f469-1f3fd","1f469-1f3fb-200d-2764-fe0f-200d-1f469-1f3fe","1f469-1f3fb-200d-2764-fe0f-200d-1f469-1f3ff","1f469-1f3fc-200d-2764-fe0f-200d-1f469-1f3fb","1f469-1f3fc-200d-2764-fe0f-200d-1f469-1f3fc","1f469-1f3fc-200d-2764-fe0f-200d-1f469-1f3fd","1f469-1f3fc-200d-2764-fe0f-200d-1f469-1f3fe","1f469-1f3fc-200d-2764-fe0f-200d-1f469-1f3ff","1f469-1f3fd-200d-2764-fe0f-200d-1f469-1f3fb","1f469-1f3fd-200d-2764-fe0f-200d-1f469-1f3fc","1f469-1f3fd-200d-2764-fe0f-200d-1f469-1f3fd","1f469-1f3fd-200d-2764-fe0f-200d-1f469-1f3fe","1f469-1f3fd-200d-2764-fe0f-200d-1f469-1f3ff","1f469-1f3fe-200d-2764-fe0f-200d-1f469-1f3fb","1f469-1f3fe-200d-2764-fe0f-200d-1f469-1f3fc","1f469-1f3fe-200d-2764-fe0f-200d-1f469-1f3fd","1f469-1f3fe-200d-2764-fe0f-200d-1f469-1f3fe","1f469-1f3fe-200d-2764-fe0f-200d-1f469-1f3ff","1f469-1f3ff-200d-2764-fe0f-200d-1f469-1f3fb","1f469-1f3ff-200d-2764-fe0f-200d-1f469-1f3fc","1f469-1f3ff-200d-2764-fe0f-200d-1f469-1f3fd","1f469-1f3ff-200d-2764-fe0f-200d-1f469-1f3fe","1f469-1f3ff-200d-2764-fe0f-200d-1f469-1f3ff"],a:"2.0"},{n:["family"],u:"1f46a",a:"0.6"},{n:["man-woman-boy","family: man, woman, boy"],u:"1f468-200d-1f469-200d-1f466",a:"2.0"},{n:["man-woman-girl","family: man, woman, girl"],u:"1f468-200d-1f469-200d-1f467",a:"2.0"},{n:["man-woman-girl-boy","family: man, woman, girl, boy"],u:"1f468-200d-1f469-200d-1f467-200d-1f466",a:"2.0"},{n:["man-woman-boy-boy","family: man, woman, boy, boy"],u:"1f468-200d-1f469-200d-1f466-200d-1f466",a:"2.0"},{n:["man-woman-girl-girl","family: man, woman, girl, girl"],u:"1f468-200d-1f469-200d-1f467-200d-1f467",a:"2.0"},{n:["man-man-boy","family: man, man, boy"],u:"1f468-200d-1f468-200d-1f466",a:"2.0"},{n:["man-man-girl","family: man, man, girl"],u:"1f468-200d-1f468-200d-1f467",a:"2.0"},{n:["man-man-girl-boy","family: man, man, girl, boy"],u:"1f468-200d-1f468-200d-1f467-200d-1f466",a:"2.0"},{n:["man-man-boy-boy","family: man, man, boy, boy"],u:"1f468-200d-1f468-200d-1f466-200d-1f466",a:"2.0"},{n:["man-man-girl-girl","family: man, man, girl, girl"],u:"1f468-200d-1f468-200d-1f467-200d-1f467",a:"2.0"},{n:["woman-woman-boy","family: woman, woman, boy"],u:"1f469-200d-1f469-200d-1f466",a:"2.0"},{n:["woman-woman-girl","family: woman, woman, girl"],u:"1f469-200d-1f469-200d-1f467",a:"2.0"},{n:["woman-woman-girl-boy","family: woman, woman, girl, boy"],u:"1f469-200d-1f469-200d-1f467-200d-1f466",a:"2.0"},{n:["woman-woman-boy-boy","family: woman, woman, boy, boy"],u:"1f469-200d-1f469-200d-1f466-200d-1f466",a:"2.0"},{n:["woman-woman-girl-girl","family: woman, woman, girl, girl"],u:"1f469-200d-1f469-200d-1f467-200d-1f467",a:"2.0"},{n:["man-boy","family: man, boy"],u:"1f468-200d-1f466",a:"4.0"},{n:["man-boy-boy","family: man, boy, boy"],u:"1f468-200d-1f466-200d-1f466",a:"4.0"},{n:["man-girl","family: man, girl"],u:"1f468-200d-1f467",a:"4.0"},{n:["man-girl-boy","family: man, girl, boy"],u:"1f468-200d-1f467-200d-1f466",a:"4.0"},{n:["man-girl-girl","family: man, girl, girl"],u:"1f468-200d-1f467-200d-1f467",a:"4.0"},{n:["woman-boy","family: woman, boy"],u:"1f469-200d-1f466",a:"4.0"},{n:["woman-boy-boy","family: woman, boy, boy"],u:"1f469-200d-1f466-200d-1f466",a:"4.0"},{n:["woman-girl","family: woman, girl"],u:"1f469-200d-1f467",a:"4.0"},{n:["woman-girl-boy","family: woman, girl, boy"],u:"1f469-200d-1f467-200d-1f466",a:"4.0"},{n:["woman-girl-girl","family: woman, girl, girl"],u:"1f469-200d-1f467-200d-1f467",a:"4.0"},{n:["speaking head","speaking head in silhouette"],u:"1f5e3-fe0f",a:"0.7"},{n:["bust in silhouette"],u:"1f464",a:"0.6"},{n:["busts in silhouette"],u:"1f465",a:"1.0"},{n:["people hugging"],u:"1fac2",a:"13.0"},{n:["footprints"],u:"1f463",a:"0.6"}],ySe=[{n:["monkey face"],u:"1f435",a:"0.6"},{n:["monkey"],u:"1f412",a:"0.6"},{n:["gorilla"],u:"1f98d",a:"3.0"},{n:["orangutan"],u:"1f9a7",a:"12.0"},{n:["dog","dog face"],u:"1f436",a:"0.6"},{n:["dog","dog2"],u:"1f415",a:"0.7"},{n:["guide dog"],u:"1f9ae",a:"12.0"},{n:["service dog"],u:"1f415-200d-1f9ba",a:"12.0"},{n:["poodle"],u:"1f429",a:"0.6"},{n:["wolf","wolf face"],u:"1f43a",a:"0.6"},{n:["fox face"],u:"1f98a",a:"3.0"},{n:["raccoon"],u:"1f99d",a:"11.0"},{n:["cat","cat face"],u:"1f431",a:"0.6"},{n:["cat","cat2"],u:"1f408",a:"0.7"},{n:["black cat"],u:"1f408-200d-2b1b",a:"13.0"},{n:["lion face"],u:"1f981",a:"1.0"},{n:["tiger","tiger face"],u:"1f42f",a:"0.6"},{n:["tiger","tiger2"],u:"1f405",a:"1.0"},{n:["leopard"],u:"1f406",a:"1.0"},{n:["horse","horse face"],u:"1f434",a:"0.6"},{n:["horse","racehorse"],u:"1f40e",a:"0.6"},{n:["unicorn face"],u:"1f984",a:"1.0"},{n:["zebra face"],u:"1f993",a:"5.0"},{n:["deer"],u:"1f98c",a:"3.0"},{n:["bison"],u:"1f9ac",a:"13.0"},{n:["cow","cow face"],u:"1f42e",a:"0.6"},{n:["ox"],u:"1f402",a:"1.0"},{n:["water buffalo"],u:"1f403",a:"1.0"},{n:["cow","cow2"],u:"1f404",a:"1.0"},{n:["pig","pig face"],u:"1f437",a:"0.6"},{n:["pig","pig2"],u:"1f416",a:"1.0"},{n:["boar"],u:"1f417",a:"0.6"},{n:["pig nose"],u:"1f43d",a:"0.6"},{n:["ram"],u:"1f40f",a:"1.0"},{n:["sheep"],u:"1f411",a:"0.6"},{n:["goat"],u:"1f410",a:"1.0"},{n:["dromedary camel"],u:"1f42a",a:"1.0"},{n:["camel","bactrian camel"],u:"1f42b",a:"0.6"},{n:["llama"],u:"1f999",a:"11.0"},{n:["giraffe face"],u:"1f992",a:"5.0"},{n:["elephant"],u:"1f418",a:"0.6"},{n:["mammoth"],u:"1f9a3",a:"13.0"},{n:["rhinoceros"],u:"1f98f",a:"3.0"},{n:["hippopotamus"],u:"1f99b",a:"11.0"},{n:["mouse","mouse face"],u:"1f42d",a:"0.6"},{n:["mouse","mouse2"],u:"1f401",a:"1.0"},{n:["rat"],u:"1f400",a:"1.0"},{n:["hamster","hamster face"],u:"1f439",a:"0.6"},{n:["rabbit","rabbit face"],u:"1f430",a:"0.6"},{n:["rabbit","rabbit2"],u:"1f407",a:"1.0"},{n:["chipmunk"],u:"1f43f-fe0f",a:"0.7"},{n:["beaver"],u:"1f9ab",a:"13.0"},{n:["hedgehog"],u:"1f994",a:"5.0"},{n:["bat"],u:"1f987",a:"3.0"},{n:["bear","bear face"],u:"1f43b",a:"0.6"},{n:["polar bear"],u:"1f43b-200d-2744-fe0f",a:"13.0"},{n:["koala"],u:"1f428",a:"0.6"},{n:["panda face"],u:"1f43c",a:"0.6"},{n:["sloth"],u:"1f9a5",a:"12.0"},{n:["otter"],u:"1f9a6",a:"12.0"},{n:["skunk"],u:"1f9a8",a:"12.0"},{n:["kangaroo"],u:"1f998",a:"11.0"},{n:["badger"],u:"1f9a1",a:"11.0"},{n:["feet","paw prints"],u:"1f43e",a:"0.6"},{n:["turkey"],u:"1f983",a:"1.0"},{n:["chicken"],u:"1f414",a:"0.6"},{n:["rooster"],u:"1f413",a:"1.0"},{n:["hatching chick"],u:"1f423",a:"0.6"},{n:["baby chick"],u:"1f424",a:"0.6"},{n:["hatched chick","front-facing baby chick"],u:"1f425",a:"0.6"},{n:["bird"],u:"1f426",a:"0.6"},{n:["penguin"],u:"1f427",a:"0.6"},{n:["dove","dove of peace"],u:"1f54a-fe0f",a:"0.7"},{n:["eagle"],u:"1f985",a:"3.0"},{n:["duck"],u:"1f986",a:"3.0"},{n:["swan"],u:"1f9a2",a:"11.0"},{n:["owl"],u:"1f989",a:"3.0"},{n:["dodo"],u:"1f9a4",a:"13.0"},{n:["feather"],u:"1fab6",a:"13.0"},{n:["flamingo"],u:"1f9a9",a:"12.0"},{n:["peacock"],u:"1f99a",a:"11.0"},{n:["parrot"],u:"1f99c",a:"11.0"},{n:["frog","frog face"],u:"1f438",a:"0.6"},{n:["crocodile"],u:"1f40a",a:"1.0"},{n:["turtle"],u:"1f422",a:"0.6"},{n:["lizard"],u:"1f98e",a:"3.0"},{n:["snake"],u:"1f40d",a:"0.6"},{n:["dragon face"],u:"1f432",a:"0.6"},{n:["dragon"],u:"1f409",a:"1.0"},{n:["sauropod"],u:"1f995",a:"5.0"},{n:["t-rex"],u:"1f996",a:"5.0"},{n:["whale","spouting whale"],u:"1f433",a:"0.6"},{n:["whale","whale2"],u:"1f40b",a:"1.0"},{n:["dolphin","flipper"],u:"1f42c",a:"0.6"},{n:["seal"],u:"1f9ad",a:"13.0"},{n:["fish"],u:"1f41f",a:"0.6"},{n:["tropical fish"],u:"1f420",a:"0.6"},{n:["blowfish"],u:"1f421",a:"0.6"},{n:["shark"],u:"1f988",a:"3.0"},{n:["octopus"],u:"1f419",a:"0.6"},{n:["shell","spiral shell"],u:"1f41a",a:"0.6"},{n:["coral"],u:"1fab8",a:"14.0"},{n:["snail"],u:"1f40c",a:"0.6"},{n:["butterfly"],u:"1f98b",a:"3.0"},{n:["bug"],u:"1f41b",a:"0.6"},{n:["ant"],u:"1f41c",a:"0.6"},{n:["bee","honeybee"],u:"1f41d",a:"0.6"},{n:["beetle"],u:"1fab2",a:"13.0"},{n:["ladybug","lady beetle"],u:"1f41e",a:"0.6"},{n:["cricket"],u:"1f997",a:"5.0"},{n:["cockroach"],u:"1fab3",a:"13.0"},{n:["spider"],u:"1f577-fe0f",a:"0.7"},{n:["spider web"],u:"1f578-fe0f",a:"0.7"},{n:["scorpion"],u:"1f982",a:"1.0"},{n:["mosquito"],u:"1f99f",a:"11.0"},{n:["fly"],u:"1fab0",a:"13.0"},{n:["worm"],u:"1fab1",a:"13.0"},{n:["microbe"],u:"1f9a0",a:"11.0"},{n:["bouquet"],u:"1f490",a:"0.6"},{n:["cherry blossom"],u:"1f338",a:"0.6"},{n:["white flower"],u:"1f4ae",a:"0.6"},{n:["lotus"],u:"1fab7",a:"14.0"},{n:["rosette"],u:"1f3f5-fe0f",a:"0.7"},{n:["rose"],u:"1f339",a:"0.6"},{n:["wilted flower"],u:"1f940",a:"3.0"},{n:["hibiscus"],u:"1f33a",a:"0.6"},{n:["sunflower"],u:"1f33b",a:"0.6"},{n:["blossom"],u:"1f33c",a:"0.6"},{n:["tulip"],u:"1f337",a:"0.6"},{n:["seedling"],u:"1f331",a:"0.6"},{n:["potted plant"],u:"1fab4",a:"13.0"},{n:["evergreen tree"],u:"1f332",a:"1.0"},{n:["deciduous tree"],u:"1f333",a:"1.0"},{n:["palm tree"],u:"1f334",a:"0.6"},{n:["cactus"],u:"1f335",a:"0.6"},{n:["ear of rice"],u:"1f33e",a:"0.6"},{n:["herb"],u:"1f33f",a:"0.6"},{n:["shamrock"],u:"2618-fe0f",a:"1.0"},{n:["four leaf clover"],u:"1f340",a:"0.6"},{n:["maple leaf"],u:"1f341",a:"0.6"},{n:["fallen leaf"],u:"1f342",a:"0.6"},{n:["leaves","leaf fluttering in wind"],u:"1f343",a:"0.6"},{n:["empty nest"],u:"1fab9",a:"14.0"},{n:["nest with eggs"],u:"1faba",a:"14.0"}],TSe=[{n:["grapes"],u:"1f347",a:"0.6"},{n:["melon"],u:"1f348",a:"0.6"},{n:["watermelon"],u:"1f349",a:"0.6"},{n:["tangerine"],u:"1f34a",a:"0.6"},{n:["lemon"],u:"1f34b",a:"1.0"},{n:["banana"],u:"1f34c",a:"0.6"},{n:["pineapple"],u:"1f34d",a:"0.6"},{n:["mango"],u:"1f96d",a:"11.0"},{n:["apple","red apple"],u:"1f34e",a:"0.6"},{n:["green apple"],u:"1f34f",a:"0.6"},{n:["pear"],u:"1f350",a:"1.0"},{n:["peach"],u:"1f351",a:"0.6"},{n:["cherries"],u:"1f352",a:"0.6"},{n:["strawberry"],u:"1f353",a:"0.6"},{n:["blueberries"],u:"1fad0",a:"13.0"},{n:["kiwifruit"],u:"1f95d",a:"3.0"},{n:["tomato"],u:"1f345",a:"0.6"},{n:["olive"],u:"1fad2",a:"13.0"},{n:["coconut"],u:"1f965",a:"5.0"},{n:["avocado"],u:"1f951",a:"3.0"},{n:["eggplant","aubergine"],u:"1f346",a:"0.6"},{n:["potato"],u:"1f954",a:"3.0"},{n:["carrot"],u:"1f955",a:"3.0"},{n:["corn","ear of maize"],u:"1f33d",a:"0.6"},{n:["hot pepper"],u:"1f336-fe0f",a:"0.7"},{n:["bell pepper"],u:"1fad1",a:"13.0"},{n:["cucumber"],u:"1f952",a:"3.0"},{n:["leafy green"],u:"1f96c",a:"11.0"},{n:["broccoli"],u:"1f966",a:"5.0"},{n:["garlic"],u:"1f9c4",a:"12.0"},{n:["onion"],u:"1f9c5",a:"12.0"},{n:["mushroom"],u:"1f344",a:"0.6"},{n:["peanuts"],u:"1f95c",a:"3.0"},{n:["beans"],u:"1fad8",a:"14.0"},{n:["chestnut"],u:"1f330",a:"0.6"},{n:["bread"],u:"1f35e",a:"0.6"},{n:["croissant"],u:"1f950",a:"3.0"},{n:["baguette bread"],u:"1f956",a:"3.0"},{n:["flatbread"],u:"1fad3",a:"13.0"},{n:["pretzel"],u:"1f968",a:"5.0"},{n:["bagel"],u:"1f96f",a:"11.0"},{n:["pancakes"],u:"1f95e",a:"3.0"},{n:["waffle"],u:"1f9c7",a:"12.0"},{n:["cheese wedge"],u:"1f9c0",a:"1.0"},{n:["meat on bone"],u:"1f356",a:"0.6"},{n:["poultry leg"],u:"1f357",a:"0.6"},{n:["cut of meat"],u:"1f969",a:"5.0"},{n:["bacon"],u:"1f953",a:"3.0"},{n:["hamburger"],u:"1f354",a:"0.6"},{n:["fries","french fries"],u:"1f35f",a:"0.6"},{n:["pizza","slice of pizza"],u:"1f355",a:"0.6"},{n:["hotdog","hot dog"],u:"1f32d",a:"1.0"},{n:["sandwich"],u:"1f96a",a:"5.0"},{n:["taco"],u:"1f32e",a:"1.0"},{n:["burrito"],u:"1f32f",a:"1.0"},{n:["tamale"],u:"1fad4",a:"13.0"},{n:["stuffed flatbread"],u:"1f959",a:"3.0"},{n:["falafel"],u:"1f9c6",a:"12.0"},{n:["egg"],u:"1f95a",a:"3.0"},{n:["cooking","fried egg"],u:"1f373",a:"0.6"},{n:["shallow pan of food"],u:"1f958",a:"3.0"},{n:["stew","pot of food"],u:"1f372",a:"0.6"},{n:["fondue"],u:"1fad5",a:"13.0"},{n:["bowl with spoon"],u:"1f963",a:"5.0"},{n:["green salad"],u:"1f957",a:"3.0"},{n:["popcorn"],u:"1f37f",a:"1.0"},{n:["butter"],u:"1f9c8",a:"12.0"},{n:["salt","salt shaker"],u:"1f9c2",a:"11.0"},{n:["canned food"],u:"1f96b",a:"5.0"},{n:["bento","bento box"],u:"1f371",a:"0.6"},{n:["rice cracker"],u:"1f358",a:"0.6"},{n:["rice ball"],u:"1f359",a:"0.6"},{n:["rice","cooked rice"],u:"1f35a",a:"0.6"},{n:["curry","curry and rice"],u:"1f35b",a:"0.6"},{n:["ramen","steaming bowl"],u:"1f35c",a:"0.6"},{n:["spaghetti"],u:"1f35d",a:"0.6"},{n:["sweet potato","roasted sweet potato"],u:"1f360",a:"0.6"},{n:["oden"],u:"1f362",a:"0.6"},{n:["sushi"],u:"1f363",a:"0.6"},{n:["fried shrimp"],u:"1f364",a:"0.6"},{n:["fish cake","fish cake with swirl design"],u:"1f365",a:"0.6"},{n:["moon cake"],u:"1f96e",a:"11.0"},{n:["dango"],u:"1f361",a:"0.6"},{n:["dumpling"],u:"1f95f",a:"5.0"},{n:["fortune cookie"],u:"1f960",a:"5.0"},{n:["takeout box"],u:"1f961",a:"5.0"},{n:["crab"],u:"1f980",a:"1.0"},{n:["lobster"],u:"1f99e",a:"11.0"},{n:["shrimp"],u:"1f990",a:"3.0"},{n:["squid"],u:"1f991",a:"3.0"},{n:["oyster"],u:"1f9aa",a:"12.0"},{n:["icecream","soft ice cream"],u:"1f366",a:"0.6"},{n:["shaved ice"],u:"1f367",a:"0.6"},{n:["ice cream"],u:"1f368",a:"0.6"},{n:["doughnut"],u:"1f369",a:"0.6"},{n:["cookie"],u:"1f36a",a:"0.6"},{n:["birthday","birthday cake"],u:"1f382",a:"0.6"},{n:["cake","shortcake"],u:"1f370",a:"0.6"},{n:["cupcake"],u:"1f9c1",a:"11.0"},{n:["pie"],u:"1f967",a:"5.0"},{n:["chocolate bar"],u:"1f36b",a:"0.6"},{n:["candy"],u:"1f36c",a:"0.6"},{n:["lollipop"],u:"1f36d",a:"0.6"},{n:["custard"],u:"1f36e",a:"0.6"},{n:["honey pot"],u:"1f36f",a:"0.6"},{n:["baby bottle"],u:"1f37c",a:"1.0"},{n:["glass of milk"],u:"1f95b",a:"3.0"},{n:["coffee","hot beverage"],u:"2615",a:"0.6"},{n:["teapot"],u:"1fad6",a:"13.0"},{n:["tea","teacup without handle"],u:"1f375",a:"0.6"},{n:["sake","sake bottle and cup"],u:"1f376",a:"0.6"},{n:["champagne","bottle with popping cork"],u:"1f37e",a:"1.0"},{n:["wine glass"],u:"1f377",a:"0.6"},{n:["cocktail","cocktail glass"],u:"1f378",a:"0.6"},{n:["tropical drink"],u:"1f379",a:"0.6"},{n:["beer","beer mug"],u:"1f37a",a:"0.6"},{n:["beers","clinking beer mugs"],u:"1f37b",a:"0.6"},{n:["clinking glasses"],u:"1f942",a:"3.0"},{n:["tumbler glass"],u:"1f943",a:"3.0"},{n:["pouring liquid"],u:"1fad7",a:"14.0"},{n:["cup with straw"],u:"1f964",a:"5.0"},{n:["bubble tea"],u:"1f9cb",a:"13.0"},{n:["beverage box"],u:"1f9c3",a:"12.0"},{n:["mate drink"],u:"1f9c9",a:"12.0"},{n:["ice cube"],u:"1f9ca",a:"12.0"},{n:["chopsticks"],u:"1f962",a:"5.0"},{n:["knife fork plate","fork and knife with plate"],u:"1f37d-fe0f",a:"0.7"},{n:["fork and knife"],u:"1f374",a:"0.6"},{n:["spoon"],u:"1f944",a:"3.0"},{n:["hocho","knife"],u:"1f52a",a:"0.6"},{n:["jar"],u:"1fad9",a:"14.0"},{n:["amphora"],u:"1f3fa",a:"1.0"}],bSe=[{n:["earth africa","earth globe europe-africa"],u:"1f30d",a:"0.7"},{n:["earth americas","earth globe americas"],u:"1f30e",a:"0.7"},{n:["earth asia","earth globe asia-australia"],u:"1f30f",a:"0.6"},{n:["globe with meridians"],u:"1f310",a:"1.0"},{n:["world map"],u:"1f5fa-fe0f",a:"0.7"},{n:["japan","silhouette of japan"],u:"1f5fe",a:"0.6"},{n:["compass"],u:"1f9ed",a:"11.0"},{n:["snow-capped mountain","snow capped mountain"],u:"1f3d4-fe0f",a:"0.7"},{n:["mountain"],u:"26f0-fe0f",a:"0.7"},{n:["volcano"],u:"1f30b",a:"0.6"},{n:["mount fuji"],u:"1f5fb",a:"0.6"},{n:["camping"],u:"1f3d5-fe0f",a:"0.7"},{n:["beach with umbrella"],u:"1f3d6-fe0f",a:"0.7"},{n:["desert"],u:"1f3dc-fe0f",a:"0.7"},{n:["desert island"],u:"1f3dd-fe0f",a:"0.7"},{n:["national park"],u:"1f3de-fe0f",a:"0.7"},{n:["stadium"],u:"1f3df-fe0f",a:"0.7"},{n:["classical building"],u:"1f3db-fe0f",a:"0.7"},{n:["building construction"],u:"1f3d7-fe0f",a:"0.7"},{n:["brick","bricks"],u:"1f9f1",a:"11.0"},{n:["rock"],u:"1faa8",a:"13.0"},{n:["wood"],u:"1fab5",a:"13.0"},{n:["hut"],u:"1f6d6",a:"13.0"},{n:["houses","house buildings"],u:"1f3d8-fe0f",a:"0.7"},{n:["derelict house","derelict house building"],u:"1f3da-fe0f",a:"0.7"},{n:["house","house building"],u:"1f3e0",a:"0.6"},{n:["house with garden"],u:"1f3e1",a:"0.6"},{n:["office","office building"],u:"1f3e2",a:"0.6"},{n:["post office","japanese post office"],u:"1f3e3",a:"0.6"},{n:["european post office"],u:"1f3e4",a:"1.0"},{n:["hospital"],u:"1f3e5",a:"0.6"},{n:["bank"],u:"1f3e6",a:"0.6"},{n:["hotel"],u:"1f3e8",a:"0.6"},{n:["love hotel"],u:"1f3e9",a:"0.6"},{n:["convenience store"],u:"1f3ea",a:"0.6"},{n:["school"],u:"1f3eb",a:"0.6"},{n:["department store"],u:"1f3ec",a:"0.6"},{n:["factory"],u:"1f3ed",a:"0.6"},{n:["japanese castle"],u:"1f3ef",a:"0.6"},{n:["european castle"],u:"1f3f0",a:"0.6"},{n:["wedding"],u:"1f492",a:"0.6"},{n:["tokyo tower"],u:"1f5fc",a:"0.6"},{n:["statue of liberty"],u:"1f5fd",a:"0.6"},{n:["church"],u:"26ea",a:"0.6"},{n:["mosque"],u:"1f54c",a:"1.0"},{n:["hindu temple"],u:"1f6d5",a:"12.0"},{n:["synagogue"],u:"1f54d",a:"1.0"},{n:["shinto shrine"],u:"26e9-fe0f",a:"0.7"},{n:["kaaba"],u:"1f54b",a:"1.0"},{n:["fountain"],u:"26f2",a:"0.6"},{n:["tent"],u:"26fa",a:"0.6"},{n:["foggy"],u:"1f301",a:"0.6"},{n:["night with stars"],u:"1f303",a:"0.6"},{n:["cityscape"],u:"1f3d9-fe0f",a:"0.7"},{n:["sunrise over mountains"],u:"1f304",a:"0.6"},{n:["sunrise"],u:"1f305",a:"0.6"},{n:["city sunset","cityscape at dusk"],u:"1f306",a:"0.6"},{n:["city sunrise","sunset over buildings"],u:"1f307",a:"0.6"},{n:["bridge at night"],u:"1f309",a:"0.6"},{n:["hotsprings","hot springs"],u:"2668-fe0f",a:"0.6"},{n:["carousel horse"],u:"1f3a0",a:"0.6"},{n:["playground slide"],u:"1f6dd",a:"14.0"},{n:["ferris wheel"],u:"1f3a1",a:"0.6"},{n:["roller coaster"],u:"1f3a2",a:"0.6"},{n:["barber","barber pole"],u:"1f488",a:"0.6"},{n:["circus tent"],u:"1f3aa",a:"0.6"},{n:["steam locomotive"],u:"1f682",a:"1.0"},{n:["railway car"],u:"1f683",a:"0.6"},{n:["high-speed train","bullettrain side"],u:"1f684",a:"0.6"},{n:["bullettrain front","high-speed train with bullet nose"],u:"1f685",a:"0.6"},{n:["train","train2"],u:"1f686",a:"1.0"},{n:["metro"],u:"1f687",a:"0.6"},{n:["light rail"],u:"1f688",a:"1.0"},{n:["station"],u:"1f689",a:"0.6"},{n:["tram"],u:"1f68a",a:"1.0"},{n:["monorail"],u:"1f69d",a:"1.0"},{n:["mountain railway"],u:"1f69e",a:"1.0"},{n:["train","tram car"],u:"1f68b",a:"1.0"},{n:["bus"],u:"1f68c",a:"0.6"},{n:["oncoming bus"],u:"1f68d",a:"0.7"},{n:["trolleybus"],u:"1f68e",a:"1.0"},{n:["minibus"],u:"1f690",a:"1.0"},{n:["ambulance"],u:"1f691",a:"0.6"},{n:["fire engine"],u:"1f692",a:"0.6"},{n:["police car"],u:"1f693",a:"0.6"},{n:["oncoming police car"],u:"1f694",a:"0.7"},{n:["taxi"],u:"1f695",a:"0.6"},{n:["oncoming taxi"],u:"1f696",a:"1.0"},{n:["car","red car","automobile"],u:"1f697",a:"0.6"},{n:["oncoming automobile"],u:"1f698",a:"0.7"},{n:["blue car","recreational vehicle"],u:"1f699",a:"0.6"},{n:["pickup truck"],u:"1f6fb",a:"13.0"},{n:["truck","delivery truck"],u:"1f69a",a:"0.6"},{n:["articulated lorry"],u:"1f69b",a:"1.0"},{n:["tractor"],u:"1f69c",a:"1.0"},{n:["racing car"],u:"1f3ce-fe0f",a:"0.7"},{n:["motorcycle","racing motorcycle"],u:"1f3cd-fe0f",a:"0.7"},{n:["motor scooter"],u:"1f6f5",a:"3.0"},{n:["manual wheelchair"],u:"1f9bd",a:"12.0"},{n:["motorized wheelchair"],u:"1f9bc",a:"12.0"},{n:["auto rickshaw"],u:"1f6fa",a:"12.0"},{n:["bike","bicycle"],u:"1f6b2",a:"0.6"},{n:["scooter"],u:"1f6f4",a:"3.0"},{n:["skateboard"],u:"1f6f9",a:"11.0"},{n:["roller skate"],u:"1f6fc",a:"13.0"},{n:["busstop","bus stop"],u:"1f68f",a:"0.6"},{n:["motorway"],u:"1f6e3-fe0f",a:"0.7"},{n:["railway track"],u:"1f6e4-fe0f",a:"0.7"},{n:["oil drum"],u:"1f6e2-fe0f",a:"0.7"},{n:["fuelpump","fuel pump"],u:"26fd",a:"0.6"},{n:["wheel"],u:"1f6de",a:"14.0"},{n:["rotating light","police cars revolving light"],u:"1f6a8",a:"0.6"},{n:["traffic light","horizontal traffic light"],u:"1f6a5",a:"0.6"},{n:["vertical traffic light"],u:"1f6a6",a:"1.0"},{n:["octagonal sign"],u:"1f6d1",a:"3.0"},{n:["construction","construction sign"],u:"1f6a7",a:"0.6"},{n:["anchor"],u:"2693",a:"0.6"},{n:["ring buoy"],u:"1f6df",a:"14.0"},{n:["boat","sailboat"],u:"26f5",a:"0.6"},{n:["canoe"],u:"1f6f6",a:"3.0"},{n:["speedboat"],u:"1f6a4",a:"0.6"},{n:["passenger ship"],u:"1f6f3-fe0f",a:"0.7"},{n:["ferry"],u:"26f4-fe0f",a:"0.7"},{n:["motor boat"],u:"1f6e5-fe0f",a:"0.7"},{n:["ship"],u:"1f6a2",a:"0.6"},{n:["airplane"],u:"2708-fe0f",a:"0.6"},{n:["small airplane"],u:"1f6e9-fe0f",a:"0.7"},{n:["airplane departure"],u:"1f6eb",a:"1.0"},{n:["airplane arriving"],u:"1f6ec",a:"1.0"},{n:["parachute"],u:"1fa82",a:"12.0"},{n:["seat"],u:"1f4ba",a:"0.6"},{n:["helicopter"],u:"1f681",a:"1.0"},{n:["suspension railway"],u:"1f69f",a:"1.0"},{n:["mountain cableway"],u:"1f6a0",a:"1.0"},{n:["aerial tramway"],u:"1f6a1",a:"1.0"},{n:["satellite"],u:"1f6f0-fe0f",a:"0.7"},{n:["rocket"],u:"1f680",a:"0.6"},{n:["flying saucer"],u:"1f6f8",a:"5.0"},{n:["bellhop bell"],u:"1f6ce-fe0f",a:"0.7"},{n:["luggage"],u:"1f9f3",a:"11.0"},{n:["hourglass"],u:"231b",a:"0.6"},{n:["hourglass flowing sand","hourglass with flowing sand"],u:"23f3",a:"0.6"},{n:["watch"],u:"231a",a:"0.6"},{n:["alarm clock"],u:"23f0",a:"0.6"},{n:["stopwatch"],u:"23f1-fe0f",a:"1.0"},{n:["timer clock"],u:"23f2-fe0f",a:"1.0"},{n:["mantelpiece clock"],u:"1f570-fe0f",a:"0.7"},{n:["clock12","clock face twelve oclock"],u:"1f55b",a:"0.6"},{n:["clock1230","clock face twelve-thirty"],u:"1f567",a:"0.7"},{n:["clock1","clock face one oclock"],u:"1f550",a:"0.6"},{n:["clock130","clock face one-thirty"],u:"1f55c",a:"0.7"},{n:["clock2","clock face two oclock"],u:"1f551",a:"0.6"},{n:["clock230","clock face two-thirty"],u:"1f55d",a:"0.7"},{n:["clock3","clock face three oclock"],u:"1f552",a:"0.6"},{n:["clock330","clock face three-thirty"],u:"1f55e",a:"0.7"},{n:["clock4","clock face four oclock"],u:"1f553",a:"0.6"},{n:["clock430","clock face four-thirty"],u:"1f55f",a:"0.7"},{n:["clock5","clock face five oclock"],u:"1f554",a:"0.6"},{n:["clock530","clock face five-thirty"],u:"1f560",a:"0.7"},{n:["clock6","clock face six oclock"],u:"1f555",a:"0.6"},{n:["clock630","clock face six-thirty"],u:"1f561",a:"0.7"},{n:["clock7","clock face seven oclock"],u:"1f556",a:"0.6"},{n:["clock730","clock face seven-thirty"],u:"1f562",a:"0.7"},{n:["clock8","clock face eight oclock"],u:"1f557",a:"0.6"},{n:["clock830","clock face eight-thirty"],u:"1f563",a:"0.7"},{n:["clock9","clock face nine oclock"],u:"1f558",a:"0.6"},{n:["clock930","clock face nine-thirty"],u:"1f564",a:"0.7"},{n:["clock10","clock face ten oclock"],u:"1f559",a:"0.6"},{n:["clock1030","clock face ten-thirty"],u:"1f565",a:"0.7"},{n:["clock11","clock face eleven oclock"],u:"1f55a",a:"0.6"},{n:["clock1130","clock face eleven-thirty"],u:"1f566",a:"0.7"},{n:["new moon","new moon symbol"],u:"1f311",a:"0.6"},{n:["waxing crescent moon","waxing crescent moon symbol"],u:"1f312",a:"1.0"},{n:["first quarter moon","first quarter moon symbol"],u:"1f313",a:"0.6"},{n:["moon","waxing gibbous moon","waxing gibbous moon symbol"],u:"1f314",a:"0.6"},{n:["full moon","full moon symbol"],u:"1f315",a:"0.6"},{n:["waning gibbous moon","waning gibbous moon symbol"],u:"1f316",a:"1.0"},{n:["last quarter moon","last quarter moon symbol"],u:"1f317",a:"1.0"},{n:["waning crescent moon","waning crescent moon symbol"],u:"1f318",a:"1.0"},{n:["crescent moon"],u:"1f319",a:"0.6"},{n:["new moon with face"],u:"1f31a",a:"1.0"},{n:["first quarter moon with face"],u:"1f31b",a:"0.6"},{n:["last quarter moon with face"],u:"1f31c",a:"0.7"},{n:["thermometer"],u:"1f321-fe0f",a:"0.7"},{n:["sunny","black sun with rays"],u:"2600-fe0f",a:"0.6"},{n:["full moon with face"],u:"1f31d",a:"1.0"},{n:["sun with face"],u:"1f31e",a:"1.0"},{n:["ringed planet"],u:"1fa90",a:"12.0"},{n:["star","white medium star"],u:"2b50",a:"0.6"},{n:["star2","glowing star"],u:"1f31f",a:"0.6"},{n:["stars","shooting star"],u:"1f320",a:"0.6"},{n:["milky way"],u:"1f30c",a:"0.6"},{n:["cloud"],u:"2601-fe0f",a:"0.6"},{n:["partly sunny","sun behind cloud"],u:"26c5",a:"0.6"},{n:["thunder cloud and rain","cloud with lightning and rain"],u:"26c8-fe0f",a:"0.7"},{n:["mostly sunny","sun small cloud","sun behind small cloud"],u:"1f324-fe0f",a:"0.7"},{n:["barely sunny","sun behind cloud","sun behind large cloud"],u:"1f325-fe0f",a:"0.7"},{n:["partly sunny rain","sun behind rain cloud"],u:"1f326-fe0f",a:"0.7"},{n:["rain cloud","cloud with rain"],u:"1f327-fe0f",a:"0.7"},{n:["snow cloud","cloud with snow"],u:"1f328-fe0f",a:"0.7"},{n:["lightning","lightning cloud","cloud with lightning"],u:"1f329-fe0f",a:"0.7"},{n:["tornado","tornado cloud"],u:"1f32a-fe0f",a:"0.7"},{n:["fog"],u:"1f32b-fe0f",a:"0.7"},{n:["wind face","wind blowing face"],u:"1f32c-fe0f",a:"0.7"},{n:["cyclone"],u:"1f300",a:"0.6"},{n:["rainbow"],u:"1f308",a:"0.6"},{n:["closed umbrella"],u:"1f302",a:"0.6"},{n:["umbrella"],u:"2602-fe0f",a:"0.7"},{n:["umbrella with rain drops"],u:"2614",a:"0.6"},{n:["umbrella on ground"],u:"26f1-fe0f",a:"0.7"},{n:["zap","high voltage sign"],u:"26a1",a:"0.6"},{n:["snowflake"],u:"2744-fe0f",a:"0.6"},{n:["snowman"],u:"2603-fe0f",a:"0.7"},{n:["snowman without snow"],u:"26c4",a:"0.6"},{n:["comet"],u:"2604-fe0f",a:"1.0"},{n:["fire"],u:"1f525",a:"0.6"},{n:["droplet"],u:"1f4a7",a:"0.6"},{n:["ocean","water wave"],u:"1f30a",a:"0.6"}],CSe=[{n:["jack-o-lantern","jack o lantern"],u:"1f383",a:"0.6"},{n:["christmas tree"],u:"1f384",a:"0.6"},{n:["fireworks"],u:"1f386",a:"0.6"},{n:["sparkler","firework sparkler"],u:"1f387",a:"0.6"},{n:["firecracker"],u:"1f9e8",a:"11.0"},{n:["sparkles"],u:"2728",a:"0.6"},{n:["balloon"],u:"1f388",a:"0.6"},{n:["tada","party popper"],u:"1f389",a:"0.6"},{n:["confetti ball"],u:"1f38a",a:"0.6"},{n:["tanabata tree"],u:"1f38b",a:"0.6"},{n:["bamboo","pine decoration"],u:"1f38d",a:"0.6"},{n:["dolls","japanese dolls"],u:"1f38e",a:"0.6"},{n:["flags","carp streamer"],u:"1f38f",a:"0.6"},{n:["wind chime"],u:"1f390",a:"0.6"},{n:["rice scene","moon viewing ceremony"],u:"1f391",a:"0.6"},{n:["red envelope","red gift envelope"],u:"1f9e7",a:"11.0"},{n:["ribbon"],u:"1f380",a:"0.6"},{n:["gift","wrapped present"],u:"1f381",a:"0.6"},{n:["reminder ribbon"],u:"1f397-fe0f",a:"0.7"},{n:["admission tickets"],u:"1f39f-fe0f",a:"0.7"},{n:["ticket"],u:"1f3ab",a:"0.6"},{n:["medal","military medal"],u:"1f396-fe0f",a:"0.7"},{n:["trophy"],u:"1f3c6",a:"0.6"},{n:["sports medal"],u:"1f3c5",a:"1.0"},{n:["first place medal"],u:"1f947",a:"3.0"},{n:["second place medal"],u:"1f948",a:"3.0"},{n:["third place medal"],u:"1f949",a:"3.0"},{n:["soccer","soccer ball"],u:"26bd",a:"0.6"},{n:["baseball"],u:"26be",a:"0.6"},{n:["softball"],u:"1f94e",a:"11.0"},{n:["basketball","basketball and hoop"],u:"1f3c0",a:"0.6"},{n:["volleyball"],u:"1f3d0",a:"1.0"},{n:["football","american football"],u:"1f3c8",a:"0.6"},{n:["rugby football"],u:"1f3c9",a:"1.0"},{n:["tennis","tennis racquet and ball"],u:"1f3be",a:"0.6"},{n:["flying disc"],u:"1f94f",a:"11.0"},{n:["bowling"],u:"1f3b3",a:"0.6"},{n:["cricket bat and ball"],u:"1f3cf",a:"1.0"},{n:["field hockey stick and ball"],u:"1f3d1",a:"1.0"},{n:["ice hockey stick and puck"],u:"1f3d2",a:"1.0"},{n:["lacrosse","lacrosse stick and ball"],u:"1f94d",a:"11.0"},{n:["table tennis paddle and ball"],u:"1f3d3",a:"1.0"},{n:["badminton racquet and shuttlecock"],u:"1f3f8",a:"1.0"},{n:["boxing glove"],u:"1f94a",a:"3.0"},{n:["martial arts uniform"],u:"1f94b",a:"3.0"},{n:["goal net"],u:"1f945",a:"3.0"},{n:["golf","flag in hole"],u:"26f3",a:"0.6"},{n:["ice skate"],u:"26f8-fe0f",a:"0.7"},{n:["fishing pole and fish"],u:"1f3a3",a:"0.6"},{n:["diving mask"],u:"1f93f",a:"12.0"},{n:["running shirt with sash"],u:"1f3bd",a:"0.6"},{n:["ski","ski and ski boot"],u:"1f3bf",a:"0.6"},{n:["sled"],u:"1f6f7",a:"5.0"},{n:["curling stone"],u:"1f94c",a:"5.0"},{n:["dart","direct hit"],u:"1f3af",a:"0.6"},{n:["yo-yo"],u:"1fa80",a:"12.0"},{n:["kite"],u:"1fa81",a:"12.0"},{n:["8ball","billiards"],u:"1f3b1",a:"0.6"},{n:["crystal ball"],u:"1f52e",a:"0.6"},{n:["magic wand"],u:"1fa84",a:"13.0"},{n:["nazar amulet"],u:"1f9ff",a:"11.0"},{n:["hamsa"],u:"1faac",a:"14.0"},{n:["video game"],u:"1f3ae",a:"0.6"},{n:["joystick"],u:"1f579-fe0f",a:"0.7"},{n:["slot machine"],u:"1f3b0",a:"0.6"},{n:["game die"],u:"1f3b2",a:"0.6"},{n:["jigsaw","jigsaw puzzle piece"],u:"1f9e9",a:"11.0"},{n:["teddy bear"],u:"1f9f8",a:"11.0"},{n:["pinata"],u:"1fa85",a:"13.0"},{n:["mirror ball"],u:"1faa9",a:"14.0"},{n:["nesting dolls"],u:"1fa86",a:"13.0"},{n:["spades","black spade suit"],u:"2660-fe0f",a:"0.6"},{n:["hearts","black heart suit"],u:"2665-fe0f",a:"0.6"},{n:["diamonds","black diamond suit"],u:"2666-fe0f",a:"0.6"},{n:["clubs","black club suit"],u:"2663-fe0f",a:"0.6"},{n:["chess pawn"],u:"265f-fe0f",a:"11.0"},{n:["black joker","playing card black joker"],u:"1f0cf",a:"0.6"},{n:["mahjong","mahjong tile red dragon"],u:"1f004",a:"0.6"},{n:["flower playing cards"],u:"1f3b4",a:"0.6"},{n:["performing arts"],u:"1f3ad",a:"0.6"},{n:["framed picture","frame with picture"],u:"1f5bc-fe0f",a:"0.7"},{n:["art","artist palette"],u:"1f3a8",a:"0.6"},{n:["thread","spool of thread"],u:"1f9f5",a:"11.0"},{n:["sewing needle"],u:"1faa1",a:"13.0"},{n:["yarn","ball of yarn"],u:"1f9f6",a:"11.0"},{n:["knot"],u:"1faa2",a:"13.0"}],wSe=[{n:["eyeglasses"],u:"1f453",a:"0.6"},{n:["sunglasses","dark sunglasses"],u:"1f576-fe0f",a:"0.7"},{n:["goggles"],u:"1f97d",a:"11.0"},{n:["lab coat"],u:"1f97c",a:"11.0"},{n:["safety vest"],u:"1f9ba",a:"12.0"},{n:["necktie"],u:"1f454",a:"0.6"},{n:["shirt","tshirt","t-shirt"],u:"1f455",a:"0.6"},{n:["jeans"],u:"1f456",a:"0.6"},{n:["scarf"],u:"1f9e3",a:"5.0"},{n:["gloves"],u:"1f9e4",a:"5.0"},{n:["coat"],u:"1f9e5",a:"5.0"},{n:["socks"],u:"1f9e6",a:"5.0"},{n:["dress"],u:"1f457",a:"0.6"},{n:["kimono"],u:"1f458",a:"0.6"},{n:["sari"],u:"1f97b",a:"12.0"},{n:["one-piece swimsuit"],u:"1fa71",a:"12.0"},{n:["briefs"],u:"1fa72",a:"12.0"},{n:["shorts"],u:"1fa73",a:"12.0"},{n:["bikini"],u:"1f459",a:"0.6"},{n:["womans clothes"],u:"1f45a",a:"0.6"},{n:["purse"],u:"1f45b",a:"0.6"},{n:["handbag"],u:"1f45c",a:"0.6"},{n:["pouch"],u:"1f45d",a:"0.6"},{n:["shopping bags"],u:"1f6cd-fe0f",a:"0.7"},{n:["school satchel"],u:"1f392",a:"0.6"},{n:["thong sandal"],u:"1fa74",a:"13.0"},{n:["shoe","mans shoe"],u:"1f45e",a:"0.6"},{n:["athletic shoe"],u:"1f45f",a:"0.6"},{n:["hiking boot"],u:"1f97e",a:"11.0"},{n:["flat shoe","womans flat shoe"],u:"1f97f",a:"11.0"},{n:["high heel","high-heeled shoe"],u:"1f460",a:"0.6"},{n:["sandal","womans sandal"],u:"1f461",a:"0.6"},{n:["ballet shoes"],u:"1fa70",a:"12.0"},{n:["boot","womans boots"],u:"1f462",a:"0.6"},{n:["crown"],u:"1f451",a:"0.6"},{n:["womans hat"],u:"1f452",a:"0.6"},{n:["tophat","top hat"],u:"1f3a9",a:"0.6"},{n:["mortar board","graduation cap"],u:"1f393",a:"0.6"},{n:["billed cap"],u:"1f9e2",a:"5.0"},{n:["military helmet"],u:"1fa96",a:"13.0"},{n:["rescue workers helmet","helmet with white cross"],u:"26d1-fe0f",a:"0.7"},{n:["prayer beads"],u:"1f4ff",a:"1.0"},{n:["lipstick"],u:"1f484",a:"0.6"},{n:["ring"],u:"1f48d",a:"0.6"},{n:["gem","gem stone"],u:"1f48e",a:"0.6"},{n:["mute","speaker with cancellation stroke"],u:"1f507",a:"1.0"},{n:["speaker"],u:"1f508",a:"0.7"},{n:["sound","speaker with one sound wave"],u:"1f509",a:"1.0"},{n:["loud sound","speaker with three sound waves"],u:"1f50a",a:"0.6"},{n:["loudspeaker","public address loudspeaker"],u:"1f4e2",a:"0.6"},{n:["mega","cheering megaphone"],u:"1f4e3",a:"0.6"},{n:["postal horn"],u:"1f4ef",a:"1.0"},{n:["bell"],u:"1f514",a:"0.6"},{n:["no bell","bell with cancellation stroke"],u:"1f515",a:"1.0"},{n:["musical score"],u:"1f3bc",a:"0.6"},{n:["musical note"],u:"1f3b5",a:"0.6"},{n:["notes","multiple musical notes"],u:"1f3b6",a:"0.6"},{n:["studio microphone"],u:"1f399-fe0f",a:"0.7"},{n:["level slider"],u:"1f39a-fe0f",a:"0.7"},{n:["control knobs"],u:"1f39b-fe0f",a:"0.7"},{n:["microphone"],u:"1f3a4",a:"0.6"},{n:["headphone","headphones"],u:"1f3a7",a:"0.6"},{n:["radio"],u:"1f4fb",a:"0.6"},{n:["saxophone"],u:"1f3b7",a:"0.6"},{n:["accordion"],u:"1fa97",a:"13.0"},{n:["guitar"],u:"1f3b8",a:"0.6"},{n:["musical keyboard"],u:"1f3b9",a:"0.6"},{n:["trumpet"],u:"1f3ba",a:"0.6"},{n:["violin"],u:"1f3bb",a:"0.6"},{n:["banjo"],u:"1fa95",a:"12.0"},{n:["drum with drumsticks"],u:"1f941",a:"3.0"},{n:["long drum"],u:"1fa98",a:"13.0"},{n:["iphone","mobile phone"],u:"1f4f1",a:"0.6"},{n:["calling","mobile phone with rightwards arrow at left"],u:"1f4f2",a:"0.6"},{n:["phone","telephone","black telephone"],u:"260e-fe0f",a:"0.6"},{n:["telephone receiver"],u:"1f4de",a:"0.6"},{n:["pager"],u:"1f4df",a:"0.6"},{n:["fax","fax machine"],u:"1f4e0",a:"0.6"},{n:["battery"],u:"1f50b",a:"0.6"},{n:["low battery"],u:"1faab",a:"14.0"},{n:["electric plug"],u:"1f50c",a:"0.6"},{n:["computer","personal computer"],u:"1f4bb",a:"0.6"},{n:["desktop computer"],u:"1f5a5-fe0f",a:"0.7"},{n:["printer"],u:"1f5a8-fe0f",a:"0.7"},{n:["keyboard"],u:"2328-fe0f",a:"1.0"},{n:["computer mouse","three button mouse"],u:"1f5b1-fe0f",a:"0.7"},{n:["trackball"],u:"1f5b2-fe0f",a:"0.7"},{n:["minidisc"],u:"1f4bd",a:"0.6"},{n:["floppy disk"],u:"1f4be",a:"0.6"},{n:["cd","optical disc"],u:"1f4bf",a:"0.6"},{n:["dvd"],u:"1f4c0",a:"0.6"},{n:["abacus"],u:"1f9ee",a:"11.0"},{n:["movie camera"],u:"1f3a5",a:"0.6"},{n:["film frames"],u:"1f39e-fe0f",a:"0.7"},{n:["film projector"],u:"1f4fd-fe0f",a:"0.7"},{n:["clapper","clapper board"],u:"1f3ac",a:"0.6"},{n:["tv","television"],u:"1f4fa",a:"0.6"},{n:["camera"],u:"1f4f7",a:"0.6"},{n:["camera with flash"],u:"1f4f8",a:"1.0"},{n:["video camera"],u:"1f4f9",a:"0.6"},{n:["vhs","videocassette"],u:"1f4fc",a:"0.6"},{n:["mag","left-pointing magnifying glass"],u:"1f50d",a:"0.6"},{n:["mag right","right-pointing magnifying glass"],u:"1f50e",a:"0.6"},{n:["candle"],u:"1f56f-fe0f",a:"0.7"},{n:["bulb","electric light bulb"],u:"1f4a1",a:"0.6"},{n:["flashlight","electric torch"],u:"1f526",a:"0.6"},{n:["lantern","izakaya lantern"],u:"1f3ee",a:"0.6"},{n:["diya lamp"],u:"1fa94",a:"12.0"},{n:["notebook with decorative cover"],u:"1f4d4",a:"0.6"},{n:["closed book"],u:"1f4d5",a:"0.6"},{n:["book","open book"],u:"1f4d6",a:"0.6"},{n:["green book"],u:"1f4d7",a:"0.6"},{n:["blue book"],u:"1f4d8",a:"0.6"},{n:["orange book"],u:"1f4d9",a:"0.6"},{n:["books"],u:"1f4da",a:"0.6"},{n:["notebook"],u:"1f4d3",a:"0.6"},{n:["ledger"],u:"1f4d2",a:"0.6"},{n:["page with curl"],u:"1f4c3",a:"0.6"},{n:["scroll"],u:"1f4dc",a:"0.6"},{n:["page facing up"],u:"1f4c4",a:"0.6"},{n:["newspaper"],u:"1f4f0",a:"0.6"},{n:["rolled-up newspaper","rolled up newspaper"],u:"1f5de-fe0f",a:"0.7"},{n:["bookmark tabs"],u:"1f4d1",a:"0.6"},{n:["bookmark"],u:"1f516",a:"0.6"},{n:["label"],u:"1f3f7-fe0f",a:"0.7"},{n:["moneybag","money bag"],u:"1f4b0",a:"0.6"},{n:["coin"],u:"1fa99",a:"13.0"},{n:["yen","banknote with yen sign"],u:"1f4b4",a:"0.6"},{n:["dollar","banknote with dollar sign"],u:"1f4b5",a:"0.6"},{n:["euro","banknote with euro sign"],u:"1f4b6",a:"1.0"},{n:["pound","banknote with pound sign"],u:"1f4b7",a:"1.0"},{n:["money with wings"],u:"1f4b8",a:"0.6"},{n:["credit card"],u:"1f4b3",a:"0.6"},{n:["receipt"],u:"1f9fe",a:"11.0"},{n:["chart","chart with upwards trend and yen sign"],u:"1f4b9",a:"0.6"},{n:["email","envelope"],u:"2709-fe0f",a:"0.6"},{n:["e-mail","e-mail symbol"],u:"1f4e7",a:"0.6"},{n:["incoming envelope"],u:"1f4e8",a:"0.6"},{n:["envelope with arrow","envelope with downwards arrow above"],u:"1f4e9",a:"0.6"},{n:["outbox tray"],u:"1f4e4",a:"0.6"},{n:["inbox tray"],u:"1f4e5",a:"0.6"},{n:["package"],u:"1f4e6",a:"0.6"},{n:["mailbox","closed mailbox with raised flag"],u:"1f4eb",a:"0.6"},{n:["mailbox closed","closed mailbox with lowered flag"],u:"1f4ea",a:"0.6"},{n:["mailbox with mail","open mailbox with raised flag"],u:"1f4ec",a:"0.7"},{n:["mailbox with no mail","open mailbox with lowered flag"],u:"1f4ed",a:"0.7"},{n:["postbox"],u:"1f4ee",a:"0.6"},{n:["ballot box with ballot"],u:"1f5f3-fe0f",a:"0.7"},{n:["pencil","pencil2"],u:"270f-fe0f",a:"0.6"},{n:["black nib"],u:"2712-fe0f",a:"0.6"},{n:["fountain pen","lower left fountain pen"],u:"1f58b-fe0f",a:"0.7"},{n:["pen","lower left ballpoint pen"],u:"1f58a-fe0f",a:"0.7"},{n:["paintbrush","lower left paintbrush"],u:"1f58c-fe0f",a:"0.7"},{n:["crayon","lower left crayon"],u:"1f58d-fe0f",a:"0.7"},{n:["memo","pencil"],u:"1f4dd",a:"0.6"},{n:["briefcase"],u:"1f4bc",a:"0.6"},{n:["file folder"],u:"1f4c1",a:"0.6"},{n:["open file folder"],u:"1f4c2",a:"0.6"},{n:["card index dividers"],u:"1f5c2-fe0f",a:"0.7"},{n:["date","calendar"],u:"1f4c5",a:"0.6"},{n:["calendar","tear-off calendar"],u:"1f4c6",a:"0.6"},{n:["spiral notepad","spiral note pad"],u:"1f5d2-fe0f",a:"0.7"},{n:["spiral calendar","spiral calendar pad"],u:"1f5d3-fe0f",a:"0.7"},{n:["card index"],u:"1f4c7",a:"0.6"},{n:["chart with upwards trend"],u:"1f4c8",a:"0.6"},{n:["chart with downwards trend"],u:"1f4c9",a:"0.6"},{n:["bar chart"],u:"1f4ca",a:"0.6"},{n:["clipboard"],u:"1f4cb",a:"0.6"},{n:["pushpin"],u:"1f4cc",a:"0.6"},{n:["round pushpin"],u:"1f4cd",a:"0.6"},{n:["paperclip"],u:"1f4ce",a:"0.6"},{n:["linked paperclips"],u:"1f587-fe0f",a:"0.7"},{n:["straight ruler"],u:"1f4cf",a:"0.6"},{n:["triangular ruler"],u:"1f4d0",a:"0.6"},{n:["scissors","black scissors"],u:"2702-fe0f",a:"0.6"},{n:["card file box"],u:"1f5c3-fe0f",a:"0.7"},{n:["file cabinet"],u:"1f5c4-fe0f",a:"0.7"},{n:["wastebasket"],u:"1f5d1-fe0f",a:"0.7"},{n:["lock"],u:"1f512",a:"0.6"},{n:["unlock","open lock"],u:"1f513",a:"0.6"},{n:["lock with ink pen"],u:"1f50f",a:"0.6"},{n:["closed lock with key"],u:"1f510",a:"0.6"},{n:["key"],u:"1f511",a:"0.6"},{n:["old key"],u:"1f5dd-fe0f",a:"0.7"},{n:["hammer"],u:"1f528",a:"0.6"},{n:["axe"],u:"1fa93",a:"12.0"},{n:["pick"],u:"26cf-fe0f",a:"0.7"},{n:["hammer and pick"],u:"2692-fe0f",a:"1.0"},{n:["hammer and wrench"],u:"1f6e0-fe0f",a:"0.7"},{n:["dagger","dagger knife"],u:"1f5e1-fe0f",a:"0.7"},{n:["crossed swords"],u:"2694-fe0f",a:"1.0"},{n:["gun","pistol"],u:"1f52b",a:"0.6"},{n:["boomerang"],u:"1fa83",a:"13.0"},{n:["bow and arrow"],u:"1f3f9",a:"1.0"},{n:["shield"],u:"1f6e1-fe0f",a:"0.7"},{n:["carpentry saw"],u:"1fa9a",a:"13.0"},{n:["wrench"],u:"1f527",a:"0.6"},{n:["screwdriver"],u:"1fa9b",a:"13.0"},{n:["nut and bolt"],u:"1f529",a:"0.6"},{n:["gear"],u:"2699-fe0f",a:"1.0"},{n:["clamp","compression"],u:"1f5dc-fe0f",a:"0.7"},{n:["scales","balance scale"],u:"2696-fe0f",a:"1.0"},{n:["probing cane"],u:"1f9af",a:"12.0"},{n:["link","link symbol"],u:"1f517",a:"0.6"},{n:["chains"],u:"26d3-fe0f",a:"0.7"},{n:["hook"],u:"1fa9d",a:"13.0"},{n:["toolbox"],u:"1f9f0",a:"11.0"},{n:["magnet"],u:"1f9f2",a:"11.0"},{n:["ladder"],u:"1fa9c",a:"13.0"},{n:["alembic"],u:"2697-fe0f",a:"1.0"},{n:["test tube"],u:"1f9ea",a:"11.0"},{n:["petri dish"],u:"1f9eb",a:"11.0"},{n:["dna","dna double helix"],u:"1f9ec",a:"11.0"},{n:["microscope"],u:"1f52c",a:"1.0"},{n:["telescope"],u:"1f52d",a:"1.0"},{n:["satellite antenna"],u:"1f4e1",a:"0.6"},{n:["syringe"],u:"1f489",a:"0.6"},{n:["drop of blood"],u:"1fa78",a:"12.0"},{n:["pill"],u:"1f48a",a:"0.6"},{n:["adhesive bandage"],u:"1fa79",a:"12.0"},{n:["crutch"],u:"1fa7c",a:"14.0"},{n:["stethoscope"],u:"1fa7a",a:"12.0"},{n:["x-ray"],u:"1fa7b",a:"14.0"},{n:["door"],u:"1f6aa",a:"0.6"},{n:["elevator"],u:"1f6d7",a:"13.0"},{n:["mirror"],u:"1fa9e",a:"13.0"},{n:["window"],u:"1fa9f",a:"13.0"},{n:["bed"],u:"1f6cf-fe0f",a:"0.7"},{n:["couch and lamp"],u:"1f6cb-fe0f",a:"0.7"},{n:["chair"],u:"1fa91",a:"12.0"},{n:["toilet"],u:"1f6bd",a:"0.6"},{n:["plunger"],u:"1faa0",a:"13.0"},{n:["shower"],u:"1f6bf",a:"1.0"},{n:["bathtub"],u:"1f6c1",a:"1.0"},{n:["mouse trap"],u:"1faa4",a:"13.0"},{n:["razor"],u:"1fa92",a:"12.0"},{n:["lotion bottle"],u:"1f9f4",a:"11.0"},{n:["safety pin"],u:"1f9f7",a:"11.0"},{n:["broom"],u:"1f9f9",a:"11.0"},{n:["basket"],u:"1f9fa",a:"11.0"},{n:["roll of paper"],u:"1f9fb",a:"11.0"},{n:["bucket"],u:"1faa3",a:"13.0"},{n:["soap","bar of soap"],u:"1f9fc",a:"11.0"},{n:["bubbles"],u:"1fae7",a:"14.0"},{n:["toothbrush"],u:"1faa5",a:"13.0"},{n:["sponge"],u:"1f9fd",a:"11.0"},{n:["fire extinguisher"],u:"1f9ef",a:"11.0"},{n:["shopping trolley"],u:"1f6d2",a:"3.0"},{n:["smoking","smoking symbol"],u:"1f6ac",a:"0.6"},{n:["coffin"],u:"26b0-fe0f",a:"1.0"},{n:["headstone"],u:"1faa6",a:"13.0"},{n:["funeral urn"],u:"26b1-fe0f",a:"1.0"},{n:["moyai"],u:"1f5ff",a:"0.6"},{n:["placard"],u:"1faa7",a:"13.0"},{n:["identification card"],u:"1faaa",a:"14.0"}],RSe=[{n:["atm","automated teller machine"],u:"1f3e7",a:"0.6"},{n:["put litter in its place","put litter in its place symbol"],u:"1f6ae",a:"1.0"},{n:["potable water","potable water symbol"],u:"1f6b0",a:"1.0"},{n:["wheelchair","wheelchair symbol"],u:"267f",a:"0.6"},{n:["mens","mens symbol"],u:"1f6b9",a:"0.6"},{n:["womens","womens symbol"],u:"1f6ba",a:"0.6"},{n:["restroom"],u:"1f6bb",a:"0.6"},{n:["baby symbol"],u:"1f6bc",a:"0.6"},{n:["wc","water closet"],u:"1f6be",a:"0.6"},{n:["passport control"],u:"1f6c2",a:"1.0"},{n:["customs"],u:"1f6c3",a:"1.0"},{n:["baggage claim"],u:"1f6c4",a:"1.0"},{n:["left luggage"],u:"1f6c5",a:"1.0"},{n:["warning","warning sign"],u:"26a0-fe0f",a:"0.6"},{n:["children crossing"],u:"1f6b8",a:"1.0"},{n:["no entry"],u:"26d4",a:"0.6"},{n:["no entry sign"],u:"1f6ab",a:"0.6"},{n:["no bicycles"],u:"1f6b3",a:"1.0"},{n:["no smoking","no smoking symbol"],u:"1f6ad",a:"0.6"},{n:["do not litter","do not litter symbol"],u:"1f6af",a:"1.0"},{n:["non-potable water","non-potable water symbol"],u:"1f6b1",a:"1.0"},{n:["no pedestrians"],u:"1f6b7",a:"1.0"},{n:["no mobile phones"],u:"1f4f5",a:"1.0"},{n:["underage","no one under eighteen symbol"],u:"1f51e",a:"0.6"},{n:["radioactive","radioactive sign"],u:"2622-fe0f",a:"1.0"},{n:["biohazard","biohazard sign"],u:"2623-fe0f",a:"1.0"},{n:["arrow up","upwards black arrow"],u:"2b06-fe0f",a:"0.6"},{n:["north east arrow","arrow upper right"],u:"2197-fe0f",a:"0.6"},{n:["arrow right","black rightwards arrow"],u:"27a1-fe0f",a:"0.6"},{n:["south east arrow","arrow lower right"],u:"2198-fe0f",a:"0.6"},{n:["arrow down","downwards black arrow"],u:"2b07-fe0f",a:"0.6"},{n:["south west arrow","arrow lower left"],u:"2199-fe0f",a:"0.6"},{n:["arrow left","leftwards black arrow"],u:"2b05-fe0f",a:"0.6"},{n:["north west arrow","arrow upper left"],u:"2196-fe0f",a:"0.6"},{n:["up down arrow","arrow up down"],u:"2195-fe0f",a:"0.6"},{n:["left right arrow"],u:"2194-fe0f",a:"0.6"},{n:["leftwards arrow with hook"],u:"21a9-fe0f",a:"0.6"},{n:["arrow right hook","rightwards arrow with hook"],u:"21aa-fe0f",a:"0.6"},{n:["arrow heading up","arrow pointing rightwards then curving upwards"],u:"2934-fe0f",a:"0.6"},{n:["arrow heading down","arrow pointing rightwards then curving downwards"],u:"2935-fe0f",a:"0.6"},{n:["arrows clockwise","clockwise downwards and upwards open circle arrows"],u:"1f503",a:"0.6"},{n:["arrows counterclockwise","anticlockwise downwards and upwards open circle arrows"],u:"1f504",a:"1.0"},{n:["back","back with leftwards arrow above"],u:"1f519",a:"0.6"},{n:["end","end with leftwards arrow above"],u:"1f51a",a:"0.6"},{n:["on","on with exclamation mark with left right arrow above"],u:"1f51b",a:"0.6"},{n:["soon","soon with rightwards arrow above"],u:"1f51c",a:"0.6"},{n:["top","top with upwards arrow above"],u:"1f51d",a:"0.6"},{n:["place of worship"],u:"1f6d0",a:"1.0"},{n:["atom symbol"],u:"269b-fe0f",a:"1.0"},{n:["om","om symbol"],u:"1f549-fe0f",a:"0.7"},{n:["star of david"],u:"2721-fe0f",a:"0.7"},{n:["wheel of dharma"],u:"2638-fe0f",a:"0.7"},{n:["yin yang"],u:"262f-fe0f",a:"0.7"},{n:["latin cross"],u:"271d-fe0f",a:"0.7"},{n:["orthodox cross"],u:"2626-fe0f",a:"1.0"},{n:["star and crescent"],u:"262a-fe0f",a:"0.7"},{n:["peace symbol"],u:"262e-fe0f",a:"1.0"},{n:["menorah with nine branches"],u:"1f54e",a:"1.0"},{n:["six pointed star","six pointed star with middle dot"],u:"1f52f",a:"0.6"},{n:["aries"],u:"2648",a:"0.6"},{n:["taurus"],u:"2649",a:"0.6"},{n:["gemini"],u:"264a",a:"0.6"},{n:["cancer"],u:"264b",a:"0.6"},{n:["leo"],u:"264c",a:"0.6"},{n:["virgo"],u:"264d",a:"0.6"},{n:["libra"],u:"264e",a:"0.6"},{n:["scorpius"],u:"264f",a:"0.6"},{n:["sagittarius"],u:"2650",a:"0.6"},{n:["capricorn"],u:"2651",a:"0.6"},{n:["aquarius"],u:"2652",a:"0.6"},{n:["pisces"],u:"2653",a:"0.6"},{n:["ophiuchus"],u:"26ce",a:"0.6"},{n:["twisted rightwards arrows"],u:"1f500",a:"1.0"},{n:["repeat","clockwise rightwards and leftwards open circle arrows"],u:"1f501",a:"1.0"},{n:["repeat one","clockwise rightwards and leftwards open circle arrows with circled one overlay"],u:"1f502",a:"1.0"},{n:["arrow forward","black right-pointing triangle"],u:"25b6-fe0f",a:"0.6"},{n:["fast forward","black right-pointing double triangle"],u:"23e9",a:"0.6"},{n:["next track button","black right pointing double triangle with vertical bar"],u:"23ed-fe0f",a:"0.7"},{n:["play or pause button","black right pointing triangle with double vertical bar"],u:"23ef-fe0f",a:"1.0"},{n:["arrow backward","black left-pointing triangle"],u:"25c0-fe0f",a:"0.6"},{n:["rewind","black left-pointing double triangle"],u:"23ea",a:"0.6"},{n:["last track button","black left pointing double triangle with vertical bar"],u:"23ee-fe0f",a:"0.7"},{n:["arrow up small","up-pointing small red triangle"],u:"1f53c",a:"0.6"},{n:["arrow double up","black up-pointing double triangle"],u:"23eb",a:"0.6"},{n:["arrow down small","down-pointing small red triangle"],u:"1f53d",a:"0.6"},{n:["arrow double down","black down-pointing double triangle"],u:"23ec",a:"0.6"},{n:["pause button","double vertical bar"],u:"23f8-fe0f",a:"0.7"},{n:["stop button","black square for stop"],u:"23f9-fe0f",a:"0.7"},{n:["record button","black circle for record"],u:"23fa-fe0f",a:"0.7"},{n:["eject","eject button"],u:"23cf-fe0f",a:"1.0"},{n:["cinema"],u:"1f3a6",a:"0.6"},{n:["low brightness","low brightness symbol"],u:"1f505",a:"1.0"},{n:["high brightness","high brightness symbol"],u:"1f506",a:"1.0"},{n:["signal strength","antenna with bars"],u:"1f4f6",a:"0.6"},{n:["vibration mode"],u:"1f4f3",a:"0.6"},{n:["mobile phone off"],u:"1f4f4",a:"0.6"},{n:["female sign"],u:"2640-fe0f",a:"4.0"},{n:["male sign"],u:"2642-fe0f",a:"4.0"},{n:["transgender symbol"],u:"26a7-fe0f",a:"13.0"},{n:["heavy multiplication x"],u:"2716-fe0f",a:"0.6"},{n:["heavy plus sign"],u:"2795",a:"0.6"},{n:["heavy minus sign"],u:"2796",a:"0.6"},{n:["heavy division sign"],u:"2797",a:"0.6"},{n:["heavy equals sign"],u:"1f7f0",a:"14.0"},{n:["infinity"],u:"267e-fe0f",a:"11.0"},{n:["bangbang","double exclamation mark"],u:"203c-fe0f",a:"0.6"},{n:["interrobang","exclamation question mark"],u:"2049-fe0f",a:"0.6"},{n:["question","black question mark ornament"],u:"2753",a:"0.6"},{n:["grey question","white question mark ornament"],u:"2754",a:"0.6"},{n:["grey exclamation","white exclamation mark ornament"],u:"2755",a:"0.6"},{n:["exclamation","heavy exclamation mark","heavy exclamation mark symbol"],u:"2757",a:"0.6"},{n:["wavy dash"],u:"3030-fe0f",a:"0.6"},{n:["currency exchange"],u:"1f4b1",a:"0.6"},{n:["heavy dollar sign"],u:"1f4b2",a:"0.6"},{n:["medical symbol","staff of aesculapius"],u:"2695-fe0f",a:"4.0"},{n:["recycle","black universal recycling symbol"],u:"267b-fe0f",a:"0.6"},{n:["fleur-de-lis","fleur de lis"],u:"269c-fe0f",a:"1.0"},{n:["trident","trident emblem"],u:"1f531",a:"0.6"},{n:["name badge"],u:"1f4db",a:"0.6"},{n:["beginner","japanese symbol for beginner"],u:"1f530",a:"0.6"},{n:["o","heavy large circle"],u:"2b55",a:"0.6"},{n:["white check mark","white heavy check mark"],u:"2705",a:"0.6"},{n:["ballot box with check"],u:"2611-fe0f",a:"0.6"},{n:["heavy check mark"],u:"2714-fe0f",a:"0.6"},{n:["x","cross mark"],u:"274c",a:"0.6"},{n:["negative squared cross mark"],u:"274e",a:"0.6"},{n:["curly loop"],u:"27b0",a:"0.6"},{n:["loop","double curly loop"],u:"27bf",a:"1.0"},{n:["part alternation mark"],u:"303d-fe0f",a:"0.6"},{n:["eight spoked asterisk"],u:"2733-fe0f",a:"0.6"},{n:["eight pointed black star"],u:"2734-fe0f",a:"0.6"},{n:["sparkle"],u:"2747-fe0f",a:"0.6"},{n:["copyright","copyright sign"],u:"00a9-fe0f",a:"0.6"},{n:["registered","registered sign"],u:"00ae-fe0f",a:"0.6"},{n:["tm","trade mark sign"],u:"2122-fe0f",a:"0.6"},{n:["hash","hash key"],u:"0023-fe0f-20e3",a:"0.6"},{n:["keycap: *","keycap star"],u:"002a-fe0f-20e3",a:"2.0"},{n:["zero","keycap 0"],u:"0030-fe0f-20e3",a:"0.6"},{n:["one","keycap 1"],u:"0031-fe0f-20e3",a:"0.6"},{n:["two","keycap 2"],u:"0032-fe0f-20e3",a:"0.6"},{n:["three","keycap 3"],u:"0033-fe0f-20e3",a:"0.6"},{n:["four","keycap 4"],u:"0034-fe0f-20e3",a:"0.6"},{n:["five","keycap 5"],u:"0035-fe0f-20e3",a:"0.6"},{n:["six","keycap 6"],u:"0036-fe0f-20e3",a:"0.6"},{n:["seven","keycap 7"],u:"0037-fe0f-20e3",a:"0.6"},{n:["eight","keycap 8"],u:"0038-fe0f-20e3",a:"0.6"},{n:["nine","keycap 9"],u:"0039-fe0f-20e3",a:"0.6"},{n:["keycap ten"],u:"1f51f",a:"0.6"},{n:["capital abcd","input symbol for latin capital letters"],u:"1f520",a:"0.6"},{n:["abcd","input symbol for latin small letters"],u:"1f521",a:"0.6"},{n:["1234","input symbol for numbers"],u:"1f522",a:"0.6"},{n:["symbols","input symbol for symbols"],u:"1f523",a:"0.6"},{n:["abc","input symbol for latin letters"],u:"1f524",a:"0.6"},{n:["a","negative squared latin capital letter a"],u:"1f170-fe0f",a:"0.6"},{n:["ab","negative squared ab"],u:"1f18e",a:"0.6"},{n:["b","negative squared latin capital letter b"],u:"1f171-fe0f",a:"0.6"},{n:["cl","squared cl"],u:"1f191",a:"0.6"},{n:["cool","squared cool"],u:"1f192",a:"0.6"},{n:["free","squared free"],u:"1f193",a:"0.6"},{n:["information source"],u:"2139-fe0f",a:"0.6"},{n:["id","squared id"],u:"1f194",a:"0.6"},{n:["m","circled latin capital letter m"],u:"24c2-fe0f",a:"0.6"},{n:["new","squared new"],u:"1f195",a:"0.6"},{n:["ng","squared ng"],u:"1f196",a:"0.6"},{n:["o2","negative squared latin capital letter o"],u:"1f17e-fe0f",a:"0.6"},{n:["ok","squared ok"],u:"1f197",a:"0.6"},{n:["parking","negative squared latin capital letter p"],u:"1f17f-fe0f",a:"0.6"},{n:["sos","squared sos"],u:"1f198",a:"0.6"},{n:["up","squared up with exclamation mark"],u:"1f199",a:"0.6"},{n:["vs","squared vs"],u:"1f19a",a:"0.6"},{n:["koko","squared katakana koko"],u:"1f201",a:"0.6"},{n:["sa","squared katakana sa"],u:"1f202-fe0f",a:"0.6"},{n:["u6708","squared cjk unified ideograph-6708"],u:"1f237-fe0f",a:"0.6"},{n:["u6709","squared cjk unified ideograph-6709"],u:"1f236",a:"0.6"},{n:["u6307","squared cjk unified ideograph-6307"],u:"1f22f",a:"0.6"},{n:["ideograph advantage","circled ideograph advantage"],u:"1f250",a:"0.6"},{n:["u5272","squared cjk unified ideograph-5272"],u:"1f239",a:"0.6"},{n:["u7121","squared cjk unified ideograph-7121"],u:"1f21a",a:"0.6"},{n:["u7981","squared cjk unified ideograph-7981"],u:"1f232",a:"0.6"},{n:["accept","circled ideograph accept"],u:"1f251",a:"0.6"},{n:["u7533","squared cjk unified ideograph-7533"],u:"1f238",a:"0.6"},{n:["u5408","squared cjk unified ideograph-5408"],u:"1f234",a:"0.6"},{n:["u7a7a","squared cjk unified ideograph-7a7a"],u:"1f233",a:"0.6"},{n:["congratulations","circled ideograph congratulation"],u:"3297-fe0f",a:"0.6"},{n:["secret","circled ideograph secret"],u:"3299-fe0f",a:"0.6"},{n:["u55b6","squared cjk unified ideograph-55b6"],u:"1f23a",a:"0.6"},{n:["u6e80","squared cjk unified ideograph-6e80"],u:"1f235",a:"0.6"},{n:["red circle","large red circle"],u:"1f534",a:"0.6"},{n:["large orange circle"],u:"1f7e0",a:"12.0"},{n:["large yellow circle"],u:"1f7e1",a:"12.0"},{n:["large green circle"],u:"1f7e2",a:"12.0"},{n:["large blue circle"],u:"1f535",a:"0.6"},{n:["large purple circle"],u:"1f7e3",a:"12.0"},{n:["large brown circle"],u:"1f7e4",a:"12.0"},{n:["black circle","medium black circle"],u:"26ab",a:"0.6"},{n:["white circle","medium white circle"],u:"26aa",a:"0.6"},{n:["large red square"],u:"1f7e5",a:"12.0"},{n:["large orange square"],u:"1f7e7",a:"12.0"},{n:["large yellow square"],u:"1f7e8",a:"12.0"},{n:["large green square"],u:"1f7e9",a:"12.0"},{n:["large blue square"],u:"1f7e6",a:"12.0"},{n:["large purple square"],u:"1f7ea",a:"12.0"},{n:["large brown square"],u:"1f7eb",a:"12.0"},{n:["black large square"],u:"2b1b",a:"0.6"},{n:["white large square"],u:"2b1c",a:"0.6"},{n:["black medium square"],u:"25fc-fe0f",a:"0.6"},{n:["white medium square"],u:"25fb-fe0f",a:"0.6"},{n:["black medium small square"],u:"25fe",a:"0.6"},{n:["white medium small square"],u:"25fd",a:"0.6"},{n:["black small square"],u:"25aa-fe0f",a:"0.6"},{n:["white small square"],u:"25ab-fe0f",a:"0.6"},{n:["large orange diamond"],u:"1f536",a:"0.6"},{n:["large blue diamond"],u:"1f537",a:"0.6"},{n:["small orange diamond"],u:"1f538",a:"0.6"},{n:["small blue diamond"],u:"1f539",a:"0.6"},{n:["small red triangle","up-pointing red triangle"],u:"1f53a",a:"0.6"},{n:["small red triangle down","down-pointing red triangle"],u:"1f53b",a:"0.6"},{n:["diamond shape with a dot inside"],u:"1f4a0",a:"0.6"},{n:["radio button"],u:"1f518",a:"0.6"},{n:["white square button"],u:"1f533",a:"0.6"},{n:["black square button"],u:"1f532",a:"0.6"}],ISe=[{n:["chequered flag","checkered flag"],u:"1f3c1",a:"0.6"},{n:["triangular flag on post"],u:"1f6a9",a:"0.6"},{n:["crossed flags"],u:"1f38c",a:"0.6"},{n:["waving black flag"],u:"1f3f4",a:"1.0"},{n:["white flag","waving white flag"],u:"1f3f3-fe0f",a:"0.7"},{n:["rainbow flag","rainbow-flag"],u:"1f3f3-fe0f-200d-1f308",a:"4.0"},{n:["transgender flag"],u:"1f3f3-fe0f-200d-26a7-fe0f",a:"13.0"},{n:["pirate flag"],u:"1f3f4-200d-2620-fe0f",a:"11.0"},{n:["flag-ac","ascension island flag"],u:"1f1e6-1f1e8",a:"2.0"},{n:["flag-ad","andorra flag"],u:"1f1e6-1f1e9",a:"2.0"},{n:["flag-ae","united arab emirates flag"],u:"1f1e6-1f1ea",a:"2.0"},{n:["flag-af","afghanistan flag"],u:"1f1e6-1f1eb",a:"2.0"},{n:["flag-ag","antigua & barbuda flag"],u:"1f1e6-1f1ec",a:"2.0"},{n:["flag-ai","anguilla flag"],u:"1f1e6-1f1ee",a:"2.0"},{n:["flag-al","albania flag"],u:"1f1e6-1f1f1",a:"2.0"},{n:["flag-am","armenia flag"],u:"1f1e6-1f1f2",a:"2.0"},{n:["flag-ao","angola flag"],u:"1f1e6-1f1f4",a:"2.0"},{n:["flag-aq","antarctica flag"],u:"1f1e6-1f1f6",a:"2.0"},{n:["flag-ar","argentina flag"],u:"1f1e6-1f1f7",a:"2.0"},{n:["flag-as","american samoa flag"],u:"1f1e6-1f1f8",a:"2.0"},{n:["flag-at","austria flag"],u:"1f1e6-1f1f9",a:"2.0"},{n:["flag-au","australia flag"],u:"1f1e6-1f1fa",a:"2.0"},{n:["flag-aw","aruba flag"],u:"1f1e6-1f1fc",a:"2.0"},{n:["flag-ax","land islands flag"],u:"1f1e6-1f1fd",a:"2.0"},{n:["flag-az","azerbaijan flag"],u:"1f1e6-1f1ff",a:"2.0"},{n:["flag-ba","bosnia & herzegovina flag"],u:"1f1e7-1f1e6",a:"2.0"},{n:["flag-bb","barbados flag"],u:"1f1e7-1f1e7",a:"2.0"},{n:["flag-bd","bangladesh flag"],u:"1f1e7-1f1e9",a:"2.0"},{n:["flag-be","belgium flag"],u:"1f1e7-1f1ea",a:"2.0"},{n:["flag-bf","burkina faso flag"],u:"1f1e7-1f1eb",a:"2.0"},{n:["flag-bg","bulgaria flag"],u:"1f1e7-1f1ec",a:"2.0"},{n:["flag-bh","bahrain flag"],u:"1f1e7-1f1ed",a:"2.0"},{n:["flag-bi","burundi flag"],u:"1f1e7-1f1ee",a:"2.0"},{n:["flag-bj","benin flag"],u:"1f1e7-1f1ef",a:"2.0"},{n:["flag-bl","st. barthlemy flag"],u:"1f1e7-1f1f1",a:"2.0"},{n:["flag-bm","bermuda flag"],u:"1f1e7-1f1f2",a:"2.0"},{n:["flag-bn","brunei flag"],u:"1f1e7-1f1f3",a:"2.0"},{n:["flag-bo","bolivia flag"],u:"1f1e7-1f1f4",a:"2.0"},{n:["flag-bq","caribbean netherlands flag"],u:"1f1e7-1f1f6",a:"2.0"},{n:["flag-br","brazil flag"],u:"1f1e7-1f1f7",a:"2.0"},{n:["flag-bs","bahamas flag"],u:"1f1e7-1f1f8",a:"2.0"},{n:["flag-bt","bhutan flag"],u:"1f1e7-1f1f9",a:"2.0"},{n:["flag-bv","bouvet island flag"],u:"1f1e7-1f1fb",a:"2.0"},{n:["flag-bw","botswana flag"],u:"1f1e7-1f1fc",a:"2.0"},{n:["flag-by","belarus flag"],u:"1f1e7-1f1fe",a:"2.0"},{n:["flag-bz","belize flag"],u:"1f1e7-1f1ff",a:"2.0"},{n:["flag-ca","canada flag"],u:"1f1e8-1f1e6",a:"2.0"},{n:["flag-cc","cocos (keeling) islands flag"],u:"1f1e8-1f1e8",a:"2.0"},{n:["flag-cd","congo - kinshasa flag"],u:"1f1e8-1f1e9",a:"2.0"},{n:["flag-cf","central african republic flag"],u:"1f1e8-1f1eb",a:"2.0"},{n:["flag-cg","congo - brazzaville flag"],u:"1f1e8-1f1ec",a:"2.0"},{n:["flag-ch","switzerland flag"],u:"1f1e8-1f1ed",a:"2.0"},{n:["flag-ci","cte divoire flag"],u:"1f1e8-1f1ee",a:"2.0"},{n:["flag-ck","cook islands flag"],u:"1f1e8-1f1f0",a:"2.0"},{n:["flag-cl","chile flag"],u:"1f1e8-1f1f1",a:"2.0"},{n:["flag-cm","cameroon flag"],u:"1f1e8-1f1f2",a:"2.0"},{n:["cn","flag-cn","china flag"],u:"1f1e8-1f1f3",a:"0.6"},{n:["flag-co","colombia flag"],u:"1f1e8-1f1f4",a:"2.0"},{n:["flag-cp","clipperton island flag"],u:"1f1e8-1f1f5",a:"2.0"},{n:["flag-cr","costa rica flag"],u:"1f1e8-1f1f7",a:"2.0"},{n:["flag-cu","cuba flag"],u:"1f1e8-1f1fa",a:"2.0"},{n:["flag-cv","cape verde flag"],u:"1f1e8-1f1fb",a:"2.0"},{n:["flag-cw","curaao flag"],u:"1f1e8-1f1fc",a:"2.0"},{n:["flag-cx","christmas island flag"],u:"1f1e8-1f1fd",a:"2.0"},{n:["flag-cy","cyprus flag"],u:"1f1e8-1f1fe",a:"2.0"},{n:["flag-cz","czechia flag"],u:"1f1e8-1f1ff",a:"2.0"},{n:["de","flag-de","germany flag"],u:"1f1e9-1f1ea",a:"0.6"},{n:["flag-dg","diego garcia flag"],u:"1f1e9-1f1ec",a:"2.0"},{n:["flag-dj","djibouti flag"],u:"1f1e9-1f1ef",a:"2.0"},{n:["flag-dk","denmark flag"],u:"1f1e9-1f1f0",a:"2.0"},{n:["flag-dm","dominica flag"],u:"1f1e9-1f1f2",a:"2.0"},{n:["flag-do","dominican republic flag"],u:"1f1e9-1f1f4",a:"2.0"},{n:["flag-dz","algeria flag"],u:"1f1e9-1f1ff",a:"2.0"},{n:["flag-ea","ceuta & melilla flag"],u:"1f1ea-1f1e6",a:"2.0"},{n:["flag-ec","ecuador flag"],u:"1f1ea-1f1e8",a:"2.0"},{n:["flag-ee","estonia flag"],u:"1f1ea-1f1ea",a:"2.0"},{n:["flag-eg","egypt flag"],u:"1f1ea-1f1ec",a:"2.0"},{n:["flag-eh","western sahara flag"],u:"1f1ea-1f1ed",a:"2.0"},{n:["flag-er","eritrea flag"],u:"1f1ea-1f1f7",a:"2.0"},{n:["es","flag-es","spain flag"],u:"1f1ea-1f1f8",a:"0.6"},{n:["flag-et","ethiopia flag"],u:"1f1ea-1f1f9",a:"2.0"},{n:["flag-eu","european union flag"],u:"1f1ea-1f1fa",a:"2.0"},{n:["flag-fi","finland flag"],u:"1f1eb-1f1ee",a:"2.0"},{n:["flag-fj","fiji flag"],u:"1f1eb-1f1ef",a:"2.0"},{n:["flag-fk","falkland islands flag"],u:"1f1eb-1f1f0",a:"2.0"},{n:["flag-fm","micronesia flag"],u:"1f1eb-1f1f2",a:"2.0"},{n:["flag-fo","faroe islands flag"],u:"1f1eb-1f1f4",a:"2.0"},{n:["fr","flag-fr","france flag"],u:"1f1eb-1f1f7",a:"0.6"},{n:["flag-ga","gabon flag"],u:"1f1ec-1f1e6",a:"2.0"},{n:["gb","uk","flag-gb","united kingdom flag"],u:"1f1ec-1f1e7",a:"0.6"},{n:["flag-gd","grenada flag"],u:"1f1ec-1f1e9",a:"2.0"},{n:["flag-ge","georgia flag"],u:"1f1ec-1f1ea",a:"2.0"},{n:["flag-gf","french guiana flag"],u:"1f1ec-1f1eb",a:"2.0"},{n:["flag-gg","guernsey flag"],u:"1f1ec-1f1ec",a:"2.0"},{n:["flag-gh","ghana flag"],u:"1f1ec-1f1ed",a:"2.0"},{n:["flag-gi","gibraltar flag"],u:"1f1ec-1f1ee",a:"2.0"},{n:["flag-gl","greenland flag"],u:"1f1ec-1f1f1",a:"2.0"},{n:["flag-gm","gambia flag"],u:"1f1ec-1f1f2",a:"2.0"},{n:["flag-gn","guinea flag"],u:"1f1ec-1f1f3",a:"2.0"},{n:["flag-gp","guadeloupe flag"],u:"1f1ec-1f1f5",a:"2.0"},{n:["flag-gq","equatorial guinea flag"],u:"1f1ec-1f1f6",a:"2.0"},{n:["flag-gr","greece flag"],u:"1f1ec-1f1f7",a:"2.0"},{n:["flag-gs","south georgia & south sandwich islands flag"],u:"1f1ec-1f1f8",a:"2.0"},{n:["flag-gt","guatemala flag"],u:"1f1ec-1f1f9",a:"2.0"},{n:["flag-gu","guam flag"],u:"1f1ec-1f1fa",a:"2.0"},{n:["flag-gw","guinea-bissau flag"],u:"1f1ec-1f1fc",a:"2.0"},{n:["flag-gy","guyana flag"],u:"1f1ec-1f1fe",a:"2.0"},{n:["flag-hk","hong kong sar china flag"],u:"1f1ed-1f1f0",a:"2.0"},{n:["flag-hm","heard & mcdonald islands flag"],u:"1f1ed-1f1f2",a:"2.0"},{n:["flag-hn","honduras flag"],u:"1f1ed-1f1f3",a:"2.0"},{n:["flag-hr","croatia flag"],u:"1f1ed-1f1f7",a:"2.0"},{n:["flag-ht","haiti flag"],u:"1f1ed-1f1f9",a:"2.0"},{n:["flag-hu","hungary flag"],u:"1f1ed-1f1fa",a:"2.0"},{n:["flag-ic","canary islands flag"],u:"1f1ee-1f1e8",a:"2.0"},{n:["flag-id","indonesia flag"],u:"1f1ee-1f1e9",a:"2.0"},{n:["flag-ie","ireland flag"],u:"1f1ee-1f1ea",a:"2.0"},{n:["flag-il","israel flag"],u:"1f1ee-1f1f1",a:"2.0"},{n:["flag-im","isle of man flag"],u:"1f1ee-1f1f2",a:"2.0"},{n:["flag-in","india flag"],u:"1f1ee-1f1f3",a:"2.0"},{n:["flag-io","british indian ocean territory flag"],u:"1f1ee-1f1f4",a:"2.0"},{n:["flag-iq","iraq flag"],u:"1f1ee-1f1f6",a:"2.0"},{n:["flag-ir","iran flag"],u:"1f1ee-1f1f7",a:"2.0"},{n:["flag-is","iceland flag"],u:"1f1ee-1f1f8",a:"2.0"},{n:["it","flag-it","italy flag"],u:"1f1ee-1f1f9",a:"0.6"},{n:["flag-je","jersey flag"],u:"1f1ef-1f1ea",a:"2.0"},{n:["flag-jm","jamaica flag"],u:"1f1ef-1f1f2",a:"2.0"},{n:["flag-jo","jordan flag"],u:"1f1ef-1f1f4",a:"2.0"},{n:["jp","flag-jp","japan flag"],u:"1f1ef-1f1f5",a:"0.6"},{n:["flag-ke","kenya flag"],u:"1f1f0-1f1ea",a:"2.0"},{n:["flag-kg","kyrgyzstan flag"],u:"1f1f0-1f1ec",a:"2.0"},{n:["flag-kh","cambodia flag"],u:"1f1f0-1f1ed",a:"2.0"},{n:["flag-ki","kiribati flag"],u:"1f1f0-1f1ee",a:"2.0"},{n:["flag-km","comoros flag"],u:"1f1f0-1f1f2",a:"2.0"},{n:["flag-kn","st. kitts & nevis flag"],u:"1f1f0-1f1f3",a:"2.0"},{n:["flag-kp","north korea flag"],u:"1f1f0-1f1f5",a:"2.0"},{n:["kr","flag-kr","south korea flag"],u:"1f1f0-1f1f7",a:"0.6"},{n:["flag-kw","kuwait flag"],u:"1f1f0-1f1fc",a:"2.0"},{n:["flag-ky","cayman islands flag"],u:"1f1f0-1f1fe",a:"2.0"},{n:["flag-kz","kazakhstan flag"],u:"1f1f0-1f1ff",a:"2.0"},{n:["flag-la","laos flag"],u:"1f1f1-1f1e6",a:"2.0"},{n:["flag-lb","lebanon flag"],u:"1f1f1-1f1e7",a:"2.0"},{n:["flag-lc","st. lucia flag"],u:"1f1f1-1f1e8",a:"2.0"},{n:["flag-li","liechtenstein flag"],u:"1f1f1-1f1ee",a:"2.0"},{n:["flag-lk","sri lanka flag"],u:"1f1f1-1f1f0",a:"2.0"},{n:["flag-lr","liberia flag"],u:"1f1f1-1f1f7",a:"2.0"},{n:["flag-ls","lesotho flag"],u:"1f1f1-1f1f8",a:"2.0"},{n:["flag-lt","lithuania flag"],u:"1f1f1-1f1f9",a:"2.0"},{n:["flag-lu","luxembourg flag"],u:"1f1f1-1f1fa",a:"2.0"},{n:["flag-lv","latvia flag"],u:"1f1f1-1f1fb",a:"2.0"},{n:["flag-ly","libya flag"],u:"1f1f1-1f1fe",a:"2.0"},{n:["flag-ma","morocco flag"],u:"1f1f2-1f1e6",a:"2.0"},{n:["flag-mc","monaco flag"],u:"1f1f2-1f1e8",a:"2.0"},{n:["flag-md","moldova flag"],u:"1f1f2-1f1e9",a:"2.0"},{n:["flag-me","montenegro flag"],u:"1f1f2-1f1ea",a:"2.0"},{n:["flag-mf","st. martin flag"],u:"1f1f2-1f1eb",a:"2.0"},{n:["flag-mg","madagascar flag"],u:"1f1f2-1f1ec",a:"2.0"},{n:["flag-mh","marshall islands flag"],u:"1f1f2-1f1ed",a:"2.0"},{n:["flag-mk","north macedonia flag"],u:"1f1f2-1f1f0",a:"2.0"},{n:["flag-ml","mali flag"],u:"1f1f2-1f1f1",a:"2.0"},{n:["flag-mm","myanmar (burma) flag"],u:"1f1f2-1f1f2",a:"2.0"},{n:["flag-mn","mongolia flag"],u:"1f1f2-1f1f3",a:"2.0"},{n:["flag-mo","macao sar china flag"],u:"1f1f2-1f1f4",a:"2.0"},{n:["flag-mp","northern mariana islands flag"],u:"1f1f2-1f1f5",a:"2.0"},{n:["flag-mq","martinique flag"],u:"1f1f2-1f1f6",a:"2.0"},{n:["flag-mr","mauritania flag"],u:"1f1f2-1f1f7",a:"2.0"},{n:["flag-ms","montserrat flag"],u:"1f1f2-1f1f8",a:"2.0"},{n:["flag-mt","malta flag"],u:"1f1f2-1f1f9",a:"2.0"},{n:["flag-mu","mauritius flag"],u:"1f1f2-1f1fa",a:"2.0"},{n:["flag-mv","maldives flag"],u:"1f1f2-1f1fb",a:"2.0"},{n:["flag-mw","malawi flag"],u:"1f1f2-1f1fc",a:"2.0"},{n:["flag-mx","mexico flag"],u:"1f1f2-1f1fd",a:"2.0"},{n:["flag-my","malaysia flag"],u:"1f1f2-1f1fe",a:"2.0"},{n:["flag-mz","mozambique flag"],u:"1f1f2-1f1ff",a:"2.0"},{n:["flag-na","namibia flag"],u:"1f1f3-1f1e6",a:"2.0"},{n:["flag-nc","new caledonia flag"],u:"1f1f3-1f1e8",a:"2.0"},{n:["flag-ne","niger flag"],u:"1f1f3-1f1ea",a:"2.0"},{n:["flag-nf","norfolk island flag"],u:"1f1f3-1f1eb",a:"2.0"},{n:["flag-ng","nigeria flag"],u:"1f1f3-1f1ec",a:"2.0"},{n:["flag-ni","nicaragua flag"],u:"1f1f3-1f1ee",a:"2.0"},{n:["flag-nl","netherlands flag"],u:"1f1f3-1f1f1",a:"2.0"},{n:["flag-no","norway flag"],u:"1f1f3-1f1f4",a:"2.0"},{n:["flag-np","nepal flag"],u:"1f1f3-1f1f5",a:"2.0"},{n:["flag-nr","nauru flag"],u:"1f1f3-1f1f7",a:"2.0"},{n:["flag-nu","niue flag"],u:"1f1f3-1f1fa",a:"2.0"},{n:["flag-nz","new zealand flag"],u:"1f1f3-1f1ff",a:"2.0"},{n:["flag-om","oman flag"],u:"1f1f4-1f1f2",a:"2.0"},{n:["flag-pa","panama flag"],u:"1f1f5-1f1e6",a:"2.0"},{n:["flag-pe","peru flag"],u:"1f1f5-1f1ea",a:"2.0"},{n:["flag-pf","french polynesia flag"],u:"1f1f5-1f1eb",a:"2.0"},{n:["flag-pg","papua new guinea flag"],u:"1f1f5-1f1ec",a:"2.0"},{n:["flag-ph","philippines flag"],u:"1f1f5-1f1ed",a:"2.0"},{n:["flag-pk","pakistan flag"],u:"1f1f5-1f1f0",a:"2.0"},{n:["flag-pl","poland flag"],u:"1f1f5-1f1f1",a:"2.0"},{n:["flag-pm","st. pierre & miquelon flag"],u:"1f1f5-1f1f2",a:"2.0"},{n:["flag-pn","pitcairn islands flag"],u:"1f1f5-1f1f3",a:"2.0"},{n:["flag-pr","puerto rico flag"],u:"1f1f5-1f1f7",a:"2.0"},{n:["flag-ps","palestinian territories flag"],u:"1f1f5-1f1f8",a:"2.0"},{n:["flag-pt","portugal flag"],u:"1f1f5-1f1f9",a:"2.0"},{n:["flag-pw","palau flag"],u:"1f1f5-1f1fc",a:"2.0"},{n:["flag-py","paraguay flag"],u:"1f1f5-1f1fe",a:"2.0"},{n:["flag-qa","qatar flag"],u:"1f1f6-1f1e6",a:"2.0"},{n:["flag-re","runion flag"],u:"1f1f7-1f1ea",a:"2.0"},{n:["flag-ro","romania flag"],u:"1f1f7-1f1f4",a:"2.0"},{n:["flag-rs","serbia flag"],u:"1f1f7-1f1f8",a:"2.0"},{n:["ru","flag-ru","russia flag"],u:"1f1f7-1f1fa",a:"0.6"},{n:["flag-rw","rwanda flag"],u:"1f1f7-1f1fc",a:"2.0"},{n:["flag-sa","saudi arabia flag"],u:"1f1f8-1f1e6",a:"2.0"},{n:["flag-sb","solomon islands flag"],u:"1f1f8-1f1e7",a:"2.0"},{n:["flag-sc","seychelles flag"],u:"1f1f8-1f1e8",a:"2.0"},{n:["flag-sd","sudan flag"],u:"1f1f8-1f1e9",a:"2.0"},{n:["flag-se","sweden flag"],u:"1f1f8-1f1ea",a:"2.0"},{n:["flag-sg","singapore flag"],u:"1f1f8-1f1ec",a:"2.0"},{n:["flag-sh","st. helena flag"],u:"1f1f8-1f1ed",a:"2.0"},{n:["flag-si","slovenia flag"],u:"1f1f8-1f1ee",a:"2.0"},{n:["flag-sj","svalbard & jan mayen flag"],u:"1f1f8-1f1ef",a:"2.0"},{n:["flag-sk","slovakia flag"],u:"1f1f8-1f1f0",a:"2.0"},{n:["flag-sl","sierra leone flag"],u:"1f1f8-1f1f1",a:"2.0"},{n:["flag-sm","san marino flag"],u:"1f1f8-1f1f2",a:"2.0"},{n:["flag-sn","senegal flag"],u:"1f1f8-1f1f3",a:"2.0"},{n:["flag-so","somalia flag"],u:"1f1f8-1f1f4",a:"2.0"},{n:["flag-sr","suriname flag"],u:"1f1f8-1f1f7",a:"2.0"},{n:["flag-ss","south sudan flag"],u:"1f1f8-1f1f8",a:"2.0"},{n:["flag-st","so tom & prncipe flag"],u:"1f1f8-1f1f9",a:"2.0"},{n:["flag-sv","el salvador flag"],u:"1f1f8-1f1fb",a:"2.0"},{n:["flag-sx","sint maarten flag"],u:"1f1f8-1f1fd",a:"2.0"},{n:["flag-sy","syria flag"],u:"1f1f8-1f1fe",a:"2.0"},{n:["flag-sz","eswatini flag"],u:"1f1f8-1f1ff",a:"2.0"},{n:["flag-ta","tristan da cunha flag"],u:"1f1f9-1f1e6",a:"2.0"},{n:["flag-tc","turks & caicos islands flag"],u:"1f1f9-1f1e8",a:"2.0"},{n:["flag-td","chad flag"],u:"1f1f9-1f1e9",a:"2.0"},{n:["flag-tf","french southern territories flag"],u:"1f1f9-1f1eb",a:"2.0"},{n:["flag-tg","togo flag"],u:"1f1f9-1f1ec",a:"2.0"},{n:["flag-th","thailand flag"],u:"1f1f9-1f1ed",a:"2.0"},{n:["flag-tj","tajikistan flag"],u:"1f1f9-1f1ef",a:"2.0"},{n:["flag-tk","tokelau flag"],u:"1f1f9-1f1f0",a:"2.0"},{n:["flag-tl","timor-leste flag"],u:"1f1f9-1f1f1",a:"2.0"},{n:["flag-tm","turkmenistan flag"],u:"1f1f9-1f1f2",a:"2.0"},{n:["flag-tn","tunisia flag"],u:"1f1f9-1f1f3",a:"2.0"},{n:["flag-to","tonga flag"],u:"1f1f9-1f1f4",a:"2.0"},{n:["flag-tr","turkey flag"],u:"1f1f9-1f1f7",a:"2.0"},{n:["flag-tt","trinidad & tobago flag"],u:"1f1f9-1f1f9",a:"2.0"},{n:["flag-tv","tuvalu flag"],u:"1f1f9-1f1fb",a:"2.0"},{n:["flag-tw","taiwan flag"],u:"1f1f9-1f1fc",a:"2.0"},{n:["flag-tz","tanzania flag"],u:"1f1f9-1f1ff",a:"2.0"},{n:["flag-ua","ukraine flag"],u:"1f1fa-1f1e6",a:"2.0"},{n:["flag-ug","uganda flag"],u:"1f1fa-1f1ec",a:"2.0"},{n:["flag-um","u.s. outlying islands flag"],u:"1f1fa-1f1f2",a:"2.0"},{n:["flag-un","united nations flag"],u:"1f1fa-1f1f3",a:"4.0"},{n:["us","flag-us","united states flag"],u:"1f1fa-1f1f8",a:"0.6"},{n:["flag-uy","uruguay flag"],u:"1f1fa-1f1fe",a:"2.0"},{n:["flag-uz","uzbekistan flag"],u:"1f1fa-1f1ff",a:"2.0"},{n:["flag-va","vatican city flag"],u:"1f1fb-1f1e6",a:"2.0"},{n:["flag-vc","st. vincent & grenadines flag"],u:"1f1fb-1f1e8",a:"2.0"},{n:["flag-ve","venezuela flag"],u:"1f1fb-1f1ea",a:"2.0"},{n:["flag-vg","british virgin islands flag"],u:"1f1fb-1f1ec",a:"2.0"},{n:["flag-vi","u.s. virgin islands flag"],u:"1f1fb-1f1ee",a:"2.0"},{n:["flag-vn","vietnam flag"],u:"1f1fb-1f1f3",a:"2.0"},{n:["flag-vu","vanuatu flag"],u:"1f1fb-1f1fa",a:"2.0"},{n:["flag-wf","wallis & futuna flag"],u:"1f1fc-1f1eb",a:"2.0"},{n:["flag-ws","samoa flag"],u:"1f1fc-1f1f8",a:"2.0"},{n:["flag-xk","kosovo flag"],u:"1f1fd-1f1f0",a:"2.0"},{n:["flag-ye","yemen flag"],u:"1f1fe-1f1ea",a:"2.0"},{n:["flag-yt","mayotte flag"],u:"1f1fe-1f1f9",a:"2.0"},{n:["flag-za","south africa flag"],u:"1f1ff-1f1e6",a:"2.0"},{n:["flag-zm","zambia flag"],u:"1f1ff-1f1f2",a:"2.0"},{n:["flag-zw","zimbabwe flag"],u:"1f1ff-1f1fc",a:"2.0"},{n:["england flag","flag-england"],u:"1f3f4-e0067-e0062-e0065-e006e-e0067-e007f",a:"5.0"},{n:["scotland flag","flag-scotland"],u:"1f3f4-e0067-e0062-e0073-e0063-e0074-e007f",a:"5.0"},{n:["wales flag","flag-wales"],u:"1f3f4-e0067-e0062-e0077-e006c-e0073-e007f",a:"5.0"}],v5={custom:vSe,smileys_people:SSe,animals_nature:ySe,food_drink:TSe,travel_places:bSe,activities:CSe,objects:wSe,symbols:RSe,flags:ISe},nG=[c0.NEUTRAL,c0.LIGHT,c0.MEDIUM_LIGHT,c0.MEDIUM,c0.MEDIUM_DARK,c0.DARK],ASe=Object.entries(c0).reduce(function(o,d){var h=d[0],g=d[1];return o[g]=h,o},{}),OSe=nG.reduce(function(o,d){var h;return Object.assign(o,(h={},h[d]=d,h))},{}),hm;(function(o){o.name="n",o.unified="u",o.variations="v",o.added_in="a",o.imgUrl="imgUrl"})(hm||(hm={}));var s5={};setTimeout(function(){UG.reduce(function(o,d){return poe(d),o},s5)});function poe(o){var d=G5(o).flat().join("").toLowerCase().replace(/[^a-zA-Z\d]/g,"").split("");d.forEach(function(h){var g;s5[h]=(g=s5[h])!=null?g:{},s5[h][mu(o)]=o})}function G5(o){var d;return(d=o[hm.name])!=null?d:[]}function NSe(o){return parseFloat(o[hm.added_in])}function XX(o){return o?G5(o)[0]:""}function eZ(o){var d=o.split("-"),h=d.splice(1,1),g=h[0];return OSe[g]?d.join("-"):o}function mu(o,d){var h,g=o[hm.unified];return!d||!VP(o)?g:(h=DSe(o,d))!=null?h:g}function LSe(o){var d;return(d=v5==null?void 0:v5[o])!=null?d:[]}function moe(o,d){return""+ESe(d)+o+".png"}function z5(o){var d;return(d=o[hm.variations])!=null?d:[]}function VP(o){return z5(o).length>0}function DSe(o,d){return d?z5(o).find(function(h){return h.includes(d)}):mu(o)}function wP(o){if(o){if(_P[o])return _P[o];var d=eZ(o);return _P[d]}}var UG=Object.values(v5).flat();function PSe(o){v5[Ei.CUSTOM].length=0,o.forEach(function(d){var h=MSe(d);v5[Ei.CUSTOM].push(h),!_P[h[hm.unified]]&&(UG.push(h),_P[h[hm.unified]]=h,poe(h))})}function MSe(o){var d;return d={},d[hm.name]=o.names.map(function(h){return h.toLowerCase()}),d[hm.unified]=o.id.toLowerCase(),d[hm.added_in]="0",d[hm.imgUrl]=o.imgUrl,d}var _P={};setTimeout(function(){UG.reduce(function(o,d){return o[mu(d)]=d,VP(d)&&z5(d).forEach(function(h){o[h]=d}),o},_P)});function kSe(o){var d=o.split("-"),h=d[1];return nG.includes(h)?h:null}var xSe=["2640-fe0f","2642-fe0f","2695-fe0f"],rG="Search",USe="No results found",goe=" found. Use up and down arrow keys to navigate.",jSe="1 result"+goe,VSe="%n results"+goe;function Pee(o){var d,h;o===void 0&&(o={});var g=_oe(),T=Object.assign(g.previewConfig,(d=o.previewConfig)!=null?d:{}),I=Object.assign(g,o),N=hSe(o.categories,{suggestionMode:I.suggestedEmojisMode});I.hiddenEmojis.forEach(function(k){I.unicodeToHide.add(k)}),PSe((h=I.customEmojis)!=null?h:[]);var M=I.searchDisabled?CP.PREVIEW:I.skinTonePickerLocation;return Ys({},I,{categories:N,previewConfig:T,skinTonePickerLocation:M})}function _oe(){return{autoFocusSearch:!0,categories:foe(),className:"",customEmojis:[],defaultSkinTone:c0.NEUTRAL,emojiStyle:Ph.APPLE,emojiVersion:null,getEmojiUrl:moe,height:450,lazyLoadEmojis:!1,previewConfig:Ys({},BSe),searchDisabled:!1,searchPlaceHolder:rG,searchPlaceholder:rG,skinTonePickerLocation:CP.SEARCH,skinTonesDisabled:!1,style:{},suggestedEmojisMode:_5.FREQUENT,theme:E5.LIGHT,unicodeToHide:new Set(xSe),width:350,reactionsDefaultOpen:!1,reactions:dSe,open:!0,allowExpandReactions:!0,hiddenEmojis:[]}}var BSe={defaultEmoji:"1f60a",defaultCaption:"What's your mood?",showPreview:!0},FSe=["children"],Eoe=q.createContext(_oe());function GSe(o){var d=o.children,h=loe(o,FSe),g=zSe(h);return q.createElement(Eoe.Provider,{value:g},d)}function zSe(o){var d,h=q.useState(function(){return Pee(o)}),g=h[0],T=h[1];return q.useEffect(function(){doe(g,o)||T(Pee(o))},[(d=o.customEmojis)==null?void 0:d.length,o.open,o.emojiVersion,o.reactionsDefaultOpen,o.searchPlaceHolder,o.searchPlaceholder,o.defaultSkinTone,o.skinTonesDisabled,o.autoFocusSearch,o.emojiStyle,o.theme,o.suggestedEmojisMode,o.lazyLoadEmojis,o.className,o.height,o.width,o.searchDisabled,o.skinTonePickerLocation,o.allowExpandReactions]),g}function ho(){return q.useContext(Eoe)}var voe=fo.createContext({});function Soe(){var o=fo.useContext(voe);return o}function HSe(o){var d=fo.useRef({onEmojiClick:o.onEmojiClick||h7,onReactionClick:o.onReactionClick||o.onEmojiClick,onSkinToneChange:o.onSkinToneChange||h7});return fo.useEffect(function(){d.current.onEmojiClick=o.onEmojiClick||h7,d.current.onReactionClick=o.onReactionClick||o.onEmojiClick},[o.onEmojiClick,o.onReactionClick]),fo.useEffect(function(){d.current.onSkinToneChange=o.onSkinToneChange||h7},[o.onSkinToneChange]),d}function h7(){}var S5;(function(o){o.REACTIONS="reactions",o.PICKER="picker"})(S5||(S5={}));function WSe(){var o,d=ho(),h=d.searchPlaceHolder,g=d.searchPlaceholder;return(o=[h,g].find(function(T){return T!==rG}))!=null?o:rG}function YSe(){var o=ho(),d=o.defaultSkinTone;return d}function yoe(){var o=ho(),d=o.allowExpandReactions;return d}function Toe(){var o=ho(),d=o.skinTonesDisabled;return d}function JA(){var o=ho(),d=o.emojiStyle;return d}function KSe(){var o=ho(),d=o.autoFocusSearch;return d}function boe(){var o=ho(),d=o.categories;return d}function qSe(){var o=ho(),d=o.customEmojis;return d}function JSe(){var o=ho(),d=o.open;return d}function XSe(o){var d,h=Soe(),g=h.current,T=(d=o===S5.REACTIONS?g.onReactionClick:g.onEmojiClick)!=null?d:g.onEmojiClick;return T||function(){}}function QSe(){var o=Soe(),d=o.current;return d.onSkinToneChange||function(){}}function Coe(){var o=ho(),d=o.previewConfig;return d}function ZSe(){var o=ho(),d=o.theme;return d}function $Se(){var o=ho(),d=o.suggestedEmojisMode;return d}function eye(){var o=ho(),d=o.lazyLoadEmojis;return d}function tye(){var o=ho(),d=o.className;return d}function nye(){var o=ho(),d=o.height,h=o.width,g=o.style;return Ys({height:Mee(d),width:Mee(h)},g)}function rye(){var o=ho(),d=o.reactionsDefaultOpen;return d}function iye(){var o=ho(),d=o.emojiVersion;return d}function woe(){var o=ho(),d=o.searchDisabled;return d}function Roe(){var o=ho(),d=o.skinTonePickerLocation;return d}function aye(){var o=ho(),d=o.unicodeToHide;return d}function sye(){var o=ho(),d=o.reactions;return d}function XA(){var o=ho(),d=o.getEmojiUrl;return d}function Mee(o){return typeof o=="number"?o+"px":o}function oye(o){var d=o>0,h=o>1;return d?h?VSe.replace("%n",o.toString()):jSe:USe}function kee(o,d){d===void 0&&(d=0);var h=q.useState(o),g=h[0],T=h[1],I=q.useRef(null);function N(M){return new Promise(function(k){var x;I.current&&clearTimeout(I.current),I.current=(x=window)==null?void 0:x.setTimeout(function(){T(M),k(M)},d)})}return[g,N]}function cye(){var o=aye();return function(d){return o.has(d)}}function Ioe(){var o=q.useRef({}),d=iye();return q.useMemo(function(){var h=parseFloat(""+d);return!d||Number.isNaN(h)?o.current:UG.reduce(function(g,T){return dye(T,h)&&(g[mu(T)]=!0),g},o.current)},[d])}function lye(){var o=Ioe(),d=cye();return function(g){var T=eZ(mu(g));return!!(o[T]||d(T))}}function dye(o,d){return NSe(o)>d}function uye(o){q.useEffect(function(){o(!0)},[o])}function fye(o){var d=o.children,h=Ioe(),g=YSe(),T=rye(),I=q.useRef(s5),N=q.useRef(!1),M=q.useRef(!1),k=q.useRef(h),x=kee(Date.now(),200),V=kee("",100),K=q.useState(!1),Q=q.useState(g),ie=q.useState(null),X=q.useState(new Set),Z=q.useState(null),ae=q.useState(T),le=q.useState(!1),fe=le[0],ue=le[1];return uye(ue),q.createElement(Em.Provider,{value:{activeCategoryState:ie,activeSkinTone:Q,disallowClickRef:N,disallowMouseRef:M,disallowedEmojisRef:k,emojiVariationPickerState:Z,emojisThatFailedToLoadState:X,filterRef:I,isPastInitialLoad:fe,searchTerm:V,skinToneFanOpenState:K,suggestedUpdateState:x,reactionsModeState:ae}},d)}var Em=q.createContext({activeCategoryState:[null,function(){}],activeSkinTone:[c0.NEUTRAL,function(){}],disallowClickRef:{current:!1},disallowMouseRef:{current:!1},disallowedEmojisRef:{current:{}},emojiVariationPickerState:[null,function(){}],emojisThatFailedToLoadState:[new Set,function(){}],filterRef:{current:{}},isPastInitialLoad:!0,searchTerm:["",function(){return new Promise(function(){})}],skinToneFanOpenState:[!1,function(){}],suggestedUpdateState:[Date.now(),function(){}],reactionsModeState:[!1,function(){}]});function tZ(){var o=q.useContext(Em),d=o.filterRef;return d}function hye(){var o=q.useContext(Em),d=o.disallowClickRef;return d}function nZ(){var o=q.useContext(Em),d=o.disallowMouseRef;return d}function jG(){var o=q.useContext(Em),d=o.reactionsModeState;return d}function VG(){var o=q.useContext(Em),d=o.searchTerm;return d}function rZ(){var o=q.useContext(Em),d=o.activeSkinTone;return d}function Aoe(){var o=q.useContext(Em),d=o.emojisThatFailedToLoadState;return d}function pye(){var o=q.useContext(Em),d=o.isPastInitialLoad;return d}function BP(){var o=q.useContext(Em),d=o.emojiVariationPickerState;return d}function H5(){var o=q.useContext(Em),d=o.skinToneFanOpenState;return d}function Ooe(){var o=q.useContext(Em),d=o.suggestedUpdateState,h=d[0],g=d[1];return[h,function(){g(Date.now())}]}function BG(){var o=VG(),d=o[0];return!!d}function Uh(o){o&&requestAnimationFrame(function(){o.focus()})}function Noe(o){if(o){var d=o.previousElementSibling;Uh(d)}}function Loe(o){if(o){var d=o.nextElementSibling;Uh(d)}}function Doe(o){if(o){var d=o.firstElementChild;Uh(d)}}function y5(){return document.activeElement}function mye(o){var d=o.children,h=q.useRef(null),g=q.useRef(null),T=q.useRef(null),I=q.useRef(null),N=q.useRef(null),M=q.useRef(null),k=q.useRef(null),x=q.useRef(null);return q.createElement(Poe.Provider,{value:{AnchoredEmojiRef:g,BodyRef:T,CategoryNavigationRef:M,PickerMainRef:h,SearchInputRef:I,SkinTonePickerRef:N,VariationPickerRef:k,ReactionsRef:x}},d)}var Poe=q.createContext({AnchoredEmojiRef:q.createRef(),BodyRef:q.createRef(),CategoryNavigationRef:q.createRef(),PickerMainRef:q.createRef(),SearchInputRef:q.createRef(),SkinTonePickerRef:q.createRef(),VariationPickerRef:q.createRef(),ReactionsRef:q.createRef()});function aC(){return q.useContext(Poe)}function W5(){return aC().PickerMainRef}function FG(){return aC().AnchoredEmojiRef}function Moe(){var o=FG();return function(d){d===null&&o.current!==null&&Uh(o.current),o.current=d}}function vm(){return aC().BodyRef}function gye(){return aC().ReactionsRef}function sC(){return aC().SearchInputRef}function iZ(){return aC().SkinTonePickerRef}function aZ(){return aC().CategoryNavigationRef}function _ye(){return aC().VariationPickerRef}function koe(o,d){d===void 0&&(d=0);var h=Xoe(o);h&&requestAnimationFrame(function(){h.scrollTop=d})}function Eye(o,d){var h=Xoe(o);h&&requestAnimationFrame(function(){h.scrollTop=h.scrollTop+d})}function vye(){var o=vm();return q.useCallback(function(d){requestAnimationFrame(function(){o.current&&(o.current.scrollTop=d)})},[o])}function GG(o){if(!(!o||!lTe(o))&&!o.closest(Sd(vi.variationPicker))){var d=Zoe(o),h=Qoe(o);Eye(d,-(uZ(oC(o))-h))}}function zG(o){var d=mZ(o);Uh(d),GG(d)}function Sye(o){var d=mZ(o);Uh(d),d==null||d.click()}function yye(o){Uh(nce(o))}function Tye(o){if(o){var d=rce(o);if(!d)return zG(WG(o));Uh(d),GG(d)}}function bye(o){if(o){var d=pZ(o);if(!d)return yye(HG(o));Uh(d),GG(d)}}function Cye(o,d){if(o){var h=Rye(o);if(!h)return d();Uh(h),GG(h)}}function wye(o){if(o){var d=Iye(o);return Uh(d)}}function Rye(o){if(!o)return null;var d=ice(o),h=oC(d),g=Yoe(d,o),T=Koe(d,o),I=Woe(d,o);if(T===0){var N=HG(h);return N?qoe(RP(N),-1,I,g):null}return rTe(RP(d),T,I,g)}function Iye(o){if(!o)return null;var d=ice(o),h=oC(d),g=Yoe(d,o),T=Koe(d,o),I=Woe(d,o);if(!eTe(d,o)){var N=WG(h);return N?qoe(RP(N),0,I,g):null}var M=nTe(RP(d),T,I,g);return M}function QA(){var o=BP(),d=o[0],h=o[1],g=H5(),T=g[0],I=g[1],N=q.useCallback(function(){d&&h(null),T&&I(!1)},[d,T,h,I]);return N}function xoe(){var o=BP(),d=o[0],h=H5(),g=h[0];return function(){return!!d||g}}function Aye(){var o=nZ();return function(){o.current=!0}}function Uoe(){var o=nZ();return function(){o.current=!1}}function joe(){var o=nZ();return function(){return o.current}}function Oye(){var o=vm(),d=Uoe(),h=joe();q.useEffect(function(){var g=o.current;g==null||g.addEventListener("mousemove",T,{passive:!0});function T(){h()&&d()}return function(){g==null||g.removeEventListener("mousemove",T)}},[o,d,h])}function ZA(){var o=sC();return q.useCallback(function(){Uh(o.current)},[o])}function Nye(){var o=iZ();return q.useCallback(function(){o.current&&Doe(o.current)},[o])}function Voe(){var o=aZ();return q.useCallback(function(){o.current&&Doe(o.current)},[o])}function Lye(){var o=tZ();return function d(h){if(typeof h=="function")return d(h(o.current));o.current=h}}function Boe(){var o=sZ(),d=sC(),h=ZA();return function(){d.current&&(d.current.value=""),o(""),h()}}function Dye(){var o=sC(),d=sZ();return function(g){o.current?(o.current.value=""+o.current.value+g,d(QX(o.current.value))):d(QX(g))}}function Pye(){var o=sC(),d=tZ(),h=Lye(),g=sZ(),T=VG(),I=T[0],N=Vye(d.current,I);return{onChange:M,searchTerm:I,SearchInputRef:o,statusSearchResults:N};function M(k){var x=d.current,V=k.toLowerCase();if(x!=null&&x[V]||V.length<=1)return g(V);var K=jye(V,x);if(!K)return g(V);h(function(Q){var ie;return Object.assign(Q,(ie={},ie[V]=Mye(K,V),ie))}),g(V)}}function sZ(){var o=VG(),d=o[1],h=W5();return function(T){requestAnimationFrame(function(){d(T&&(T==null?void 0:T.toLowerCase())).then(function(){koe(h.current,0)})})}}function Mye(o,d){var h={};for(var g in o){var T=o[g];kye(T,d)&&(h[g]=T)}return h}function kye(o,d){return G5(o).some(function(h){return h.includes(d)})}function xye(){var o=tZ(),d=o.current,h=VG(),g=h[0];return function(T){return Uye(T,d,g)}}function Uye(o,d,h){var g;return!d||!h?!1:!((g=d[h])!=null&&g[o])}function jye(o,d){if(!d)return null;if(d[o])return d[o];var h=Object.keys(d).sort(function(g,T){return T.length-g.length}).find(function(g){return o.includes(g)});return h?d[h]:null}function QX(o){return!o||typeof o!="string"?"":o.trim().toLowerCase()}function Vye(o,d){var h;if(!(o!=null&&o[d]))return"";var g=((h=Object.entries(o==null?void 0:o[d]))==null?void 0:h.length)||0;return oye(g)}function Foe(){var o=Moe(),d=BP(),h=d[1];return function(T){var I=dZ(T),N=I[0];N&&(o(T),h(N))}}function oZ(){var o=Roe();return o===CP.SEARCH}function Goe(){var o=Roe();return o===CP.PREVIEW}var Qo;(function(o){o.ArrowDown="ArrowDown",o.ArrowUp="ArrowUp",o.ArrowLeft="ArrowLeft",o.ArrowRight="ArrowRight",o.Escape="Escape",o.Enter="Enter",o.Space=" "})(Qo||(Qo={}));function Bye(){Fye(),Gye(),zye(),Hye(),Wye()}function Fye(){var o=W5(),d=Boe(),h=vye(),g=sC(),T=ZA(),I=xoe(),N=Aye(),M=QA(),k=q.useMemo(function(){return function(V){var K=V.key;switch(N(),K){case Qo.Escape:if(V.preventDefault(),I()){M();return}d(),h(0),T();break}}},[h,d,M,T,I,N]);q.useEffect(function(){var x=o.current;if(x)return x.addEventListener("keydown",k),function(){x.removeEventListener("keydown",k)}},[o,g,h,k])}function Gye(){var o=Nye(),d=W5(),h=vm(),g=sC(),T=H5(),I=T[1],N=zoe(),M=oZ(),k=q.useMemo(function(){return function(V){var K=V.key;switch(K){case Qo.ArrowRight:if(!M)return;V.preventDefault(),I(!0),o();break;case Qo.ArrowDown:V.preventDefault(),N();break;case Qo.Enter:V.preventDefault(),Sye(h.current);break}}},[o,N,I,h,M]);q.useEffect(function(){var x=g.current;if(x)return x.addEventListener("keydown",k),function(){x.removeEventListener("keydown",k)}},[d,g,k])}function zye(){var o=iZ(),d=ZA(),h=sC(),g=zoe(),T=H5(),I=T[0],N=T[1],M=Goe(),k=oZ(),x=cZ(),V=q.useMemo(function(){return function(Q){var ie=Q.key;if(k)switch(ie){case Qo.ArrowLeft:if(Q.preventDefault(),!I)return d();xee(d);break;case Qo.ArrowRight:if(Q.preventDefault(),!I)return d();Uee();break;case Qo.ArrowDown:Q.preventDefault(),I&&N(!1),g();break;default:x(Q);break}if(M)switch(ie){case Qo.ArrowUp:if(Q.preventDefault(),!I)return d();xee(d);break;case Qo.ArrowDown:if(Q.preventDefault(),!I)return d();Uee();break;default:x(Q);break}}},[I,d,N,g,x,M,k]);q.useEffect(function(){var K=o.current;if(K)return K.addEventListener("keydown",V),function(){K.removeEventListener("keydown",V)}},[o,h,I,V])}function Hye(){var o=ZA(),d=aZ(),h=vm(),g=cZ(),T=q.useMemo(function(){return function(N){var M=N.key;switch(M){case Qo.ArrowUp:N.preventDefault(),o();break;case Qo.ArrowRight:N.preventDefault(),Loe(y5());break;case Qo.ArrowLeft:N.preventDefault(),Noe(y5());break;case Qo.ArrowDown:N.preventDefault(),zG(h.current);break;default:g(N);break}}},[h,o,g]);q.useEffect(function(){var I=d.current;if(I)return I.addEventListener("keydown",T),function(){I.removeEventListener("keydown",T)}},[d,h,T])}function Wye(){var o=vm(),d=Yye(),h=Foe(),g=xoe(),T=QA(),I=cZ(),N=q.useMemo(function(){return function(k){var x=k.key,V=f0(y5());switch(x){case Qo.ArrowRight:k.preventDefault(),Tye(V);break;case Qo.ArrowLeft:k.preventDefault(),bye(V);break;case Qo.ArrowDown:if(k.preventDefault(),g()){T();break}wye(V);break;case Qo.ArrowUp:if(k.preventDefault(),g()){T();break}Cye(V,d);break;case Qo.Space:k.preventDefault(),h(k.target);break;default:I(k);break}}},[d,I,h,g,T]);q.useEffect(function(){var M=o.current;if(M)return M.addEventListener("keydown",N),function(){M.removeEventListener("keydown",N)}},[o,N])}function zoe(){var o=Voe(),d=BG(),h=vm();return q.useCallback(function(){return d?zG(h.current):o()},[h,o,d])}function Yye(){var o=ZA(),d=Voe(),h=BG();return q.useCallback(function(){return h?o():d()},[o,h,d])}function xee(o){var d=y5();d&&(aTe(d)||o(),Loe(d))}function Uee(){var o=y5();o&&Noe(o)}function cZ(){var o=Dye(),d=ZA(),h=woe(),g=QA();return function(I){var N=I.key;Kye(I)||h||N.match(/(^[a-zA-Z0-9]$){1}/)&&(I.preventDefault(),g(),d(),o(N))}}function Kye(o){var d=o.metaKey,h=o.ctrlKey,g=o.altKey;return d||h||g}function qye(o,d,h){if(d&&h!==Ph.NATIVE){var g=mu(d);jee.has(g)||(z5(d).forEach(function(T){var I=o(T,h);Jye(I)}),jee.add(g))}}var jee=new Set;function Jye(o){var d=new Image;d.src=o}function Xye(){var o=vm(),d=JA(),h=XA();q.useEffect(function(){if(d===Ph.NATIVE)return;var g=o.current;return g==null||g.addEventListener("focusin",T),function(){g==null||g.removeEventListener("focusin",T)};function T(I){var N=f0(I.target);if(N){var M=dZ(N),k=M[0];k&&VP(k)&&qye(h,k,d)}}},[o,d,h])}var Qye=["width","height"],Hoe=40;function Zye(o){var d=o.children;return q.createElement(fye,null,q.createElement($ye,null,d))}function $ye(o){var d,h=o.children,g=jG(),T=g[0],I=ZSe(),N=BG(),M=W5(),k=tye(),x=nye();Bye(),Xye();var V=x||{},K=V.width,Q=V.height,ie=loe(V,Qye);return q.createElement("aside",{className:Mi(Bj.main,Bj.baseVariables,I===E5.DARK&&Bj.darkTheme,I===E5.AUTO&&Bj.autoThemeDark,(d={},d[vi.searchActive]=N,d),T&&Bj.reactionsMenu,k),ref:M,style:Ys({},ie,!T&&{height:Q,width:K})},h)}var Vee={"--epr-emoji-variation-picker-bg-color":"var(--epr-dark-emoji-variation-picker-bg-color)","--epr-hover-bg-color-reduced-opacity":"var(--epr-dark-hover-bg-color-reduced-opacity)","--epr-highlight-color":"var(--epr-dark-highlight-color)","--epr-text-color":"var(--epr-dark-text-color)","--epr-hover-bg-color":"var(--epr-dark-hover-bg-color)","--epr-focus-bg-color":"var(--epr-dark-focus-bg-color)","--epr-search-input-bg-color":"var(--epr-dark-search-input-bg-color)","--epr-category-label-bg-color":"var(--epr-dark-category-label-bg-color)","--epr-picker-border-color":"var(--epr-dark-picker-border-color)","--epr-bg-color":"var(--epr-dark-bg-color)","--epr-reactions-bg-color":"var(--epr-dark-reactions-bg-color)","--epr-search-input-bg-color-active":"var(--epr-dark-search-input-bg-color-active)","--epr-emoji-variation-indicator-color":"var(--epr-dark-emoji-variation-indicator-color)","--epr-category-icon-active-color":"var(--epr-dark-category-icon-active-color)","--epr-skin-tone-picker-menu-color":"var(--epr-dark-skin-tone-picker-menu-color)","--epr-skin-tone-outer-border-color":"var(--epr-dark-skin-tone-outer-border-color)","--epr-skin-tone-inner-border-color":"var(--epr-dark-skin-tone-inner-border-color)"},Bj=Ns.create({main:{".":["epr-main",vi.emojiPicker],position:"relative",display:"flex",flexDirection:"column",borderWidth:"1px",borderStyle:"solid",borderRadius:"var(--epr-picker-border-radius)",borderColor:"var(--epr-picker-border-color)",backgroundColor:"var(--epr-bg-color)",overflow:"hidden",transition:"all 0.3s ease-in-out, background-color 0.1s ease-in-out","*":{boxSizing:"border-box",fontFamily:"sans-serif"}},baseVariables:{"--":{"--epr-highlight-color":"#007aeb","--epr-hover-bg-color":"#e5f0fa","--epr-hover-bg-color-reduced-opacity":"#e5f0fa80","--epr-focus-bg-color":"#e0f0ff","--epr-text-color":"#858585","--epr-search-input-bg-color":"#f6f6f6","--epr-picker-border-color":"#e7e7e7","--epr-bg-color":"#fff","--epr-reactions-bg-color":"#ffffff90","--epr-category-icon-active-color":"#6aa8de","--epr-skin-tone-picker-menu-color":"#ffffff95","--epr-skin-tone-outer-border-color":"#555555","--epr-skin-tone-inner-border-color":"var(--epr-bg-color)","--epr-horizontal-padding":"10px","--epr-picker-border-radius":"8px","--epr-search-border-color":"var(--epr-highlight-color)","--epr-header-padding":"15px var(--epr-horizontal-padding)","--epr-active-skin-tone-indicator-border-color":"var(--epr-highlight-color)","--epr-active-skin-hover-color":"var(--epr-hover-bg-color)","--epr-search-input-bg-color-active":"var(--epr-search-input-bg-color)","--epr-search-input-padding":"0 30px","--epr-search-input-border-radius":"8px","--epr-search-input-height":"40px","--epr-search-input-text-color":"var(--epr-text-color)","--epr-search-input-placeholder-color":"var(--epr-text-color)","--epr-search-bar-inner-padding":"var(--epr-horizontal-padding)","--epr-category-navigation-button-size":"30px","--epr-emoji-variation-picker-height":"45px","--epr-emoji-variation-picker-bg-color":"var(--epr-bg-color)","--epr-preview-height":"70px","--epr-preview-text-size":"14px","--epr-preview-text-padding":"0 var(--epr-horizontal-padding)","--epr-preview-border-color":"var(--epr-picker-border-color)","--epr-preview-text-color":"var(--epr-text-color)","--epr-category-padding":"0 var(--epr-horizontal-padding)","--epr-category-label-bg-color":"#ffffffe6","--epr-category-label-text-color":"var(--epr-text-color)","--epr-category-label-padding":"0 var(--epr-horizontal-padding)","--epr-category-label-height":Hoe+"px","--epr-emoji-size":"30px","--epr-emoji-padding":"5px","--epr-emoji-fullsize":"calc(var(--epr-emoji-size) + var(--epr-emoji-padding) * 2)","--epr-emoji-hover-color":"var(--epr-hover-bg-color)","--epr-emoji-variation-indicator-color":"var(--epr-picker-border-color)","--epr-emoji-variation-indicator-color-hover":"var(--epr-text-color)","--epr-header-overlay-z-index":"3","--epr-emoji-variations-indictator-z-index":"1","--epr-category-label-z-index":"2","--epr-skin-variation-picker-z-index":"5","--epr-preview-z-index":"6","--epr-dark":"#000","--epr-dark-emoji-variation-picker-bg-color":"var(--epr-dark)","--epr-dark-highlight-color":"#c0c0c0","--epr-dark-text-color":"var(--epr-highlight-color)","--epr-dark-hover-bg-color":"#363636f6","--epr-dark-hover-bg-color-reduced-opacity":"#36363680","--epr-dark-focus-bg-color":"#474747","--epr-dark-search-input-bg-color":"#333333","--epr-dark-category-label-bg-color":"#222222e6","--epr-dark-picker-border-color":"#151617","--epr-dark-bg-color":"#222222","--epr-dark-reactions-bg-color":"#22222290","--epr-dark-search-input-bg-color-active":"var(--epr-dark)","--epr-dark-emoji-variation-indicator-color":"#444","--epr-dark-category-icon-active-color":"#3271b7","--epr-dark-skin-tone-picker-menu-color":"#22222295","--epr-dark-skin-tone-outer-border-color":"var(--epr-dark-picker-border-color)","--epr-dark-skin-tone-inner-border-color":"#FFFFFF"}},autoThemeDark:{".":vi.autoTheme,"@media (prefers-color-scheme: dark)":{"--":Vee}},darkTheme:{".":vi.darkTheme,"--":Vee},reactionsMenu:{".":"epr-reactions",height:"50px",display:"inline-flex",backgroundColor:"var(--epr-reactions-bg-color)",backdropFilter:"blur(8px)","--":{"--epr-picker-border-radius":"50px"}}});function Woe(o,d){if(!o||!d)return 0;var h=o.getBoundingClientRect().width,g=d.getBoundingClientRect().width;return Math.floor(h/g)}function Yoe(o,d){if(!o||!d)return 0;var h=d.getBoundingClientRect().width,g=d.getBoundingClientRect().left,T=o.getBoundingClientRect().left;return Math.floor((g-T)/h)}function Koe(o,d){if(!o||!d)return 0;var h=d.getBoundingClientRect().height,g=d.getBoundingClientRect().top,T=o.getBoundingClientRect().top;return Math.round((g-T)/h)}function eTe(o,d){if(!o||!d)return!1;var h=d.getBoundingClientRect().height,g=d.getBoundingClientRect().top,T=o.getBoundingClientRect().top,I=o.getBoundingClientRect().height;return Math.round(g-T+h)<I}function lZ(o,d,h){if(d===-1){var g=Math.floor((o.length-1)/h),T=g*h,I=o.length-1;return o.slice(T,I+1)}return o.slice(d*h,(d+1)*h)}function tTe(o,d,h){var g=d+1;return g*h>o.length?[]:lZ(o,g,h)}function qoe(o,d,h,g){var T=lZ(o,d,h);return T[g]||T[T.length-1]||null}function nTe(o,d,h,g){var T=tTe(o,d,h);return T[g]||T[T.length-1]||null}function rTe(o,d,h,g){var T=lZ(o,d-1,h);return T[g]||T[T.length-1]||null}function iTe(o,d,h){if(!o||!d.length)return null;var g=o.getBoundingClientRect().top,T=o.getBoundingClientRect().bottom,I=g+sTe(o),N=d.find(function(M){var k=M.getBoundingClientRect().top,x=M.getBoundingClientRect().bottom,V=M.clientHeight*h,K=k+V,Q=x-V;return K<I?!1:K>=g&&K<=T||Q>=g&&Q<=T});return N||null}function aTe(o){return!!o.nextElementSibling}function sTe(o){for(var d=Array.from(o.querySelectorAll(Sd(vi.label))),h=0,g=d;h<g.length;h++){var T=g[h],I=T.getBoundingClientRect().height;if(I>0)return I}return Hoe}var iG="button"+Sd(vi.emoji),oTe=[iG,Sd(vi.visible),":not("+Sd(vi.hidden)+")"].join("");function f0(o){var d;return(d=o==null?void 0:o.closest(iG))!=null?d:null}function dZ(o){var d=$oe(o),h=fZ(o);if(!d)return[];var g=wP(h??d);return g?[g,h]:[]}function cTe(o){var d;return!!(o!=null&&o.matches(iG)||!(o==null||(d=o.parentElement)==null)&&d.matches(iG))}function Bee(o){var d;return(d=o==null?void 0:o.clientHeight)!=null?d:0}function Joe(o){if(!o)return 0;var d=f0(o),h=oC(d),g=uZ(h);return Fee(d)+Fee(h)+g}function uZ(o){var d,h;if(!o)return 0;var g=o.querySelector(Sd(vi.categoryContent));return((d=o==null?void 0:o.clientHeight)!=null?d:0)-((h=g==null?void 0:g.clientHeight)!=null?h:0)}function lTe(o){return o?Qoe(o)<uZ(oC(o)):!1}function Xoe(o){return o?o.matches(Sd(vi.scrollBody))?o:o.querySelector(Sd(vi.scrollBody)):null}function Qoe(o){var d,h;return o?Joe(o)-((d=(h=Zoe(o))==null?void 0:h.scrollTop)!=null?d:0):0}function Zoe(o){var d;return o&&(d=o.closest(Sd(vi.scrollBody)))!=null?d:null}function dTe(o){var d=f0(o),h=oC(d);return Gee(d)+Gee(h)}function Fee(o){var d;return(d=o==null?void 0:o.offsetTop)!=null?d:0}function Gee(o){var d;return(d=o==null?void 0:o.offsetLeft)!=null?d:0}function fZ(o){var d;return(d=uTe(f0(o),"unified"))!=null?d:null}function $oe(o){var d=fZ(o);return d?eZ(d):null}function ece(o){return o?{unified:fZ(o),originalUnified:$oe(o)}:{unified:null,originalUnified:null}}function uTe(o,d){var h;return(h=fTe(o)[d])!=null?h:null}function fTe(o){var d;return(d=o==null?void 0:o.dataset)!=null?d:{}}function hZ(o){return o.classList.contains(vi.visible)}function tce(o){return o?o.classList.contains(vi.hidden):!0}function RP(o){return o?Array.from(o.querySelectorAll(oTe)):[]}function nce(o){if(!o)return null;var d=RP(o),h=d.slice(-1),g=h[0];return g?hZ(g)?g:pZ(g):null}function rce(o){var d=o.nextElementSibling;return d?hZ(d)?d:rce(d):mZ(WG(o))}function pZ(o){var d=o.previousElementSibling;return d?hZ(d)?d:pZ(d):nce(HG(o))}function mZ(o){if(!o)return null;var d=RP(o);return iTe(o,d,.1)}function HG(o){var d=oC(o);if(!d)return null;var h=d.previousElementSibling;return h?tce(h)?HG(h):h:null}function WG(o){var d=oC(o);if(!d)return null;var h=d.nextElementSibling;return h?tce(h)?WG(h):h:null}function oC(o){return o?o.closest(Sd(vi.category)):null}function ice(o){return o?o.closest(Sd(vi.categoryContent)):null}function ace(o){return o.split("-").map(function(d){return String.fromCodePoint(parseInt(d,16))}).join("")}var sce="epr_suggested";function oce(o){try{var d,h,g;if(!((d=window)!=null&&d.localStorage))return[];var T=JSON.parse((h=(g=window)==null?void 0:g.localStorage.getItem(sce))!=null?h:"[]");return o===_5.FREQUENT?T.sort(function(I,N){return N.count-I.count}):T}catch{return[]}}function hTe(o,d){var h=oce(),g=mu(o,d),T=mu(o),I=h.find(function(k){var x=k.unified;return x===g}),N;I?N=[I].concat(h.filter(function(k){return k!==I})):(I={unified:g,original:T,count:0},N=[I].concat(h)),I.count++,N.length=Math.min(N.length,14);try{var M;(M=window)==null||M.localStorage.setItem(sce,JSON.stringify(N))}catch{}}function pTe(o){return o.category===Ei.CUSTOM}function cce(o){return o.imgUrl!==void 0}function lce(o,d){var h=q.useRef(),g=Foe(),T=hye(),I=BP(),N=I[1],M=QA(),k=rZ(),x=k[0],V=XSe(d),K=Ooe(),Q=K[1],ie=XA(),X=JA(),Z=q.useCallback(function(ue){if(!T.current){M();var de=zee(ue),te=de[0],ye=de[1];if(!(!te||!ye)){var Te=kSe(ye)||x;Q(),hTe(te,Te),V(mTe(te,Te,X,ie),ue)}}},[x,M,T,V,Q,ie,X]),ae=q.useCallback(function(ue){var de;h.current&&clearTimeout(h.current);var te=zee(ue),ye=te[0];!ye||!VP(ye)||(h.current=(de=window)==null?void 0:de.setTimeout(function(){T.current=!0,h.current=void 0,M(),g(ue.target),N(ye)},500))},[T,M,g,N]),le=q.useCallback(function(){h.current?(clearTimeout(h.current),h.current=void 0):T.current&&requestAnimationFrame(function(){T.current=!1})},[T]);q.useEffect(function(){if(o.current){var fe=o.current;return fe.addEventListener("click",Z,{passive:!0}),fe.addEventListener("mousedown",ae,{passive:!0}),fe.addEventListener("mouseup",le,{passive:!0}),function(){fe==null||fe.removeEventListener("click",Z),fe==null||fe.removeEventListener("mousedown",ae),fe==null||fe.removeEventListener("mouseup",le)}}},[o,Z,ae,le])}function zee(o){var d=o==null?void 0:o.target;return cTe(d)?dZ(d):[]}function mTe(o,d,h,g){var T=G5(o);if(cce(o)){var I=mu(o);return{activeSkinTone:d,emoji:I,getImageUrl:function(){return o.imgUrl},imageUrl:o.imgUrl,isCustom:!0,names:T,unified:I,unifiedWithoutSkinTone:I}}var N=mu(o,d);return{activeSkinTone:d,emoji:ace(N),getImageUrl:function(k){return k===void 0&&(k=h??Ph.APPLE),g(N,k)},imageUrl:g(N,h??Ph.APPLE),isCustom:!1,names:T,unified:N,unifiedWithoutSkinTone:mu(o)}}function Y5(o){return q.createElement("button",Object.assign({type:"button"},o,{className:Mi(gTe.button,o.className)}),o.children)}var gTe=Ns.create({button:{".":"epr-btn",cursor:"pointer",border:"0",background:"none",outline:"none"}});function _Te(o){var d,h=o.emojiNames,g=o.unified,T=o.hidden,I=o.hiddenOnSearch,N=o.showVariations,M=N===void 0?!0:N,k=o.hasVariations,x=o.children,V=o.className,K=o.noBackground,Q=K===void 0?!1:K;return q.createElement(Y5,{className:Mi(KK.emoji,T&&ZQ.hidden,I&&qA.hiddenOnSearch,(d={},d[vi.visible]=!T&&!I,d),!!(k&&M)&&KK.hasVariations,Q&&KK.noBackground,V),"data-unified":g,"aria-label":ETe(h),"data-full-name":h},x)}function ETe(o){var d;return o[0].match("flag-")&&(d=o[1])!=null?d:o[0]}var KK=Ns.create({emoji:{".":vi.emoji,position:"relative",width:"var(--epr-emoji-fullsize)",height:"var(--epr-emoji-fullsize)",boxSizing:"border-box",display:"flex",alignItems:"center",justifyContent:"center",maxWidth:"var(--epr-emoji-fullsize)",maxHeight:"var(--epr-emoji-fullsize)",borderRadius:"8px",overflow:"hidden",transition:"background-color 0.2s",":hover":{backgroundColor:"var(--epr-emoji-hover-color)"},":focus":{backgroundColor:"var(--epr-focus-bg-color)"}},noBackground:{background:"none",":hover":{backgroundColor:"transparent",background:"none"},":focus":{backgroundColor:"transparent",background:"none"}},hasVariations:{".":vi.emojiHasVariations,":after":{content:"",display:"block",width:"0",height:"0",right:"0px",bottom:"1px",position:"absolute",borderLeft:"4px solid transparent",borderRight:"4px solid transparent",transform:"rotate(135deg)",borderBottom:"4px solid var(--epr-emoji-variation-indicator-color)",zIndex:"var(--epr-emoji-variations-indictator-z-index)"},":hover:after":{borderBottom:"4px solid var(--epr-emoji-variation-indicator-color-hover)"}}}),aG=Ns.create({external:{".":vi.external,fontSize:"0"},common:{alignSelf:"center",justifySelf:"center",display:"block"}});function Hee(o){var d=o.emojiName,h=o.style,g=o.lazyLoad,T=g===void 0?!1:g,I=o.imgUrl,N=o.onError,M=o.className;return q.createElement("img",{src:I,alt:d,className:Mi(vTe.emojiImag,aG.external,aG.common,M),loading:T?"lazy":"eager",onError:N,style:h})}var vTe=Ns.create({emojiImag:{".":"epr-emoji-img",maxWidth:"var(--epr-emoji-fullsize)",maxHeight:"var(--epr-emoji-fullsize)",minWidth:"var(--epr-emoji-fullsize)",minHeight:"var(--epr-emoji-fullsize)",padding:"var(--epr-emoji-padding)"}});function STe(o){var d=o.unified,h=o.style,g=o.className;return q.createElement("span",{className:Mi(yTe.nativeEmoji,aG.common,aG.external,g),"data-unified":d,style:h},ace(d))}var yTe=Ns.create({nativeEmoji:{".":"epr-emoji-native",fontFamily:'"Segoe UI Emoji", "Segoe UI Symbol", "Segoe UI", "Apple Color Emoji", "Twemoji Mozilla", "Noto Color Emoji", "EmojiOne Color", "Android Emoji"!important',position:"relative",lineHeight:"100%",fontSize:"var(--epr-emoji-size)",textAlign:"center",alignSelf:"center",justifySelf:"center",letterSpacing:"0",padding:"var(--epr-emoji-padding)"}});function ZX(o){var d=o.emoji,h=o.unified,g=o.emojiStyle,T=o.size,I=o.lazyLoad,N=o.getEmojiUrl,M=N===void 0?moe:N,k=o.className,x=Aoe(),V=x[1],K={};T&&(K.width=K.height=K.fontSize=T+"px");var Q=d||wP(h);if(!Q)return null;if(cce(Q))return q.createElement(Hee,{style:K,emojiName:h,emojiStyle:Ph.NATIVE,lazyLoad:I,imgUrl:Q.imgUrl,onError:ie,className:k});return q.createElement(q.Fragment,null,g===Ph.NATIVE?q.createElement(STe,{unified:h,style:K,className:k}):q.createElement(Hee,{style:K,emojiName:XX(Q),emojiStyle:g,lazyLoad:I,imgUrl:M(h,g),onError:ie,className:k}));function ie(){V(function(X){return new Set(X).add(h)})}}function YG(o){var d=o.emoji,h=o.unified,g=o.hidden,T=o.hiddenOnSearch,I=o.emojiStyle,N=o.showVariations,M=N===void 0?!0:N,k=o.size,x=o.lazyLoad,V=o.getEmojiUrl,K=o.className,Q=o.noBackground,ie=Q===void 0?!1:Q,X=VP(d);return q.createElement(_Te,{hasVariations:X,showVariations:M,hidden:g,hiddenOnSearch:T,emojiNames:G5(d),unified:h,noBackground:ie},q.createElement(ZX,{unified:h,emoji:d,size:k,emojiStyle:I,lazyLoad:x,getEmojiUrl:V,className:K}))}var TTe="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDI4LjEuMCwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPgo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IgoJIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjgwcHgiIHZpZXdCb3g9IjAgMCAyMCA4MCIgZW5hYmxlLWJhY2tncm91bmQ9Im5ldyAwIDAgMjAgODAiIHhtbDpzcGFjZT0icHJlc2VydmUiPgo8cGF0aCBmaWxsPSIjODY4Njg2IiBkPSJNNS43LDEwLjRjMCwwLjEsMC4xLDAuMywwLjIsMC40QzYsMTAuOSw2LjEsMTEsNi4zLDExaDMuNHYzLjRjMCwwLjEsMC4xLDAuMywwLjIsMC40CgljMC4xLDAuMSwwLjIsMC4yLDAuNCwwLjJjMC4zLDAsMC41LTAuMiwwLjUtMC41di0zLjRoMy40YzAuMywwLDAuNS0wLjIsMC41LTAuNXMtMC4yLTAuNS0wLjUtMC41aC0zLjRWNi43YzAtMC4zLTAuMi0wLjUtMC41LTAuNQoJQzkuOCw2LDkuNiw2LjIsOS42LDYuNXYzLjRINi4yQzUuOSw5LjksNS43LDEwLjEsNS43LDEwLjRMNS43LDEwLjR6Ii8+CjxwYXRoIGZpbGw9IiMzMzcxQjciIGQ9Ik01LjcsMzAuNGMwLDAuMSwwLjEsMC4zLDAuMiwwLjRTNi4xLDMxLDYuMywzMWgzLjR2My40YzAsMC4xLDAuMSwwLjMsMC4yLDAuNGMwLjEsMC4xLDAuMiwwLjIsMC40LDAuMgoJYzAuMywwLDAuNS0wLjIsMC41LTAuNXYtMy40aDMuNGMwLjMsMCwwLjUtMC4yLDAuNS0wLjVzLTAuMi0wLjUtMC41LTAuNWgtMy40di0zLjRjMC0wLjMtMC4yLTAuNS0wLjUtMC41cy0wLjUsMC4yLTAuNSwwLjV2My40SDYuMgoJQzUuOSwyOS45LDUuNywzMC4xLDUuNywzMC40TDUuNywzMC40eiIvPgo8cGF0aCBmaWxsPSIjQzBDMEJGIiBkPSJNNS43LDUwLjRjMCwwLjEsMC4xLDAuMywwLjIsMC40QzYsNTAuOSw2LjEsNTEsNi4zLDUxaDMuNHYzLjRjMCwwLjEsMC4xLDAuMywwLjIsMC40CgljMC4xLDAuMSwwLjIsMC4yLDAuNCwwLjJjMC4zLDAsMC41LTAuMiwwLjUtMC41di0zLjRoMy40YzAuMywwLDAuNS0wLjIsMC41LTAuNXMtMC4yLTAuNS0wLjUtMC41aC0zLjR2LTMuNGMwLTAuMy0wLjItMC41LTAuNS0wLjUKCXMtMC41LDAuMi0wLjUsMC41djMuNEg2LjJDNS45LDQ5LjksNS43LDUwLjEsNS43LDUwLjRMNS43LDUwLjR6Ii8+CjxwYXRoIGZpbGw9IiM2QUE5REQiIGQ9Ik01LjcsNzAuNGMwLDAuMSwwLjEsMC4zLDAuMiwwLjRTNi4xLDcxLDYuMyw3MWgzLjR2My40YzAsMC4xLDAuMSwwLjMsMC4yLDAuNGMwLjEsMC4xLDAuMiwwLjIsMC40LDAuMgoJYzAuMywwLDAuNS0wLjIsMC41LTAuNXYtMy40aDMuNGMwLjMsMCwwLjUtMC4yLDAuNS0wLjVzLTAuMi0wLjUtMC41LTAuNWgtMy40di0zLjRjMC0wLjMtMC4yLTAuNS0wLjUtMC41cy0wLjUsMC4yLTAuNSwwLjV2My40SDYuNAoJQzUuOSw2OS45LDUuNyw3MC4xLDUuNyw3MC40TDUuNyw3MC40eiIvPgo8L3N2Zz4=";function bTe(){var o=jG(),d=o[1];return q.createElement(Y5,{"aria-label":"Show all Emojis",title:"Show all Emojis",tabIndex:0,className:Mi(CTe.plusSign),onClick:function(){return d(!1)}})}var CTe=Ns.create(Ys({plusSign:{fontSize:"20px",padding:"17px",color:"var(--epr-text-color)",borderRadius:"50%",textAlign:"center",lineHeight:"100%",width:"20px",height:"20px",display:"flex",justifyContent:"center",alignItems:"center",transition:"background-color 0.2s ease-in-out",":after":{content:"",minWidth:"20px",minHeight:"20px",backgroundImage:"url("+TTe+")",backgroundColor:"transparent",backgroundRepeat:"no-repeat",backgroundSize:"20px",backgroundPositionY:"0"},":hover":{color:"var(--epr-highlight-color)",backgroundColor:"var(--epr-hover-bg-color-reduced-opacity)",":after":{backgroundPositionY:"-20px"}},":focus":{color:"var(--epr-highlight-color)",backgroundColor:"var(--epr-hover-bg-color-reduced-opacity)",":after":{backgroundPositionY:"-40px"}}}},nC("plusSign",{":after":{backgroundPositionY:"-40px"},":hover:after":{backgroundPositionY:"-60px"}})));function wTe(){var o=jG(),d=o[0],h=gye(),g=sye();lce(h,S5.REACTIONS);var T=JA(),I=yoe(),N=XA();return d?q.createElement("ul",{className:Mi(Wee.list,!d&&ZQ.hidden),ref:h},g.map(function(M){return q.createElement("li",{key:M},q.createElement(YG,{emoji:wP(M),emojiStyle:T,unified:M,showVariations:!1,className:Mi(Wee.emojiButton),noBackground:!0,getEmojiUrl:N}))}),I?q.createElement("li",null,q.createElement(bTe,null)):null):null}var Wee=Ns.create({list:{listStyle:"none",margin:"0",padding:"0 5px",display:"flex",justifyContent:"space-between",alignItems:"center",height:"100%"},emojiButton:{":hover":{transform:"scale(1.2)"},":focus":{transform:"scale(1.2)"},":active":{transform:"scale(1.1)"},transition:"transform 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.5)"}});function RTe(o){var d=QA();q.useEffect(function(){var h=o.current;if(!h)return;h.addEventListener("scroll",g,{passive:!0});function g(){d()}return function(){h==null||h.removeEventListener("scroll",g)}},[o,d])}function ITe(){var o=Aoe(),d=o[0],h=xye();return function(g){var T=mu(g),I=d.has(T),N=h(T);return{failedToLoad:I,filteredOut:N,hidden:I||N}}}function dce(o){var d=o.categoryConfig,h=o.children,g=o.hidden,T=o.hiddenOnSearch,I=$Q(d),N=hoe(d);return q.createElement("li",{className:Mi(qK.category,g&&ZQ.hidden,T&&qA.hiddenOnSearch),"data-name":I,"aria-label":N},q.createElement("h2",{className:Mi(qK.label)},N),q.createElement("div",{className:Mi(qK.categoryContent)},h))}var qK=Ns.create({category:{".":vi.category,":not(:has(.epr-visible))":{display:"none"}},categoryContent:{".":vi.categoryContent,display:"grid",gridGap:"0",gridTemplateColumns:"repeat(auto-fill, var(--epr-emoji-fullsize))",justifyContent:"space-between",margin:"var(--epr-category-padding)",position:"relative"},label:{".":vi.label,alignItems:"center",backdropFilter:"blur(3px)",backgroundColor:"var(--epr-category-label-bg-color)",color:"var(--epr-category-label-text-color)",display:"flex",fontSize:"16px",fontWeight:"bold",height:"var(--epr-category-label-height)",margin:"0",padding:"var(--epr-category-label-padding)",position:"sticky",textTransform:"capitalize",top:"0",width:"100%",zIndex:"var(--epr-category-label-z-index)"}}),JK=!1;function ATe(){var o=q.useState(JK),d=o[0],h=o[1];return q.useEffect(function(){h(!0),JK=!0},[]),d||JK}function OTe(o){var d=o.categoryConfig,h=Ooe(),g=h[0],T=ATe(),I=$Se(),N=XA(),M=q.useMemo(function(){var x;return(x=oce(I))!=null?x:[]},[g,I]),k=JA();return T?q.createElement(dce,{categoryConfig:d,hiddenOnSearch:!0,hidden:M.length===0},M.map(function(x){var V=wP(x.original);return V?q.createElement(YG,{showVariations:!1,unified:x.unified,emojiStyle:k,emoji:V,key:x.unified,getEmojiUrl:N}):null})):null}function NTe(){var o=boe(),d=q.useRef(0);return q.createElement("ul",{className:Mi(DTe.emojiList)},o.map(function(h){var g=$Q(h);return g===Ei.SUGGESTED?q.createElement(OTe,{key:g,categoryConfig:h}):q.createElement(q.Suspense,{key:g},q.createElement(LTe,{category:g,categoryConfig:h,renderdCategoriesCountRef:d}))}))}function LTe(o){var d=o.category,h=o.categoryConfig,g=o.renderdCategoriesCountRef,T=ITe(),I=eye(),N=JA(),M=pye(),k=rZ(),x=k[0],V=lye(),K=XA(),Q=!Toe(),ie=!M&&g.current>0?[]:LSe(d);ie.length>0&&g.current++;var X=0,Z=ie.map(function(ae){var le=mu(ae,x),fe=T(ae),ue=fe.failedToLoad,de=fe.filteredOut,te=fe.hidden,ye=V(ae);return(te||ye)&&X++,ye?null:q.createElement(YG,{showVariations:Q,key:le,emoji:ae,unified:le,hidden:ue,hiddenOnSearch:de,emojiStyle:N,lazyLoad:I,getEmojiUrl:K})});return q.createElement(dce,{categoryConfig:h,hidden:X===Z.length},Z)}var DTe=Ns.create({emojiList:{".":vi.emojiList,listStyle:"none",margin:"0",padding:"0"}}),PTe="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDI2LjMuMSwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPgo8c3ZnIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiIHdpZHRoPSI1MHB4IgoJIGhlaWdodD0iMTVweCIgdmlld0JveD0iMCAwIDUwIDE1IiBlbmFibGUtYmFja2dyb3VuZD0ibmV3IDAgMCA1MCAxNSIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+CjxnIGlkPSJMYXllcl8xIj4KPC9nPgo8ZyBpZD0iTGF5ZXJfMiI+Cgk8cGF0aCBmaWxsPSIjRkZGRkZGIiBzdHJva2U9IiNFOEU3RTciIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgZD0iTTEuODYtMC40M2w5LjgzLDExLjUzYzAuNTksMC42OSwxLjU2LDAuNjksMi4xNCwwbDkuODMtMTEuNTMiLz4KCTxwYXRoIGZpbGw9IiMwMTAyMDIiIHN0cm9rZT0iIzE1MTYxNyIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBkPSJNMjYuODYtMC40M2w5LjgzLDExLjUzYzAuNTksMC42OSwxLjU2LDAuNjksMi4xNCwwbDkuODMtMTEuNTMiLz4KPC9nPgo8L3N2Zz4=",EP;(function(o){o[o.Up=0]="Up",o[o.Down=1]="Down"})(EP||(EP={}));function MTe(){var o=FG(),d=_ye(),h=BP(),g=h[0],T=JA(),I=xTe(d),N=I.getTop,M=I.getMenuDirection,k=Moe(),x=kTe(d),V=XA(),K=f0(o.current),Q=!!(g&&K&&VP(g)&&K.classList.contains(vi.emojiHasVariations));q.useEffect(function(){Q&&zG(d.current)},[d,Q,o]);var ie,X;return!Q&&o.current?k(null):(ie=N(),X=x()),q.createElement("div",{ref:d,className:Mi(p7.variationPicker,M()===EP.Down&&p7.pointingUp,Q&&p7.visible),style:{top:ie}},Q&&g?[mu(g)].concat(z5(g)).slice(0,6).map(function(Z){return q.createElement(YG,{key:Z,emoji:g,unified:Z,emojiStyle:T,showVariations:!1,getEmojiUrl:V})}):null,q.createElement("div",{className:Mi(p7.pointer),style:X}))}function kTe(o){var d=FG();return function(){var g={};if(!o.current)return g;if(d.current){var T=f0(d.current),I=dTe(T);if(!T)return g;g.left=I+(T==null?void 0:T.clientWidth)/2}return g}}function xTe(o){var d=FG(),h=vm(),g=EP.Up;return{getMenuDirection:T,getTop:I};function T(){return g}function I(){g=EP.Up;var N=0;if(!o.current)return 0;var M=Bee(o.current);if(d.current){var k,x=h.current,V=f0(d.current),K=Bee(V);N=Joe(V);var Q=(k=x==null?void 0:x.scrollTop)!=null?k:0;Q>N-M&&(g=EP.Down,N+=K+M)}return N-M}}var p7=Ns.create(Ys({variationPicker:{".":vi.variationPicker,position:"absolute",right:"15px",left:"15px",padding:"5px",boxShadow:"0px 2px 5px rgba(0, 0, 0, 0.2)",borderRadius:"3px",display:"flex",alignItems:"center",justifyContent:"space-around",opacity:"0",visibility:"hidden",pointerEvents:"none",top:"-100%",border:"1px solid var(--epr-picker-border-color)",height:"var(--epr-emoji-variation-picker-height)",zIndex:"var(--epr-skin-variation-picker-z-index)",background:"var(--epr-emoji-variation-picker-bg-color)",transform:"scale(0.9)",transition:"transform 0.1s ease-out, opacity 0.2s ease-out"},visible:{opacity:"1",visibility:"visible",pointerEvents:"all",transform:"scale(1)"},pointingUp:{".":"pointing-up",transformOrigin:"center 0%",transform:"scale(0.9)"},".pointing-up":{pointer:{top:"0",transform:"rotate(180deg) translateY(100%) translateX(18px)"}},pointer:{".":"epr-emoji-pointer",content:"",position:"absolute",width:"25px",height:"15px",backgroundRepeat:"no-repeat",backgroundPosition:"0 0",backgroundSize:"50px 15px",top:"100%",transform:"translateX(-18px)",backgroundImage:"url("+PTe+")"}},nC("pointer",{backgroundPosition:"-25px 0"})));function UTe(){var o=vm();return RTe(o),lce(o,S5.PICKER),Oye(),q.createElement("div",{className:Mi(jTe.body,qA.hiddenOnReactions),ref:o},q.createElement(MTe,null),q.createElement(NTe,null))}var jTe=Ns.create({body:{".":vi.scrollBody,flex:"1",overflowY:"scroll",overflowX:"hidden",position:"relative"}});function VTe(o,d){if(!o||!d)return 0;var h=o.getBoundingClientRect(),g=d.getBoundingClientRect();return g.height-(h.y-g.y)}function BTe(o,d){var h=vm(),g=joe(),T=Uoe();q.useEffect(function(){if(!o)return;var I=h.current;I==null||I.addEventListener("keydown",k,{passive:!0}),I==null||I.addEventListener("mouseover",x,!0),I==null||I.addEventListener("focus",N,!0),I==null||I.addEventListener("mouseout",M,{passive:!0}),I==null||I.addEventListener("blur",M,!0);function N(V){var K=f0(V.target);if(!K)return M();var Q=ece(K),ie=Q.unified,X=Q.originalUnified;if(!ie||!X)return M();d({unified:ie,originalUnified:X})}function M(V){if(V){var K=V.relatedTarget;if(!f0(K))return d(null)}d(null)}function k(V){V.key==="Escape"&&d(null)}function x(V){if(!g()){var K=f0(V.target);if(K){var Q=VTe(K,I),ie=K.getBoundingClientRect().height;if(Q<ie)return FTe(K,d);Uh(K)}}}return function(){I==null||I.removeEventListener("mouseover",x),I==null||I.removeEventListener("mouseout",M),I==null||I.removeEventListener("focus",N,!0),I==null||I.removeEventListener("blur",M,!0),I==null||I.removeEventListener("keydown",k)}},[h,o,d,g,T])}function FTe(o,d){var h,g=ece(o),T=g.unified,I=g.originalUnified;!T||!I||((h=document.activeElement)==null||h.blur==null||h.blur(),d({unified:T,originalUnified:I}))}var m7,T5;(function(o){o.ROW="FlexRow",o.COLUMN="FlexColumn"})(T5||(T5={}));function uce(o){var d=o.children,h=o.className,g=o.style,T=g===void 0?{}:g,I=o.direction,N=I===void 0?T5.ROW:I;return q.createElement("div",{style:Ys({},T),className:Mi(Yee.flex,h,Yee[N])},d)}var Yee=Ns.create((m7={flex:{display:"flex"}},m7[T5.ROW]={flexDirection:"row"},m7[T5.COLUMN]={flexDirection:"column"},m7));function GTe(o){var d=o.className,h=o.style,g=h===void 0?{}:h;return q.createElement("div",{style:Ys({flex:1},g),className:Mi(d)})}function zTe(o){var d=o.children,h=o.className,g=o.style;return q.createElement("div",{style:Ys({},g,{position:"absolute"}),className:h},d)}function KG(o){var d=o.children,h=o.className,g=o.style;return q.createElement("div",{style:Ys({},g,{position:"relative"}),className:h},d)}function HTe(o){var d=o.isOpen,h=o.onClick,g=o.isActive,T=o.skinToneVariation,I=o.style;return q.createElement(Y5,{style:I,onClick:h,className:Mi("epr-tone-"+T,XK.tone,!d&&XK.closedTone,g&&XK.active),"aria-pressed":g,"aria-label":"Skin tone "+ASe[T]})}var XK=Ns.create({closedTone:{opacity:"0",zIndex:"0"},active:{".":"epr-active",zIndex:"1",opacity:"1"},tone:{".":"epr-tone",width:"var(--epr-skin-tone-size)",display:"block",cursor:"pointer",borderRadius:"4px",height:"var(--epr-skin-tone-size)",position:"absolute",right:"0",transition:"transform 0.3s ease-in-out, opacity 0.35s ease-in-out",zIndex:"0",border:"1px solid var(--epr-skin-tone-outer-border-color)",boxShadow:"inset 0px 0px 0 1px var(--epr-skin-tone-inner-border-color)",":hover":{boxShadow:"0 0 0 3px var(--epr-active-skin-hover-color), inset 0px 0px 0 1px var(--epr-skin-tone-inner-border-color)"},":focus":{boxShadow:"0 0 0 3px var(--epr-focus-bg-color)"},"&.epr-tone-neutral":{backgroundColor:"#ffd225"},"&.epr-tone-1f3fb":{backgroundColor:"#ffdfbd"},"&.epr-tone-1f3fc":{backgroundColor:"#e9c197"},"&.epr-tone-1f3fd":{backgroundColor:"#c88e62"},"&.epr-tone-1f3fe":{backgroundColor:"#a86637"},"&.epr-tone-1f3ff":{backgroundColor:"#60463a"}}}),Qj=28;function WTe(){return q.createElement(KG,{style:{height:Qj}},q.createElement(zTe,{style:{bottom:0,right:0}},q.createElement(fce,{direction:b5.VERTICAL})))}function fce(o){var d=o.direction,h=d===void 0?b5.HORIZONTAL:d,g=iZ(),T=Toe(),I=H5(),N=I[0],M=I[1],k=rZ(),x=k[0],V=k[1],K=QSe(),Q=QA(),ie=ZA();if(T)return null;var X=Qj*nG.length+"px",Z=N?X:Qj+"px",ae=h===b5.VERTICAL;return q.createElement(KG,{className:Mi(Fj.skinTones,ae&&Fj.vertical,N&&Fj.open,ae&&N&&Fj.verticalShadow),style:ae?{flexBasis:Z,height:Z}:{flexBasis:Z}},q.createElement("div",{className:Mi(Fj.select),ref:g},nG.map(function(le,fe){var ue=le===x;return q.createElement(HTe,{key:le,skinToneVariation:le,isOpen:N,style:{transform:Mi(ae?"translateY(-"+fe*(N?Qj:0)+"px)":"translateX(-"+fe*(N?Qj:0)+"px)",N&&ue&&"scale(1.3)")},isActive:ue,onClick:function(){N?(V(le),K(le),ie()):M(!0),Q()}})})))}var b5;(function(o){o.VERTICAL="epr-vertical",o.HORIZONTAL="epr-horizontal"})(b5||(b5={}));var Fj=Ns.create({skinTones:{".":"epr-skin-tones","--":{"--epr-skin-tone-size":"15px"},display:"flex",alignItems:"center",justifyContent:"flex-end",transition:"all 0.3s ease-in-out",padding:"10px 0"},vertical:{padding:"9px",alignItems:"flex-end",flexDirection:"column",borderRadius:"6px",border:"1px solid var(--epr-bg-color)"},verticalShadow:{boxShadow:"0px 0 7px var(--epr-picker-border-color)"},open:{backdropFilter:"blur(5px)",background:"var(--epr-skin-tone-picker-menu-color)",".epr-active":{border:"1px solid var(--epr-active-skin-tone-indicator-border-color)"}},select:{".":"epr-skin-tone-select",position:"relative",width:"var(--epr-skin-tone-size)",height:"var(--epr-skin-tone-size)"}});function YTe(){var o=Coe(),d=Goe();return o.showPreview?q.createElement(uce,{className:Mi(k7.preview,qA.hiddenOnReactions)},q.createElement(KTe,null),q.createElement(GTe,null),d?q.createElement(WTe,null):null):null}function KTe(){var o,d=Coe(),h=q.useState(null),g=h[0],T=h[1],I=JA(),N=BP(),M=N[0],k=XA();BTe(d.showPreview,T);var x=wP((o=g==null?void 0:g.unified)!=null?o:g==null?void 0:g.originalUnified),V=x!=null&&g!=null;return q.createElement(K,null);function K(){var Q=M??wP(d.defaultEmoji);if(!Q)return null;var ie=M?XX(M):d.defaultCaption;return q.createElement(q.Fragment,null,q.createElement("div",null,V?q.createElement(ZX,{unified:g==null?void 0:g.unified,emoji:x,emojiStyle:I,size:45,getEmojiUrl:k,className:Mi(k7.emoji)}):Q?q.createElement(ZX,{unified:mu(Q),emoji:Q,emojiStyle:I,size:45,getEmojiUrl:k,className:Mi(k7.emoji)}):null),q.createElement("div",{className:Mi(k7.label)},V?XX(x):ie))}}var k7=Ns.create({preview:{alignItems:"center",borderTop:"1px solid var(--epr-preview-border-color)",height:"var(--epr-preview-height)",padding:"0 var(--epr-horizontal-padding)",position:"relative",zIndex:"var(--epr-preview-z-index)"},label:{color:"var(--epr-preview-text-color)",fontSize:"var(--epr-preview-text-size)",padding:"var(--epr-preview-text-padding)",textTransform:"capitalize"},emoji:{padding:"0"}});function qTe(o){var d;return(d=o==null?void 0:o.getAttribute("data-name"))!=null?d:null}function JTe(o){var d=vm();q.useEffect(function(){var h=new Map,g=d.current,T=new IntersectionObserver(function(I){if(g){for(var N=cSe(I),M;!(M=N()).done;){var k=M.value,x=qTe(k.target);h.set(x,k.intersectionRatio)}var V=Array.from(h),K=V[V.length-1];if(K[1]==1)return o(K[0]);for(var Q=0,ie=V;Q<ie.length;Q++){var X=ie[Q],Z=X[0],ae=X[1];if(ae){o(Z);break}}}},{threshold:[0,1]});g==null||g.querySelectorAll(Sd(vi.category)).forEach(function(I){T.observe(I)})},[d,o])}function XTe(){var o=vm(),d=W5();return function(g){var T;if(o.current){var I=(T=o.current)==null?void 0:T.querySelector('[data-name="'+g+'"]');if(I){var N=I.offsetTop||0;koe(d.current,N)}}}}function QTe(){var o=qSe();return o?o.length===0:!1}var ZTe="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDI2LjMuMSwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPgo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IgoJIHdpZHRoPSIyMDBweCIgaGVpZ2h0PSI4MHB4IiB2aWV3Qm94PSIwIDAgMjAwIDgwIiBlbmFibGUtYmFja2dyb3VuZD0ibmV3IDAgMCAyMDAgODAiIHhtbDpzcGFjZT0icHJlc2VydmUiPgo8ZyBpZD0iTGF5ZXJfMTEiPgoJPGc+CgkJPHBhdGggZmlsbD0iIzMzNzFCNyIgc3Ryb2tlPSIjMzM3MUI3IiBzdHJva2Utd2lkdGg9IjAuMSIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBkPSJNMTIuOCwyOS41YzAuNiwwLDEuMS0wLjUsMS4xLTEuMQoJCQljMC0wLjYtMC41LTEuMi0xLjEtMS4yYy0wLjYsMC0xLjIsMC41LTEuMiwxLjJDMTEuNiwyOSwxMi4yLDI5LjUsMTIuOCwyOS41eiBNMTIuOCwyOGMwLjIsMCwwLjQsMC4yLDAuNCwwLjQKCQkJYzAsMC4yLTAuMiwwLjQtMC40LDAuNGMtMC4yLDAtMC40LTAuMi0wLjQtMC40QzEyLjQsMjguMSwxMi42LDI4LDEyLjgsMjh6Ii8+CgkJPHBhdGggZmlsbD0iIzMzNzFCNyIgc3Ryb2tlPSIjMzM3MUI3IiBzdHJva2Utd2lkdGg9IjAuMSIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBkPSJNMTAsMjNjLTMuOCwwLTcsMy4xLTcsN2MwLDMuOCwzLjEsNyw3LDcKCQkJczctMy4xLDctN0MxNywyNi4yLDEzLjgsMjMsMTAsMjN6IE0xMCwzNi4yYy0zLjQsMC02LjItMi44LTYuMi02LjJjMC0zLjQsMi44LTYuMiw2LjItNi4yczYuMiwyLjgsNi4yLDYuMgoJCQlDMTYuMiwzMy40LDEzLjQsMzYuMiwxMCwzNi4yeiIvPgoJCTxwYXRoIGZpbGw9IiMzMzcxQjciIHN0cm9rZT0iIzMzNzFCNyIgc3Ryb2tlLXdpZHRoPSIwLjEiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgZD0iTTE0LjYsMzEuMmMtMC4xLTAuMS0wLjItMC4yLTAuMy0wLjJINS43CgkJCWMtMC4xLDAtMC4yLDAuMS0wLjMsMC4yYy0wLjEsMC4xLTAuMSwwLjIsMCwwLjRjMC43LDIsMi41LDMuMyw0LjYsMy4zczMuOS0xLjMsNC42LTMuM0MxNC43LDMxLjUsMTQuNywzMS4zLDE0LjYsMzEuMnogTTEwLDM0LjEKCQkJYy0xLjYsMC0zLTAuOS0zLjctMi4yaDcuM0MxMywzMy4yLDExLjYsMzQuMSwxMCwzNC4xeiIvPgoJCTxwYXRoIGZpbGw9IiMzMzcxQjciIHN0cm9rZT0iIzMzNzFCNyIgc3Ryb2tlLXdpZHRoPSIwLjEiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgZD0iTTcuMiwyOS41YzAuNiwwLDEuMi0wLjUsMS4yLTEuMQoJCQljMC0wLjYtMC41LTEuMi0xLjItMS4yYy0wLjYsMC0xLjEsMC41LTEuMSwxLjJDNi4xLDI5LDYuNiwyOS41LDcuMiwyOS41eiBNNy4yLDI4YzAuMiwwLDAuNCwwLjIsMC40LDAuNGMwLDAuMi0wLjIsMC40LTAuNCwwLjQKCQkJYy0wLjIsMC0wLjQtMC4yLTAuNC0wLjRDNi44LDI4LjEsNywyOCw3LjIsMjh6Ii8+Cgk8L2c+Cgk8Zz4KCQk8Zz4KCQkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMzM3MUI3IiBkPSJNNjQuMSwzMy40bDIuMywwYzAuMiwwLDAuNCwwLjIsMC40LDAuNHYyLjFjMCwwLjItMC4yLDAuNC0wLjQsMC40aC0yLjMKCQkJCWMtMC4yLDAtMC40LTAuMi0wLjQtMC40di0yLjFDNjMuNywzMy42LDYzLjgsMzMuNCw2NC4xLDMzLjR6Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzMzNzFCNyIgZD0iTTczLjUsMzMuNWgyLjRjMC4yLDAsMC40LDAuMiwwLjQsMC40djJjMCwwLjItMC4yLDAuNC0wLjQsMC40aC0yLjQKCQkJCWMtMC4yLDAtMC40LTAuMi0wLjQtMC40bDAtMkM3My4xLDMzLjYsNzMuMywzMy41LDczLjUsMzMuNXoiLz4KCQkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMzM3MUI3IiBkPSJNNjMuNywyOC40aDEyLjZ2NUg2My43VjI4LjR6Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzMzNzFCNyIgZD0iTTY1LjUsMjMuNmg4LjljMSwwLDEuOSwwLjgsMS45LDEuOXYzLjFINjMuN3YtMy4xQzYzLjcsMjQuNSw2NC41LDIzLjYsNjUuNSwyMy42eiIvPgoJCQk8ZWxsaXBzZSBmaWxsPSIjMzM3MUI3IiBjeD0iNjYuMiIgY3k9IjMwLjkiIHJ4PSIwLjkiIHJ5PSIxIi8+CgkJCTxlbGxpcHNlIGZpbGw9IiMzMzcxQjciIGN4PSI3My44IiBjeT0iMzAuOSIgcng9IjAuOSIgcnk9IjEiLz4KCQk8L2c+Cgk8L2c+Cgk8Zz4KCQk8Zz4KCQkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMzM3MUI3IiBkPSJNOTYuNCwzMGMwLDMuNi0yLjksNi41LTYuNCw2LjVzLTYuNC0yLjktNi40LTYuNXMyLjktNi41LDYuNC02LjVTOTYuNCwyNi40LDk2LjQsMzB6Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzMzNzFCNyIgZD0iTTk2LjMsMjguNmMwLDAsMCwwLjEsMCwwLjFjLTAuOSwwLjEtMi45LDAuMS00LjYtMS4xYy0xLjEtMC44LTItMS43LTIuNi0yLjUKCQkJCWMtMC4zLTAuNC0wLjYtMC44LTAuNy0xYy0wLjEtMC4xLTAuMS0wLjEtMC4xLTAuMmMwLjUtMC4xLDEuMi0wLjIsMi0wLjFjMS4yLDAsMi41LDAuMywzLjUsMS4xYzEsMC44LDEuNywxLjgsMi4xLDIuOAoJCQkJQzk2LjEsMjcuOSw5Ni4yLDI4LjMsOTYuMywyOC42eiIvPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiMzMzcxQjciIGQ9Ik04NCwzMi4yYzAsMCwwLTAuMSwwLTAuMWMwLjktMC4yLDIuOS0wLjQsNC43LDAuNmMxLjEsMC43LDEuOSwxLjUsMi40LDIuMwoJCQkJYzAuNCwwLjUsMC42LDEsMC43LDEuM2MtMC40LDAuMS0xLDAuMi0xLjcsMC4zYy0xLDAtMi4xLTAuMS0zLjItMC44cy0xLjktMS42LTIuNC0yLjVDODQuMiwzMi44LDg0LjEsMzIuNSw4NCwzMi4yeiIvPgoJCTwvZz4KCTwvZz4KCTxnPgoJCTxnPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiMzMzcxQjciIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgZD0iTTExNi4zLDI2LjhsLTEuNCwybC0wLjgtMC44bC0wLjYtMC42bDAsMC45bC0wLjEsOC4yaC02LjgKCQkJCWwtMC4xLTguMmwwLTAuOWwtMC42LDAuNmwtMC44LDAuOGwtMS40LTJsMi42LTIuOWMwLjEtMC4xLDAuMi0wLjEsMC4zLTAuMWgxLjNsMC40LDAuN2MwLjcsMS4zLDIuNiwxLjMsMy4zLTAuMWwwLjMtMC42aDEuMgoJCQkJYzAuMSwwLDAuMiwwLDAuMywwLjFsMC4zLTAuM2wtMC4zLDAuM0wxMTYuMywyNi44eiIvPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiMzMzcxQjciIGQ9Ik0xMTAuMSwyNy43aDJ2MC45YzAsMC40LTAuNCwwLjctMSwwLjdjLTAuNiwwLTEtMC4zLTEtMC43TDExMC4xLDI3LjdMMTEwLjEsMjcuN3oiLz4KCQk8L2c+Cgk8L2c+Cgk8Zz4KCQk8Zz4KCQkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMzM3MUI3IiBkPSJNMTI2LjgsMzQuM2MwLDEuMi0xLDIuMi0yLjIsMi4ycy0yLjItMS0yLjItMi4yczEtMi4yLDIuMi0yLjJTMTI2LjgsMzMuMSwxMjYuOCwzNC4zeiIvPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiMzMzcxQjciIGQ9Ik0xMzcuNiwzNC4zYzAsMS4yLTEsMi4yLTIuMiwyLjJjLTEuMiwwLTIuMi0xLTIuMi0yLjJzMS0yLjIsMi4yLTIuMgoJCQkJQzEzNi42LDMyLjEsMTM3LjYsMzMuMSwxMzcuNiwzNC4zeiIvPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiMzMzcxQjciIGQ9Ik0xMjYuOCwyNC40djkuOSIvPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiMzMzcxQjciIGQ9Ik0xMzcuNywyNC40djkuOSIvPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiMzMzcxQjciIGQ9Ik0xMjYuOCwyMy41aDEwLjh2Mi43aC0xMC44QzEyNi44LDI2LjIsMTI2LjgsMjMuNSwxMjYuOCwyMy41eiIvPgoJCTwvZz4KCTwvZz4KCTxnPgoJCTxnPgoJCQk8cGF0aCBmaWxsPSIjMzM3MUI3IiBkPSJNMTcwLjgsMjMuMUwxNzAuOCwyMy4xYy0wLjMsMC0wLjUsMC0wLjgsMGMtMi4xLDAtNCwxLTUuMywyLjVsLTAuMSwwbC0wLjEtMC4xbC0xLTEuMmwtMC4zLDMuNGwzLjQsMC4zCgkJCQlsLTEuMS0xLjNsLTAuMS0wLjFsMC4xLTAuMWMxLjEtMS41LDMtMi4zLDUtMi4xbDAsMGMzLjIsMC4zLDUuNSwzLjEsNS4yLDYuM2MtMC4zLDMtMy4xLDUuMy02LjEsNS4xYy0zLjEtMC4yLTUuNC0yLjktNS4zLTYKCQkJCWwtMS4zLTAuMWMtMC4yLDMuOCwyLjYsNy4xLDYuMyw3LjRjMy45LDAuMyw3LjMtMi42LDcuNi02LjVDMTc3LjIsMjYuOCwxNzQuNCwyMy41LDE3MC44LDIzLjF6Ii8+CgkJCTxwYXRoIGZpbGw9IiMzMzcxQjciIGQ9Ik0xNzAuMywyNy40YzAtMC4zLTAuMy0wLjYtMC42LTAuNnMtMC42LDAuMy0wLjYsMC42djMuMmMwLDAuMiwwLjEsMC4zLDAuMiwwLjRjMC4xLDAuMSwwLjMsMC4yLDAuNCwwLjIKCQkJCWgyLjRjMC40LDAsMC42LTAuMywwLjYtMC42YzAtMC40LTAuMy0wLjYtMC42LTAuNmgtMS42aC0wLjJ2LTAuMkwxNzAuMywyNy40TDE3MC4zLDI3LjR6Ii8+CgkJPC9nPgoJPC9nPgoJPGc+CgkJPGc+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzMzNzFCNyIgZD0iTTE4Ni4yLDIzLjRoNy43YzEuNSwwLDIuNywxLjIsMi43LDIuN3Y3LjdjMCwxLjUtMS4yLDIuNy0yLjcsMi43aC03LjcKCQkJCWMtMS41LDAtMi43LTEuMi0yLjctMi43di03LjdDMTgzLjQsMjQuNiwxODQuNywyMy40LDE4Ni4yLDIzLjR6Ii8+CgkJCTxlbGxpcHNlIGZpbGw9IiMzMzcxQjciIGN4PSIxODYiIGN5PSIyOC45IiByeD0iMC43IiByeT0iMC43Ii8+CgkJCTxlbGxpcHNlIGZpbGw9IiMzMzcxQjciIGN4PSIxOTQiIGN5PSIyNi43IiByeD0iMC43IiByeT0iMC43Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzMzNzFCNyIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBkPSJNMTg2LDMzLjNsMC40LTAuM2MwLjQtMC4zLDEtMC4zLDEuNS0wLjFsMSwwLjQKCQkJCWMwLjUsMC4yLDEsMC4yLDEuNS0wLjFsMC44LTAuNWMwLjQtMC4zLDEtMC4zLDEuNS0wLjFsMS44LDAuOCIvPgoJCTwvZz4KCTwvZz4KCTxwYXRoIGZpbGw9IiMzMzcxQjciIHN0cm9rZT0iIzMzNzFCNyIgc3Ryb2tlLXdpZHRoPSIwLjI1IiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIGQ9Ik0xNTYsMjQuM2MtMC4yLTAuMS0wLjQtMC4xLTAuNSwwCgkJYzAsMC0wLjIsMC4xLTAuOSwwLjJjLTAuNywwLTIuNC0wLjEtMy44LTAuNmMtMC44LTAuMy0xLjctMC41LTIuNS0wLjVjLTAuMiwwLTAuNCwwLTAuNSwwYy0xLjMsMC0yLjUsMC4zLTMuNiwxCgkJYy0wLjIsMC4xLTAuMiwwLjItMC4yLDAuNHYxMS42YzAsMC4zLDAuMSwwLjUsMC4zLDAuNWMwLjYsMCwwLjUtMC40LDAuNS0wLjZ2LTUuN2MwLjctMC4zLDMuMi0xLjEsNS44LTAuMQoJCWMxLjYsMC42LDMuNSwwLjcsNC4zLDAuN2MwLjgsMCwxLjMtMC4zLDEuMy0wLjNjMC4yLTAuMSwwLjMtMC4yLDAuMy0wLjR2LTUuN0MxNTYuMiwyNC42LDE1Ni4xLDI0LjQsMTU2LDI0LjN6IE0xNTUuNiwzMC4yCgkJYy0wLjEsMC0wLjcsMC4xLTEsMC4xYy0wLjcsMC0yLjQtMC4xLTMuOC0wLjZjLTIuNS0xLTUtMC41LTYuMi0wLjF2LTQuOWMwLjktMC41LDIuMi0wLjcsMy4yLTAuN2MwLjEsMCwwLjMsMCwwLjQsMAoJCWMwLjcsMCwxLjUsMC4yLDIuMiwwLjRjMS42LDAuNiwzLjUsMC43LDQuMywwLjdjMC4yLDAsMC44LDAsMS0wLjFWMzAuMnoiLz4KCTxnPgoJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzMzNzFCNyIgZD0iTTQ4LjEsMjMuNWgzLjdjMi41LDAsNC41LDIsNC41LDQuNWMwLDAuNS0wLjQsMC45LTAuOSwwLjlINDQuNWMtMC41LDAtMC45LTAuNC0wLjktMC45CgkJCUM0My42LDI1LjUsNDUuNiwyMy41LDQ4LjEsMjMuNXoiLz4KCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiMzMzcxQjciIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgZD0iTTQzLjUsMjguOGMtMC4yLDAuMS0wLjUsMS4yLDAsMS41YzEuNCwxLDguNSwwLjgsMTEuMywwLjYKCQkJYzAuOC0wLjEsMS42LTAuNCwxLjctMS4yYzAtMC4zLTAuMS0wLjYtMC42LTAuOSIvPgoJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzMzNzFCNyIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBkPSJNNDMuNSwzMC42TDQzLjMsMzFjLTAuMiwwLjUsMC4yLDEsMC43LDAuOWMwLjMtMC4xLDAuNSwwLDAuNywwLjMKCQkJbDAuMSwwLjJjMC4zLDAuNSwxLDAuNiwxLjUsMC4ybDAsMGMwLjMtMC4yLDAuNy0wLjMsMS0wLjJsMC44LDAuM2MwLjQsMC4yLDAuOCwwLjEsMS4yLDBsMC41LTAuMmMwLjQtMC4yLDAuOS0wLjIsMS4zLDBsMC41LDAuMgoJCQljMC40LDAuMiwwLjgsMC4yLDEuMiwwbDAuMi0wLjFjMC4zLTAuMiwwLjgtMC4yLDEuMSwwLjFsMC4yLDAuMmMwLjMsMC4zLDAuOCwwLjIsMS0wLjJsMC4xLTAuMmMwLjEtMC4yLDAtMC4zLDAuMi0wLjMKCQkJYzAuNSwwLDEuMi0wLjMsMS4xLTAuN2wtMC40LTEuMSIvPgoJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzMzNzFCNyIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBkPSJNNDMuNSwzMi4yYy0wLjEsMC4yLTAuMywwLjgsMCwxLjFjMC4zLDAuNCwzLDEuMSw2LjQsMS4xCgkJCWMyLjIsMCw0LjYtMC4zLDYtMC42YzAuNS0wLjEsMC45LTAuNSwwLjgtMC45YzAtMC4yLTAuMi0wLjUtMC40LTAuNyIvPgoJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzMzNzFCNyIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBkPSJNNDMuNSwzMy4zYzAsMC41LDAuNiwyLjMsMS4zLDIuN2MxLjgsMC44LDUuNywwLjcsOC4xLDAuNQoJCQljMS4zLTAuMSwyLjUtMC43LDMuMi0xLjhjMC4zLTAuNSwwLjUtMSwwLjUtMS40Ii8+CgkJPGVsbGlwc2UgZmlsbD0iIzMzNzFCNyIgY3g9IjUxLjYiIGN5PSIyNi41IiByeD0iMC4zIiByeT0iMC40Ii8+CgkJPGVsbGlwc2UgZmlsbD0iIzMzNzFCNyIgY3g9IjUzIiBjeT0iMjUiIHJ4PSIwLjMiIHJ5PSIwLjQiLz4KCQk8ZWxsaXBzZSBmaWxsPSIjMzM3MUI3IiBjeD0iNTMiIGN5PSIyNy4yIiByeD0iMC4zIiByeT0iMC40Ii8+CgkJPGVsbGlwc2UgZmlsbD0iIzMzNzFCNyIgY3g9IjU0LjMiIGN5PSIyNi41IiByeD0iMC4zIiByeT0iMC40Ii8+CgkJPGVsbGlwc2UgZmlsbD0iIzMzNzFCNyIgY3g9IjUwLjkiIGN5PSIyNSIgcng9IjAuMyIgcnk9IjAuNCIvPgoJPC9nPgoJPGc+CgkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMzM3MUI3IiBkPSJNMjQuMiwzMXYtNy42YzAuMSwwLjEsMC44LDAuOSwyLjgsMy4xYzIuNS0xLjYsNS42LTAuNyw2LjksMGwyLjQtMy4xdjcuMQoJCQljMCwxLjItMC4xLDIuNS0wLjksMy40Yy0xLDEuMi0yLjcsMi41LTUuMywyLjVjLTIuOSwwLTQuNS0xLjUtNS4zLTIuOUMyNC4yLDMyLjksMjQuMiwzMiwyNC4yLDMxeiIvPgoJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzMzNzFCNyIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBkPSJNMjEuMiwzMGw1LjQsMS4yIi8+CgkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMzM3MUI3IiBzdHJva2UtbGluZWNhcD0icm91bmQiIGQ9Ik0yMS4yLDM0LjFsNS40LTEuMiIvPgoJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzMzNzFCNyIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBkPSJNMzguOCwzMGwtNS40LDEuMiIvPgoJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzMzNzFCNyIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBkPSJNMzguOCwzNC4xbC01LjQtMS4yIi8+CgkJPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGZpbGw9IiMzMzcxQjciIGQ9Ik0yOS41LDMyLjRMMjksMzEuN2MtMC4yLTAuMywwLTAuNiwwLjMtMC42aDEuNAoJCQljMC4zLDAsMC41LDAuNCwwLjMsMC42bC0wLjcsMWwwLDBjLTAuNywxLjItMi42LDEuMS0zLjEtMC4zbC0wLjEtMC4yYy0wLjEtMC4yLDAtMC40LDAuMi0wLjVzMC40LDAsMC41LDAuMmwwLjEsMC4yCgkJCUMyOC4zLDMyLjgsMjkuMSwzMi45LDI5LjUsMzIuNHoiLz4KCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiMzMzcxQjciIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgZD0iTTMyLjQsMzIuMWwtMC4xLDAuMmMtMC40LDEtMS44LDEuMS0yLjMsMC4yIi8+CgkJPGVsbGlwc2UgZmlsbD0iIzMzNzFCNyIgY3g9IjI3LjYiIGN5PSIyOS43IiByeD0iMC43IiByeT0iMC43Ii8+CgkJPGVsbGlwc2UgZmlsbD0iIzMzNzFCNyIgY3g9IjMyLjQiIGN5PSIyOS43IiByeD0iMC43IiByeT0iMC43Ii8+Cgk8L2c+Cgk8Zz4KCQk8cGF0aCBmaWxsPSIjQzBDMEJGIiBzdHJva2U9IiNDMEMwQkYiIHN0cm9rZS13aWR0aD0iMC4xIiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIGQ9Ik0xMi44LDQ5LjVjMC42LDAsMS4xLTAuNSwxLjEtMS4xCgkJCWMwLTAuNi0wLjUtMS4yLTEuMS0xLjJjLTAuNiwwLTEuMiwwLjUtMS4yLDEuMkMxMS42LDQ5LDEyLjIsNDkuNSwxMi44LDQ5LjV6IE0xMi44LDQ4YzAuMiwwLDAuNCwwLjIsMC40LDAuNAoJCQljMCwwLjItMC4yLDAuNC0wLjQsMC40Yy0wLjIsMC0wLjQtMC4yLTAuNC0wLjRDMTIuNCw0OC4xLDEyLjYsNDgsMTIuOCw0OHoiLz4KCQk8cGF0aCBmaWxsPSIjQzBDMEJGIiBzdHJva2U9IiNDMEMwQkYiIHN0cm9rZS13aWR0aD0iMC4xIiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIGQ9Ik0xNC42LDUxLjJjLTAuMS0wLjEtMC4yLTAuMi0wLjMtMC4ySDUuNwoJCQljLTAuMSwwLTAuMiwwLjEtMC4zLDAuMmMtMC4xLDAuMS0wLjEsMC4yLDAsMC40YzAuNywyLDIuNSwzLjMsNC42LDMuM3MzLjktMS4zLDQuNi0zLjNDMTQuNyw1MS41LDE0LjcsNTEuMywxNC42LDUxLjJ6IE0xMCw1NC4xCgkJCWMtMS42LDAtMy0wLjktMy43LTIuMmg3LjNDMTMsNTMuMiwxMS42LDU0LjEsMTAsNTQuMXoiLz4KCQk8cGF0aCBmaWxsPSIjQzBDMEJGIiBzdHJva2U9IiNDMEMwQkYiIHN0cm9rZS13aWR0aD0iMC4xIiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIGQ9Ik03LjIsNDkuNWMwLjYsMCwxLjItMC41LDEuMi0xLjEKCQkJYzAtMC42LTAuNS0xLjItMS4yLTEuMmMtMC42LDAtMS4xLDAuNS0xLjEsMS4yQzYuMSw0OSw2LjYsNDkuNSw3LjIsNDkuNXogTTcuMiw0OGMwLjIsMCwwLjQsMC4yLDAuNCwwLjRjMCwwLjItMC4yLDAuNC0wLjQsMC40CgkJCWMtMC4yLDAtMC40LTAuMi0wLjQtMC40QzYuOCw0OC4xLDcsNDgsNy4yLDQ4eiIvPgoJCTxwYXRoIGZpbGw9IiNDMEMwQkYiIHN0cm9rZT0iI0MwQzBCRiIgc3Ryb2tlLXdpZHRoPSIwLjEiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgZD0iTTEwLDQzYy0zLjgsMC03LDMuMS03LDdjMCwzLjgsMy4xLDcsNyw3CgkJCXM3LTMuMSw3LTdDMTcsNDYuMiwxMy44LDQzLDEwLDQzeiBNMTAsNTYuMmMtMy40LDAtNi4yLTIuOC02LjItNi4yYzAtMy40LDIuOC02LjIsNi4yLTYuMnM2LjIsMi44LDYuMiw2LjIKCQkJQzE2LjIsNTMuNCwxMy40LDU2LjIsMTAsNTYuMnoiLz4KCTwvZz4KCTxnPgoJCTxnPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiNDMEMwQkYiIGQ9Ik02NC4xLDUzLjRsMi4zLDBjMC4yLDAsMC40LDAuMiwwLjQsMC40djIuMWMwLDAuMi0wLjIsMC40LTAuNCwwLjRoLTIuMwoJCQkJYy0wLjIsMC0wLjQtMC4yLTAuNC0wLjR2LTIuMUM2My43LDUzLjYsNjMuOCw1My40LDY0LjEsNTMuNHoiLz4KCQkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjQzBDMEJGIiBkPSJNNzMuNSw1My41aDIuNGMwLjIsMCwwLjQsMC4yLDAuNCwwLjR2MmMwLDAuMi0wLjIsMC40LTAuNCwwLjRoLTIuNAoJCQkJYy0wLjIsMC0wLjQtMC4yLTAuNC0wLjRsMC0yQzczLjEsNTMuNiw3My4zLDUzLjUsNzMuNSw1My41eiIvPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiNDMEMwQkYiIGQ9Ik02My43LDQ4LjRoMTIuNnY1SDYzLjdWNDguNHoiLz4KCQkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjQzBDMEJGIiBkPSJNNjUuNSw0My42aDguOWMxLDAsMS45LDAuOCwxLjksMS45djMuMUg2My43di0zLjFDNjMuNyw0NC41LDY0LjUsNDMuNiw2NS41LDQzLjZ6Ii8+CgkJCTxlbGxpcHNlIGZpbGw9IiNDMEMwQkYiIGN4PSI2Ni4yIiBjeT0iNTAuOSIgcng9IjAuOSIgcnk9IjEiLz4KCQkJPGVsbGlwc2UgZmlsbD0iI0MwQzBCRiIgY3g9IjczLjgiIGN5PSI1MC45IiByeD0iMC45IiByeT0iMSIvPgoJCTwvZz4KCTwvZz4KCTxnPgoJCTxnPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiNDMEMwQkYiIGQ9Ik05Ni40LDUwYzAsMy42LTIuOSw2LjUtNi40LDYuNXMtNi40LTIuOS02LjQtNi41czIuOS02LjUsNi40LTYuNVM5Ni40LDQ2LjQsOTYuNCw1MHoiLz4KCQkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjQzBDMEJGIiBkPSJNOTYuMyw0OC42YzAsMCwwLDAuMSwwLDAuMWMtMC45LDAuMS0yLjksMC4xLTQuNi0xLjJjLTEuMS0wLjgtMi0xLjctMi42LTIuNQoJCQkJYy0wLjMtMC40LTAuNi0wLjgtMC43LTFjLTAuMS0wLjEtMC4xLTAuMi0wLjEtMC4yYzAuNS0wLjEsMS4yLTAuMiwyLTAuMmMxLjIsMCwyLjUsMC4zLDMuNSwxLjFjMSwwLjgsMS43LDEuOCwyLjEsMi44CgkJCQlDOTYuMSw0Ny45LDk2LjIsNDguMyw5Ni4zLDQ4LjZ6Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iI0MwQzBCRiIgZD0iTTg0LDUyLjJjMCwwLDAtMC4xLDAtMC4xYzAuOS0wLjIsMi45LTAuNCw0LjcsMC42YzEuMSwwLjcsMS45LDEuNSwyLjQsMi4zCgkJCQljMC40LDAuNSwwLjYsMSwwLjcsMS4zYy0wLjQsMC4xLTEsMC4yLTEuNywwLjNjLTEsMC0yLjEtMC4xLTMuMi0wLjhzLTEuOS0xLjYtMi40LTIuNUM4NC4yLDUyLjgsODQuMSw1Mi41LDg0LDUyLjJ6Ii8+CgkJPC9nPgoJPC9nPgoJPGc+CgkJPGc+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iI0MwQzBCRiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBkPSJNMTE2LjMsNDYuOGwtMS40LDJsLTAuOC0wLjhsLTAuNi0wLjdsMCwwLjlsLTAuMSw4LjJoLTYuOAoJCQkJbC0wLjEtOC4ybDAtMC45bC0wLjYsMC43bC0wLjgsMC44bC0xLjQtMmwyLjYtMi45YzAuMS0wLjEsMC4yLTAuMSwwLjMtMC4xaDEuM2wwLjQsMC43YzAuNywxLjMsMi42LDEuMywzLjMtMC4xbDAuMy0wLjZoMS4yCgkJCQljMC4xLDAsMC4yLDAsMC4zLDAuMWwwLjMtMC4zbC0wLjMsMC4zTDExNi4zLDQ2Ljh6Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iI0MwQzBCRiIgZD0iTTExMC4xLDQ3LjdoMnYwLjljMCwwLjQtMC40LDAuNy0xLDAuN2MtMC42LDAtMS0wLjMtMS0wLjdMMTEwLjEsNDcuN0wxMTAuMSw0Ny43eiIvPgoJCTwvZz4KCTwvZz4KCTxnPgoJCTxnPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiNDMEMwQkYiIGQ9Ik0xMjYuOCw1NC4zYzAsMS4yLTEsMi4yLTIuMiwyLjJzLTIuMi0xLTIuMi0yLjJzMS0yLjIsMi4yLTIuMlMxMjYuOCw1My4xLDEyNi44LDU0LjN6Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iI0MwQzBCRiIgZD0iTTEzNy42LDU0LjNjMCwxLjItMSwyLjItMi4yLDIuMmMtMS4yLDAtMi4yLTEtMi4yLTIuMnMxLTIuMiwyLjItMi4yCgkJCQlDMTM2LjYsNTIuMSwxMzcuNiw1My4xLDEzNy42LDU0LjN6Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iI0MwQzBCRiIgZD0iTTEyNi44LDQ0LjR2OS45Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iI0MwQzBCRiIgZD0iTTEzNy43LDQ0LjR2OS45Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iI0MwQzBCRiIgZD0iTTEyNi44LDQzLjVoMTAuOHYyLjdoLTEwLjhDMTI2LjgsNDYuMiwxMjYuOCw0My41LDEyNi44LDQzLjV6Ii8+CgkJPC9nPgoJPC9nPgoJPGc+CgkJPGc+CgkJCTxwYXRoIGZpbGw9IiNDMEMwQkYiIGQ9Ik0xNzAuOCw0My4xTDE3MC44LDQzLjFjLTAuMywwLTAuNSwwLTAuOCwwYy0yLjEsMC00LDEtNS4zLDIuNWwtMC4xLDBsLTAuMS0wLjFsLTEtMS4ybC0wLjMsMy40bDMuNCwwLjMKCQkJCWwtMS4xLTEuM2wtMC4xLTAuMWwwLjEtMC4xYzEuMS0xLjUsMy0yLjMsNS0yLjFsMCwwYzMuMiwwLjMsNS41LDMuMSw1LjIsNi4zYy0wLjMsMy0zLjEsNS4zLTYuMSw1LjFjLTMuMS0wLjItNS40LTIuOS01LjMtNgoJCQkJbC0xLjMtMC4xYy0wLjIsMy44LDIuNiw3LjEsNi4zLDcuNGMzLjksMC4zLDcuMy0yLjYsNy42LTYuNUMxNzcuMiw0Ni44LDE3NC40LDQzLjUsMTcwLjgsNDMuMXoiLz4KCQkJPHBhdGggZmlsbD0iI0MwQzBCRiIgZD0iTTE3MC4zLDQ3LjRjMC0wLjMtMC4zLTAuNi0wLjYtMC42cy0wLjYsMC4zLTAuNiwwLjZ2My4yYzAsMC4yLDAuMSwwLjMsMC4yLDAuNGMwLjEsMC4xLDAuMywwLjIsMC40LDAuMgoJCQkJaDIuNGMwLjQsMCwwLjYtMC4zLDAuNi0wLjZjMC0wLjMtMC4zLTAuNi0wLjYtMC42aC0xLjZoLTAuMnYtMC4yTDE3MC4zLDQ3LjRMMTcwLjMsNDcuNHoiLz4KCQk8L2c+Cgk8L2c+Cgk8Zz4KCQk8Zz4KCQkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjQzBDMEJGIiBkPSJNMTg2LjIsNDMuNGg3LjdjMS41LDAsMi43LDEuMiwyLjcsMi43djcuN2MwLDEuNS0xLjIsMi43LTIuNywyLjdoLTcuNwoJCQkJYy0xLjUsMC0yLjctMS4yLTIuNy0yLjd2LTcuN0MxODMuNCw0NC43LDE4NC43LDQzLjQsMTg2LjIsNDMuNHoiLz4KCQkJPGVsbGlwc2UgZmlsbD0iI0MwQzBCRiIgY3g9IjE4NiIgY3k9IjQ4LjkiIHJ4PSIwLjciIHJ5PSIwLjciLz4KCQkJPGVsbGlwc2UgZmlsbD0iI0MwQzBCRiIgY3g9IjE5NCIgY3k9IjQ2LjciIHJ4PSIwLjciIHJ5PSIwLjciLz4KCQkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjQzBDMEJGIiBzdHJva2UtbGluZWNhcD0icm91bmQiIGQ9Ik0xODYsNTMuM2wwLjQtMC4zYzAuNC0wLjMsMS0wLjMsMS41LTAuMWwxLDAuNAoJCQkJYzAuNSwwLjIsMSwwLjIsMS41LTAuMWwwLjgtMC41YzAuNC0wLjMsMS0wLjMsMS41LTAuMWwxLjgsMC44Ii8+CgkJPC9nPgoJPC9nPgoJPHBhdGggZmlsbD0iI0MwQzBCRiIgc3Ryb2tlPSIjQzBDMEJGIiBzdHJva2Utd2lkdGg9IjAuMjUiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgZD0iTTE1Niw0NC4zYy0wLjItMC4xLTAuNC0wLjEtMC41LDAKCQljMCwwLTAuMiwwLjEtMC45LDAuMmMtMC43LDAtMi40LTAuMS0zLjgtMC42Yy0wLjgtMC4zLTEuNy0wLjUtMi41LTAuNWMtMC4yLDAtMC40LDAtMC41LDBjLTEuMywwLTIuNSwwLjMtMy42LDEKCQljLTAuMiwwLjEtMC4yLDAuMi0wLjIsMC40djExLjZjMCwwLjMsMC4xLDAuNSwwLjMsMC41YzAuNiwwLDAuNS0wLjQsMC41LTAuNnYtNS43YzAuNy0wLjMsMy4yLTEuMSw1LjgtMC4xCgkJYzEuNiwwLjYsMy41LDAuNyw0LjMsMC43YzAuOCwwLDEuMy0wLjMsMS4zLTAuM2MwLjItMC4xLDAuMy0wLjIsMC4zLTAuNHYtNS43QzE1Ni4yLDQ0LjYsMTU2LjEsNDQuNCwxNTYsNDQuM3ogTTE1NS42LDUwLjIKCQljLTAuMSwwLTAuNywwLjEtMSwwLjFjLTAuNywwLTIuNC0wLjEtMy44LTAuNmMtMi41LTEtNS0wLjUtNi4yLTAuMXYtNC45YzAuOS0wLjUsMi4yLTAuNywzLjItMC43YzAuMSwwLDAuMywwLDAuNCwwCgkJYzAuNywwLDEuNSwwLjIsMi4yLDAuNGMxLjYsMC42LDMuNSwwLjcsNC4zLDAuN2MwLjIsMCwwLjgsMCwxLTAuMVY1MC4yeiIvPgoJPGc+CgkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjQzBDMEJGIiBkPSJNNDguMSw0My41aDMuN2MyLjUsMCw0LjUsMiw0LjUsNC41YzAsMC41LTAuNCwwLjktMC45LDAuOUg0NC41Yy0wLjUsMC0wLjktMC40LTAuOS0wLjkKCQkJQzQzLjYsNDUuNSw0NS42LDQzLjUsNDguMSw0My41eiIvPgoJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iI0MwQzBCRiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBkPSJNNDMuNSw0OC44Yy0wLjIsMC4xLTAuNSwxLjIsMCwxLjVjMS40LDEsOC41LDAuOCwxMS4zLDAuNgoJCQljMC44LTAuMSwxLjYtMC40LDEuNy0xLjJjMC0wLjMtMC4xLTAuNi0wLjYtMC45Ii8+CgkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjQzBDMEJGIiBzdHJva2UtbGluZWNhcD0icm91bmQiIGQ9Ik00My41LDUwLjZMNDMuMyw1MWMtMC4yLDAuNSwwLjIsMSwwLjcsMC45YzAuMy0wLjEsMC41LDAsMC43LDAuMwoJCQlsMC4xLDAuMmMwLjMsMC41LDEsMC42LDEuNSwwLjJsMCwwYzAuMy0wLjIsMC43LTAuMywxLTAuMmwwLjgsMC4zYzAuNCwwLjIsMC44LDAuMSwxLjIsMGwwLjUtMC4yYzAuNC0wLjIsMC45LTAuMiwxLjMsMGwwLjUsMC4yCgkJCWMwLjQsMC4yLDAuOCwwLjIsMS4yLDBsMC4yLTAuMWMwLjMtMC4yLDAuOC0wLjIsMS4xLDAuMWwwLjIsMC4yYzAuMywwLjMsMC44LDAuMiwxLTAuMmwwLjEtMC4yYzAuMS0wLjIsMC0wLjMsMC4yLTAuMwoJCQljMC41LDAsMS4yLTAuMywxLjEtMC43bC0wLjQtMS4xIi8+CgkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjQzBDMEJGIiBzdHJva2UtbGluZWNhcD0icm91bmQiIGQ9Ik00My41LDUyLjJjLTAuMSwwLjItMC4zLDAuOCwwLDEuMWMwLjMsMC40LDMsMS4xLDYuNCwxLjEKCQkJYzIuMiwwLDQuNi0wLjMsNi0wLjZjMC41LTAuMSwwLjktMC41LDAuOC0wLjljMC0wLjItMC4yLTAuNS0wLjQtMC43Ii8+CgkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjQzBDMEJGIiBzdHJva2UtbGluZWNhcD0icm91bmQiIGQ9Ik00My41LDUzLjNjMCwwLjUsMC42LDIuMywxLjMsMi43YzEuOCwwLjgsNS43LDAuNyw4LjEsMC41CgkJCWMxLjMtMC4xLDIuNS0wLjcsMy4yLTEuOGMwLjMtMC41LDAuNS0xLDAuNS0xLjQiLz4KCQk8ZWxsaXBzZSBmaWxsPSIjQzBDMEJGIiBjeD0iNTEuNiIgY3k9IjQ2LjUiIHJ4PSIwLjMiIHJ5PSIwLjQiLz4KCQk8ZWxsaXBzZSBmaWxsPSIjQzBDMEJGIiBjeD0iNTMiIGN5PSI0NSIgcng9IjAuMyIgcnk9IjAuNCIvPgoJCTxlbGxpcHNlIGZpbGw9IiNDMEMwQkYiIGN4PSI1MyIgY3k9IjQ3LjIiIHJ4PSIwLjMiIHJ5PSIwLjQiLz4KCQk8ZWxsaXBzZSBmaWxsPSIjQzBDMEJGIiBjeD0iNTQuMyIgY3k9IjQ2LjUiIHJ4PSIwLjMiIHJ5PSIwLjQiLz4KCQk8ZWxsaXBzZSBmaWxsPSIjQzBDMEJGIiBjeD0iNTAuOSIgY3k9IjQ1IiByeD0iMC4zIiByeT0iMC40Ii8+Cgk8L2c+Cgk8Zz4KCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiNDMEMwQkYiIGQ9Ik0yNC4yLDUxdi03LjZjMC4xLDAuMSwwLjgsMC45LDIuOCwzLjFjMi41LTEuNyw1LjYtMC43LDYuOSwwbDIuNC0zLjF2Ny4xCgkJCWMwLDEuMi0wLjEsMi41LTAuOSwzLjRjLTEsMS4yLTIuNywyLjUtNS4zLDIuNWMtMi45LDAtNC41LTEuNS01LjMtMi45QzI0LjIsNTIuOSwyNC4yLDUyLDI0LjIsNTF6Ii8+CgkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjQzBDMEJGIiBzdHJva2UtbGluZWNhcD0icm91bmQiIGQ9Ik0yMS4yLDUwbDUuNCwxLjIiLz4KCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiNDMEMwQkYiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgZD0iTTIxLjIsNTQuMWw1LjQtMS4yIi8+CgkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjQzBDMEJGIiBzdHJva2UtbGluZWNhcD0icm91bmQiIGQ9Ik0zOC44LDUwbC01LjQsMS4yIi8+CgkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjQzBDMEJGIiBzdHJva2UtbGluZWNhcD0icm91bmQiIGQ9Ik0zOC44LDU0LjFsLTUuNC0xLjIiLz4KCQk8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZmlsbD0iI0MwQzBCRiIgZD0iTTI5LjUsNTIuNEwyOSw1MS43Yy0wLjItMC4zLDAtMC42LDAuMy0wLjZoMS40CgkJCWMwLjMsMCwwLjUsMC40LDAuMywwLjZsLTAuNywxbDAsMGMtMC43LDEuMi0yLjYsMS4xLTMuMS0wLjNsLTAuMS0wLjJjLTAuMS0wLjIsMC0wLjQsMC4yLTAuNXMwLjQsMCwwLjUsMC4ybDAuMSwwLjIKCQkJQzI4LjMsNTIuOCwyOS4xLDUyLjksMjkuNSw1Mi40eiIvPgoJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iI0MwQzBCRiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBkPSJNMzIuNCw1Mi4xbC0wLjEsMC4yYy0wLjQsMS0xLjgsMS4xLTIuMywwLjIiLz4KCQk8ZWxsaXBzZSBmaWxsPSIjQzBDMEJGIiBjeD0iMjcuNiIgY3k9IjQ5LjciIHJ4PSIwLjciIHJ5PSIwLjciLz4KCQk8ZWxsaXBzZSBmaWxsPSIjQzBDMEJGIiBjeD0iMzIuNCIgY3k9IjQ5LjciIHJ4PSIwLjciIHJ5PSIwLjciLz4KCTwvZz4KCTxnPgoJCTxwYXRoIGZpbGw9IiM2QUE5REQiIHN0cm9rZT0iIzZBQTlERCIgc3Ryb2tlLXdpZHRoPSIwLjEiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgZD0iTTE0LjYsNzEuMmMtMC4xLTAuMS0wLjItMC4yLTAuMy0wLjJINS43CgkJCWMtMC4xLDAtMC4yLDAuMS0wLjMsMC4yYy0wLjEsMC4xLTAuMSwwLjIsMCwwLjRjMC43LDIsMi41LDMuMyw0LjYsMy4zczMuOS0xLjMsNC42LTMuM0MxNC43LDcxLjUsMTQuNyw3MS4zLDE0LjYsNzEuMnogTTEwLDc0LjEKCQkJYy0xLjYsMC0zLTAuOS0zLjctMi4yaDcuM0MxMyw3My4yLDExLjYsNzQuMSwxMCw3NC4xeiIvPgoJCTxwYXRoIGZpbGw9IiM2QUE5REQiIHN0cm9rZT0iIzZBQTlERCIgc3Ryb2tlLXdpZHRoPSIwLjEiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgZD0iTTEyLjgsNjkuNWMwLjYsMCwxLjEtMC41LDEuMS0xLjEKCQkJYzAtMC42LTAuNS0xLjItMS4xLTEuMmMtMC42LDAtMS4yLDAuNS0xLjIsMS4yQzExLjYsNjksMTIuMiw2OS41LDEyLjgsNjkuNXogTTEyLjgsNjhjMC4yLDAsMC40LDAuMiwwLjQsMC40CgkJCWMwLDAuMi0wLjIsMC40LTAuNCwwLjRjLTAuMiwwLTAuNC0wLjItMC40LTAuNEMxMi40LDY4LjEsMTIuNiw2OCwxMi44LDY4eiIvPgoJCTxwYXRoIGZpbGw9IiM2QUE5REQiIHN0cm9rZT0iIzZBQTlERCIgc3Ryb2tlLXdpZHRoPSIwLjEiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgZD0iTTcuMiw2OS41YzAuNiwwLDEuMi0wLjUsMS4yLTEuMQoJCQljMC0wLjYtMC41LTEuMi0xLjItMS4yYy0wLjYsMC0xLjEsMC41LTEuMSwxLjJDNi4xLDY5LDYuNiw2OS41LDcuMiw2OS41eiBNNy4yLDY4YzAuMiwwLDAuNCwwLjIsMC40LDAuNGMwLDAuMi0wLjIsMC40LTAuNCwwLjQKCQkJYy0wLjIsMC0wLjQtMC4yLTAuNC0wLjRDNi44LDY4LjEsNyw2OCw3LjIsNjh6Ii8+CgkJPHBhdGggZmlsbD0iIzZBQTlERCIgc3Ryb2tlPSIjNkFBOUREIiBzdHJva2Utd2lkdGg9IjAuMSIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBkPSJNMTAsNjNjLTMuOCwwLTcsMy4xLTcsN2MwLDMuOCwzLjEsNyw3LDcKCQkJczctMy4xLDctN0MxNyw2Ni4yLDEzLjgsNjMsMTAsNjN6IE0xMCw3Ni4yYy0zLjQsMC02LjItMi44LTYuMi02LjJjMC0zLjQsMi44LTYuMiw2LjItNi4yczYuMiwyLjgsNi4yLDYuMgoJCQlDMTYuMiw3My40LDEzLjQsNzYuMiwxMCw3Ni4yeiIvPgoJPC9nPgoJPGc+CgkJPGc+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzZBQTlERCIgZD0iTTY0LjEsNzMuNGwyLjMsMGMwLjIsMCwwLjQsMC4yLDAuNCwwLjR2Mi4xYzAsMC4yLTAuMiwwLjQtMC40LDAuNGgtMi4zCgkJCQljLTAuMiwwLTAuNC0wLjItMC40LTAuNHYtMi4xQzYzLjcsNzMuNiw2My44LDczLjQsNjQuMSw3My40eiIvPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiM2QUE5REQiIGQ9Ik03My41LDczLjVoMi40YzAuMiwwLDAuNCwwLjIsMC40LDAuNHYyLjFjMCwwLjItMC4yLDAuNC0wLjQsMC40aC0yLjQKCQkJCWMtMC4yLDAtMC40LTAuMi0wLjQtMC40bDAtMi4xQzczLjEsNzMuNiw3My4zLDczLjUsNzMuNSw3My41eiIvPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiM2QUE5REQiIGQ9Ik02My43LDY4LjRoMTIuNnY1SDYzLjdWNjguNHoiLz4KCQkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjNkFBOUREIiBkPSJNNjUuNSw2My42aDguOWMxLDAsMS45LDAuOCwxLjksMS45djMuMUg2My43di0zLjFDNjMuNyw2NC41LDY0LjUsNjMuNiw2NS41LDYzLjZ6Ii8+CgkJCTxlbGxpcHNlIGZpbGw9IiM2QUE5REQiIGN4PSI2Ni4yIiBjeT0iNzAuOSIgcng9IjAuOSIgcnk9IjAuOSIvPgoJCQk8ZWxsaXBzZSBmaWxsPSIjNkFBOUREIiBjeD0iNzMuOCIgY3k9IjcwLjkiIHJ4PSIwLjkiIHJ5PSIwLjkiLz4KCQk8L2c+Cgk8L2c+Cgk8Zz4KCQk8Zz4KCQkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjNkFBOUREIiBkPSJNOTYuNCw3MGMwLDMuNi0yLjksNi41LTYuNCw2LjVzLTYuNC0yLjktNi40LTYuNXMyLjktNi41LDYuNC02LjVTOTYuNCw2Ni40LDk2LjQsNzB6Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzZBQTlERCIgZD0iTTk2LjMsNjguNmMwLDAsMCwwLjEsMCwwLjFjLTAuOSwwLjEtMi45LDAuMS00LjYtMS4yYy0xLjEtMC44LTItMS43LTIuNi0yLjUKCQkJCWMtMC4zLTAuNC0wLjYtMC44LTAuNy0xLjFjLTAuMS0wLjEtMC4xLTAuMi0wLjEtMC4yYzAuNS0wLjEsMS4yLTAuMiwyLTAuMmMxLjIsMCwyLjUsMC4zLDMuNSwxLjFjMSwwLjgsMS43LDEuOCwyLjEsMi44CgkJCQlDOTYuMSw2Ny45LDk2LjIsNjguMyw5Ni4zLDY4LjZ6Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzZBQTlERCIgZD0iTTg0LDcyLjJjMCwwLDAtMC4xLDAtMC4xYzAuOS0wLjIsMi45LTAuNCw0LjcsMC42YzEuMSwwLjcsMS45LDEuNSwyLjQsMi4zCgkJCQljMC40LDAuNSwwLjYsMSwwLjcsMS4zYy0wLjQsMC4xLTEsMC4yLTEuNywwLjNjLTEsMC0yLjEtMC4xLTMuMi0wLjhzLTEuOS0xLjYtMi40LTIuNUM4NC4yLDcyLjgsODQuMSw3Mi40LDg0LDcyLjJ6Ii8+CgkJPC9nPgoJPC9nPgoJPGc+CgkJPGc+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzZBQTlERCIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBkPSJNMTE2LjMsNjYuOGwtMS40LDJsLTAuOC0wLjhsLTAuNi0wLjdsMCwwLjlsLTAuMSw4LjJoLTYuOAoJCQkJbC0wLjEtOC4ybDAtMC45bC0wLjYsMC43bC0wLjgsMC44bC0xLjQtMmwyLjYtMi45YzAuMS0wLjEsMC4yLTAuMSwwLjMtMC4xaDEuM2wwLjQsMC43YzAuNywxLjMsMi42LDEuMywzLjMtMC4xbDAuMy0wLjZoMS4yCgkJCQljMC4xLDAsMC4yLDAsMC4zLDAuMWwwLjMtMC4zbC0wLjMsMC4zTDExNi4zLDY2Ljh6Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzZBQTlERCIgZD0iTTExMC4xLDY3LjdoMnYwLjljMCwwLjQtMC40LDAuNy0xLDAuN2MtMC42LDAtMS0wLjMtMS0wLjdMMTEwLjEsNjcuN0wxMTAuMSw2Ny43eiIvPgoJCTwvZz4KCTwvZz4KCTxnPgoJCTxnPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiM2QUE5REQiIGQ9Ik0xMjYuOCw3NC4zYzAsMS4yLTEsMi4yLTIuMiwyLjJzLTIuMi0xLTIuMi0yLjJzMS0yLjIsMi4yLTIuMlMxMjYuOCw3My4xLDEyNi44LDc0LjN6Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzZBQTlERCIgZD0iTTEzNy42LDc0LjNjMCwxLjItMSwyLjItMi4yLDIuMmMtMS4yLDAtMi4yLTEtMi4yLTIuMnMxLTIuMiwyLjItMi4yCgkJCQlDMTM2LjYsNzIuMSwxMzcuNiw3My4xLDEzNy42LDc0LjN6Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzZBQTlERCIgZD0iTTEyNi44LDY0LjR2OS45Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzZBQTlERCIgZD0iTTEzNy43LDY0LjR2OS45Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzZBQTlERCIgZD0iTTEyNi44LDYzLjVoMTAuOHYyLjdoLTEwLjhDMTI2LjgsNjYuMiwxMjYuOCw2My41LDEyNi44LDYzLjV6Ii8+CgkJPC9nPgoJPC9nPgoJPGc+CgkJPGc+CgkJCTxwYXRoIGZpbGw9IiM2QUE5REQiIGQ9Ik0xNzAuOCw2My4xTDE3MC44LDYzLjFjLTAuMywwLTAuNSwwLTAuOCwwYy0yLjEsMC00LDEtNS4zLDIuNWwtMC4xLDBsLTAuMS0wLjFsLTEtMS4ybC0wLjMsMy40bDMuNCwwLjMKCQkJCWwtMS4xLTEuM2wtMC4xLTAuMWwwLjEtMC4xYzEuMS0xLjQsMy0yLjMsNS0yLjFsMCwwYzMuMiwwLjMsNS41LDMuMSw1LjIsNi4zYy0wLjMsMy0zLjEsNS4zLTYuMSw1LjFjLTMuMS0wLjItNS40LTIuOS01LjMtNgoJCQkJbC0xLjMtMC4xYy0wLjIsMy44LDIuNiw3LjEsNi4zLDcuNGMzLjksMC4zLDcuMy0yLjYsNy42LTYuNUMxNzcuMiw2Ni44LDE3NC40LDYzLjUsMTcwLjgsNjMuMXoiLz4KCQkJPHBhdGggZmlsbD0iIzZBQTlERCIgZD0iTTE3MC4zLDY3LjRjMC0wLjMtMC4zLTAuNi0wLjYtMC42cy0wLjYsMC4zLTAuNiwwLjZ2My4yYzAsMC4yLDAuMSwwLjMsMC4yLDAuNGMwLjEsMC4xLDAuMywwLjIsMC40LDAuMgoJCQkJaDIuNGMwLjQsMCwwLjYtMC4zLDAuNi0wLjZTMTcyLjQsNzAsMTcyLDcwaC0xLjZoLTAuMnYtMC4yTDE3MC4zLDY3LjRMMTcwLjMsNjcuNHoiLz4KCQk8L2c+Cgk8L2c+Cgk8Zz4KCQk8Zz4KCQkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjNkFBOUREIiBkPSJNMTg2LjIsNjMuNGg3LjdjMS41LDAsMi43LDEuMiwyLjcsMi43djcuN2MwLDEuNS0xLjIsMi43LTIuNywyLjdoLTcuNwoJCQkJYy0xLjUsMC0yLjctMS4yLTIuNy0yLjd2LTcuN0MxODMuNCw2NC43LDE4NC43LDYzLjQsMTg2LjIsNjMuNHoiLz4KCQkJPGVsbGlwc2UgZmlsbD0iIzZBQTlERCIgY3g9IjE4NiIgY3k9IjY4LjkiIHJ4PSIwLjciIHJ5PSIwLjciLz4KCQkJPGVsbGlwc2UgZmlsbD0iIzZBQTlERCIgY3g9IjE5NCIgY3k9IjY2LjciIHJ4PSIwLjciIHJ5PSIwLjciLz4KCQkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjNkFBOUREIiBzdHJva2UtbGluZWNhcD0icm91bmQiIGQ9Ik0xODYsNzMuM2wwLjQtMC4zYzAuNC0wLjMsMS0wLjMsMS41LTAuMWwxLDAuNAoJCQkJYzAuNSwwLjIsMSwwLjIsMS41LTAuMWwwLjgtMC41YzAuNC0wLjMsMS0wLjMsMS41LTAuMWwxLjgsMC44Ii8+CgkJPC9nPgoJPC9nPgoJPHBhdGggZmlsbD0iIzZBQTlERCIgc3Ryb2tlPSIjNkFBOUREIiBzdHJva2Utd2lkdGg9IjAuMjUiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgZD0iTTE1Niw2NC4zYy0wLjItMC4xLTAuNC0wLjEtMC41LDAKCQljMCwwLTAuMiwwLjEtMC45LDAuMmMtMC43LDAtMi40LTAuMS0zLjgtMC42Yy0wLjgtMC4zLTEuNy0wLjUtMi41LTAuNWMtMC4yLDAtMC40LDAtMC41LDBjLTEuMywwLTIuNSwwLjMtMy42LDEKCQljLTAuMiwwLjEtMC4yLDAuMi0wLjIsMC40djExLjZjMCwwLjMsMC4xLDAuNSwwLjMsMC41YzAuNiwwLDAuNS0wLjQsMC41LTAuNnYtNS43YzAuNy0wLjMsMy4yLTEuMSw1LjgtMC4xCgkJYzEuNiwwLjYsMy41LDAuNyw0LjMsMC43YzAuOCwwLDEuMy0wLjMsMS4zLTAuM2MwLjItMC4xLDAuMy0wLjIsMC4zLTAuNHYtNS43QzE1Ni4yLDY0LjYsMTU2LjEsNjQuNCwxNTYsNjQuM3ogTTE1NS42LDcwLjIKCQljLTAuMSwwLTAuNywwLjEtMSwwLjFjLTAuNywwLTIuNC0wLjEtMy44LTAuNmMtMi41LTEtNS0wLjUtNi4yLTAuMXYtNC45YzAuOS0wLjUsMi4yLTAuNywzLjItMC43YzAuMSwwLDAuMywwLDAuNCwwCgkJYzAuNywwLDEuNSwwLjIsMi4yLDAuNGMxLjYsMC42LDMuNSwwLjcsNC4zLDAuN2MwLjIsMCwwLjgsMCwxLTAuMVY3MC4yeiIvPgoJPGc+CgkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjNkFBOUREIiBkPSJNNDguMSw2My41aDMuN2MyLjUsMCw0LjUsMiw0LjUsNC41YzAsMC41LTAuNCwwLjktMC45LDAuOUg0NC41Yy0wLjUsMC0wLjktMC40LTAuOS0wLjkKCQkJQzQzLjYsNjUuNSw0NS42LDYzLjUsNDguMSw2My41eiIvPgoJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzZBQTlERCIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBkPSJNNDMuNSw2OC44Yy0wLjIsMC4xLTAuNSwxLjIsMCwxLjVjMS40LDAuOSw4LjUsMC44LDExLjMsMC42CgkJCWMwLjgtMC4xLDEuNi0wLjQsMS43LTEuMmMwLTAuMy0wLjEtMC42LTAuNi0wLjkiLz4KCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiM2QUE5REQiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgZD0iTTQzLjUsNzAuNkw0My4zLDcxYy0wLjIsMC41LDAuMiwxLDAuNywwLjljMC4zLTAuMSwwLjUsMC4xLDAuNywwLjMKCQkJbDAuMSwwLjJjMC4zLDAuNSwxLDAuNiwxLjUsMC4ybDAsMGMwLjMtMC4yLDAuNy0wLjMsMS0wLjJsMC44LDAuM2MwLjQsMC4yLDAuOCwwLjEsMS4yLDBsMC41LTAuMmMwLjQtMC4yLDAuOS0wLjIsMS4zLDBsMC41LDAuMgoJCQljMC40LDAuMiwwLjgsMC4yLDEuMi0wLjFsMC4yLTAuMWMwLjMtMC4yLDAuOC0wLjIsMS4xLDAuMWwwLjIsMC4yYzAuMywwLjMsMC44LDAuMiwxLTAuMmwwLjEtMC4yYzAuMS0wLjIsMC0wLjMsMC4yLTAuMwoJCQljMC41LDAsMS4yLTAuMywxLjEtMC43bC0wLjQtMS4xIi8+CgkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjNkFBOUREIiBzdHJva2UtbGluZWNhcD0icm91bmQiIGQ9Ik00My41LDcyLjJjLTAuMSwwLjItMC4zLDAuOCwwLDEuMWMwLjMsMC40LDMsMS4xLDYuNCwxLjEKCQkJYzIuMiwwLDQuNi0wLjMsNi0wLjZjMC41LTAuMSwwLjktMC40LDAuOC0wLjljMC0wLjItMC4yLTAuNS0wLjQtMC43Ii8+CgkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjNkFBOUREIiBzdHJva2UtbGluZWNhcD0icm91bmQiIGQ9Ik00My41LDczLjNjMCwwLjUsMC42LDIuMywxLjMsMi43YzEuOCwwLjgsNS43LDAuNyw4LjEsMC41CgkJCWMxLjMtMC4xLDIuNS0wLjcsMy4yLTEuOGMwLjMtMC41LDAuNS0xLDAuNS0xLjQiLz4KCQk8ZWxsaXBzZSBmaWxsPSIjNkFBOUREIiBjeD0iNTEuNiIgY3k9IjY2LjUiIHJ4PSIwLjMiIHJ5PSIwLjQiLz4KCQk8ZWxsaXBzZSBmaWxsPSIjNkFBOUREIiBjeD0iNTMiIGN5PSI2NSIgcng9IjAuMyIgcnk9IjAuNCIvPgoJCTxlbGxpcHNlIGZpbGw9IiM2QUE5REQiIGN4PSI1MyIgY3k9IjY3LjIiIHJ4PSIwLjMiIHJ5PSIwLjQiLz4KCQk8ZWxsaXBzZSBmaWxsPSIjNkFBOUREIiBjeD0iNTQuMyIgY3k9IjY2LjUiIHJ4PSIwLjMiIHJ5PSIwLjQiLz4KCQk8ZWxsaXBzZSBmaWxsPSIjNkFBOUREIiBjeD0iNTAuOSIgY3k9IjY1IiByeD0iMC4zIiByeT0iMC40Ii8+Cgk8L2c+Cgk8Zz4KCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiM2QUE5REQiIGQ9Ik0yNC4yLDcxdi03LjZjMC4xLDAuMSwwLjgsMC45LDIuOCwzLjFjMi41LTEuNyw1LjYtMC43LDYuOSwwbDIuNC0zLjF2Ny4xCgkJCWMwLDEuMi0wLjEsMi41LTAuOSwzLjRjLTEsMS4yLTIuNywyLjUtNS4zLDIuNWMtMi45LDAtNC41LTEuNS01LjMtMi45QzI0LjIsNzIuOSwyNC4yLDcyLDI0LjIsNzF6Ii8+CgkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjNkFBOUREIiBzdHJva2UtbGluZWNhcD0icm91bmQiIGQ9Ik0yMS4yLDcwLjFsNS40LDEuMiIvPgoJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzZBQTlERCIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBkPSJNMjEuMiw3NC4xbDUuNC0xLjIiLz4KCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiM2QUE5REQiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgZD0iTTM4LjgsNzAuMWwtNS40LDEuMiIvPgoJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzZBQTlERCIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBkPSJNMzguOCw3NC4xbC01LjQtMS4yIi8+CgkJPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGZpbGw9IiM2QUE5REQiIGQ9Ik0yOS41LDcyLjRMMjksNzEuN2MtMC4yLTAuMywwLTAuNiwwLjMtMC42aDEuNAoJCQljMC4zLDAsMC41LDAuNCwwLjMsMC42bC0wLjcsMWwwLDBjLTAuNywxLjItMi42LDEuMS0zLjEtMC4zbC0wLjEtMC4yYy0wLjEtMC4yLDAtMC40LDAuMi0wLjVjMC4yLTAuMSwwLjQsMCwwLjUsMC4ybDAuMSwwLjIKCQkJQzI4LjMsNzIuOCwyOS4xLDcyLjksMjkuNSw3Mi40eiIvPgoJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzZBQTlERCIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBkPSJNMzIuNCw3Mi4xbC0wLjEsMC4yYy0wLjQsMS0xLjgsMS4xLTIuMywwLjIiLz4KCQk8ZWxsaXBzZSBmaWxsPSIjNkFBOUREIiBjeD0iMjcuNiIgY3k9IjY5LjciIHJ4PSIwLjciIHJ5PSIwLjciLz4KCQk8ZWxsaXBzZSBmaWxsPSIjNkFBOUREIiBjeD0iMzIuNCIgY3k9IjY5LjciIHJ4PSIwLjciIHJ5PSIwLjciLz4KCTwvZz4KPC9nPgo8Zz4KCTxwYXRoIGZpbGw9IiM4Njg2ODYiIHN0cm9rZT0iIzg2ODY4NiIgc3Ryb2tlLXdpZHRoPSIwLjEiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgZD0iTTEyLjgsOS41YzAuNiwwLDEuMS0wLjUsMS4xLTEuMgoJCWMwLTAuNi0wLjUtMS4xLTEuMS0xLjFjLTAuNiwwLTEuMiwwLjUtMS4yLDEuMVMxMi4yLDkuNSwxMi44LDkuNXogTTEyLjgsNy45YzAuMiwwLDAuNCwwLjIsMC40LDAuNGMwLDAuMi0wLjIsMC40LTAuNCwwLjQKCQljLTAuMiwwLTAuNC0wLjItMC40LTAuNEMxMi40LDguMSwxMi42LDcuOSwxMi44LDcuOXoiLz4KCTxwYXRoIGZpbGw9IiM4Njg2ODYiIHN0cm9rZT0iIzg2ODY4NiIgc3Ryb2tlLXdpZHRoPSIwLjEiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgZD0iTTcuMiw5LjVjMC42LDAsMS4yLTAuNSwxLjItMS4yCgkJYzAtMC42LTAuNS0xLjEtMS4yLTEuMWMtMC42LDAtMS4xLDAuNS0xLjEsMS4xUzYuNiw5LjUsNy4yLDkuNXogTTcuMiw3LjljMC4yLDAsMC40LDAuMiwwLjQsMC40YzAsMC4yLTAuMiwwLjQtMC40LDAuNAoJCUM3LDguNyw2LjgsOC41LDYuOCw4LjNDNi44LDguMSw3LDcuOSw3LjIsNy45eiIvPgoJPHBhdGggZmlsbD0iIzg2ODY4NiIgc3Ryb2tlPSIjODY4Njg2IiBzdHJva2Utd2lkdGg9IjAuMSIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBkPSJNMTQuNiwxMS4yYy0wLjEtMC4xLTAuMi0wLjItMC4zLTAuMkg1LjcKCQljLTAuMSwwLTAuMiwwLjEtMC4zLDAuMmMtMC4xLDAuMS0wLjEsMC4yLDAsMC40YzAuNywyLDIuNSwzLjMsNC42LDMuM3MzLjktMS4zLDQuNi0zLjNDMTQuNywxMS40LDE0LjcsMTEuMywxNC42LDExLjJ6IE0xMCwxNC4xCgkJYy0xLjYsMC0zLTAuOS0zLjctMi4yaDcuM0MxMywxMy4yLDExLjYsMTQuMSwxMCwxNC4xeiIvPgoJPHBhdGggZmlsbD0iIzg2ODY4NiIgc3Ryb2tlPSIjODY4Njg2IiBzdHJva2Utd2lkdGg9IjAuMSIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBkPSJNMTAsM2MtMy44LDAtNywzLjEtNyw3czMuMSw3LDcsN3M3LTMuMSw3LTcKCQlTMTMuOCwzLDEwLDN6IE0xMCwxNi4yYy0zLjQsMC02LjItMi44LTYuMi02LjJTNi42LDMuOCwxMCwzLjhzNi4yLDIuOCw2LjIsNi4yUzEzLjQsMTYuMiwxMCwxNi4yeiIvPgo8L2c+CjxnIGlkPSJDYXJfMDAwMDAwMTg5MzUzOTUwODU0MTM0MTM3NTAwMDAwMDA4MjUyNzM4Nzc4NDI3NzU3MTVfIj4KCTxnPgoJCTxnPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiM4Njg2ODYiIGQ9Ik02NC4xLDEzLjRsMi4zLDBjMC4yLDAsMC40LDAuMiwwLjQsMC40djIuMWMwLDAuMi0wLjIsMC40LTAuNCwwLjRoLTIuMwoJCQkJYy0wLjIsMC0wLjQtMC4yLTAuNC0wLjR2LTIuMUM2My43LDEzLjYsNjMuOCwxMy40LDY0LjEsMTMuNHoiLz4KCQkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjODY4Njg2IiBkPSJNNzMuNSwxMy40aDIuNGMwLjIsMCwwLjQsMC4yLDAuNCwwLjR2Mi4xYzAsMC4yLTAuMiwwLjQtMC40LDAuNGgtMi40CgkJCQljLTAuMiwwLTAuNC0wLjItMC40LTAuNGwwLTIuMUM3My4xLDEzLjYsNzMuMywxMy40LDczLjUsMTMuNHoiLz4KCQkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjODY4Njg2IiBkPSJNNjMuNyw4LjRoMTIuNnY1SDYzLjdWOC40eiIvPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiM4Njg2ODYiIGQ9Ik02NS41LDMuNmg4LjljMSwwLDEuOSwwLjgsMS45LDEuOXYzLjFINjMuN1Y1LjVDNjMuNyw0LjQsNjQuNSwzLjYsNjUuNSwzLjZ6Ii8+CgkJCTxlbGxpcHNlIGZpbGw9IiM4Njg2ODYiIGN4PSI2Ni4yIiBjeT0iMTAuOSIgcng9IjAuOSIgcnk9IjAuOSIvPgoJCQk8ZWxsaXBzZSBmaWxsPSIjODY4Njg2IiBjeD0iNzMuOCIgY3k9IjEwLjkiIHJ4PSIwLjkiIHJ5PSIwLjkiLz4KCQk8L2c+Cgk8L2c+CjwvZz4KPGcgaWQ9IkFjdGl2aXRpZXMiPgoJPGc+CgkJPGc+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzg2ODY4NiIgZD0iTTk2LjQsMTBjMCwzLjYtMi45LDYuNS02LjQsNi41cy02LjQtMi45LTYuNC02LjVzMi45LTYuNSw2LjQtNi41Uzk2LjQsNi40LDk2LjQsMTB6Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzg2ODY4NiIgZD0iTTk2LjMsOC42YzAsMCwwLDAuMSwwLDAuMWMtMC45LDAuMS0yLjksMC4xLTQuNi0xLjJjLTEuMS0wLjgtMi0xLjctMi42LTIuNQoJCQkJYy0wLjMtMC40LTAuNi0wLjgtMC43LTEuMWMtMC4xLTAuMS0wLjEtMC4yLTAuMS0wLjJjMC41LTAuMSwxLjItMC4yLDItMC4yYzEuMiwwLDIuNSwwLjMsMy41LDEuMWMxLDAuOCwxLjcsMS44LDIuMSwyLjgKCQkJCUM5Ni4xLDcuOSw5Ni4yLDguMyw5Ni4zLDguNnoiLz4KCQkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjODY4Njg2IiBkPSJNODQsMTIuMWMwLDAsMC0wLjEsMC0wLjFjMC45LTAuMiwyLjktMC40LDQuNywwLjZjMS4xLDAuNiwxLjksMS41LDIuNCwyLjMKCQkJCWMwLjQsMC41LDAuNiwxLDAuNywxLjNjLTAuNCwwLjEtMSwwLjItMS43LDAuM2MtMSwwLTIuMS0wLjEtMy4yLTAuOGMtMS4xLTAuNi0xLjktMS42LTIuNC0yLjVDODQuMiwxMi44LDg0LjEsMTIuNCw4NCwxMi4xeiIvPgoJCTwvZz4KCTwvZz4KPC9nPgo8ZyBpZD0iT2JqZWN0c18wMDAwMDA2NDMxMjM3MTczOTEzMDMxNTI1MDAwMDAxMDIyNTg4OTAzMjIyODYzMjk3NV8iPgoJPGc+CgkJPGc+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzg2ODY4NiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBkPSJNMTE2LjMsNi44bC0xLjQsMkwxMTQuMSw4bC0wLjYtMC43bDAsMC45bC0wLjEsOC4yaC02LjhsLTAuMS04LjIKCQkJCWwwLTAuOUwxMDUuOSw4bC0wLjgsMC44bC0xLjQtMmwyLjYtMi45YzAuMS0wLjEsMC4yLTAuMSwwLjMtMC4xaDEuM2wwLjQsMC43YzAuNywxLjMsMi42LDEuMywzLjMtMC4xbDAuMy0wLjZoMS4yCgkJCQljMC4xLDAsMC4yLDAsMC4zLDAuMWwwLjMtMC4zbC0wLjMsMC4zTDExNi4zLDYuOHoiLz4KCQkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjODY4Njg2IiBkPSJNMTEwLjEsNy43aDJ2MC45YzAsMC40LTAuNCwwLjctMSwwLjdjLTAuNiwwLTEtMC4zLTEtMC43TDExMC4xLDcuN0wxMTAuMSw3Ljd6Ii8+CgkJPC9nPgoJPC9nPgo8L2c+CjxnIGlkPSJTeW1ib2xzXzAwMDAwMDk2NzQ2OTA3ODY5OTI5OTIxMTgwMDAwMDA2NDg0ODEyODMwMjgyNTgyNDE2XyI+Cgk8Zz4KCQk8Zz4KCQkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjODY4Njg2IiBkPSJNMTI2LjgsMTQuM2MwLDEuMi0xLDIuMi0yLjIsMi4ycy0yLjItMS0yLjItMi4yczEtMi4yLDIuMi0yLjJTMTI2LjgsMTMuMSwxMjYuOCwxNC4zeiIvPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiM4Njg2ODYiIGQ9Ik0xMzcuNiwxNC4zYzAsMS4yLTEsMi4yLTIuMiwyLjJjLTEuMiwwLTIuMi0xLTIuMi0yLjJzMS0yLjIsMi4yLTIuMgoJCQkJQzEzNi42LDEyLjEsMTM3LjYsMTMuMSwxMzcuNiwxNC4zeiIvPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiM4Njg2ODYiIGQ9Ik0xMjYuOCw0LjR2OS45Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzg2ODY4NiIgZD0iTTEzNy43LDQuNHY5LjkiLz4KCQkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjODY4Njg2IiBkPSJNMTI2LjgsMy41aDEwLjh2Mi43aC0xMC44QzEyNi44LDYuMiwxMjYuOCwzLjUsMTI2LjgsMy41eiIvPgoJCTwvZz4KCTwvZz4KPC9nPgo8ZyBpZD0iUmVjZW50cyI+Cgk8Zz4KCQk8Zz4KCQkJPHBhdGggZmlsbD0iIzg2ODY4NiIgZD0iTTE3MC44LDMuMUwxNzAuOCwzLjFjLTAuMywwLTAuNSwwLTAuOCwwYy0yLjEsMC00LDEtNS4zLDIuNWwtMC4xLDBsLTAuMS0wLjFsLTEtMS4ybC0wLjMsMy40bDMuNCwwLjMKCQkJCWwtMS4xLTEuM2wtMC4xLTAuMWwwLjEtMC4xYzEuMS0xLjQsMy0yLjMsNS0yLjFsMCwwYzMuMiwwLjMsNS41LDMuMSw1LjIsNi4zYy0wLjMsMy0zLjEsNS4zLTYuMSw1LjFjLTMuMS0wLjItNS40LTIuOS01LjMtNgoJCQkJTDE2Myw5LjVjLTAuMiwzLjgsMi42LDcuMSw2LjMsNy40YzMuOSwwLjQsNy4zLTIuNiw3LjYtNi41QzE3Ny4yLDYuOCwxNzQuNCwzLjUsMTcwLjgsMy4xeiIvPgoJCQk8cGF0aCBmaWxsPSIjODY4Njg2IiBkPSJNMTcwLjMsNy40YzAtMC4zLTAuMy0wLjYtMC42LTAuNlMxNjksNy4xLDE2OSw3LjR2My4yYzAsMC4yLDAuMSwwLjMsMC4yLDAuNGMwLjEsMC4xLDAuMywwLjIsMC40LDAuMgoJCQkJaDIuNGMwLjQsMCwwLjYtMC4zLDAuNi0wLjZzLTAuMy0wLjYtMC42LTAuNmgtMS42aC0wLjJWOS44TDE3MC4zLDcuNEwxNzAuMyw3LjR6Ii8+CgkJPC9nPgoJPC9nPgo8L2c+CjxnIGlkPSJDdXN0b21fMDAwMDAxODEwODcyMjk0MzQzMDIzMzY3ODAwMDAwMDUxNTIyNzc5NDU5NDA2NzQ0ODhfIj4KCTxnPgoJCTxnPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiM4Njg2ODYiIGQ9Ik0xODYuMiwzLjRoNy43YzEuNSwwLDIuNywxLjIsMi43LDIuN3Y3LjdjMCwxLjUtMS4yLDIuNy0yLjcsMi43aC03LjcKCQkJCWMtMS41LDAtMi43LTEuMi0yLjctMi43VjYuMUMxODMuNCw0LjYsMTg0LjcsMy40LDE4Ni4yLDMuNHoiLz4KCQkJPGVsbGlwc2UgZmlsbD0iIzg2ODY4NiIgY3g9IjE4NiIgY3k9IjguOSIgcng9IjAuNyIgcnk9IjAuNyIvPgoJCQk8ZWxsaXBzZSBmaWxsPSIjODY4Njg2IiBjeD0iMTk0IiBjeT0iNi43IiByeD0iMC43IiByeT0iMC43Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzg2ODY4NiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBkPSJNMTg2LDEzLjNsMC40LTAuM2MwLjQtMC4zLDEtMC4zLDEuNS0wLjFsMSwwLjQKCQkJCWMwLjUsMC4yLDEsMC4yLDEuNS0wLjFsMC44LTAuNWMwLjQtMC4zLDEtMC4zLDEuNS0wLjFsMS44LDAuOCIvPgoJCTwvZz4KCTwvZz4KPC9nPgo8cGF0aCBmaWxsPSIjODY4Njg2IiBzdHJva2U9IiM4Njg2ODYiIHN0cm9rZS13aWR0aD0iMC4yNSIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBkPSJNMTU2LDQuM2MtMC4yLTAuMS0wLjQtMC4xLTAuNSwwCgljMCwwLTAuMiwwLjEtMC45LDAuMWMtMC43LDAtMi40LTAuMS0zLjgtMC42Yy0wLjgtMC4zLTEuNy0wLjUtMi41LTAuNWMtMC4yLDAtMC40LDAtMC41LDBjLTEuMywwLTIuNSwwLjMtMy42LDEKCWMtMC4yLDAuMS0wLjIsMC4yLTAuMiwwLjR2MTEuNmMwLDAuMywwLjEsMC41LDAuMywwLjVjMC42LDAsMC41LTAuNCwwLjUtMC42di01LjdjMC43LTAuMywzLjItMS4xLDUuOC0wLjFjMS42LDAuNiwzLjUsMC43LDQuMywwLjcKCWMwLjgsMCwxLjMtMC4zLDEuMy0wLjNjMC4yLTAuMSwwLjMtMC4yLDAuMy0wLjRWNC43QzE1Ni4yLDQuNSwxNTYuMSw0LjQsMTU2LDQuM3ogTTE1NS42LDEwLjJjLTAuMSwwLTAuNywwLjEtMSwwLjEKCWMtMC43LDAtMi40LTAuMS0zLjgtMC42Yy0yLjUtMS01LTAuNS02LjItMC4xVjQuN2MwLjktMC41LDIuMi0wLjcsMy4yLTAuN2MwLjEsMCwwLjMsMCwwLjQsMGMwLjcsMCwxLjUsMC4yLDIuMiwwLjQKCWMxLjYsMC42LDMuNSwwLjcsNC4zLDAuN2MwLjIsMCwwLjgsMCwxLTAuMVYxMC4yeiIvPgo8ZyBpZD0iRm9vZCI+Cgk8ZyBpZD0iTGF5ZXJfMTIiPgoJCTxnPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiM4Njg2ODYiIGQ9Ik00OC4xLDMuNWgzLjdjMi41LDAsNC41LDIsNC41LDQuNWMwLDAuNS0wLjQsMC45LTAuOSwwLjlINDQuNWMtMC41LDAtMC45LTAuNC0wLjktMC45CgkJCQlDNDMuNiw1LjUsNDUuNiwzLjUsNDguMSwzLjV6Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzg2ODY4NiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBkPSJNNDMuNSw4LjdjLTAuMiwwLjEtMC41LDEuMiwwLDEuNWMxLjQsMC45LDguNSwwLjgsMTEuMywwLjYKCQkJCWMwLjgtMC4xLDEuNi0wLjQsMS43LTEuMmMwLTAuMy0wLjEtMC42LTAuNi0wLjkiLz4KCQkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjODY4Njg2IiBzdHJva2UtbGluZWNhcD0icm91bmQiIGQ9Ik00My41LDEwLjZMNDMuMywxMWMtMC4yLDAuNSwwLjIsMSwwLjcsMC45CgkJCQljMC4zLTAuMSwwLjUsMC4xLDAuNywwLjNsMC4xLDAuMmMwLjMsMC41LDEsMC42LDEuNSwwLjJsMCwwYzAuMy0wLjIsMC43LTAuMywxLTAuMmwwLjgsMC4zYzAuNCwwLjEsMC44LDAuMSwxLjIsMGwwLjUtMC4yCgkJCQljMC40LTAuMiwwLjktMC4yLDEuMywwbDAuNSwwLjJjMC40LDAuMiwwLjgsMC4xLDEuMi0wLjFsMC4yLTAuMWMwLjMtMC4yLDAuOC0wLjEsMS4xLDAuMWwwLjIsMC4yYzAuMywwLjMsMC44LDAuMiwxLTAuMmwwLjEtMC4yCgkJCQljMC4xLTAuMiwwLTAuMywwLjItMC40YzAuNSwwLDEuMi0wLjMsMS4xLTAuN2wtMC40LTEuMSIvPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiM4Njg2ODYiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgZD0iTTQzLjUsMTIuMWMtMC4xLDAuMi0wLjMsMC44LDAsMS4xYzAuMywwLjQsMywxLjEsNi40LDEuMQoJCQkJYzIuMiwwLDQuNi0wLjMsNi0wLjZjMC41LTAuMSwwLjktMC40LDAuOC0wLjljMC0wLjItMC4yLTAuNS0wLjQtMC43Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzg2ODY4NiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBkPSJNNDMuNSwxMy4zYzAsMC41LDAuNiwyLjQsMS4zLDIuNmMxLjgsMC44LDUuNywwLjcsOC4xLDAuNQoJCQkJYzEuMy0wLjEsMi41LTAuNywzLjItMS44YzAuMy0wLjUsMC41LTEsMC41LTEuNCIvPgoJCQk8ZWxsaXBzZSBmaWxsPSIjODY4Njg2IiBjeD0iNTEuNiIgY3k9IjYuNSIgcng9IjAuMyIgcnk9IjAuNCIvPgoJCQk8ZWxsaXBzZSBmaWxsPSIjODY4Njg2IiBjeD0iNTMiIGN5PSI0LjkiIHJ4PSIwLjMiIHJ5PSIwLjQiLz4KCQkJPGVsbGlwc2UgZmlsbD0iIzg2ODY4NiIgY3g9IjUzIiBjeT0iNy4yIiByeD0iMC4zIiByeT0iMC40Ii8+CgkJCTxlbGxpcHNlIGZpbGw9IiM4Njg2ODYiIGN4PSI1NC4zIiBjeT0iNi41IiByeD0iMC4zIiByeT0iMC40Ii8+CgkJCTxlbGxpcHNlIGZpbGw9IiM4Njg2ODYiIGN4PSI1MC45IiBjeT0iNC45IiByeD0iMC4zIiByeT0iMC40Ii8+CgkJPC9nPgoJPC9nPgo8L2c+CjxnIGlkPSJBbmltYWxzIj4KCTxnPgoJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzg2ODY4NiIgZD0iTTI0LjIsMTFWMy41YzAuMSwwLjEsMC44LDAuOSwyLjgsMy4xYzIuNS0xLjcsNS42LTAuNyw2LjksMGwyLjQtMy4xdjcuMQoJCQljMCwxLjItMC4xLDIuNS0wLjksMy40Yy0xLDEuMi0yLjcsMi41LTUuMywyLjVjLTIuOSwwLTQuNS0xLjUtNS4zLTIuOUMyNC4yLDEyLjksMjQuMiwxMS45LDI0LjIsMTF6Ii8+CgkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjODY4Njg2IiBzdHJva2UtbGluZWNhcD0icm91bmQiIGQ9Ik0yMS4yLDEwbDUuNCwxLjIiLz4KCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiM4Njg2ODYiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgZD0iTTIxLjIsMTQuMWw1LjQtMS4yIi8+CgkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjODY4Njg2IiBzdHJva2UtbGluZWNhcD0icm91bmQiIGQ9Ik0zOC44LDEwbC01LjQsMS4yIi8+CgkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjODY4Njg2IiBzdHJva2UtbGluZWNhcD0icm91bmQiIGQ9Ik0zOC44LDE0LjFsLTUuNC0xLjIiLz4KCQk8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZmlsbD0iIzg2ODY4NiIgZD0iTTI5LjUsMTIuNEwyOSwxMS43Yy0wLjItMC4zLDAtMC42LDAuMy0wLjZoMS40CgkJCWMwLjMsMCwwLjUsMC40LDAuMywwLjZsLTAuNywxbDAsMGMtMC43LDEuMi0yLjYsMS4xLTMuMS0wLjNsLTAuMS0wLjJjLTAuMS0wLjIsMC0wLjQsMC4yLTAuNXMwLjQsMCwwLjUsMC4ybDAuMSwwLjIKCQkJQzI4LjMsMTIuNywyOS4xLDEyLjksMjkuNSwxMi40eiIvPgoJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzg2ODY4NiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBkPSJNMzIuNCwxMi4xbC0wLjEsMC4yYy0wLjQsMS0xLjgsMS4xLTIuMywwLjIiLz4KCQk8ZWxsaXBzZSBmaWxsPSIjODY4Njg2IiBjeD0iMjcuNiIgY3k9IjkuNyIgcng9IjAuNyIgcnk9IjAuNyIvPgoJCTxlbGxpcHNlIGZpbGw9IiM4Njg2ODYiIGN4PSIzMi40IiBjeT0iOS43IiByeD0iMC43IiByeT0iMC43Ii8+Cgk8L2c+CjwvZz4KPC9zdmc+";function $Te(o){var d,h=o.isActiveCategory,g=o.category,T=o.allowNavigation,I=o.categoryConfig,N=o.onClick;return q.createElement(Y5,{tabIndex:T?0:-1,className:Mi(tbe.catBtn,qA.categoryBtn,"epr-icn-"+g,(d={},d[vi.active]=h,d)),onClick:N,"aria-label":hoe(I),"aria-selected":h,role:"tab","aria-controls":"epr-category-nav-id"})}var Kee={backgroundPositionY:"calc(var(--epr-category-navigation-button-size) * 3)"},ebe={backgroundPositionY:"calc(var(--epr-category-navigation-button-size) * 2)"},qee={":not(.epr-search-active)":{catBtn:{":hover":Kee,"&.epr-active":Kee}}},tbe=Ns.create(Ys({catBtn:{".":"epr-cat-btn",display:"inline-block",transition:"opacity 0.2s ease-in-out",position:"relative",height:"var(--epr-category-navigation-button-size)",width:"var(--epr-category-navigation-button-size)",backgroundSize:"calc(var(--epr-category-navigation-button-size) * 10)",outline:"none",backgroundPosition:"0 0",backgroundImage:"url("+ZTe+")",":focus:before":{content:"",position:"absolute",top:"-2px",left:"-2px",right:"-2px",bottom:"-2px",border:"2px solid var(--epr-category-icon-active-color)",borderRadius:"50%"},"&.epr-icn-suggested":{backgroundPositionX:"calc(var(--epr-category-navigation-button-size) * -8)"},"&.epr-icn-custom":{backgroundPositionX:"calc(var(--epr-category-navigation-button-size) * -9)"},"&.epr-icn-activities":{backgroundPositionX:"calc(var(--epr-category-navigation-button-size) * -4)"},"&.epr-icn-animals_nature":{backgroundPositionX:"calc(var(--epr-category-navigation-button-size) * -1)"},"&.epr-icn-flags":{backgroundPositionX:"calc(var(--epr-category-navigation-button-size) * -7)"},"&.epr-icn-food_drink":{backgroundPositionX:"calc(var(--epr-category-navigation-button-size) * -2)"},"&.epr-icn-objects":{backgroundPositionX:"calc(var(--epr-category-navigation-button-size) * -5)"},"&.epr-icn-smileys_people":{backgroundPositionX:"0px"},"&.epr-icn-symbols":{backgroundPositionX:"calc(var(--epr-category-navigation-button-size) * -6)"},"&.epr-icn-travel_places":{backgroundPositionX:"calc(var(--epr-category-navigation-button-size) * -3)"}}},nC("catBtn",ebe),{".epr-dark-theme":Ys({},qee),".epr-auto-theme":Ys({},qee)}));function nbe(){var o=q.useState(null),d=o[0],h=o[1],g=XTe();JTe(h);var T=BG(),I=boe(),N=aZ(),M=QTe();return q.createElement("div",{className:Mi(rbe.nav),role:"tablist","aria-label":"Category navigation",id:"epr-category-nav-id",ref:N},I.map(function(k){var x=$Q(k),V=x===d;if(pTe(k)&&M)return null;var K=!T&&!V;return q.createElement($Te,{key:x,category:x,isActiveCategory:V,allowNavigation:K,categoryConfig:k,onClick:function(){h(x),g(x)}})}))}var rbe=Ns.create({nav:{".":"epr-category-nav",display:"flex",flexDirection:"row",justifyContent:"space-around",padding:"var(--epr-header-padding)"},".epr-search-active":{nav:{opacity:"0.3",cursor:"default",pointerEvents:"none"}},".epr-main:has(input:not(:placeholder-shown))":{nav:{opacity:"0.3",cursor:"default",pointerEvents:"none"}}}),hce="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDI2LjMuMSwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPgo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IgoJIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjgwcHgiIHZpZXdCb3g9IjAgMCAyMCA4MCIgZW5hYmxlLWJhY2tncm91bmQ9Im5ldyAwIDAgMjAgODAiIHhtbDpzcGFjZT0icHJlc2VydmUiPgo8cGF0aCBmaWxsPSIjODY4Njg2IiBkPSJNNi45OCwxMy41OWMwLjEsMC4xLDAuMjQsMC4xNSwwLjM3LDAuMTVzMC4yNy0wLjA1LDAuMzctMC4xNWwyLjQyLTIuNDJsMi40MywyLjQzCgljMC4xLDAuMSwwLjI0LDAuMTUsMC4zNywwLjE1YzAuMTQsMCwwLjI3LTAuMDUsMC4zNy0wLjE1YzAuMjEtMC4yMSwwLjIxLTAuNTQsMC0wLjc1bC0yLjQzLTIuNDNMMTMuMzIsOAoJYzAuMjEtMC4yMSwwLjIxLTAuNTQsMC0wLjc1Yy0wLjIxLTAuMjEtMC41NC0wLjIxLTAuNzUsMGwtMi40MiwyLjQyTDcuNzQsNy4yN2MtMC4yMS0wLjIxLTAuNTQtMC4yMS0wLjc1LDAKCWMtMC4yMSwwLjIxLTAuMjEsMC41NCwwLDAuNzVsMi40MSwyLjQxbC0yLjQyLDIuNDJDNi43NywxMy4wNSw2Ljc3LDEzLjM5LDYuOTgsMTMuNTlMNi45OCwxMy41OXoiLz4KPHBhdGggZmlsbD0iIzg2ODY4NiIgZD0iTTEwLjE1LDE4LjQzYzQuNDEsMCw4LTMuNTksOC04YzAtNC40MS0zLjU5LTgtOC04Yy00LjQxLDAtOCwzLjU5LTgsOEMyLjE1LDE0Ljg0LDUuNzQsMTguNDMsMTAuMTUsMTguNDN6CgkgTTEwLjE1LDMuNDljMy44MywwLDYuOTQsMy4xMSw2Ljk0LDYuOTRjMCwzLjgzLTMuMTEsNi45NC02Ljk0LDYuOTRjLTMuODMsMC02Ljk0LTMuMTEtNi45NC02Ljk0QzMuMjEsNi42LDYuMzMsMy40OSwxMC4xNSwzLjQ5CglMMTAuMTUsMy40OXoiLz4KPHBhdGggZmlsbD0iIzMzNzFCNyIgZD0iTTYuOTgsMzMuNTljMC4xLDAuMSwwLjI0LDAuMTUsMC4zNywwLjE1czAuMjctMC4wNSwwLjM3LTAuMTVsMi40Mi0yLjQybDIuNDMsMi40MwoJYzAuMSwwLjEsMC4yNCwwLjE1LDAuMzcsMC4xNWMwLjE0LDAsMC4yNy0wLjA1LDAuMzctMC4xNWMwLjIxLTAuMjEsMC4yMS0wLjU0LDAtMC43NWwtMi40My0yLjQzTDEzLjMyLDI4CgljMC4yMS0wLjIxLDAuMjEtMC41NCwwLTAuNzVjLTAuMjEtMC4yMS0wLjU0LTAuMjEtMC43NSwwbC0yLjQyLDIuNDJsLTIuNDEtMi40MWMtMC4yMS0wLjIxLTAuNTQtMC4yMS0wLjc1LDAKCWMtMC4yMSwwLjIxLTAuMjEsMC41NCwwLDAuNzVsMi40MSwyLjQxbC0yLjQyLDIuNDJDNi43NywzMy4wNSw2Ljc3LDMzLjM5LDYuOTgsMzMuNTlMNi45OCwzMy41OXoiLz4KPHBhdGggZmlsbD0iIzMzNzFCNyIgZD0iTTEwLjE1LDM4LjQzYzQuNDEsMCw4LTMuNTksOC04YzAtNC40MS0zLjU5LTgtOC04Yy00LjQxLDAtOCwzLjU5LTgsOEMyLjE1LDM0Ljg0LDUuNzQsMzguNDMsMTAuMTUsMzguNDN6CgkgTTEwLjE1LDIzLjQ5YzMuODMsMCw2Ljk0LDMuMTEsNi45NCw2Ljk0YzAsMy44My0zLjExLDYuOTQtNi45NCw2Ljk0Yy0zLjgzLDAtNi45NC0zLjExLTYuOTQtNi45NAoJQzMuMjEsMjYuNiw2LjMzLDIzLjQ5LDEwLjE1LDIzLjQ5TDEwLjE1LDIzLjQ5eiIvPgo8cGF0aCBmaWxsPSIjQzBDMEJGIiBkPSJNNi45OCw1My41OWMwLjEsMC4xLDAuMjQsMC4xNSwwLjM3LDAuMTVzMC4yNy0wLjA1LDAuMzctMC4xNWwyLjQyLTIuNDJsMi40MywyLjQzCgljMC4xLDAuMSwwLjI0LDAuMTUsMC4zNywwLjE1YzAuMTQsMCwwLjI3LTAuMDUsMC4zNy0wLjE1YzAuMjEtMC4yMSwwLjIxLTAuNTQsMC0wLjc1bC0yLjQzLTIuNDNMMTMuMzIsNDgKCWMwLjIxLTAuMjEsMC4yMS0wLjU0LDAtMC43NWMtMC4yMS0wLjIxLTAuNTQtMC4yMS0wLjc1LDBsLTIuNDIsMi40MmwtMi40MS0yLjQxYy0wLjIxLTAuMjEtMC41NC0wLjIxLTAuNzUsMAoJYy0wLjIxLDAuMjEtMC4yMSwwLjU0LDAsMC43NWwyLjQxLDIuNDFsLTIuNDIsMi40MkM2Ljc3LDUzLjA1LDYuNzcsNTMuMzksNi45OCw1My41OUw2Ljk4LDUzLjU5eiIvPgo8cGF0aCBmaWxsPSIjQzBDMEJGIiBkPSJNMTAuMTUsNTguNDNjNC40MSwwLDgtMy41OSw4LThjMC00LjQxLTMuNTktOC04LThjLTQuNDEsMC04LDMuNTktOCw4QzIuMTUsNTQuODQsNS43NCw1OC40MywxMC4xNSw1OC40M3oKCSBNMTAuMTUsNDMuNDljMy44MywwLDYuOTQsMy4xMSw2Ljk0LDYuOTRjMCwzLjgzLTMuMTEsNi45NC02Ljk0LDYuOTRjLTMuODMsMC02Ljk0LTMuMTEtNi45NC02Ljk0CglDMy4yMSw0Ni42LDYuMzMsNDMuNDksMTAuMTUsNDMuNDlMMTAuMTUsNDMuNDl6Ii8+CjxwYXRoIGZpbGw9IiM2QUE5REQiIGQ9Ik02Ljk4LDczLjU5YzAuMSwwLjEsMC4yNCwwLjE1LDAuMzcsMC4xNXMwLjI3LTAuMDUsMC4zNy0wLjE1bDIuNDItMi40MmwyLjQzLDIuNDMKCWMwLjEsMC4xLDAuMjQsMC4xNSwwLjM3LDAuMTVjMC4xNCwwLDAuMjctMC4wNSwwLjM3LTAuMTVjMC4yMS0wLjIxLDAuMjEtMC41NCwwLTAuNzVsLTIuNDMtMi40M0wxMy4zMiw2OAoJYzAuMjEtMC4yMSwwLjIxLTAuNTQsMC0wLjc1Yy0wLjIxLTAuMjEtMC41NC0wLjIxLTAuNzUsMGwtMi40MiwyLjQybC0yLjQxLTIuNDFjLTAuMjEtMC4yMS0wLjU0LTAuMjEtMC43NSwwCgljLTAuMjEsMC4yMS0wLjIxLDAuNTQsMCwwLjc1bDIuNDEsMi40MWwtMi40MiwyLjQyQzYuNzcsNzMuMDUsNi43Nyw3My4zOSw2Ljk4LDczLjU5TDYuOTgsNzMuNTl6Ii8+CjxwYXRoIGZpbGw9IiM2QUE5REQiIGQ9Ik0xMC4xNSw3OC40M2M0LjQxLDAsOC0zLjU5LDgtOGMwLTQuNDEtMy41OS04LTgtOGMtNC40MSwwLTgsMy41OS04LDhDMi4xNSw3NC44NCw1Ljc0LDc4LjQzLDEwLjE1LDc4LjQzegoJIE0xMC4xNSw2My40OWMzLjgzLDAsNi45NCwzLjExLDYuOTQsNi45NGMwLDMuODMtMy4xMSw2Ljk0LTYuOTQsNi45NGMtMy44MywwLTYuOTQtMy4xMS02Ljk0LTYuOTQKCUMzLjIxLDY2LjYsNi4zMyw2My40OSwxMC4xNSw2My40OUwxMC4xNSw2My40OXoiLz4KPC9zdmc+";function ibe(){var o=Boe();return q.createElement(Y5,{className:Mi(Jee.btnClearSearch,qA.visibleOnSearchOnly),onClick:o,"aria-label":"Clear",title:"Clear"},q.createElement("div",{className:Mi(Jee.icnClearnSearch)}))}var abe={":hover":{"> .epr-icn-clear-search":{backgroundPositionY:"-60px"}}},Jee=Ns.create(Ys({btnClearSearch:{".":"epr-btn-clear-search",position:"absolute",right:"var(--epr-search-bar-inner-padding)",height:"30px",width:"30px",display:"flex",alignItems:"center",justifyContent:"center",top:"50%",transform:"translateY(-50%)",padding:"0",borderRadius:"50%",":hover":{background:"var(--epr-hover-bg-color)"},":focus":{background:"var(--epr-hover-bg-color)"}},icnClearnSearch:{".":"epr-icn-clear-search",backgroundColor:"transparent",backgroundRepeat:"no-repeat",backgroundSize:"20px",height:"20px",width:"20px",backgroundImage:"url("+hce+")",":hover":{backgroundPositionY:"-20px"},":focus":{backgroundPositionY:"-20px"}}},nC("icnClearnSearch",{backgroundPositionY:"-40px"}),nC("btnClearSearch",abe))),QK=Sd(vi.emojiPicker)+" "+Sd(vi.emojiList),pce=["button",Sd(vi.emoji)].join(""),sbe=Sd(vi.category);function obe(o){var d=o.value;if(!d)return null;var h=cbe(d);return q.createElement("style",null,`
    `+QK+" "+pce+` {
      display: none;
    }


    `+QK+" "+h+` {
      display: flex;
    }

    `+QK+" "+sbe+":not(:has("+h+`)) {
      display: none;
    }
  `)}function cbe(o){return[pce,'[data-full-name*="',QX(o),'"]'].join("")}var lbe="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDI2LjMuMSwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPgo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IgoJIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjQwcHgiIHZpZXdCb3g9IjAgMCAyMCA0MCIgZW5hYmxlLWJhY2tncm91bmQ9Im5ldyAwIDAgMjAgNDAiIHhtbDpzcGFjZT0icHJlc2VydmUiPgo8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZmlsbD0iIzg2ODY4NiIgZD0iTTEyLDguODFjMCwyLjA4LTEuNjgsMy43Ni0zLjc2LDMuNzZjLTIuMDgsMC0zLjc2LTEuNjgtMy43Ni0zLjc2CgljMC0yLjA4LDEuNjgtMy43NiwzLjc2LTMuNzZDMTAuMzIsNS4wNSwxMiw2LjczLDEyLDguODF6IE0xMS4yMywxMi43MmMtMC44MywwLjY0LTEuODcsMS4wMS0yLjk5LDEuMDFjLTIuNzIsMC00LjkyLTIuMi00LjkyLTQuOTIKCWMwLTIuNzIsMi4yLTQuOTIsNC45Mi00LjkyYzIuNzIsMCw0LjkyLDIuMiw0LjkyLDQuOTJjMCwxLjEzLTAuMzgsMi4xNi0xLjAxLDIuOTlsMy45NCwzLjkzYzAuMjUsMC4yNSwwLjI1LDAuNjYsMCwwLjkyCgljLTAuMjUsMC4yNS0wLjY2LDAuMjUtMC45MiwwTDExLjIzLDEyLjcyeiIvPgo8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZmlsbD0iI0MwQzBCRiIgZD0iTTEyLDI4LjgxYzAsMi4wOC0xLjY4LDMuNzYtMy43NiwzLjc2Yy0yLjA4LDAtMy43Ni0xLjY4LTMuNzYtMy43NgoJYzAtMi4wOCwxLjY4LTMuNzYsMy43Ni0zLjc2QzEwLjMyLDI1LjA1LDEyLDI2LjczLDEyLDI4LjgxeiBNMTEuMjMsMzIuNzJjLTAuODMsMC42NC0xLjg3LDEuMDEtMi45OSwxLjAxCgljLTIuNzIsMC00LjkyLTIuMi00LjkyLTQuOTJjMC0yLjcyLDIuMi00LjkyLDQuOTItNC45MmMyLjcyLDAsNC45MiwyLjIsNC45Miw0LjkyYzAsMS4xMy0wLjM4LDIuMTYtMS4wMSwyLjk5bDMuOTQsMy45MwoJYzAuMjUsMC4yNSwwLjI1LDAuNjYsMCwwLjkyYy0wLjI1LDAuMjUtMC42NiwwLjI1LTAuOTIsMEwxMS4yMywzMi43MnoiLz4KPC9zdmc+";function dbe(){return q.createElement("div",{className:Mi(ube.icnSearch)})}var ube=Ns.create(Ys({icnSearch:{".":"epr-icn-search",content:"",position:"absolute",top:"50%",left:"var(--epr-search-bar-inner-padding)",transform:"translateY(-50%)",width:"20px",height:"20px",backgroundRepeat:"no-repeat",backgroundPosition:"0 0",backgroundSize:"20px",backgroundImage:"url("+lbe+")"}},nC("icnSearch",{backgroundPositionY:"-20px"})));function fbe(){var o=woe(),d=oZ();return o?null:q.createElement(uce,{className:Mi(x7.overlay)},q.createElement(hbe,null),d?q.createElement(fce,null):null)}function hbe(){var o=q.useState(0),d=o[0],h=o[1],g=QA(),T=sC(),I=WSe(),N=KSe(),M=Pye(),k=M.statusSearchResults,x=M.searchTerm,V=M.onChange,K=T==null?void 0:T.current,Q=K==null?void 0:K.value;return q.createElement(KG,{className:Mi(x7.searchContainer)},q.createElement(obe,{value:Q}),q.createElement("input",{autoFocus:N,"aria-label":"Type to search for an emoji",onFocus:g,className:Mi(x7.search),type:"text","aria-controls":"epr-search-id",placeholder:I,onChange:function(X){h(d+1),setTimeout(function(){var Z,ae;V((Z=X==null||(ae=X.target)==null?void 0:ae.value)!=null?Z:Q)})},ref:T}),x?q.createElement("div",{role:"status",className:Mi("epr-status-search-results",x7.visuallyHidden),"aria-live":"polite",id:"epr-search-id","aria-atomic":"true"},k):null,q.createElement(dbe,null),q.createElement(ibe,null))}var x7=Ns.create(Ys({overlay:{padding:"var(--epr-header-padding)",zIndex:"var(--epr-header-overlay-z-index)"},searchContainer:{".":"epr-search-container",flex:"1",display:"block",minWidth:"0"},visuallyHidden:{clip:"rect(0 0 0 0)",clipPath:"inset(50%)",height:"1px",overflow:"hidden",position:"absolute",whiteSpace:"nowrap",width:"1px"},search:{outline:"none",transition:"all 0.2s ease-in-out",color:"var(--epr-search-input-text-color)",borderRadius:"var(--epr-search-input-border-radius)",padding:"var(--epr-search-input-padding)",height:"var(--epr-search-input-height)",backgroundColor:"var(--epr-search-input-bg-color)",border:"1px solid var(--epr-search-input-bg-color)",width:"100%",":focus":{backgroundColor:"var(--epr-search-input-bg-color-active)",border:"1px solid var(--epr-search-border-color)"},"::placeholder":{color:"var(--epr-search-input-placeholder-color)"}},btnClearSearch:{".":"epr-btn-clear-search",position:"absolute",right:"var(--epr-search-bar-inner-padding)",height:"30px",width:"30px",display:"flex",alignItems:"center",justifyContent:"center",top:"50%",transform:"translateY(-50%)",padding:"0",borderRadius:"50%",":hover":{background:"var(--epr-hover-bg-color)"},":focus":{background:"var(--epr-hover-bg-color)"}},icnClearnSearch:{".":"epr-icn-clear-search",backgroundColor:"transparent",backgroundRepeat:"no-repeat",backgroundSize:"20px",height:"20px",width:"20px",backgroundImage:"url("+hce+")",":hover":{backgroundPositionY:"-20px"},":focus":{backgroundPositionY:"-20px"}}},nC("icnClearnSearch",{backgroundPositionY:"-40px"}),nC("btnClearSearch",{":hover > .epr-icn-clear-search":{backgroundPositionY:"-60px"}})));function pbe(){return q.createElement(KG,{className:Mi("epr-header",qA.hiddenOnReactions)},q.createElement(fbe,null),q.createElement(nbe,null))}function mbe(o){return q.createElement(mye,null,q.createElement(lSe,null),q.createElement(GSe,Object.assign({},o),q.createElement(gbe,null)))}function gbe(){var o=jG(),d=o[0],h=yoe(),g=q.useState(!d),T=g[0],I=g[1],N=JSe();return q.useEffect(function(){d&&!h||T||I(!0)},[T,h,d]),N?q.createElement(Zye,null,q.createElement(wTe,null),q.createElement(_be,{renderAll:T})):null}function _be(o){var d=o.renderAll;return d?q.createElement(q.Fragment,null,q.createElement(pbe,null),q.createElement(UTe,null),q.createElement(YTe,null)):null}var Ebe=q.memo(mbe,doe),vbe=function(o){sSe(d,o);function d(g){var T;return T=o.call(this,g)||this,T.state={hasError:!1},T}d.getDerivedStateFromError=function(){return{hasError:!0}};var h=d.prototype;return h.componentDidCatch=function(T,I){console.error("Emoji Picker React failed to render:",T,I)},h.render=function(){return this.state.hasError?null:this.props.children},d}(q.Component);function Sbe(o){var d=HSe({onEmojiClick:o.onEmojiClick,onReactionClick:o.onReactionClick,onSkinToneChange:o.onSkinToneChange});return q.createElement(vbe,null,q.createElement(voe.Provider,{value:d},q.createElement(Ebe,Object.assign({},o))))}var U7={exports:{}},ybe=U7.exports,Xee;function Tbe(){return Xee||(Xee=1,function(o,d){(function(h,g){o.exports=g()})(ybe,function(){function h(e,t){return t.forEach(function(r){r&&typeof r!="string"&&!Array.isArray(r)&&Object.keys(r).forEach(function(s){if(s!=="default"&&!(s in e)){var l=Object.getOwnPropertyDescriptor(r,s);Object.defineProperty(e,s,l.get?l:{enumerable:!0,get:function(){return r[s]}})}})}),Object.freeze(e)}var g=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof r5<"u"?r5:typeof self<"u"?self:{};function T(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var I=function(e){try{return!!e()}catch{return!0}},N=!I(function(){var e=(function(){}).bind();return typeof e!="function"||e.hasOwnProperty("prototype")}),M=N,k=Function.prototype,x=k.call,V=M&&k.bind.bind(x,x),K=M?V:function(e){return function(){return x.apply(e,arguments)}},Q=K({}.isPrototypeOf),ie=function(e){return e&&e.Math===Math&&e},X=ie(typeof globalThis=="object"&&globalThis)||ie(typeof window=="object"&&window)||ie(typeof self=="object"&&self)||ie(typeof g=="object"&&g)||ie(typeof g=="object"&&g)||function(){return this}()||Function("return this")(),Z=N,ae=Function.prototype,le=ae.apply,fe=ae.call,ue=typeof Reflect=="object"&&Reflect.apply||(Z?fe.bind(le):function(){return fe.apply(le,arguments)}),de=K,te=de({}.toString),ye=de("".slice),Te=function(e){return ye(te(e),8,-1)},Le=Te,je=K,he=function(e){if(Le(e)==="Function")return je(e)},ke=typeof document=="object"&&document.all,We=ke===void 0&&ke!==void 0?function(e){return typeof e=="function"||e===ke}:function(e){return typeof e=="function"},ze={},$e=!I(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),et=N,Oe=Function.prototype.call,qe=et?Oe.bind(Oe):function(){return Oe.apply(Oe,arguments)},lt={},Ge={}.propertyIsEnumerable,Ae=Object.getOwnPropertyDescriptor,rt=Ae&&!Ge.call({1:2},1);lt.f=rt?function(e){var t=Ae(this,e);return!!t&&t.enumerable}:Ge;var yt,Lt,Pt=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},_n=I,Gt=Te,zt=Object,rn=K("".split),ir=_n(function(){return!zt("z").propertyIsEnumerable(0)})?function(e){return Gt(e)==="String"?rn(e,""):zt(e)}:zt,kt=function(e){return e==null},Ht=kt,Jt=TypeError,tn=function(e){if(Ht(e))throw new Jt("Can't call method on "+e);return e},Yn=ir,oi=tn,Ri=function(e){return Yn(oi(e))},jr=We,dr=function(e){return typeof e=="object"?e!==null:jr(e)},Ii={},sa=Ii,ar=X,Sn=We,vc=function(e){return Sn(e)?e:void 0},Zi=function(e,t){return arguments.length<2?vc(sa[e])||vc(ar[e]):sa[e]&&sa[e][t]||ar[e]&&ar[e][t]},bm=X.navigator,jl=bm&&bm.userAgent,Tr=jl?String(jl):"",ss=X,Za=Tr,Vh=ss.process,ec=ss.Deno,Cf=Vh&&Vh.versions||ec&&ec.version,Sc=Cf&&Cf.v8;Sc&&(Lt=(yt=Sc.split("."))[0]>0&&yt[0]<4?1:+(yt[0]+yt[1])),!Lt&&Za&&(!(yt=Za.match(/Edge\/(\d+)/))||yt[1]>=74)&&(yt=Za.match(/Chrome\/(\d+)/))&&(Lt=+yt[1]);var Fa=Lt,ko=Fa,wf=I,Cm=X.String,Td=!!Object.getOwnPropertySymbols&&!wf(function(){var e=Symbol("symbol detection");return!Cm(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&ko&&ko<41}),Su=Td&&!Symbol.sham&&typeof Symbol.iterator=="symbol",wE=Zi,RE=We,wm=Q,uC=Object,Bh=Su?function(e){return typeof e=="symbol"}:function(e){var t=wE("Symbol");return RE(t)&&wm(t.prototype,uC(e))},Fh=String,yu=function(e){try{return Fh(e)}catch{return"Object"}},er=We,yc=yu,Ty=TypeError,os=function(e){if(er(e))return e;throw new Ty(yc(e)+" is not a function")},$i=os,Tc=kt,Rf=function(e,t){var r=e[t];return Tc(r)?void 0:$i(r)},Rm=qe,fC=We,hC=dr,pC=TypeError,E0={exports:{}},IE=X,Im=Object.defineProperty,v0=X,AE=function(e,t){try{Im(IE,e,{value:t,configurable:!0,writable:!0})}catch{IE[e]=t}return t},Gh="__core-js_shared__",cs=E0.exports=v0[Gh]||AE(Gh,{});(cs.versions||(cs.versions=[])).push({version:"3.42.0",mode:"pure",copyright:" 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.42.0/LICENSE",source:"https://github.com/zloirock/core-js"});var OE=E0.exports,zh=OE,Vl=function(e,t){return zh[e]||(zh[e]=t||{})},S0=tn,Tu=Object,bd=function(e){return Tu(S0(e))},i2=bd,ls=K({}.hasOwnProperty),Ga=Object.hasOwn||function(e,t){return ls(i2(e),t)},by=K,If=0,mC=Math.random(),Cy=by(1 .toString),Hh=function(e){return"Symbol("+(e===void 0?"":e)+")_"+Cy(++If+mC,36)},wy=Vl,Ry=Ga,YP=Hh,a2=Td,po=Su,Af=X.Symbol,gC=wy("wks"),Ai=po?Af.for||Af:Af&&Af.withoutSetter||YP,ea=function(e){return Ry(gC,e)||(gC[e]=a2&&Ry(Af,e)?Af[e]:Ai("Symbol."+e)),gC[e]},NE=qe,_C=dr,rl=Bh,EC=Rf,s2=function(e,t){var r,s;if(fC(r=e.toString)&&!hC(s=Rm(r,e))||fC(r=e.valueOf)&&!hC(s=Rm(r,e)))return s;throw new pC("Can't convert object to primitive value")},vC=TypeError,y0=ea("toPrimitive"),o2=function(e,t){if(!_C(e)||rl(e))return e;var r,s=EC(e,y0);if(s){if(r=NE(s,e,t),!_C(r)||rl(r))return r;throw new vC("Can't convert object to primitive value")}return s2(e)},LE=Bh,Of=function(e){var t=o2(e,"string");return LE(t)?t:t+""},Iy=dr,Ay=X.document,Oy=Iy(Ay)&&Iy(Ay.createElement),DE=function(e){return Oy?Ay.createElement(e):{}},c2=DE,l2=!$e&&!I(function(){return Object.defineProperty(c2("div"),"a",{get:function(){return 7}}).a!==7}),Ny=$e,SC=qe,yC=lt,T0=Pt,b0=Ri,d2=Of,TC=Ga,bC=l2,C0=Object.getOwnPropertyDescriptor;ze.f=Ny?C0:function(e,t){if(e=b0(e),t=d2(t),bC)try{return C0(e,t)}catch{}if(TC(e,t))return T0(!SC(yC.f,e,t),e[t])};var Nf=I,CC=We,Lf=/#|\.prototype\./,Bl=function(e,t){var r=Ly[wC(e)];return r===PE||r!==u2&&(CC(t)?Nf(t):!!t)},wC=Bl.normalize=function(e){return String(e).replace(Lf,".").toLowerCase()},Ly=Bl.data={},u2=Bl.NATIVE="N",PE=Bl.POLYFILL="P",ME=Bl,f2=os,bc=N,Cc=he(he.bind),$a=function(e,t){return f2(e),t===void 0?e:bc?Cc(e,t):function(){return e.apply(t,arguments)}},mo={},h2=$e&&I(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),RC=dr,IC=String,Es=TypeError,Ks=function(e){if(RC(e))return e;throw new Es(IC(e)+" is not an object")},p2=$e,KP=l2,Dy=h2,kE=Ks,Py=Of,AC=TypeError,OC=Object.defineProperty,NC=Object.getOwnPropertyDescriptor,xE="enumerable",UE="configurable",My="writable";mo.f=p2?Dy?function(e,t,r){if(kE(e),t=Py(t),kE(r),typeof e=="function"&&t==="prototype"&&"value"in r&&My in r&&!r[My]){var s=NC(e,t);s&&s[My]&&(e[t]=r.value,r={configurable:UE in r?r[UE]:s[UE],enumerable:xE in r?r[xE]:s[xE],writable:!1})}return OC(e,t,r)}:OC:function(e,t,r){if(kE(e),t=Py(t),kE(r),KP)try{return OC(e,t,r)}catch{}if("get"in r||"set"in r)throw new AC("Accessors not supported");return"value"in r&&(e[t]=r.value),e};var qP=mo,Wh=Pt,bu=$e?function(e,t,r){return qP.f(e,t,Wh(1,r))}:function(e,t,r){return e[t]=r,e},jE=X,LC=ue,JP=he,XP=We,QP=ze.f,Am=ME,w0=Ii,R0=$a,Om=bu,m2=Ga,br=function(e){var t=function(r,s,l){if(this instanceof t){switch(arguments.length){case 0:return new e;case 1:return new e(r);case 2:return new e(r,s)}return new e(r,s,l)}return LC(e,this,arguments)};return t.prototype=e.prototype,t},pr=function(e,t){var r,s,l,f,m,E,y,b,A,O=e.target,D=e.global,P=e.stat,F=e.proto,B=D?jE:P?jE[O]:jE[O]&&jE[O].prototype,Y=D?w0:w0[O]||Om(w0,O,{})[O],$=Y.prototype;for(f in t)s=!(r=Am(D?f:O+(P?".":"#")+f,e.forced))&&B&&m2(B,f),E=Y[f],s&&(y=e.dontCallGetSet?(A=QP(B,f))&&A.value:B[f]),m=s&&y?y:t[f],(r||F||typeof E!=typeof m)&&(b=e.bind&&s?R0(m,jE):e.wrap&&s?br(m):F&&XP(m)?JP(m):m,(e.sham||m&&m.sham||E&&E.sham)&&Om(b,"sham",!0),Om(Y,f,b),F&&(m2(w0,l=O+"Prototype")||Om(w0,l,{}),Om(w0[l],f,m),e.real&&$&&(r||!$[f])&&Om($,f,m)))},ZP=Math.ceil,$P=Math.floor,eM=Math.trunc||function(e){var t=+e;return(t>0?$P:ZP)(t)},VE=eM,Nm=function(e){var t=+e;return t!=t||t===0?0:VE(t)},tM=Nm,g2=Math.max,ky=Math.min,xy=function(e,t){var r=tM(e);return r<0?g2(r+t,0):ky(r,t)},_2=Nm,DC=Math.min,Lm=function(e){var t=_2(e);return t>0?DC(t,9007199254740991):0},Df=Lm,Yh=function(e){return Df(e.length)},nM=Ri,E2=xy,PC=Yh,Kh=function(e){return function(t,r,s){var l=nM(t),f=PC(l);if(f===0)return!e&&-1;var m,E=E2(s,f);if(e&&r!=r){for(;f>E;)if((m=l[E++])!=m)return!0}else for(;f>E;E++)if((e||E in l)&&l[E]===r)return e||E||0;return!e&&-1}},Dm={includes:Kh(!0),indexOf:Kh(!1)},rM=Dm.includes;pr({target:"Array",proto:!0,forced:I(function(){return!Array(1).includes()})},{includes:function(e){return rM(this,e,arguments.length>1?arguments[1]:void 0)}});var tc=X,v2=Ii,il=function(e,t){var r=v2[e+"Prototype"],s=r&&r[t];if(s)return s;var l=tc[e],f=l&&l.prototype;return f&&f[t]},MC=il("Array","includes"),kC=dr,xC=Te,S2=ea("match"),UC=function(e){var t;return kC(e)&&((t=e[S2])!==void 0?!!t:xC(e)==="RegExp")},y2=UC,jC=TypeError,T2={};T2[ea("toStringTag")]="z";var VC=String(T2)==="[object z]",Uy=VC,al=We,qh=Te,b2=ea("toStringTag"),Cd=Object,C2=qh(function(){return arguments}())==="Arguments",Pf=Uy?qh:function(e){var t,r,s;return e===void 0?"Undefined":e===null?"Null":typeof(r=function(l,f){try{return l[f]}catch{}}(t=Cd(e),b2))=="string"?r:C2?qh(t):(s=qh(t))==="Object"&&al(t.callee)?"Arguments":s},nc=Pf,iM=String,Ls=function(e){if(nc(e)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return iM(e)},BC=ea("match"),BE=pr,jy=function(e){if(y2(e))throw new jC("The method doesn't accept regular expressions");return e},w2=tn,Jh=Ls,I0=function(e){var t=/./;try{"/./"[e](t)}catch{try{return t[BC]=!1,"/./"[e](t)}catch{}}return!1},Vy=K("".indexOf);BE({target:"String",proto:!0,forced:!I0("includes")},{includes:function(e){return!!~Vy(Jh(w2(this)),Jh(jy(e)),arguments.length>1?arguments[1]:void 0)}});var R2=il("String","includes"),Xh=Q,By=MC,Fy=R2,Gy=Array.prototype,ft=String.prototype,aM=function(e){var t=e.includes;return e===Gy||Xh(Gy,e)&&t===Gy.includes?By:typeof e=="string"||e===ft||Xh(ft,e)&&t===ft.includes?Fy:t},ht=T(aM),I2=os,A2=bd,FC=ir,wd=Yh,GC=TypeError,sl="Reduce of empty array with no initial value",rc=function(e){return function(t,r,s,l){var f=A2(t),m=FC(f),E=wd(f);if(I2(r),E===0&&s<2)throw new GC(sl);var y=e?E-1:0,b=e?-1:1;if(s<2)for(;;){if(y in m){l=m[y],y+=b;break}if(y+=b,e?y<0:E<=y)throw new GC(sl)}for(;e?y>=0:E>y;y+=b)y in m&&(l=r(l,m[y],y,f));return l}},Rd={left:rc(!1)},zC=I,Pm=function(e,t){var r=[][e];return!!r&&zC(function(){r.call(null,t||function(){return 1},1)})},Qh=X,HC=Tr,Zh=Te,FE=function(e){return HC.slice(0,e.length)===e},Mm=FE("Bun/")?"BUN":FE("Cloudflare-Workers")?"CLOUDFLARE":FE("Deno/")?"DENO":FE("Node.js/")?"NODE":Qh.Bun&&typeof Bun.version=="string"?"BUN":Qh.Deno&&typeof Deno.version=="object"?"DENO":Zh(Qh.process)==="process"?"NODE":Qh.window&&Qh.document?"BROWSER":"REST",Ds=Mm==="NODE",sM=Rd.left;pr({target:"Array",proto:!0,forced:!Ds&&Fa>79&&Fa<83||!Pm("reduce")},{reduce:function(e){var t=arguments.length;return sM(this,e,t,t>1?arguments[1]:void 0)}});var go=il("Array","reduce"),WC=Q,Mf=go,zy=Array.prototype,GE=function(e){var t=e.reduce;return e===zy||WC(zy,e)&&t===zy.reduce?Mf:t},$h=GE,wc=T($h),YC=Te,Fl=Array.isArray||function(e){return YC(e)==="Array"},A0=pr,zE=Fl,HE=K([].reverse),ol=[1,2];A0({target:"Array",proto:!0,forced:String(ol)===String(ol.reverse())},{reverse:function(){return zE(this)&&(this.length=this.length),HE(this)}});var cl=il("Array","reverse"),Cu=Q,kf=cl,Id=Array.prototype,km=function(e){var t=e.reverse;return e===Id||Cu(Id,e)&&t===Id.reverse?kf:t},KC=km,Hy=T(KC),Wy=Hh,qs=Vl("keys"),wa=function(e){return qs[e]||(qs[e]=Wy(e))},Si=!I(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),xm=Ga,wu=We,qC=bd,Um=Si,JC=wa("IE_PROTO"),Yy=Object,WE=Yy.prototype,jm=Um?Yy.getPrototypeOf:function(e){var t=qC(e);if(xm(t,JC))return t[JC];var r=t.constructor;return wu(r)&&t instanceof r?r.prototype:t instanceof Yy?WE:null},O2=K,ep=os,O0=dr,xf=function(e){return O0(e)||e===null},Uf=String,tp=TypeError,jf=function(e,t,r){try{return O2(ep(Object.getOwnPropertyDescriptor(e,t)[r]))}catch{}},Ky=dr,qy=tn,Vm=function(e){if(xf(e))return e;throw new tp("Can't set "+Uf(e)+" as a prototype")},Jy=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,r={};try{(e=jf(Object.prototype,"__proto__","set"))(r,[]),t=r instanceof Array}catch{}return function(s,l){return qy(s),Vm(l),Ky(s)&&(t?e(s,l):s.__proto__=l),s}}():void 0),Ru={},za={},N0=Ga,N2=Ri,oM=Dm.indexOf,cM=za,L2=K([].push),vs=function(e,t){var r,s=N2(e),l=0,f=[];for(r in s)!N0(cM,r)&&N0(s,r)&&L2(f,r);for(;t.length>l;)N0(s,r=t[l++])&&(~oM(f,r)||L2(f,r));return f},L0=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],YE=vs,KE=L0.concat("length","prototype");Ru.f=Object.getOwnPropertyNames||function(e){return YE(e,KE)};var Bm={};Bm.f=Object.getOwnPropertySymbols;var np=Zi,D0=Ru,lM=Bm,qE=Ks,dM=K([].concat),D2=np("Reflect","ownKeys")||function(e){var t=D0.f(qE(e)),r=lM.f;return r?dM(t,r(e)):t},rp=Ga,XC=D2,Xy=ze,P2=mo,Iu={},QC=vs,Qy=L0,P0=Object.keys||function(e){return QC(e,Qy)},ZC=$e,Zy=h2,M2=mo,JE=Ks,$y=Ri,eT=P0;Iu.f=ZC&&!Zy?Object.defineProperties:function(e,t){JE(e);for(var r,s=$y(t),l=eT(t),f=l.length,m=0;f>m;)M2.f(e,r=l[m++],s[r]);return e};var Gl,M0=Zi("document","documentElement"),tT=Ks,Vf=Iu,zl=L0,Bf=za,$C=M0,ew=DE,ip="prototype",Fm="script",tw=wa("IE_PROTO"),XE=function(){},Gm=function(e){return"<"+Fm+">"+e+"</"+Fm+">"},QE=function(e){e.write(Gm("")),e.close();var t=e.parentWindow.Object;return e=null,t},ZE=function(){try{Gl=new ActiveXObject("htmlfile")}catch{}var e,t,r;ZE=typeof document<"u"?document.domain&&Gl?QE(Gl):(t=ew("iframe"),r="java"+Fm+":",t.style.display="none",$C.appendChild(t),t.src=String(r),(e=t.contentWindow.document).open(),e.write(Gm("document.F=Object")),e.close(),e.F):QE(Gl);for(var s=zl.length;s--;)delete ZE[ip][zl[s]];return ZE()};Bf[tw]=!0;var zm=Object.create||function(e,t){var r;return e!==null?(XE[ip]=tT(e),r=new XE,XE[ip]=null,r[tw]=e):r=ZE(),t===void 0?r:Vf.f(r,t)},nw=dr,ap=bu,Nr=Error,ci=K("".replace),Ss=String(new Nr("zxcasd").stack),$E=/\n\s*at [^:]*:[^\n]*/,k0=$E.test(Ss),sp=Pt,nT=!I(function(){var e=new Error("a");return!("stack"in e)||(Object.defineProperty(e,"stack",sp(1,7)),e.stack!==7)}),x0=bu,U0=function(e,t){if(k0&&typeof e=="string"&&!Nr.prepareStackTrace)for(;t--;)e=ci(e,$E,"");return e},uM=nT,es=Error.captureStackTrace,Ad={},rw=Ad,k2=ea("iterator"),x2=Array.prototype,U2=function(e){return e!==void 0&&(rw.Array===e||x2[k2]===e)},iw=Pf,rT=Rf,ev=kt,Rc=Ad,ds=ea("iterator"),j0=function(e){if(!ev(e))return rT(e,ds)||rT(e,"@@iterator")||Rc[iw(e)]},V0=qe,iT=os,aw=Ks,Ff=yu,aT=j0,sw=TypeError,tv=function(e,t){var r=arguments.length<2?aT(e):t;if(iT(r))return aw(V0(r,e));throw new sw(Ff(e)+" is not iterable")},ow=qe,cw=Ks,j2=Rf,sT=function(e,t,r){var s,l;cw(e);try{if(!(s=j2(e,"return"))){if(t==="throw")throw r;return r}s=ow(s,e)}catch(f){l=!0,s=f}if(t==="throw")throw r;if(l)throw s;return cw(s),r},V2=$a,nv=qe,oT=Ks,B0=yu,fM=U2,B2=Yh,lw=Q,F2=tv,F0=j0,dw=sT,uw=TypeError,Hm=function(e,t){this.stopped=e,this.result=t},rv=Hm.prototype,G0=function(e,t,r){var s,l,f,m,E,y,b,A=r&&r.that,O=!(!r||!r.AS_ENTRIES),D=!(!r||!r.IS_RECORD),P=!(!r||!r.IS_ITERATOR),F=!(!r||!r.INTERRUPTED),B=V2(t,A),Y=function(ee){return s&&dw(s,"normal",ee),new Hm(!0,ee)},$=function(ee){return O?(oT(ee),F?B(ee[0],ee[1],Y):B(ee[0],ee[1])):F?B(ee,Y):B(ee)};if(D)s=e.iterator;else if(P)s=e;else{if(!(l=F0(e)))throw new uw(B0(e)+" is not iterable");if(fM(l)){for(f=0,m=B2(e);m>f;f++)if((E=$(e[f]))&&lw(rv,E))return E;return new Hm(!1)}s=F2(e,l)}for(y=D?e.next:s.next;!(b=nv(y,s)).done;){try{E=$(b.value)}catch(ee){dw(s,"throw",ee)}if(typeof E=="object"&&E&&lw(rv,E))return E}return new Hm(!1)},hM=Ls,G2=pr,z0=Q,cT=jm,op=Jy,lT=function(e,t,r){for(var s=XC(t),l=P2.f,f=Xy.f,m=0;m<s.length;m++){var E=s[m];rp(e,E)||r&&rp(r,E)||l(e,E,f(t,E))}},Od=zm,H0=bu,Wm=Pt,W0=function(e,t){nw(t)&&"cause"in t&&ap(e,"cause",t.cause)},iv=function(e,t,r,s){uM&&(es?es(e,t):x0(e,"stack",U0(r,s)))},z2=G0,fw=function(e,t){return e===void 0?arguments.length<2?"":t:hM(e)},hw=ea("toStringTag"),Y0=Error,H2=[].push,cp=function(e,t){var r,s=z0(K0,this);op?r=op(new Y0,s?cT(this):K0):(r=s?this:Od(K0),H0(r,hw,"Error")),t!==void 0&&H0(r,"message",fw(t)),iv(r,cp,r.stack,1),arguments.length>2&&W0(r,arguments[2]);var l=[];return z2(e,H2,{that:l}),H0(r,"errors",l),r};op?op(cp,Y0):lT(cp,Y0,{name:!0});var K0=cp.prototype=Od(Y0.prototype,{constructor:Wm(1,cp),message:Wm(1,""),name:Wm(1,"AggregateError")});G2({global:!0},{AggregateError:cp});var Ym,av,q0,pw=We,sv=X.WeakMap,mw=pw(sv)&&/native code/.test(String(sv)),Hl=X,Km=dr,qm=bu,dT=Ga,ov=OE,Nd=wa,cv=za,lv="Object already initialized",dv=Hl.TypeError,W2=Hl.WeakMap;if(mw||ov.state){var Ic=ov.state||(ov.state=new W2);Ic.get=Ic.get,Ic.has=Ic.has,Ic.set=Ic.set,Ym=function(e,t){if(Ic.has(e))throw new dv(lv);return t.facade=e,Ic.set(e,t),t},av=function(e){return Ic.get(e)||{}},q0=function(e){return Ic.has(e)}}else{var lp=Nd("state");cv[lp]=!0,Ym=function(e,t){if(dT(e,lp))throw new dv(lv);return t.facade=e,qm(e,lp,t),t},av=function(e){return dT(e,lp)?e[lp]:{}},q0=function(e){return dT(e,lp)}}var dp,Gf,Jm,Ld={set:Ym,get:av,has:q0,enforce:function(e){return q0(e)?av(e):Ym(e,{})},getterFor:function(e){return function(t){var r;if(!Km(t)||(r=av(t)).type!==e)throw new dv("Incompatible receiver, "+e+" required");return r}}},J0=$e,uv=Ga,X0=Function.prototype,Y2=J0&&Object.getOwnPropertyDescriptor,fv=uv(X0,"name"),up={PROPER:fv&&(function(){}).name==="something",CONFIGURABLE:fv&&(!J0||J0&&Y2(X0,"name").configurable)},K2=bu,ys=function(e,t,r,s){return s&&s.enumerable?e[t]=r:K2(e,t,r),e},Au=I,fp=We,q2=dr,hp=zm,Ou=jm,Ps=ys,Q0=ea("iterator"),hv=!1;[].keys&&("next"in(Jm=[].keys())?(Gf=Ou(Ou(Jm)))!==Object.prototype&&(dp=Gf):hv=!0);var Nu=!q2(dp)||Au(function(){var e={};return dp[Q0].call(e)!==e});fp((dp=Nu?{}:hp(dp))[Q0])||Ps(dp,Q0,function(){return this});var gw={IteratorPrototype:dp,BUGGY_SAFARI_ITERATORS:hv},J2=Pf,Xm=VC?{}.toString:function(){return"[object "+J2(this)+"]"},uT=VC,X2=mo.f,Q2=bu,fT=Ga,hT=Xm,_w=ea("toStringTag"),Dd=function(e,t,r,s){var l=r?e:e&&e.prototype;l&&(fT(l,_w)||X2(l,_w,{configurable:!0,value:t}),s&&!uT&&Q2(l,"toString",hT))},Z2=gw.IteratorPrototype,$2=zm,pM=Pt,Ew=Dd,Ms=Ad,_o=function(){return this},pT=function(e,t,r,s){var l=t+" Iterator";return e.prototype=$2(Z2,{next:pM(+!s,r)}),Ew(e,l,!1,!0),Ms[l]=_o,e},pv=pr,mT=qe,vw=up,mv=pT,gv=jm,Sw=Dd,gT=ys,_v=Ad,eO=gw,_T=vw.PROPER,Qm=eO.BUGGY_SAFARI_ITERATORS,Ev=ea("iterator"),ET="keys",Zm="values",vv="entries",yw=function(){return this},Tw=function(e,t,r,s,l,f,m){mv(r,t,s);var E,y,b,A=function($){if($===l&&B)return B;if(!Qm&&$&&$ in P)return P[$];switch($){case ET:case Zm:case vv:return function(){return new r(this,$)}}return function(){return new r(this)}},O=t+" Iterator",D=!1,P=e.prototype,F=P[Ev]||P["@@iterator"]||l&&P[l],B=!Qm&&F||A(l),Y=t==="Array"&&P.entries||F;if(Y&&(E=gv(Y.call(new e)))!==Object.prototype&&E.next&&(Sw(E,O,!0,!0),_v[O]=yw),_T&&l===Zm&&F&&F.name!==Zm&&(D=!0,B=function(){return mT(F,this)}),l)if(y={values:A(Zm),keys:f?B:A(ET),entries:A(vv)},m)for(b in y)(Qm||D||!(b in P))&&gT(P,b,y[b]);else pv({target:t,proto:!0,forced:Qm||D},y);return m&&P[Ev]!==B&&gT(P,Ev,B,{}),_v[t]=B,y},zf=function(e,t){return{value:e,done:t}},tO=Ri,Lu=Ad,vT=Ld;mo.f;var nO=Tw,Sv=zf,Du="Array Iterator",ST=vT.set,yT=vT.getterFor(Du);nO(Array,"Array",function(e,t){ST(this,{type:Du,target:tO(e),index:0,kind:t})},function(){var e=yT(this),t=e.target,r=e.index++;if(!t||r>=t.length)return e.target=null,Sv(void 0,!0);switch(e.kind){case"keys":return Sv(r,!1);case"values":return Sv(t[r],!1)}return Sv([r,t[r]],!1)},"values"),Lu.Arguments=Lu.Array;var $m=mo,ga=function(e,t,r){return $m.f(e,t,r)},rO=Zi,mM=ga,iO=$e,eg=ea("species"),pp=Q,aO=TypeError,yv=function(e,t){if(pp(t,e))return e;throw new aO("Incorrect invocation")},Tv=We,ll=OE,TT=K(Function.toString);Tv(ll.inspectSource)||(ll.inspectSource=function(e){return TT(e)});var bT=ll.inspectSource,sO=K,tg=I,bv=We,mp=Pf,ng=bT,Pd=function(){},Da=Zi("Reflect","construct"),gp=/^\s*(?:class|function)\b/,oO=sO(gp.exec),Js=!gp.test(Pd),Cv=function(e){if(!bv(e))return!1;try{return Da(Pd,[],e),!0}catch{return!1}},CT=function(e){if(!bv(e))return!1;switch(mp(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return Js||!!oO(gp,ng(e))}catch{return!0}};CT.sham=!0;var Z0,qi,ic,dl,_p=!Da||tg(function(){var e;return Cv(Cv.call)||!Cv(Object)||!Cv(function(){e=!0})||e})?CT:Cv,cO=_p,$0=yu,wT=TypeError,_a=Ks,Md=function(e){if(cO(e))return e;throw new wT($0(e)+" is not a constructor")},lO=kt,Ac=ea("species"),RT=function(e,t){var r,s=_a(e).constructor;return s===void 0||lO(r=_a(s)[Ac])?t:Md(r)},xo=K([].slice),Ep=TypeError,Oc=function(e,t){if(e<t)throw new Ep("Not enough arguments");return e},wv=/(?:ipad|iphone|ipod).*applewebkit/i.test(Tr),ac=X,Pu=ue,dO=$a,Hf=We,rg=Ga,e_=I,Wf=M0,uO=xo,IT=DE,Rv=Oc,AT=wv,vp=Ds,Iv=ac.setImmediate,Av=ac.clearImmediate,bw=ac.process,Oi=ac.Dispatch,oa=ac.Function,Lr=ac.MessageChannel,ii=ac.String,Zr=0,ks={},kd="onreadystatechange";e_(function(){Z0=ac.location});var Mu=function(e){if(rg(ks,e)){var t=ks[e];delete ks[e],t()}},t_=function(e){return function(){Mu(e)}},xd=function(e){Mu(e.data)},Ha=function(e){ac.postMessage(ii(e),Z0.protocol+"//"+Z0.host)};Iv&&Av||(Iv=function(e){Rv(arguments.length,1);var t=Hf(e)?e:oa(e),r=uO(arguments,1);return ks[++Zr]=function(){Pu(t,void 0,r)},qi(Zr),Zr},Av=function(e){delete ks[e]},vp?qi=function(e){bw.nextTick(t_(e))}:Oi&&Oi.now?qi=function(e){Oi.now(t_(e))}:Lr&&!AT?(dl=(ic=new Lr).port2,ic.port1.onmessage=xd,qi=dO(dl.postMessage,dl)):ac.addEventListener&&Hf(ac.postMessage)&&!ac.importScripts&&Z0&&Z0.protocol!=="file:"&&!e_(Ha)?(qi=Ha,ac.addEventListener("message",xd,!1)):qi=kd in IT("script")?function(e){Wf.appendChild(IT("script"))[kd]=function(){Wf.removeChild(this),Mu(e)}}:function(e){setTimeout(t_(e),0)});var Ud={set:Iv,clear:Av},Nc=X,OT=$e,Wl=Object.getOwnPropertyDescriptor,Yf=function(e){if(!OT)return Nc[e];var t=Wl(Nc,e);return t&&t.value},n_=function(){this.head=null,this.tail=null};n_.prototype={add:function(e){var t={item:e,next:null},r=this.tail;r?r.next=t:this.head=t,this.tail=t},get:function(){var e=this.head;if(e)return(this.head=e.next)===null&&(this.tail=null),e.item}};var xs,Ov,Nv,Sp,r_,ku=n_,Xs=/ipad|iphone|ipod/i.test(Tr)&&typeof Pebble<"u",jd=/web0s(?!.*chrome)/i.test(Tr),Yl=X,yp=Yf,ig=$a,Tp=Ud.set,Cw=ku,xu=wv,Kf=Xs,Lc=jd,NT=Ds,Dc=Yl.MutationObserver||Yl.WebKitMutationObserver,ag=Yl.document,ww=Yl.process,LT=Yl.Promise,Uu=yp("queueMicrotask");if(!Uu){var sg=new Cw,i_=function(){var e,t;for(NT&&(e=ww.domain)&&e.exit();t=sg.get();)try{t()}catch(r){throw sg.head&&xs(),r}e&&e.enter()};xu||NT||Lc||!Dc||!ag?!Kf&&LT&&LT.resolve?((Sp=LT.resolve(void 0)).constructor=LT,r_=ig(Sp.then,Sp),xs=function(){r_(i_)}):NT?xs=function(){ww.nextTick(i_)}:(Tp=ig(Tp,Yl),xs=function(){Tp(i_)}):(Ov=!0,Nv=ag.createTextNode(""),new Dc(i_).observe(Nv,{characterData:!0}),xs=function(){Nv.data=Ov=!Ov}),Uu=function(e){sg.head||xs(),sg.add(e)}}var og=Uu,qf=function(e){try{return{error:!1,value:e()}}catch(t){return{error:!0,value:t}}},Jf=X.Promise,fO=X,bp=Jf,Rw=We,Lv=ME,ju=bT,hO=ea,Iw=Mm,DT=Fa,Xf=bp&&bp.prototype,Dv=hO("species"),Aw=Rw(fO.PromiseRejectionEvent),Pv=Lv("Promise",function(){var e=ju(bp),t=e!==String(bp);if(!t&&DT===66||!Xf.catch||!Xf.finally)return!0;if(!DT||DT<51||!/native code/.test(e)){var r=new bp(function(l){l(1)}),s=function(l){l(function(){},function(){})};if((r.constructor={})[Dv]=s,!(r.then(function(){})instanceof s))return!0}return!(t||Iw!=="BROWSER"&&Iw!=="DENO"||Aw)}),ul={CONSTRUCTOR:Pv,REJECTION_EVENT:Aw},sc={},Ow=os,pO=TypeError,PT=function(e){var t,r;this.promise=new e(function(s,l){if(t!==void 0||r!==void 0)throw new pO("Bad Promise constructor");t=s,r=l}),this.resolve=Ow(t),this.reject=Ow(r)};sc.f=function(e){return new PT(e)};var MT,Mv,ca=pr,a_=Ds,Cp=X,cg=qe,Nw=ys,gM=Dd,_M=function(e){var t=rO(e);iO&&t&&!t[eg]&&mM(t,eg,{configurable:!0,get:function(){return this}})},kT=os,Qf=We,kv=dr,xv=yv,xT=RT,Vd=Ud.set,fl=og,Uv=function(e,t){try{arguments.length===1?console.error(e):console.error(e,t)}catch{}},Lw=qf,mO=ku,Dw=Ld,wp=Jf,jv=ul,Pw=sc,Rp="Promise",Vv=jv.CONSTRUCTOR,UT=jv.REJECTION_EVENT,Mw=Dw.getterFor(Rp),kw=Dw.set,jT=wp&&wp.prototype,s_=wp,VT=jT,lg=Cp.TypeError,BT=Cp.document,FT=Cp.process,Pr=Pw.f,xw=Pr,Zf=!!(BT&&BT.createEvent&&Cp.dispatchEvent),$f="unhandledrejection",Bv=function(e){var t;return!(!kv(e)||!Qf(t=e.then))&&t},Fv=function(e,t){var r,s,l,f=t.value,m=t.state===1,E=m?e.ok:e.fail,y=e.resolve,b=e.reject,A=e.domain;try{E?(m||(t.rejection===2&&EM(t),t.rejection=1),E===!0?r=f:(A&&A.enter(),r=E(f),A&&(A.exit(),l=!0)),r===e.promise?b(new lg("Promise-chain cycle")):(s=Bv(r))?cg(s,r,y,b):y(r)):b(f)}catch(O){A&&!l&&A.exit(),b(O)}},dg=function(e,t){e.notified||(e.notified=!0,fl(function(){for(var r,s=e.reactions;r=s.get();)Fv(r,e);e.notified=!1,t&&!e.rejection&&ug(e)}))},Gv=function(e,t,r){var s,l;Zf?((s=BT.createEvent("Event")).promise=t,s.reason=r,s.initEvent(e,!1,!0),Cp.dispatchEvent(s)):s={promise:t,reason:r},!UT&&(l=Cp["on"+e])?l(s):e===$f&&Uv("Unhandled promise rejection",r)},ug=function(e){cg(Vd,Cp,function(){var t,r=e.facade,s=e.value;if(Uw(e)&&(t=Lw(function(){a_?FT.emit("unhandledRejection",s,r):Gv($f,r,s)}),e.rejection=a_||Uw(e)?2:1,t.error))throw t.value})},Uw=function(e){return e.rejection!==1&&!e.parent},EM=function(e){cg(Vd,Cp,function(){var t=e.facade;a_?FT.emit("rejectionHandled",t):Gv("rejectionhandled",t,e.value)})},eh=function(e,t,r){return function(s){e(t,s,r)}},fg=function(e,t,r){e.done||(e.done=!0,r&&(e=r),e.value=t,e.state=2,dg(e,!0))},GT=function(e,t,r){if(!e.done){e.done=!0,r&&(e=r);try{if(e.facade===t)throw new lg("Promise can't be resolved itself");var s=Bv(t);s?fl(function(){var l={done:!1};try{cg(s,t,eh(GT,l,e),eh(fg,l,e))}catch(f){fg(l,f,e)}}):(e.value=t,e.state=1,dg(e,!1))}catch(l){fg({done:!1},l,e)}}};Vv&&(VT=(s_=function(e){xv(this,VT),kT(e),cg(MT,this);var t=Mw(this);try{e(eh(GT,t),eh(fg,t))}catch(r){fg(t,r)}}).prototype,(MT=function(e){kw(this,{type:Rp,done:!1,notified:!1,parent:!1,reactions:new mO,rejection:!1,state:0,value:null})}).prototype=Nw(VT,"then",function(e,t){var r=Mw(this),s=Pr(xT(this,s_));return r.parent=!0,s.ok=!Qf(e)||e,s.fail=Qf(t)&&t,s.domain=a_?FT.domain:void 0,r.state===0?r.reactions.add(s):fl(function(){Fv(s,r)}),s.promise}),Mv=function(){var e=new MT,t=Mw(e);this.promise=e,this.resolve=eh(GT,t),this.reject=eh(fg,t)},Pw.f=Pr=function(e){return e===s_||e===void 0?new Mv(e):xw(e)}),ca({global:!0,wrap:!0,forced:Vv},{Promise:s_}),gM(s_,Rp,!1,!0),_M(Rp);var zv=ea("iterator"),Ji=!1;try{var jw=0,Qs={next:function(){return{done:!!jw++}},return:function(){Ji=!0}};Qs[zv]=function(){return this},Array.from(Qs,function(){throw 2})}catch{}var vM=Jf,Vw=function(e,t){try{if(!t&&!Ji)return!1}catch{return!1}var r=!1;try{var s={};s[zv]=function(){return{next:function(){return{done:r=!0}}}},e(s)}catch{}return r},o_=ul.CONSTRUCTOR||!Vw(function(e){vM.all(e).then(void 0,function(){})}),zT=qe,gO=os,_O=sc,Bw=qf,Fw=G0;pr({target:"Promise",stat:!0,forced:o_},{all:function(e){var t=this,r=_O.f(t),s=r.resolve,l=r.reject,f=Bw(function(){var m=gO(t.resolve),E=[],y=0,b=1;Fw(e,function(A){var O=y++,D=!1;b++,zT(m,t,A).then(function(P){D||(D=!0,E[O]=P,--b||s(E))},l)}),--b||s(E)});return f.error&&l(f.value),r.promise}});var SM=pr,EO=ul.CONSTRUCTOR;Jf&&Jf.prototype,SM({target:"Promise",proto:!0,forced:EO,real:!0},{catch:function(e){return this.then(void 0,e)}});var yM=qe,Gw=os,TM=sc,bM=qf,Ip=G0;pr({target:"Promise",stat:!0,forced:o_},{race:function(e){var t=this,r=TM.f(t),s=r.reject,l=bM(function(){var f=Gw(t.resolve);Ip(e,function(m){yM(f,t,m).then(r.resolve,s)})});return l.error&&s(l.value),r.promise}});var vO=sc;pr({target:"Promise",stat:!0,forced:ul.CONSTRUCTOR},{reject:function(e){var t=vO.f(this);return(0,t.reject)(e),t.promise}});var zw=Ks,CM=dr,wM=sc,HT=function(e,t){if(zw(e),CM(t)&&t.constructor===e)return t;var r=wM.f(e);return(0,r.resolve)(t),r.promise},RM=pr,Bd=Jf,Hw=ul.CONSTRUCTOR,SO=HT,yO=Zi("Promise"),Hv=!Hw;RM({target:"Promise",stat:!0,forced:!0},{resolve:function(e){return SO(Hv&&this===yO?Bd:this,e)}});var Kl=qe,TO=os,WT=sc,Vu=qf,IM=G0;pr({target:"Promise",stat:!0,forced:o_},{allSettled:function(e){var t=this,r=WT.f(t),s=r.resolve,l=r.reject,f=Vu(function(){var m=TO(t.resolve),E=[],y=0,b=1;IM(e,function(A){var O=y++,D=!1;b++,Kl(m,t,A).then(function(P){D||(D=!0,E[O]={status:"fulfilled",value:P},--b||s(E))},function(P){D||(D=!0,E[O]={status:"rejected",reason:P},--b||s(E))})}),--b||s(E)});return f.error&&l(f.value),r.promise}});var Ww=qe,c_=os,bO=Zi,AM=sc,OM=qf,CO=G0,wO="No one promise resolved";pr({target:"Promise",stat:!0,forced:o_},{any:function(e){var t=this,r=bO("AggregateError"),s=AM.f(t),l=s.resolve,f=s.reject,m=OM(function(){var E=c_(t.resolve),y=[],b=0,A=1,O=!1;CO(e,function(D){var P=b++,F=!1;A++,Ww(E,t,D).then(function(B){F||O||(O=!0,l(B))},function(B){F||O||(F=!0,y[P]=B,--A||f(new r(y,wO)))})}),--A||f(new r(y,wO))});return m.error&&f(m.value),s.promise}});var Yw=pr,NM=ue,LM=xo,RO=sc,l_=os,hg=qf,YT=X.Promise,Kw=!1;Yw({target:"Promise",stat:!0,forced:!YT||!YT.try||hg(function(){YT.try(function(e){Kw=e===8},8)}).error||!Kw},{try:function(e){var t=arguments.length>1?LM(arguments,1):[],r=RO.f(this),s=hg(function(){return NM(l_(e),void 0,t)});return(s.error?r.reject:r.resolve)(s.value),r.promise}});var Ap=sc;pr({target:"Promise",stat:!0},{withResolvers:function(){var e=Ap.f(this);return{promise:e.promise,resolve:e.resolve,reject:e.reject}}});var Wv=pr,KT=Jf,Yv=I,qw=Zi,qT=We,Kv=RT,Jw=HT,IO=KT&&KT.prototype;Wv({target:"Promise",proto:!0,real:!0,forced:!!KT&&Yv(function(){IO.finally.call({then:function(){}},function(){})})},{finally:function(e){var t=Kv(this,qw("Promise")),r=qT(e);return this.then(r?function(s){return Jw(t,e()).then(function(){return s})}:e,r?function(s){return Jw(t,e()).then(function(){throw s})}:e)}});var Xw=K,AO=Nm,qv=Ls,DM=tn,PM=Xw("".charAt),Qw=Xw("".charCodeAt),Jv=Xw("".slice),pg=function(e){return function(t,r){var s,l,f=qv(DM(t)),m=AO(r),E=f.length;return m<0||m>=E?e?"":void 0:(s=Qw(f,m))<55296||s>56319||m+1===E||(l=Qw(f,m+1))<56320||l>57343?e?PM(f,m):s:e?Jv(f,m,m+2):l-56320+(s-55296<<10)+65536}},d_={codeAt:pg(!1),charAt:pg(!0)},Zw=d_.charAt,u_=Ls,Et=Ld,OO=Tw,$w=zf,eR="String Iterator",NO=Et.set,tR=Et.getterFor(eR);OO(String,"String",function(e){NO(this,{type:eR,string:u_(e),index:0})},function(){var e,t=tR(this),r=t.string,s=t.index;return s>=r.length?$w(void 0,!0):(e=Zw(r,s),t.index+=e.length,$w(e,!1))});var JT=Ii.Promise,XT={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},MM=X,Pc=Dd,QT=Ad;for(var Xv in XT)Pc(MM[Xv],Xv),QT[Xv]=QT.Array;var mg=JT,gt=T(mg),LO=il("Array","values"),nR=Pf,Op=Ga,Fd=Q,th=LO,gg=Array.prototype,Qv={DOMTokenList:!0,NodeList:!0},Np=function(e){var t=e.values;return e===gg||Fd(gg,e)&&t===gg.values||Op(Qv,nR(e))?th:t},oc=T(Np),Zv=yu,f_=TypeError,DO=xo,ZT=Math.floor,h_=function(e,t){var r=e.length;if(r<8)for(var s,l,f=1;f<r;){for(l=f,s=e[f];l&&t(e[l-1],s)>0;)e[l]=e[--l];l!==f++&&(e[l]=s)}else for(var m=ZT(r/2),E=h_(DO(e,0,m),t),y=h_(DO(e,m),t),b=E.length,A=y.length,O=0,D=0;O<b||D<A;)e[O+D]=O<b&&D<A?t(E[O],y[D])<=0?E[O++]:y[D++]:O<b?E[O++]:y[D++];return e},rR=h_,iR=Tr.match(/firefox\/(\d+)/i),p_=!!iR&&+iR[1],nh=/MSIE|Trident/.test(Tr),m_=Tr.match(/AppleWebKit\/(\d+)\./),Mc=!!m_&&+m_[1],Lp=pr,g_=K,aR=os,kM=bd,$v=Yh,p=function(e,t){if(!delete e[t])throw new f_("Cannot delete property "+Zv(t)+" of "+Zv(e))},v=Ls,w=I,L=rR,U=Pm,H=p_,pe=nh,Ce=Fa,Fe=Mc,it=[],pt=g_(it.sort),xt=g_(it.push),ct=w(function(){it.sort(void 0)}),dt=w(function(){it.sort(null)}),tr=U("sort"),wn=!w(function(){if(Ce)return Ce<70;if(!(H&&H>3)){if(pe)return!0;if(Fe)return Fe<603;var e,t,r,s,l="";for(e=65;e<76;e++){switch(t=String.fromCharCode(e),e){case 66:case 69:case 70:case 72:r=3;break;case 68:case 71:r=4;break;default:r=2}for(s=0;s<47;s++)it.push({k:t+s,v:r})}for(it.sort(function(f,m){return m.v-f.v}),s=0;s<it.length;s++)t=it[s].k.charAt(0),l.charAt(l.length-1)!==t&&(l+=t);return l!=="DGBEFHACIJK"}});Lp({target:"Array",proto:!0,forced:ct||!dt||!tr||!wn},{sort:function(e){e!==void 0&&aR(e);var t=kM(this);if(wn)return e===void 0?pt(t):pt(t,e);var r,s,l=[],f=$v(t);for(s=0;s<f;s++)s in t&&xt(l,t[s]);for(L(l,function(m){return function(E,y){return y===void 0?-1:E===void 0?1:m!==void 0?+m(E,y)||0:v(E)>v(y)?1:-1}}(e)),r=$v(l),s=0;s<r;)t[s]=l[s++];for(;s<f;)p(t,s++);return t}});var ta=il("Array","sort"),nt=Q,Je=ta,st=Array.prototype,Nt=function(e){var t=e.sort;return e===st||nt(st,e)&&t===st.sort?Je:t},sn=T(Nt),Gr=pr,Rn=K,Vn=xy,Us=RangeError,$r=String.fromCharCode,hl=String.fromCodePoint,sR=Rn([].join);Gr({target:"String",stat:!0,forced:!!hl&&hl.length!==1},{fromCodePoint:function(e){for(var t,r=[],s=arguments.length,l=0;s>l;){if(t=+arguments[l++],Vn(t,1114111)!==t)throw new Us(t+" is not a valid code point");r[l]=t<65536?$r(t):$r(55296+((t-=65536)>>10),t%1024+56320)}return sR(r,"")}});var iV=I,Rz=ea("iterator"),PO=!iV(function(){var e=new URL("b?a=1&b=2&c=3","https://a"),t=e.searchParams,r=new URLSearchParams("a=1&a=2&b=3"),s="";return e.pathname="c%20d",t.forEach(function(l,f){t.delete("b"),s+=f+l}),r.delete("a",2),r.delete("b",void 0),!e.toJSON||!r.has("a",1)||r.has("a",2)||!r.has("a",void 0)||r.has("b")||!t.size&&!0||!t.sort||e.href!=="https://a/c%20d?a=1&c=3"||t.get("c")!=="3"||String(new URLSearchParams("?a=1"))!=="a=1"||!t[Rz]||new URL("https://a@b").username!=="a"||new URLSearchParams(new URLSearchParams("a=b")).get("a")!=="b"||new URL("https://").host!=="xn--e1aybc"||new URL("https://a#").hash!=="#%D0%B1"||s!=="a1c3"||new URL("https://x",void 0).host!=="x"}),aV=ys,xM=pr,sV=X,MO=Yf,eS=Zi,$T=qe,rh=K,eb=$e,UM=PO,oV=ys,Iz=ga,cV=function(e,t,r){for(var s in t)r&&r.unsafe&&e[s]?e[s]=t[s]:aV(e,s,t[s],r);return e},Az=Dd,Oz=pT,kO=Ld,lV=yv,jM=We,Nz=Ga,dV=$a,VM=Pf,uV=Ks,oR=dr,Zs=Ls,Lz=zm,fV=Pt,BM=tv,FM=j0,pl=zf,tb=Oc,Dz=rR,hV=ea("iterator"),nb="URLSearchParams",pV=nb+"Iterator",mV=kO.set,ql=kO.getterFor(nb),Pz=kO.getterFor(pV),gV=MO("fetch"),xO=MO("Request"),cR=MO("Headers"),__=xO&&xO.prototype,GM=cR&&cR.prototype,Mz=sV.TypeError,kz=sV.encodeURIComponent,xz=String.fromCharCode,Uz=eS("String","fromCodePoint"),jz=parseInt,UO=rh("".charAt),_V=rh([].join),E_=rh([].push),EV=rh("".replace),Vz=rh([].shift),vV=rh([].splice),zM=rh("".split),SV=rh("".slice),Bz=rh(/./.exec),yV=/\+/g,tS=/^[0-9a-f]+$/i,jO=function(e,t){var r=SV(e,t,t+2);return Bz(tS,r)?jz(r,16):NaN},Fz=function(e){for(var t=0,r=128;r>0&&(e&r)!=0;r>>=1)t++;return t},TV=function(e){var t=null;switch(e.length){case 1:t=e[0];break;case 2:t=(31&e[0])<<6|63&e[1];break;case 3:t=(15&e[0])<<12|(63&e[1])<<6|63&e[2];break;case 4:t=(7&e[0])<<18|(63&e[1])<<12|(63&e[2])<<6|63&e[3]}return t>1114111?null:t},HM=function(e){for(var t=(e=EV(e,yV," ")).length,r="",s=0;s<t;){var l=UO(e,s);if(l==="%"){if(UO(e,s+1)==="%"||s+3>t){r+="%",s++;continue}var f=jO(e,s+1);if(f!=f){r+=l,s++;continue}s+=2;var m=Fz(f);if(m===0)l=xz(f);else{if(m===1||m>4){r+="",s++;continue}for(var E=[f],y=1;y<m&&!(++s+3>t||UO(e,s)!=="%");){var b=jO(e,s+1);if(b!=b){s+=3;break}if(b>191||b<128)break;E_(E,b),s+=2,y++}if(E.length!==m){r+="";continue}var A=TV(E);A===null?r+="":l=Uz(A)}}r+=l,s++}return r},bV=/[!'()~]|%20/g,Gz={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},rb=function(e){return Gz[e]},VO=function(e){return EV(kz(e),bV,rb)},BO=Oz(function(e,t){mV(this,{type:pV,target:ql(e).entries,index:0,kind:t})},nb,function(){var e=Pz(this),t=e.target,r=e.index++;if(!t||r>=t.length)return e.target=null,pl(void 0,!0);var s=t[r];switch(e.kind){case"keys":return pl(s.key,!1);case"values":return pl(s.value,!1)}return pl([s.key,s.value],!1)},!0),WM=function(e){this.entries=[],this.url=null,e!==void 0&&(oR(e)?this.parseObject(e):this.parseQuery(typeof e=="string"?UO(e,0)==="?"?SV(e,1):e:Zs(e)))};WM.prototype={type:nb,bindURL:function(e){this.url=e,this.update()},parseObject:function(e){var t,r,s,l,f,m,E,y=this.entries,b=FM(e);if(b)for(r=(t=BM(e,b)).next;!(s=$T(r,t)).done;){if(f=(l=BM(uV(s.value))).next,(m=$T(f,l)).done||(E=$T(f,l)).done||!$T(f,l).done)throw new Mz("Expected sequence with length 2");E_(y,{key:Zs(m.value),value:Zs(E.value)})}else for(var A in e)Nz(e,A)&&E_(y,{key:A,value:Zs(e[A])})},parseQuery:function(e){if(e)for(var t,r,s=this.entries,l=zM(e,"&"),f=0;f<l.length;)(t=l[f++]).length&&(r=zM(t,"="),E_(s,{key:HM(Vz(r)),value:HM(_V(r,"="))}))},serialize:function(){for(var e,t=this.entries,r=[],s=0;s<t.length;)e=t[s++],E_(r,VO(e.key)+"="+VO(e.value));return _V(r,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var ih=function(){lV(this,ib);var e=mV(this,new WM(arguments.length>0?arguments[0]:void 0));eb||(this.size=e.entries.length)},ib=ih.prototype;if(cV(ib,{append:function(e,t){var r=ql(this);tb(arguments.length,2),E_(r.entries,{key:Zs(e),value:Zs(t)}),eb||this.length++,r.updateURL()},delete:function(e){for(var t=ql(this),r=tb(arguments.length,1),s=t.entries,l=Zs(e),f=r<2?void 0:arguments[1],m=f===void 0?f:Zs(f),E=0;E<s.length;){var y=s[E];if(y.key!==l||m!==void 0&&y.value!==m)E++;else if(vV(s,E,1),m!==void 0)break}eb||(this.size=s.length),t.updateURL()},get:function(e){var t=ql(this).entries;tb(arguments.length,1);for(var r=Zs(e),s=0;s<t.length;s++)if(t[s].key===r)return t[s].value;return null},getAll:function(e){var t=ql(this).entries;tb(arguments.length,1);for(var r=Zs(e),s=[],l=0;l<t.length;l++)t[l].key===r&&E_(s,t[l].value);return s},has:function(e){for(var t=ql(this).entries,r=tb(arguments.length,1),s=Zs(e),l=r<2?void 0:arguments[1],f=l===void 0?l:Zs(l),m=0;m<t.length;){var E=t[m++];if(E.key===s&&(f===void 0||E.value===f))return!0}return!1},set:function(e,t){var r=ql(this);tb(arguments.length,1);for(var s,l=r.entries,f=!1,m=Zs(e),E=Zs(t),y=0;y<l.length;y++)(s=l[y]).key===m&&(f?vV(l,y--,1):(f=!0,s.value=E));f||E_(l,{key:m,value:E}),eb||(this.size=l.length),r.updateURL()},sort:function(){var e=ql(this);Dz(e.entries,function(t,r){return t.key>r.key?1:-1}),e.updateURL()},forEach:function(e){for(var t,r=ql(this).entries,s=dV(e,arguments.length>1?arguments[1]:void 0),l=0;l<r.length;)s((t=r[l++]).value,t.key,this)},keys:function(){return new BO(this,"keys")},values:function(){return new BO(this,"values")},entries:function(){return new BO(this,"entries")}},{enumerable:!0}),oV(ib,hV,ib.entries,{}),oV(ib,"toString",function(){return ql(this).serialize()},{enumerable:!0}),eb&&Iz(ib,"size",{get:function(){return ql(this).entries.length},configurable:!0,enumerable:!0}),Az(ih,nb),xM({global:!0,forced:!UM},{URLSearchParams:ih}),!UM&&jM(cR)){var zz=rh(GM.has),Hz=rh(GM.set),YM=function(e){if(oR(e)){var t,r=e.body;if(VM(r)===nb)return t=e.headers?new cR(e.headers):new cR,zz(t,"content-type")||Hz(t,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),Lz(e,{body:fV(0,Zs(r)),headers:fV(0,t)})}return e};if(jM(gV)&&xM({global:!0,dontCallGetSet:!0,forced:!0},{fetch:function(e){return gV(e,arguments.length>1?YM(arguments[1]):{})}}),jM(xO)){var KM=function(e){return lV(this,__),new xO(e,arguments.length>1?YM(arguments[1]):{})};__.constructor=KM,KM.prototype=__,xM({global:!0,dontCallGetSet:!0,forced:!0},{Request:KM})}}var Bu,Wz={URLSearchParams:ih,getState:ql},qM=Ii.URLSearchParams,CV=$e,JM=K,wV=qe,Fu=I,ab=P0,Gu=Bm,Yz=lt,XM=bd,QM=ir,ah=Object.assign,zu=Object.defineProperty,Kz=JM([].concat),qz=!ah||Fu(function(){if(CV&&ah({b:1},ah(zu({},"a",{enumerable:!0,get:function(){zu(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var e={},t={},r=Symbol("assign detection"),s="abcdefghijklmnopqrst";return e[r]=7,s.split("").forEach(function(l){t[l]=l}),ah({},e)[r]!==7||ab(ah({},t)).join("")!==s})?function(e,t){for(var r=XM(e),s=arguments.length,l=1,f=Gu.f,m=Yz.f;s>l;)for(var E,y=QM(arguments[l++]),b=f?Kz(ab(y),f(y)):ab(y),A=b.length,O=0;A>O;)E=b[O++],CV&&!wV(m,y,E)||(r[E]=y[E]);return r}:ah,_g=Ks,Jz=sT,Xz=$e,RV=mo,IV=Pt,ZM=function(e,t,r){Xz?RV.f(e,t,IV(0,r)):e[t]=r},FO=$a,Qz=qe,Zz=bd,lR=function(e,t,r,s){try{return s?t(_g(r)[0],r[1]):t(r)}catch(l){Jz(e,"throw",l)}},$M=U2,GO=_p,$z=Yh,ek=ZM,Hu=tv,sh=j0,sb=Array,nS=K,tk=2147483647,ob=/[^\0-\u007E]/,zO=/[.\u3002\uFF0E\uFF61]/g,AV="Overflow: input needs wider integers to process",OV=RangeError,dR=nS(zO.exec),Eg=Math.floor,nk=String.fromCharCode,HO=nS("".charCodeAt),cb=nS([].join),vg=nS([].push),NV=nS("".replace),eH=nS("".split),rk=nS("".toLowerCase),LV=function(e){return e+22+75*(e<26)},tH=function(e,t,r){var s=0;for(e=r?Eg(e/700):e>>1,e+=Eg(e/t);e>455;)e=Eg(e/35),s+=36;return Eg(s+36*e/(e+38))},nH=function(e){var t=[];e=function($){for(var ee=[],Ee=0,Re=$.length;Ee<Re;){var Ie=HO($,Ee++);if(Ie>=55296&&Ie<=56319&&Ee<Re){var we=HO($,Ee++);(64512&we)==56320?vg(ee,((1023&Ie)<<10)+(1023&we)+65536):(vg(ee,Ie),Ee--)}else vg(ee,Ie)}return ee}(e);var r,s,l=e.length,f=128,m=0,E=72;for(r=0;r<e.length;r++)(s=e[r])<128&&vg(t,nk(s));var y=t.length,b=y;for(y&&vg(t,"-");b<l;){var A=tk;for(r=0;r<e.length;r++)(s=e[r])>=f&&s<A&&(A=s);var O=b+1;if(A-f>Eg((tk-m)/O))throw new OV(AV);for(m+=(A-f)*O,f=A,r=0;r<e.length;r++){if((s=e[r])<f&&++m>tk)throw new OV(AV);if(s===f){for(var D=m,P=36;;){var F=P<=E?1:P>=E+26?26:P-E;if(D<F)break;var B=D-F,Y=36-F;vg(t,nk(LV(F+B%Y))),D=Eg(B/Y),P+=36}vg(t,nk(LV(D))),E=tH(m,O,b===y),m=0,b++}}m++,f++}return cb(t,"")},DV=pr,ik=$e,rH=PO,ak=X,PV=$a,Wu=K,v_=ys,ml=ga,MV=yv,WO=Ga,uR=qz,Gd=function(e){var t=Zz(e),r=GO(this),s=arguments.length,l=s>1?arguments[1]:void 0,f=l!==void 0;f&&(l=FO(l,s>2?arguments[2]:void 0));var m,E,y,b,A,O,D=sh(t),P=0;if(!D||this===sb&&$M(D))for(m=$z(t),E=r?new this(m):sb(m);m>P;P++)O=f?l(t[P],P):t[P],ek(E,P,O);else for(E=r?new this:[],A=(b=Hu(t,D)).next;!(y=Qz(A,b)).done;P++)O=f?lR(b,l,[y.value,P],!0):y.value,ek(E,P,O);return E.length=P,E},Jl=xo,fR=d_.codeAt,kV=function(e){var t,r,s=[],l=eH(NV(rk(e),zO,"."),".");for(t=0;t<l.length;t++)r=l[t],vg(s,dR(ob,r)?"xn--"+nH(r):r);return cb(s,".")},Sg=Ls,sk=Dd,xV=Oc,YO=Wz,ok=Ld,UV=ok.set,lb=ok.getterFor("URL"),jV=YO.URLSearchParams,VV=YO.getState,S_=ak.URL,db=ak.TypeError,ub=ak.parseInt,ck=Math.floor,KO=Math.pow,Xl=Wu("".charAt),Yu=Wu(/./.exec),rS=Wu([].join),fb=Wu(1 .toString),Dp=Wu([].pop),iS=Wu([].push),yg=Wu("".replace),Tg=Wu([].shift),lk=Wu("".split),Pp=Wu("".slice),Uo=Wu("".toLowerCase),Ku=Wu([].unshift),qO="Invalid scheme",y_="Invalid host",BV="Invalid port",FV=/[a-z]/i,iH=/[\d+-.a-z]/i,JO=/\d/,aH=/^0x/i,GV=/^[0-7]+$/,XO=/^\d+$/,dk=/^[\da-f]+$/i,zV=/[\0\t\n\r #%/:<>?@[\\\]^|]/,QO=/[\0\t\n\r #/:<>?@[\\\]^|]/,aS=/^[\u0000-\u0020]+/,sH=/(^|[^\u0000-\u0020])[\u0000-\u0020]+$/,oH=/[\t\n\r]/g,hb=function(e){var t,r,s,l;if(typeof e=="number"){for(t=[],r=0;r<4;r++)Ku(t,e%256),e=ck(e/256);return rS(t,".")}if(typeof e=="object"){for(t="",s=function(f){for(var m=null,E=1,y=null,b=0,A=0;A<8;A++)f[A]!==0?(b>E&&(m=y,E=b),y=null,b=0):(y===null&&(y=A),++b);return b>E?y:m}(e),r=0;r<8;r++)l&&e[r]===0||(l&&(l=!1),s===r?(t+=r?":":"::",l=!0):(t+=fb(e[r],16),r<7&&(t+=":")));return"["+t+"]"}return e},pb={},uk=uR({},pb,{" ":1,'"':1,"<":1,">":1,"`":1}),fk=uR({},uk,{"#":1,"?":1,"{":1,"}":1}),hR=uR({},fk,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),bg=function(e,t){var r=fR(e,0);return r>32&&r<127&&!WO(t,e)?e:encodeURIComponent(e)},pR={ftp:21,file:null,http:80,https:443,ws:80,wss:443},mb=function(e,t){var r;return e.length===2&&Yu(FV,Xl(e,0))&&((r=Xl(e,1))===":"||!t&&r==="|")},hk=function(e){var t;return e.length>1&&mb(Pp(e,0,2))&&(e.length===2||(t=Xl(e,2))==="/"||t==="\\"||t==="?"||t==="#")},HV=function(e){return e==="."||Uo(e)==="%2e"},ZO={},pk={},$O={},mk={},gk={},mR={},_k={},Ek={},gR={},_R={},ER={},eN={},tN={},nN={},vk={},rN={},sS={},oh={},Sk={},T_={},Mp={},iN=function(e,t,r){var s,l,f,m=Sg(e);if(t){if(l=this.parse(m))throw new db(l);this.searchParams=null}else{if(r!==void 0&&(s=new iN(r,!0)),l=this.parse(m,null,s))throw new db(l);(f=VV(new jV)).bindURL(this),this.searchParams=f}};iN.prototype={type:"URL",parse:function(e,t,r){var s,l,f,m,E,y=this,b=t||ZO,A=0,O="",D=!1,P=!1,F=!1;for(e=Sg(e),t||(y.scheme="",y.username="",y.password="",y.host=null,y.port=null,y.path=[],y.query=null,y.fragment=null,y.cannotBeABaseURL=!1,e=yg(e,aS,""),e=yg(e,sH,"$1")),e=yg(e,oH,""),s=Gd(e);A<=s.length;){switch(l=s[A],b){case ZO:if(!l||!Yu(FV,l)){if(t)return qO;b=$O;continue}O+=Uo(l),b=pk;break;case pk:if(l&&(Yu(iH,l)||l==="+"||l==="-"||l==="."))O+=Uo(l);else{if(l!==":"){if(t)return qO;O="",b=$O,A=0;continue}if(t&&(y.isSpecial()!==WO(pR,O)||O==="file"&&(y.includesCredentials()||y.port!==null)||y.scheme==="file"&&!y.host))return;if(y.scheme=O,t)return void(y.isSpecial()&&pR[y.scheme]===y.port&&(y.port=null));O="",y.scheme==="file"?b=nN:y.isSpecial()&&r&&r.scheme===y.scheme?b=mk:y.isSpecial()?b=Ek:s[A+1]==="/"?(b=gk,A++):(y.cannotBeABaseURL=!0,iS(y.path,""),b=Sk)}break;case $O:if(!r||r.cannotBeABaseURL&&l!=="#")return qO;if(r.cannotBeABaseURL&&l==="#"){y.scheme=r.scheme,y.path=Jl(r.path),y.query=r.query,y.fragment="",y.cannotBeABaseURL=!0,b=Mp;break}b=r.scheme==="file"?nN:mR;continue;case mk:if(l!=="/"||s[A+1]!=="/"){b=mR;continue}b=gR,A++;break;case gk:if(l==="/"){b=_R;break}b=oh;continue;case mR:if(y.scheme=r.scheme,l===Bu)y.username=r.username,y.password=r.password,y.host=r.host,y.port=r.port,y.path=Jl(r.path),y.query=r.query;else if(l==="/"||l==="\\"&&y.isSpecial())b=_k;else if(l==="?")y.username=r.username,y.password=r.password,y.host=r.host,y.port=r.port,y.path=Jl(r.path),y.query="",b=T_;else{if(l!=="#"){y.username=r.username,y.password=r.password,y.host=r.host,y.port=r.port,y.path=Jl(r.path),y.path.length--,b=oh;continue}y.username=r.username,y.password=r.password,y.host=r.host,y.port=r.port,y.path=Jl(r.path),y.query=r.query,y.fragment="",b=Mp}break;case _k:if(!y.isSpecial()||l!=="/"&&l!=="\\"){if(l!=="/"){y.username=r.username,y.password=r.password,y.host=r.host,y.port=r.port,b=oh;continue}b=_R}else b=gR;break;case Ek:if(b=gR,l!=="/"||Xl(O,A+1)!=="/")continue;A++;break;case gR:if(l!=="/"&&l!=="\\"){b=_R;continue}break;case _R:if(l==="@"){D&&(O="%40"+O),D=!0,f=Gd(O);for(var B=0;B<f.length;B++){var Y=f[B];if(Y!==":"||F){var $=bg(Y,hR);F?y.password+=$:y.username+=$}else F=!0}O=""}else if(l===Bu||l==="/"||l==="?"||l==="#"||l==="\\"&&y.isSpecial()){if(D&&O==="")return"Invalid authority";A-=Gd(O).length+1,O="",b=ER}else O+=l;break;case ER:case eN:if(t&&y.scheme==="file"){b=rN;continue}if(l!==":"||P){if(l===Bu||l==="/"||l==="?"||l==="#"||l==="\\"&&y.isSpecial()){if(y.isSpecial()&&O==="")return y_;if(t&&O===""&&(y.includesCredentials()||y.port!==null))return;if(m=y.parseHost(O))return m;if(O="",b=sS,t)return;continue}l==="["?P=!0:l==="]"&&(P=!1),O+=l}else{if(O==="")return y_;if(m=y.parseHost(O))return m;if(O="",b=tN,t===eN)return}break;case tN:if(!Yu(JO,l)){if(l===Bu||l==="/"||l==="?"||l==="#"||l==="\\"&&y.isSpecial()||t){if(O!==""){var ee=ub(O,10);if(ee>65535)return BV;y.port=y.isSpecial()&&ee===pR[y.scheme]?null:ee,O=""}if(t)return;b=sS;continue}return BV}O+=l;break;case nN:if(y.scheme="file",l==="/"||l==="\\")b=vk;else{if(!r||r.scheme!=="file"){b=oh;continue}switch(l){case Bu:y.host=r.host,y.path=Jl(r.path),y.query=r.query;break;case"?":y.host=r.host,y.path=Jl(r.path),y.query="",b=T_;break;case"#":y.host=r.host,y.path=Jl(r.path),y.query=r.query,y.fragment="",b=Mp;break;default:hk(rS(Jl(s,A),""))||(y.host=r.host,y.path=Jl(r.path),y.shortenPath()),b=oh;continue}}break;case vk:if(l==="/"||l==="\\"){b=rN;break}r&&r.scheme==="file"&&!hk(rS(Jl(s,A),""))&&(mb(r.path[0],!0)?iS(y.path,r.path[0]):y.host=r.host),b=oh;continue;case rN:if(l===Bu||l==="/"||l==="\\"||l==="?"||l==="#"){if(!t&&mb(O))b=oh;else if(O===""){if(y.host="",t)return;b=sS}else{if(m=y.parseHost(O))return m;if(y.host==="localhost"&&(y.host=""),t)return;O="",b=sS}continue}O+=l;break;case sS:if(y.isSpecial()){if(b=oh,l!=="/"&&l!=="\\")continue}else if(t||l!=="?")if(t||l!=="#"){if(l!==Bu&&(b=oh,l!=="/"))continue}else y.fragment="",b=Mp;else y.query="",b=T_;break;case oh:if(l===Bu||l==="/"||l==="\\"&&y.isSpecial()||!t&&(l==="?"||l==="#")){if((E=Uo(E=O))===".."||E==="%2e."||E===".%2e"||E==="%2e%2e"?(y.shortenPath(),l==="/"||l==="\\"&&y.isSpecial()||iS(y.path,"")):HV(O)?l==="/"||l==="\\"&&y.isSpecial()||iS(y.path,""):(y.scheme==="file"&&!y.path.length&&mb(O)&&(y.host&&(y.host=""),O=Xl(O,0)+":"),iS(y.path,O)),O="",y.scheme==="file"&&(l===Bu||l==="?"||l==="#"))for(;y.path.length>1&&y.path[0]==="";)Tg(y.path);l==="?"?(y.query="",b=T_):l==="#"&&(y.fragment="",b=Mp)}else O+=bg(l,fk);break;case Sk:l==="?"?(y.query="",b=T_):l==="#"?(y.fragment="",b=Mp):l!==Bu&&(y.path[0]+=bg(l,pb));break;case T_:t||l!=="#"?l!==Bu&&(l==="'"&&y.isSpecial()?y.query+="%27":y.query+=l==="#"?"%23":bg(l,pb)):(y.fragment="",b=Mp);break;case Mp:l!==Bu&&(y.fragment+=bg(l,uk))}A++}},parseHost:function(e){var t,r,s;if(Xl(e,0)==="["){if(Xl(e,e.length-1)!=="]"||(t=function(l){var f,m,E,y,b,A,O,D=[0,0,0,0,0,0,0,0],P=0,F=null,B=0,Y=function(){return Xl(l,B)};if(Y()===":"){if(Xl(l,1)!==":")return;B+=2,F=++P}for(;Y();){if(P===8)return;if(Y()!==":"){for(f=m=0;m<4&&Yu(dk,Y());)f=16*f+ub(Y(),16),B++,m++;if(Y()==="."){if(m===0||(B-=m,P>6))return;for(E=0;Y();){if(y=null,E>0){if(!(Y()==="."&&E<4))return;B++}if(!Yu(JO,Y()))return;for(;Yu(JO,Y());){if(b=ub(Y(),10),y===null)y=b;else{if(y===0)return;y=10*y+b}if(y>255)return;B++}D[P]=256*D[P]+y,++E!=2&&E!==4||P++}if(E!==4)return;break}if(Y()===":"){if(B++,!Y())return}else if(Y())return;D[P++]=f}else{if(F!==null)return;B++,F=++P}}if(F!==null)for(A=P-F,P=7;P!==0&&A>0;)O=D[P],D[P--]=D[F+A-1],D[F+--A]=O;else if(P!==8)return;return D}(Pp(e,1,-1)),!t))return y_;this.host=t}else if(this.isSpecial()){if(e=kV(e),Yu(zV,e)||(t=function(l){var f,m,E,y,b,A,O,D=lk(l,".");if(D.length&&D[D.length-1]===""&&D.length--,(f=D.length)>4)return l;for(m=[],E=0;E<f;E++){if((y=D[E])==="")return l;if(b=10,y.length>1&&Xl(y,0)==="0"&&(b=Yu(aH,y)?16:8,y=Pp(y,b===8?1:2)),y==="")A=0;else{if(!Yu(b===10?XO:b===8?GV:dk,y))return l;A=ub(y,b)}iS(m,A)}for(E=0;E<f;E++)if(A=m[E],E===f-1){if(A>=KO(256,5-f))return null}else if(A>255)return null;for(O=Dp(m),E=0;E<m.length;E++)O+=m[E]*KO(256,3-E);return O}(e),t===null))return y_;this.host=t}else{if(Yu(QO,e))return y_;for(t="",r=Gd(e),s=0;s<r.length;s++)t+=bg(r[s],pb);this.host=t}},cannotHaveUsernamePasswordPort:function(){return!this.host||this.cannotBeABaseURL||this.scheme==="file"},includesCredentials:function(){return this.username!==""||this.password!==""},isSpecial:function(){return WO(pR,this.scheme)},shortenPath:function(){var e=this.path,t=e.length;!t||this.scheme==="file"&&t===1&&mb(e[0],!0)||e.length--},serialize:function(){var e=this,t=e.scheme,r=e.username,s=e.password,l=e.host,f=e.port,m=e.path,E=e.query,y=e.fragment,b=t+":";return l!==null?(b+="//",e.includesCredentials()&&(b+=r+(s?":"+s:"")+"@"),b+=hb(l),f!==null&&(b+=":"+f)):t==="file"&&(b+="//"),b+=e.cannotBeABaseURL?m[0]:m.length?"/"+rS(m,"/"):"",E!==null&&(b+="?"+E),y!==null&&(b+="#"+y),b},setHref:function(e){var t=this.parse(e);if(t)throw new db(t);this.searchParams.update()},getOrigin:function(){var e=this.scheme,t=this.port;if(e==="blob")try{return new oS(e.path[0]).origin}catch{return"null"}return e!=="file"&&this.isSpecial()?e+"://"+hb(this.host)+(t!==null?":"+t:""):"null"},getProtocol:function(){return this.scheme+":"},setProtocol:function(e){this.parse(Sg(e)+":",ZO)},getUsername:function(){return this.username},setUsername:function(e){var t=Gd(Sg(e));if(!this.cannotHaveUsernamePasswordPort()){this.username="";for(var r=0;r<t.length;r++)this.username+=bg(t[r],hR)}},getPassword:function(){return this.password},setPassword:function(e){var t=Gd(Sg(e));if(!this.cannotHaveUsernamePasswordPort()){this.password="";for(var r=0;r<t.length;r++)this.password+=bg(t[r],hR)}},getHost:function(){var e=this.host,t=this.port;return e===null?"":t===null?hb(e):hb(e)+":"+t},setHost:function(e){this.cannotBeABaseURL||this.parse(e,ER)},getHostname:function(){var e=this.host;return e===null?"":hb(e)},setHostname:function(e){this.cannotBeABaseURL||this.parse(e,eN)},getPort:function(){var e=this.port;return e===null?"":Sg(e)},setPort:function(e){this.cannotHaveUsernamePasswordPort()||((e=Sg(e))===""?this.port=null:this.parse(e,tN))},getPathname:function(){var e=this.path;return this.cannotBeABaseURL?e[0]:e.length?"/"+rS(e,"/"):""},setPathname:function(e){this.cannotBeABaseURL||(this.path=[],this.parse(e,sS))},getSearch:function(){var e=this.query;return e?"?"+e:""},setSearch:function(e){(e=Sg(e))===""?this.query=null:(Xl(e,0)==="?"&&(e=Pp(e,1)),this.query="",this.parse(e,T_)),this.searchParams.update()},getSearchParams:function(){return this.searchParams.facade},getHash:function(){var e=this.fragment;return e?"#"+e:""},setHash:function(e){(e=Sg(e))!==""?(Xl(e,0)==="#"&&(e=Pp(e,1)),this.fragment="",this.parse(e,Mp)):this.fragment=null},update:function(){this.query=this.searchParams.serialize()||null}};var oS=function(e){var t=MV(this,kc),r=xV(arguments.length,1)>1?arguments[1]:void 0,s=UV(t,new iN(e,!1,r));ik||(t.href=s.serialize(),t.origin=s.getOrigin(),t.protocol=s.getProtocol(),t.username=s.getUsername(),t.password=s.getPassword(),t.host=s.getHost(),t.hostname=s.getHostname(),t.port=s.getPort(),t.pathname=s.getPathname(),t.search=s.getSearch(),t.searchParams=s.getSearchParams(),t.hash=s.getHash())},kc=oS.prototype,zd=function(e,t){return{get:function(){return lb(this)[e]()},set:t&&function(r){return lb(this)[t](r)},configurable:!0,enumerable:!0}};if(ik&&(ml(kc,"href",zd("serialize","setHref")),ml(kc,"origin",zd("getOrigin")),ml(kc,"protocol",zd("getProtocol","setProtocol")),ml(kc,"username",zd("getUsername","setUsername")),ml(kc,"password",zd("getPassword","setPassword")),ml(kc,"host",zd("getHost","setHost")),ml(kc,"hostname",zd("getHostname","setHostname")),ml(kc,"port",zd("getPort","setPort")),ml(kc,"pathname",zd("getPathname","setPathname")),ml(kc,"search",zd("getSearch","setSearch")),ml(kc,"searchParams",zd("getSearchParams")),ml(kc,"hash",zd("getHash","setHash"))),v_(kc,"toJSON",function(){return lb(this).serialize()},{enumerable:!0}),v_(kc,"toString",function(){return lb(this).serialize()},{enumerable:!0}),S_){var yk=S_.createObjectURL,Tk=S_.revokeObjectURL;yk&&v_(oS,"createObjectURL",PV(yk,S_)),Tk&&v_(oS,"revokeObjectURL",PV(Tk,S_))}sk(oS,"URL"),DV({global:!0,forced:!rH,sham:!ik},{URL:oS});var WV=pr,bk=I,YV=Oc,Ck=Ls,cH=PO,wk=Zi("URL"),Rk=cH&&bk(function(){wk.canParse()}),KV=bk(function(){return wk.canParse.length!==1});WV({target:"URL",stat:!0,forced:!Rk||KV},{canParse:function(e){var t=YV(arguments.length,1),r=Ck(e),s=t<2||arguments[1]===void 0?void 0:Ck(arguments[1]);try{return!!new wk(r,s)}catch{return!1}}});var lH=pr,dH=Oc,qV=Ls,uH=PO,fH=Zi("URL");lH({target:"URL",stat:!0,forced:!uH},{parse:function(e){var t=dH(arguments.length,1),r=qV(e),s=t<2||arguments[1]===void 0?void 0:qV(arguments[1]);try{return new fH(r,s)}catch{return null}}});var aN=T(Ii.URL);let Ik=!0,JV=!0;function sN(e,t,r){const s=e.match(t);return s&&s.length>=r&&parseInt(s[r],10)}function cS(e,t,r){if(!e.RTCPeerConnection)return;const s=e.RTCPeerConnection.prototype,l=s.addEventListener;s.addEventListener=function(m,E){if(m!==t)return l.apply(this,arguments);const y=b=>{const A=r(b);A&&(E.handleEvent?E.handleEvent(A):E(A))};return this._eventMap=this._eventMap||{},this._eventMap[t]||(this._eventMap[t]=new Map),this._eventMap[t].set(E,y),l.apply(this,[m,y])};const f=s.removeEventListener;s.removeEventListener=function(m,E){if(m!==t||!this._eventMap||!this._eventMap[t])return f.apply(this,arguments);if(!this._eventMap[t].has(E))return f.apply(this,arguments);const y=this._eventMap[t].get(E);return this._eventMap[t].delete(E),this._eventMap[t].size===0&&delete this._eventMap[t],Object.keys(this._eventMap).length===0&&delete this._eventMap,f.apply(this,[m,y])},Object.defineProperty(s,"on"+t,{get(){return this["_on"+t]},set(m){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),m&&this.addEventListener(t,this["_on"+t]=m)},enumerable:!0,configurable:!0})}function hH(e){return typeof e!="boolean"?new Error("Argument type: "+typeof e+". Please use a boolean."):(Ik=e,e?"adapter.js logging disabled":"adapter.js logging enabled")}function Ak(e){return typeof e!="boolean"?new Error("Argument type: "+typeof e+". Please use a boolean."):(JV=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))}function XV(){if(typeof window=="object"){if(Ik)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function js(e,t){JV&&console.warn(e+" is deprecated, please use "+t+" instead.")}function Ok(e){return Object.prototype.toString.call(e)==="[object Object]"}function Nk(e){var t;return Ok(e)?wc(t=Object.keys(e)).call(t,function(r,s){const l=Ok(e[s]),f=l?Nk(e[s]):e[s],m=l&&!Object.keys(f).length;return f===void 0||m?r:Object.assign(r,{[s]:f})},{}):e}function b_(e,t,r){t&&!r.has(t.id)&&(r.set(t.id,t),Object.keys(t).forEach(s=>{s.endsWith("Id")?b_(e,e.get(t[s]),r):s.endsWith("Ids")&&t[s].forEach(l=>{b_(e,e.get(l),r)})}))}function QV(e,t,r){const s=r?"outbound-rtp":"inbound-rtp",l=new Map;if(t===null)return l;const f=[];return e.forEach(m=>{m.type==="track"&&m.trackIdentifier===t.id&&f.push(m)}),f.forEach(m=>{e.forEach(E=>{E.type===s&&E.trackId===m.id&&b_(e,E,l)})}),l}const vR=XV;function oN(e,t){const r=e&&e.navigator;if(!r.mediaDevices)return;const s=function(m){if(typeof m!="object"||m.mandatory||m.optional)return m;const E={};return Object.keys(m).forEach(y=>{if(y==="require"||y==="advanced"||y==="mediaSource")return;const b=typeof m[y]=="object"?m[y]:{ideal:m[y]};b.exact!==void 0&&typeof b.exact=="number"&&(b.min=b.max=b.exact);const A=function(O,D){return O?O+D.charAt(0).toUpperCase()+D.slice(1):D==="deviceId"?"sourceId":D};if(b.ideal!==void 0){E.optional=E.optional||[];let O={};typeof b.ideal=="number"?(O[A("min",y)]=b.ideal,E.optional.push(O),O={},O[A("max",y)]=b.ideal,E.optional.push(O)):(O[A("",y)]=b.ideal,E.optional.push(O))}b.exact!==void 0&&typeof b.exact!="number"?(E.mandatory=E.mandatory||{},E.mandatory[A("",y)]=b.exact):["min","max"].forEach(O=>{b[O]!==void 0&&(E.mandatory=E.mandatory||{},E.mandatory[A(O,y)]=b[O])})}),m.advanced&&(E.optional=(E.optional||[]).concat(m.advanced)),E},l=function(m,E){if(t.version>=61)return E(m);if((m=JSON.parse(JSON.stringify(m)))&&typeof m.audio=="object"){const y=function(b,A,O){A in b&&!(O in b)&&(b[O]=b[A],delete b[A])};y((m=JSON.parse(JSON.stringify(m))).audio,"autoGainControl","googAutoGainControl"),y(m.audio,"noiseSuppression","googNoiseSuppression"),m.audio=s(m.audio)}if(m&&typeof m.video=="object"){let y=m.video.facingMode;y=y&&(typeof y=="object"?y:{ideal:y});const b=t.version<66;if(y&&(y.exact==="user"||y.exact==="environment"||y.ideal==="user"||y.ideal==="environment")&&(!r.mediaDevices.getSupportedConstraints||!r.mediaDevices.getSupportedConstraints().facingMode||b)){let A;if(delete m.video.facingMode,y.exact==="environment"||y.ideal==="environment"?A=["back","rear"]:y.exact!=="user"&&y.ideal!=="user"||(A=["front"]),A)return r.mediaDevices.enumerateDevices().then(O=>{let D=(O=O.filter(P=>P.kind==="videoinput")).find(P=>A.some(F=>{var B;return ht(B=P.label.toLowerCase()).call(B,F)}));return!D&&O.length&&ht(A).call(A,"back")&&(D=O[O.length-1]),D&&(m.video.deviceId=y.exact?{exact:D.deviceId}:{ideal:D.deviceId}),m.video=s(m.video),vR("chrome: "+JSON.stringify(m)),E(m)})}m.video=s(m.video)}return vR("chrome: "+JSON.stringify(m)),E(m)},f=function(m){return t.version>=64?m:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[m.name]||m.name,message:m.message,constraint:m.constraint||m.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}};if(r.getUserMedia=(function(m,E,y){l(m,b=>{r.webkitGetUserMedia(b,E,A=>{y&&y(f(A))})})}).bind(r),r.mediaDevices.getUserMedia){const m=r.mediaDevices.getUserMedia.bind(r.mediaDevices);r.mediaDevices.getUserMedia=function(E){return l(E,y=>m(y).then(b=>{if(y.audio&&!b.getAudioTracks().length||y.video&&!b.getVideoTracks().length)throw b.getTracks().forEach(A=>{A.stop()}),new DOMException("","NotFoundError");return b},b=>gt.reject(f(b))))}}}function SR(e){e.MediaStream=e.MediaStream||e.webkitMediaStream}function yR(e){if(typeof e=="object"&&e.RTCPeerConnection&&!("ontrack"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(r){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=r)},enumerable:!0,configurable:!0});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=r=>{r.stream.addEventListener("addtrack",s=>{let l;l=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(m=>m.track&&m.track.id===s.track.id):{track:s.track};const f=new Event("track");f.track=s.track,f.receiver=l,f.transceiver={receiver:l},f.streams=[r.stream],this.dispatchEvent(f)}),r.stream.getTracks().forEach(s=>{let l;l=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(m=>m.track&&m.track.id===s.id):{track:s};const f=new Event("track");f.track=s,f.receiver=l,f.transceiver={receiver:l},f.streams=[r.stream],this.dispatchEvent(f)})},this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}else cS(e,"track",t=>(t.transceiver||Object.defineProperty(t,"transceiver",{value:{receiver:t.receiver}}),t))}function cN(e){if(typeof e=="object"&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){const t=function(l,f){return{track:f,get dtmf(){return this._dtmf===void 0&&(f.kind==="audio"?this._dtmf=l.createDTMFSender(f):this._dtmf=null),this._dtmf},_pc:l}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const l=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(m,E){let y=l.apply(this,arguments);return y||(y=t(this,m),this._senders.push(y)),y};const f=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(m){f.apply(this,arguments);const E=this._senders.indexOf(m);E!==-1&&this._senders.splice(E,1)}}const r=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(l){this._senders=this._senders||[],r.apply(this,[l]),l.getTracks().forEach(f=>{this._senders.push(t(this,f))})};const s=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(l){this._senders=this._senders||[],s.apply(this,[l]),l.getTracks().forEach(f=>{const m=this._senders.find(E=>E.track===f);m&&this._senders.splice(this._senders.indexOf(m),1)})}}else if(typeof e=="object"&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){const r=t.apply(this,[]);return r.forEach(s=>s._pc=this),r},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function lN(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[r,s,l]=arguments;if(arguments.length>0&&typeof r=="function")return t.apply(this,arguments);if(t.length===0&&(arguments.length===0||typeof r!="function"))return t.apply(this,[]);const f=function(E){const y={};return E.result().forEach(b=>{const A={id:b.id,timestamp:b.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[b.type]||b.type};b.names().forEach(O=>{A[O]=b.stat(O)}),y[A.id]=A}),y},m=function(E){return new Map(Object.keys(E).map(y=>[y,E[y]]))};if(arguments.length>=2){const E=function(y){s(m(f(y)))};return t.apply(this,[E,r])}return new gt((E,y)=>{t.apply(this,[function(b){E(m(f(b)))},y])}).then(s,l)}}function TR(e){if(!(typeof e=="object"&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver))return;if(!("getStats"in e.RTCRtpSender.prototype)){const r=e.RTCPeerConnection.prototype.getSenders;r&&(e.RTCPeerConnection.prototype.getSenders=function(){const l=r.apply(this,[]);return l.forEach(f=>f._pc=this),l});const s=e.RTCPeerConnection.prototype.addTrack;s&&(e.RTCPeerConnection.prototype.addTrack=function(){const l=s.apply(this,arguments);return l._pc=this,l}),e.RTCRtpSender.prototype.getStats=function(){const l=this;return this._pc.getStats().then(f=>QV(f,l.track,!0))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){const r=e.RTCPeerConnection.prototype.getReceivers;r&&(e.RTCPeerConnection.prototype.getReceivers=function(){const s=r.apply(this,[]);return s.forEach(l=>l._pc=this),s}),cS(e,"track",s=>(s.receiver._pc=s.srcElement,s)),e.RTCRtpReceiver.prototype.getStats=function(){const s=this;return this._pc.getStats().then(l=>QV(l,s.track,!1))}}if(!("getStats"in e.RTCRtpSender.prototype)||!("getStats"in e.RTCRtpReceiver.prototype))return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){const r=arguments[0];let s,l,f;return this.getSenders().forEach(m=>{m.track===r&&(s?f=!0:s=m)}),this.getReceivers().forEach(m=>(m.track===r&&(l?f=!0:l=m),m.track===r)),f||s&&l?gt.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):s?s.getStats():l?l.getStats():gt.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return t.apply(this,arguments)}}function bR(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(f=>this._shimmedLocalStreams[f][0])};const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(f,m){if(!m)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const E=t.apply(this,arguments);return this._shimmedLocalStreams[m.id]?this._shimmedLocalStreams[m.id].indexOf(E)===-1&&this._shimmedLocalStreams[m.id].push(E):this._shimmedLocalStreams[m.id]=[m,E],E};const r=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(f){this._shimmedLocalStreams=this._shimmedLocalStreams||{},f.getTracks().forEach(y=>{if(this.getSenders().find(A=>A.track===y))throw new DOMException("Track already exists.","InvalidAccessError")});const m=this.getSenders();r.apply(this,arguments);const E=this.getSenders().filter(y=>m.indexOf(y)===-1);this._shimmedLocalStreams[f.id]=[f].concat(E)};const s=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(f){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[f.id],s.apply(this,arguments)};const l=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(f){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},f&&Object.keys(this._shimmedLocalStreams).forEach(m=>{const E=this._shimmedLocalStreams[m].indexOf(f);E!==-1&&this._shimmedLocalStreams[m].splice(E,1),this._shimmedLocalStreams[m].length===1&&delete this._shimmedLocalStreams[m]}),l.apply(this,arguments)}}function ZV(e,t){if(!e.RTCPeerConnection)return;if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return bR(e);const r=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){const y=r.apply(this);return this._reverseStreams=this._reverseStreams||{},y.map(b=>this._reverseStreams[b.id])};const s=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(y){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},y.getTracks().forEach(b=>{if(this.getSenders().find(O=>O.track===b))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[y.id]){const b=new e.MediaStream(y.getTracks());this._streams[y.id]=b,this._reverseStreams[b.id]=y,y=b}s.apply(this,[y])};const l=e.RTCPeerConnection.prototype.removeStream;function f(y,b){let A=b.sdp;return Object.keys(y._reverseStreams||[]).forEach(O=>{const D=y._reverseStreams[O],P=y._streams[D.id];A=A.replace(new RegExp(P.id,"g"),D.id)}),new RTCSessionDescription({type:b.type,sdp:A})}e.RTCPeerConnection.prototype.removeStream=function(y){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},l.apply(this,[this._streams[y.id]||y]),delete this._reverseStreams[this._streams[y.id]?this._streams[y.id].id:y.id],delete this._streams[y.id]},e.RTCPeerConnection.prototype.addTrack=function(y,b){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const A=[].slice.call(arguments,1);if(A.length!==1||!A[0].getTracks().find(P=>P===y))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(P=>P.track===y))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const D=this._streams[b.id];if(D)D.addTrack(y),gt.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const P=new e.MediaStream([y]);this._streams[b.id]=P,this._reverseStreams[P.id]=b,this.addStream(P)}return this.getSenders().find(P=>P.track===y)},["createOffer","createAnswer"].forEach(function(y){const b=e.RTCPeerConnection.prototype[y],A={[y](){const O=arguments;return arguments.length&&typeof arguments[0]=="function"?b.apply(this,[D=>{const P=f(this,D);O[0].apply(null,[P])},D=>{O[1]&&O[1].apply(null,D)},arguments[2]]):b.apply(this,arguments).then(D=>f(this,D))}};e.RTCPeerConnection.prototype[y]=A[y]});const m=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=function(y,b){let A=b.sdp;return Object.keys(y._reverseStreams||[]).forEach(O=>{const D=y._reverseStreams[O],P=y._streams[D.id];A=A.replace(new RegExp(D.id,"g"),P.id)}),new RTCSessionDescription({type:b.type,sdp:A})}(this,arguments[0]),m.apply(this,arguments)):m.apply(this,arguments)};const E=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get(){const y=E.get.apply(this);return y.type===""?y:f(this,y)}}),e.RTCPeerConnection.prototype.removeTrack=function(y){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!y._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(y._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");let b;this._streams=this._streams||{},Object.keys(this._streams).forEach(A=>{this._streams[A].getTracks().find(O=>y.track===O)&&(b=this._streams[A])}),b&&(b.getTracks().length===1?this.removeStream(this._reverseStreams[b.id]):b.removeTrack(y.track),this.dispatchEvent(new Event("negotiationneeded")))}}function dN(e,t){!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),e.RTCPeerConnection&&t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(r){const s=e.RTCPeerConnection.prototype[r],l={[r](){return arguments[0]=new(r==="addIceCandidate"?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),s.apply(this,arguments)}};e.RTCPeerConnection.prototype[r]=l[r]})}function $V(e,t){cS(e,"negotiationneeded",r=>{const s=r.target;if(!(t.version<72||s.getConfiguration&&s.getConfiguration().sdpSemantics==="plan-b")||s.signalingState==="stable")return r})}var Lk=Object.freeze({__proto__:null,fixNegotiationNeeded:$V,shimAddTrackRemoveTrack:ZV,shimAddTrackRemoveTrackWithNative:bR,shimGetDisplayMedia:function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(typeof t=="function"?e.navigator.mediaDevices.getDisplayMedia=function(r){return t(r).then(s=>{const l=r.video&&r.video.width,f=r.video&&r.video.height,m=r.video&&r.video.frameRate;return r.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:s,maxFrameRate:m||3}},l&&(r.video.mandatory.maxWidth=l),f&&(r.video.mandatory.maxHeight=f),e.navigator.mediaDevices.getUserMedia(r)})}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))},shimGetSendersWithDtmf:cN,shimGetStats:lN,shimGetUserMedia:oN,shimMediaStream:SR,shimOnTrack:yR,shimPeerConnection:dN,shimSenderReceiverGetStats:TR});function e9(e,t){const r=e&&e.navigator,s=e&&e.MediaStreamTrack;if(r.getUserMedia=function(l,f,m){js("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),r.mediaDevices.getUserMedia(l).then(f,m)},!(t.version>55&&"autoGainControl"in r.mediaDevices.getSupportedConstraints())){const l=function(m,E,y){E in m&&!(y in m)&&(m[y]=m[E],delete m[E])},f=r.mediaDevices.getUserMedia.bind(r.mediaDevices);if(r.mediaDevices.getUserMedia=function(m){return typeof m=="object"&&typeof m.audio=="object"&&(m=JSON.parse(JSON.stringify(m)),l(m.audio,"autoGainControl","mozAutoGainControl"),l(m.audio,"noiseSuppression","mozNoiseSuppression")),f(m)},s&&s.prototype.getSettings){const m=s.prototype.getSettings;s.prototype.getSettings=function(){const E=m.apply(this,arguments);return l(E,"mozAutoGainControl","autoGainControl"),l(E,"mozNoiseSuppression","noiseSuppression"),E}}if(s&&s.prototype.applyConstraints){const m=s.prototype.applyConstraints;s.prototype.applyConstraints=function(E){return this.kind==="audio"&&typeof E=="object"&&(E=JSON.parse(JSON.stringify(E)),l(E,"autoGainControl","mozAutoGainControl"),l(E,"noiseSuppression","mozNoiseSuppression")),m.apply(this,[E])}}}}function t9(e){typeof e=="object"&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function uN(e,t){if(typeof e!="object"||!e.RTCPeerConnection&&!e.mozRTCPeerConnection)return;!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(l){const f=e.RTCPeerConnection.prototype[l],m={[l](){return arguments[0]=new(l==="addIceCandidate"?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),f.apply(this,arguments)}};e.RTCPeerConnection.prototype[l]=m[l]});const r={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},s=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[l,f,m]=arguments;return s.apply(this,[l||null]).then(E=>{if(t.version<53&&!f)try{E.forEach(y=>{y.type=r[y.type]||y.type})}catch(y){if(y.name!=="TypeError")throw y;E.forEach((b,A)=>{E.set(A,Object.assign({},b,{type:r[b.type]||b.type}))})}return E}).then(f,m)}}function n9(e){if(typeof e!="object"||!e.RTCPeerConnection||!e.RTCRtpSender||e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype)return;const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const s=t.apply(this,[]);return s.forEach(l=>l._pc=this),s});const r=e.RTCPeerConnection.prototype.addTrack;r&&(e.RTCPeerConnection.prototype.addTrack=function(){const s=r.apply(this,arguments);return s._pc=this,s}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):gt.resolve(new Map)}}function r9(e){if(typeof e!="object"||!e.RTCPeerConnection||!e.RTCRtpSender||e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype)return;const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const r=t.apply(this,[]);return r.forEach(s=>s._pc=this),r}),cS(e,"track",r=>(r.receiver._pc=r.srcElement,r)),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function Dk(e){e.RTCPeerConnection&&!("removeStream"in e.RTCPeerConnection.prototype)&&(e.RTCPeerConnection.prototype.removeStream=function(t){js("removeStream","removeTrack"),this.getSenders().forEach(r=>{var s;r.track&&ht(s=t.getTracks()).call(s,r.track)&&this.removeTrack(r)})})}function i9(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)}function a9(e){if(typeof e!="object"||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.addTransceiver;t&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let r=arguments[1]&&arguments[1].sendEncodings;r===void 0&&(r=[]),r=[...r];const s=r.length>0;s&&r.forEach(f=>{if("rid"in f&&!/^[a-z0-9]{0,16}$/i.test(f.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in f&&!(parseFloat(f.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in f&&!(parseFloat(f.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const l=t.apply(this,arguments);if(s){const{sender:f}=l,m=f.getParameters();(!("encodings"in m)||m.encodings.length===1&&Object.keys(m.encodings[0]).length===0)&&(m.encodings=r,f.sendEncodings=r,this.setParametersPromises.push(f.setParameters(m).then(()=>{delete f.sendEncodings}).catch(()=>{delete f.sendEncodings})))}return l})}function Pk(e){if(typeof e!="object"||!e.RTCRtpSender)return;const t=e.RTCRtpSender.prototype.getParameters;t&&(e.RTCRtpSender.prototype.getParameters=function(){const r=t.apply(this,arguments);return"encodings"in r||(r.encodings=[].concat(this.sendEncodings||[{}])),r})}function s9(e){if(typeof e!="object"||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?gt.all(this.setParametersPromises).then(()=>t.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):t.apply(this,arguments)}}function Mk(e){if(typeof e!="object"||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?gt.all(this.setParametersPromises).then(()=>t.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):t.apply(this,arguments)}}var fN=Object.freeze({__proto__:null,shimAddTransceiver:a9,shimCreateAnswer:Mk,shimCreateOffer:s9,shimGetDisplayMedia:function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(e.navigator.mediaDevices.getDisplayMedia=function(r){if(!r||!r.video){const s=new DOMException("getDisplayMedia without video constraints is undefined");return s.name="NotFoundError",s.code=8,gt.reject(s)}return r.video===!0?r.video={mediaSource:t}:r.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(r)})},shimGetParameters:Pk,shimGetUserMedia:e9,shimOnTrack:t9,shimPeerConnection:uN,shimRTCDataChannel:i9,shimReceiverGetStats:r9,shimRemoveStream:Dk,shimSenderGetStats:n9});function o9(e){if(typeof e=="object"&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(r){var s;this._localStreams||(this._localStreams=[]),ht(s=this._localStreams).call(s,r)||this._localStreams.push(r),r.getAudioTracks().forEach(l=>t.call(this,l,r)),r.getVideoTracks().forEach(l=>t.call(this,l,r))},e.RTCPeerConnection.prototype.addTrack=function(r){for(var s=arguments.length,l=new Array(s>1?s-1:0),f=1;f<s;f++)l[f-1]=arguments[f];return l&&l.forEach(m=>{var E;this._localStreams?ht(E=this._localStreams).call(E,m)||this._localStreams.push(m):this._localStreams=[m]}),t.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(t){this._localStreams||(this._localStreams=[]);const r=this._localStreams.indexOf(t);if(r===-1)return;this._localStreams.splice(r,1);const s=t.getTracks();this.getSenders().forEach(l=>{ht(s).call(s,l.track)&&this.removeTrack(l)})})}}function c9(e){if(typeof e=="object"&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(r){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=r),this.addEventListener("track",this._onaddstreampoly=s=>{s.streams.forEach(l=>{var f;if(this._remoteStreams||(this._remoteStreams=[]),ht(f=this._remoteStreams).call(f,l))return;this._remoteStreams.push(l);const m=new Event("addstream");m.stream=l,this.dispatchEvent(m)})})}});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){const r=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(s){s.streams.forEach(l=>{if(r._remoteStreams||(r._remoteStreams=[]),r._remoteStreams.indexOf(l)>=0)return;r._remoteStreams.push(l);const f=new Event("addstream");f.stream=l,r.dispatchEvent(f)})}),t.apply(r,arguments)}}}function kk(e){if(typeof e!="object"||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype,r=t.createOffer,s=t.createAnswer,l=t.setLocalDescription,f=t.setRemoteDescription,m=t.addIceCandidate;t.createOffer=function(y,b){const A=arguments.length>=2?arguments[2]:arguments[0],O=r.apply(this,[A]);return b?(O.then(y,b),gt.resolve()):O},t.createAnswer=function(y,b){const A=arguments.length>=2?arguments[2]:arguments[0],O=s.apply(this,[A]);return b?(O.then(y,b),gt.resolve()):O};let E=function(y,b,A){const O=l.apply(this,[y]);return A?(O.then(b,A),gt.resolve()):O};t.setLocalDescription=E,E=function(y,b,A){const O=f.apply(this,[y]);return A?(O.then(b,A),gt.resolve()):O},t.setRemoteDescription=E,E=function(y,b,A){const O=m.apply(this,[y]);return A?(O.then(b,A),gt.resolve()):O},t.addIceCandidate=E}function l9(e){const t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){const r=t.mediaDevices,s=r.getUserMedia.bind(r);t.mediaDevices.getUserMedia=l=>s(xk(l))}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=(function(r,s,l){t.mediaDevices.getUserMedia(r).then(s,l)}).bind(t))}function xk(e){return e&&e.video!==void 0?Object.assign({},e,{video:Nk(e.video)}):e}function Uk(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection;e.RTCPeerConnection=function(r,s){if(r&&r.iceServers){const l=[];for(let f=0;f<r.iceServers.length;f++){let m=r.iceServers[f];!m.hasOwnProperty("urls")&&m.hasOwnProperty("url")?(js("RTCIceServer.url","RTCIceServer.urls"),m=JSON.parse(JSON.stringify(m)),m.urls=m.url,delete m.url,l.push(m)):l.push(r.iceServers[f])}r.iceServers=l}return new t(r,s)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in t&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:()=>t.generateCertificate})}function Cg(e){typeof e=="object"&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function jk(e){const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(r){if(r){r.offerToReceiveAudio!==void 0&&(r.offerToReceiveAudio=!!r.offerToReceiveAudio);const s=this.getTransceivers().find(f=>f.receiver.track.kind==="audio");r.offerToReceiveAudio===!1&&s?s.direction==="sendrecv"?s.setDirection?s.setDirection("sendonly"):s.direction="sendonly":s.direction==="recvonly"&&(s.setDirection?s.setDirection("inactive"):s.direction="inactive"):r.offerToReceiveAudio!==!0||s||this.addTransceiver("audio",{direction:"recvonly"}),r.offerToReceiveVideo!==void 0&&(r.offerToReceiveVideo=!!r.offerToReceiveVideo);const l=this.getTransceivers().find(f=>f.receiver.track.kind==="video");r.offerToReceiveVideo===!1&&l?l.direction==="sendrecv"?l.setDirection?l.setDirection("sendonly"):l.direction="sendonly":l.direction==="recvonly"&&(l.setDirection?l.setDirection("inactive"):l.direction="inactive"):r.offerToReceiveVideo!==!0||l||this.addTransceiver("video",{direction:"recvonly"})}return t.apply(this,arguments)}}function d9(e){typeof e!="object"||e.AudioContext||(e.AudioContext=e.webkitAudioContext)}var u9=Object.freeze({__proto__:null,shimAudioContext:d9,shimCallbacksAPI:kk,shimConstraints:xk,shimCreateOfferLegacy:jk,shimGetUserMedia:l9,shimLocalStreamsAPI:o9,shimRTCIceServerUrls:Uk,shimRemoteStreamsAPI:c9,shimTrackEventTransceiver:Cg}),f9=`	
\v\f\r \u2028\u2029\uFEFF`,pH=tn,h9=Ls,Vk=f9,p9=K("".replace),mH=RegExp("^["+Vk+"]+"),Bk=RegExp("(^|[^"+Vk+"])["+Vk+"]+$"),gH=function(e){return function(t){var r=h9(pH(t));return 1&e&&(r=p9(r,mH,"")),2&e&&(r=p9(r,Bk,"$1")),r}},CR={trim:gH(3)},Fk=up.PROPER,m9=I,hN=f9,_H=CR.trim;pr({target:"String",proto:!0,forced:function(e){return m9(function(){return!!hN[e]()||""[e]()!==""||Fk&&hN[e].name!==e})}("trim")},{trim:function(){return _H(this)}});var EH=il("String","trim"),vH=Q,SH=EH,Gk=String.prototype,yH=function(e){var t=e.trim;return typeof e=="string"||e===Gk||vH(Gk,e)&&t===Gk.trim?SH:t},Eo=T(yH),g9={exports:{}};(function(e){const t={generateIdentifier:function(){return Math.random().toString(36).substring(2,12)}};t.localCName=t.generateIdentifier(),t.splitLines=function(r){return r.trim().split(`
`).map(s=>s.trim())},t.splitSections=function(r){return r.split(`
m=`).map((s,l)=>(l>0?"m="+s:s).trim()+`\r
`)},t.getDescription=function(r){const s=t.splitSections(r);return s&&s[0]},t.getMediaSections=function(r){const s=t.splitSections(r);return s.shift(),s},t.matchPrefix=function(r,s){return t.splitLines(r).filter(l=>l.indexOf(s)===0)},t.parseCandidate=function(r){let s;s=r.indexOf("a=candidate:")===0?r.substring(12).split(" "):r.substring(10).split(" ");const l={foundation:s[0],component:{1:"rtp",2:"rtcp"}[s[1]]||s[1],protocol:s[2].toLowerCase(),priority:parseInt(s[3],10),ip:s[4],address:s[4],port:parseInt(s[5],10),type:s[7]};for(let f=8;f<s.length;f+=2)switch(s[f]){case"raddr":l.relatedAddress=s[f+1];break;case"rport":l.relatedPort=parseInt(s[f+1],10);break;case"tcptype":l.tcpType=s[f+1];break;case"ufrag":l.ufrag=s[f+1],l.usernameFragment=s[f+1];break;default:l[s[f]]===void 0&&(l[s[f]]=s[f+1])}return l},t.writeCandidate=function(r){const s=[];s.push(r.foundation);const l=r.component;l==="rtp"?s.push(1):l==="rtcp"?s.push(2):s.push(l),s.push(r.protocol.toUpperCase()),s.push(r.priority),s.push(r.address||r.ip),s.push(r.port);const f=r.type;return s.push("typ"),s.push(f),f!=="host"&&r.relatedAddress&&r.relatedPort&&(s.push("raddr"),s.push(r.relatedAddress),s.push("rport"),s.push(r.relatedPort)),r.tcpType&&r.protocol.toLowerCase()==="tcp"&&(s.push("tcptype"),s.push(r.tcpType)),(r.usernameFragment||r.ufrag)&&(s.push("ufrag"),s.push(r.usernameFragment||r.ufrag)),"candidate:"+s.join(" ")},t.parseIceOptions=function(r){return r.substring(14).split(" ")},t.parseRtpMap=function(r){let s=r.substring(9).split(" ");const l={payloadType:parseInt(s.shift(),10)};return s=s[0].split("/"),l.name=s[0],l.clockRate=parseInt(s[1],10),l.channels=s.length===3?parseInt(s[2],10):1,l.numChannels=l.channels,l},t.writeRtpMap=function(r){let s=r.payloadType;r.preferredPayloadType!==void 0&&(s=r.preferredPayloadType);const l=r.channels||r.numChannels||1;return"a=rtpmap:"+s+" "+r.name+"/"+r.clockRate+(l!==1?"/"+l:"")+`\r
`},t.parseExtmap=function(r){const s=r.substring(9).split(" ");return{id:parseInt(s[0],10),direction:s[0].indexOf("/")>0?s[0].split("/")[1]:"sendrecv",uri:s[1],attributes:s.slice(2).join(" ")}},t.writeExtmap=function(r){return"a=extmap:"+(r.id||r.preferredId)+(r.direction&&r.direction!=="sendrecv"?"/"+r.direction:"")+" "+r.uri+(r.attributes?" "+r.attributes:"")+`\r
`},t.parseFmtp=function(r){const s={};let l;const f=r.substring(r.indexOf(" ")+1).split(";");for(let m=0;m<f.length;m++)l=f[m].trim().split("="),s[l[0].trim()]=l[1];return s},t.writeFmtp=function(r){let s="",l=r.payloadType;if(r.preferredPayloadType!==void 0&&(l=r.preferredPayloadType),r.parameters&&Object.keys(r.parameters).length){const f=[];Object.keys(r.parameters).forEach(m=>{r.parameters[m]!==void 0?f.push(m+"="+r.parameters[m]):f.push(m)}),s+="a=fmtp:"+l+" "+f.join(";")+`\r
`}return s},t.parseRtcpFb=function(r){const s=r.substring(r.indexOf(" ")+1).split(" ");return{type:s.shift(),parameter:s.join(" ")}},t.writeRtcpFb=function(r){let s="",l=r.payloadType;return r.preferredPayloadType!==void 0&&(l=r.preferredPayloadType),r.rtcpFeedback&&r.rtcpFeedback.length&&r.rtcpFeedback.forEach(f=>{s+="a=rtcp-fb:"+l+" "+f.type+(f.parameter&&f.parameter.length?" "+f.parameter:"")+`\r
`}),s},t.parseSsrcMedia=function(r){const s=r.indexOf(" "),l={ssrc:parseInt(r.substring(7,s),10)},f=r.indexOf(":",s);return f>-1?(l.attribute=r.substring(s+1,f),l.value=r.substring(f+1)):l.attribute=r.substring(s+1),l},t.parseSsrcGroup=function(r){const s=r.substring(13).split(" ");return{semantics:s.shift(),ssrcs:s.map(l=>parseInt(l,10))}},t.getMid=function(r){const s=t.matchPrefix(r,"a=mid:")[0];if(s)return s.substring(6)},t.parseFingerprint=function(r){const s=r.substring(14).split(" ");return{algorithm:s[0].toLowerCase(),value:s[1].toUpperCase()}},t.getDtlsParameters=function(r,s){return{role:"auto",fingerprints:t.matchPrefix(r+s,"a=fingerprint:").map(t.parseFingerprint)}},t.writeDtlsParameters=function(r,s){let l="a=setup:"+s+`\r
`;return r.fingerprints.forEach(f=>{l+="a=fingerprint:"+f.algorithm+" "+f.value+`\r
`}),l},t.parseCryptoLine=function(r){const s=r.substring(9).split(" ");return{tag:parseInt(s[0],10),cryptoSuite:s[1],keyParams:s[2],sessionParams:s.slice(3)}},t.writeCryptoLine=function(r){return"a=crypto:"+r.tag+" "+r.cryptoSuite+" "+(typeof r.keyParams=="object"?t.writeCryptoKeyParams(r.keyParams):r.keyParams)+(r.sessionParams?" "+r.sessionParams.join(" "):"")+`\r
`},t.parseCryptoKeyParams=function(r){if(r.indexOf("inline:")!==0)return null;const s=r.substring(7).split("|");return{keyMethod:"inline",keySalt:s[0],lifeTime:s[1],mkiValue:s[2]?s[2].split(":")[0]:void 0,mkiLength:s[2]?s[2].split(":")[1]:void 0}},t.writeCryptoKeyParams=function(r){return r.keyMethod+":"+r.keySalt+(r.lifeTime?"|"+r.lifeTime:"")+(r.mkiValue&&r.mkiLength?"|"+r.mkiValue+":"+r.mkiLength:"")},t.getCryptoParameters=function(r,s){return t.matchPrefix(r+s,"a=crypto:").map(t.parseCryptoLine)},t.getIceParameters=function(r,s){const l=t.matchPrefix(r+s,"a=ice-ufrag:")[0],f=t.matchPrefix(r+s,"a=ice-pwd:")[0];return l&&f?{usernameFragment:l.substring(12),password:f.substring(10)}:null},t.writeIceParameters=function(r){let s="a=ice-ufrag:"+r.usernameFragment+`\r
a=ice-pwd:`+r.password+`\r
`;return r.iceLite&&(s+=`a=ice-lite\r
`),s},t.parseRtpParameters=function(r){const s={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},l=t.splitLines(r)[0].split(" ");s.profile=l[2];for(let m=3;m<l.length;m++){const E=l[m],y=t.matchPrefix(r,"a=rtpmap:"+E+" ")[0];if(y){const b=t.parseRtpMap(y),A=t.matchPrefix(r,"a=fmtp:"+E+" ");switch(b.parameters=A.length?t.parseFmtp(A[0]):{},b.rtcpFeedback=t.matchPrefix(r,"a=rtcp-fb:"+E+" ").map(t.parseRtcpFb),s.codecs.push(b),b.name.toUpperCase()){case"RED":case"ULPFEC":s.fecMechanisms.push(b.name.toUpperCase())}}}t.matchPrefix(r,"a=extmap:").forEach(m=>{s.headerExtensions.push(t.parseExtmap(m))});const f=t.matchPrefix(r,"a=rtcp-fb:* ").map(t.parseRtcpFb);return s.codecs.forEach(m=>{f.forEach(E=>{m.rtcpFeedback.find(y=>y.type===E.type&&y.parameter===E.parameter)||m.rtcpFeedback.push(E)})}),s},t.writeRtpDescription=function(r,s){let l="";l+="m="+r+" ",l+=s.codecs.length>0?"9":"0",l+=" "+(s.profile||"UDP/TLS/RTP/SAVPF")+" ",l+=s.codecs.map(m=>m.preferredPayloadType!==void 0?m.preferredPayloadType:m.payloadType).join(" ")+`\r
`,l+=`c=IN IP4 0.0.0.0\r
`,l+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,s.codecs.forEach(m=>{l+=t.writeRtpMap(m),l+=t.writeFmtp(m),l+=t.writeRtcpFb(m)});let f=0;return s.codecs.forEach(m=>{m.maxptime>f&&(f=m.maxptime)}),f>0&&(l+="a=maxptime:"+f+`\r
`),s.headerExtensions&&s.headerExtensions.forEach(m=>{l+=t.writeExtmap(m)}),l},t.parseRtpEncodingParameters=function(r){const s=[],l=t.parseRtpParameters(r),f=l.fecMechanisms.indexOf("RED")!==-1,m=l.fecMechanisms.indexOf("ULPFEC")!==-1,E=t.matchPrefix(r,"a=ssrc:").map(D=>t.parseSsrcMedia(D)).filter(D=>D.attribute==="cname"),y=E.length>0&&E[0].ssrc;let b;const A=t.matchPrefix(r,"a=ssrc-group:FID").map(D=>D.substring(17).split(" ").map(P=>parseInt(P,10)));A.length>0&&A[0].length>1&&A[0][0]===y&&(b=A[0][1]),l.codecs.forEach(D=>{if(D.name.toUpperCase()==="RTX"&&D.parameters.apt){let P={ssrc:y,codecPayloadType:parseInt(D.parameters.apt,10)};y&&b&&(P.rtx={ssrc:b}),s.push(P),f&&(P=JSON.parse(JSON.stringify(P)),P.fec={ssrc:y,mechanism:m?"red+ulpfec":"red"},s.push(P))}}),s.length===0&&y&&s.push({ssrc:y});let O=t.matchPrefix(r,"b=");return O.length&&(O=O[0].indexOf("b=TIAS:")===0?parseInt(O[0].substring(7),10):O[0].indexOf("b=AS:")===0?1e3*parseInt(O[0].substring(5),10)*.95-16e3:void 0,s.forEach(D=>{D.maxBitrate=O})),s},t.parseRtcpParameters=function(r){const s={},l=t.matchPrefix(r,"a=ssrc:").map(E=>t.parseSsrcMedia(E)).filter(E=>E.attribute==="cname")[0];l&&(s.cname=l.value,s.ssrc=l.ssrc);const f=t.matchPrefix(r,"a=rtcp-rsize");s.reducedSize=f.length>0,s.compound=f.length===0;const m=t.matchPrefix(r,"a=rtcp-mux");return s.mux=m.length>0,s},t.writeRtcpParameters=function(r){let s="";return r.reducedSize&&(s+=`a=rtcp-rsize\r
`),r.mux&&(s+=`a=rtcp-mux\r
`),r.ssrc!==void 0&&r.cname&&(s+="a=ssrc:"+r.ssrc+" cname:"+r.cname+`\r
`),s},t.parseMsid=function(r){let s;const l=t.matchPrefix(r,"a=msid:");if(l.length===1)return s=l[0].substring(7).split(" "),{stream:s[0],track:s[1]};const f=t.matchPrefix(r,"a=ssrc:").map(m=>t.parseSsrcMedia(m)).filter(m=>m.attribute==="msid");return f.length>0?(s=f[0].value.split(" "),{stream:s[0],track:s[1]}):void 0},t.parseSctpDescription=function(r){const s=t.parseMLine(r),l=t.matchPrefix(r,"a=max-message-size:");let f;l.length>0&&(f=parseInt(l[0].substring(19),10)),isNaN(f)&&(f=65536);const m=t.matchPrefix(r,"a=sctp-port:");if(m.length>0)return{port:parseInt(m[0].substring(12),10),protocol:s.fmt,maxMessageSize:f};const E=t.matchPrefix(r,"a=sctpmap:");if(E.length>0){const y=E[0].substring(10).split(" ");return{port:parseInt(y[0],10),protocol:y[1],maxMessageSize:f}}},t.writeSctpDescription=function(r,s){let l=[];return l=r.protocol!=="DTLS/SCTP"?["m="+r.kind+" 9 "+r.protocol+" "+s.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+s.port+`\r
`]:["m="+r.kind+" 9 "+r.protocol+" "+s.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+s.port+" "+s.protocol+` 65535\r
`],s.maxMessageSize!==void 0&&l.push("a=max-message-size:"+s.maxMessageSize+`\r
`),l.join("")},t.generateSessionId=function(){return Math.random().toString().substr(2,22)},t.writeSessionBoilerplate=function(r,s,l){let f;const m=s!==void 0?s:2;return f=r||t.generateSessionId(),`v=0\r
o=`+(l||"thisisadapterortc")+" "+f+" "+m+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},t.getDirection=function(r,s){const l=t.splitLines(r);for(let f=0;f<l.length;f++)switch(l[f]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return l[f].substring(2)}return s?t.getDirection(s):"sendrecv"},t.getKind=function(r){return t.splitLines(r)[0].split(" ")[0].substring(2)},t.isRejected=function(r){return r.split(" ",2)[1]==="0"},t.parseMLine=function(r){const s=t.splitLines(r)[0].substring(2).split(" ");return{kind:s[0],port:parseInt(s[1],10),protocol:s[2],fmt:s.slice(3).join(" ")}},t.parseOLine=function(r){const s=t.matchPrefix(r,"o=")[0].substring(2).split(" ");return{username:s[0],sessionId:s[1],sessionVersion:parseInt(s[2],10),netType:s[3],addressType:s[4],address:s[5]}},t.isValidSDP=function(r){if(typeof r!="string"||r.length===0)return!1;const s=t.splitLines(r);for(let l=0;l<s.length;l++)if(s[l].length<2||s[l].charAt(1)!=="=")return!1;return!0},e.exports=t})(g9);var _9=g9.exports,lS=T(_9),TH=h({__proto__:null,default:lS},[_9]);function wR(e){if(!e.RTCIceCandidate||e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)return;const t=e.RTCIceCandidate;e.RTCIceCandidate=function(r){if(typeof r=="object"&&r.candidate&&r.candidate.indexOf("a=")===0&&((r=JSON.parse(JSON.stringify(r))).candidate=r.candidate.substr(2)),r.candidate&&r.candidate.length){const s=new t(r),l=lS.parseCandidate(r.candidate),f=Object.assign(s,l);return f.toJSON=function(){return{candidate:f.candidate,sdpMid:f.sdpMid,sdpMLineIndex:f.sdpMLineIndex,usernameFragment:f.usernameFragment}},f}return new t(r)},e.RTCIceCandidate.prototype=t.prototype,cS(e,"icecandidate",r=>(r.candidate&&Object.defineProperty(r,"candidate",{value:new e.RTCIceCandidate(r.candidate),writable:"false"}),r))}function zk(e){!e.RTCIceCandidate||e.RTCIceCandidate&&"relayProtocol"in e.RTCIceCandidate.prototype||cS(e,"icecandidate",t=>{if(t.candidate){const r=lS.parseCandidate(t.candidate.candidate);r.type==="relay"&&(t.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[r.priority>>24])}return t})}function pN(e,t){if(!e.RTCPeerConnection)return;"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get(){return this._sctp===void 0?null:this._sctp}});const r=function(E){if(!E||!E.sdp)return!1;const y=lS.splitSections(E.sdp);return y.shift(),y.some(b=>{const A=lS.parseMLine(b);return A&&A.kind==="application"&&A.protocol.indexOf("SCTP")!==-1})},s=function(E){const y=E.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(y===null||y.length<2)return-1;const b=parseInt(y[1],10);return b!=b?-1:b},l=function(E){let y=65536;return t.browser==="firefox"&&(y=t.version<57?E===-1?16384:2147483637:t.version<60?t.version===57?65535:65536:2147483637),y},f=function(E,y){let b=65536;t.browser==="firefox"&&t.version===57&&(b=65535);const A=lS.matchPrefix(E.sdp,"a=max-message-size:");return A.length>0?b=parseInt(A[0].substr(19),10):t.browser==="firefox"&&y!==-1&&(b=2147483637),b},m=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,t.browser==="chrome"&&t.version>=76){const{sdpSemantics:E}=this.getConfiguration();E==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return this._sctp===void 0?null:this._sctp},enumerable:!0,configurable:!0})}if(r(arguments[0])){const E=s(arguments[0]),y=l(E),b=f(arguments[0],E);let A;A=y===0&&b===0?Number.POSITIVE_INFINITY:y===0||b===0?Math.max(y,b):Math.min(y,b);const O={};Object.defineProperty(O,"maxMessageSize",{get:()=>A}),this._sctp=O}return m.apply(this,arguments)}}function mN(e){if(!e.RTCPeerConnection||!("createDataChannel"in e.RTCPeerConnection.prototype))return;function t(s,l){const f=s.send;s.send=function(){const m=arguments[0],E=m.length||m.size||m.byteLength;if(s.readyState==="open"&&l.sctp&&E>l.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+l.sctp.maxMessageSize+" bytes)");return f.apply(s,arguments)}}const r=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){const s=r.apply(this,arguments);return t(s,this),s},cS(e,"datachannel",s=>(t(s.channel,s.target),s))}function Hk(e){if(!e.RTCPeerConnection||"connectionState"in e.RTCPeerConnection.prototype)return;const t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(r){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),r&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=r)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(r=>{const s=t[r];t[r]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=l=>{const f=l.target;if(f._lastConnectionState!==f.connectionState){f._lastConnectionState=f.connectionState;const m=new Event("connectionstatechange",l);f.dispatchEvent(m)}return l},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),s.apply(this,arguments)}})}function Wk(e,t){if(!e.RTCPeerConnection||t.browser==="chrome"&&t.version>=71||t.browser==="safari"&&t.version>=605)return;const r=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(s){if(s&&s.sdp&&s.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const l=s.sdp.split(`
`).filter(f=>Eo(f).call(f)!=="a=extmap-allow-mixed").join(`
`);e.RTCSessionDescription&&s instanceof e.RTCSessionDescription?arguments[0]=new e.RTCSessionDescription({type:s.type,sdp:l}):s.sdp=l}return r.apply(this,arguments)}}function gN(e,t){if(!e.RTCPeerConnection||!e.RTCPeerConnection.prototype)return;const r=e.RTCPeerConnection.prototype.addIceCandidate;r&&r.length!==0&&(e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(t.browser==="chrome"&&t.version<78||t.browser==="firefox"&&t.version<68||t.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?gt.resolve():r.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),gt.resolve())})}function _N(e,t){if(!e.RTCPeerConnection||!e.RTCPeerConnection.prototype)return;const r=e.RTCPeerConnection.prototype.setLocalDescription;r&&r.length!==0&&(e.RTCPeerConnection.prototype.setLocalDescription=function(){let s=arguments[0]||{};if(typeof s!="object"||s.type&&s.sdp)return r.apply(this,arguments);if(s={type:s.type,sdp:s.sdp},!s.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":s.type="offer";break;default:s.type="answer"}return s.sdp||s.type!=="offer"&&s.type!=="answer"?r.apply(this,[s]):(s.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(l=>r.apply(this,[l]))})}var bH=Object.freeze({__proto__:null,removeExtmapAllowMixed:Wk,shimAddIceCandidateNullOrEmpty:gN,shimConnectionState:Hk,shimMaxMessageSize:pN,shimParameterlessSetLocalDescription:_N,shimRTCIceCandidate:wR,shimRTCIceCandidateRelayProtocol:zk,shimSendThrowTypeError:mN});(function(){let{window:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0};const r=XV,s=function(f){const m={browser:null,version:null};if(f===void 0||!f.navigator)return m.browser="Not a browser.",m;const{navigator:E}=f;if(E.mozGetUserMedia)m.browser="firefox",m.version=sN(E.userAgent,/Firefox\/(\d+)\./,1);else if(E.webkitGetUserMedia||f.isSecureContext===!1&&f.webkitRTCPeerConnection)m.browser="chrome",m.version=sN(E.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else{if(!f.RTCPeerConnection||!E.userAgent.match(/AppleWebKit\/(\d+)\./))return m.browser="Not a supported browser.",m;m.browser="safari",m.version=sN(E.userAgent,/AppleWebKit\/(\d+)\./,1),m.supportsUnifiedPlan=f.RTCRtpTransceiver&&"currentDirection"in f.RTCRtpTransceiver.prototype}return m}(e),l={browserDetails:s,commonShim:bH,extractVersion:sN,disableLog:hH,disableWarnings:Ak,sdp:TH};switch(s.browser){case"chrome":if(!Lk||!dN||!t.shimChrome)return r("Chrome shim is not included in this adapter release."),l;if(s.version===null)return r("Chrome shim can not determine version, not shimming."),l;r("adapter.js shimming chrome."),l.browserShim=Lk,gN(e,s),_N(e),oN(e,s),SR(e),dN(e,s),yR(e),ZV(e,s),cN(e),lN(e),TR(e),$V(e,s),wR(e),zk(e),Hk(e),pN(e,s),mN(e),Wk(e,s);break;case"firefox":if(!fN||!uN||!t.shimFirefox)return r("Firefox shim is not included in this adapter release."),l;r("adapter.js shimming firefox."),l.browserShim=fN,gN(e,s),_N(e),e9(e,s),uN(e,s),t9(e),Dk(e),n9(e),r9(e),i9(e),a9(e),Pk(e),s9(e),Mk(e),wR(e),Hk(e),pN(e,s),mN(e);break;case"safari":if(!u9||!t.shimSafari)return r("Safari shim is not included in this adapter release."),l;r("adapter.js shimming safari."),l.browserShim=u9,gN(e,s),_N(e),Uk(e),jk(e),kk(e),o9(e),c9(e),Cg(e),l9(e),d9(e),wR(e),zk(e),pN(e,s),mN(e),Wk(e,s);break;default:r("Unsupported browser!")}})({window:typeof window>"u"?void 0:window});var Yk=X;pr({global:!0,forced:Yk.globalThis!==Yk},{globalThis:Yk});var Kk=T(X),EN={exports:{}};(function(e,t){(function(r,s){var l="function",f="undefined",m="object",E="string",y="major",b="model",A="name",O="type",D="vendor",P="version",F="architecture",B="console",Y="mobile",$="tablet",ee="smarttv",Ee="wearable",Re="embedded",Ie="Amazon",we="Apple",Ue="ASUS",ve="BlackBerry",Ne="Browser",Ve="Chrome",Be="Firefox",W="Google",ce="Huawei",Se="LG",Xe="Microsoft",en="Motorola",He="Opera",tt="Samsung",St="Sharp",Ze="Sony",J="Xiaomi",_e="Zebra",be="Facebook",ot="Chromium OS",an="Mac OS",hr=" Browser",Bi=function(ha){for(var Ka={},_i=0;_i<ha.length;_i++)Ka[ha[_i].toUpperCase()]=ha[_i];return Ka},Hr=function(ha,Ka){return typeof ha===E&&gi(Ka).indexOf(gi(ha))!==-1},gi=function(ha){return ha.toLowerCase()},Wr=function(ha,Ka){if(typeof ha===E)return ha=ha.replace(/^\s\s*/,""),typeof Ka===f?ha:ha.substring(0,500)},Ws=function(ha,Ka){for(var _i,md,s0,ba,ny,$n,o0=0;o0<Ka.length&&!ny;){var TA=Ka[o0],oE=Ka[o0+1];for(_i=md=0;_i<TA.length&&!ny&&TA[_i];)if(ny=TA[_i++].exec(ha))for(s0=0;s0<oE.length;s0++)$n=ny[++md],typeof(ba=oE[s0])===m&&ba.length>0?ba.length===2?typeof ba[1]==l?this[ba[0]]=ba[1].call(this,$n):this[ba[0]]=ba[1]:ba.length===3?typeof ba[1]!==l||ba[1].exec&&ba[1].test?this[ba[0]]=$n?$n.replace(ba[1],ba[2]):s:this[ba[0]]=$n?ba[1].call(this,$n,ba[2]):s:ba.length===4&&(this[ba[0]]=$n?ba[3].call(this,$n.replace(ba[1],ba[2])):s):this[ba]=$n||s;o0+=2}},Ml=function(ha,Ka){for(var _i in Ka)if(typeof Ka[_i]===m&&Ka[_i].length>0){for(var md=0;md<Ka[_i].length;md++)if(Hr(Ka[_i][md],ha))return _i==="?"?s:_i}else if(Hr(Ka[_i],ha))return _i==="?"?s:_i;return Ka.hasOwnProperty("*")?Ka["*"]:ha},Fi={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},Zn={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[P,[A,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[P,[A,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[A,P],[/opios[\/ ]+([\w\.]+)/i],[P,[A,He+" Mini"]],[/\bop(?:rg)?x\/([\w\.]+)/i],[P,[A,He+" GX"]],[/\bopr\/([\w\.]+)/i],[P,[A,He]],[/\bb[ai]*d(?:uhd|[ub]*[aekoprswx]{5,6})[\/ ]?([\w\.]+)/i],[P,[A,"Baidu"]],[/\b(?:mxbrowser|mxios|myie2)\/?([-\w\.]*)\b/i],[P,[A,"Maxthon"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer|sleipnir)[\/ ]?([\w\.]*)/i,/(avant|iemobile|slim(?:browser|boat|jet))[\/ ]?([\d\.]*)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|duckduckgo|klar|helio|(?=comodo_)?dragon)\/([-\w\.]+)/i,/(heytap|ovi|115)browser\/([\d\.]+)/i,/(weibo)__([\d\.]+)/i],[A,P],[/quark(?:pc)?\/([-\w\.]+)/i],[P,[A,"Quark"]],[/\bddg\/([\w\.]+)/i],[P,[A,"DuckDuckGo"]],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[P,[A,"UC"+Ne]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i,/micromessenger\/([\w\.]+)/i],[P,[A,"WeChat"]],[/konqueror\/([\w\.]+)/i],[P,[A,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[P,[A,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[P,[A,"Yandex"]],[/slbrowser\/([\w\.]+)/i],[P,[A,"Smart Lenovo "+Ne]],[/(avast|avg)\/([\w\.]+)/i],[[A,/(.+)/,"$1 Secure "+Ne],P],[/\bfocus\/([\w\.]+)/i],[P,[A,Be+" Focus"]],[/\bopt\/([\w\.]+)/i],[P,[A,He+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[P,[A,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[P,[A,"Dolphin"]],[/coast\/([\w\.]+)/i],[P,[A,He+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[P,[A,"MIUI"+hr]],[/fxios\/([\w\.-]+)/i],[P,[A,Be]],[/\bqihoobrowser\/?([\w\.]*)/i],[P,[A,"360"]],[/\b(qq)\/([\w\.]+)/i],[[A,/(.+)/,"$1Browser"],P],[/(oculus|sailfish|huawei|vivo|pico)browser\/([\w\.]+)/i],[[A,/(.+)/,"$1"+hr],P],[/samsungbrowser\/([\w\.]+)/i],[P,[A,tt+" Internet"]],[/metasr[\/ ]?([\d\.]+)/i],[P,[A,"Sogou Explorer"]],[/(sogou)mo\w+\/([\d\.]+)/i],[[A,"Sogou Mobile"],P],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|2345(?=browser|chrome|explorer))\w*[\/ ]?v?([\w\.]+)/i],[A,P],[/(lbbrowser|rekonq)/i,/\[(linkedin)app\]/i],[A],[/ome\/([\w\.]+) \w* ?(iron) saf/i,/ome\/([\w\.]+).+qihu (360)[es]e/i],[P,A],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[A,be],P],[/(Klarna)\/([\w\.]+)/i,/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(alipay)client\/([\w\.]+)/i,/(twitter)(?:and| f.+e\/([\w\.]+))/i,/(chromium|instagram|snapchat)[\/ ]([-\w\.]+)/i],[A,P],[/\bgsa\/([\w\.]+) .*safari\//i],[P,[A,"GSA"]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[P,[A,"TikTok"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[P,[A,Ve+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[A,Ve+" WebView"],P],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[P,[A,"Android "+Ne]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[A,P],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[P,[A,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[P,A],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[A,[P,Ml,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[A,P],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[A,"Netscape"],P],[/(wolvic|librewolf)\/([\w\.]+)/i],[A,P],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[P,[A,Be+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i],[A,[P,/_/g,"."]],[/(cobalt)\/([\w\.]+)/i],[A,[P,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[F,"amd64"]],[/(ia32(?=;))/i],[[F,gi]],[/((?:i[346]|x)86)[;\)]/i],[[F,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[F,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[F,"armhf"]],[/windows (ce|mobile); ppc;/i],[[F,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[F,/ower/,"",gi]],[/(sun4\w)[;\)]/i],[[F,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[F,gi]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[b,[D,tt],[O,$]],[/\b((?:s[cgp]h|gt|sm)-(?![lr])\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]((?!sm-[lr])[-\w]+)/i,/sec-(sgh\w+)/i],[b,[D,tt],[O,Y]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)(?:\/|;)/i],[b,[D,we],[O,Y]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[b,[D,we],[O,$]],[/(macintosh);/i],[b,[D,we]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[b,[D,St],[O,Y]],[/(?:honor)([-\w ]+)[;\)]/i],[b,[D,"Honor"],[O,Y]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[b,[D,ce],[O,$]],[/(?:huawei)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[b,[D,ce],[O,Y]],[/\b(poco[\w ]+|m2\d{3}j\d\d[a-z]{2})(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/oid[^\)]+; (m?[12][0-389][01]\w{3,6}[c-y])( bui|; wv|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite|pro)?)(?: bui|\))/i],[[b,/_/g," "],[D,J],[O,Y]],[/oid[^\)]+; (2\d{4}(283|rpbf)[cgl])( bui|\))/i,/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[b,/_/g," "],[D,J],[O,$]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[b,[D,"OPPO"],[O,Y]],[/\b(opd2\d{3}a?) bui/i],[b,[D,"OPPO"],[O,$]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[b,[D,"Vivo"],[O,Y]],[/\b(rmx[1-3]\d{3})(?: bui|;|\))/i],[b,[D,"Realme"],[O,Y]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[b,[D,en],[O,Y]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[b,[D,en],[O,$]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[b,[D,Se],[O,$]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[b,[D,Se],[O,Y]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[b,[D,"Lenovo"],[O,$]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[b,/_/g," "],[D,"Nokia"],[O,Y]],[/(pixel c)\b/i],[b,[D,W],[O,$]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[b,[D,W],[O,Y]],[/droid.+; (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[b,[D,Ze],[O,Y]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[b,"Xperia Tablet"],[D,Ze],[O,$]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[b,[D,"OnePlus"],[O,Y]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo(?!bc)\w\w)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[b,[D,Ie],[O,$]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[b,/(.+)/g,"Fire Phone $1"],[D,Ie],[O,Y]],[/(playbook);[-\w\),; ]+(rim)/i],[b,D,[O,$]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[b,[D,ve],[O,Y]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[b,[D,Ue],[O,$]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[b,[D,Ue],[O,Y]],[/(nexus 9)/i],[b,[D,"HTC"],[O,$]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[D,[b,/_/g," "],[O,Y]],[/droid [\w\.]+; ((?:8[14]9[16]|9(?:0(?:48|60|8[01])|1(?:3[27]|66)|2(?:6[69]|9[56])|466))[gqswx])\w*(\)| bui)/i],[b,[D,"TCL"],[O,$]],[/(itel) ((\w+))/i],[[D,gi],b,[O,Ml,{tablet:["p10001l","w7001"],"*":"mobile"}]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[b,[D,"Acer"],[O,$]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[b,[D,"Meizu"],[O,Y]],[/; ((?:power )?armor(?:[\w ]{0,8}))(?: bui|\))/i],[b,[D,"Ulefone"],[O,Y]],[/; (energy ?\w+)(?: bui|\))/i,/; energizer ([\w ]+)(?: bui|\))/i],[b,[D,"Energizer"],[O,Y]],[/; cat (b35);/i,/; (b15q?|s22 flip|s48c|s62 pro)(?: bui|\))/i],[b,[D,"Cat"],[O,Y]],[/((?:new )?andromax[\w- ]+)(?: bui|\))/i],[b,[D,"Smartfren"],[O,Y]],[/droid.+; (a(?:015|06[35]|142p?))/i],[b,[D,"Nothing"],[O,Y]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron|infinix|tecno|micromax|advan)[-_ ]?([-\w]*)/i,/; (imo) ((?!tab)[\w ]+?)(?: bui|\))/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[D,b,[O,Y]],[/(imo) (tab \w+)/i,/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[D,b,[O,$]],[/(surface duo)/i],[b,[D,Xe],[O,$]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[b,[D,"Fairphone"],[O,Y]],[/(u304aa)/i],[b,[D,"AT&T"],[O,Y]],[/\bsie-(\w*)/i],[b,[D,"Siemens"],[O,Y]],[/\b(rct\w+) b/i],[b,[D,"RCA"],[O,$]],[/\b(venue[\d ]{2,7}) b/i],[b,[D,"Dell"],[O,$]],[/\b(q(?:mv|ta)\w+) b/i],[b,[D,"Verizon"],[O,$]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[b,[D,"Barnes & Noble"],[O,$]],[/\b(tm\d{3}\w+) b/i],[b,[D,"NuVision"],[O,$]],[/\b(k88) b/i],[b,[D,"ZTE"],[O,$]],[/\b(nx\d{3}j) b/i],[b,[D,"ZTE"],[O,Y]],[/\b(gen\d{3}) b.+49h/i],[b,[D,"Swiss"],[O,Y]],[/\b(zur\d{3}) b/i],[b,[D,"Swiss"],[O,$]],[/\b((zeki)?tb.*\b) b/i],[b,[D,"Zeki"],[O,$]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[D,"Dragon Touch"],b,[O,$]],[/\b(ns-?\w{0,9}) b/i],[b,[D,"Insignia"],[O,$]],[/\b((nxa|next)-?\w{0,9}) b/i],[b,[D,"NextBook"],[O,$]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[D,"Voice"],b,[O,Y]],[/\b(lvtel\-)?(v1[12]) b/i],[[D,"LvTel"],b,[O,Y]],[/\b(ph-1) /i],[b,[D,"Essential"],[O,Y]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[b,[D,"Envizen"],[O,$]],[/\b(trio[-\w\. ]+) b/i],[b,[D,"MachSpeed"],[O,$]],[/\btu_(1491) b/i],[b,[D,"Rotor"],[O,$]],[/(shield[\w ]+) b/i],[b,[D,"Nvidia"],[O,$]],[/(sprint) (\w+)/i],[D,b,[O,Y]],[/(kin\.[onetw]{3})/i],[[b,/\./g," "],[D,Xe],[O,Y]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[b,[D,_e],[O,$]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[b,[D,_e],[O,Y]],[/smart-tv.+(samsung)/i],[D,[O,ee]],[/hbbtv.+maple;(\d+)/i],[[b,/^/,"SmartTV"],[D,tt],[O,ee]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[D,Se],[O,ee]],[/(apple) ?tv/i],[D,[b,we+" TV"],[O,ee]],[/crkey/i],[[b,Ve+"cast"],[D,W],[O,ee]],[/droid.+aft(\w+)( bui|\))/i],[b,[D,Ie],[O,ee]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[b,[D,St],[O,ee]],[/(bravia[\w ]+)( bui|\))/i],[b,[D,Ze],[O,ee]],[/(mitv-\w{5}) bui/i],[b,[D,J],[O,ee]],[/Hbbtv.*(technisat) (.*);/i],[D,b,[O,ee]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[D,Wr],[b,Wr],[O,ee]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[O,ee]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[D,b,[O,B]],[/droid.+; (shield) bui/i],[b,[D,"Nvidia"],[O,B]],[/(playstation [345portablevi]+)/i],[b,[D,Ze],[O,B]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[b,[D,Xe],[O,B]],[/\b(sm-[lr]\d\d[05][fnuw]?s?)\b/i],[b,[D,tt],[O,Ee]],[/((pebble))app/i],[D,b,[O,Ee]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[b,[D,we],[O,Ee]],[/droid.+; (glass) \d/i],[b,[D,W],[O,Ee]],[/droid.+; (wt63?0{2,3})\)/i],[b,[D,_e],[O,Ee]],[/droid.+; (glass) \d/i],[b,[D,W],[O,Ee]],[/(pico) (4|neo3(?: link|pro)?)/i],[D,b,[O,Ee]],[/; (quest( \d| pro)?)/i],[b,[D,be],[O,Ee]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[D,[O,Re]],[/(aeobc)\b/i],[b,[D,Ie],[O,Re]],[/droid .+?; ([^;]+?)(?: bui|; wv\)|\) applew).+? mobile safari/i],[b,[O,Y]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[b,[O,$]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[O,$]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[O,Y]],[/(android[-\w\. ]{0,9});.+buil/i],[b,[D,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[P,[A,"EdgeHTML"]],[/(arkweb)\/([\w\.]+)/i],[A,P],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[P,[A,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna|servo)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[A,P],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[P,A]],os:[[/microsoft (windows) (vista|xp)/i],[A,P],[/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i],[A,[P,Ml,Fi]],[/windows nt 6\.2; (arm)/i,/windows[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i,/(?:win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[P,Ml,Fi],[A,"Windows"]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/(?:ios;fbsv\/|iphone.+ios[\/ ])([\d\.]+)/i,/cfnetwork\/.+darwin/i],[[P,/_/g,"."],[A,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[A,an],[P,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[P,A],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish|openharmony)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[A,P],[/\(bb(10);/i],[P,[A,ve]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[P,[A,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[P,[A,Be+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[P,[A,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[P,[A,"watchOS"]],[/crkey\/([\d\.]+)/i],[P,[A,Ve+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[A,ot],P],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[A,P],[/(sunos) ?([\w\.\d]*)/i],[[A,"Solaris"],P],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[A,P]]},Ta=function(ha,Ka){if(typeof ha===m&&(Ka=ha,ha=s),!(this instanceof Ta))return new Ta(ha,Ka).getResult();var _i=typeof r!==f&&r.navigator?r.navigator:s,md=ha||(_i&&_i.userAgent?_i.userAgent:""),s0=_i&&_i.userAgentData?_i.userAgentData:s,ba=Ka?function($n,o0){var TA={};for(var oE in $n)o0[oE]&&o0[oE].length%2==0?TA[oE]=o0[oE].concat($n[oE]):TA[oE]=$n[oE];return TA}(Zn,Ka):Zn,ny=_i&&_i.userAgent==md;return this.getBrowser=function(){var $n={};return $n[A]=s,$n[P]=s,Ws.call($n,md,ba.browser),$n[y]=function(o0){return typeof o0===E?o0.replace(/[^\d\.]/g,"").split(".")[0]:s}($n[P]),ny&&_i&&_i.brave&&typeof _i.brave.isBrave==l&&($n[A]="Brave"),$n},this.getCPU=function(){var $n={};return $n[F]=s,Ws.call($n,md,ba.cpu),$n},this.getDevice=function(){var $n={};return $n[D]=s,$n[b]=s,$n[O]=s,Ws.call($n,md,ba.device),ny&&!$n[O]&&s0&&s0.mobile&&($n[O]=Y),ny&&$n[b]=="Macintosh"&&_i&&typeof _i.standalone!==f&&_i.maxTouchPoints&&_i.maxTouchPoints>2&&($n[b]="iPad",$n[O]=$),$n},this.getEngine=function(){var $n={};return $n[A]=s,$n[P]=s,Ws.call($n,md,ba.engine),$n},this.getOS=function(){var $n={};return $n[A]=s,$n[P]=s,Ws.call($n,md,ba.os),ny&&!$n[A]&&s0&&s0.platform&&s0.platform!="Unknown"&&($n[A]=s0.platform.replace(/chrome os/i,ot).replace(/macos/i,an)),$n},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return md},this.setUA=function($n){return md=typeof $n===E&&$n.length>500?Wr($n,500):$n,this},this.setUA(md),this};Ta.VERSION="0.7.40",Ta.BROWSER=Bi([A,P,y]),Ta.CPU=Bi([F]),Ta.DEVICE=Bi([b,D,O,B,Y,ee,$,Ee,Re]),Ta.ENGINE=Ta.OS=Bi([A,P]),e.exports&&(t=e.exports=Ta),t.UAParser=Ta;var $c=typeof r!==f&&(r.jQuery||r.Zepto);if($c&&!$c.ua){var pd=new Ta;$c.ua=pd.getResult(),$c.ua.get=function(){return pd.getUA()},$c.ua.set=function(ha){pd.setUA(ha);var Ka=pd.getResult();for(var _i in Ka)$c.ua[_i]=Ka[_i]}}})(typeof window=="object"?window:g)})(EN,EN.exports);var CH=T(EN.exports),qk=Ud.clear;pr({global:!0,bind:!0,forced:X.clearImmediate!==qk},{clearImmediate:qk});var Jk=X,wH=ue,RH=We,IH=Mm,AH=Tr,OH=xo,NH=Oc,E9=Jk.Function,v9=/MSIE .\./.test(AH)||IH==="BUN"&&function(){var e=Jk.Bun.version.split(".");return e.length<3||e[0]==="0"&&(e[1]<3||e[1]==="3"&&e[2]==="0")}(),LH=pr,vN=X,RR=Ud.set,Xk=function(e,t){var r=1;return v9?function(s,l){var f=NH(arguments.length,1)>r,m=RH(s)?s:E9(s),E=f?OH(arguments,r):[],y=f?function(){wH(m,this,E)}:m;return e(y)}:e},qu=vN.setImmediate?Xk(RR):RR;LH({global:!0,bind:!0,forced:vN.setImmediate!==qu},{setImmediate:qu});var IR=T(Ii.setImmediate),gb=X,AR=og,S9=os,DH=Oc,Hd=$e;pr({global:!0,dontCallGetSet:!0,forced:I(function(){return Hd&&Object.getOwnPropertyDescriptor(gb,"queueMicrotask").value.length!==1})},{queueMicrotask:function(e){DH(arguments.length,1),AR(S9(e))}});var Qk=T(Ii.queueMicrotask);function OR(e,t){return function(){return e.apply(t,arguments)}}const{toString:SN}=Object.prototype,{getPrototypeOf:Zk}=Object,{iterator:yN,toStringTag:y9}=Symbol,TN=($k=Object.create(null),e=>{const t=SN.call(e);return $k[t]||($k[t]=t.slice(8,-1).toLowerCase())});var $k;const ch=e=>(e=e.toLowerCase(),t=>TN(t)===e),bN=e=>t=>typeof t===e,{isArray:_b}=Array,NR=bN("undefined"),Eb=ch("ArrayBuffer"),T9=bN("string"),$s=bN("function"),e4=bN("number"),CN=e=>e!==null&&typeof e=="object",vb=e=>{if(TN(e)!=="object")return!1;const t=Zk(e);return!(t!==null&&t!==Object.prototype&&Object.getPrototypeOf(t)!==null||y9 in e||yN in e)},PH=ch("Date"),b9=ch("File"),MH=ch("Blob"),C9=ch("FileList"),t4=ch("URLSearchParams"),[w9,R9,kH,I9]=["ReadableStream","Request","Response","Headers"].map(ch);function Sb(e,t){let r,s,{allOwnKeys:l=!1}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(e!=null)if(typeof e!="object"&&(e=[e]),_b(e))for(r=0,s=e.length;r<s;r++)t.call(null,e[r],r,e);else{const f=l?Object.getOwnPropertyNames(e):Object.keys(e),m=f.length;let E;for(r=0;r<m;r++)E=f[r],t.call(null,e[E],E,e)}}function n4(e,t){t=t.toLowerCase();const r=Object.keys(e);let s,l=r.length;for(;l-- >0;)if(s=r[l],t===s.toLowerCase())return s;return null}const wg=Kk!==void 0?Kk:typeof self<"u"?self:typeof window<"u"?window:r5,LR=e=>!NR(e)&&e!==wg,xH=(_t=typeof Uint8Array<"u"&&Zk(Uint8Array),e=>_t&&e instanceof _t);var _t;const Mr=ch("HTMLFormElement"),r4=(e=>{let{hasOwnProperty:t}=e;return(r,s)=>t.call(r,s)})(Object.prototype),A9=ch("RegExp"),wN=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),s={};Sb(r,(l,f)=>{let m;(m=t(l,f,e))!==!1&&(s[f]=m||l)}),Object.defineProperties(e,s)},O9=ch("AsyncFunction"),i4=(N9=typeof IR=="function",DR=$s(wg.postMessage),N9?IR:DR?(RN="axios@".concat(Math.random()),yb=[],wg.addEventListener("message",e=>{let{source:t,data:r}=e;t===wg&&r===RN&&yb.length&&yb.shift()()},!1),e=>{yb.push(e),wg.postMessage(RN,"*")}):e=>setTimeout(e));var N9,DR,RN,yb;const L9=Qk!==void 0?Qk.bind(wg):typeof process<"u"&&process.nextTick||i4;var mt={isArray:_b,isArrayBuffer:Eb,isBuffer:function(e){return e!==null&&!NR(e)&&e.constructor!==null&&!NR(e.constructor)&&$s(e.constructor.isBuffer)&&e.constructor.isBuffer(e)},isFormData:e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||$s(e.append)&&((t=TN(e))==="formdata"||t==="object"&&$s(e.toString)&&e.toString()==="[object FormData]"))},isArrayBufferView:function(e){let t;return t=typeof ArrayBuffer<"u"&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&Eb(e.buffer),t},isString:T9,isNumber:e4,isBoolean:e=>e===!0||e===!1,isObject:CN,isPlainObject:vb,isReadableStream:w9,isRequest:R9,isResponse:kH,isHeaders:I9,isUndefined:NR,isDate:PH,isFile:b9,isBlob:MH,isRegExp:A9,isFunction:$s,isStream:e=>CN(e)&&$s(e.pipe),isURLSearchParams:t4,isTypedArray:xH,isFileList:C9,forEach:Sb,merge:function e(){const{caseless:t}=LR(this)&&this||{},r={},s=(l,f)=>{const m=t&&n4(r,f)||f;vb(r[m])&&vb(l)?r[m]=e(r[m],l):vb(l)?r[m]=e({},l):_b(l)?r[m]=l.slice():r[m]=l};for(let l=0,f=arguments.length;l<f;l++)arguments[l]&&Sb(arguments[l],s);return r},extend:function(e,t,r){let{allOwnKeys:s}=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return Sb(t,(l,f)=>{r&&$s(l)?e[f]=OR(l,r):e[f]=l},{allOwnKeys:s}),e},trim:e=>Eo(e)?Eo(e).call(e):e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),inherits:(e,t,r,s)=>{e.prototype=Object.create(t.prototype,s),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},toFlatObject:(e,t,r,s)=>{let l,f,m;const E={};if(t=t||{},e==null)return t;do{for(l=Object.getOwnPropertyNames(e),f=l.length;f-- >0;)m=l[f],s&&!s(m,e,t)||E[m]||(t[m]=e[m],E[m]=!0);e=r!==!1&&Zk(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},kindOf:TN,kindOfTest:ch,endsWith:(e,t,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=t.length;const s=e.indexOf(t,r);return s!==-1&&s===r},toArray:e=>{if(!e)return null;if(_b(e))return e;let t=e.length;if(!e4(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},forEachEntry:(e,t)=>{const r=(e&&e[yN]).call(e);let s;for(;(s=r.next())&&!s.done;){const l=s.value;t.call(e,l[0],l[1])}},matchAll:(e,t)=>{let r;const s=[];for(;(r=e.exec(t))!==null;)s.push(r);return s},isHTMLForm:Mr,hasOwnProperty:r4,hasOwnProp:r4,reduceDescriptors:wN,freezeMethods:e=>{wN(e,(t,r)=>{if($s(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const s=e[r];$s(s)&&(t.enumerable=!1,"writable"in t?t.writable=!1:t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")}))})},toObjectSet:(e,t)=>{const r={},s=l=>{l.forEach(f=>{r[f]=!0})};return _b(e)?s(e):s(String(e).split(t)),r},toCamelCase:e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,r,s){return r.toUpperCase()+s}),noop:()=>{},toFiniteNumber:(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t,findKey:n4,global:wg,isContextDefined:LR,isSpecCompliantForm:function(e){return!!(e&&$s(e.append)&&e[y9]==="FormData"&&e[yN])},toJSONObject:e=>{const t=new Array(10),r=(s,l)=>{if(CN(s)){if(t.indexOf(s)>=0)return;if(!("toJSON"in s)){t[l]=s;const f=_b(s)?[]:{};return Sb(s,(m,E)=>{const y=r(m,l+1);!NR(y)&&(f[E]=y)}),t[l]=void 0,f}}return s};return r(e,0)},isAsyncFn:O9,isThenable:e=>e&&(CN(e)||$s(e))&&$s(e.then)&&$s(e.catch),setImmediate:i4,asap:L9,isIterable:e=>e!=null&&$s(e[yN])};function Dr(e,t,r,s,l){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),s&&(this.request=s),l&&(this.response=l,this.status=l.status?l.status:null)}mt.inherits(Dr,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:mt.toJSONObject(this.config),code:this.code,status:this.status}}});const a4=Dr.prototype,s4={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{s4[e]={value:e}}),Object.defineProperties(Dr,s4),Object.defineProperty(a4,"isAxiosError",{value:!0}),Dr.from=(e,t,r,s,l,f)=>{const m=Object.create(a4);return mt.toFlatObject(e,m,function(E){return E!==Error.prototype},E=>E!=="isAxiosError"),Dr.call(m,e.message,t,r,s,l),m.cause=e,m.name=e.name,f&&Object.assign(m,f),m};function IN(e){return mt.isPlainObject(e)||mt.isArray(e)}function D9(e){return mt.endsWith(e,"[]")?e.slice(0,-2):e}function P9(e,t,r){return e?e.concat(t).map(function(s,l){return s=D9(s),!r&&l?"["+s+"]":s}).join(r?".":""):t}const M9=mt.toFlatObject(mt,{},null,function(e){return/^is[A-Z]/.test(e)});function PR(e,t,r){if(!mt.isObject(e))throw new TypeError("target must be an object");t=t||new FormData;const s=(r=mt.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(D,P){return!mt.isUndefined(P[D])})).metaTokens,l=r.visitor||b,f=r.dots,m=r.indexes,E=(r.Blob||typeof Blob<"u"&&Blob)&&mt.isSpecCompliantForm(t);if(!mt.isFunction(l))throw new TypeError("visitor must be a function");function y(D){if(D===null)return"";if(mt.isDate(D))return D.toISOString();if(!E&&mt.isBlob(D))throw new Dr("Blob is not supported. Use a Buffer instead.");return mt.isArrayBuffer(D)||mt.isTypedArray(D)?E&&typeof Blob=="function"?new Blob([D]):Buffer.from(D):D}function b(D,P,F){let B=D;if(D&&!F&&typeof D=="object"){if(mt.endsWith(P,"{}"))P=s?P:P.slice(0,-2),D=JSON.stringify(D);else if(mt.isArray(D)&&function(Y){return mt.isArray(Y)&&!Y.some(IN)}(D)||(mt.isFileList(D)||mt.endsWith(P,"[]"))&&(B=mt.toArray(D)))return P=D9(P),B.forEach(function(Y,$){!mt.isUndefined(Y)&&Y!==null&&t.append(m===!0?P9([P],$,f):m===null?P:P+"[]",y(Y))}),!1}return!!IN(D)||(t.append(P9(F,P,f),y(D)),!1)}const A=[],O=Object.assign(M9,{defaultVisitor:b,convertValue:y,isVisitable:IN});if(!mt.isObject(e))throw new TypeError("data must be an object");return function D(P,F){if(!mt.isUndefined(P)){if(A.indexOf(P)!==-1)throw Error("Circular reference detected in "+F.join("."));A.push(P),mt.forEach(P,function(B,Y){(!(mt.isUndefined(B)||B===null)&&l.call(t,B,mt.isString(Y)?Eo(Y).call(Y):Y,F,O))===!0&&D(B,F?F.concat(Y):[Y])}),A.pop()}}(e),t}function k9(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(r){return t[r]})}function AN(e,t){this._pairs=[],e&&PR(e,this,t)}const x9=AN.prototype;function U9(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function j9(e,t,r){if(!t)return e;const s=r&&r.encode||U9;mt.isFunction(r)&&(r={serialize:r});const l=r&&r.serialize;let f;if(f=l?l(t,r):mt.isURLSearchParams(t)?t.toString():new AN(t,r).toString(s),f){const m=e.indexOf("#");m!==-1&&(e=e.slice(0,m)),e+=(e.indexOf("?")===-1?"?":"&")+f}return e}x9.append=function(e,t){this._pairs.push([e,t])},x9.toString=function(e){const t=e?function(r){return e.call(this,r,k9)}:k9;return this._pairs.map(function(r){return t(r[0])+"="+t(r[1])},"").join("&")};var V9=class{constructor(){this.handlers=[]}use(e,t,r){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!r&&r.synchronous,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){mt.forEach(this.handlers,function(t){t!==null&&e(t)})}},B9={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},o4={exports:{}},UH=pr,F9=$e,G9=mo.f;UH({target:"Object",stat:!0,forced:Object.defineProperty!==G9,sham:!F9},{defineProperty:G9});var z9=Ii.Object,jH=o4.exports=function(e,t,r){return z9.defineProperty(e,t,r)};z9.defineProperty.sham&&(jH.sham=!0);var c4=T(o4.exports),VH=TypeError,H9=Fl,BH=_p,FH=dr,GH=ea("species"),W9=Array,Y9=function(e){var t;return H9(e)&&(t=e.constructor,(BH(t)&&(t===W9||H9(t.prototype))||FH(t)&&(t=t[GH])===null)&&(t=void 0)),t===void 0?W9:t},l4=function(e,t){return new(Y9(e))(t===0?0:t)},zH=I,HH=Fa,WH=ea("species"),d4=function(e){return HH>=51||!zH(function(){var t=[];return(t.constructor={})[WH]=function(){return{foo:1}},t[e](Boolean).foo!==1})},YH=pr,KH=I,K9=Fl,qH=dr,JH=bd,q9=Yh,J9=function(e){if(e>9007199254740991)throw VH("Maximum allowed index exceeded");return e},u4=ZM,Tb=l4,XH=d4,X9=Fa,Q9=ea("isConcatSpreadable"),QH=X9>=51||!KH(function(){var e=[];return e[Q9]=!1,e.concat()[0]!==e}),ZH=function(e){if(!qH(e))return!1;var t=e[Q9];return t!==void 0?!!t:K9(e)};YH({target:"Array",proto:!0,forced:!QH||!XH("concat")},{concat:function(e){var t,r,s,l,f,m=JH(this),E=Tb(m,0),y=0;for(t=-1,s=arguments.length;t<s;t++)if(ZH(f=t===-1?m:arguments[t]))for(l=q9(f),J9(y+l),r=0;r<l;r++,y++)r in f&&u4(E,y,f[r]);else J9(y+1),u4(E,y++,f);return E.length=y,E}});var us={},$H=Te,eW=Ri,Z9=Ru.f,tW=xo,f4=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];us.f=function(e){return f4&&$H(e)==="Window"?function(t){try{return Z9(t)}catch{return tW(f4)}}(e):Z9(eW(e))};var bb={},nW=ea;bb.f=nW;var $9=Ii,rW=Ga,iW=bb,aW=mo.f,ts=function(e){var t=$9.Symbol||($9.Symbol={});rW(t,e)||aW(t,e,{value:iW.f(e)})},ON=qe,h4=Zi,p4=ea,sW=ys,dS=function(){var e=h4("Symbol"),t=e&&e.prototype,r=t&&t.valueOf,s=p4("toPrimitive");t&&!t[s]&&sW(t,s,function(l){return ON(r,this)},{})},Cb=$a,oW=ir,jo=bd,cW=Yh,m4=l4,MR=K([].push),g4=function(e){var t=e===1,r=e===2,s=e===3,l=e===4,f=e===6,m=e===7,E=e===5||f;return function(y,b,A,O){for(var D,P,F=jo(y),B=oW(F),Y=cW(B),$=Cb(b,A),ee=0,Ee=O||m4,Re=t?Ee(y,Y):r||m?Ee(y,0):void 0;Y>ee;ee++)if((E||ee in B)&&(P=$(D=B[ee],ee,F),e))if(t)Re[ee]=P;else if(P)switch(e){case 3:return!0;case 5:return D;case 6:return ee;case 2:MR(Re,D)}else switch(e){case 4:return!1;case 7:MR(Re,D)}return f?-1:s||l?l:Re}},eB={forEach:g4(0)},wb=pr,Rg=X,NN=qe,lW=K,uS=$e,Rb=Td,tB=I,vo=Ga,dW=Q,LN=Ks,kR=Ri,_4=Of,E4=Ls,DN=Pt,fS=zm,nB=P0,uW=Ru,rB=us,fW=Bm,iB=ze,v4=mo,PN=Iu,gl=lt,xR=ys,UR=ga,S4=Vl,y4=za,Ju=Hh,hS=ea,MN=bb,hW=ts,T4=dS,aB=Dd,C_=Ld,jR=eB.forEach,Ql=wa("hidden"),VR="Symbol",Wd="prototype",BR=C_.set,sB=C_.getterFor(VR),Yd=Object[Wd],Ig=Rg.Symbol,Ib=Ig&&Ig[Wd],kN=Rg.RangeError,b4=Rg.TypeError,xN=Rg.QObject,C4=iB.f,w_=v4.f,w4=rB.f,oB=gl.f,cB=lW([].push),Ag=S4("symbols"),FR=S4("op-symbols"),pW=S4("wks"),UN=!xN||!xN[Wd]||!xN[Wd].findChild,lB=function(e,t,r){var s=C4(Yd,t);s&&delete Yd[t],w_(e,t,r),s&&e!==Yd&&w_(Yd,t,s)},GR=uS&&tB(function(){return fS(w_({},"a",{get:function(){return w_(this,"a",{value:7}).a}})).a!==7})?lB:w_,R4=function(e,t){var r=Ag[e]=fS(Ib);return BR(r,{type:VR,tag:e,description:t}),uS||(r.description=t),r},jN=function(e,t,r){e===Yd&&jN(FR,t,r),LN(e);var s=_4(t);return LN(r),vo(Ag,s)?(r.enumerable?(vo(e,Ql)&&e[Ql][s]&&(e[Ql][s]=!1),r=fS(r,{enumerable:DN(0,!1)})):(vo(e,Ql)||w_(e,Ql,DN(1,fS(null))),e[Ql][s]=!0),GR(e,s,r)):w_(e,s,r)},I4=function(e,t){LN(e);var r=kR(t),s=nB(r).concat(A4(r));return jR(s,function(l){uS&&!NN(dB,r,l)||jN(e,l,r[l])}),e},dB=function(e){var t=_4(e),r=NN(oB,this,t);return!(this===Yd&&vo(Ag,t)&&!vo(FR,t))&&(!(r||!vo(this,t)||!vo(Ag,t)||vo(this,Ql)&&this[Ql][t])||r)},uB=function(e,t){var r=kR(e),s=_4(t);if(r!==Yd||!vo(Ag,s)||vo(FR,s)){var l=C4(r,s);return!l||!vo(Ag,s)||vo(r,Ql)&&r[Ql][s]||(l.enumerable=!0),l}},fB=function(e){var t=w4(kR(e)),r=[];return jR(t,function(s){vo(Ag,s)||vo(y4,s)||cB(r,s)}),r},A4=function(e){var t=e===Yd,r=w4(t?FR:kR(e)),s=[];return jR(r,function(l){!vo(Ag,l)||t&&!vo(Yd,l)||cB(s,Ag[l])}),s};Rb||(Ig=function(){if(dW(Ib,this))throw new b4("Symbol is not a constructor");var e=arguments.length&&arguments[0]!==void 0?E4(arguments[0]):void 0,t=Ju(e),r=function(s){var l=this===void 0?Rg:this;l===Yd&&NN(r,FR,s),vo(l,Ql)&&vo(l[Ql],t)&&(l[Ql][t]=!1);var f=DN(1,s);try{GR(l,t,f)}catch(m){if(!(m instanceof kN))throw m;lB(l,t,f)}};return uS&&UN&&GR(Yd,t,{configurable:!0,set:r}),R4(t,e)},xR(Ib=Ig[Wd],"toString",function(){return sB(this).tag}),xR(Ig,"withoutSetter",function(e){return R4(Ju(e),e)}),gl.f=dB,v4.f=jN,PN.f=I4,iB.f=uB,uW.f=rB.f=fB,fW.f=A4,MN.f=function(e){return R4(hS(e),e)},uS&&UR(Ib,"description",{configurable:!0,get:function(){return sB(this).description}})),wb({global:!0,wrap:!0,forced:!Rb,sham:!Rb},{Symbol:Ig}),jR(nB(pW),function(e){hW(e)}),wb({target:VR,stat:!0,forced:!Rb},{useSetter:function(){UN=!0},useSimple:function(){UN=!1}}),wb({target:"Object",stat:!0,forced:!Rb,sham:!uS},{create:function(e,t){return t===void 0?fS(e):I4(fS(e),t)},defineProperty:jN,defineProperties:I4,getOwnPropertyDescriptor:uB}),wb({target:"Object",stat:!0,forced:!Rb},{getOwnPropertyNames:fB}),T4(),aB(Ig,VR),y4[Ql]=!0;var O4=Td&&!!Symbol.for&&!!Symbol.keyFor,mW=pr,hB=Zi,gW=Ga,pB=Ls,mB=Vl,gB=O4,VN=mB("string-to-symbol-registry"),_W=mB("symbol-to-string-registry");mW({target:"Symbol",stat:!0,forced:!gB},{for:function(e){var t=pB(e);if(gW(VN,t))return VN[t];var r=hB("Symbol")(t);return VN[t]=r,_W[r]=t,r}});var zR=pr,_B=Ga,EB=Bh,vB=yu,SB=O4,yB=Vl("symbol-to-string-registry");zR({target:"Symbol",stat:!0,forced:!SB},{keyFor:function(e){if(!EB(e))throw new TypeError(vB(e)+" is not a symbol");if(_B(yB,e))return yB[e]}});var TB=Fl,EW=We,Og=Te,BN=Ls,N4=K([].push),vW=pr,bB=Zi,CB=ue,SW=qe,Ab=K,L4=I,D4=We,P4=Bh,wB=xo,yW=function(e){if(EW(e))return e;if(TB(e)){for(var t=e.length,r=[],s=0;s<t;s++){var l=e[s];typeof l=="string"?N4(r,l):typeof l!="number"&&Og(l)!=="Number"&&Og(l)!=="String"||N4(r,BN(l))}var f=r.length,m=!0;return function(E,y){if(m)return m=!1,y;if(TB(this))return y;for(var b=0;b<f;b++)if(r[b]===E)return y}}},RB=Td,TW=String,R_=bB("JSON","stringify"),FN=Ab(/./.exec),IB=Ab("".charAt),bW=Ab("".charCodeAt),CW=Ab("".replace),wW=Ab(1 .toString),AB=/[\uD800-\uDFFF]/g,M4=/^[\uD800-\uDBFF]$/,OB=/^[\uDC00-\uDFFF]$/,NB=!RB||L4(function(){var e=bB("Symbol")("stringify detection");return R_([e])!=="[null]"||R_({a:e})!=="{}"||R_(Object(e))!=="{}"}),GN=L4(function(){return R_("\uDF06\uD834")!=='"\\udf06\\ud834"'||R_("\uDEAD")!=='"\\udead"'}),RW=function(e,t){var r=wB(arguments),s=yW(t);if(D4(s)||e!==void 0&&!P4(e))return r[1]=function(l,f){if(D4(s)&&(f=SW(s,this,TW(l),f)),!P4(f))return f},CB(R_,null,r)},IW=function(e,t,r){var s=IB(r,t-1),l=IB(r,t+1);return FN(M4,e)&&!FN(OB,l)||FN(OB,e)&&!FN(M4,s)?"\\u"+wW(bW(e,0),16):e};R_&&vW({target:"JSON",stat:!0,forced:NB||GN},{stringify:function(e,t,r){var s=wB(arguments),l=CB(NB?RW:R_,null,s);return GN&&typeof l=="string"?CW(l,AB,IW):l}});var k4=Bm,AW=bd;pr({target:"Object",stat:!0,forced:!Td||I(function(){k4.f(1)})},{getOwnPropertySymbols:function(e){var t=k4.f;return t?t(AW(e)):[]}}),ts("asyncIterator"),ts("hasInstance"),ts("isConcatSpreadable"),ts("iterator"),ts("match"),ts("matchAll"),ts("replace"),ts("search"),ts("species"),ts("split");var LB=dS;ts("toPrimitive"),LB();var OW=Zi,NW=Dd;ts("toStringTag"),NW(OW("Symbol"),"Symbol"),ts("unscopables"),Dd(X.JSON,"JSON",!0);var LW=Ii.Symbol,zN=ea,DB=mo.f,x4=zN("metadata"),PB=Function.prototype;PB[x4]===void 0&&DB(PB,x4,{value:null}),ts("asyncDispose"),ts("dispose"),ts("metadata");var MB=LW,U4=K,HN=Zi("Symbol"),DW=HN.keyFor,kB=U4(HN.prototype.valueOf),j4=HN.isRegisteredSymbol||function(e){try{return DW(kB(e))!==void 0}catch{return!1}};pr({target:"Symbol",stat:!0},{isRegisteredSymbol:j4});for(var Ob=Vl,V4=Zi,HR=K,PW=Bh,MW=ea,re=V4("Symbol"),B4=re.isWellKnownSymbol,xB=V4("Object","getOwnPropertyNames"),F4=HR(re.prototype.valueOf),WN=Ob("wks"),G4=0,UB=xB(re),kW=UB.length;G4<kW;G4++)try{var z4=UB[G4];PW(re[z4])&&MW(z4)}catch{}var H4=function(e){if(B4&&B4(e))return!0;try{for(var t=F4(e),r=0,s=xB(WN),l=s.length;r<l;r++)if(WN[s[r]]==t)return!0}catch{}return!1};pr({target:"Symbol",stat:!0,forced:!0},{isWellKnownSymbol:H4}),ts("customMatcher"),ts("observable"),pr({target:"Symbol",stat:!0},{isRegistered:j4}),pr({target:"Symbol",stat:!0,forced:!0},{isWellKnown:H4}),ts("matcher"),ts("metadataKey"),ts("patternMatch"),ts("replaceAll");var Vs=T(MB),jB=T(bb.f("iterator"));function WR(e){return WR=typeof Vs=="function"&&typeof jB=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Vs=="function"&&t.constructor===Vs&&t!==Vs.prototype?"symbol":typeof t},WR(e)}var xW=T(bb.f("toPrimitive"));function UW(e){var t=function(r,s){if(WR(r)!="object"||!r)return r;var l=r[xW];if(l!==void 0){var f=l.call(r,s);if(WR(f)!="object")return f;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(r)}(e,"string");return WR(t)=="symbol"?t:t+""}function ne(e,t,r){return(t=UW(t))in e?c4(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var W4=T(qM),VB={isBrowser:!0,classes:{URLSearchParams:W4!==void 0?W4:AN,FormData:typeof FormData<"u"?FormData:null,Blob:typeof Blob<"u"?Blob:null},protocols:["http","https","file","blob","url","data"]};const Y4=typeof window<"u"&&typeof document<"u",YN=typeof navigator=="object"&&navigator||void 0,jW=Y4&&(!YN||["ReactNative","NativeScript","NS"].indexOf(YN.product)<0),VW=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",BW=Y4&&window.location.href||"http://localhost";function BB(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),r.push.apply(r,s)}return r}function FB(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?BB(Object(r),!0).forEach(function(s){ne(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):BB(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}var xc=FB(FB({},Object.freeze({__proto__:null,hasBrowserEnv:Y4,hasStandardBrowserEnv:jW,hasStandardBrowserWebWorkerEnv:VW,navigator:YN,origin:BW})),VB),GB=Ks,zB=qe,FW=Ga,KN=Q,HB=function(){var e=GB(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.unicodeSets&&(t+="v"),e.sticky&&(t+="y"),t},K4=RegExp.prototype,Nb=function(e){var t=e.flags;return t!==void 0||"flags"in K4||FW(e,"flags")||!KN(K4,e)?t:zB(HB,e)},GW=d_.charAt,WB=qe,zW=Ks,HW=We,YB=Te,WW=/./.exec,YW=TypeError,KW=pr,KB=qe,qB=he,JB=pT,qN=zf,q4=tn,J4=Lm,YR=Ls,qW=Ks,JW=dr,X4=Te,JN=UC,XN=Nb,XW=Rf,XB=I,QW=RT,ZW=function(e,t,r){return t+(r?GW(e,t).length:1)},$W=function(e,t){var r=e.exec;if(HW(r)){var s=WB(r,e,t);return s!==null&&zW(s),s}if(YB(e)==="RegExp")return WB(WW,e,t);throw new YW("RegExp#exec called on incompatible receiver")},QN=Ld,eY=ea("matchAll"),QB="RegExp String",Q4=QB+" Iterator",Z4=QN.set,$4=QN.getterFor(Q4),tY=TypeError,ZN=qB("".indexOf),I_=qB("".matchAll),Lb=!!I_&&!XB(function(){I_("a",/./)}),ex=JB(function(e,t,r,s){Z4(this,{type:Q4,regexp:e,string:t,global:r,unicode:s,done:!1})},QB,function(){var e=$4(this);if(e.done)return qN(void 0,!0);var t=e.regexp,r=e.string,s=$W(t,r);return s===null?(e.done=!0,qN(void 0,!0)):e.global?(YR(s[0])===""&&(t.lastIndex=ZW(r,J4(t.lastIndex),e.unicode)),qN(s,!1)):(e.done=!0,qN(s,!1))}),KR=function(e){var t,r,s,l=qW(this),f=YR(e),m=QW(l,RegExp),E=YR(XN(l));return t=new m(m===RegExp?l.source:l,E),r=!!~ZN(E,"g"),s=!!~ZN(E,"u"),t.lastIndex=J4(l.lastIndex),new ex(t,f,r,s)};KW({target:"String",proto:!0,forced:Lb},{matchAll:function(e){var t,r,s,l,f=q4(this);if(JW(e)){if(JN(e)&&(t=YR(q4(XN(e))),!~ZN(t,"g")))throw new tY("`.matchAll` does not allow non-global regexes");if(Lb)return I_(f,e);if((s=XW(e,eY))===void 0&&X4(e)==="RegExp"&&(s=KR),s)return KB(s,e,f)}else if(Lb)return I_(f,e);return r=YR(f),l=new RegExp(e,"g"),KB(KR,l,r)}});var lh=il("String","matchAll"),tx=Q,ZB=lh,A_=String.prototype,$B=function(e){var t=e.matchAll;return typeof e=="string"||e===A_||tx(A_,e)&&t===A_.matchAll?ZB:t},$N=T($B);function nx(e){function t(r,s,l,f){let m=r[f++];if(m==="__proto__")return!0;const E=Number.isFinite(+m),y=f>=r.length;return m=!m&&mt.isArray(l)?l.length:m,y?(mt.hasOwnProp(l,m)?l[m]=[l[m],s]:l[m]=s,!E):(l[m]&&mt.isObject(l[m])||(l[m]=[]),t(r,s,l[m],f)&&mt.isArray(l[m])&&(l[m]=function(b){const A={},O=Object.keys(b);let D;const P=O.length;let F;for(D=0;D<P;D++)F=O[D],A[F]=b[F];return A}(l[m])),!E)}if(mt.isFormData(e)&&mt.isFunction(e.entries)){const r={};return mt.forEachEntry(e,(s,l)=>{t(function(f){return $N(mt).call(mt,/\w+|\[(\w*)]/g,f).map(m=>m[0]==="[]"?"":m[1]||m[0])}(s),l,r,0)}),r}return null}const eL={transitional:B9,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const r=t.getContentType()||"",s=r.indexOf("application/json")>-1,l=mt.isObject(e);if(l&&mt.isHTMLForm(e)&&(e=new FormData(e)),mt.isFormData(e))return s?JSON.stringify(nx(e)):e;if(mt.isArrayBuffer(e)||mt.isBuffer(e)||mt.isStream(e)||mt.isFile(e)||mt.isBlob(e)||mt.isReadableStream(e))return e;if(mt.isArrayBufferView(e))return e.buffer;if(mt.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let f;if(l){if(r.indexOf("application/x-www-form-urlencoded")>-1)return function(m,E){return PR(m,new xc.classes.URLSearchParams,Object.assign({visitor:function(y,b,A,O){return xc.isNode&&mt.isBuffer(y)?(this.append(b,y.toString("base64")),!1):O.defaultVisitor.apply(this,arguments)}},E))}(e,this.formSerializer).toString();if((f=mt.isFileList(e))||r.indexOf("multipart/form-data")>-1){const m=this.env&&this.env.FormData;return PR(f?{"files[]":e}:e,m&&new m,this.formSerializer)}}return l||s?(t.setContentType("application/json",!1),function(m,E,y){if(mt.isString(m))try{return(E||JSON.parse)(m),Eo(mt).call(mt,m)}catch(b){if(b.name!=="SyntaxError")throw b}return(y||JSON.stringify)(m)}(e)):e}],transformResponse:[function(e){const t=this.transitional||eL.transitional,r=t&&t.forcedJSONParsing,s=this.responseType==="json";if(mt.isResponse(e)||mt.isReadableStream(e))return e;if(e&&mt.isString(e)&&(r&&!this.responseType||s)){const l=!(t&&t.silentJSONParsing)&&s;try{return JSON.parse(e)}catch(f){if(l)throw f.name==="SyntaxError"?Dr.from(f,Dr.ERR_BAD_RESPONSE,this,null,this.response):f}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:xc.classes.FormData,Blob:xc.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};mt.forEach(["delete","get","head","post","put","patch"],e=>{eL.headers[e]={}});var rx=eL;const nY=mt.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),ix=Symbol("internals");function Db(e){var t;return e&&Eo(t=String(e)).call(t).toLowerCase()}function qR(e){return e===!1||e==null?e:mt.isArray(e)?e.map(qR):String(e)}function Ng(e,t,r,s,l){return mt.isFunction(s)?s.call(this,t,r):(l&&(t=r),mt.isString(t)?mt.isString(s)?t.indexOf(s)!==-1:mt.isRegExp(s)?s.test(t):void 0:void 0)}class JR{constructor(t){t&&this.set(t)}set(t,r,s){const l=this;function f(y,b,A){const O=Db(b);if(!O)throw new Error("header name must be a non-empty string");const D=mt.findKey(l,O);(!D||l[D]===void 0||A===!0||A===void 0&&l[D]!==!1)&&(l[D||b]=qR(y))}const m=(y,b)=>mt.forEach(y,(A,O)=>f(A,O,b));if(mt.isPlainObject(t)||t instanceof this.constructor)m(t,r);else if(mt.isString(t)&&(t=Eo(t).call(t))&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(Eo(E=t).call(E)))m((y=>{const b={};let A,O,D;return y&&y.split(`
`).forEach(function(P){var F,B;D=P.indexOf(":"),A=Eo(F=P.substring(0,D)).call(F).toLowerCase(),O=Eo(B=P.substring(D+1)).call(B),!A||b[A]&&nY[A]||(A==="set-cookie"?b[A]?b[A].push(O):b[A]=[O]:b[A]=b[A]?b[A]+", "+O:O)}),b})(t),r);else if(mt.isObject(t)&&mt.isIterable(t)){let y,b,A={};for(const O of t){if(!mt.isArray(O))throw TypeError("Object iterator must return a key-value pair");A[b=O[0]]=(y=A[b])?mt.isArray(y)?[...y,O[1]]:[y,O[1]]:O[1]}m(A,r)}else t!=null&&f(r,t,s);var E;return this}get(t,r){if(t=Db(t)){const s=mt.findKey(this,t);if(s){const l=this[s];if(!r)return l;if(r===!0)return function(f){const m=Object.create(null),E=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let y;for(;y=E.exec(f);)m[y[1]]=y[2];return m}(l);if(mt.isFunction(r))return r.call(this,l,s);if(mt.isRegExp(r))return r.exec(l);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=Db(t)){const s=mt.findKey(this,t);return!(!s||this[s]===void 0||r&&!Ng(0,this[s],s,r))}return!1}delete(t,r){const s=this;let l=!1;function f(m){if(m=Db(m)){const E=mt.findKey(s,m);!E||r&&!Ng(0,s[E],E,r)||(delete s[E],l=!0)}}return mt.isArray(t)?t.forEach(f):f(t),l}clear(t){const r=Object.keys(this);let s=r.length,l=!1;for(;s--;){const f=r[s];t&&!Ng(0,this[f],f,t,!0)||(delete this[f],l=!0)}return l}normalize(t){const r=this,s={};return mt.forEach(this,(l,f)=>{var m;const E=mt.findKey(s,f);if(E)return r[E]=qR(l),void delete r[f];const y=t?function(b){return Eo(b).call(b).toLowerCase().replace(/([a-z\d])(\w*)/g,(A,O,D)=>O.toUpperCase()+D)}(f):Eo(m=String(f)).call(m);y!==f&&delete r[f],r[y]=qR(l),s[y]=!0}),this}concat(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return this.constructor.concat(this,...r)}toJSON(t){const r=Object.create(null);return mt.forEach(this,(s,l)=>{s!=null&&s!==!1&&(r[l]=t&&mt.isArray(s)?s.join(", "):s)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(t=>{let[r,s]=t;return r+": "+s}).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t){const r=new this(t);for(var s=arguments.length,l=new Array(s>1?s-1:0),f=1;f<s;f++)l[f-1]=arguments[f];return l.forEach(m=>r.set(m)),r}static accessor(t){const r=(this[ix]=this[ix]={accessors:{}}).accessors,s=this.prototype;function l(f){const m=Db(f);r[m]||(function(E,y){const b=mt.toCamelCase(" "+y);["get","set","has"].forEach(A=>{Object.defineProperty(E,A+b,{value:function(O,D,P){return this[A].call(this,y,O,D,P)},configurable:!0})})}(s,f),r[m]=!0)}return mt.isArray(t)?t.forEach(l):l(t),this}}JR.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),mt.reduceDescriptors(JR.prototype,(e,t)=>{let{value:r}=e,s=t[0].toUpperCase()+t.slice(1);return{get:()=>r,set(l){this[s]=l}}}),mt.freezeMethods(JR);var dh=JR;function ax(e,t){const r=this||rx,s=t||r,l=dh.from(s.headers);let f=s.data;return mt.forEach(e,function(m){f=m.call(r,f,l.normalize(),t?t.status:void 0)}),l.normalize(),f}function e8(e){return!(!e||!e.__CANCEL__)}function Pb(e,t,r){Dr.call(this,e??"canceled",Dr.ERR_CANCELED,t,r),this.name="CanceledError"}function t8(e,t,r){const s=r.config.validateStatus;r.status&&s&&!s(r.status)?t(new Dr("Request failed with status code "+r.status,[Dr.ERR_BAD_REQUEST,Dr.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r)):e(r)}mt.inherits(Pb,Dr,{__CANCEL__:!0});const tL=function(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:3,s=0;const l=function(f,m){f=f||10;const E=new Array(f),y=new Array(f);let b,A=0,O=0;return m=m!==void 0?m:1e3,function(D){const P=Date.now(),F=y[O];b||(b=P),E[A]=D,y[A]=P;let B=O,Y=0;for(;B!==A;)Y+=E[B++],B%=f;if(A=(A+1)%f,A===O&&(O=(O+1)%f),P-b<m)return;const $=F&&P-F;return $?Math.round(1e3*Y/$):void 0}}(50,250);return function(f,m){let E,y,b=0,A=1e3/m;const O=function(D){b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Date.now(),E=null,y&&(clearTimeout(y),y=null),f.apply(null,D)};return[function(){const D=Date.now(),P=D-b;for(var F=arguments.length,B=new Array(F),Y=0;Y<F;Y++)B[Y]=arguments[Y];P>=A?O(B,D):(E=B,y||(y=setTimeout(()=>{y=null,O(E)},A-P)))},()=>E&&O(E)]}(f=>{const m=f.loaded,E=f.lengthComputable?f.total:void 0,y=m-s,b=l(y);s=m,e({loaded:m,total:E,progress:E?m/E:void 0,bytes:y,rate:b||void 0,estimated:b&&E&&m<=E?(E-m)/b:void 0,event:f,lengthComputable:E!=null,[t?"download":"upload"]:!0})},r)},nL=(e,t)=>{const r=e!=null;return[s=>t[0]({lengthComputable:r,total:e,loaded:s}),t[1]]},sx=e=>function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return mt.asap(()=>e(...r))};var rY=xc.hasStandardBrowserEnv?((e,t)=>r=>(r=new aN(r,xc.origin),e.protocol===r.protocol&&e.host===r.host&&(t||e.port===r.port)))(new aN(xc.origin),xc.navigator&&/(msie|trident)/i.test(xc.navigator.userAgent)):()=>!0,ox=xc.hasStandardBrowserEnv?{write(e,t,r,s,l,f){const m=[e+"="+encodeURIComponent(t)];mt.isNumber(r)&&m.push("expires="+new Date(r).toGMTString()),mt.isString(s)&&m.push("path="+s),mt.isString(l)&&m.push("domain="+l),f===!0&&m.push("secure"),document.cookie=m.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read:()=>null,remove(){}};function Mb(e,t,r){let s=!function(l){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(l)}(t);return e&&(s||r==0)?function(l,f){return f?l.replace(/\/?\/$/,"")+"/"+f.replace(/^\/+/,""):l}(e,t):t}function Zl(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),r.push.apply(r,s)}return r}const Kn=e=>e instanceof dh?function(t){for(var r=1;r<arguments.length;r++){var s=arguments[r]!=null?arguments[r]:{};r%2?Zl(Object(s),!0).forEach(function(l){ne(t,l,s[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):Zl(Object(s)).forEach(function(l){Object.defineProperty(t,l,Object.getOwnPropertyDescriptor(s,l))})}return t}({},e):e;function kp(e,t){t=t||{};const r={};function s(b,A,O,D){return mt.isPlainObject(b)&&mt.isPlainObject(A)?mt.merge.call({caseless:D},b,A):mt.isPlainObject(A)?mt.merge({},A):mt.isArray(A)?A.slice():A}function l(b,A,O,D){return mt.isUndefined(A)?mt.isUndefined(b)?void 0:s(void 0,b,0,D):s(b,A,0,D)}function f(b,A){if(!mt.isUndefined(A))return s(void 0,A)}function m(b,A){return mt.isUndefined(A)?mt.isUndefined(b)?void 0:s(void 0,b):s(void 0,A)}function E(b,A,O){return O in t?s(b,A):O in e?s(void 0,b):void 0}const y={url:f,method:f,data:f,baseURL:m,transformRequest:m,transformResponse:m,paramsSerializer:m,timeout:m,timeoutMessage:m,withCredentials:m,withXSRFToken:m,adapter:m,responseType:m,xsrfCookieName:m,xsrfHeaderName:m,onUploadProgress:m,onDownloadProgress:m,decompress:m,maxContentLength:m,maxBodyLength:m,beforeRedirect:m,transport:m,httpAgent:m,httpsAgent:m,cancelToken:m,socketPath:m,responseEncoding:m,validateStatus:E,headers:(b,A,O)=>l(Kn(b),Kn(A),0,!0)};return mt.forEach(Object.keys(Object.assign({},e,t)),function(b){const A=y[b]||l,O=A(e[b],t[b],b);mt.isUndefined(O)&&A!==E||(r[b]=O)}),r}var rL=e=>{const t=kp({},e);let r,{data:s,withXSRFToken:l,xsrfHeaderName:f,xsrfCookieName:m,headers:E,auth:y}=t;if(t.headers=E=dh.from(E),t.url=j9(Mb(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),y&&E.set("Authorization","Basic "+btoa((y.username||"")+":"+(y.password?unescape(encodeURIComponent(y.password)):""))),mt.isFormData(s)){if(xc.hasStandardBrowserEnv||xc.hasStandardBrowserWebWorkerEnv)E.setContentType(void 0);else if((r=E.getContentType())!==!1){const[b,...A]=r?r.split(";").map(O=>Eo(O).call(O)).filter(Boolean):[];E.setContentType([b||"multipart/form-data",...A].join("; "))}}if(xc.hasStandardBrowserEnv&&(l&&mt.isFunction(l)&&(l=l(t)),l||l!==!1&&rY(t.url))){const b=f&&m&&ox.read(m);b&&E.set(f,b)}return t},cx=typeof XMLHttpRequest<"u"&&function(e){return new gt(function(t,r){const s=rL(e);let l=s.data;const f=dh.from(s.headers).normalize();let m,E,y,b,A,{responseType:O,onUploadProgress:D,onDownloadProgress:P}=s;function F(){b&&b(),A&&A(),s.cancelToken&&s.cancelToken.unsubscribe(m),s.signal&&s.signal.removeEventListener("abort",m)}let B=new XMLHttpRequest;function Y(){if(!B)return;const ee=dh.from("getAllResponseHeaders"in B&&B.getAllResponseHeaders());t8(function(Ee){t(Ee),F()},function(Ee){r(Ee),F()},{data:O&&O!=="text"&&O!=="json"?B.response:B.responseText,status:B.status,statusText:B.statusText,headers:ee,config:e,request:B}),B=null}B.open(s.method.toUpperCase(),s.url,!0),B.timeout=s.timeout,"onloadend"in B?B.onloadend=Y:B.onreadystatechange=function(){B&&B.readyState===4&&(B.status!==0||B.responseURL&&B.responseURL.indexOf("file:")===0)&&setTimeout(Y)},B.onabort=function(){B&&(r(new Dr("Request aborted",Dr.ECONNABORTED,e,B)),B=null)},B.onerror=function(){r(new Dr("Network Error",Dr.ERR_NETWORK,e,B)),B=null},B.ontimeout=function(){let ee=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded";const Ee=s.transitional||B9;s.timeoutErrorMessage&&(ee=s.timeoutErrorMessage),r(new Dr(ee,Ee.clarifyTimeoutError?Dr.ETIMEDOUT:Dr.ECONNABORTED,e,B)),B=null},l===void 0&&f.setContentType(null),"setRequestHeader"in B&&mt.forEach(f.toJSON(),function(ee,Ee){B.setRequestHeader(Ee,ee)}),mt.isUndefined(s.withCredentials)||(B.withCredentials=!!s.withCredentials),O&&O!=="json"&&(B.responseType=s.responseType),P&&([y,A]=tL(P,!0),B.addEventListener("progress",y)),D&&B.upload&&([E,b]=tL(D),B.upload.addEventListener("progress",E),B.upload.addEventListener("loadend",b)),(s.cancelToken||s.signal)&&(m=ee=>{B&&(r(!ee||ee.type?new Pb(null,e,B):ee),B.abort(),B=null)},s.cancelToken&&s.cancelToken.subscribe(m),s.signal&&(s.signal.aborted?m():s.signal.addEventListener("abort",m)));const $=function(ee){const Ee=/^([-+\w]{1,25})(:?\/\/|:)/.exec(ee);return Ee&&Ee[1]||""}(s.url);$&&xc.protocols.indexOf($)===-1?r(new Dr("Unsupported protocol "+$+":",Dr.ERR_BAD_REQUEST,e)):B.send(l||null)})},iL=(e,t)=>{const{length:r}=e=e?e.filter(Boolean):[];if(t||r){let s,l=new AbortController;const f=function(b){if(!s){s=!0,E();const A=b instanceof Error?b:this.reason;l.abort(A instanceof Dr?A:new Pb(A instanceof Error?A.message:A))}};let m=t&&setTimeout(()=>{m=null,f(new Dr("timeout ".concat(t," of ms exceeded"),Dr.ETIMEDOUT))},t);const E=()=>{e&&(m&&clearTimeout(m),m=null,e.forEach(b=>{b.unsubscribe?b.unsubscribe(f):b.removeEventListener("abort",f)}),e=null)};e.forEach(b=>b.addEventListener("abort",f));const{signal:y}=l;return y.unsubscribe=()=>mt.asap(E),y}},lx=T(mg),n8=bb.f("asyncIterator"),iY=T(n8);function aL(e,t){this.v=e,this.k=t}function $l(e){return function(){return new kb(e.apply(this,arguments))}}function kb(e){var t,r;function s(f,m){try{var E=e[f](m),y=E.value,b=y instanceof aL;lx.resolve(b?y.v:y).then(function(A){if(b){var O=f==="return"?"return":"next";if(!y.k||A.done)return s(O,A);A=e[O](A).value}l(E.done?"return":"normal",A)},function(A){s("throw",A)})}catch(A){l("throw",A)}}function l(f,m){switch(f){case"return":t.resolve({value:m,done:!0});break;case"throw":t.reject(m);break;default:t.resolve({value:m,done:!1})}(t=t.next)?s(t.key,t.arg):r=null}this._invoke=function(f,m){return new lx(function(E,y){var b={key:f,arg:m,resolve:E,reject:y,next:null};r?r=r.next=b:(t=r=b,s(f,m))})},typeof e.return!="function"&&(this.return=void 0)}function xn(e){return new aL(e,0)}function XR(e){var t={},r=!1;function s(l,f){return r=!0,f=new lx(function(m){m(e[l](f))}),{done:!1,value:new aL(f,1)}}return t[Vs!==void 0&&jB||"@@iterator"]=function(){return this},t.next=function(l){return r?(r=!1,l):s("next",l)},typeof e.throw=="function"&&(t.throw=function(l){if(r)throw r=!1,l;return s("throw",l)}),typeof e.return=="function"&&(t.return=function(l){return r?(r=!1,l):s("return",l)}),t}kb.prototype[typeof Vs=="function"&&iY||"@@asyncIterator"]=function(){return this},kb.prototype.next=function(e){return this._invoke("next",e)},kb.prototype.throw=function(e){return this._invoke("throw",e)},kb.prototype.return=function(e){return this._invoke("return",e)};var dx=T(n8);function sL(e){var t,r,s,l=2;for(typeof Symbol<"u"&&(r=dx,s=Symbol.iterator);l--;){if(r&&(t=e[r])!=null)return t.call(e);if(s&&(t=e[s])!=null)return new QR(t.call(e));r="@@asyncIterator",s="@@iterator"}throw new TypeError("Object is not async iterable")}function QR(e){function t(r){if(Object(r)!==r)return gt.reject(new TypeError(r+" is not an object."));var s=r.done;return gt.resolve(r.value).then(function(l){return{value:l,done:s}})}return QR=function(r){this.s=r,this.n=r.next},QR.prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(r){var s=this.s.return;return s===void 0?gt.resolve({value:r,done:!0}):t(s.apply(this.s,arguments))},throw:function(r){var s=this.s.return;return s===void 0?gt.reject(r):t(s.apply(this.s,arguments))}},new QR(e)}const aY=function*(e,t){let r=e.byteLength;if(!t||r<t)return void(yield e);let s,l=0;for(;l<r;)s=l+t,yield e.slice(l,s),l=s},ux=function(){var e=$l(function*(t,r){var s,l=!1,f=!1;try{for(var m,E=sL(oL(t));l=!(m=yield xn(E.next())).done;l=!1){const y=m.value;yield*XR(sL(aY(y,r)))}}catch(y){f=!0,s=y}finally{try{l&&E.return!=null&&(yield xn(E.return()))}finally{if(f)throw s}}});return function(t,r){return e.apply(this,arguments)}}(),oL=function(){var e=$l(function*(t){if(t[dx])return void(yield*XR(sL(t)));const r=t.getReader();try{for(;;){const{done:s,value:l}=yield xn(r.read());if(s)break;yield l}}finally{yield xn(r.cancel())}});return function(t){return e.apply(this,arguments)}}(),fx=(e,t,r,s)=>{const l=ux(e,t);let f,m=0,E=y=>{f||(f=!0,s&&s(y))};return new ReadableStream({async pull(y){try{const{done:b,value:A}=await l.next();if(b)return E(),void y.close();let O=A.byteLength;if(r){let D=m+=O;r(D)}y.enqueue(new Uint8Array(A))}catch(b){throw E(b),b}},cancel:y=>(E(y),l.return())},{highWaterMark:2})};function r8(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),r.push.apply(r,s)}return r}function i8(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?r8(Object(r),!0).forEach(function(s){ne(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):r8(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}const xb=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",hx=xb&&typeof ReadableStream=="function",sY=xb&&(typeof TextEncoder=="function"?(px=new TextEncoder,e=>px.encode(e)):async e=>new Uint8Array(await new Response(e).arrayBuffer()));var px;const cL=function(e){try{for(var t=arguments.length,r=new Array(t>1?t-1:0),s=1;s<t;s++)r[s-1]=arguments[s];return!!e(...r)}catch{return!1}},a8=hx&&cL(()=>{let e=!1;const t=new Request(xc.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),lL=hx&&cL(()=>mt.isReadableStream(new Response("").body)),pS={stream:lL&&(e=>e.body)};var mx;xb&&(mx=new Response,["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!pS[e]&&(pS[e]=mt.isFunction(mx[e])?t=>t[e]():(t,r)=>{throw new Dr("Response type '".concat(e,"' is not supported"),Dr.ERR_NOT_SUPPORT,r)})}));const dL=async(e,t)=>{const r=mt.toFiniteNumber(e.getContentLength());return r??(async s=>s==null?0:mt.isBlob(s)?s.size:mt.isSpecCompliantForm(s)?(await new Request(xc.origin,{method:"POST",body:s}).arrayBuffer()).byteLength:mt.isArrayBufferView(s)||mt.isArrayBuffer(s)?s.byteLength:(mt.isURLSearchParams(s)&&(s+=""),mt.isString(s)?(await sY(s)).byteLength:void 0))(t)};var xp=xb&&(async e=>{let{url:t,method:r,data:s,signal:l,cancelToken:f,timeout:m,onDownloadProgress:E,onUploadProgress:y,responseType:b,headers:A,withCredentials:O="same-origin",fetchOptions:D}=rL(e);b=b?(b+"").toLowerCase():"text";let P,F=iL([l,f&&f.toAbortSignal()],m);const B=F&&F.unsubscribe&&(()=>{F.unsubscribe()});let Y;try{if(y&&a8&&r!=="get"&&r!=="head"&&(Y=await dL(A,s))!==0){let Ie,we=new Request(t,{method:"POST",body:s,duplex:"half"});if(mt.isFormData(s)&&(Ie=we.headers.get("content-type"))&&A.setContentType(Ie),we.body){const[Ue,ve]=nL(Y,tL(sx(y)));s=fx(we.body,65536,Ue,ve)}}mt.isString(O)||(O=O?"include":"omit");const $="credentials"in Request.prototype;P=new Request(t,i8(i8({},D),{},{signal:F,method:r.toUpperCase(),headers:A.normalize().toJSON(),body:s,duplex:"half",credentials:$?O:void 0}));let ee=await fetch(P);const Ee=lL&&(b==="stream"||b==="response");if(lL&&(E||Ee&&B)){const Ie={};["status","statusText","headers"].forEach(Ne=>{Ie[Ne]=ee[Ne]});const we=mt.toFiniteNumber(ee.headers.get("content-length")),[Ue,ve]=E&&nL(we,tL(sx(E),!0))||[];ee=new Response(fx(ee.body,65536,Ue,()=>{ve&&ve(),B&&B()}),Ie)}b=b||"text";let Re=await pS[mt.findKey(pS,b)||"text"](ee,e);return!Ee&&B&&B(),await new gt((Ie,we)=>{t8(Ie,we,{data:Re,headers:dh.from(ee.headers),status:ee.status,statusText:ee.statusText,config:e,request:P})})}catch($){throw B&&B(),$&&$.name==="TypeError"&&/Load failed|fetch/i.test($.message)?Object.assign(new Dr("Network Error",Dr.ERR_NETWORK,e,P),{cause:$.cause||$}):Dr.from($,$&&$.code,e,P)}});const Ub={http:null,xhr:cx,fetch:xp};mt.forEach(Ub,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const ZR=e=>"- ".concat(e),gx=e=>mt.isFunction(e)||e===null||e===!1;var s8={getAdapter:e=>{e=mt.isArray(e)?e:[e];const{length:t}=e;let r,s;const l={};for(let f=0;f<t;f++){let m;if(r=e[f],s=r,!gx(r)&&(s=Ub[(m=String(r)).toLowerCase()],s===void 0))throw new Dr("Unknown adapter '".concat(m,"'"));if(s)break;l[m||"#"+f]=s}if(!s){const f=Object.entries(l).map(m=>{let[E,y]=m;return"adapter ".concat(E," ")+(y===!1?"is not supported by the environment":"is not available in the build")});throw new Dr("There is no suitable adapter to dispatch the request "+(t?f.length>1?`since :
`+f.map(ZR).join(`
`):" "+ZR(f[0]):"as no adapter specified"),"ERR_NOT_SUPPORT")}return s},adapters:Ub};function $R(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Pb(null,e)}function o8(e){return $R(e),e.headers=dh.from(e.headers),e.data=ax.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),s8.getAdapter(e.adapter||rx.adapter)(e).then(function(t){return $R(e),t.data=ax.call(e,e.transformResponse,t),t.headers=dh.from(t.headers),t},function(t){return e8(t)||($R(e),t&&t.response&&(t.response.data=ax.call(e,e.transformResponse,t.response),t.response.headers=dh.from(t.response.headers))),gt.reject(t)})}const Bs="1.9.0",eo={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{eo[e]=function(r){return typeof r===e||"a"+(t<1?"n ":" ")+e}});const c8={};eo.transitional=function(e,t,r){function s(l,f){return"[Axios v"+Bs+"] Transitional option '"+l+"'"+f+(r?". "+r:"")}return(l,f,m)=>{if(e===!1)throw new Dr(s(f," has been removed"+(t?" in "+t:"")),Dr.ERR_DEPRECATED);return t&&!c8[f]&&(c8[f]=!0,console.warn(s(f," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(l,f,m)}},eo.spelling=function(e){return(t,r)=>(console.warn("".concat(r," is likely a misspelling of ").concat(e)),!0)};var O_={assertOptions:function(e,t,r){if(typeof e!="object")throw new Dr("options must be an object",Dr.ERR_BAD_OPTION_VALUE);const s=Object.keys(e);let l=s.length;for(;l-- >0;){const f=s[l],m=t[f];if(m){const E=e[f],y=E===void 0||m(E,f,e);if(y!==!0)throw new Dr("option "+f+" must be "+y,Dr.ERR_BAD_OPTION_VALUE)}else if(r!==!0)throw new Dr("Unknown option "+f,Dr.ERR_BAD_OPTION)}},validators:eo};const Kd=O_.validators;let mS=class{constructor(e){this.defaults=e||{},this.interceptors={request:new V9,response:new V9}}async request(e,t){try{return await this._request(e,t)}catch(r){if(r instanceof Error){let s={};Error.captureStackTrace?Error.captureStackTrace(s):s=new Error;const l=s.stack?s.stack.replace(/^.+\n/,""):"";try{r.stack?l&&!String(r.stack).endsWith(l.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+l):r.stack=l}catch{}}throw r}}_request(e,t){typeof e=="string"?(t=t||{}).url=e:t=e||{},t=kp(this.defaults,t);const{transitional:r,paramsSerializer:s,headers:l}=t;r!==void 0&&O_.assertOptions(r,{silentJSONParsing:Kd.transitional(Kd.boolean),forcedJSONParsing:Kd.transitional(Kd.boolean),clarifyTimeoutError:Kd.transitional(Kd.boolean)},!1),s!=null&&(mt.isFunction(s)?t.paramsSerializer={serialize:s}:O_.assertOptions(s,{encode:Kd.function,serialize:Kd.function},!0)),t.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),O_.assertOptions(t,{baseUrl:Kd.spelling("baseURL"),withXsrfToken:Kd.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let f=l&&mt.merge(l.common,l[t.method]);l&&mt.forEach(["delete","get","head","post","put","patch","common"],P=>{delete l[P]}),t.headers=dh.concat(f,l);const m=[];let E=!0;this.interceptors.request.forEach(function(P){typeof P.runWhen=="function"&&P.runWhen(t)===!1||(E=E&&P.synchronous,m.unshift(P.fulfilled,P.rejected))});const y=[];let b;this.interceptors.response.forEach(function(P){y.push(P.fulfilled,P.rejected)});let A,O=0;if(!E){const P=[o8.bind(this),void 0];for(P.unshift.apply(P,m),P.push.apply(P,y),A=P.length,b=gt.resolve(t);O<A;)b=b.then(P[O++],P[O++]);return b}A=m.length;let D=t;for(O=0;O<A;){const P=m[O++],F=m[O++];try{D=P(D)}catch(B){F.call(this,B);break}}try{b=o8.call(this,D)}catch(P){return gt.reject(P)}for(O=0,A=y.length;O<A;)b=b.then(y[O++],y[O++]);return b}getUri(e){return j9(Mb((e=kp(this.defaults,e)).baseURL,e.url,e.allowAbsoluteUrls),e.params,e.paramsSerializer)}};mt.forEach(["delete","get","head","options"],function(e){mS.prototype[e]=function(t,r){return this.request(kp(r||{},{method:e,url:t,data:(r||{}).data}))}}),mt.forEach(["post","put","patch"],function(e){function t(r){return function(s,l,f){return this.request(kp(f||{},{method:e,headers:r?{"Content-Type":"multipart/form-data"}:{},url:s,data:l}))}}mS.prototype[e]=t(),mS.prototype[e+"Form"]=t(!0)});var qd=mS;class Ra{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new gt(function(l){r=l});const s=this;this.promise.then(l=>{if(!s._listeners)return;let f=s._listeners.length;for(;f-- >0;)s._listeners[f](l);s._listeners=null}),this.promise.then=l=>{let f;const m=new gt(E=>{s.subscribe(E),f=E}).then(l);return m.cancel=function(){s.unsubscribe(f)},m},t(function(l,f,m){s.reason||(s.reason=new Pb(l,f,m),r(s.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){this.reason?t(this.reason):this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const t=new AbortController,r=s=>{t.abort(s)};return this.subscribe(r),t.signal.unsubscribe=()=>this.unsubscribe(r),t.signal}static source(){let t;return{token:new Ra(function(s){t=s}),cancel:t}}}var cr=Ra;const uL={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(uL).forEach(e=>{let[t,r]=e;uL[r]=t});var uh=uL;const Ts=function e(t){const r=new qd(t),s=OR(qd.prototype.request,r);return mt.extend(s,qd.prototype,r,{allOwnKeys:!0}),mt.extend(s,r,null,{allOwnKeys:!0}),s.create=function(l){return e(kp(t,l))},s}(rx);Ts.Axios=qd,Ts.CanceledError=Pb,Ts.CancelToken=cr,Ts.isCancel=e8,Ts.VERSION=Bs,Ts.toFormData=PR,Ts.AxiosError=Dr,Ts.Cancel=Ts.CanceledError,Ts.all=function(e){return gt.all(e)},Ts.spread=function(e){return function(t){return e.apply(null,t)}},Ts.isAxiosError=function(e){return mt.isObject(e)&&e.isAxiosError===!0},Ts.mergeConfig=kp,Ts.AxiosHeaders=dh,Ts.formToJSON=e=>nx(mt.isHTMLForm(e)?new FormData(e):e),Ts.getAdapter=s8.getAdapter,Ts.HttpStatusCode=uh,Ts.default=Ts;var En=Ts;const l8=()=>{};function N_(){const e={promise:void 0,isResolved:!1,isRejected:!1,isFinished:!1,resolve:void 0,reject:void 0,cancel:l8};return e.promise=new gt((t,r)=>{e.resolve=s=>{e.isFinished||(e.isResolved=!0,e.isFinished=!0,t(s),e.value=s)},e.reject=s=>{e.isFinished||(e.isRejected=!0,e.isFinished=!0,r(s))}}),e}const eI=new Map,gS=new Map,Vo=new Map;let mr=function(e){return e.WIN_10="Windows 10",e.WIN_81="Windows 8.1",e.WIN_8="Windows 8",e.WIN_7="Windows 7",e.WIN_VISTA="Windows Vista",e.WIN_SERVER_2003="Windows Server 2003",e.WIN_XP="Windows XP",e.WIN_2000="Windows 2000",e.ANDROID="Android",e.HARMONY_OS="HarmonyOS",e.OPEN_BSD="Open BSD",e.SUN_OS="Sun OS",e.LINUX="Linux",e.IOS="iOS",e.MAC_OS="Mac OS",e.CHROMIUM_OS="Chromium OS",e.QNX="QNX",e.UNIX="UNIX",e.BEOS="BeOS",e.OS_2="OS/2",e.SEARCH_BOT="Search Bot",e}({}),sr=function(e){return e.CHROME="Chrome",e.SAFARI="Safari",e.EDGE="Edge",e.FIREFOX="Firefox",e.OPERA="OPR",e.QQ="QQBrowser",e.WECHAT="MicroMessenger",e}({});const Ni=new CH;let Ea=Ni.getResult(),_S=null;function qn(e){if(!_S){Ea=Ni.getResult();const t=function(E){if(E.engine.name==="Blink"&&E.browser.name!=="WeChat")return sr.CHROME;switch(E.browser.name){case"Chrome Headless":case"Chrome":case"Chromium":return sr.CHROME;case"Safari":case"Mobile Safari":return sr.SAFARI;case"Edge":return sr.EDGE;case"Firefox":return sr.FIREFOX;case"QQ":case"QQBrowser":return sr.QQ;case"Opera":return sr.OPERA;case"WeChat":return sr.WECHAT;default:return E.browser.name||""}}(Ea),r=fL(Ea),s=function(E){return E.os.name==="Windows"?E.os.version?E.os.name+" "+E.os.version:E.os.name:E.os.name||""}(Ea),l=Ea.os.version,f=fL(Ea,!1),m=Ea.device.type;if(!(t&&r&&s&&l))return{name:t,version:r,os:s,osVersion:l,browserVersion:f,deviceType:m};_S={name:t,version:r,os:s,osVersion:l,browserVersion:f,deviceType:m}}return _S}function fL(e){let t,r=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];return t=e.engine.name==="Blink"?e.engine.version||"":e.browser.version||"",r?t.split(".")[0]:t}function jb(){return qn().os}function _x(){const e=qn();return"".concat(e.os," ").concat(e.osVersion)}function tI(){const e=qn();return!!(Ea.engine.name==="WebKit"&&e.os===mr.MAC_OS&&navigator.maxTouchPoints&&navigator.maxTouchPoints>0&&e.name!==sr.SAFARI||to()&&e.name!==sr.SAFARI)}function Up(){return qn().name===sr.CHROME}function ns(){return qn().name===sr.SAFARI}function Ex(){return qn().name===sr.EDGE}function ei(){return qn().name===sr.FIREFOX}function to(){return qn().os===mr.IOS}function Vb(e){const t=qn();return!(t.name!==sr.CHROME||!t.osVersion)&&Number(t.version)>=e}function Jd(e){const t=qn();return!(t.name!==sr.CHROME||!t.osVersion)&&Number(t.version)<e}function hL(e,t,r){const s=qn();return!(s.name!==e||!s.osVersion)&&(r?Number(s.version)>=t&&Number(s.version)<=r:Number(s.version)===t)}function pL(e){const t=qn();return!(t.name!==sr.EDGE||!t.osVersion)&&Number(t.version)>=e}function mL(e){const t=qn();return!(t.name!==sr.SAFARI||!t.osVersion)&&Number(t.version)>=e}function jp(e,t,r){const s=qn();if(s.os!==mr.IOS||!s.osVersion)return!1;const l=s.osVersion.split(".");return t&&Number(l[0])===e&&Number(l[1])<t||Number(l[0])<e}function nI(e,t,r){const s=qn();if(s.name!==sr.SAFARI||!s.osVersion||!s.browserVersion)return!1;const l=s.browserVersion.split(".");return r?t&&Number(l[0])===e&&Number(l[1])<t||Number(l[0])<e:t?Number(l[0])===e&&Number(l[1])<=t||Number(l[0])<e:Number(l[0])<=e}function ES(e){const t=qn();return!(t.name!==sr.OPERA||!t.osVersion)&&Number(t.version)>=e}function vx(){const e=qn();if(e.os!==mr.IOS||!e.osVersion)return!1;const t=e.osVersion.split(".");return Number(t[0])<14||Number(t[0])===14&&Number(t[1])<=6}function Ct(){const e=qn();if(e.os!==mr.IOS||!e.osVersion)return!1;const t=e.osVersion.split(".");return Number(t[0])===15}function un(){const e=qn();if(e.os!==mr.IOS||!e.osVersion)return!1;const t=e.osVersion.split(".");return Number(t[0])===16}function oe(){const e=qn();if(e.os!==mr.IOS||!e.osVersion)return!1;const t=e.osVersion.split(".");return Number(t[0])===15&&Number(t[1])>=1}function Ye(){return ns()&&navigator.maxTouchPoints>0}function Vp(){return qn().name===sr.WECHAT}function Ia(){return window.navigator.appVersion&&window.navigator.appVersion.match(/Chrome\/([\w\W]*?)\./)!==null&&window.navigator.appVersion.match(/Chrome\/([\w\W]*?)\./)[1]<=35}function Cr(){const e=jb();return function(){const{deviceType:t}=qn();return t==="mobile"||t==="tablet"}()||e===mr.ANDROID||e===mr.IOS||e===mr.HARMONY_OS}function fh(){const e=qn();return e.name!==sr.EDGE&&e.name!==sr.SAFARI&&!!navigator.userAgent.toLocaleLowerCase().match(/chrome\/[\d]./i)}function Pa(){return jb()===mr.ANDROID}function Xd(){const e=qn();return Pa()&&(e.name===sr.CHROME||e.name===sr.WECHAT||/chrome|chromium/i.test(navigator.userAgent))}function Bt(e,t,r){return(t=function(s){var l=function(f,m){if(typeof f!="object"||!f)return f;var E=f[Symbol.toPrimitive];if(E!==void 0){var y=E.call(f,"string");if(typeof y!="object")return y;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(f)}(s);return typeof l=="symbol"?l:l+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Sx(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),r.push.apply(r,s)}return r}function It(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Sx(Object(r),!0).forEach(function(s){Bt(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Sx(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}let se=function(e){return e.UNEXPECTED_ERROR="UNEXPECTED_ERROR",e.UNEXPECTED_RESPONSE="UNEXPECTED_RESPONSE",e.TIMEOUT="TIMEOUT",e.INVALID_PARAMS="INVALID_PARAMS",e.NOT_READABLE="NOT_READABLE",e.NOT_SUPPORTED="NOT_SUPPORTED",e.INVALID_OPERATION="INVALID_OPERATION",e.OPERATION_ABORTED="OPERATION_ABORTED",e.WEB_SECURITY_RESTRICT="WEB_SECURITY_RESTRICT",e.EXCHANGE_SDP_FAILED="EXCHANGE_SDP_FAILED",e.ADD_CANDIDATE_FAILED="ADD_CANDIDATE_FAILED",e.DATACHANNEL_FAILED="DATACHANNEL_FAILED",e.NETWORK_ERROR="NETWORK_ERROR",e.NETWORK_TIMEOUT="NETWORK_TIMEOUT",e.NETWORK_RESPONSE_ERROR="NETWORK_RESPONSE_ERROR",e.API_INVOKE_TIMEOUT="API_INVOKE_TIMEOUT",e.ENUMERATE_DEVICES_FAILED="ENUMERATE_DEVICES_FAILED",e.DEVICE_NOT_FOUND="DEVICE_NOT_FOUND",e.ELECTRON_IS_NULL="ELECTRON_IS_NULL",e.ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR="ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR",e.CHROME_PLUGIN_NO_RESPONSE="CHROME_PLUGIN_NO_RESPONSE",e.CHROME_PLUGIN_NOT_INSTALL="CHROME_PLUGIN_NOT_INSTALL",e.MEDIA_OPTION_INVALID="MEDIA_OPTION_INVALID",e.PERMISSION_DENIED="PERMISSION_DENIED",e.CONSTRAINT_NOT_SATISFIED="CONSTRAINT_NOT_SATISFIED",e.TRACK_IS_DISABLED="TRACK_IS_DISABLED",e.GET_VIDEO_ELEMENT_VISIBLE_ERROR="GET_VIDEO_ELEMENT_VISIBLE_ERROR",e.SHARE_AUDIO_NOT_ALLOWED="SHARE_AUDIO_NOT_ALLOWED",e.LOW_STREAM_ENCODING_ERROR="LOW_STREAM_ENCODING_ERROR",e.SET_ENCODING_PARAMETER_ERROR="SET_ENCODING_PARAMETER_ERROR",e.TRACK_STATE_UNREACHABLE="TRACK_STATE_UNREACHABLE",e.INVALID_UINT_UID_FROM_STRING_UID="INVALID_UINT_UID_FROM_STRING_UID",e.CAN_NOT_GET_PROXY_SERVER="CAN_NOT_GET_PROXY_SERVER",e.CAN_NOT_GET_GATEWAY_SERVER="CAN_NOT_GET_GATEWAY_SERVER",e.VOID_GATEWAY_ADDRESS="VOID_GATEWAY_ADDRESS",e.UID_CONFLICT="UID_CONFLICT",e.MULTI_UNILBS_RESPONSE_ERROR="MULTI_UNILBS_RESPONSE_ERROR",e.UPDATE_TICKET_FAILED="UPDATE_TICKET_FAILED",e.TOKEN_EXPIRE="TOKEN_EXPIRE",e.INVALID_LOCAL_TRACK="INVALID_LOCAL_TRACK",e.INVALID_TRACK="INVALID_TRACK",e.SENDER_NOT_FOUND="SENDER_NOT_FOUND",e.CREATE_OFFER_FAILED="CREATE_OFFER_FAILED",e.SET_ANSWER_FAILED="SET_ANSWER_FAILED",e.ICE_FAILED="ICE_FAILED",e.PC_CLOSED="PC_CLOSED",e.SENDER_REPLACE_FAILED="SENDER_REPLACE_FAILED",e.GET_LOCAL_CAPABILITIES_FAILED="GET_LOCAL_CAPABILITIES_FAILED",e.GET_LOCAL_CONNECTION_PARAMS_FAILED="GET_LOCAL_CONNECTION_PARAMS_FAILED",e.SUBSCRIBE_FAILED="SUBSCRIBE_FAILED",e.UNSUBSCRIBE_FAILED="UNSUBSCRIBE_FAILED",e.GATEWAY_P2P_LOST="GATEWAY_P2P_LOST",e.NO_ICE_CANDIDATE="NO_ICE_CANDIDATE",e.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS="CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS",e.EXIST_DISABLED_VIDEO_TRACK="EXIST_DISABLED_VIDEO_TRACK",e.INVALID_REMOTE_USER="INVALID_REMOTE_USER",e.REMOTE_USER_IS_NOT_PUBLISHED="REMOTE_USER_IS_NOT_PUBLISHED",e.CUSTOM_REPORT_SEND_FAILED="CUSTOM_REPORT_SEND_FAILED",e.CUSTOM_REPORT_FREQUENCY_TOO_HIGH="CUSTOM_REPORT_FREQUENCY_TOO_HIGH",e.FETCH_AUDIO_FILE_FAILED="FETCH_AUDIO_FILE_FAILED",e.READ_LOCAL_AUDIO_FILE_ERROR="READ_LOCAL_AUDIO_FILE_ERROR",e.DECODE_AUDIO_FILE_FAILED="DECODE_AUDIO_FILE_FAILED",e.WS_ABORT="WS_ABORT",e.WS_DISCONNECT="WS_DISCONNECT",e.WS_ERR="WS_ERR",e.EXTERNAL_SIGNAL_ABORT="EXTERNAL_SIGNAL_ABORT",e.LIVE_STREAMING_TASK_CONFLICT="LIVE_STREAMING_TASK_CONFLICT",e.LIVE_STREAMING_INVALID_ARGUMENT="LIVE_STREAMING_INVALID_ARGUMENT",e.LIVE_STREAMING_INTERNAL_SERVER_ERROR="LIVE_STREAMING_INTERNAL_SERVER_ERROR",e.LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED="LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED",e.LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED="LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED",e.LIVE_STREAMING_CDN_ERROR="LIVE_STREAMING_CDN_ERROR",e.LIVE_STREAMING_INVALID_RAW_STREAM="LIVE_STREAMING_INVALID_RAW_STREAM",e.LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT="LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT",e.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE="LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE",e.LIVE_STREAMING_WARN_FREQUENT_REQUEST="LIVE_STREAMING_WARN_FREQUENT_REQUEST",e.WEBGL_INTERNAL_ERROR="WEBGL_INTERNAL_ERROR",e.BEAUTY_PROCESSOR_INTERNAL_ERROR="BEAUTY_PROCESSOR_INTERNAL_ERROR",e.CROSS_CHANNEL_WAIT_STATUS_ERROR="CROSS_CHANNEL_WAIT_STATUS_ERROR",e.CROSS_CHANNEL_FAILED_JOIN_SRC="CROSS_CHANNEL_FAILED_JOIN_SEC",e.CROSS_CHANNEL_FAILED_JOIN_DEST="CROSS_CHANNEL_FAILED_JOIN_DEST",e.CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST="CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST",e.CROSS_CHANNEL_SERVER_ERROR_RESPONSE="CROSS_CHANNEL_SERVER_ERROR_RESPONSE",e.METADATA_OUT_OF_RANGE="METADATA_OUT_OF_RANGE",e.LOCAL_AEC_ERROR="LOCAL_AEC_ERROR",e.INVALID_PLUGIN="INVALID_PLUGIN",e.DISCONNECT_P2P="DISCONNECT_P2P",e.CONVERTING_IMAGEDATA_TO_BLOB_FAILED="CONVERTING_IMAGEDATA_TO_BLOB_FAILED",e.CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED="CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED",e.INIT_DATACHANNEL_TIMEOUT="INIT_DATACHANNEL_TIMEOUT",e.CREATE_DATACHANNEL_ERROR="CREATE_DATACHANNEL_ERROR",e.DATACHANNEL_CONNECTION_TIMEOUT="DATACHANNEL_CONNECTION_TIMEOUT",e.PROHIBITED_OPERATION="PROHIBITED_OPERATION",e.IMAGE_MODERATION_UPLOAD_FAILED="IMAGE_MODERATION_UPLOAD_FAILED",e.P2P_MESSAGE_FAILED="P2P_MESSAGE_FAILED",e}({}),Ke=class extends Error{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",r=arguments.length>2?arguments[2]:void 0;super(t),Bt(this,"code",void 0),Bt(this,"message",void 0),Bt(this,"data",void 0),Bt(this,"name","AgoraRTCException"),this.code=e,this.message="AgoraRTCError ".concat(this.code,": ").concat(t),this.data=r}toString(){return this.data?"".concat(this.message,`
data: `).concat(JSON.stringify(this.data)):this.message}print(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"error",t=arguments.length>1?arguments[1]:void 0;return e==="error"&&(t||console).error(this.toString()),e==="warning"&&(t||console).warn(this.toString()),this}throw(e){throw this.print("error",e),this}};function hh(e,t){if(typeof e!="boolean")throw new Ke(se.INVALID_PARAMS,"Invalid ".concat(t,": The value is of the boolean type."))}function Aa(e,t,r){if(!ht(r).call(r,e))throw new Ke(se.INVALID_PARAMS,"".concat(t," can only be set as ").concat(JSON.stringify(r)))}function wr(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1e4;if(e<r||e>s||(!(arguments.length>4&&arguments[4]!==void 0)||arguments[4])&&!function(l){return typeof l=="number"&&l%1==0}(e))throw new Ke(se.INVALID_PARAMS,"invalid ".concat(t,": the value range is [").concat(r,", ").concat(s,"]. integer only"))}function li(e,t){if(typeof e!="number"){if(!(e.min||e.max||e.ideal||e.exact))throw new Ke(se.INVALID_PARAMS,"".concat(t," is not a valid ConstrainLong"));e.min!==void 0&&wr(e.min,"".concat(t,".min"),0,1/0),e.max!==void 0&&wr(e.max,"".concat(t,".max"),1,1/0),e.exact!==void 0&&wr(e.exact,"".concat(t,".exact"),1,1/0),e.ideal!==void 0&&wr(e.ideal,"".concat(t,".ideal"),1,1/0)}else wr(e,t,1,1/0)}function Oa(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:255,l=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4];if(e==null)throw new Ke(se.INVALID_PARAMS,"".concat(t||"param"," cannot be empty"));if(!Li(e,r,s,l))throw new Ke(se.INVALID_PARAMS,"Invalid ".concat(t||"string param",": Length of the string: [").concat(r,",").concat(s,"].").concat(l?" ASCII characters only.":""))}function Bp(e,t){if(!Array.isArray(e))throw new Ke(se.INVALID_PARAMS,"".concat(t," should be an array"))}function bn(e){return e==null}function Li(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:255,s=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3];return typeof e=="string"&&e.length<=r&&e.length>=t&&(!s||function(l){if(typeof l!="string")return!1;for(let f=0;f<l.length;f+=1){const m=l.charCodeAt(f);if(m<0||m>255)return!1}return!0}(e))}var Bb=function(e){return e.COVERED="COVERED",e.POSITION="POSITION",e.SIZE="SIZE",e.STYLE="STYLE",e}(Bb||{}),yx=function(e){return e.UNMOUNTED="UNMOUNTED",e.INVALID_HTML_ELEMENT="INVALID_HTML_ELEMENT",e}(yx||{});const ur=new class{constructor(){Bt(this,"_clientSize",null),Bt(this,"getClientWidth",()=>document.documentElement?document.documentElement.clientWidth:document.body.clientWidth),Bt(this,"getClientHeight",()=>document.documentElement?document.documentElement.clientHeight:document.body.clientHeight),Bt(this,"getStyle",e=>window.getComputedStyle(e,null)),Bt(this,"checkCssVisibleProperty",e=>{var t;let r=!0;const s=this.getStyle(e),{display:l,visibility:f,opacity:m,filter:E}=s;return(l==="none"||ht(t=["hidden","collapse"]).call(t,f)||Number(m)<.1)&&(r=!1),!!r&&(E&&E.split(" ").filter(y=>{var b;const A=y.split("(")[0];return ht(b=["brightness","blur","opacity"]).call(b,A)}).map(y=>{const[b,A]=y.split(/\(|\)/);return[b,Number(A.match(/^[0-9\.]+/))]}).forEach(y=>{const[b,A]=y;switch(b){case"brightness":(A<.1||A>3)&&(r=!1);break;case"blur":A>3&&(r=!1);break;case"opacity":A<.1&&(r=!1)}}),r)}),Bt(this,"checkPropertyUpToAllParentNodes",(e,t)=>{let r=!0,s=!0;const l=m=>t(m);let f=e;for(;f&&s;)l(f)||(r=!1,s=!1),f=f.parentElement,f||(s=!1);return r}),Bt(this,"checkActualCssVisibleIncludeInherit",e=>this.checkPropertyUpToAllParentNodes(e,this.checkCssVisibleProperty)),Bt(this,"getSizeAboutClient",e=>{const{width:t,height:r,left:s,right:l,top:f,bottom:m}=e.getBoundingClientRect(),E=this.getClientWidth(),y=this.getClientHeight();return{width:t,height:r,left:s,right:l,top:f,bottom:m,clientWidth:E,clientHeight:y,clientMin:Math.min(E,y)}}),Bt(this,"checkActualSize",()=>{const{width:e,height:t,clientMin:r}=this._clientSize;return this.checkSizeIsVisible(e,t,r)}),Bt(this,"elementFromPoint",(e,t)=>document.elementFromPoint?document.elementFromPoint(e,t):null),Bt(this,"checkCoverForAPoint",(e,t,r)=>{const s=this.elementFromPoint(e,t);return s!==null&&s!==r}),Bt(this,"getPointPositionList",()=>{const{width:e,height:t,left:r,top:s}=this._clientSize,l=e/6,f=t/6,m=[],E=10**6;for(let y=0;y<5;y++)for(let b=0;b<5;b++){const A=(r*E+(y===0?.1:y===4?(l*y*E-1e5)/E:l*y)*E)/E,O=(s*E+(b===0?.1:b===4?(f*b*E-1e5)/E:f*b)*E)/E;m.push({x:A,y:O})}return[...m]}),Bt(this,"checkElementCover",e=>this.getPointPositionList().map(t=>this.checkCoverForAPoint(t.x,t.y,e)).filter(t=>!!t).length>6),Bt(this,"checkSizeIsVisible",(e,t,r)=>(e>50||r/e<=10)&&(t>50||r/t<=10)),Bt(this,"checkSizeOfPartInClient",()=>{const{left:e,right:t,top:r,bottom:s,clientHeight:l,clientWidth:f,clientMin:m}=this._clientSize;let E,y,b,A;if(e<0)E=0;else{if(!(e<f))return!1;E=e}if(t<0)return!1;if(y=t<f?t:f,r<0)b=0;else{if(!(r<l))return!1;b=r}if(s<0)return!1;A=s<l?s:l;const O=y-E,D=A-b;return this.checkSizeIsVisible(O,D,m)}),Bt(this,"returnHiddenResult",e=>(this._clientSize=null,{visible:!1,reason:e})),Bt(this,"checkOneElementVisible",e=>{if(e instanceof HTMLElement){if(this.checkElementIsMountedOnDom(e)){if(this.checkActualCssVisibleIncludeInherit(e)){if(this._clientSize=this.getSizeAboutClient(e),this.checkElementCover(e))return this.returnHiddenResult(Bb.COVERED);{const t=this.checkActualSize(),r=this.checkSizeOfPartInClient();return t&&!r?this.returnHiddenResult(Bb.POSITION):t?(this._clientSize=null,{visible:!0}):this.returnHiddenResult(Bb.SIZE)}}return this.returnHiddenResult(Bb.STYLE)}return this.returnHiddenResult(yx.UNMOUNTED)}return this.returnHiddenResult(yx.INVALID_HTML_ELEMENT)}),Bt(this,"checkElementIsMountedOnDom",e=>this.checkPropertyUpToAllParentNodes(e,t=>t.nodeName.toUpperCase()!=="HTML"?t.parentElement!==null:!!document.documentElement))}};function vS(e){return new TextEncoder().encode(e)}const Tx=function(e,t){const r=new Uint8Array(e.byteLength+t.byteLength);return r.set(new Uint8Array(e),0),r.set(new Uint8Array(t),e.byteLength),r},rI=async e=>function(t,r){let s="";return new Uint8Array(t).forEach(l=>{s+=l.toString(r).padStart(2,"0")}),s}(await crypto.subtle.digest("SHA-256",vS(e)),16);let Xt=class{constructor(){Bt(this,"_events",{}),Bt(this,"addListener",this.on)}getListeners(e){return this._events[e]?this._events[e].map(t=>t.listener):[]}on(e,t){this._events[e]||(this._events[e]=[]);const r=this._events[e];this._indexOfListener(r,t)===-1&&r.push({listener:t,once:!1})}once(e,t){this._events[e]||(this._events[e]=[]);const r=this._events[e];this._indexOfListener(r,t)===-1&&r.push({listener:t,once:!0})}off(e,t){if(!this._events[e])return;const r=this._events[e],s=this._indexOfListener(r,t);s!==-1&&r.splice(s,1),this._events[e].length===0&&delete this._events[e]}removeAllListeners(e){e?delete this._events[e]:this._events={}}emit(e){this._events[e]||(this._events[e]=[]);const t=this._events[e].map(f=>f);for(var r=arguments.length,s=new Array(r>1?r-1:0),l=1;l<r;l++)s[l-1]=arguments[l];for(let f=0;f<t.length;f+=1){const m=t[f];m.once&&this.off(e,m.listener),m.listener.apply(this,s||[])}}safeEmit(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),s=1;s<t;s++)r[s-1]=arguments[s];[...this._events[e]||[]].forEach(l=>{l.once&&this.off(e,l.listener);try{l.listener.apply(this,r)}catch(f){console.error("safeEmit event:".concat(e," error ").concat(f==null?void 0:f.toString()))}})}_indexOfListener(e,t){let r=e.length;for(;r--;)if(e[r].listener===t)return r;return-1}},Ma=null;function Uc(){if(Ma)return Ma;if(window.electron)return Ma=window.electron;if(!window.require)return null;try{return Ma=window.require("electron"),Ma}catch{return null}}let Di=function(e){return e.CREATE_CLIENT="createClient",e.CHECK_SYSTEM_REQUIREMENTS="checkSystemRequirements",e.SET_AREA="setArea",e.PRELOAD="PRELOAD",e.CHECK_VIDEO_TRACK_IS_ACTIVE="checkVideoTrackIsActive",e.CHECK_AUDIO_TRACK_IS_ACTIVE="checkAudioTrackIsActive",e.CREATE_MIC_AUDIO_TRACK="createMicrophoneAudioTrack",e.CREATE_CUSTOM_AUDIO_TRACK="createCustomAudioTrack",e.CREATE_BUFFER_AUDIO_TRACK="createBufferSourceAudioTrack",e.CREATE_CAM_VIDEO_TRACK="createCameraVideoTrack",e.CREATE_CUSTOM_VIDEO_TRACK="createCustomVideoTrack",e.CREATE_MIC_AND_CAM_TRACKS="createMicrophoneAndCameraTracks",e.CREATE_SCREEN_VIDEO_TRACK="createScreenVideoTrack",e.SET_ENCRYPTION_CONFIG="Client.setEncryptionConfig",e.START_PROXY_SERVER="Client.startProxyServer",e.STOP_PROXY_SERVER="Client.stopProxyServer",e.SET_PROXY_SERVER="Client.setProxyServer",e.SET_TURN_SERVER="Client.setTurnServer",e.SET_CLIENT_ROLE="Client.setClientRole",e.SET_LOW_STREAM_PARAMETER="Client.setLowStreamParameter",e.ENABLE_DUAL_STREAM="Client.enableDualStream",e.DISABLE_DUAL_STREAM="Client.disableDualStream",e.JOIN="Client.join",e.LEAVE="Client.leave",e.PUBLISH="Client.publish",e.UNPUBLISH="Client.unpublish",e.SUBSCRIBE="Client.subscribe",e.MASS_SUBSCRIBE="Client.massSubscribe",e.MASS_UNSUBSCRIBE="Client.massUnsubscribe",e.UNSUBSCRIBE="Client.unsubscribe",e.RENEW_TOKEN="Client.renewToken",e.SET_REMOTE_VIDEO_STREAM_TYPE="Client.setRemoteVideoStreamType",e.SET_STREAM_FALLBACK_OPTION="Client.setStreamFallbackOption",e.ENABLE_AUDIO_VOLUME_INDICATOR="Client.enableAudioVolumeIndicator",e.SEND_CUSTOM_REPORT_MESSAGE="Client.sendCustomReportMessage",e.INSPECT_VIDEO_CONTENT="Client.inspectVideoContent",e.STOP_INSPECT_VIDEO_CONTENT="Client.stopInspectVideoContent",e.JOIN_FALLBACK_TO_PROXY="Client._joinFallbackToProxy",e.ON_LIVE_STREAM_WARNING="Client.onLiveStreamWarning",e.ON_LIVE_STREAM_ERROR="Client.onLiveStreamingError",e.START_LIVE_STREAMING="Client.startLiveStreaming",e.SET_LIVE_TRANSCODING="Client.setLiveTranscoding",e.STOP_LIVE_STREAMING="Client.stopLiveStreaming",e.START_CHANNEL_MEDIA_RELAY="Client.startChannelMediaRelay",e.UPDATE_CHANNEL_MEDIA_RELAY="Client.updateChannelMediaRelay",e.STOP_CHANNEL_MEDIA_RELAY="Client.stopChannelMediaRelay",e.REQUEST_CONFIG_DISTRIBUTE="_config-distribute-request",e.SET_CONFIG_DISTRIBUTE="_configDistribute",e.LOCAL_TRACK_SET_MUTED="LocalTrack.setMute",e.LOCAL_AUDIO_TRACK_PLAY="LocalAudioTrack.play",e.LOCAL_AUDIO_TRACK_PLAY_IN_ELEMENT="LocalAudioTrack.playInElement",e.LOCAL_AUDIO_TRACK_STOP="LocalAudioTrack.stop",e.LOCAL_AUDIO_TRACK_SET_VOLUME="LocalAudioTrack.setVolume",e.MIC_AUDIO_TRACK_SET_DEVICE="MicrophoneAudioTrack.setDevice",e.BUFFER_AUDIO_TRACK_START="BufferSourceAudioTrack.startProcessAudioBuffer",e.BUFFER_AUDIO_TRACK_STOP="BufferSourceAudioTrack.stopProcessAudioBuffer",e.BUFFER_AUDIO_TRACK_PAUSE="BufferSourceAudioTrack.pauseProcessAudioBuffer",e.BUFFER_AUDIO_TRACK_RESUME="BufferSourceAudioTrack.resumeProcessAudioBuffer",e.BUFFER_AUDIO_TRACK_SEEK="BufferSourceAudioTrack.seekAudioBuffer",e.LOCAL_VIDEO_TRACK_PLAY="LocalVideoTrack.play",e.LOCAL_VIDEO_TRACK_STOP="LocalVideoTrack.stop",e.LOCAL_VIDEO_TRACK_GET_VIDEO_VISIBLE="LocalVideoTrack.getVideoElementVisibleStatus",e.LOCAL_VIDEO_TRACK_BEAUTY="LocalVideoTrack.setBeautyEffect",e.LOCAL_VIDEO_SEND_SEI_DATA="LocalVideoTrack.sendSeiData",e.CAM_VIDEO_TRACK_SET_DEVICE="CameraVideoTrack.setDevice",e.CAM_VIDEO_TRACK_SET_ENCODER_CONFIG="CameraVideoTrack.setEncoderConfiguration",e.REMOTE_VIDEO_TRACK_PLAY="RemoteVideoTrack.play",e.REMOTE_VIDEO_TRACK_STOP="RemoteVideoTrack.stop",e.REMOTE_VIDEO_TRACK_GET_VIDEO_VISIBLE="RemoteVideoTrack.getVideoElementVisibleStatus",e.REMOTE_AUDIO_TRACK_PLAY="RemoteAudioTrack.play",e.REMOTE_AUDIO_TRACK_STOP="RemoteAudioTrack.stop",e.REMOTE_AUDIO_SET_VOLUME="RemoteAudioTrack.setVolume",e.REMOTE_AUDIO_SET_OUTPUT_DEVICE="RemoteAudioTrack.setOutputDevice",e.GET_MEDIA_STREAM_TRACK="Track.getMediaStreamTrack",e.STREAM_TYPE_CHANGE="streamTypeChange",e.CONNECTION_STATE_CHANGE="connectionStateChange",e.LOAD_CONFIG_FROM_LOCALSTORAGE="loadConfigFromLocalStorage",e.IMAGE_MODERATION_UPLOAD="imageModerationUpload",e.REPUB_AFTER_PC_CONNECTED="repubAfterPCConnected",e}({}),Bn=function(e){return e.TRACER="tracer",e}({});function Vr(e){return wr(e.timeout,"config.timeout",0,1e5),wr(e.timeoutFactor,"config.timeoutFactor",0,100,!1),wr(e.maxRetryCount,"config.maxRetryConfig",0,1/0),wr(e.maxRetryTimeout,"config.maxRetryTimeout",0,1/0),!0}let ed=function(e){return e[e.AUDIENCE_LEVEL_LOW_LATENCY=1]="AUDIENCE_LEVEL_LOW_LATENCY",e[e.AUDIENCE_LEVEL_ULTRA_LOW_LATENCY=2]="AUDIENCE_LEVEL_ULTRA_LOW_LATENCY",e[e.AUDIENCE_LEVEL_SYNC_LATENCY=3]="AUDIENCE_LEVEL_SYNC_LATENCY",e}({}),nr=function(e){return e.LEAVE="LEAVE",e.NETWORK_ERROR="NETWORK_ERROR",e.SERVER_ERROR="SERVER_ERROR",e.UID_BANNED="UID_BANNED",e.FALLBACK="FALLBACK",e.IP_BANNED="IP_BANNED",e.CHANNEL_BANNED="CHANNEL_BANNED",e.LICENSE_MISSING="LICENSE_MISSING",e.LICENSE_EXPIRED="LICENSE_EXPIRED",e.LICENSE_MINUTES_EXCEEDED="LICENSE_MINUTES_EXCEEDED",e.LICENSE_PERIOD_INVALID="LICENSE_PERIOD_INVALID",e.LICENSE_MULTIPLE_SDK_SERVICE="LICENSE_MULTIPLE_SDK_SERVICE",e.LICENSE_ILLEGAL="LICENSE_ILLEGAL",e.TOKEN_EXPIRE="TOKEN_EXPIRE",e}({});function ki(e){if(!Array.isArray(e)||e.length<1)return!1;try{e.forEach(t=>{if(!t.urls)throw Error()})}catch{return!1}return!0}function iI(e){return Oa(e.turnServerURL,"turnServerURL"),Oa(e.username,"username"),Oa(e.password,"password"),e.udpport&&wr(e.udpport,"udpport",1,99999,!0),e.forceturn&&hh(e.forceturn,"forceturn"),e.security&&hh(e.security,"security"),e.tcpport&&wr(e.tcpport,"tcpport",1,99999,!0),!0}function L_(e){return e.level!==void 0&&Aa(e.level,"level",[1,2,3]),e.delay!==void 0&&wr(e.delay,"delay",0,3e3,!0),!0}let In=function(e){return e.PEERCONNECTION_STATE_CHANGE="peerconnection-state-change",e.AUDIO_METADATA="audio-metadata",e.CONNECTION_STATE_CHANGE="connection-state-change",e.MEDIA_RECONNECT_START="media-reconnect-start",e.MEDIA_RECONNECT_END="media-reconnect-end",e.IS_USING_CLOUD_PROXY="is-using-cloud-proxy",e.USER_JOINED="user-joined",e.USER_LEAVED="user-left",e.USER_PUBLISHED="user-published",e.USER_UNPUBLISHED="user-unpublished",e.USER_INFO_UPDATED="user-info-updated",e.CLIENT_BANNED="client-banned",e.CHANNEL_MEDIA_RELAY_STATE="channel-media-relay-state",e.CHANNEL_MEDIA_RELAY_EVENT="channel-media-relay-event",e.VOLUME_INDICATOR="volume-indicator",e.CRYPT_ERROR="crypt-error",e.ON_TOKEN_PRIVILEGE_WILL_EXPIRE="token-privilege-will-expire",e.ON_TOKEN_PRIVILEGE_DID_EXPIRE="token-privilege-did-expire",e.NETWORK_QUALITY="network-quality",e.STREAM_TYPE_CHANGED="stream-type-changed",e.STREAM_FALLBACK="stream-fallback",e.RECEIVE_METADATA="receive-metadata",e.STREAM_MESSAGE="stream-message",e.LIVE_STREAMING_ERROR="live-streaming-error",e.LIVE_STREAMING_WARNING="live-streaming-warning",e.EXCEPTION="exception",e.ERROR="error",e.P2P_LOST="p2p_lost",e.JOIN_FALLBACK_TO_PROXY="join-fallback-to-proxy",e.CHANNEL_FALLBACK_TO_WEBSOCKET="channel-fallback-to-websocket",e.MEDIA_CONNECTION_TYPE_CHANGE="media-connection-type-change",e.PUBLISHED_USER_LIST="published-user-list",e.CONTENT_INSPECT_CONNECTION_STATE_CHANGE="content-inspect-connection-state-change",e.CONTENT_INSPECT_ERROR="content-inspect-error",e.CONTENT_INSPECT_RESULT="content-inspect-result",e.IMAGE_MODERATION_CONNECTION_STATE_CHANGE="image-moderation-connection-state-change",e}({}),Fn=function(e){return e.NETWORK_ERROR="NETWORK_ERROR",e.SERVER_ERROR="SERVER_ERROR",e.MULTI_IP="MULTI_IP",e.TIMEOUT="TIMEOUT",e.OFFLINE="OFFLINE",e.LEAVE="LEAVE",e.P2P_FAILED="P2P_FAILED",e.FALLBACK="FALLBACK",e.REGIONAL_DISTRIBUTION="REGIONAL_DISTRIBUTION",e}({}),Fs=function(e){return e.ONLINE="ONLINE",e.OFFLINE="OFFLINE",e}({}),SS=function(e){return e.NETWORK_STATE_CHANGE="NETWORK_STATE_CHANGE",e.ONLINE="ONLINE",e.OFFLINE="OFFLINE",e}({});function la(e,t){for(var r=arguments.length,s=new Array(r>2?r-2:0),l=2;l<r;l++)s[l-2]=arguments[l];return e.getListeners(t).length===0?gt.reject(new Ke(se.UNEXPECTED_ERROR,"can not emit promise")):new gt((f,m)=>{e.emit(t,...s,f,m)})}function fr(e,t){if(e.getListeners(t).length===0)return gt.resolve();for(var r=arguments.length,s=new Array(r>2?r-2:0),l=2;l<r;l++)s[l-2]=arguments[l];return la(e,t,...s)}function Gs(e,t){if(e.getListeners(t).length===0)return null;for(var r=arguments.length,s=new Array(r>2?r-2:0),l=2;l<r;l++)s[l-2]=arguments[l];return Fb(e,t,...s)}function Fb(e,t){let r=null,s=null;for(var l=arguments.length,f=new Array(l>2?l-2:0),m=2;m<l;m++)f[m-2]=arguments[m];if(e.emit(t,...f,E=>{r=E},E=>{s=E}),s!==null)throw s;if(r===null)throw new Ke(se.UNEXPECTED_ERROR,"handler is not sync");return r}const na=new class extends Xt{set networkState(e){this.emit(SS.NETWORK_STATE_CHANGE,e,this._networkState),e===Fs.ONLINE?this.emit(SS.ONLINE):e===Fs.OFFLINE&&(this.onlineWaiter=new gt(t=>{this.once(SS.ONLINE,()=>{this.onlineWaiter=void 0,t(Fs.ONLINE)})}),this.emit(SS.OFFLINE)),this._networkState=e}get networkState(){return this._networkState}get isOnline(){return this._networkState===Fs.ONLINE}constructor(){super(),Bt(this,"_moduleName","network-indicator"),Bt(this,"_networkState",Fs.ONLINE),Bt(this,"onlineWaiter",void 0),window.addEventListener("online",()=>{this.networkState=Fs.ONLINE}),window.addEventListener("offline",()=>{this.networkState=Fs.OFFLINE})}};function Qd(e,t){const r=e.indexOf(t);r!==-1&&e.splice(r,1)}function yS(e){const t=[];return e.forEach(r=>{t.indexOf(r)===-1&&t.push(r)}),t}function gL(e){gt!==void 0?gt.resolve().then(e):setTimeout(e,0)}function Mn(e){return JSON.parse(JSON.stringify(e))}function gr(e){try{return Mn(e)}catch{return e}}const D_={};function ph(e,t){D_[t]||(D_[t]=!0,e())}function P_(e){const t=window.atob(e),r=new Uint8Array(new ArrayBuffer(t.length));for(let s=0;s<t.length;s+=1)r[s]=t.charCodeAt(s);return r}function Lg(e){let t="";for(let r=0;r<e.length;r+=1)t+=String.fromCharCode(e[r]);return window.btoa(t)}function bx(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:16,r=new TextEncoder().encode(e);if(r.length>t)r=r.slice(0,t);else if(r.length<t){const s=new Uint8Array(t);s.set(r),r=s}return r}function _L(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];const s=wc(t).call(t,(m,E)=>m+E.length,0),l=new Uint8Array(new ArrayBuffer(s));let f=0;return t.forEach(m=>{l.set(m,f),f+=m.length}),l}function mh(e){return window.TextEncoder?new TextEncoder().encode(e).length:e.length}function EL(e){let t=0;return(/DingTalk/i.test(navigator.userAgent)||/AliApp/i.test(navigator.userAgent))&&e.realFormData&&(e=e.realFormData),e.forEach(r=>{t+=typeof r=="string"?mh(r):r.size}),t+138}function d8(e){const t=new Ke(se.TIMEOUT,"timeout");return new gt((r,s)=>{window.setTimeout(()=>s(t),e)})}function fs(e){return new gt(t=>{window.setTimeout(t,e)})}function Br(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:7,t=arguments.length>1?arguments[1]:void 0;const r=Math.random().toString(16).substr(2,e).toLowerCase();return r.length===e?"".concat(t).concat(r):"".concat(t).concat(r)+Br(e-r.length,"")}function Na(){return Br(32,"").toUpperCase()}const Dg=()=>{},da=new class{constructor(){Bt(this,"fnMap",new Map)}throttleByKey(e,t,r,s){for(var l=arguments.length,f=new Array(l>4?l-4:0),m=4;m<l;m++)f[m-4]=arguments[m];if(this.fnMap.has(t)){const E=this.fnMap.get(t);if(E.threshold!==r){E.fn(...E.args),clearTimeout(E.timer);const y=window.setTimeout(()=>{const b=this.fnMap.get(t);b&&b.fn(...b.args),this.fnMap.delete(t)},r);this.fnMap.set(t,{fn:e,threshold:r,timer:y,args:f,skipFn:s})}else E.skipFn&&E.skipFn(...E.args),this.fnMap.set(t,It(It({},E),{},{fn:e,args:f,skipFn:s}))}else{const E=window.setTimeout(()=>{const y=this.fnMap.get(t);y&&y.fn(...y.args),this.fnMap.delete(t)},r);this.fnMap.set(t,{fn:e,threshold:r,timer:E,args:f,skipFn:s})}}},vL=da.throttleByKey.bind(da);function Xu(e){return typeof e=="object"&&e!==null&&!(e instanceof RegExp)}function Gb(e,t){if(!Xu(e)||!Xu(t)||Array.isArray(e)&&!Array.isArray(t)||!Array.isArray(e)&&Array.isArray(t))return t;if(Array.isArray(t)&&Array.isArray(e)){const r=[...e];for(let s=0;s<t.length;s++)r[s]=Gb(e[s],t[s]);return r}{const r=It({},e);for(const s in t)Object.prototype.hasOwnProperty.call(t,s)&&(Object.prototype.hasOwnProperty.call(e,s)?r[s]=Gb(e[s],t[s]):r[s]=t[s]);return r}}function Cx(e,t){let r=[0];if(r=new Array(t).fill(0),e===0)return r;let s=0;for(;e>0&&(r[s]=255&e,e>>=8,s++,s!==t););return r}function zb(e){return typeof e=="number"?e:e.exact||e.ideal||e.max||e.min||0}function aI(e){return wc(e).call(e,(t,r)=>t+r,0)}function SL(e){const t="0123456789abcdef";function r(Ee){let Re,Ie="";for(Re=0;Re<=3;Re++)Ie+=t.charAt(Ee>>8*Re+4&15)+t.charAt(Ee>>8*Re&15);return Ie}function s(Ee,Re){const Ie=(65535&Ee)+(65535&Re);return(Ee>>16)+(Re>>16)+(Ie>>16)<<16|65535&Ie}function l(Ee,Re,Ie,we,Ue,ve){return s(function(Ne,Ve){return Ne<<Ve|Ne>>>32-Ve}(s(s(Re,Ee),s(we,ve)),Ue),Ie)}function f(Ee,Re,Ie,we,Ue,ve,Ne){return l(Re&Ie|~Re&we,Ee,Re,Ue,ve,Ne)}function m(Ee,Re,Ie,we,Ue,ve,Ne){return l(Re&we|Ie&~we,Ee,Re,Ue,ve,Ne)}function E(Ee,Re,Ie,we,Ue,ve,Ne){return l(Re^Ie^we,Ee,Re,Ue,ve,Ne)}function y(Ee,Re,Ie,we,Ue,ve,Ne){return l(Ie^(Re|~we),Ee,Re,Ue,ve,Ne)}const b=function(Ee){let Re;const Ie=1+(Ee.length+8>>6),we=new Array(16*Ie);for(Re=0;Re<16*Ie;Re++)we[Re]=0;for(Re=0;Re<Ee.length;Re++)we[Re>>2]|=Ee.charCodeAt(Re)<<Re%4*8;return we[Re>>2]|=128<<Re%4*8,we[16*Ie-2]=8*Ee.length,we}(e);let A,O,D,P,F,B=1732584193,Y=-271733879,$=-1732584194,ee=271733878;for(A=0;A<b.length;A+=16)O=B,D=Y,P=$,F=ee,B=f(B,Y,$,ee,b[A+0],7,-680876936),ee=f(ee,B,Y,$,b[A+1],12,-389564586),$=f($,ee,B,Y,b[A+2],17,606105819),Y=f(Y,$,ee,B,b[A+3],22,-1044525330),B=f(B,Y,$,ee,b[A+4],7,-176418897),ee=f(ee,B,Y,$,b[A+5],12,1200080426),$=f($,ee,B,Y,b[A+6],17,-1473231341),Y=f(Y,$,ee,B,b[A+7],22,-45705983),B=f(B,Y,$,ee,b[A+8],7,1770035416),ee=f(ee,B,Y,$,b[A+9],12,-1958414417),$=f($,ee,B,Y,b[A+10],17,-42063),Y=f(Y,$,ee,B,b[A+11],22,-1990404162),B=f(B,Y,$,ee,b[A+12],7,1804603682),ee=f(ee,B,Y,$,b[A+13],12,-40341101),$=f($,ee,B,Y,b[A+14],17,-1502002290),Y=f(Y,$,ee,B,b[A+15],22,1236535329),B=m(B,Y,$,ee,b[A+1],5,-165796510),ee=m(ee,B,Y,$,b[A+6],9,-1069501632),$=m($,ee,B,Y,b[A+11],14,643717713),Y=m(Y,$,ee,B,b[A+0],20,-373897302),B=m(B,Y,$,ee,b[A+5],5,-701558691),ee=m(ee,B,Y,$,b[A+10],9,38016083),$=m($,ee,B,Y,b[A+15],14,-660478335),Y=m(Y,$,ee,B,b[A+4],20,-405537848),B=m(B,Y,$,ee,b[A+9],5,568446438),ee=m(ee,B,Y,$,b[A+14],9,-1019803690),$=m($,ee,B,Y,b[A+3],14,-187363961),Y=m(Y,$,ee,B,b[A+8],20,1163531501),B=m(B,Y,$,ee,b[A+13],5,-1444681467),ee=m(ee,B,Y,$,b[A+2],9,-51403784),$=m($,ee,B,Y,b[A+7],14,1735328473),Y=m(Y,$,ee,B,b[A+12],20,-1926607734),B=E(B,Y,$,ee,b[A+5],4,-378558),ee=E(ee,B,Y,$,b[A+8],11,-2022574463),$=E($,ee,B,Y,b[A+11],16,1839030562),Y=E(Y,$,ee,B,b[A+14],23,-35309556),B=E(B,Y,$,ee,b[A+1],4,-1530992060),ee=E(ee,B,Y,$,b[A+4],11,1272893353),$=E($,ee,B,Y,b[A+7],16,-155497632),Y=E(Y,$,ee,B,b[A+10],23,-1094730640),B=E(B,Y,$,ee,b[A+13],4,681279174),ee=E(ee,B,Y,$,b[A+0],11,-358537222),$=E($,ee,B,Y,b[A+3],16,-722521979),Y=E(Y,$,ee,B,b[A+6],23,76029189),B=E(B,Y,$,ee,b[A+9],4,-640364487),ee=E(ee,B,Y,$,b[A+12],11,-421815835),$=E($,ee,B,Y,b[A+15],16,530742520),Y=E(Y,$,ee,B,b[A+2],23,-995338651),B=y(B,Y,$,ee,b[A+0],6,-198630844),ee=y(ee,B,Y,$,b[A+7],10,1126891415),$=y($,ee,B,Y,b[A+14],15,-1416354905),Y=y(Y,$,ee,B,b[A+5],21,-57434055),B=y(B,Y,$,ee,b[A+12],6,1700485571),ee=y(ee,B,Y,$,b[A+3],10,-1894986606),$=y($,ee,B,Y,b[A+10],15,-1051523),Y=y(Y,$,ee,B,b[A+1],21,-2054922799),B=y(B,Y,$,ee,b[A+8],6,1873313359),ee=y(ee,B,Y,$,b[A+15],10,-30611744),$=y($,ee,B,Y,b[A+6],15,-1560198380),Y=y(Y,$,ee,B,b[A+13],21,1309151649),B=y(B,Y,$,ee,b[A+4],6,-145523070),ee=y(ee,B,Y,$,b[A+11],10,-1120210379),$=y($,ee,B,Y,b[A+2],15,718787259),Y=y(Y,$,ee,B,b[A+9],21,-343485551),B=s(B,O),Y=s(Y,D),$=s($,P),ee=s(ee,F);return r(B)+r(Y)+r($)+r(ee)}let oY=1,wx=console,Gi=class{static setLogger(e){wx=e}constructor(e,t){Bt(this,"id",void 0),Bt(this,"lockingPromise",gt.resolve()),Bt(this,"locks",0),Bt(this,"name",""),Bt(this,"lockId",void 0),this.lockId=oY++,e&&(this.name=e),t&&(this.id=t),this.logger("created")}logger(e,t){const r=(this.id?"[".concat(this.id,"]"):"")+"[lock-".concat(this.name,"-").concat(this.lockId,"]"),s=e==="created"?"is ".concat(e,"."):"is ".concat(e,", current queue ").concat(this.locks,". ").concat(t??"");wx.debug("".concat(r," ").concat(s))}setId(e){this.id=e}get isLocked(){return this.locks>0}lock(e){let t;this.locks+=1,this.logger("locked",e);const r=new gt(l=>{t=()=>{this.locks-=1,this.logger("unlocked",e),l()}}),s=this.lockingPromise.then(()=>t);return this.lockingPromise=this.lockingPromise.then(()=>r),s}};function TS(e,t){return function(r,s,l){const f=l.value;if(typeof f!="function")throw new Error("Cannot use mutex on object property.");return l.value=async function(){const m=this[t];if(!m)throw new Error("mutex property key ".concat(t," doesn't exist on ").concat(e));const E=await m.lock("From ".concat(e,".").concat(s));try{for(var y=arguments.length,b=new Array(y),A=0;A<y;A++)b[A]=arguments[A];return await f.apply(this,b)}finally{E()}},l}}const ra={timeout:500,timeoutFactor:1.5,maxRetryCount:1/0,maxRetryTimeout:1e4};function Qu(e,t){const r=Math.floor(t.timeout*Math.pow(t.timeoutFactor,e));return Math.min(t.maxRetryTimeout,r)}function _l(e,t,r,s){const l=Object.assign({},ra,s);let f=l.timeout;const m=async()=>{await function(b){return new gt(A=>{window.setTimeout(A,b)})}(f),f*=l.timeoutFactor,f=Math.min(l.maxRetryTimeout,f)};let E=!1;const y=new gt(async(b,A)=>{t=t||(()=>!1),r=r||(()=>!0);for(let O=0;O<l.maxRetryCount;O+=1){if(E)return A(new Ke(se.OPERATION_ABORTED));try{const D=await e();if(!t(D,O)||O+1===l.maxRetryCount)return b(D);await m()}catch(D){if(!r(D,O)||O+1===l.maxRetryCount)return A(D);await m()}}});return y.cancel=()=>E=!0,y}let sI,Rx=class{constructor(e){Bt(this,"input",[]),Bt(this,"size",void 0),this.size=e}add(e){this.input.push(e),this.input.length>this.size&&this.input.splice(0,1)}mean(){var e;return this.input.length===0?0:wc(e=this.input).call(e,(t,r)=>t+r)/this.input.length}},oI=0,yL=0;function cI(e,t,r,s){return new gt((l,f)=>{t.responseType=t.responseType||"json",t.data&&!r?(t.data=JSON.stringify(t.data),oI+=mh(t.data)):r&&(t.data.size?oI+=t.data.size:t.data instanceof FormData?oI+=EL(t.data):oI+=mh(JSON.stringify(t.data))),t.headers=t.headers||{},t.headers["Content-Type"]=t.headers["Content-Type"]||"application/json",t.method="POST",t.url=e,En.request(t).then(m=>{typeof m.data=="string"?yL+=mh(m.data):m.data instanceof ArrayBuffer||m.data instanceof Uint8Array?yL+=m.data.byteLength:yL+=mh(JSON.stringify(m.data)),l(m.data)}).catch(m=>{En.isCancel(m)?f(new Ke(se.OPERATION_ABORTED,"cancel token canceled")):m.code==="ECONNABORTED"?f(new Ke(se.NETWORK_TIMEOUT,m.message)):m.response?f(new Ke(se.NETWORK_RESPONSE_ERROR,m.response.status)):f(new Ke(se.NETWORK_ERROR,m.message))})})}async function cY(e,t){const r=new Blob([t.data],{type:"buffer"});return await cI(e,It(It({},t),{},{data:r,headers:{"Content-Type":"application/octet-stream"}}),!0)}const Hb=()=>window.isSecureContext!==void 0;function El(e){if(Array.isArray(e))return e.map(r=>r);if(!TL(e))return e;const t={};for(const r in e){const s=e[r];TL(s)||Array.isArray(s)?t[r]=El(s):t[r]=s}return t}function TL(e){return!(typeof e!="object"||Array.isArray(e)||!e)}let jc=class{constructor(e){Bt(this,"input",[]),Bt(this,"size",void 0),this.size=e}add(e){this.input.push(e),this.input.length>this.size&&this.input.splice(0,1)}diffMean(){return this.input.length===0?0:(this.input[this.input.length-1]-this.input[0])/this.input.length}};const vl={address:"unknown",candidateType:"unknown",id:"unknown",port:0,priority:0,protocol:"unknown",type:"unknown"},Pg={timestamp:0,bitrate:{actualEncoded:0,transmit:0},sendPacketLossRate:0,recvPacketLossRate:0,videoRecv:[],videoSend:[],audioRecv:[],audioSend:[],selectedCandidatePair:{id:"unknown",localCandidate:vl,remoteCandidate:vl},updateInterval:0},Ix={firsCount:0,nacksCount:0,plisCount:0,framesDecodeCount:0,framesDecodeInterval:0,framesDecodeFreezeTime:0,decodeFrameRate:0,bytes:0,packetsLost:0,packetLostRate:0,packets:0,ssrc:0,qpSumPerFrame:0,framesDroppedCount:0,outputFrameRate:0,packetsDiscarded:0,framesAssembledFromMultiplePackets:0,totalProcessingDelay:0,avgDecodeMs:0,avgFramesAssembledFromMultiplePacketsMs:0,avgProcessingDelayMs:0,avgInterFrameDelayMs:0,totalAssemblyTime:0},u8={firsCount:0,nacksCount:0,plisCount:0,frameCount:0,bytes:0,packets:0,packetsLost:0,packetLostRate:0,ssrc:0,rttMs:0,jitterMs:0,qpSumPerFrame:0},bL={bytes:0,packets:0,packetsLost:0,packetLostRate:0,ssrc:0,rttMs:0,jitterMs:0},Ax={jitterBufferMs:0,jitterMs:0,bytes:0,packetsLost:0,packetLostRate:0,packetsDiscarded:0,packets:0,ssrc:0,receivedFrames:0,droppedFrames:0,concealedSamples:0,totalSamplesReceived:0,silentConcealedSamples:0,concealmentEvents:0,freezeMs80:0,freezeMs200:0,freezeSamples80:0,freezeSamples200:0};let lI=class{constructor(e,t){Bt(this,"onFirstVideoReceived",void 0),Bt(this,"onFirstVideoDecoded",void 0),Bt(this,"onFirstAudioReceived",void 0),Bt(this,"onFirstVideoDecodedTimeout",void 0),Bt(this,"onFirstAudioDecoded",void 0),Bt(this,"onSelectedLocalCandidateChanged",void 0),Bt(this,"onSelectedRemoteCandidateChanged",void 0),Bt(this,"videoIsReady",!1),Bt(this,"videoIsReady2",{}),Bt(this,"pc",void 0),Bt(this,"options",void 0),Bt(this,"intervalTimer",void 0),Bt(this,"stats",El(Pg)),Bt(this,"isFirstVideoReceived",{}),Bt(this,"isFirstVideoDecoded",{}),Bt(this,"isFirstAudioReceived",{}),Bt(this,"isFirstAudioDecoded",{}),Bt(this,"isFirstVideoDecodedTimeout",{}),Bt(this,"lossRateWindowStats",[]),this.pc=e,this.options=t,this.intervalTimer=window.setInterval(async()=>{this.updateStats()},this.options.updateInterval)}getStats(){return this.stats}getSelectedCandidatePair(){return new gt(e=>{e({local:It({},vl),remote:It({},vl)})})}setVideoIsReady(e){this.videoIsReady=e}setVideoIsReady2(e,t){this.videoIsReady2[e]=t}getVideoIsReady(e){return this.videoIsReady2[e]||!1}setIsFirstAudioDecoded(e){}destroy(){window.clearInterval(this.intervalTimer),this.pc=void 0}calcLossRate(e){this.lossRateWindowStats.push(e),this.lossRateWindowStats.length>this.options.lossRateInterval&&this.lossRateWindowStats.splice(0,1);const t=this.lossRateWindowStats.length,r=["videoSend","audioSend","videoRecv","audioRecv"];let s=0,l=0,f=0,m=0;for(const E of r)e[E].forEach((y,b)=>{if(!this.lossRateWindowStats[t-1][E][b]||!this.lossRateWindowStats[0][E][b])return;const A=this.lossRateWindowStats[t-1][E][b].packets-this.lossRateWindowStats[0][E][b].packets,O=this.lossRateWindowStats[t-1][E][b].packetsLost-this.lossRateWindowStats[0][E][b].packetsLost;E==="videoSend"||E==="audioSend"?(s+=A,f+=O):(l+=A,m+=O),Number.isNaN(A)||Number.isNaN(A)?y.packetLostRate=0:y.packetLostRate=A<=0||O<=0?0:O/(A+O)});e.sendPacketLossRate=s<=0||f<=0?0:f/(s+f),e.recvPacketLossRate=l<=0||m<=0?0:m/(l+m)}},Zd=class extends lI{constructor(){super(...arguments),Bt(this,"_stats",Pg),Bt(this,"lastDecodeVideoReceiverStats",new Map)}async updateStats(){const e=await this._getStats(),t=this.statsResponsesToObjects(e);this._stats=El(Pg);const r=t.filter(l=>l.type==="ssrc");this.processSSRCStats(r);const s=t.find(l=>l.type==="VideoBwe");s&&this.processBandwidthStats(s),this._stats.timestamp=Date.now(),this.calcLossRate(this._stats),this.stats=this._stats}processBandwidthStats(e){this._stats.bitrate={actualEncoded:Number(e.googActualEncBitrate),targetEncoded:Number(e.googTargetEncBitrate),retransmit:Number(e.googRetransmitBitrate),transmit:Number(e.googTransmitBitrate)},this._stats.sendBandwidth=Number(e.googAvailableSendBandwidth)}processSSRCStats(e){e.forEach(t=>{var r;const s=ht(r=t.id).call(r,"send");switch("".concat(t.mediaType,"_").concat(s?"send":"recv")){case"video_send":{const l=El(u8);l.codec=t.googCodecName,l.adaptionChangeReason="none",t.googCpuLimitedResolution&&(l.adaptionChangeReason="cpu"),t.googBandwidthLimitedResolution&&(l.adaptionChangeReason="bandwidth"),l.avgEncodeMs=Number(t.googAvgEncodeMs),l.inputFrame={width:Number(t.googFrameWidthInput)||Number(t.googFrameWidthSent),height:Number(t.googFrameHeightInput)||Number(t.googFrameHeightSent),frameRate:Number(t.googFrameRateInput)},l.sentFrame={width:Number(t.googFrameWidthSent),height:Number(t.googFrameHeightSent),frameRate:Number(t.googFrameRateInput)},l.firsCount=Number(t.googFirReceived),l.nacksCount=Number(t.googNacksReceived),l.plisCount=Number(t.googPlisReceived),l.frameCount=Number(t.framesEncoded),l.bytes=Number(t.bytesSent),l.packets=Number(t.packetsSent),l.packetsLost=Number(t.packetsLost),l.ssrc=Number(t.ssrc),l.rttMs=Number(t.googRtt||0),this._stats.videoSend.push(l),this._stats.rtt=l.rttMs;break}case"video_recv":{const l=El(Ix),f=this.lastDecodeVideoReceiverStats.get(Number(t.ssrc));if(l.codec=t.googCodecName,l.targetDelayMs=Number(t.googTargetDelayMs),l.renderDelayMs=Number(t.googRenderDelayMs),l.currentDelayMs=Number(t.googCurrentDelayMs),l.minPlayoutDelayMs=Number(t.googMinPlayoutDelayMs),l.decodeMs=Number(t.googDecodeMs),l.maxDecodeMs=Number(t.googMaxDecodeMs),l.receivedFrame={width:Number(t.googFrameWidthReceived),height:Number(t.googFrameHeightReceived),frameRate:Number(t.googFrameRateReceived)},l.decodedFrame={width:Number(t.googFrameWidthReceived),height:Number(t.googFrameHeightReceived),frameRate:Number(t.googFrameRateDecoded)},l.decodeFrameRate=Number(t.googFrameRateDecoded),l.outputFrame={width:Number(t.googFrameWidthReceived),height:Number(t.googFrameHeightReceived),frameRate:Number(t.googFrameRateOutput)},l.jitterBufferMs=Number(t.googJitterBufferMs),l.firsCount=Number(t.googFirsSent),l.nacksCount=Number(t.googNacksSent),l.plisCount=Number(t.googPlisSent),l.framesDecodeCount=Number(t.framesDecoded),l.bytes=Number(t.bytesReceived),l.packets=Number(t.packetsReceived),l.packetsLost=Number(t.packetsLost),l.ssrc=Number(t.ssrc),l.packets>0&&!this.isFirstVideoReceived[l.ssrc]&&(this.onFirstVideoReceived&&this.onFirstVideoReceived(l.ssrc),this.isFirstVideoReceived[l.ssrc]=!0),l.framesDecodeCount>0&&!this.isFirstVideoDecoded[l.ssrc]&&(this.onFirstVideoDecoded&&this.onFirstVideoDecoded(l.ssrc,l.decodedFrame.width,l.decodedFrame.height),this.isFirstVideoDecoded[l.ssrc]=!0),f){const m=f.stats,E=Date.now()-f.lts;l.framesDecodeFreezeTime=m.framesDecodeFreezeTime,l.framesDecodeInterval=m.framesDecodeInterval,l.framesDecodeCount>m.framesDecodeCount&&this.isFirstVideoDecoded[l.ssrc]?(f.lts=Date.now(),l.framesDecodeInterval=E,l.framesDecodeInterval>=this.options.freezeRateLimit&&(this.getVideoIsReady(parseInt(t.ssrc,10))?l.framesDecodeFreezeTime+=l.framesDecodeInterval:this.setVideoIsReady2(parseInt(t.ssrc,10),!0))):l.framesDecodeCount<f.stats.framesDecodeCount&&(l.framesDecodeInterval=0)}this.lastDecodeVideoReceiverStats.set(l.ssrc,{stats:It({},l),lts:Date.now()}),this._stats.videoRecv.push(l);break}case"audio_recv":{const l=El(Ax);l.codec=t.googCodecName,l.outputLevel=Math.abs(Number(t.audioOutputLevel))/32767,l.decodingCNG=Number(t.googDecodingCNG),l.decodingCTN=Number(t.googDecodingCTN),l.decodingCTSG=Number(t.googDecodingCTSG),l.decodingNormal=Number(t.googDecodingNormal),l.decodingPLC=Number(t.googDecodingPLC),l.decodingPLCCNG=Number(t.googDecodingPLCCNG),l.expandRate=Number(t.googExpandRate),l.accelerateRate=Number(t.googAccelerateRate),l.preemptiveExpandRate=Number(t.googPreemptiveExpandRate),l.secondaryDecodedRate=Number(t.googSecondaryDecodedRate),l.speechExpandRate=Number(t.googSpeechExpandRate),l.preferredJitterBufferMs=Number(t.googPreferredJitterBufferMs),l.jitterBufferMs=Number(t.googJitterBufferMs),l.jitterMs=Number(t.googJitterReceived),l.bytes=Number(t.bytesReceived),l.packets=Number(t.packetsReceived),l.packetsLost=Number(t.packetsLost),l.ssrc=Number(t.ssrc),l.receivedFrames=Number(t.googDecodingCTN)||Number(t.packetsReceived),l.droppedFrames=Number(t.googDecodingPLC)+Number(t.googDecodingPLCCNG)||Number(t.packetsLost),l.receivedFrames>0&&!this.isFirstAudioReceived[l.ssrc]&&(this.onFirstAudioReceived&&this.onFirstAudioReceived(l.ssrc),this.isFirstAudioReceived[l.ssrc]=!0),l.decodingNormal>0&&!this.isFirstAudioDecoded[l.ssrc]&&(this.onFirstAudioDecoded&&this.onFirstAudioDecoded(l.ssrc),this.isFirstAudioDecoded[l.ssrc]=!0),this._stats.audioRecv.push(l);break}case"audio_send":{const l=El(bL);l.codec=t.googCodecName,l.inputLevel=Math.abs(Number(t.audioInputLevel))/32767,l.aecReturnLoss=Number(t.googEchoCancellationReturnLoss||0),l.aecReturnLossEnhancement=Number(t.googEchoCancellationReturnLossEnhancement||0),l.residualEchoLikelihood=Number(t.googResidualEchoLikelihood||0),l.residualEchoLikelihoodRecentMax=Number(t.googResidualEchoLikelihoodRecentMax||0),l.bytes=Number(t.bytesSent),l.packets=Number(t.packetsSent),l.packetsLost=Number(t.packetsLost),l.ssrc=Number(t.ssrc),l.rttMs=Number(t.googRtt||0),this._stats.rtt=l.rttMs,this._stats.audioSend.push(l);break}}})}_getStats(){return new gt((e,t)=>{this.pc.getStats(e,t)})}statsResponsesToObjects(e){const t=[];return e.result().forEach(r=>{const s={id:r.id,timestamp:r.timestamp.valueOf().toString(),type:r.type};r.names().forEach(l=>{s[l]=r.stat(l)}),t.push(s)}),t}},bS=function(e){return e.BANDWIDTH="bandwidth",e.CPU="cpu",e.NONE="none",e.OTHER="other",e}({}),Fp=function(e){return e.L1T1="L1T1",e.L1T2="L1T2",e.L1T3="L1T3",e.L1T3_KEY="L1T3_KEY",e.L2T1_KEY="L2T1_KEY",e.L2T2_KEY="L2T2_KEY",e.L2T3_KEY="L2T3_KEY",e.L3T1_KEY="L3T1_KEY",e.L3T2_KEY="L3T2_KEY",e.L3T3_KEY="L3T3_KEY",e}({}),rs=function(e){return e[e.new=0]="new",e[e.connecting=1]="connecting",e[e.connected=2]="connected",e[e.disconnected=3]="disconnected",e[e.failed=4]="failed",e[e.closed=5]="closed",e}({}),cc=function(e){return e.CERTIFICATE="certificate",e.CODEC="codec",e.CANDIDATE_PAIR="candidate-pair",e.LOCAL_CANDIDATE="local-candidate",e.REMOTE_CANDIDATE="remote-candidate",e.INBOUND="inbound-rtp",e.TRACK="track",e.OUTBOUND="outbound-rtp",e.PC="peer-connection",e.REMOTE_INBOUND="remote-inbound-rtp",e.REMOTE_OUTBOUND="remote-outbound-rtp",e.TRANSPORT="transport",e.CSRC="csrc",e.DATA_CHANNEL="data-channel",e.STREAM="stream",e.SENDER="sender",e.RECEIVER="receiver",e}({});var M_=function(e){return e[e.kNone=1]="kNone",e[e.kMillisecondsFromSeconds=1e3]="kMillisecondsFromSeconds",e[e.kBytesToBits=8]="kBytesToBits",e}(M_||{});function CS(e,t,r,s){let l=arguments.length>4&&arguments[4]!==void 0?arguments[4]:M_.kNone;if(!t)return;const f=Number(t[r]);if(typeof f!="number")return;const m=Number(t[s]);if(typeof m!="number")return;if(!e)return m?f/m*l:void 0;const E=Number(e[r]);if(typeof E!="number")return;const y=Number(e[s]);if(typeof y!="number")return;const b=m-y;return b?(f-E)/b*l:void 0}let CL=class extends lI{constructor(){super(...arguments),Bt(this,"_stats",Pg),Bt(this,"report",void 0),Bt(this,"lastDecodeVideoReceiverStats",new Map),Bt(this,"lastVideoFramesRecv",new Map),Bt(this,"lastVideoFramesSent",new Map),Bt(this,"lastVideoFramesDecode",new Map),Bt(this,"lastVideoFramesOutput",new Map),Bt(this,"lastVideoJBDelay",new Map),Bt(this,"lastAudioJBDelay",new Map),Bt(this,"mediaBytesSent",new Map),Bt(this,"mediaBytesRetransmit",new Map),Bt(this,"mediaBytesTargetEncode",new Map),Bt(this,"lastDecodeAudioReceiverStats",new Map),Bt(this,"lastAudioConcealment",new Map),Bt(this,"lastEncoderMs",new Map)}async updateStats(){this.report=await this.pc.getStats(),this._stats=El(Pg),this.report.forEach(e=>{switch(e.type){case cc.OUTBOUND:case cc.INBOUND:{const t=e.mediaType||e.kind,r=!t&&"frameWidth"in e,s=!t&&!("frameWidth"in e);e.type===cc.OUTBOUND?t==="audio"||s?this.processAudioOutboundStats(e):(t==="video"||r)&&this.processVideoOutboundStats(e):e.type===cc.INBOUND&&(t==="audio"||s?this.processAudioInboundStats(e):(t==="video"||r)&&this.processVideoInboundStats(e));break}case cc.TRANSPORT:{const t=this.report.get(e.selectedCandidatePairId);t&&this.processCandidatePairStats(t);break}case cc.CANDIDATE_PAIR:e.selected&&this.processCandidatePairStats(e)}}),this.updateSendBitrate(),this._stats.updateInterval=Date.now()-this.stats.timestamp,this._stats.timestamp=Date.now(),this.calcLossRate(this._stats),this.stats=this._stats}async getSelectedCandidatePair(){const e=await this.pc.getStats(),t={local:It({},vl),remote:It({},vl)};return e.forEach(r=>{let s;if(r.type===cc.TRANSPORT&&(s=e.get(r.selectedCandidatePairId)),r.type===cc.CANDIDATE_PAIR&&r.selected&&(s=r),s){const l=(f,m)=>{f.type=m.type,f.id=m.id,m.address&&(f.address=m.address),m.candidateType&&(f.candidateType=m.candidateType),m.port&&(f.port=m.port),m.priority&&(f.priority=m.priority),m.protocol&&(f.protocol=m.protocol),m.relayProtocol&&(f.relayProtocol=m.relayProtocol)};if(s.localCandidateId){const f=e.get(s.localCandidateId);f&&l(t.local,f)}if(s.remoteCandidateId){const f=e.get(s.remoteCandidateId);f&&l(t.remote,f)}}}),t}processCandidatePairStats(e){if(this._stats.sendBandwidth=e.availableOutgoingBitrate||0,e.currentRoundTripTime&&(this._stats.rtt=1e3*e.currentRoundTripTime),this._stats.videoSend.forEach(t=>{e.currentRoundTripTime&&(t.rttMs=1e3*e.currentRoundTripTime)}),this._stats.audioSend.forEach(t=>{e.currentRoundTripTime&&(t.rttMs=1e3*e.currentRoundTripTime)}),this._stats.selectedCandidatePair.id=e.id,e.localCandidateId){const t=this.report.get(e.localCandidateId);t&&this.processCandidateStats(t)}if(e.remoteCandidateId){const t=this.report.get(e.remoteCandidateId);t&&this.processCandidateStats(t)}}processCandidateStats(e){let t;e.type===cc.LOCAL_CANDIDATE&&(t=this._stats.selectedCandidatePair.localCandidate),e.type===cc.REMOTE_CANDIDATE&&(t=this._stats.selectedCandidatePair.remoteCandidate),t&&(t.type=e.type,t.id=e.id,e.address&&(t.address=e.address),e.candidateType&&(t.candidateType=e.candidateType),e.port&&(t.port=e.port),e.priority&&(t.priority=e.priority),e.protocol&&(t.protocol=e.protocol),e.relayProtocol&&(t.relayProtocol=e.relayProtocol),e.type===cc.LOCAL_CANDIDATE&&this.stats.selectedCandidatePair.localCandidate.id!==t.id&&this.onSelectedLocalCandidateChanged&&this.onSelectedLocalCandidateChanged(It({},t),It({},this.stats.selectedCandidatePair.localCandidate)),e.type===cc.REMOTE_CANDIDATE&&this.stats.selectedCandidatePair.remoteCandidate.id!==t.id&&this.onSelectedRemoteCandidateChanged&&this.onSelectedRemoteCandidateChanged(It({},t),It({},this.stats.selectedCandidatePair.remoteCandidate)))}processAudioInboundStats(e){let t=this._stats.audioRecv.find(s=>s.ssrc===e.ssrc);t||(t=El(Ax),this._stats.audioRecv.push(t)),t.ssrc=e.ssrc,t.packets=e.packetsReceived,t.packetsLost=e.packetsLost,t.packetsDiscarded=e.packetsDiscarded,t.bytes=e.bytesReceived,t.jitterMs=1e3*e.jitter,t.retransmittedBytesReceived=e.retransmittedBytesReceived,t.retransmittedPacketsReceived=e.retransmittedPacketsReceived,t.totalProcessingDelay=e.totalProcessingDelay,t.jitterBufferEmittedCount=e.jitterBufferEmittedCount;const r=this.lastDecodeAudioReceiverStats.get(t.ssrc);t.avgProcessingDelayMs=CS(r,t,"totalProcessingDelay","jitterBufferEmittedCount",M_.kMillisecondsFromSeconds),this.processAudioTrackReceiverStats(e,e.trackId,t),this.calculateAudioFreeze(t,r,e),e.codecId&&(t.codec=this.getCodecFromCodecStats(e.codecId)),t.receivedFrames||(t.receivedFrames=e.packetsReceived),t.droppedFrames||(t.droppedFrames=e.packetsLost),t.receivedFrames>0&&!this.isFirstAudioReceived[t.ssrc]&&(this.onFirstAudioReceived&&this.onFirstAudioReceived(t.ssrc),this.isFirstAudioReceived[t.ssrc]=!0),t.outputLevel&&t.outputLevel>0&&!this.isFirstAudioDecoded[t.ssrc]&&(this.onFirstAudioDecoded&&this.onFirstAudioDecoded(t.ssrc),this.isFirstAudioDecoded[t.ssrc]=!0),typeof e.concealedSamples=="number"&&(t.concealedSamples=e.concealedSamples),this.lastDecodeAudioReceiverStats.set(t.ssrc,It({},t))}calculateAudioFreeze(e,t,r){const s=this.lastAudioConcealment.get(e.ssrc);if(t!=null&&s!=null){const l=s.lts,f=r.timestamp,m=f-l;if(m<=0)return;const E=e.concealedSamples-t.concealedSamples-0,y=s.nonSilent+E,b=e.totalSamplesReceived-t.totalSamplesReceived;if(b<=0)return;const A=80*b/m,O=200*b/m,D=m/b;let P=0;e.freezeSamples80=t.freezeSamples80,e.freezeMs80=t.freezeMs80,y>A&&(s.plc80>0?(e.freezeSamples80+=E,e.freezeMs80+=Math.round(E*D)):(e.freezeSamples80+=y,e.freezeMs80+=Math.round(y*D)),P=s.plc80+1);let F=0;e.freezeSamples200=t.freezeSamples200,e.freezeMs200=t.freezeMs200,y>O&&(s.plc200>0?(e.freezeSamples200+=E,e.freezeMs200+=Math.round(E*D)):(e.freezeSamples200+=y,e.freezeMs200+=Math.round(y*D)),F=s.plc200+1),this.lastAudioConcealment.set(e.ssrc,{nonSilent:E,lts:f,plc80:P,plc200:F})}else e.freezeSamples80=0,e.freezeSamples200=0,e.freezeMs80=0,e.freezeMs200=0,this.lastAudioConcealment.set(e.ssrc,{nonSilent:0,lts:r.timestamp,plc80:0,plc200:0})}processVideoInboundStats(e){let t=this._stats.videoRecv.find(m=>m.ssrc===e.ssrc);t||(t=El(Ix),this._stats.videoRecv.push(t)),t.ssrc=e.ssrc,t.packets=e.packetsReceived,t.packetsLost=e.packetsLost,t.bytes=e.bytesReceived,t.firsCount=e.firCount,t.nacksCount=e.nackCount,t.plisCount=e.pliCount,t.framesDecodeCount=e.framesDecoded,t.framesDroppedCount=e.framesDropped,t.totalInterFrameDelay=e.totalInterFrameDelay,t.totalSquaredInterFrameDelay=e.totalSquaredInterFrameDelay,t.totalFreezesDuration=e.totalFreezesDuration,t.totalProcessingDelay=e.totalProcessingDelay,t.packetsDiscarded=e.packetsDiscarded,t.framesAssembledFromMultiplePackets=e.framesAssembledFromMultiplePackets,t.totalAssemblyTime=e.totalAssemblyTime,t.keyFramesDecoded=e.keyFramesDecoded,t.retransmittedBytesReceived=e.retransmittedBytesReceived,t.retransmittedPacketsReceived=e.retransmittedPacketsReceived;const r=this.lastDecodeVideoReceiverStats.get(t.ssrc),s=this.lastVideoFramesDecode.get(t.ssrc),l=this.lastVideoFramesOutput.get(t.ssrc),f=Date.now();if(t.framesDecodeCount>0&&!this.isFirstVideoDecoded[t.ssrc]){const m=t.decodedFrame?t.decodedFrame.width:0,E=t.decodedFrame?t.decodedFrame.height:0;this.onFirstVideoDecoded&&this.onFirstVideoDecoded(t.ssrc,m,E),this.isFirstVideoDecoded[t.ssrc]=!0}if(r){const m=r.stats,E=f-r.lts;t.framesDecodeFreezeTime=m.framesDecodeFreezeTime,t.framesDecodeInterval=m.framesDecodeInterval,!this.isFirstVideoDecoded[t.ssrc]&&E>this.options.firstVideoDecodedTimeout&&!this.isFirstVideoDecodedTimeout[t.ssrc]&&(this.onFirstVideoDecodedTimeout&&this.onFirstVideoDecodedTimeout(t.ssrc),this.isFirstVideoDecodedTimeout[t.ssrc]=!0),t.framesDecodeCount>m.framesDecodeCount&&this.isFirstVideoDecoded[t.ssrc]?(r.lts=Date.now(),t.framesDecodeInterval=E,t.framesDecodeInterval>=this.options.freezeRateLimit&&(this.getVideoIsReady(parseInt(e.ssrc))?t.framesDecodeFreezeTime+=t.framesDecodeInterval:this.setVideoIsReady2(parseInt(e.ssrc,10),!0))):t.framesDecodeCount<m.framesDecodeCount&&(t.framesDecodeInterval=0),e.framesDecoded&&e.qpSum&&(r.stats.framesDecodeCount>e.framesDecoded?t.qpSumPerFrame=e.qpSum/e.framesDecoded:t.qpSumPerFrame=(e.qpSum-r.qpSum)/(e.framesDecoded-r.stats.framesDecodeCount))}e.totalDecodeTime&&(t.decodeMs=1e3*e.totalDecodeTime,t.avgDecodeMs=CS(r==null?void 0:r.stats,t,"decodeMs","framesDecodeCount")),t.avgProcessingDelayMs=CS(r==null?void 0:r.stats,t,"totalProcessingDelay","framesDecodeCount",M_.kMillisecondsFromSeconds),t.avgFramesAssembledFromMultiplePacketsMs=CS(r==null?void 0:r.stats,t,"totalAssemblyTime","framesAssembledFromMultiplePackets",M_.kMillisecondsFromSeconds),t.avgInterFrameDelayMs=CS(r==null?void 0:r.stats,t,"totalInterFrameDelay","framesDecodeCount",M_.kMillisecondsFromSeconds),s&&f-s.lts>=800?(t.decodeFrameRate=Math.round((t.framesDecodeCount-s.count)/((f-s.lts)/1e3)),this.lastVideoFramesDecode.set(t.ssrc,{count:t.framesDecodeCount,lts:f,rate:t.decodeFrameRate})):s?t.decodeFrameRate=s.rate:this.lastVideoFramesDecode.set(t.ssrc,{count:t.framesDecodeCount,lts:f,rate:0}),t.framesDroppedCount&&e.framesReceived&&(l&&f-l.lts>=800?(t.outputFrameRate=Math.round((e.framesReceived-t.framesDroppedCount-l.count)/((f-l.lts)/1e3)),this.lastVideoFramesOutput.set(t.ssrc,{count:e.framesReceived-t.framesDroppedCount,lts:f,rate:Math.max(t.outputFrameRate,0)})):l?t.outputFrameRate=l.rate:this.lastVideoFramesOutput.set(t.ssrc,{count:e.framesReceived-t.framesDroppedCount,lts:f,rate:0})),this.processVideoTrackReceiverStats(e,e.trackId,t),e.codecId&&(t.codec=this.getCodecFromCodecStats(e.codecId)),e.framerateMean&&(t.framesRateFirefox=e.framerateMean),t.packets>0&&!this.isFirstVideoReceived[t.ssrc]&&(this.onFirstVideoReceived&&this.onFirstVideoReceived(t.ssrc),this.isFirstVideoReceived[t.ssrc]=!0),this.lastDecodeVideoReceiverStats.set(t.ssrc,{stats:It({},t),lts:r?r.lts:Date.now(),qpSum:e.qpSum})}processVideoOutboundStats(e){let t=this._stats.videoSend.find(s=>s.ssrc===e.ssrc);t||(t=El(u8),this._stats.videoSend.push(t));const r=this.mediaBytesSent.get(e.ssrc);if(r)r.add(e.bytesSent);else{const s=new jc(10);s.add(e.bytesSent),this.mediaBytesSent.set(e.ssrc,s)}if(e.retransmittedBytesSent!==void 0){const s=this.mediaBytesRetransmit.get(e.ssrc);if(s)s.add(e.retransmittedBytesSent);else{const l=new jc(10);l.add(e.retransmittedBytesSent),this.mediaBytesRetransmit.set(e.ssrc,l)}}if(e.totalEncodedBytesTarget){const s=this.mediaBytesTargetEncode.get(e.ssrc);if(s)s.add(e.totalEncodedBytesTarget);else{const l=new jc(10);l.add(e.totalEncodedBytesTarget),this.mediaBytesTargetEncode.set(e.ssrc,l)}}if(t.ssrc=e.ssrc,t.bytes=e.bytesSent,t.packets=e.packetsSent,t.firsCount=e.firCount,t.nacksCount=e.nackCount,t.plisCount=e.pliCount,t.frameCount=e.framesEncoded,t.adaptionChangeReason=e.qualityLimitationReason,t.scalabilityMode=e.scalabilityMode,t.retransmittedBytesSent=e.retransmittedBytesSent,t.retransmittedPacketsSent=e.retransmittedPacketsSent,t.hugeFramesSent=e.hugeFramesSent,t.keyFramesEncoded=e.keyFramesEncoded,t.targetBitrate=e.targetBitrate,e.totalEncodeTime&&e.framesEncoded){const s=this.lastEncoderMs.get(e.ssrc);if(!s||s.lastFrameCount>e.framesEncoded)t.avgEncodeMs=1e3*e.totalEncodeTime/e.framesEncoded;else{const l=e.framesEncoded-s.lastFrameCount,f=e.totalEncodeTime-s.lastEncoderTime;t.avgEncodeMs=1e3*f/l}}if(e.framesEncoded&&e.qpSum){const s=this.lastEncoderMs.get(e.ssrc);!s||s.lastFrameCount>e.framesEncoded?t.qpSumPerFrame=e.qpSum/e.framesEncoded:t.qpSumPerFrame=(e.qpSum-s.lastQpSum)/(e.framesEncoded-s.lastFrameCount)}if(this.lastEncoderMs.set(e.ssrc,{lastFrameCount:e.framesEncoded,lastEncoderTime:e.totalEncodeTime,lastQpSum:e.qpSum,lts:Date.now()}),e.codecId&&(t.codec=this.getCodecFromCodecStats(e.codecId)),e.mediaSourceId&&this.processVideoMediaSource(e.mediaSourceId,t),this.processVideoTrackSenderStats(e,e.trackId,t),e.remoteId)this.processRemoteInboundStats(e.remoteId,t);else{const s=this.findRemoteStatsId(e.ssrc,cc.REMOTE_INBOUND);s&&this.processRemoteInboundStats(s,t)}}processAudioOutboundStats(e){let t=this._stats.audioSend.find(r=>r.ssrc===e.ssrc);if(t||(t=El(bL),this._stats.audioSend.push(t)),t.ssrc=e.ssrc,t.packets=e.packetsSent,t.bytes=e.bytesSent,t.retransmittedBytesSent=e.retransmittedBytesSent,t.retransmittedPacketsSent=e.retransmittedPacketsSent,e.mediaSourceId&&this.processAudioMediaSource(e.mediaSourceId,t),e.codecId&&(t.codec=this.getCodecFromCodecStats(e.codecId)),this.processAudioTrackSenderStats(e,e.trackId,t),e.remoteId)this.processRemoteInboundStats(e.remoteId,t);else{const r=this.findRemoteStatsId(e.ssrc,cc.REMOTE_INBOUND);r&&this.processRemoteInboundStats(r,t)}}findRemoteStatsId(e,t){var r;const s=Array.from(oc(r=this.report).call(r)).find(l=>l.type===t&&l.ssrc===e);return s?s.id:null}processVideoMediaSource(e,t){const r=this.report.get(e);r&&r.width&&r.height&&r.framesPerSecond&&(t.inputFrame={width:r.width,height:r.height,frameRate:r.framesPerSecond})}processAudioMediaSource(e,t){const r=this.report.get(e);r&&(t.inputLevel=r.audioLevel)}processVideoTrackSenderStats(e,t,r){var s,l,f,m;const E=t?this.report.get(t):void 0,y=(s=E==null?void 0:E.framesSent)!==null&&s!==void 0?s:e.framesSent;if(typeof y!="number")return;let b=(l=E==null?void 0:E.frameWidth)!==null&&l!==void 0?l:e.frameWidth,A=(f=E==null?void 0:E.frameHeight)!==null&&f!==void 0?f:e.frameHeight,O=(m=E==null?void 0:E.framesPerSecond)!==null&&m!==void 0?m:e.framesPerSecond;if(typeof b=="number"&&typeof A=="number"||(b=0,A=0),O==null){const D=Date.now(),P=this.lastVideoFramesSent.get(r.ssrc);P&&D-P.lts>=800?(O=Math.round((y-P.count)/((D-P.lts)/1e3)),this.lastVideoFramesSent.set(r.ssrc,{count:y,lts:D,rate:O})):P?O=P.rate:this.lastVideoFramesSent.set(r.ssrc,{count:y,lts:D,rate:0})}r.sentFrame={width:b,height:A,frameRate:Math.max(0,O)}}processVideoTrackReceiverStats(e,t,r){var s,l,f,m,E;const y=t?this.report.get(t):void 0,b=(s=y==null?void 0:y.framesReceived)!==null&&s!==void 0?s:e.framesReceived,A=(l=y==null?void 0:y.frameWidth)!==null&&l!==void 0?l:e.frameWidth,O=(f=y==null?void 0:y.frameHeight)!==null&&f!==void 0?f:e.frameHeight,D=(m=y==null?void 0:y.jitterBufferDelay)!==null&&m!==void 0?m:e.jitterBufferDelay,P=(E=y==null?void 0:y.jitterBufferEmittedCount)!==null&&E!==void 0?E:e.jitterBufferEmittedCount;if(typeof b=="number"){const F=this.lastVideoFramesRecv.get(r.ssrc),B=Date.now();r.framesReceivedCount=b;let Y=0;F&&B-F.lts>=800?(Y=Math.round((b-F.count)/((B-F.lts)/1e3)),this.lastVideoFramesRecv.set(r.ssrc,{count:b,lts:B,rate:Y})):F?Y=F.rate:this.lastVideoFramesRecv.set(r.ssrc,{count:b,lts:B,rate:0}),r.receivedFrame={width:A||0,height:O||0,frameRate:Y||0},r.decodedFrame={width:A||0,height:O||0,frameRate:r.decodeFrameRate||0},r.outputFrame={width:A||0,height:O||0,frameRate:r.outputFrameRate||r.decodeFrameRate||0}}if(D&&P){const F=this.lastVideoJBDelay.get(r.ssrc)||{jitterBufferDelay:0,jitterBufferEmittedCount:0,jitterBufferMs:0};let B=F.jitterBufferMs;const Y=P-F.jitterBufferEmittedCount;Y>0&&(B=1e3*(D-F.jitterBufferDelay)/Y),r.jitterBufferMs=B,r.currentDelayMs=Math.round(B),this.lastVideoJBDelay.set(r.ssrc,{jitterBufferDelay:D,jitterBufferEmittedCount:P,jitterBufferMs:r.currentDelayMs})}}processAudioTrackSenderStats(e,t,r){var s,l,f,m;const E=t?this.report.get(t):void 0,y=(s=(l=E==null?void 0:E.echoReturnLoss)!==null&&l!==void 0?l:e.echoReturnLoss)!==null&&s!==void 0?s:0,b=(f=(m=E==null?void 0:E.echoReturnLossEnhancement)!==null&&m!==void 0?m:e.echoReturnLossEnhancement)!==null&&f!==void 0?f:0;r.aecReturnLoss=y,r.aecReturnLossEnhancement=b}processAudioTrackReceiverStats(e,t,r){var s,l,f,m,E,y,b,A,O;const D=t?this.report.get(t):void 0,P=(s=D==null?void 0:D.removedSamplesForAcceleration)!==null&&s!==void 0?s:e.removedSamplesForAcceleration,F=(l=D==null?void 0:D.totalSamplesReceived)!==null&&l!==void 0?l:e.totalSamplesReceived,B=(f=D==null?void 0:D.jitterBufferDelay)!==null&&f!==void 0?f:e.jitterBufferDelay,Y=(m=D==null?void 0:D.jitterBufferEmittedCount)!==null&&m!==void 0?m:e.jitterBufferEmittedCount,$=(E=D==null?void 0:D.audioLevel)!==null&&E!==void 0?E:e==null?void 0:e.audioLevel,ee=(y=D==null?void 0:D.totalSamplesDuration)!==null&&y!==void 0?y:e==null?void 0:e.totalSamplesDuration,Ee=(b=D==null?void 0:D.concealedSamples)!==null&&b!==void 0?b:e.concealedSamples,Re=(A=D==null?void 0:D.silentConcealedSamples)!==null&&A!==void 0?A:e.silentConcealedSamples,Ie=(O=D==null?void 0:D.concealmentEvents)!==null&&O!==void 0?O:e.concealmentEvents;if(typeof F=="number"&&(r.totalSamplesReceived=F),typeof Re=="number"&&(r.silentConcealedSamples=Re),typeof Ie=="number"&&(r.concealmentEvents=Ie),typeof Ee=="number"&&(r.concealedSamples=Ee),P&&F&&(r.accelerateRate=P/F),B&&Y){const Ue=this.lastAudioJBDelay.get(r.ssrc)||{jitterBufferDelay:0,jitterBufferEmittedCount:0,jitterBufferMs:0};let ve=Ue.jitterBufferMs;const Ne=Y-Ue.jitterBufferEmittedCount;Ne>0&&(ve=1e3*(B-Ue.jitterBufferDelay)/Ne),r.jitterBufferMs=Math.round(ve),this.lastAudioJBDelay.set(r.ssrc,{jitterBufferDelay:B,jitterBufferEmittedCount:Y,jitterBufferMs:r.jitterBufferMs})}r.outputLevel=$;let we=1920;ee&&F&&(we=F/ee/50,r.receivedFrames=Math.round(F/we)),Ee&&(r.droppedFrames=Math.round(Ee/we))}processRemoteInboundStats(e,t){const r=this.report.get(e);r&&(t.packetsLost=r.packetsLost,r.roundTripTime&&(t.rttMs=1e3*r.roundTripTime),r.jitter&&(t.jitterMs=1e3*r.jitter),r.timestamp&&(t.timestamp=r.timestamp))}getCodecFromCodecStats(e){const t=this.report.get(e);if(!t)return"";const r=t.mimeType.match(/\/(.*)$/);return r&&r[1]?r[1]:""}updateSendBitrate(){let e=0,t=null,r=null;this.mediaBytesSent.forEach(l=>{e+=l.diffMean()}),this.mediaBytesRetransmit.forEach(l=>{t=t===null?l.diffMean():t+l.diffMean()}),this.mediaBytesTargetEncode.forEach(l=>{r=r===null?l.diffMean():r+l.diffMean()});const s=t!==null?e-t:e;this._stats.bitrate={actualEncoded:8*s/(this.options.updateInterval/1e3),transmit:8*e/(this.options.updateInterval/1e3)},t!==null&&(this._stats.bitrate.retransmit=8*t/(this.options.updateInterval/1e3)),r!==null&&(this._stats.bitrate.targetEncoded=8*r/(this.options.updateInterval/1e3))}},ai=class extends lI{updateStats(){return gt.resolve()}};function Sr(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:250,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:8,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:500,l=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1e4;const f=function(){const m=navigator.userAgent.toLocaleLowerCase().match(/chrome\/[\d]*/i);return m&&m[0]?Number(m[0].split("/")[1]):null}();return f?f<76?new Zd(e,{updateInterval:t,lossRateInterval:r,freezeRateLimit:s,firstVideoDecodedTimeout:l}):new CL(e,{updateInterval:t,lossRateInterval:r,freezeRateLimit:s,firstVideoDecodedTimeout:l}):function(m){if(!window.RTCStatsReport)return!1;const E=m.getStats();return!!(E instanceof gt||function(y){return!!y&&(typeof y=="object"||typeof y=="function")&&typeof y.then=="function"}(E))}(e)?new CL(e,{updateInterval:t,lossRateInterval:r,freezeRateLimit:s,firstVideoDecodedTimeout:l}):new ai(e,{updateInterval:t,lossRateInterval:r,freezeRateLimit:s,firstVideoDecodedTimeout:l})}const ge="websdk_ng_install_id";function wL(){try{if(me("INSTALL_ID"))return me("INSTALL_ID");let e=window.localStorage.getItem(ge);return e||(e=Na(),window.localStorage.setItem(ge,e)),Dn("INSTALL_ID",e),e}catch{return}}const hs=function(e){if(e.match(/[0-9]+\.[0-9]+\.[0-9]+$/))return e;const t=e.match(/([0-9]+\.[0-9]+\.[0-9]+)\-([0-9]+)/);if(t&&t[1]&&t[2]){const r=t[1],s=t[2];return"".concat(r,".").concat(s)}return"4.0.0.999"}("4.23.4"),Ln=function(){try{return JSON.parse("true")===!0}catch{return!0}}();let Gp=function(e){return e.Default="default",e.Auto="auto",e.Relay="relay",e.SdRtn="sd-rtn",e}({});const ps=function(){const e="us".concat("erna","me"),t="pa".concat("sswo","rd"),r=["t","s","t"];r.splice(1,0,"e");const s=r.join(""),l=[];for(let E=0;E<6;E++)l.push("1");const f=l.join(""),m={};return m[e]=s,m[t]=f,Object.assign(m,{turnServerURL:"",tcpport:3433,udpport:3478,forceturn:!1})}();window.DEFAULT_TURN_CONFIG=ps;const RL={ENABLE_PUBLISHED_USER_LIST:!0,MAX_SUBSCRIPTION:50,SUBSCRIBE_AUDIO_FILTER_TOPN:void 0,ENABLE_PUBLISH_AUDIO_FILTER:void 0,ENABLE_USER_LICENSE_CHECK:!0,DISABLE_FEC:void 0,ENABLE_NTP_REPORT:!1,ENABLE_INSTANT_VIDEO:!1,ENABLE_USER_AUTO_REBALANCE_CHECK:!0,ENABLE_LOSSBASED_BWE:!0,ENABLE_AUT_CC:!1,ENABLE_CC_FALLBACK:void 0,SUBSCRIBE_TWCC:!0,PUBLISH_TWCC:!1,ENABLE_SVC_DEFAULT_CODECS:["H264","VP8","VP9","AV1"],SVC:[],ENABLE_FULL_LINK_AV_SYNC:!1,SVC_MODE:null,PRE_SUB_NUM:2,ENABLE_AUT_FEEDBACK:!1,SVC_EXTENDED:["VP9"]},IL={MIN_FRAME_RATE:1,MAX_FRAME_RATE:30,MAX_THRESHOLD_FRAMERATE:30,BITRATE_MIN_THRESHOLD:100,BITRATE_MAX_THRESHOLD:100,MAX_SCALE:5,BWE_SCALE_UP_THRESHOLD:.6,BWE_SCALE_DOWN_THRESHOLD:.6,PERF_SCALE_UP_THRESHOLD:.7,PERF_SCALE_DOWN_THRESHOLD:.6,MOTION_RESOLUTION_FACTOR:.8,MOTION_BITRATE_FACTOR:.6,DETAIL_FRAMERATE_FACTOR:.8,DETAIL_BITRATE_FACTOR:.6,BALANCE_RESOLUTION_FACTOR:.9,BALANCE_FRAMERATE_FACTOR:.9,BALANCE_BITRATE_FACTOR:.6,OVERUSE_TIMES_THRESHOLD:10,UNDERUSE_TIMES_THRESHOLD:40},k_="v4.23.4-0-g17410532-dirty(6/5/2025, 4:24:52 PM)",Ox={ENABLE_EVENT_REPORT:!0,UPLOAD_LOG:!1,ENABLE_AG_ADAPTATION:!0,FORCE_AG_HIGH_FRAMERATE:!1,FORCE_SUPPORT_AG_ADAPTATION:!1,ENCODER_CONFIG_LIMIT:{},CAMERA_CAPTURE_CONFIG:void 0,ENABLE_PRELOAD:!0,NEW_ICE_RESTART:!1,ICE_RESTART_INTERVAL:1e4,RESTART_SEQUENCE:["udp_tcp_relay","relay"],FIRST_TCP_CANDIDATE:!1,FIRST_TCP_CANDIDATE_INTERVAL:1e3,TURN_DOMAIN:"edge.agora.io",USE_TURN_IP:!1,NEW_TURN_MODE:void 0,NEW_FORCE_TURN:!1,USE_NEW_RENDER_FREEZE_TIME:!1},ti=It(It(It(It({},Ox),{},{PROCESS_ID:"",ENCRYPT_AES:!0,AREAS:["CHINA","GLOBAL"],WEBCS_DOMAIN:["webrtc2-ap-web-1.agora.io","webrtc2-2.ap.sd-rtn.com"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-ap-web-3.agora.io","webrtc2-4.ap.sd-rtn.com"],PROXY_CS:["ap-proxy-1.agora.io","ap-proxy-2.agora.io"],CDS_AP:["cds-ap-web-1.agora.io","cds-web-2.ap.sd-rtn.com","cds-ap-web-3.agora.io","cds-web-4.ap.sd-rtn.com"],ACCOUNT_REGISTER:["sua-ap-web-1.agora.io","sua-web-2.ap.sd-rtn.com","sua-ap-web-3.agora.io","sua-web-4.ap.sd-rtn.com"],UAP_AP:["uap-ap-web-1.agora.io","uap-web-2.ap.sd-rtn.com","uap-ap-web-3.agora.io","uap-web-4.ap.sd-rtn.com"],LOG_UPLOAD_SERVER:"logservice.agora.io",EVENT_REPORT_DOMAIN:"statscollector-1.agora.io",EVENT_REPORT_BACKUP_DOMAIN:"web-2.statscollector.sd-rtn.com",GATEWAY_ADDRESS:[],GATEWAY_WSS_ADDRESS:"",LIVE_STREAMING_ADDRESS:"",HTTP_CONNECT_TIMEOUT:5e3,SIGNAL_REQUEST_TIMEOUT:1e4,REPORT_STATS:!0,NOT_REPORT_EVENT:[],PING_PONG_TIME_OUT:10,WEBSOCKET_TIMEOUT_MIN:1e4,EVENT_REPORT_SEND_INTERVAL:3e3,CONFIG_DISTRIBUTE_INTERVAL:3e5,ENABLE_CONFIG_DISTRIBUTE:!0,CANDIDATE_TIMEOUT:5e3,SHOW_REPORT_INVOKER_LOG:!1,SHOW_REPORT_USER_INVOKER_LOG:!0,JOIN_EXTEND:"",PUB_EXTEND:"",SUB_EXTEND:"",FORCE_TURN:!1,TURN_ENABLE_TCP:!0,TURN_ENABLE_UDP:!0,MAX_UPLOAD_CACHE:50,UPLOAD_CACHE_INTERVAL:2e3,AJAX_REQUEST_CONCURRENT:3,REPORT_APP_SCENARIO:void 0,GATEWAY_DOMAINS:["edge.agora.io","edge.sd-rtn.com"],CONNECT_GATEWAY_WITHOUT_DOMAIN:!1,WORKER_DOMAIN:"edge.agora.io",EVENT_REPORT_RETRY:!0,CHROME_FORCE_PLAN_B:!1,AUDIO_SOURCE_VOLUME_UPDATE_INTERVAL:400,AUDIO_SOURCE_AVG_VOLUME_DURATION:3e3,AUDIO_VOLUME_INDICATION_INTERVAL:2e3,VOLUME_VOICE_WEIGHT:10,GET_VOLUME_OF_MUTED_AUDIO_TRACK:!1,STATS_UPDATE_INTERVAL:250,NORMAL_EVENT_QUEUE_CAPACITY:100,CUSTOM_REPORT:!0,CUSTOM_REPORT_LIMIT:20,PROXY_SERVER_TYPE2:"webnginx-proxy.agora.io",PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.sd-rtn.com","webrtc-cloud-proxy.agora.io"],CUSTOM_PUB_ANSWER_MODIFIER:null,CUSTOM_SUB_ANSWER_MODIFIER:null,CUSTOM_PUB_OFFER_MODIFIER:null,CUSTOM_SUB_OFFER_MODIFIER:null,DSCP_TYPE:"high",REMOVE_NEW_CODECS:!0,FRAGEMENT_LENGTH:3,WEBSOCKET_COMPRESS:!1,SIMULCAST:!1,PRELOAD_MEDIA_COUNT:0,CHECK_VIDEO_VISIBLE_INTERVAL:3e4,CHECK_LOCAL_STATS_INTERVAL:250,PROFILE_SWITCH_INTERVAL:2e3,UNSUPPORTED_VIDEO_CODEC:[],ENUMERATE_DEVICES_INTERVAL:!1,ENUMERATE_DEVICES_INTERVAL_TIME:1e4,USE_NEW_TOKEN:!1,CLOSE_AFB_FOR_LOCAL_AP:!0,JOIN_MAX_CONCURRENCY:6,JOIN_WITH_FALLBACK_SIGNAL_PROXY:!0,JOIN_WITH_FALLBACK_MEDIA_PROXY:!0,JOIN_WITH_FALLBACK_MEDIA_PROXY_FORCE:!1,JOIN_GATEWAY_TRY_443PORT_DURATION:2e3,JOIN_GATEWAY_USE_443PORT_ONLY:!1,JOIN_GATEWAY_USE_DUAL_DOMAIN:!0,JOIN_GATEWAY_FALLBACK_PORT:443,USE_TURN_SERVER_OF_GATEWAY:!1,H264_PROFILE_LEVEL_ID:"",USE_NEW_LOG:!1,LOG_VERSION:3,MEDIA_DEVICE_CONSTRAINTS:null,ENCRYPT_PROXY_USERNAME_AND_PSW:!0,SDP_LOGGING:!1,CSP_DETECTED_HOSTNAME_LIST:["agora.io","sd-rtn.com"],REMOTE_AUDIO_TRACK_USES_WEB_AUDIO:!1,LOCAL_AUDIO_TRACK_USES_WEB_AUDIO:!1,BITRATE_ADAPTER_TYPE:"STANDARD_BITRATE",AI_DENOISER_PARAMETERS:{excludedLinks:[]},ADJUST_3A_FROM_PLUGINS:!0,RAISE_H264_BASELINE_PRIORITY:!0,FILTER_SEND_H264_BASELINE:!1,FIRST_H264_PROFILE_LEVEL_ID:"42001f",FIRST_PACKETIZATION_MODE:"",X_GOOGLE_START_BITRATE:void 0,NEW_REPORT_SERVER:!1,NEW_REPORT_SERVER_DOMAINS:["data-reporting.agora.io","data-reporting.agora.io"],VIDEO_INSPECT_WORKER_MESSAGE_LENGTH_LIMIT:3e5,VIDEO_INSPECT_INTERVAL_MINIMUM:1e3,VIDEO_INSPECT_QUALITY_RATIO:.9,VIDEO_INSPECT_WORKER_MANAGER_HOST:"edge.agora.io",VIDEO_INSPECT_WORKER_MANAGER_PORT:"",VIDEO_INSPECT_WORKER_PORT:"",SHOW_VIDEO_INSPECT_WORKER_MESSAGE:!1,STATS_COLLECTOR_PORT:443,FORCE_TURN_TCP:!1,WEBAUDIO_INIT_OPTIONS:void 0,FILTER_VIDEO_FEC:!0,FILTER_AUDIO_FEC:!1,CHROME_DUAL_STREAM_USE_ENCODING:!0,DISABLE_DUAL_STREAM_USE_ENCODING:!1,EXTENSION_USAGE_UPLOAD_INTERVAL:1e4,ICE_RESTART:!0,FINGERPRINT:null,ENABLE_VIDEO_FRAME_CALLBACK:!0,VIDEO_FREEZE_DURATION:500,SPATIALIZER_PARAMETERS:{},UPLOAD_LOG_INTERVAL:3e3,UPLOAD_LOG_REQUEST_RETRY_INTERVAL:2e3,UPLOAD_LOG_REQUEST_MAX_RETRY_INTERVAL:2e4,UPLOAD_LOG_TRY_INTERVAL_WHILE_OFF:5e3,UPLOAD_LOG_RETRY_INTERVAL_V1:1e4,UPLOAD_LOG_TWICE_RETRY_INTERVAL_V1:200,UPLOAD_LOG_LENGTH_EACH_TIME:10,APP_TYPE:0,DISABLE_WEBAUDIO:!1,CHANNEL_MEDIA_RELAY_SERVERS:void 0,KEEP_LAST_FRAME:!0,FORWARD_P2P_CREATION:!0,SYNC_GROUP:!0,BLOCK_LOCAL_CLIENT:!1,ENABLE_AUDIO_TOPN:!1,ENABLE_AUDIO_METADATA:!1,ENABLE_AUDIO_PTS_METADATA:!1,TOPN_SMOOTH_LEVEL:void 0,TOPN_NEW_SPEAKER_DELAY:void 0,TOPN_SWITCH_HOLD_MS:void 0,TOPN_AUDIO_GAIN:void 0,TOPN_SILENCE_THRESHOLD:250,AP_AREA:!0,ENABLE_ENCODED_TRANSFORM:!1,ENABLE_VIDEO_SEI:!1,IMAGE_MODERATION_WORKER_HOST:"edge.agora.io",IMAGE_MODERATION_WORKER_MESSAGE_LENGTH_LIMIT:3e5,IMAGE_MODERATION_INTERVAL_MINIMUM:1e3,SHOW_IMAGE_MODERATION_WORKER_MESSAGE:!1,IMAGE_MODERATION_QUALITY_RATIO:.9,IMAGE_MODERATION_UPLOAD_REPORT_INTERVAL:5e3,SHOW_GLOBAL_CLIENT_LIST:!1,DATASTREAM_MAX_RETRANSMITS:10,TCP_CANDIDATE_ONLY:!1,EXTERNAL_SIGNAL_REQUEST_TIMEOUT:3e3,SHOW_P2P_LOG:!1,MAX_P2P_TIMEOUT:3e4,P2P_TOKEN_INTERVAL:1e3,SHOW_DATASTREAM2_LOG:!1,RESTRICTION_SET_PLAYBACK_DEVICE:!0,USE_PURE_ENCRYPTION_MASTER_KEY:!1,ENABLE_AUDIO_RED:!1,OPUS_PTIME:void 0,AUDIO_DUPLICATE_NUM:void 0,ACCOUNT_REGISTER_RETRY_TIMEOUT:1,ACCOUNT_REGISTER_RETRY_RATIO:2,ACCOUNT_REGISTER_RETRY_TIMEOUT_MAX:6e4,ACCOUNT_REGISTER_RETRY_COUNT_MAX:1e5,AUDIO_CONTEXT:null,WEBCS_BACKUP_CONNECT_TIMEOUT:6e3,PLAYER_STATE_DEFER:2e3,SIGNAL_REQUEST_WATCH_INTERVAL:1e3,FILEPATH_LENMAX:255,DUALSTREAM_OPERATION_CHECK:!0,MEDIA_ELEMENT_EXISTS_DEPTH:3,SHIM_CANDIDATE:!1,LEAVE_MSG_TIMEOUT:2e3,STATS_FILTER:{transportId:!0,googTrackId:!0},FILTER_VIDEO_CODEC:[],USE_NEW_NETWORK_CONFIG:!1,AUTO_RESET_AUDIO_ROUTE:!1,PLUGIN_INFO:[],OVERUSE_DETECTOR_PARAMS:IL,CUSTOM_ADAPTATION_DEFAULT_MODE:"",HIDE_NO_POSTER:!1,AP_CACHE_NUM:10,AP_UPDATE_INTERVAL:12e4,AP_CACHE_LIFETIME:12e4,MAX_PRELOAD_ASYNC_LENGTH:3,DISABLE_SCREEN_SHARE_REMB:!1},RL),{},{USE_CANDIDATE_FROM_AP_DETAIL:!1,AP_REQUEST_DETAIL:void 0,ENABLE_ROLE_SELECT_EDGE:!1,CLIENT_ROLE_OPTIONS:void 0,COMPATIBLE_SDP_EXTENSION:["gdpr_forbidden"],LIMIT_BITRATE:void 0,EXPERIMENTS:{},USE_PUB_RTX:!0,USE_SUB_RTX:!0,ENABLE_DATASTREAM_2:!1,USE_XR:!0,ENABLE_PREALLOC_PC:!1,ENABLE_PRE_SUB:!1,ENABLE_SVC:!1},{INSTALL_ID:""}),{},{K_MIN_RENDER_DELAY:66,USE_STANDARD_BITRATE_DEFAULT:!1,VIDEO_NEW_BITRATE_RATIO:void 0,VIDEO_STANDARD_BITRATE_VERSION:void 0,BASELINE_MORE_H264_BITRATE_RATIO:1.1});function Dn(e,t,r){var s,l,f;ht(s=Object.keys(ti)).call(s,e)&&(!r&&ht(l=Object.keys(gh)).call(l,e)||(ti[e]=t,e!=="ENABLE_VIDEO_SEI"&&e!=="ENABLE_AUDIO_TOPN"&&e!=="ENABLE_AUDIO_METADATA"&&e!=="ENABLE_AUDIO_PTS_METADATA"||t!==!0||(ti.ENABLE_ENCODED_TRANSFORM=!0,e==="ENABLE_AUDIO_PTS_METADATA"&&(ti.ENABLE_AUDIO_METADATA=!0)),e==="USE_NEW_NETWORK_CONFIG"&&t&&(f=!!t,ti.USE_NEW_NETWORK_CONFIG=f,f&&(ti.WEBCS_DOMAIN=["webrtc2-2.ap.sd-rtn.com"],ti.WEBCS_DOMAIN_BACKUP_LIST=["webrtc2-4.ap.sd-rtn.com"],ti.CDS_AP=["cds-web-2.ap.sd-rtn.com","cds-web-4.ap.sd-rtn.com"],ti.ACCOUNT_REGISTER=["sua-web-2.ap.sd-rtn.com","sua-web-4.ap.sd-rtn.com"],ti.EVENT_REPORT_DOMAIN="web-2.statscollector.sd-rtn.com",ti.EVENT_REPORT_BACKUP_DOMAIN="statscollector-1.agora.io",ti.GATEWAY_DOMAINS=["edge.sd-rtn.com"])),e==="ENABLE_PRE_SUB"&&t&&(ti.ENABLE_INSTANT_VIDEO=!0,ti.ENABLE_PREALLOC_PC=!0),e==="ENABLE_SVC"&&t&&(ti.ENABLE_AUT_CC=!0),e==="NEW_FORCE_TURN"&&t&&(ti.NEW_TURN_MODE||(ti.NEW_TURN_MODE=4))))}function me(e){return ti[e]}Ln||(ti.WEBCS_DOMAIN=["ap-web-1-oversea.agora.io","ap-web-1-north-america.agora.io"],ti.WEBCS_DOMAIN_BACKUP_LIST=["ap-web-2-oversea.agora.io","ap-web-2-north-america.agora.io"],ti.PROXY_CS=["proxy-ap-web-oversea.agora.io","proxy-ap-web-america.agora.io"],ti.CDS_AP=["cds-ap-web-oversea.agora.io","cds-ap-web-america.agora.io","cds-ap-web-america2.agora.io"],ti.ACCOUNT_REGISTER=["sua-ap-web-oversea.agora.io","sua-ap-web-america.agora.io","sua-ap-web-america2.agora.io"],ti.UAP_AP=["uap-ap-web-oversea.agora.io","uap-ap-web-america.agora.io","uap-ap-web-america2.agora.io"],ti.LOG_UPLOAD_SERVER="logservice-oversea.agora.io",ti.EVENT_REPORT_DOMAIN="statscollector-1-oversea.agora.io",ti.EVENT_REPORT_BACKUP_DOMAIN="statscollector-2-oversea.agora.io",ti.PROXY_SERVER_TYPE3="webrtc-cloud-proxy.agora.io",ti.AREAS=["NORTH_AMERICA","OVERSEA"]);let f8=function(e){return e[e.REALTIME=1]="REALTIME",e}({});const gh={};var Gn=function(e){return e.SET_SESSION_ID="SET_SESSION_ID",e.SET_P2P_ID="SET_P2P_id",e.SET_DC_ID="SET_DC_id",e.SET_UID="SET_UID",e.SET_INT_UID="SET_INT_UID",e.SET_PUB_ID="SET_PUB_ID",e.SET_CLOUD_PROXY_SERVER_MODE="SET_CLOUD_PROXY_SERVER_MODE",e.KEY_METRIC_CLIENT_CREATED="KEY_METRIC_CLIENT_CREATED",e.KEY_METRIC_JOIN_START="KEY_METRIC_JOIN_START",e.KEY_METRIC_JOIN_END="KEY_METRIC_JOIN_END",e.KEY_METRIC_REQUEST_AP_START="KEY_METRIC_REQUEST_AP_START",e.KEY_METRIC_REQUEST_AP_END="KEY_METRIC_REQUEST_AP_END",e.KEY_METRIC_JOIN_GATEWAY_START="KEY_METRIC_JOIN_GATEWAY_START",e.KEY_METRIC_JOIN_GATEWAY_END="KEY_METRIC_JOIN_GATEWAY_END",e.KEY_METRIC_PEER_CONNECTION_START="KEY_METRIC_PEER_CONNECTION_START",e.KEY_METRIC_PEER_CONNECTION_END="KEY_METRIC_PEER_CONNECTION_END",e.KEY_METRIC_DESCRIPTION_START="KEY_METRIC_DESCRIPTION_START",e.KEY_METRIC_ICE_CONNECTION_END="KEY_METRIC_ICE_CONNECTION_END",e.KEY_METRIC_SIGNAL_CHANNEL_OPEN="KEY_METRIC_SIGNAL_CHANNEL_OPEN",e.KEY_METRIC_PUBLISH="KEY_METRIC_PUBLISH",e.KEY_METRIC_SUBSCRIBE="KEY_METRIC_SUBSCRIBE",e.RECORD_JOIN_CHANNEL_SERVICE="RECORD_JOIN_CHANNEL_SERVICE",e.RESET_JOIN_CHANNEL_SERVICE_RECORDS="RESET_JOIN_CHANNEL_SERVICE_RECORDS",e.RESET_KEY_METRICS="RESET_KEY_METRICS",e.SET_USE_P2P="SET_USE_P2P",e.SET_TRANSPORT_TYPE="SET_TRANSPORT_TYPE",e}(Gn||{});let AL=function(e){return e.h264="h264",e.h265="h265",e.vp8="vp8",e.vp9="vp9",e.av1="av1",e}({});(function(e){e.opus="opus",e.pcma="pcma",e.pcmu="pcmu",e.g722="g722"})({});const h8=128,Nx=96,p8=1e3,Wb=10;let td=0;var Lx=(()=>{var e={8:(s,l,f)=>{f.r(l),f.d(l,{Parser:()=>Ne,Printer:()=>Se,parse:()=>tt,print:()=>St});const m=`
`,E="".concat("\r").concat(m),y=" ";let b;function A(Ze){return Ze>="0"&&Ze<="9"}function O(Ze){return Ze>="!"&&Ze<="~"}function D(Ze){return O(Ze)||Ze>=""&&Ze<=""}function P(Ze){return Ze==="!"||Ze>="#"&&Ze<="'"||Ze>="*"&&Ze<="+"||Ze>="-"&&Ze<="."||Ze>="0"&&Ze<="9"||Ze>="A"&&Ze<="Z"||Ze>="^"&&Ze<="~"}function F(Ze){return Ze>="1"&&Ze<="9"}function B(Ze){return Ze>="A"&&Ze<="Z"||Ze>="a"&&Ze<="z"}function Y(Ze){return Ze==="d"||Ze==="h"||Ze==="m"||Ze==="s"}function $(Ze){return Ze>""&&Ze<"	"||Ze>"\v"&&Ze<"\f"||Ze>""&&Ze<""}function ee(Ze){return B(Ze)||A(Ze)||Ze==="+"||Ze==="/"}function Ee(Ze){return A(Ze)||B(Ze)||Ze==="+"||Ze==="/"||Ze==="-"||Ze==="_"}function Re(Ze){return B(Ze)||A(Ze)||Ze==="+"||Ze==="/"}function Ie(Ze,J){var _e=Object.keys(Ze);if(Object.getOwnPropertySymbols){var be=Object.getOwnPropertySymbols(Ze);J&&(be=be.filter(function(ot){return Object.getOwnPropertyDescriptor(Ze,ot).enumerable})),_e.push.apply(_e,be)}return _e}function we(Ze){for(var J=1;J<arguments.length;J++){var _e=arguments[J]!=null?arguments[J]:{};J%2?Ie(Object(_e),!0).forEach(function(be){Ue(Ze,be,_e[be])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Ze,Object.getOwnPropertyDescriptors(_e)):Ie(Object(_e)).forEach(function(be){Object.defineProperty(Ze,be,Object.getOwnPropertyDescriptor(_e,be))})}return Ze}function Ue(Ze,J,_e){return J in Ze?Object.defineProperty(Ze,J,{value:_e,enumerable:!0,configurable:!0,writable:!0}):Ze[J]=_e,Ze}(function(Ze){Ze.VERSION="v",Ze.ORIGIN="o",Ze.SESSION_NAME="s",Ze.INFORMATION="i",Ze.URI="u",Ze.EMAIL="e",Ze.PHONE="p",Ze.CONNECTION="c",Ze.BANDWIDTH="b",Ze.TIME="t",Ze.REPEAT="r",Ze.ZONE_ADJUSTMENTS="z",Ze.KEY="k",Ze.ATTRIBUTE="a",Ze.MEDIA="m"})(b||(b={}));class ve{consumeText(J,_e){let be=_e;for(;be<J.length;){const ot=J[be];if(ot==="\0"||ot==="\r"||ot===m)break;be+=1}if(be-_e==0)throw new Error("Invalid text, at ".concat(J));return be}consumeUnicastAddress(J,_e,be){return this.consumeTill(J,_e,y)}consumeOneOrMore(J,_e,be){let ot=_e;for(;be(J[ot]);)ot++;if(ot-_e==0)throw new Error("Invalid rule at ".concat(_e,"."));return ot}consumeSpace(J,_e){if(J[_e]===y)return _e+1;throw new Error("Invalid space at ".concat(_e,"."))}consumeIP4Address(J,_e){let be=_e;for(let ot=0;ot<4;ot++)if(be=this.consumeDecimalUChar(J,be),ot!==3){if(J[be]!==".")throw new Error("Invalid IP4 address.");be++}return be}consumeDecimalUChar(J,_e){let be=_e;for(let an=0;an<3&&A(J[be]);an++,be++);if(be-_e==0)throw new Error("Invalid decimal uchar.");const ot=parseInt(J.slice(_e,be));if(ot>=0&&ot<=255)return be;throw new Error("Invalid decimal uchar")}consumeIP6Address(J,_e){let be=this.consumeHexpart(J,_e);return J[be]===":"&&(be+=1,be=this.consumeIP4Address(J,be)),be}consumeHexpart(J,_e){let be=_e;if(J[be]===":"&&J[be+1]===":"){be+=2;try{be=this.consumeHexseq(J,be)}catch{}return be}if(be=this.consumeHexseq(J,be),J[be]===":"&&J[be+1]===":"){be+=2;try{be=this.consumeHexseq(J,be)}catch{}return be}return be}consumeHexseq(J,_e){let be=_e;for(;be=this.consumeHex4(J,be),J[be]===":"&&J[be+1]!==":";)be+=1;return be}consumeHex4(J,_e){let be=0;for(;be<4;be++)if(!((ot=J[_e+be])>="0"&&ot<="9"||ot>="a"&&ot<="f"||ot>="A"&&ot<="F")){if(be===0)throw new Error("Invalid hex 4");break}var ot;return _e+be}consumeFQDN(J,_e){let be=_e;for(;A(J[be])||B(J[be])||J[be]==="-"||J[be]===".";)be+=1;if(be-_e<4)throw new Error("Invalid FQDN");return be}consumeExtnAddr(J,_e){return this.consumeOneOrMore(J,_e,D)}consumeMulticastAddress(J,_e,be){switch(be){case"IP4":case"ip4":return this.consumeIP4MulticastAddress(J,_e);case"IP6":case"ip6":return this.consumeIP6MulticastAddress(J,_e);default:try{return this.consumeFQDN(J,_e)}catch{return this.consumeExtnAddr(J,_e)}}}consumeIP6MulticastAddress(J,_e){const be=this.consumeHexpart(J,_e);return J[be]==="/"?this.consumeInteger(J,be+1):be}consumeIP4MulticastAddress(J,_e){let be=_e+3;const ot=J.slice(_e,be),an=parseInt(ot);if(an<224||an>239)throw new Error("Invalid IP4 multicast address, IPv4 multicast addresses may be in the range 224.0.0.0 to 239.255.255.255.");for(let hr=0;hr<3;hr++){if(J[be]!==".")throw new Error("Invalid IP4 multicast address.");be+=1,be=this.consumeDecimalUChar(J,be)}return J[be]==="/"&&(be+=1),be=this.consumeTTL(J,be),J[be]==="/"&&(be=this.consumeInteger(J,be)),be}consumeInteger(J,_e){if(!F(J[_e]))throw new Error("Invalid integer.");for(_e+=1;A(J[_e]);)_e+=1;return _e}consumeTTL(J,_e){if(J[_e]==="0")return _e+1;if(!F(J[_e]))throw new Error("Invalid TTL.");_e+=1;for(let be=0;be<2&&A(J[_e]);be++)_e+=1;return _e}consumeToken(J,_e){return this.consumeOneOrMore(J,_e,P)}consumeTime(J,_e){let be=_e;if(J[be]==="0")return be+1;for(F(J[be])&&(be+=1);A(J[be]);)be++;if(be-_e<10)throw new Error("Invalid time");return be}consumeAddress(J,_e){return this.consumeTill(J,_e,y)}consumeTypedTime(J,_e){let be=_e;return be=this.consumeOneOrMore(J,be,A),Y(J[be])?be+1:be}consumeRepeatInterval(J,_e){if(!F(J[_e]))throw new Error("Invalid repeat interval");for(_e+=1;A(J[_e]);)_e+=1;return Y(J[_e])&&(_e+=1),_e}consumePort(J,_e){return this.consumeOneOrMore(J,_e,A)}consume(J,_e,be){for(let ot=0;ot<be.length;ot++){if(_e+ot>=J.length)throw new Error("consume exceeding value length");if(J[_e+ot]!==be[ot])throw new Error("consume ".concat(be," failed at ").concat(ot))}return _e+be.length}consumeTill(J,_e,be){let ot=_e;for(;ot<J.length&&(typeof be!="string"||J[ot]!==be)&&(typeof be!="function"||!be(J[ot]));)ot++;return ot}}class Ne extends ve{constructor(){super(),Ue(this,"records",[]),Ue(this,"currentLine",0)}parse(J){const _e=this.probeEOL(J);this.records=J.split(_e).filter($c=>!!Eo($c).call($c)).map(this.parseLine),this.currentLine=0;const be=this.parseVersion(),ot=this.parseOrigin(),an=this.parseSessionName(),hr=this.parseInformation(),Bi=this.parseUri(),Hr=this.parseEmail(),gi=this.parsePhone(),Wr=this.parseConnection(),Ws=this.parseBandWidth(),Ml=this.parseTimeFields(),Fi=this.parseKey(),Zn=this.parseSessionAttribute(),Ta=this.parseMediaDescription();if(this.currentLine!==this.records.length)throw new Error("parsing failed, non exhaustive sdp lines.");return{version:be,origin:ot,sessionName:an,information:hr,uri:Bi,emails:Hr,phones:gi,connection:Wr,bandwidths:Ws,timeFields:Ml,key:Fi,attributes:Zn,mediaDescriptions:Ta}}getCurrentRecord(){const J=this.records[this.currentLine];if(!J)throw new Error("Record doesn't exit.");return J}probeEOL(J){for(let _e=0;_e<J.length;_e++)if(J[_e]===m)return J[_e-1]==="\r"?E:m;throw new Error("Invalid newline character.")}parseLine(J,_e){if(J.length<2)throw new Error("Invalid sdp line, sdp line should be of form <type>=<value>.");const be=J[0];if(J[1]!=="=")throw new Error('Invalid sdp line, <type> should be a single character followed by an "=" sign.');return{type:be,value:J.slice(2),line:_e,cur:0}}parseSessionAttribute(){const J=new Be;for(;this.currentLine<this.records.length;){const _e=this.getCurrentRecord();if(_e.type!==b.ATTRIBUTE)break;const be={attField:this.extractOneOrMore(_e,ot=>P(ot)&&ot!==":"),_cur:0};_e.value[_e.cur]===":"&&(_e.cur+=1,be.attValue=this.extractOneOrMore(_e,$)),J.parse(be),this.currentLine++}return J.digest()}parseMediaAttributes(J){const _e=new W(J);for(;this.currentLine<this.records.length;){const be=this.getCurrentRecord();if(be.type!==b.ATTRIBUTE)break;const ot={attField:this.extractOneOrMore(be,an=>P(an)&&an!==":"),_cur:0};be.value[be.cur]===":"&&(be.cur+=1,ot.attValue=this.extractOneOrMore(be,$)),_e.parse(ot),this.currentLine++}return _e.digest()}parseKey(){const J=this.getCurrentRecord();if(J.type===b.KEY){if(J.value==="prompt"||J.value==="clear:"||J.value==="base64:"||J.value==="uri:")return J.value;throw this.currentLine++,new Error("Invalid key.")}}parseZone(){const J=this.getCurrentRecord();if(J.type===b.ZONE_ADJUSTMENTS){const _e=[];for(;;)try{const be=this.extract(J,this.consumeTime);this.consumeSpaceForRecord(J);let ot=!1;J.value[J.cur]==="-"&&(ot=!0,J.cur+=1);const an=this.extract(J,this.consumeTypedTime);_e.push({time:be,typedTime:an,back:ot})}catch{break}if(_e.length===0)throw new Error("Invalid zone adjustments");return this.currentLine++,_e}return[]}parseRepeat(){const J=[];for(;;){const _e=this.getCurrentRecord();if(_e.type!==b.REPEAT)break;{const be=this.extract(_e,this.consumeRepeatInterval),ot=this.parseTypedTime(_e);J.push({repeatInterval:be,typedTimes:ot}),this.currentLine++}}return J}parseTypedTime(J){const _e=[];for(;;)try{this.consumeSpaceForRecord(J),_e.push(this.extract(J,this.consumeTypedTime))}catch{break}if(_e.length===0)throw new Error("Invalid typed time.");return _e}parseTime(){const J=this.getCurrentRecord(),_e=this.extract(J,this.consumeTime);this.consumeSpaceForRecord(J);const be=this.extract(J,this.consumeTime);return this.currentLine++,{startTime:_e,stopTime:be}}parseBandWidth(){const J=[];for(;this.currentLine<this.records.length;){const _e=this.getCurrentRecord();if(_e.type!==b.BANDWIDTH)break;{const be=this.extractOneOrMore(_e,P);if(_e.value[_e.cur]!==":")throw new Error("Invalid bandwidth field.");_e.cur++;const ot=this.extractOneOrMore(_e,A);J.push({bwtype:be,bandwidth:ot}),this.currentLine++}}return J}parseVersion(){const J=this.getCurrentRecord();if(J.type!==b.VERSION)throw new Error("first sdp record must be version");const _e=J.value.slice(0,this.consumeOneOrMore(J.value,0,A));if(_e.length!==J.value.length)throw new Error('invalid proto version, "v='.concat(J.value,'"'));return this.currentLine++,_e}parseOrigin(){const J=this.getCurrentRecord();if(J.type!==b.ORIGIN)throw new Error("second line of sdp must be origin");const _e=this.extractOneOrMore(J,D);this.consumeSpaceForRecord(J);const be=this.extractOneOrMore(J,A);this.consumeSpaceForRecord(J);const ot=this.extractOneOrMore(J,A);this.consumeSpaceForRecord(J);const an=this.extractOneOrMore(J,P);this.consumeSpaceForRecord(J);const hr=this.extractOneOrMore(J,P);this.consumeSpaceForRecord(J);const Bi=this.extract(J,this.consumeUnicastAddress);return this.currentLine++,{username:_e,sessId:be,sessVersion:ot,nettype:an,addrtype:hr,unicastAddress:Bi}}parseSessionName(){const J=this.getCurrentRecord();if(J.type===b.SESSION_NAME){const _e=this.extract(J,this.consumeText);return this.currentLine++,_e}}parseInformation(){const J=this.getCurrentRecord();if(J.type!==b.INFORMATION)return;const _e=this.extract(J,this.consumeText);return this.currentLine++,_e}parseUri(){const J=this.getCurrentRecord();if(J.type===b.URI)return this.currentLine++,J.value}parseEmail(){const J=[];for(;;){const _e=this.getCurrentRecord();if(_e.type!==b.EMAIL)break;J.push(_e.value),this.currentLine++}return J}parsePhone(){const J=[];for(;;){const _e=this.getCurrentRecord();if(_e.type!==b.PHONE)break;J.push(_e.value),this.currentLine++}return J}parseConnection(){const J=this.getCurrentRecord();if(J.type===b.CONNECTION){const _e=this.extractOneOrMore(J,P);this.consumeSpaceForRecord(J);const be=this.extractOneOrMore(J,P);this.consumeSpaceForRecord(J);const ot=this.extract(J,this.consumeAddress);return this.currentLine++,{nettype:_e,addrtype:be,address:ot}}}parseMedia(){const J=this.getCurrentRecord(),_e=this.extract(J,this.consumeToken);this.consumeSpaceForRecord(J);let be=this.extract(J,this.consumePort);J.value[J.cur]==="/"&&(J.cur+=1,be+=this.extract(J,this.consumeInteger)),this.consumeSpaceForRecord(J);const ot=[];for(ot.push(this.extract(J,this.consumeToken));J.value[J.cur]==="/";)J.cur+=1,ot.push(this.extract(J,this.consumeToken));if(ot.length===0)throw new Error("Invalid proto");const an=this.parseFmt(J);return this.currentLine++,{mediaType:_e,port:be,protos:ot,fmts:an}}parseTimeFields(){const J=[];for(;this.getCurrentRecord().type===b.TIME;){const _e=this.parseTime(),be=this.parseRepeat(),ot=this.parseZone();J.push({time:_e,repeats:be,zones:ot})}return J}parseMediaDescription(){const J=[];for(;this.currentLine<this.records.length&&this.getCurrentRecord().type===b.MEDIA;){const _e=this.parseMedia(),be=this.parseInformation(),ot=this.parseConnections(),an=this.parseBandWidth(),hr=this.parseKey(),Bi=this.parseMediaAttributes(_e);J.push({media:_e,information:be,connections:ot,bandwidths:an,key:hr,attributes:Bi})}return J}parseConnections(){const J=[];for(;this.currentLine<this.records.length&&this.getCurrentRecord().type===b.CONNECTION;)J.push(this.parseConnection());return J}parseFmt(J){const _e=[];for(;;)try{this.consumeSpaceForRecord(J),_e.push(this.extract(J,this.consumeToken))}catch{break}if(_e.length===0)throw new Error("Invalid fmts");return _e}extract(J,_e){for(var be=arguments.length,ot=new Array(be>2?be-2:0),an=2;an<be;an++)ot[an-2]=arguments[an];const hr=_e.call(this,J.value,J.cur,...ot),Bi=J.value.slice(J.cur,hr);return J.cur=hr,Bi}extractOneOrMore(J,_e){const be=this.consumeOneOrMore(J.value,J.cur,_e),ot=J.value.slice(J.cur,be);return J.cur=be,ot}consumeSpaceForRecord(J){if(J.value[J.cur]!==y)throw new Error("Invalid space at ".concat(J.cur,"."));J.cur+=1}}class Ve extends ve{constructor(){super(...arguments),Ue(this,"attributes",void 0),Ue(this,"digested",!1)}extractOneOrMore(J,_e,be){const ot=this.consumeOneOrMore(J.attValue,J._cur,_e),an=J.attValue.slice(J._cur,ot),[hr,Bi]=be||[];if(typeof hr=="number"&&an.length<hr)throw new Error("error in length, should be more or equal than ".concat(hr," characters."));if(typeof Bi=="number"&&an.length>Bi)throw new Error("error in length, should be less or equal than ".concat(Bi," characters."));return J._cur=ot,an}consumeAttributeSpace(J){if(J.attValue[J._cur]!==y)throw new Error("Invalid space at ".concat(J._cur,"."));J._cur+=1}extract(J,_e){if(!J.attValue)throw new Error("Nothing to extract from attValue.");for(var be=arguments.length,ot=new Array(be>2?be-2:0),an=2;an<be;an++)ot[an-2]=arguments[an];const hr=_e.call(this,J.attValue,J._cur,...ot),Bi=J.attValue.slice(J._cur,hr);return J._cur=hr,Bi}atEnd(J){if(!J.attValue)throw new Error;return J._cur>=J.attValue.length}peekChar(J){if(!J.attValue)throw new Error;return J.attValue[J._cur]}peek(J,_e){if(!J.attValue)throw new Error;for(let be=0;be<_e.length;be++)if(_e[be]!==J.attValue[J._cur+be])return!1;return!0}parseIceUfrag(J){if(this.attributes.iceUfrag)throw new Error("Invalid ice-ufrag, should be only a single line if 'a=ice-ufrag'");this.attributes.iceUfrag=this.extractOneOrMore(J,ee,[4,256])}parseIcePwd(J){if(this.attributes.icePwd)throw new Error("Invalid ice-pwd, should be only a single line if 'a=ice-pwd'");this.attributes.icePwd=this.extractOneOrMore(J,ee,[22,256])}parseIceOptions(J){if(this.attributes.iceOptions)throw new Error("Invalid ice-options, should be only one 'ice-options' line");const _e=[];for(;!this.atEnd(J);){_e.push(this.extractOneOrMore(J,ee));try{this.consumeAttributeSpace(J)}catch(be){if(this.atEnd(J))break;throw be}}this.attributes.iceOptions=_e}parseFingerprint(J){const _e=this.extract(J,this.consumeToken);this.consumeAttributeSpace(J);const be=this.extract(J,this.consumeTill);this.attributes.fingerprints.push({hashFunction:_e,fingerprint:be})}parseExtmap(J){const _e=this.extractOneOrMore(J,A);let be;this.peekChar(J)==="/"&&(this.extract(J,this.consume,"/"),be=this.extract(J,this.consumeToken)),this.consumeAttributeSpace(J);const ot=this.extract(J,this.consumeTill,y),an=we(we({entry:parseInt(_e,10)},be&&{direction:be}),{},{extensionName:ot});this.peekChar(J)===y&&(this.consumeAttributeSpace(J),an.extensionAttributes=this.extract(J,this.consumeTill)),this.attributes.extmaps.push(an)}parseSetup(J){if(this.attributes.setup)throw new Error("must only be one single 'a=setup' line.");const _e=this.extract(J,this.consumeTill);if(_e!=="active"&&_e!=="passive"&&_e!=="actpass"&&_e!=="holdconn")throw new Error("role must be one of 'active', 'passive', 'actpass', 'holdconn'.");this.attributes.setup=_e}}class Be extends Ve{constructor(){super(...arguments),Ue(this,"attributes",{unrecognized:[],groups:[],extmaps:[],fingerprints:[],identities:[]})}parse(J){if(this.digested)throw new Error("already digested");try{switch(J.attField){case"group":this.parseGroup(J);break;case"ice-lite":this.parseIceLite();break;case"ice-ufrag":this.parseIceUfrag(J);break;case"ice-pwd":this.parseIcePwd(J);break;case"ice-options":this.parseIceOptions(J);break;case"fingerprint":this.parseFingerprint(J);break;case"setup":this.parseSetup(J);break;case"tls-id":this.parseTlsId(J);break;case"identity":this.parseIdentity(J);break;case"extmap":this.parseExtmap(J);break;case"msid-semantic":this.parseMsidSemantic(J);break;default:J.ignored=!0,this.attributes.unrecognized.push(J)}}catch(_e){throw console.error("parsing session attribute ".concat(J.attField,' error, "a=').concat(J.attField,":").concat(J.attValue,'"')),_e}if(!J.ignored&&J.attValue&&!this.atEnd(J))throw new Error("attribute parsing error")}digest(){return this.digested=!0,this.attributes}parseGroup(J){const _e=this.extract(J,this.consumeToken),be=[];for(;!this.atEnd(J)&&this.peekChar(J)===y;)this.consumeAttributeSpace(J),be.push(this.extract(J,this.consumeToken));this.attributes.groups.push({semantic:_e,identificationTag:be})}parseIceLite(){if(this.attributes.iceLite)throw new Error("Invalid ice-lite, should be only a single line of 'a=ice-lite'");this.attributes.iceLite=!0}parseTlsId(J){if(this.attributes.tlsId)throw new Error("must be only one tld-id line");this.attributes.tlsId=this.extractOneOrMore(J,Ee)}parseIdentity(J){const _e=this.extractOneOrMore(J,Re),be=[];for(;!this.atEnd(J)&&this.peekChar(J)===y;){this.consumeAttributeSpace(J);const ot=this.extract(J,this.consumeToken);this.extract(J,this.consume,"=");const an=this.extractOneOrMore(J,hr=>hr!==y&&$(hr));be.push({name:ot,value:an})}this.attributes.identities.push({assertionValue:_e,extensions:be})}parseMsidSemantic(J){this.peekChar(J)===y&&this.consumeAttributeSpace(J);const _e={semantic:this.extract(J,this.consumeToken),identifierList:[]};for(;;){try{this.consumeAttributeSpace(J)}catch{break}if(this.peekChar(J)==="*"){this.extract(J,this.consume,"*"),_e.applyForAll=!0;break}{const be=this.extract(J,this.consumeTill,y);_e.identifierList.push(be)}}this.attributes.msidSemantic=_e}}class W extends Ve{constructor(J){super(),Ue(this,"attributes",void 0),J.protos.indexOf("RTP")!==-1||J.protos.indexOf("rtp"),this.attributes={unrecognized:[],candidates:[],extmaps:[],fingerprints:[],imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:[],ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:[]}}parse(J){if(this.digested)throw new Error("already digested");try{switch(J.attField){case"extmap":this.parseExtmap(J);break;case"setup":this.parseSetup(J);break;case"ice-ufrag":this.parseIceUfrag(J);break;case"ice-pwd":this.parseIcePwd(J);break;case"ice-options":this.parseIceOptions(J);break;case"candidate":this.parseCandidate(J);break;case"remote-candidate":this.parseRemoteCandidate(J);break;case"end-of-candidates":this.parseEndOfCandidates();break;case"fingerprint":this.parseFingerprint(J);break;case"rtpmap":this.parseRtpmap(J);break;case"ptime":this.parsePtime(J);break;case"maxptime":this.parseMaxPtime(J);break;case"sendrecv":case"recvonly":case"sendonly":case"inactive":this.parseDirection(J);break;case"ssrc":this.parseSSRC(J);break;case"fmtp":this.parseFmtp(J);break;case"rtcp-fb":this.parseRtcpFb(J);break;case"rtcp-mux":this.parseRTCPMux();break;case"rtcp-mux-only":this.parseRTCPMuxOnly();break;case"rtcp-rsize":this.parseRTCPRsize();break;case"rtcp":this.parseRTCP(J);break;case"mid":this.parseMid(J);break;case"msid":this.parseMsid(J);break;case"imageattr":this.parseImageAttr(J);break;case"rid":this.parseRid(J);break;case"simulcast":this.parseSimulcast(J);break;case"sctp-port":this.parseSctpPort(J);break;case"max-message-size":this.parseMaxMessageSize(J);break;case"ssrc-group":this.parseSSRCGroup(J);break;default:J.ignored=!0,this.attributes.unrecognized.push(J)}}catch(_e){throw console.error("parsing media attribute ".concat(J.attField,' error, "a=').concat(J.attField,":").concat(J.attValue,'"')),_e}if(!J.ignored&&J.attValue&&!this.atEnd(J))throw new Error("attribute parsing error")}parseCandidate(J){const _e=this.extractOneOrMore(J,ee,[1,32]);this.consumeAttributeSpace(J);const be=this.extractOneOrMore(J,A,[1,5]);this.consumeAttributeSpace(J);const ot=this.extract(J,this.consumeToken);this.consumeAttributeSpace(J);const an=this.extractOneOrMore(J,A,[1,10]);this.consumeAttributeSpace(J);const hr=this.extract(J,this.consumeAddress);this.consumeAttributeSpace(J);const Bi=this.extract(J,this.consumePort);this.consumeAttributeSpace(J),this.extract(J,this.consume,"typ"),this.consumeAttributeSpace(J);const Hr={foundation:_e,componentId:be,transport:ot,priority:an,connectionAddress:hr,port:Bi,type:this.extract(J,this.consumeToken),extension:{}};for(this.peek(J," raddr")&&(this.extract(J,this.consume," raddr"),this.consumeAttributeSpace(J),Hr.relAddr=this.extract(J,this.consumeAddress)),this.peek(J," rport")&&(this.extract(J,this.consume," rport"),this.consumeAttributeSpace(J),Hr.relPort=this.extract(J,this.consumePort));this.peekChar(J)===y;){this.consumeAttributeSpace(J);const gi=this.extract(J,this.consumeToken);this.consumeAttributeSpace(J),Hr.extension[gi]=this.extractOneOrMore(J,O)}this.attributes.candidates.push(Hr)}parseRemoteCandidate(J){const _e=[];for(;;){const be=this.extractOneOrMore(J,A,[1,5]);this.consumeAttributeSpace(J);const ot=this.extract(J,this.consumeAddress);this.consumeAttributeSpace(J);const an=this.extract(J,this.consumePort);_e.push({componentId:be,connectionAddress:ot,port:an});try{this.consumeAttributeSpace(J)}catch{break}}this.attributes.remoteCandidatesList.push(_e)}parseEndOfCandidates(){if(this.attributes.endOfCandidates)throw new Error("must be only one line of end-of-candidates");this.attributes.endOfCandidates=!0}parseRtpmap(J){const _e=this.extract(J,this.consumeToken);this.consumeAttributeSpace(J);const be=this.extract(J,this.consumeTill,"/");this.extract(J,this.consume,"/");const ot={encodingName:be,clockRate:this.extractOneOrMore(J,A)};this.atEnd(J)||this.peekChar(J)!=="/"||(this.extract(J,this.consume,"/"),ot.encodingParameters=parseInt(this.extract(J,this.consumeTill),10));const an=this.attributes.payloads.find(hr=>hr.payloadType===parseInt(_e,10));an?an.rtpMap=ot:this.attributes.payloads.push({payloadType:parseInt(_e,10),rtpMap:ot,rtcpFeedbacks:[]})}parsePtime(J){if(this.attributes.ptime)throw new Error("must be only one line of ptime");this.attributes.ptime=this.extract(J,this.consumeTill)}parseMaxPtime(J){if(this.attributes.maxPtime)throw new Error("must be only one line of ptime");this.attributes.maxPtime=this.extract(J,this.consumeTill)}parseDirection(J){if(this.attributes.direction)throw new Error("must be only one line of direction info");this.attributes.direction=J.attField}parseSSRC(J){const _e=this.extractOneOrMore(J,A);this.consumeAttributeSpace(J);const be=this.extract(J,this.consumeTill,":");let ot;this.peekChar(J)===":"&&(this.extract(J,this.consume,":"),ot=this.extract(J,this.consumeTill));const an=this.attributes.ssrcs.find(hr=>hr.ssrcId===parseInt(_e,10));an?an.attributes[be]=ot:this.attributes.ssrcs.push({ssrcId:parseInt(_e,10),attributes:{[be]:ot}})}parseFmtp(J){const _e=this.extract(J,this.consumeTill,y);this.consumeAttributeSpace(J);const be=this.extract(J,this.consumeTill),ot={};be.split(";").forEach(hr=>{let[Bi,Hr]=hr.split("=");Bi=Eo(Bi).call(Bi);const gi=typeof Hr=="string"?Eo(Hr).call(Hr):null;typeof Bi=="string"&&Bi.length>0&&(ot[Bi]=gi)});const an=this.attributes.payloads.find(hr=>hr.payloadType===parseInt(_e,10));an?an.fmtp={parameters:ot}:this.attributes.payloads.push({payloadType:parseInt(_e,10),rtcpFeedbacks:[],fmtp:{parameters:ot}})}parseFmtParameters(J){const _e={},be=this.extract(J,this.consumeTill,"=");J._cur++;const ot=this.extract(J,this.consumeTill,";");for(_e[be]=ot;J.attValue[J._cur]===";";){const an=this.extract(J,this.consumeTill,"=");J._cur++;const hr=this.extract(J,this.consumeTill,";");_e[an]=hr}return _e}parseRtcpFb(J){let _e="";_e=this.peekChar(J)==="*"?this.extract(J,this.consume,"*"):this.extract(J,this.consumeTill,y),this.consumeAttributeSpace(J);const be=this.extract(J,this.consumeTill,y);let ot;if(be==="trr-int")ot={type:be,interval:this.extract(J,this.consumeTill)};else{const an={type:be};this.peekChar(J)===y&&(this.consumeAttributeSpace(J),an.parameter=this.extract(J,this.consumeToken),this.peekChar(J)===y&&(an.additional=this.extract(J,this.consumeTill))),ot=an}if(_e==="*")this.attributes.rtcpFeedbackWildcards.push(ot);else{const an=this.attributes.payloads.find(hr=>hr.payloadType===parseInt(_e,10));an?an.rtcpFeedbacks.push(ot):this.attributes.payloads.push({payloadType:parseInt(_e,10),rtcpFeedbacks:[ot]})}}parseRTCPMux(){if(this.attributes.rtcpMux)throw new Error("must be single line of rtcp-mux");this.attributes.rtcpMux=!0}parseRTCPMuxOnly(){if(this.attributes.rtcpMuxOnly)throw new Error("must be single line of rtcp-only");this.attributes.rtcpMuxOnly=!0}parseRTCPRsize(){if(this.attributes.rtcpRsize)throw new Error("must be single line of rtcp-rsize");this.attributes.rtcpRsize=!0}parseRTCP(J){if(this.attributes.rtcp)throw new Error("must be single line of rtcp");const _e={port:this.extract(J,this.consumePort)};this.peekChar(J)===y&&(this.consumeAttributeSpace(J),_e.netType=this.extractOneOrMore(J,P),this.consumeAttributeSpace(J),_e.addressType=this.extractOneOrMore(J,P),this.consumeAttributeSpace(J),_e.address=this.extract(J,this.consumeAddress)),this.attributes.rtcp=_e}parseMsid(J){const _e={id:this.extractOneOrMore(J,P,[1,64])};this.peekChar(J)===y&&(this.consumeAttributeSpace(J),_e.appdata=this.extractOneOrMore(J,P,[1,64])),this.attributes.msids.push(_e)}parseImageAttr(J){this.attributes.imageattr.push(J.attValue)}parseRid(J){const _e=this.extractOneOrMore(J,ot=>B(ot)||A(ot)||ot==="_"||ot==="-");this.consumeAttributeSpace(J);const be={id:_e,direction:this.extract(J,this.consumeToken),params:[]};if(this.peekChar(J)===y){if(this.consumeAttributeSpace(J),this.peek(J,"pt=")){this.extract(J,this.consume,"pt=");const ot=[];for(;;){const an=this.extract(J,this.consumeToken);ot.push(an);try{this.extract(J,this.consume,",")}catch{break}}be.payloads=ot,this.peekChar(J)===y&&this.extract(J,this.consume,y)}for(;;){const ot=this.extract(J,this.consumeToken);switch(ot){case"depend":{const an={type:ot,rids:this.extract(J,this.consume,"=").split(",")};be.params.push(an);break}default:{const an={type:ot};this.peekChar(J)==="="&&(this.extract(J,this.consume,"="),an.val=this.extract(J,this.consumeTill,";")),be.params.push(an)}}try{this.extract(J,this.consume,";")}catch{break}}}this.attributes.rids.push(be)}parseSimulcast(J){if(this.attributes.simulcast)throw new Error("must be single line of simulcast");this.attributes.simulcast=J.attValue,this.extract(J,this.consumeTill)}parseSctpPort(J){this.attributes.sctpPort=this.extractOneOrMore(J,A,[1,5])}parseMaxMessageSize(J){this.attributes.maxMessageSize=this.extractOneOrMore(J,A,[1,void 0])}digest(){return this.digested=!0,this.attributes}parseMid(J){this.attributes.mid=this.extract(J,this.consumeToken)}parseSSRCGroup(J){const _e=this.extract(J,this.consumeToken),be=[];for(;;)try{this.consumeAttributeSpace(J);const ot=this.extract(J,this.consumeInteger);be.push(parseInt(ot,10))}catch{break}this.attributes.ssrcGroups.push({semantic:_e,ssrcIds:be})}}function ce(Ze,J,_e){return J in Ze?Object.defineProperty(Ze,J,{value:_e,enumerable:!0,configurable:!0,writable:!0}):Ze[J]=_e,Ze}class Se{constructor(){ce(this,"eol",E)}print(J,_e){let be="";return _e&&(this.eol=_e),be+=this.printVersion(J.version),be+=this.printOrigin(J.origin),be+=this.printSessionName(J.sessionName),be+=this.printInformation(J.information),be+=this.printUri(J.uri),be+=this.printEmail(J.emails),be+=this.printPhone(J.phones),be+=this.printConnection(J.connection),be+=this.printBandwidth(J.bandwidths),be+=this.printTimeFields(J.timeFields),be+=this.printKey(J.key),be+=this.printSessionAttributes(J.attributes),be+=this.printMediaDescription(J.mediaDescriptions),be}printVersion(J){return"v=".concat(J).concat(this.eol)}printOrigin(J){return"o=".concat(J.username," ").concat(J.sessId," ").concat(J.sessVersion," ").concat(J.nettype," ").concat(J.addrtype," ").concat(J.unicastAddress).concat(this.eol)}printSessionName(J){return J?"s=".concat(J).concat(this.eol):""}printInformation(J){return J?"i=".concat(J).concat(this.eol):""}printUri(J){return J?"u=".concat(J).concat(this.eol):""}printEmail(J){let _e="";for(const be of J)_e+="e=".concat(be).concat(this.eol);return _e}printPhone(J){let _e="";for(const be of J)_e+="e=".concat(be).concat(this.eol);return _e}printConnection(J){return J?"c=".concat(J.nettype," ").concat(J.addrtype," ").concat(J.address).concat(this.eol):""}printBandwidth(J){let _e="";for(const be of J)_e+="b=".concat(be.bwtype,":").concat(be.bandwidth).concat(this.eol);return _e}printTimeFields(J){let _e="";for(const be of J){_e+="t=".concat(be.time.startTime," ").concat(be.time.startTime).concat(this.eol);for(const ot of be.repeats)_e+="r=".concat(ot.repeatInterval," ").concat(ot.typedTimes.join(" ")).concat(this.eol);be.zoneAdjustments&&(_e+="z=",_e+="z=".concat(be.zoneAdjustments.map(ot=>"".concat(ot.time," ").concat(ot.back?"-":""," ").concat(ot.typedTime)).join(" ")).concat(this.eol),_e+=this.eol)}return _e}printKey(J){return J?"k=".concat(J).concat(this.eol):""}printAttributes(J){let _e="";for(const be of J)_e+="a=".concat(be.attField).concat(be.attValue?":".concat(be.attValue):"").concat(this.eol);return _e}printMediaDescription(J){let _e="";for(const be of J)_e+=this.printMedia(be.media),_e+=this.printInformation(be.information),_e+=this.printConnections(be.connections),_e+=this.printBandwidth(be.bandwidths),_e+=this.printKey(be.key),_e+=this.printMediaAttributes(be);return _e}printConnections(J){let _e="";for(const be of J)_e+=this.printConnection(be);return _e}printMedia(J){return"m=".concat(J.mediaType," ").concat(J.port," ").concat(J.protos.join("/")," ").concat(J.fmts.join(" ")).concat(this.eol)}printSessionAttributes(J){return new en(this.eol).print(J)}printMediaAttributes(J){return new He(this.eol).print(J)}}class Xe{constructor(J){ce(this,"eol",void 0),this.eol=J}printIceUfrag(J){return J===void 0?"":"a=ice-ufrag:".concat(J).concat(this.eol)}printIcePwd(J){return J===void 0?"":"a=ice-pwd:".concat(J).concat(this.eol)}printIceOptions(J){return J===void 0?"":"a=ice-options:".concat(J.join(y)).concat(this.eol)}printFingerprints(J){return J.length>0?J.map(_e=>"a=fingerprint:".concat(_e.hashFunction).concat(y).concat(_e.fingerprint)).join(this.eol)+this.eol:""}printExtmap(J){return J.map(_e=>"a=extmap:".concat(_e.entry).concat(_e.direction?"/".concat(_e.direction):"").concat(y).concat(_e.extensionName).concat(_e.extensionAttributes?"".concat(y).concat(_e.extensionAttributes):"").concat(this.eol)).join("")}printSetup(J){return J===void 0?"":"a=setup:".concat(J).concat(this.eol)}printUnrecognized(J){return J.map(_e=>"a=".concat(_e.attField).concat(_e.attValue?":".concat(_e.attValue):"").concat(this.eol)).join("")}}class en extends Xe{print(J){let _e="";return _e+=this.printGroups(J.groups),_e+=this.printMsidSemantic(J.msidSemantic),_e+=this.printIceLite(J.iceLite),_e+=this.printIceUfrag(J.iceUfrag),_e+=this.printIcePwd(J.icePwd),_e+=this.printIceOptions(J.iceOptions),_e+=this.printFingerprints(J.fingerprints),_e+=this.printSetup(J.setup),_e+=this.printTlsId(J.tlsId),_e+=this.printIdentity(J.identities),_e+=this.printExtmap(J.extmaps),_e+=this.printUnrecognized(J.unrecognized),_e}printGroups(J){let _e="";return J.length>0&&(_e+=J.map(be=>"a=group:".concat(be.semantic).concat(be.identificationTag.map(ot=>"".concat(y).concat(ot)).join("")).concat(this.eol)).join("")),_e}printIceLite(J){return J===void 0?"":"a=ice-lite"+this.eol}printTlsId(J){return J?"a=tls-id:".concat(J).concat(this.eol):""}printIdentity(J){return J.length===0?"":J.map(_e=>"a=identity:".concat(_e.assertionValue).concat(_e.extensions.map(be=>"".concat(y).concat(be.name).concat(be.value?"=".concat(be.value):"")))).join(this.eol)+this.eol}printMsidSemantic(J){if(!J)return"";let _e="a=msid-semantic:".concat(J.semantic);return J.applyForAll?_e+="".concat(y,"*"):J.identifierList.length>0&&(_e+=J.identifierList.map(be=>"".concat(y).concat(be))),_e+this.eol}}class He extends Xe{print(J){const _e=J.attributes;let be="";return be+=this.printRTCP(_e.rtcp),be+=this.printIceUfrag(_e.iceUfrag),be+=this.printIcePwd(_e.icePwd),be+=this.printIceOptions(_e.iceOptions),be+=this.printCandidates(_e.candidates),be+=this.printRemoteCandidatesList(_e.remoteCandidatesList),be+=this.printEndOfCandidates(_e.endOfCandidates),be+=this.printFingerprints(_e.fingerprints),be+=this.printSetup(_e.setup),be+=this.printMid(_e.mid),be+=this.printExtmap(_e.extmaps),be+=this.printRTPRelated(_e),be+=this.printPtime(_e.ptime),be+=this.printMaxPtime(_e.maxPtime),be+=this.printDirection(_e.direction),be+=this.printSSRCGroups(_e.ssrcGroups),be+=this.printSSRC(_e.ssrcs),be+=this.printRTCPMux(_e.rtcpMux),be+=this.printRTCPMuxOnly(_e.rtcpMuxOnly),be+=this.printRTCPRsize(_e.rtcpRsize),be+=this.printMSId(_e.msids),be+=this.printImageattr(_e.imageattr),be+=this.printRid(_e.rids),be+=this.printSimulcast(_e.simulcast),be+=this.printSCTPPort(_e.sctpPort),be+=this.printMaxMessageSize(_e.maxMessageSize),be+=this.printUnrecognized(_e.unrecognized),be}printCandidates(J){return J.map(_e=>"a=candidate:".concat(_e.foundation).concat(y).concat(_e.componentId).concat(y).concat(_e.transport).concat(y).concat(_e.priority).concat(y).concat(_e.connectionAddress).concat(y).concat(_e.port).concat(y,"typ").concat(y).concat(_e.type).concat(_e.relAddr?"".concat(y,"raddr").concat(y).concat(_e.relAddr):"").concat(_e.relPort?"".concat(y,"rport").concat(y).concat(_e.relPort):"").concat(Object.keys(_e.extension).map(be=>"".concat(y).concat(be).concat(y).concat(_e.extension[be])).join("")).concat(this.eol)).join("")}printRemoteCandidatesList(J){return J.map(_e=>"a=remote-candidates:".concat(_e.join(y)).concat(this.eol)).join("")}printEndOfCandidates(J){return J===void 0?"":"a=end-of-candidates"+this.eol}printRTPRelated(J){if(!J.payloads)return"";const _e=J.payloads;let be="";be+=J.rtcpFeedbackWildcards.map(ot=>this.printRTCPFeedback("*",ot)).join("");for(const ot of _e)be+=this.printRtpMap(ot.payloadType,ot.rtpMap),be+=this.printFmtp(ot.payloadType,ot.fmtp),be+=ot.rtcpFeedbacks.map(an=>this.printRTCPFeedback(ot.payloadType,an)).join("");return be}printFmtp(J,_e){if(!_e)return"";const be=Object.keys(_e.parameters);return be.length===1&&_e.parameters[be[0]]===null?"a=fmtp:".concat(J).concat(y).concat(be[0]).concat(this.eol):"a=fmtp:".concat(J).concat(y).concat(Object.keys(_e.parameters).map(ot=>"".concat(ot,"=").concat(_e.parameters[ot])).join(";")).concat(this.eol)}printRtpMap(J,_e){return _e?"a=rtpmap:".concat(J).concat(y).concat(_e.encodingName,"/").concat(_e.clockRate).concat(_e.encodingParameters?"/".concat(_e.encodingParameters):"").concat(this.eol):""}printRTCPFeedback(J,_e){let be="a=rtcp-fb:".concat(J).concat(y),ot=_e;return ot.type==="trr-int"?be+="ttr-int".concat(y).concat(ot.interval):(be+="".concat(ot.type),ot.parameter&&(be+="".concat(y).concat(ot.parameter),ot.additional&&(be+="".concat(y).concat(ot.additional)))),be+this.eol}printPtime(J){return J===void 0?"":"a=ptime:".concat(J).concat(this.eol)}printMaxPtime(J){return J===void 0?"":"a=maxptime:".concat(J).concat(this.eol)}printDirection(J){return J===void 0?"":"a=".concat(J).concat(this.eol)}printSSRC(J){return J.map(_e=>Object.keys(_e.attributes).map(be=>"a=ssrc:".concat(_e.ssrcId.toString(10)).concat(y).concat(be).concat(_e.attributes[be]?":".concat(_e.attributes[be]):"").concat(this.eol)).join("")).join("")}printRTCPMux(J){return J===void 0?"":"a=rtcp-mux".concat(this.eol)}printRTCPMuxOnly(J){return J===void 0?"":"a=rtcp-mux-only".concat(this.eol)}printRTCPRsize(J){return J===void 0?"":"a=rtcp-rsize".concat(this.eol)}printRTCP(J){if(J===void 0)return"";let _e="a=rtcp:".concat(J.port);return J.netType&&(_e+="".concat(y).concat(J.netType)),J.addressType&&(_e+="".concat(y).concat(J.addressType)),J.address&&(_e+="".concat(y).concat(J.address)),_e+this.eol}printMSId(J){return J.map(_e=>"a=msid:".concat(_e.id).concat(_e.appdata?"".concat(y).concat(_e.appdata):"").concat(this.eol)).join("")}printImageattr(J){return J.map(_e=>"a=imageattr:".concat(_e).concat(this.eol)).join("")}printRid(J){return J.map(_e=>{let be="a=rid:".concat(_e.id).concat(y).concat(_e.direction);return _e.payloads&&(be+="".concat(y,"pt=").concat(_e.payloads.join(","))),_e.params.length>0&&(be+="".concat(y).concat(_e.params.map(ot=>ot.type==="depend"?"depend=".concat(ot.rids.join(",")):"".concat(ot.type,"=").concat(ot.val)).join(";"))),be+this.eol}).join("")}printSimulcast(J){return J===void 0?"":"a=simulcast:".concat(J).concat(this.eol)}printSCTPPort(J){return J===void 0?"":"a=sctp-port:".concat(J).concat(this.eol)}printMaxMessageSize(J){return J===void 0?"":"a=max-message-size:".concat(J).concat(this.eol)}printMid(J){return J===void 0?"":"a=mid:".concat(J).concat(this.eol)}printSSRCGroups(J){return J.map(_e=>"a=ssrc-group:".concat(_e.semantic).concat(_e.ssrcIds.map(be=>"".concat(y).concat(be.toString(10))).join("")).concat(this.eol)).join("")}}function tt(Ze){return new Ne().parse(Ze)}function St(Ze,J){return new Se().print(Ze,J)}}},t={};function r(s){if(t[s])return t[s].exports;var l=t[s]={exports:{}};return e[s](l,l.exports,r),l.exports}return r.d=(s,l)=>{for(var f in l)r.o(l,f)&&!r.o(s,f)&&Object.defineProperty(s,f,{enumerable:!0,get:l[f]})},r.o=(s,l)=>Object.prototype.hasOwnProperty.call(s,l),r.r=s=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(s,"__esModule",{value:!0})},r(8)})();function on(e){return Lx.parse(e)}function zr(e,t){return Lx.print(e,t)}var m8=il("Array","keys"),lY=Pf,Dx=Ga,g8=Q,$d=m8,Yb=Array.prototype,dI={DOMTokenList:!0,NodeList:!0},z=function(e){var t=e.keys;return e===Yb||g8(Yb,e)&&t===Yb.keys||Dx(dI,lY(e))?$d:t},Sl=T(z);function xi(e,t,r){return(t=function(s){var l=function(f,m){if(typeof f!="object"||!f)return f;var E=f[Symbol.toPrimitive];if(E!==void 0){var y=E.call(f,"string");if(typeof y!="object")return y;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(f)}(s);return typeof l=="symbol"?l:l+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _8(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),r.push.apply(r,s)}return r}function qt(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_8(Object(r),!0).forEach(function(s){xi(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_8(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}const di=new class extends Xt{constructor(){super(...arguments),xi(this,"currentUploadLogID",0)}reportLogUploadError(e){const{errorRange:t}=e;t[t.length-1]&&t[t.length-1]>this.currentUploadLogID&&(this.currentUploadLogID=t[t.length-1],this.emit("REPORT_LOG_UPLOAD",e))}};class dY{constructor(t){xi(this,"logger",void 0),xi(this,"prefixLists",[]),this.logger=t}debug(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];this.logger.debug(...this.prefixLists,...r)}info(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];this.logger.info(...this.prefixLists,...r)}warning(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];this.logger.warning(...this.prefixLists,...r)}error(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];this.logger.error(...this.prefixLists,...r)}prefix(t){return this.prefixLists.push(t),this}popPrefix(){return this.prefixLists.pop(),this}}function $t(){const e=new Date;return e.toTimeString().split(" ")[0]+":"+e.getMilliseconds()}function jt(){const e=new Date,t=/((\d+:){2}\d+)/.exec(new Date().toUTCString());return t?(t==null?void 0:t[0])+":"+e.getUTCMilliseconds():e.toTimeString().split(" ")[0]+":"+e.getMilliseconds()}const De={DEBUG:0,INFO:1,WARNING:2,ERROR:3,NONE:4},ka=Date.now(),Un=e=>{for(const t in De)if(Object.prototype.hasOwnProperty.call(De,t)&&De[t]===e)return t;return"DEFAULT"},G=new class{constructor(){xi(this,"proxyServerURL",void 0),xi(this,"logLevel",De.DEBUG),xi(this,"uploadState","collecting"),xi(this,"uploadLogWaitingList",[]),xi(this,"uploadLogUploadingList",[]),xi(this,"uploadErrorCount",0),xi(this,"currentLogID",0),xi(this,"url",void 0),xi(this,"extLog",(e,t)=>{this.appendLogToWaitingList(e,...t)})}debug(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];const s=[De.DEBUG].concat(t);this.log.apply(this,s)}info(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];const s=[De.INFO].concat(t);this.log.apply(this,s)}warning(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];const s=[De.WARNING].concat(t);this.log.apply(this,s)}warn(){this.warning(...arguments)}error(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];const s=[De.ERROR].concat(t);this.log.apply(this,s)}upload(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];const s=[De.DEBUG].concat(t);this.uploadLog.apply(this,s)}setLogLevel(e){e=Math.min(Math.max(0,e),4),this.logLevel=e}enableLogUpload(){Dn("UPLOAD_LOG",!0)}disableLogUpload(){Dn("UPLOAD_LOG",!1),this.uploadLogUploadingList=[],this.uploadLogWaitingList=[]}setProxyServer(e){this.proxyServerURL=e}prefix(e){return new dY(this).prefix(e)}log(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];if(Date.now()-ka<100)return void setTimeout(()=>{this.log(...t)},Date.now()-ka);const s=Math.max(0,Math.min(4,t[0]));if(t[0]=$t()+" Agora-SDK [".concat(Un(s),"]:"),this.appendLogToWaitingList(s,...t),s<this.logLevel)return;const l=$t()+" %cAgora-SDK [".concat(Un(s),"]:");let f=[];if(!me("USE_NEW_LOG"))switch(s){case De.DEBUG:f=[l,"color: #64B5F6;"].concat(t.slice(1)),console.log.apply(console,f);break;case De.INFO:f=[l,"color: #1E88E5; font-weight: bold;"].concat(t.slice(1)),console.log.apply(console,f);break;case De.WARNING:f=[l,"color: #FB8C00; font-weight: bold;"].concat(t.slice(1)),console.warn.apply(console,f);break;case De.ERROR:f=[l,"color: #B00020; font-weight: bold;"].concat(t.slice(1)),console.error.apply(console,f)}}uploadLog(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];if(Date.now()-ka<100)return void setTimeout(()=>{this.uploadLog(...t)},Date.now()-ka);const s=Math.max(0,Math.min(4,t[0]));t[0]=$t()+" Agora-SDK [".concat(Un(s),"]:"),this.appendLogToWaitingList(s,...t)}appendLogToWaitingList(e){if(!me("UPLOAD_LOG"))return;for(var t=arguments.length,r=new Array(t>1?t-1:0),s=1;s<t;s++)r[s-1]=arguments[s];Array.isArray(r[0])?r[0][0]=jt()+" Agora-SDK [".concat(Un(e),"]:"):r[0]=jt()+" Agora-SDK [".concat(Un(e),"]:");let l="";r.forEach(f=>{typeof f=="object"&&(f=JSON.stringify(f)),l+="".concat(f," ")}),this.uploadLogWaitingList.push({payload_str:l,log_level:e,log_item_id:this.currentLogID++}),this.uploadState==="uploading"&&this.uploadLogUploadingList.length===0&&this.uploadLogInterval()}startUpload(){this.uploadState="uploading",this.uploadLogUploadingList.length===0&&this.uploadLogInterval()}async uploadLogs(){const e=this.uploadLogUploadingList,t={sdk_version:hs,process_id:me("PROCESS_ID"),payload:JSON.stringify(e)};return _l(async()=>{const r=await En.post(this.url||(this.proxyServerURL?"https://".concat(this.proxyServerURL,"/ls/?h=").concat(me("LOG_UPLOAD_SERVER"),"&p=443&d=upload/v1"):"https://".concat(me("LOG_UPLOAD_SERVER"),"/upload/v1")),t,{responseType:"text"});if(r.data!=="OK"){const s=new Error("unexpected upload log response");throw s.response=r,s}},()=>(this.uploadLogUploadingList=[],!1),r=>{const s={status:-1,message:r.message,errorRange:e.map(l=>l.log_item_id)};return r.response?(s.status=r.response.status,s.data=r.response.data,s.headers=r.response.headers):r.request&&(s.status=r.request.status),di.reportLogUploadError(s),!0},{timeout:me("UPLOAD_LOG_REQUEST_RETRY_INTERVAL"),maxRetryTimeout:me("UPLOAD_LOG_REQUEST_MAX_RETRY_INTERVAL")})}uploadLogInterval(){this.uploadLogUploadingList.length===0&&this.uploadLogWaitingList.length===0||(this.uploadLogUploadingList.length===0&&(this.uploadLogUploadingList=this.uploadLogWaitingList.splice(0,me("UPLOAD_LOG_LENGTH_EACH_TIME"))),this.uploadLogs().then(()=>{this.uploadErrorCount=0,this.uploadLogWaitingList.length>0&&window.setTimeout(()=>this.uploadLogInterval(),me("UPLOAD_LOG_INTERVAL"))}).catch(e=>{this.uploadErrorCount+=1,this.uploadErrorCount<2?window.setTimeout(()=>this.uploadLogInterval(),me("UPLOAD_LOG_TWICE_RETRY_INTERVAL_V1")):window.setTimeout(()=>this.uploadLogInterval(),me("UPLOAD_LOG_RETRY_INTERVAL_V1"))}))}};var Px;function ms(e){return Oa(e.reportId,"params.reportId",0,100,!1),Oa(e.category,"params.category",0,100,!1),Oa(e.event,"params.event",0,100,!1),Oa(e.label,"params.label",0,100,!1),wr(e.value,"params.value",Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,!1),!0}(Px={}).FREE="free",Px.UPLOADING="uploading",function(e){e[e.MISC=0]="MISC",e[e.INTERNAL_EVENT=1]="INTERNAL_EVENT",e[e.PUBLIC_EVENT=2]="PUBLIC_EVENT",e[e.WEB_EVENT=3]="WEB_EVENT",e[e.INTERNAL_API=4]="INTERNAL_API",e[e.WEB_API=5]="WEB_API",e[e.PUBLIC_API=6]="PUBLIC_API"}({});const Kb={sid:"",lts:0,success:null,cname:null,uid:null,peer:null,cid:null,elapse:null,extend:null,vid:0};let fn=function(e){return e.PUBLISH="publish",e.SUBSCRIBE="subscribe",e.WS_COMPRESSOR_INIT="ws_compressor_init",e.SESSION_INIT="session_init",e.JOIN_CHOOSE_SERVER="join_choose_server",e.REQ_USER_ACCOUNT="req_user_account",e.JOIN_GATEWAY="join_gateway",e.REJOIN_GATEWAY="rejoin_gateway",e.STREAM_SWITCH="stream_switch",e.REQUEST_PROXY_WORKER_MANAGER="request_proxy_worker_manager",e.REQUEST_PROXY_APPCENTER="request_proxy_appcenter",e.FIRST_VIDEO_RECEIVED="first_video_received",e.FIRST_AUDIO_RECEIVED="first_audio_received",e.FIRST_VIDEO_DECODE="first_video_decode",e.FIRST_AUDIO_DECODE="first_audio_decode",e.ON_ADD_AUDIO_STREAM="on_add_audio_stream",e.ON_ADD_VIDEO_STREAM="on_add_video_stream",e.ON_UPDATE_STREAM="on_update_stream",e.ON_REMOVE_STREAM="on_remove_stream",e.USER_ANALYTICS="req_user_analytics",e.PC_STATS="pc_stats",e.UPDATE_REMOTE_RTPCAPABILITIES="update_remote_rtpCapabilities",e.AB_TEST="ab_test",e}({}),_r=function(e){return e.SESSION="io.agora.pb.Wrtc.Session",e.JOIN_CHOOSE_SERVER="io.agora.pb.Wrtc.JoinChooseServer",e.REQ_USER_ACCOUNT="io.agora.pb.Wrtc.ReqUserAccount",e.JOIN_GATEWAY="io.agora.pb.Wrtc.JoinGateway",e.RE_JOIN_GATEWAY="io.agora.pb.Wrtc.ReJoinGateway",e.PUBLISH="io.agora.pb.Wrtc.Publish",e.SUBSCRIBE="io.agora.pb.Wrtc.Subscribe",e.WS_COMPRESSOR_INIT="io.agora.pb.Wrtc.WsCompressorInit",e.STREAM_SWITCH="io.agora.pb.Wrtc.StreamSwitch",e.AUDIO_SENDING_STOPPED="io.agora.pb.Wrtc.AudioSendingStopped",e.VIDEO_SENDING_STOPPED="io.agora.pb.Wrtc.VideoSendingStopped",e.REQUEST_PROXY_APPCENTER="io.agora.pb.Wrtc.RequestProxyAppCenter",e.REQUEST_PROXY_WORKER_MANAGER="io.agora.pb.Wrtc.RequestProxyWorkerManager",e.API_INVOKE="io.agora.pb.Wrtc.ApiInvoke",e.FIRST_VIDEO_RECEIVED="io.agora.pb.Wrtc.FirstVideoReceived",e.FIRST_AUDIO_RECEIVED="io.agora.pb.Wrtc.FirstAudioReceived",e.FIRST_VIDEO_DECODE="io.agora.pb.Wrtc.FirstVideoDecode",e.FIRST_AUDIO_DECODE="io.agora.pb.Wrtc.FirstAudioDecode",e.ON_ADD_AUDIO_STREAM="io.agora.pb.Wrtc.OnAddAudioStream",e.ON_ADD_VIDEO_STREAM="io.agora.pb.Wrtc.OnAddVideoStream",e.ON_UPDATE_STREAM="io.agora.pb.Wrtc.OnUpdateStream",e.ON_REMOVE_STREAM="io.agora.pb.Wrtc.OnRemoveStream",e.JOIN_CHANNEL_TIMEOUT="io.agora.pb.Wrtc.JoinChannelTimeout",e.PEER_PUBLISH_STATUS="io.agora.pb.Wrtc.PeerPublishStatus",e.WORKER_EVENT="io.agora.pb.Wrtc.WorkerEvent",e.AP_WORKER_EVENT="io.agora.pb.Wrtc.APWorkerEvent",e.JOIN_WEB_PROXY_AP="io.agora.pb.Wrtc.JoinWebProxyAP",e.WEBSOCKET_QUIT="io.agora.pb.Wrtc.WebSocketQuit",e.USER_ANALYTICS="io.agora.pb.Wrtc.UserAnalytics",e.AUTOPLAY_FAILED="io.agora.pb.Wrtc.AutoplayFailed",e.PC_STATS="io.agora.pb.Wrtc.PCStats",e.UPDATE_REMOTE_RTPCAPABILITIES="io.agora.pb.Wrtc.UpdateRemoteRTPCapabilities",e.AB_TEST="io.agora.pb.Wrtc.ABTest",e}({});(function(e){e[e.WORKER_EVENT=156]="WORKER_EVENT",e[e.AP_WORKER_EVENT=160]="AP_WORKER_EVENT"})({});let Mx=function(e){return e[e.SESSION=26]="SESSION",e[e.JOIN_CHOOSE_SERVER=27]="JOIN_CHOOSE_SERVER",e[e.REQ_USER_ACCOUNT=196]="REQ_USER_ACCOUNT",e[e.JOIN_GATEWAY=28]="JOIN_GATEWAY",e[e.PUBLISH=30]="PUBLISH",e[e.SUBSCRIBE=29]="SUBSCRIBE",e[e.WS_COMPRESSOR_INIT=9430]="WS_COMPRESSOR_INIT",e[e.STREAM_SWITCH=32]="STREAM_SWITCH",e[e.AUDIO_SENDING_STOPPED=33]="AUDIO_SENDING_STOPPED",e[e.VIDEO_SENDING_STOPPED=34]="VIDEO_SENDING_STOPPED",e[e.REQUEST_PROXY_APPCENTER=35]="REQUEST_PROXY_APPCENTER",e[e.REQUEST_PROXY_WORKER_MANAGER=36]="REQUEST_PROXY_WORKER_MANAGER",e[e.API_INVOKE=41]="API_INVOKE",e[e.FIRST_VIDEO_RECEIVED=348]="FIRST_VIDEO_RECEIVED",e[e.FIRST_AUDIO_RECEIVED=349]="FIRST_AUDIO_RECEIVED",e[e.FIRST_VIDEO_DECODE=350]="FIRST_VIDEO_DECODE",e[e.FIRST_AUDIO_DECODE=351]="FIRST_AUDIO_DECODE",e[e.ON_ADD_AUDIO_STREAM=352]="ON_ADD_AUDIO_STREAM",e[e.ON_ADD_VIDEO_STREAM=353]="ON_ADD_VIDEO_STREAM",e[e.ON_UPDATE_STREAM=356]="ON_UPDATE_STREAM",e[e.ON_REMOVE_STREAM=355]="ON_REMOVE_STREAM",e[e.JOIN_CHANNEL_TIMEOUT=407]="JOIN_CHANNEL_TIMEOUT",e[e.PEER_PUBLISH_STATUS=408]="PEER_PUBLISH_STATUS",e[e.WORKER_EVENT=156]="WORKER_EVENT",e[e.AP_WORKER_EVENT=160]="AP_WORKER_EVENT",e[e.JOIN_WEB_PROXY_AP=700]="JOIN_WEB_PROXY_AP",e[e.WEBSOCKET_QUIT=671]="WEBSOCKET_QUIT",e[e.USER_ANALYTICS=1e4]="USER_ANALYTICS",e[e.AUTOPLAY_FAILED=9178]="AUTOPLAY_FAILED",e}({});function nn(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return function(t,r,s){const l=s.value;if(typeof l=="function"){const f=e.className||t.__className__||(t.constructor.name==="AgoraRTCClient"?"Client":t.constructor.name);s.value=function(){for(var m,E=arguments.length,y=new Array(E),b=0;b<E;b++)y[b]=arguments[b];let A=y;if(e.argsMap)try{A=e.argsMap(this,...y)}catch(D){G.warning(D),A=[]}try{JSON.stringify(A)}catch{G.warning("arguments for method ".concat(f,".").concat(String(r)," not serializable for apiInvoke.")),A=[]}const O=(e.report||Vt).reportApiInvoke(this._sessionId||null,{id:this._clientId||((m=this.store)===null||m===void 0?void 0:m.clientId)||this._ID,name:"".concat(f,".").concat(String(r)),options:A,tag:Bn.TRACER,reportResult:e.reportResult},e.throttleTime);try{const D=l.apply(this,y);return D instanceof gt?D.then(P=>(O.onSuccess(e.reportResult&&P),P)).catch(P=>{throw O.onError(P),P}):(O.onSuccess(e.reportResult&&D),D)}catch(D){throw O.onError(D),D}}}return s}}const Vt=new class{constructor(){xi(this,"baseInfoMap",new Map),xi(this,"proxyServer",void 0),xi(this,"eventUploadTimer",void 0),xi(this,"setSessionIdTimer",void 0),xi(this,"url",void 0),xi(this,"sids",new Set),xi(this,"backupUrl",void 0),xi(this,"_appId",void 0),xi(this,"_aid",0),xi(this,"keyEventUploadPendingItems",[]),xi(this,"normalEventUploadPendingItems",[]),xi(this,"apiInvokeUploadPendingItems",[]),xi(this,"apiInvokeCount",0),xi(this,"apiInvokeLoggedCount",0),xi(this,"ltsList",[]),xi(this,"lastSendNormalEventTime",Date.now()),xi(this,"customReportCounterTimer",void 0),xi(this,"customReportCount",0),xi(this,"extApiInvoke",async e=>{for(const t of e){const r=qt(qt({},t),{},{sid:null,invokeId:++this.apiInvokeCount,tag:Bn.TRACER});this.sendApiInvoke(r)}}),this.eventUploadTimer=window.setInterval(this.doSend.bind(this),me("EVENT_REPORT_SEND_INTERVAL")),this.setSessionIdTimer=window.setInterval(this.appendSessionId.bind(this),me("EVENT_REPORT_SEND_INTERVAL"))}getBaseInfoBySessionId(e){return this.baseInfoMap.get(e)}setAppId(e){this._appId=e,this._aid=parseInt(e.replace(/[a-fA-F0-9]{8}/g,t=>{let[r,s]=t;return r+s}),16)||0}reportApiInvoke(e,t,r){t.timeout=t.timeout||6e4,t.reportResult=t.reportResult===void 0||t.reportResult;const s=Date.now();this.apiInvokeCount+=1;const l=this.apiInvokeCount,f=!!me("SHOW_REPORT_INVOKER_LOG"),m=!!me("SHOW_REPORT_USER_INVOKER_LOG"),E=f||m&&t.id;E&&(this.apiInvokeLoggedCount+=1);const y=this.apiInvokeLoggedCount;function b(P,F){if(E){let B="[apiInvoke-".concat(y,"]");if(t.id&&(B+="[".concat(t.id,"]")),t.name&&(B+="[".concat(t.name,"]"),t.name===Di.JOIN))return G.info("".concat(B," ").concat(P));G.info("".concat(B," ").concat(P),P==="start"?t.options:F||"")}}const A=()=>({tag:t.tag,invokeId:l,sid:e,name:t.name,apiInvokeTime:s,options:t.options,states:t.states||null});b("start");let O=!1;fs(t.timeout).then(()=>{O||(this.sendApiInvoke(qt(qt({},A()),{},{error:se.API_INVOKE_TIMEOUT,success:!1})),b("timeout"))});const D=new Ke(se.UNEXPECTED_ERROR,"".concat(t.name,": this api invoke is end"));return{onSuccess:P=>{const F=()=>{if(O)throw D;return O=!0,this.sendApiInvoke(qt(qt({},A()),{},{success:!0},t.reportResult&&{result:P})),b("onSuccess"),P};return r?vL(F,t.name+"Success",r,()=>O=!0):F()},onError:P=>{const F=()=>{if(O)throw P;O=!0,this.sendApiInvoke(qt(qt({},A()),{},{success:!1,error:P})),b("onFailure",P.toString())};return r?vL(F,t.name+"Error",r,()=>O=!0):F()}}}sessionInit(e,t){if(this.baseInfoMap.has(e))return;const r=Date.now(),s=this.createBaseInfo(e,r);s.cname=t.cname;const l=Object.assign({},{willUploadConsoleLog:me("UPLOAD_LOG"),maxTouchPoints:navigator.maxTouchPoints,areaVersion:Ln?"global":"oversea",areas:me("AREAS")&&me("AREAS").join(",")},t.extend),{stringUid:f,channelProfile:m,channelMode:E,isABTestSuccess:y,lsid:b,clientRole:A}=t,O=Date.now(),D=qt(qt({},s),{},{eventType:fn.SESSION_INIT,appid:t.appid,browser:navigator.userAgent,buildFormat:t.buildFormat,build:k_,lts:O,elapse:O-r,extend:JSON.stringify(l),mode:t.mode,process:me("PROCESS_ID"),appType:me("APP_TYPE"),success:!0,version:hs,stringUid:f,channelProfile:m,channelMode:E,isABTestSuccess:y,lsid:b,clientType:ht(P=window.navigator.userAgent).call(P,"AgoraWebView")?42:20,clientRole:A,serviceId:me("PROCESS_ID"),extensionID:me("PLUGIN_INFO").join(",")||""});var P;this.send({type:_r.SESSION,data:D},!0)}joinChooseServer(e,t){const r=this.baseInfoMap.get(e);if(!r)return;const s=r.info,l=Date.now(),f=qt(qt({},s),{},{role:t.role,eventType:fn.JOIN_CHOOSE_SERVER,lts:l,eventElapse:t.elapse||l-t.lts,chooseServerAddr:t.csAddr,errorCode:t.ec,elapse:l-r.startTime,success:t.succ,chooseServerAddrList:JSON.stringify(t.serverList),uid:t.uid?parseInt(t.uid):null,cid:t.cid?parseInt(t.cid):null,chooseServerIp:t.csIp||"",opid:t.opid,unilbsServerIds:t.unilbsServerIds,extend:t.extend||void 0,isHttp3:t.isHttp3,corssRegionTagReq:t.corssRegionTagReq||void 0,corssRegionTagRes:t.corssRegionTagRes||void 0});this.send({type:_r.JOIN_CHOOSE_SERVER,data:f},!0)}reqUserAccount(e,t){const r=this.baseInfoMap.get(e);if(!r)return;const s=r.info,l=Date.now(),f=qt(qt({},s),{},{eventType:fn.REQ_USER_ACCOUNT,lts:l,success:t.success,serverAddress:t.serverAddr,stringUid:t.stringUid,uid:t.uid,errorCode:t.errorCode,elapse:t.elapse||l-r.startTime,eventElapse:l-t.lts,extend:JSON.stringify(t.extend)});this.send({type:_r.REQ_USER_ACCOUNT,data:f},!0)}joinGateway(e,t){const r=this.baseInfoMap.get(e);if(!r)return;const s=r.info;t.vid&&(s.vid=t.vid),s.uid=t.uid,s.cid=t.cid;const l=Date.now(),{firstSuccess:f,addr:m,isProxy:E}=t,y=l-r.startTime,b=qt(qt({},s),{},{eventType:fn.JOIN_GATEWAY,lts:l,gatewayAddr:t.addr,success:t.succ,errorCode:t.ec,errorMsg:t.errorMsg||"",elapse:y,eventElapse:l-t.lts,firstSuccess:f,signalChannel:t.signalChannel,preload:t.preload?1:0,installId:wL(),isABTestSuccess:t.isABTestSuccess?1:0}),A=b.success?1:0;if(t.succ&&(r.lastJoinSuccessTime=l),f)this.send({type:_r.JOIN_GATEWAY,data:b},!0);else{let O;if(m)if(E){const P=m.match(/h=(\d{1,3}-){3}\d{1,3}/g),F=m.match(/p=[0-9]{1,6}/g);O={isSuccess:A,gatewayIp:P&&P.length?P[0].split("=")[1].replace(/-/g,"."):"",port:F&&F.length?F[0].split("=")[1]:"",isProxy:E?1:0}}else{const P=m.match(/wss:\/\/(\d{1,3}-){3}\d{1,3}/g),F=m.match(/(:|p=)[0-9]{1,6}/g);O={isSuccess:A,gatewayIp:P&&P.length?P[0].split("//")[1].replace(/-/g,"."):"",port:F&&F.length?F[0].split(/:|p=/g)[1]:"",isProxy:E?1:0}}else O={isSuccess:A,gatewayIp:"",port:"",isProxy:E?1:0};delete b.success,delete b.eventType,delete b.firstSuccess,b.vid=Number(b.vid);const D=Object.assign({},b,O,{eventType:fn.REJOIN_GATEWAY});this.send({type:_r.RE_JOIN_GATEWAY,data:D},!0)}}joinChannelTimeout(e,t){const r=this.baseInfoMap.get(e);if(!r)return;const s=Date.now(),l=qt(qt({},r.info),{},{lts:s,timeout:t,elapse:s-r.startTime});this.send({type:_r.JOIN_CHANNEL_TIMEOUT,data:l},!0)}publish(e,t){const r=this.baseInfoMap.get(e);if(!r)return;const s=r.info,l=Date.now(),f=qt(qt({},s),{},{eventType:fn.PUBLISH,lts:l,eventElapse:t.eventElapse,elapse:l-r.startTime,success:t.succ,errorCode:t.ec,videoName:t.videoName,audioName:t.audioName,screenName:t.screenName,screenshare:t.screenshare,audio:t.audio,video:t.video,p2pid:t.p2pid,publishRequestid:t.publishRequestid});this.send({type:_r.PUBLISH,data:f},!0)}subscribe(e,t,r){const s=this.baseInfoMap.get(e);if(!s)return;const l=s.info,f=Date.now(),m=qt(qt({},l),{},{eventType:fn.SUBSCRIBE,lts:f,eventElapse:t.eventElapse,elapse:f-s.startTime,success:t.succ,errorCode:t.ec,video:t.video,audio:t.audio,subscribeRequestid:t.subscribeRequestid,p2pid:t.p2pid,preSsrc:t.preSsrc?1:0},r&&{extend:JSON.stringify({isMassSubscribe:!0})});typeof t.peerid=="string"?m.peerSuid=t.peerid:m.peer=t.peerid,this.send({type:_r.SUBSCRIBE,data:m},!0)}wsCompressorInit(e){var t;const r=[...Sl(t=this.baseInfoMap).call(t)],s=r.length?r[0]:"UnableToGetSid",l=this.baseInfoMap.get(s);if(!l)return;const f=l.info,m=Date.now(),E=qt(qt({},f),{},{eventType:fn.WS_COMPRESSOR_INIT,lts:m,eventElapse:e.eventElapse,elapse:m-l.startTime,status:e.status?1:2});this.send({type:_r.WS_COMPRESSOR_INIT,data:E},!0)}firstRemoteVideoDecode(e,t,r,s){const l=this.baseInfoMap.get(e);if(!l)return;const f=l.info,m=Date.now(),E=qt(qt(qt({},f),s),{},{elapse:m-l.startTime,eventType:t,lts:m,firstDecodeFrame:Math.max((s.firstFrame||m)-l.startTime,0),apEnd:Math.max(s.apEnd-l.startTime,0),apStart:Math.max(s.apStart-l.startTime,0),joinGwEnd:Math.max(s.joinGwEnd-l.startTime,0),joinGwStart:Math.max(s.joinGwStart-l.startTime,0),pcEnd:Math.max(s.pcEnd-l.startTime,0),pcStart:Math.max(s.pcStart-l.startTime,0),subscriberEnd:Math.max(s.subscriberEnd-l.startTime,0),subscriberStart:Math.max(s.subscriberStart-l.startTime,0),videoAddNotify:Math.max(s.videoAddNotify-l.startTime,0)});this.send({type:r,data:E},!0)}firstRemoteFrame(e,t,r,s){const l=this.baseInfoMap.get(e);if(!l)return;const f=l.info,m=Date.now(),E=qt(qt(qt({},f),s),{},{elapse:m-l.startTime,eventType:t,lts:m});this.send({type:r,data:E},!0)}abTest(e,t){const r=this.baseInfoMap.get(e);if(!r)return;const s=r.info,l=Date.now(),f=qt(qt(qt({},s),t),{},{vid:s.vid===void 0?0:Number(s.vid),elapse:l-r.startTime,eventType:fn.AB_TEST,lts:l});this.send({type:_r.AB_TEST,data:f},!0)}pcStats(e,t){const r=this.baseInfoMap.get(e);if(!r)return;const s=r.info,l=Date.now(),f=qt(qt(qt({},s),t),{},{vid:s.vid===void 0?0:Number(s.vid),elapse:l-r.startTime,eventType:fn.PC_STATS,lts:l,preallocation:t.preallocation?1:0});this.send({type:_r.PC_STATS,data:f},!0)}updateRemoteRTPCapabilities(e,t){if(e){const r=this.baseInfoMap.get(e);if(!r)return;const s=r.info,l=Date.now(),f=qt(qt(qt({},s),t),{},{vid:s.vid===void 0?0:Number(s.vid),eventType:fn.UPDATE_REMOTE_RTPCAPABILITIES,lts:l});this.send({type:_r.UPDATE_REMOTE_RTPCAPABILITIES,data:f},!0)}}onGatewayStream(e,t,r,s){const l=this.baseInfoMap.get(e);if(!l)return;const f=l.info,m=Date.now(),E=qt(qt(qt({},f),s),{},{eventType:t,lts:m});this.send({type:r,data:E},!0)}streamSwitch(e,t){const r=this.baseInfoMap.get(e);if(!r)return;const s=r.info,l=Date.now(),f=qt(qt({},s),{},{eventType:fn.STREAM_SWITCH,lts:l,isDual:t.isdual,elapse:l-r.startTime,success:t.succ});this.send({type:_r.STREAM_SWITCH,data:f},!0)}requestProxyAppCenter(e,t){const r=this.baseInfoMap.get(e);if(!r)return;const s=r.info,l=Date.now(),f=qt(qt({},s),{},{eventType:fn.REQUEST_PROXY_APPCENTER,lts:l,eventElapse:l-t.lts,elapse:l-r.startTime,APAddr:t.APAddr,workerManagerList:t.workerManagerList,response:t.response,errorCode:t.ec,success:t.succ});this.send({type:_r.REQUEST_PROXY_APPCENTER,data:f},!0)}requestProxyWorkerManager(e,t){const r=this.baseInfoMap.get(e);if(!r)return;const s=r.info,l=Date.now(),f=qt(qt({},s),{},{eventType:fn.REQUEST_PROXY_WORKER_MANAGER,lts:l,eventElapse:l-t.lts,elapse:l-r.startTime,workerManagerAddr:t.workerManagerAddr,response:t.response,errorCode:t.ec,success:t.succ});this.send({type:_r.REQUEST_PROXY_WORKER_MANAGER,data:f},!0)}setProxyServer(e){this.proxyServer=e,e?G.debug("reportProxyServerurl: ".concat(e)):G.debug("disable reportProxyServerurl: ".concat(e))}peerPublishStatus(e,t){const r=this.baseInfoMap.get(e);if(!r)return;const s=r.info,l=Date.now(),f=qt(qt({},s),{},{subscribeElapse:t.subscribeElapse,peer:t.peer,peerPublishDuration:Math.max(t.audioPublishDuration,t.videoPublishDuration),audiotag:t.audioPublishDuration>0?1:-1,videotag:t.videoPublishDuration>0?1:-1,lts:l,elapse:l-r.startTime,joinChannelSuccessElapse:l-(r.lastJoinSuccessTime||l),peerPublishDurationVideo:t.videoPublishDuration,peerPublishDurationAudio:t.audioPublishDuration});this.send({type:_r.PEER_PUBLISH_STATUS,data:f},!0)}workerEvent(e,t){const r=this.baseInfoMap.get(e);if(!r)return;const s=r.info,l=Date.now();(function(f,m,E){const y=f[m];if(!y||typeof y!="string")return[f];f[m]="";const b=mh(JSON.stringify(f));let A=0;const O=[];let D=0;for(let P=0;P<y.length;P++)D+=y.charCodeAt(P)<=127?1:3,D<=E-b||(O[O.length]=It(It({},f),{},{[m]:y.substring(A,P)}),A=P,D=y.charCodeAt(P)<=127?1:3);return A!==y.length-1&&(O[O.length]=It(It({},f),{},{[m]:y.substring(A)})),O})(qt(qt(qt({},s),t),{},{elapse:l-r.startTime,lts:l,productType:"WebRTC"}),"payload",1300).forEach(f=>this.send({type:_r.WORKER_EVENT,data:f},!0))}apworkerEvent(e,t){const r=this.baseInfoMap.get(e);if(!r)return;const s=r.info,l=Date.now(),f=qt(qt(qt({},s),t),{},{elapse:l-r.startTime,lts:l});this.send({type:_r.AP_WORKER_EVENT,data:f},!0)}joinWebProxyAP(e,t){const r=this.baseInfoMap.get(e);if(!r)return;const s=r.info,l=Date.now(),f=qt(qt(qt({},s),t),{},{elapse:l-r.startTime,lts:l,extend:t.extend||void 0});this.send({type:_r.JOIN_WEB_PROXY_AP,data:f},!0)}WebSocketQuit(e,t){const r=this.baseInfoMap.get(e);if(!r)return;const s=r.info,l=Date.now(),f=qt(qt(qt({},s),t),{},{elapse:l-r.startTime,lts:l});this.send({type:_r.WEBSOCKET_QUIT,data:f},!0)}async sendCustomReportMessage(e,t){if(this.customReportCount+=t.length,this.customReportCount>me("CUSTOM_REPORT_LIMIT"))throw new Ke(se.CUSTOM_REPORT_FREQUENCY_TOO_HIGH);this.customReportCounterTimer||(this.customReportCounterTimer=window.setInterval(()=>{this.customReportCount=0},5e3));const r=Date.now(),s=t.map(l=>({type:_r.USER_ANALYTICS,data:qt(qt({sid:e},l),{},{lts:r})}));try{me("NEW_REPORT_SERVER")?await this.postDataToStatsCollector2(s):await this.postDataToStatsCollector(s)}catch(l){throw G.error("send custom report message failed",l.toString()),new Ke(se.CUSTOM_REPORT_SEND_FAILED,l.message)}}sendApiInvoke(e){const t=me("NOT_REPORT_EVENT");if(e.tag&&ht(t)&&ht(t).call(t,e.tag))return!1;if(e.sid===null)return this.apiInvokeUploadPendingItems.push(e),!1;const r=this.baseInfoMap.get(e.sid);if(!r)return this.apiInvokeUploadPendingItems.push(e),!1;const{cname:s,uid:l,cid:f}=r.info;let m;if(e.lts=e.lts||Date.now(),e.error)if(e.error instanceof Ke){const{code:y,message:b}=e.error;m=y||b||e.error.toString()}else m=e.error.toString();const E={invokeId:e.invokeId,sid:e.sid,cname:s,cid:f,uid:l,lts:e.lts,success:e.success,elapse:e.lts-r.startTime,execElapse:e.lts-e.apiInvokeTime,apiName:e.name,options:e.options?JSON.stringify(e.options):void 0,execStates:e.states?JSON.stringify(e.states):void 0,execResult:e.result?JSON.stringify(e.result):void 0,errorCode:e.error?m:void 0,errorMsg:e.error?JSON.stringify(e.error):void 0};return this.send({type:_r.API_INVOKE,data:E},!1),!0}addSid(e){this.sids.add(e)}removeSid(e){this.sids.delete(e)}appendSessionId(){const e=this.apiInvokeUploadPendingItems;if(e.length===0)return;const t=Array.from(this.sids).find(r=>r!==null);t&&e.forEach(r=>{r&&(r.sid=t,this.sendApiInvoke(Object.assign({},r)))}),e.length=0}send(e,t){if(t)return this.keyEventUploadPendingItems.push(e),void this.sendItems(this.keyEventUploadPendingItems,!0);this.normalEventUploadPendingItems.push(e),this.normalEventUploadPendingItems.length>me("NORMAL_EVENT_QUEUE_CAPACITY")&&this.normalEventUploadPendingItems.splice(0,1),this.normalEventUploadPendingItems.length>=10&&this.sendItems(this.normalEventUploadPendingItems,!1)}doSend(){this.keyEventUploadPendingItems.length>0&&this.sendItems(this.keyEventUploadPendingItems,!0),this.normalEventUploadPendingItems.length>0&&Date.now()-this.lastSendNormalEventTime>=5e3&&this.sendItems(this.normalEventUploadPendingItems,!1)}sendItems(e,t){const r=[],s=[];for(;e.length;){const f=e.shift();r.length<20?r.push(f):s.push(f)}e.push(...s);for(const f of[...r]){var l;this.ltsList.indexOf(f.data.lts)!==-1?(f.data.lts=this.ltsList[this.ltsList.length-1]+1,this.ltsList.push(f.data.lts)):(this.ltsList.push(f.data.lts),sn(l=this.ltsList).call(l,(m,E)=>m-E))}return t||(this.lastSendNormalEventTime=Date.now()),me("ENABLE_EVENT_REPORT")&&r.length&&(me("NEW_REPORT_SERVER")?this.postDataToStatsCollector2(r):this.postDataToStatsCollector(r)).catch((f=>m=>{me("EVENT_REPORT_RETRY")&&(t?this.keyEventUploadPendingItems=this.keyEventUploadPendingItems.concat(f):(this.normalEventUploadPendingItems=this.normalEventUploadPendingItems.concat(f),this.normalEventUploadPendingItems.length>me("NORMAL_EVENT_QUEUE_CAPACITY")&&(this.normalEventUploadPendingItems.splice(0,this.normalEventUploadPendingItems.length-me("NORMAL_EVENT_QUEUE_CAPACITY")),G.warning("report: drop normal events"))))})(r)),e}async postDataToStatsCollector2(e){na.networkState===Fs.OFFLINE&&await gt.race([na.onlineWaiter,fs(2*ra.maxRetryTimeout)]);const t=l=>{let f=new Uint8Array;return l.forEach(m=>{const E=vS(JSON.stringify(m.data)),y=new ArrayBuffer(5),b=(O=>{let D=0;return Object.entries(_r).forEach(P=>{let[F,B]=P;B===O.type&&(D=Mx[F])}),D})(m),A=new DataView(y);A.setUint16(0,E.byteLength,!0),A.setUint8(2,255&b),A.setUint8(3,b>>>8&255),A.setUint8(4,b>>>16&255),f=Tx(f,new Uint8Array(y)),f=Tx(f,E)}),f},r="event";let s=this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(me("NEW_REPORT_SERVER_DOMAINS")[0],"&p=443&d=").concat(r):"https://".concat(me("NEW_REPORT_SERVER_DOMAINS")[0],"/").concat(r);for(let l=0;l<2;l+=1){l===1&&(s=this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(me("NEW_REPORT_SERVER_DOMAINS")[1],"&p=443&d=").concat(r):"https://".concat(me("NEW_REPORT_SERVER_DOMAINS")[1],"/").concat(r));try{await cI(s,{timeout:1e4,data:t(e),headers:qt(qt({biz:"webrtc",sendts:Math.round(Date.now()/1e3),debug:"false"},this._appId&&{appid:this._appId}),{},{"Content-Type":"application/octet-stream"})},!0)}catch(f){if(l===1)throw f;continue}return}}async postDataToStatsCollector(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];const r=(E=>{const y=E&&E.data.sid&&this.baseInfoMap.get(E.data.sid);return y&&y.info.vid&&+y.info.vid||0})(e[0]),s=r?void 0:this._aid,l={msgType:"EventMessages",sentTs:Math.round(Date.now()/1e3),payloads:e.map(E=>JSON.stringify(E)),vid:r,aid:s};na.networkState===Fs.OFFLINE&&await gt.race([na.onlineWaiter,fs(2*ra.maxRetryTimeout)]);const f=t?"/events/proto-raws":"/events/messages";let m=this.url||(this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(me("EVENT_REPORT_DOMAIN"),"&p=").concat(me("STATS_COLLECTOR_PORT"),"&d=").concat(f):"https://".concat(me("EVENT_REPORT_DOMAIN"),":").concat(me("STATS_COLLECTOR_PORT")).concat(f));for(let E=0;E<2;E+=1){E===1&&(m=this.backupUrl||(this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(me("EVENT_REPORT_BACKUP_DOMAIN"),"&p=").concat(me("STATS_COLLECTOR_PORT"),"&d=").concat(f):"https://".concat(me("EVENT_REPORT_BACKUP_DOMAIN"),":").concat(me("STATS_COLLECTOR_PORT")).concat(f)));try{t?await cY(m,{timeout:1e4,data:l}):await cI(m,{timeout:1e4,data:l})}catch(y){if(E===1)throw y;continue}return}}createBaseInfo(e,t){const r=Object.assign({},Kb);return r.sid=e,this.baseInfoMap.set(e,{info:r,startTime:t}),r}reportResourceTiming(e,t){const r=performance.getEntriesByName(e),s=r[r.length-1];s&&this.reportApiInvoke(t,{name:"Client.resourceTiming",options:s,tag:Bn.TRACER}).onSuccess()}};di.on("REPORT_LOG_UPLOAD",e=>{e.networkState=na.networkState,Vt.reportApiInvoke(null,{name:"logUploadError",options:e,tag:Bn.TRACER}).onSuccess("logUploadError")});class xe extends Ke{constructor(t){super(t,arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",arguments.length>2?arguments[2]:void 0),xi(this,"name","AgoraRTCException")}print(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"error";return super.print(t,G)}throw(){super.throw(G)}}const zi={getDisplayMedia:!1,getStreamFromExtension:!1,supportUnifiedPlan:!1,supportMinBitrate:!1,supportSetRtpSenderParameters:!1,supportDualStream:!0,webAudioMediaStreamDest:!1,supportReplaceTrack:!1,supportWebGL:!1,webAudioWithAEC:!1,supportRequestFrame:!1,supportShareAudio:!1,supportDualStreamEncoding:!1,supportDataChannel:!1,supportPCSetConfiguration:!1,supportWebRTCEncodedTransform:!1,supportWebRTCInsertableStream:!1,supportRequestVideoFrameCallback:!1,supportWebCrypto:!1};function zn(){return zi}function uI(){return"setSinkId"in HTMLAudioElement.prototype&&(!me("RESTRICTION_SET_PLAYBACK_DEVICE")||(Up()||Ex())&&!Cr())}function E8(){return!zi.supportUnifiedPlan||me("CHROME_FORCE_PLAN_B")&&fh()}let xa=function(e){return e.IOS_15_16_INTERRUPTION_START="ios15_16-interruption-start",e.IOS_15_16_INTERRUPTION_END="ios15_16-interruption-end",e.IOS_INTERRUPTION_START="ios-interruption-start",e.IOS_INTERRUPTION_END="ios-interruption-end",e.STATE_CHANGE="state-change",e}({});function _h(e,t,r){return{sampleRate:e,stereo:t,bitrate:r}}function Jn(e,t,r,s,l){return{width:e,height:t,frameRate:r,bitrateMin:s,bitrateMax:l}}function bt(e,t,r,s,l){return{width:{max:e},height:{max:t},frameRate:r,bitrateMin:s,bitrateMax:l}}function kr(e,t){return{numSpatialLayers:e,numTemporalLayers:t}}const qb={"90p":Jn(160,90),"90p_1":Jn(160,90),"120p":Jn(160,120,15,30,65),"120p_1":Jn(160,120,15,30,65),"120p_3":Jn(120,120,15,30,50),"120p_4":Jn(212,120),"180p":Jn(320,180,15,30,140),"180p_1":Jn(320,180,15,30,140),"180p_3":Jn(180,180,15,30,100),"180p_4":Jn(240,180,15,30,120),"240p":Jn(320,240,15,40,200),"240p_1":Jn(320,240,15,40,200),"240p_3":Jn(240,240,15,40,140),"240p_4":Jn(424,240,15,40,220),"360p":Jn(640,360,15,80,400),"360p_1":Jn(640,360,15,80,400),"360p_3":Jn(360,360,15,80,260),"360p_4":Jn(640,360,30,80,600),"360p_6":Jn(360,360,30,80,400),"360p_7":Jn(480,360,15,80,320),"360p_8":Jn(480,360,30,80,490),"360p_9":Jn(640,360,15,80,800),"360p_10":Jn(640,360,24,80,800),"360p_11":Jn(640,360,24,80,1e3),"480p":Jn(640,480,15,100,500),"480p_1":Jn(640,480,15,100,500),"480p_2":Jn(640,480,30,100,1e3),"480p_3":Jn(480,480,15,100,400),"480p_4":Jn(640,480,30,100,750),"480p_6":Jn(480,480,30,100,600),"480p_8":Jn(848,480,15,100,610),"480p_9":Jn(848,480,30,100,930),"480p_10":Jn(640,480,10,100,400),"720p":Jn(1280,720,15,120,1130),"720p_auto":Jn(1280,720,30,900,3e3),"720p_1":Jn(1280,720,15,120,1130),"720p_2":Jn(1280,720,30,120,2e3),"720p_3":Jn(1280,720,30,120,1710),"720p_5":Jn(960,720,15,120,910),"720p_6":Jn(960,720,30,120,1380),"1080p":Jn(1920,1080,15,120,2080),"1080p_1":Jn(1920,1080,15,120,2080),"1080p_2":Jn(1920,1080,30,120,3e3),"1080p_3":Jn(1920,1080,30,120,3150),"1080p_5":Jn(1920,1080,60,120,4780),"1440p":Jn(2560,1440,30,120,4850),"1440p_1":Jn(2560,1440,30,120,4850),"1440p_2":Jn(2560,1440,60,120,7350),"4k":Jn(3840,2160,30,120,8910),"4k_1":Jn(3840,2160,30,120,8910),"4k_3":Jn(3840,2160,60,120,13500)},uY={"480p":bt(640,480,5),"480p_1":bt(640,480,5),"480p_2":bt(640,480,30),"480p_3":bt(640,480,15),"720p":bt(1280,720,5),"720p_auto":Jn(1280,720,30,900,3e3),"720p_1":bt(1280,720,5),"720p_2":bt(1280,720,30),"720p_3":bt(1280,720,15),"1080p":bt(1920,1080,5),"1080p_1":bt(1920,1080,5),"1080p_2":bt(1920,1080,30),"1080p_3":bt(1920,1080,15)},fY={"1SL1TL":kr(1,1),"3SL3TL":kr(3,3),"2SL3TL":kr(2,3)};function Bo(e){return e||(e="480p_1"),typeof e=="string"?Object.assign({},qb[e]):e}function x_(e){return typeof e=="string"?Object.assign({},uY[e]):e}function Mg(e){return typeof e=="string"?Object.assign({},fY[e]):e}const Jb={speech_low_quality:_h(16e3,!1),speech_standard:_h(32e3,!1,18),music_standard:_h(48e3,!1),standard_stereo:_h(48e3,!0,56),high_quality:_h(48e3,!1,128),high_quality_stereo:_h(48e3,!0,192)};function lc(e){return typeof e=="string"?Object.assign({},Jb[e]):e}const U_=[];function OL(e){return Aa(e,"mediaSource",["screen","window","application"]),!0}let Dt=function(e){return e.NEED_RENEGOTIATE="@need_renegotiate",e.NEED_REPLACE_TRACK="@need_replace_track",e.NEED_REPLACE_MIXING_TRACK="@need_replace_mixing_track",e.NEED_CLOSE="@need_close",e.NEED_ENABLE_TRACK="@need_enable_track",e.NEED_DISABLE_TRACK="@need_disable_track",e.NEED_SESSION_ID="@need_sid",e.SET_OPTIMIZATION_MODE="@set_optimization_mode",e.GET_STATS="@get_stats",e.GET_RTC_STATS="@get_rtc_stats",e.GET_LOW_VIDEO_TRACK="@get_low_video_track",e.NEED_RESET_REMOTE_SDP="@need_reset_remote_sdp",e.NEED_UPDATE_VIDEO_ENCODER="@need_update_video_encoder",e.NEED_UPDATE_VIDEO_SEND_PARAMETERS="@need_update_video_send_parameters",e.NEED_MUTE_TRACK="@need_mute_track",e.NEED_UNMUTE_TRACK="@need_unmute_track",e}({}),xr=function(e){return e.SCREEN_TRACK="screen_track",e.CUSTOM_TRACK="custome_track",e.LOW_STREAM="low_stream",e.SCREEN_LOW_TRACK="screen_low_track",e}({}),wS=function(e){return e[e.HIGH_STREAM=0]="HIGH_STREAM",e[e.LOW_STREAM=1]="LOW_STREAM",e}({}),Fo=function(e){return e[e.HIGH_STREAM=0]="HIGH_STREAM",e[e.LOW_STREAM=1]="LOW_STREAM",e[e.HIGH_STREAM_LAYER1=4]="HIGH_STREAM_LAYER1",e[e.HIGH_STREAM_LAYER2=5]="HIGH_STREAM_LAYER2",e[e.HIGH_STREAM_LAYER3=6]="HIGH_STREAM_LAYER3",e[e.HIGH_STREAM_LAYER4=7]="HIGH_STREAM_LAYER4",e[e.HIGH_STREAM_LAYER5=8]="HIGH_STREAM_LAYER5",e[e.HIGH_STREAM_LAYER6=9]="HIGH_STREAM_LAYER6",e}({}),nd=function(e){return e[e.DISABLE=0]="DISABLE",e[e.LOW_STREAM=1]="LOW_STREAM",e[e.AUDIO_ONLY=2]="AUDIO_ONLY",e[e.HIGH_STREAM_LAYER1=3]="HIGH_STREAM_LAYER1",e[e.HIGH_STREAM_LAYER2=4]="HIGH_STREAM_LAYER2",e[e.HIGH_STREAM_LAYER3=5]="HIGH_STREAM_LAYER3",e[e.HIGH_STREAM_LAYER4=6]="HIGH_STREAM_LAYER4",e[e.HIGH_STREAM_LAYER5=7]="HIGH_STREAM_LAYER5",e[e.HIGH_STREAM_LAYER6=8]="HIGH_STREAM_LAYER6",e}({}),Eh=function(e){return e.TRANSCEIVER_UPDATED="transceiver-updated",e.SEI_TO_SEND="sei-to-send",e.SEI_RECEIVED="sei-received",e.TRACK_UPDATED="track-updated",e}({}),Zu=function(e){return e.SOURCE_STATE_CHANGE="source-state-change",e.TRACK_ENDED="track-ended",e.BEAUTY_EFFECT_OVERLOAD="beauty-effect-overload",e.VIDEO_ELEMENT_VISIBLE_STATUS="video-element-visible-status",e.CLOSED="closed",e}({}),is=function(e){return e.FIRST_FRAME_DECODED="first-frame-decoded",e.VIDEO_ELEMENT_VISIBLE_STATUS="video-element-visible-status",e.VIDEO_STATE_CHANGED="video-state-changed",e}({}),yl=function(e){return e.AUDIO="audio",e.VIDEO="video",e.DATA="data",e}({}),Vc=function(e){return e.AUDIO_SOURCE_STATE_CHANGE="audio_source_state_change",e.RECEIVE_TRACK_BUFFER="receive_track_buffer",e.ON_AUDIO_BUFFER="on_audio_buffer",e.UPDATE_SOURCE="update_source",e}({});(function(e){e.UPDATE_TRACK_SOURCE="update-track-source"})({});const Xb={sendVolumeLevel:0,sendBitrate:0,sendBytes:0,sendPackets:0,sendPacketsLost:0,sendJitterMs:0,sendRttMs:0,currentPacketLossRate:0},NL={sendBytes:0,sendBitrate:0,sendPackets:0,sendPacketsLost:0,sendJitterMs:0,sendRttMs:0,sendResolutionHeight:0,sendResolutionWidth:0,captureResolutionHeight:0,captureResolutionWidth:0,targetSendBitrate:0,totalDuration:0,totalFreezeTime:0,currentPacketLossRate:0},ui={transportDelay:0,end2EndDelay:0,receiveBitrate:0,receiveLevel:0,receiveBytes:0,receiveDelay:0,receivePackets:0,receivePacketsLost:0,receivePacketsDiscarded:0,totalDuration:0,totalFreezeTime:0,freezeRate:0,packetLossRate:0,currentPacketLossRate:0,publishDuration:-1},Me={uplinkNetworkQuality:0,downlinkNetworkQuality:0},Xn={transportDelay:0,end2EndDelay:0,receiveBitrate:0,receiveBytes:0,receiveDelay:0,receivePackets:0,receivePacketsLost:0,receiveResolutionHeight:0,receiveResolutionWidth:0,totalDuration:0,totalFreezeTime:0,freezeRate:0,packetLossRate:0,currentPacketLossRate:0,publishDuration:-1};let So=function(e){return e.ON_TRACK="on_track",e.ON_NODE="on_node",e}({}),yo=function(e){return e.REQUEST_UPDATE_CONSTRAINTS="request_update_constraints",e.REQUEST_CONSTRAINTS="request_constraints",e}({}),Qb=function(e){return e.IDLE="IDLE",e.INITING="INITING",e.INITEND="INITEND",e}({}),no=function(e){return e.STATE_CHANGE="state_change",e.RECORDING_DEVICE_CHANGED="recordingDeviceChanged",e.PLAYOUT_DEVICE_CHANGED="playoutDeviceChanged",e.CAMERA_DEVICE_CHANGED="cameraDeviceChanged",e}({}),Tn=function(e){return e.NONE="none",e.INIT="init",e.CANPLAY="canplay",e.PLAYING="playing",e.PAUSED="paused",e.SUSPEND="suspend",e.STALLED="stalled",e.WAITING="waiting",e.ERROR="error",e.DESTROYED="destroyed",e.ABORT="abort",e.ENDED="ended",e.EMPTIED="emptied",e.LOADEDDATA="loadeddata",e}({}),Tl=function(e){return e[e.VideoStateStopped=0]="VideoStateStopped",e[e.VideoStateStarting=1]="VideoStateStarting",e[e.VideoStateDecoding=2]="VideoStateDecoding",e[e.VideoStateFrozen=3]="VideoStateFrozen",e}({});const kg={uninit:100,none:110,init:120,loadeddata:130,canplay:200,playing:210,paused:220,suspend:300,stalled:310,waiting:320,error:330,destroyed:340,abort:350,ended:360,emptied:370};let Zb=function(e){return e.OPEN="open",e.MESSAGE="message",e.CLOSE="close",e.CLOSING="closing",e.ERROR="error",e}({});function jn(e,t,r,s,l){var f,m,E={};return Object.keys(s).forEach(function(y){E[y]=s[y]}),E.enumerable=!!E.enumerable,E.configurable=!!E.configurable,("value"in E||E.initializer)&&(E.writable=!0),E=wc(f=Hy(m=r.slice()).call(m)).call(f,function(y,b){return b(e,t,y)||y},E),l&&E.initializer!==void 0&&(E.value=E.initializer?E.initializer.call(l):void 0,E.initializer=void 0),E.initializer===void 0?(Object.defineProperty(e,t,E),null):E}function Pe(e,t,r){return(t=function(s){var l=function(f,m){if(typeof f!="object"||!f)return f;var E=f[Symbol.toPrimitive];if(E!==void 0){var y=E.call(f,"string");if(typeof y!="object")return y;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(f)}(s);return typeof l=="symbol"?l:l+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kx(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),r.push.apply(r,s)}return r}function fi(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?kx(Object(r),!0).forEach(function(s){Pe(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):kx(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}class xx extends Xt{set _mediaStreamTrack(t){t!==this.mediaStreamTrack&&(this.safeEmit(Eh.TRACK_UPDATED,t),this.mediaStreamTrack=t)}get _mediaStreamTrack(){return this.mediaStreamTrack}constructor(t,r){super(),Pe(this,"trackMediaType",void 0),Pe(this,"_ID",void 0),Pe(this,"_rtpTransceiver",void 0),Pe(this,"_lowRtpTransceiver",void 0),Pe(this,"_hints",[]),Pe(this,"_isClosed",!1),Pe(this,"_originMediaStreamTrack",void 0),Pe(this,"mediaStreamTrack",void 0),Pe(this,"_external",{}),this._ID=r||Br(8,"track-"),this._originMediaStreamTrack=t,this.mediaStreamTrack=t,function(s){ht(U_).call(U_,s)||U_.push(s)}(this)}toString(){return this._ID}getTrackId(){return this._ID}getMediaStreamTrack(t){return t||ph(()=>{var r;Vt.reportApiInvoke(null,{name:Di.GET_MEDIA_STREAM_TRACK,options:[],tag:Bn.TRACER}).onSuccess(((r=this._mediaStreamTrack)===null||r===void 0?void 0:r.label)||"")},this.mediaStreamTrack.id||this.getTrackId()),this._mediaStreamTrack}getRTCRtpTransceiver(t){return t===wS.LOW_STREAM?this._lowRtpTransceiver:this._rtpTransceiver}getMediaStreamTrackSettings(){return this.getMediaStreamTrack(!0).getSettings()}close(){this._isClosed=!0,this._lowRtpTransceiver=void 0,this._rtpTransceiver=void 0,function(t){const r=U_.indexOf(t);r!==-1&&U_.splice(r,1)}(this),this.emit(Zu.CLOSED),this.removeAllListeners(Eh.SEI_RECEIVED)}_updateRtpTransceiver(t,r){if(r===wS.LOW_STREAM){if(this._lowRtpTransceiver===t)return;this._lowRtpTransceiver=t}else{if(this._rtpTransceiver===t)return;this._rtpTransceiver=t}this.emit(Eh.TRANSCEIVER_UPDATED,t,r)}}class $b extends xx{get isExternalTrack(){return this._isExternalTrack}get muted(){return this._muted}get enabled(){return this._enabled}get processorContext(){return this._processorContext}constructor(t,r){super(t,r),Pe(this,"_enabled",!0),Pe(this,"_muted",!1),Pe(this,"_isExternalTrack",!1),Pe(this,"_isClosed",!1),Pe(this,"_enabledMutex",void 0),Pe(this,"processor",void 0),Pe(this,"_processorContext",void 0),Pe(this,"_handleTrackEnded",()=>{this.onTrackEnded()}),this._enabledMutex=new Gi("".concat(this.getTrackId())),t.addEventListener("ended",this._handleTrackEnded)}getTrackLabel(){var t,r;return(t=(r=this._originMediaStreamTrack)===null||r===void 0?void 0:r.label)!==null&&t!==void 0?t:""}close(){this._isClosed||(this.stop(),this._originMediaStreamTrack.stop(),this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack.stop(),this._mediaStreamTrack=null),this._originMediaStreamTrack=null,this._enabledMutex=null,G.debug("[".concat(this.getTrackId(),"] close")),this.emit(Dt.NEED_CLOSE),super.close())}async _updateOriginMediaStreamTrack(t,r){let s=arguments.length>2&&arguments[2]!==void 0&&arguments[2];this._isExternalTrack=s,t!==this._originMediaStreamTrack&&(this._originMediaStreamTrack&&(this._originMediaStreamTrack.removeEventListener("ended",this._handleTrackEnded),r&&this._originMediaStreamTrack.stop()),t.addEventListener("ended",this._handleTrackEnded),this._originMediaStreamTrack=t,this._muted&&(this._originMediaStreamTrack.enabled=!1),this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await fr(this,Dt.NEED_REPLACE_TRACK,this),this.processor&&this._processorContext&&this.processor.updateInput({track:this._originMediaStreamTrack,context:this._processorContext}))}_getDefaultPlayerConfig(){return{}}onTrackEnded(){G.debug("[".concat(this.getTrackId(),"] track ended")),this.safeEmit(Zu.TRACK_ENDED)}stateCheck(t,r){if(G.debug("check track state, [muted: ".concat(this._muted,", enabled: ").concat(this._enabled,"] to [").concat(t,": ").concat(r,"]")),hh(r,t),this._enabled&&this._muted&&t==="enabled"&&r===!1)throw new Ke(se.TRACK_STATE_UNREACHABLE,"cannot set enabled while the track is muted").print("error",G);if(!this._enabled&&!this._muted&&t==="muted"&&r===!0)throw new Ke(se.TRACK_STATE_UNREACHABLE,"cannot set muted while the track is disabled").print("error",G)}getProcessorStats(){return this._processorContext&&this._processorContext.gatherStats()||[]}getProcessorUsage(){return this._processorContext?this._processorContext.gatherUsage():gt.resolve([])}}const Ux=window.AudioContext||window.webkitAudioContext;let Bc=null;const Rr=new class extends Xt{constructor(){super(...arguments),Pe(this,"prevState",void 0),Pe(this,"curState",void 0),Pe(this,"currentTime",void 0),Pe(this,"currentTimeStuckAt",void 0),Pe(this,"interruptDetectorTrack",void 0),Pe(this,"onLocalAudioTrackMute",()=>{G.info("ios15-interruption-start"),this.emit(xa.IOS_15_16_INTERRUPTION_START)}),Pe(this,"onLocalAudioTrackUnmute",async()=>{G.info("ios15-interruption-end"),this.curState!=="running"||this.duringInterruption?G.info("ios15-interruption-end-canceled"):(Bc&&await Bc.suspend(),this.emit(xa.IOS_15_16_INTERRUPTION_END))})}get duringInterruption(){return this.prevState==="running"&&this.curState==="interrupted"}bindInterruptDetectorTrack(e){G.debug("webaudio bindInterruptDetectorTrack ".concat(e.getTrackId())),this.interruptDetectorTrack||(this.interruptDetectorTrack=e,this.interruptDetectorTrack._mediaStreamTrack.onmute=this.onLocalAudioTrackMute,this.interruptDetectorTrack._mediaStreamTrack.onunmute=this.onLocalAudioTrackUnmute)}unbindInterruptDetectorTrack(e){G.debug("webaudio unbindInterruptDetectorTrack ".concat(e.getTrackId())),this.interruptDetectorTrack&&this.interruptDetectorTrack===e&&(this.interruptDetectorTrack._mediaStreamTrack&&(this.interruptDetectorTrack._mediaStreamTrack.onmute=null,this.interruptDetectorTrack._mediaStreamTrack.onunmute=null),this.interruptDetectorTrack=void 0)}};function RS(){if(!Bc){if(function(){if(!Ux)return void G.error("your browser is not support web audio");G.info("create audio context");const e=fi({},me("WEBAUDIO_INIT_OPTIONS"));G.debug("audio context init option:",JSON.stringify(e)),Bc=new Ux(e),Rr.curState=Bc.state,Bc.onstatechange=()=>{Rr.prevState=Rr.curState,Rr.curState=Bc?Bc.state:void 0;const{prevState:t,curState:r}=Rr,s=r==="running",l=r==="interrupted",f=t==="running",m=t==="suspended",E=t==="interrupted",y=qn().osVersion;(to()||Ye())&&f&&l&&(G.info("ios".concat(y,"-interruption-start")),Rr.emit(xa.IOS_INTERRUPTION_START)),(to()||Ye())&&(m||E)&&s&&(G.info("ios".concat(y,"-interruption-end")),Rr.emit(xa.IOS_INTERRUPTION_END)),t!==r&&Rr.emit(xa.STATE_CHANGE,r,t)},setInterval(()=>{var t;const r=(t=Bc)===null||t===void 0?void 0:t.currentTime;Rr.currentTime!==r?(Rr.currentTimeStuckAt&&(G.debug("AudioContext current time resume at ".concat(r)),Rr.currentTimeStuckAt=void 0),Rr.currentTime=r):(r!==Rr.currentTimeStuckAt&&(Vt.reportApiInvoke(null,{name:"WEB_AUDIO_CURRENT_TIME_STUCK",options:{currentTime:r},tag:Bn.TRACER}).onSuccess(),G.warning("AudioContext current time stuck at ".concat(r))),Rr.currentTimeStuckAt=r)},5e3),async function(t){const r=["click","contextmenu","auxclick","dblclick","mousedown","mouseup","touchend","keydown","keyup"];let s,l=!1,f=!1,m=!1;function E(B){t.state==="running"?y(!1):to()||Ye()?t.state==="suspended"&&(y(!0),B&&t.resume().then(b,b)):t.state!=="closed"&&(y(!0),B&&t.resume().then(b,b))}function y(B){if(l!==B){l=B;for(let Y=0,$=r;Y<$.length;Y+=1){const ee=$[Y];B?window.addEventListener(ee,A,{capture:!0,passive:!0}):window.removeEventListener(ee,A,{capture:!0,passive:!0})}}}function b(){E(!1)}function A(){E(!0)}function O(B){if(!m)if(s.paused)if(B){let Y;D(!1),m=!0;try{Y=s.play(),Y?Y.then(P,P):(s.addEventListener("playing",P),s.addEventListener("abort",P),s.addEventListener("error",P))}catch{P()}}else D(!0);else D(!1)}function D(B){if(f!==B){f=B;for(let Y=0,$=r;Y<$.length;Y++){const ee=$[Y];B?window.addEventListener(ee,F,{capture:!0,passive:!0}):window.removeEventListener(ee,F,{capture:!0,passive:!0})}}}function P(){s.removeEventListener("playing",P),s.removeEventListener("abort",P),s.removeEventListener("error",P),m=!1,O(!1)}function F(){O(!0)}if(to()){const B=t.createMediaStreamDestination(),Y=document.createElement("div");Y.innerHTML="<audio x-webkit-airplay='deny'></audio>",s=Y.children.item(0),s.controls=!1,s.disableRemotePlayback=!0,s.preload="auto",s.srcObject=B.stream,O(!0)}Rr.on(xa.STATE_CHANGE,function(){E(!0)}),E(!1)}(Bc)}(),!Bc)throw new Ke(se.NOT_SUPPORTED,"can not create audio context");return Bc}return Bc}function ro(e){if(function(){if(jx!==null)return jx;const s=RS(),l=s.createBufferSource(),f=s.createGain(),m=s.createGain();l.connect(f),l.connect(m),l.disconnect(f);let E=!1;try{l.disconnect(f)}catch{E=!0}return l.disconnect(),jx=E,E}())return;const t=e.connect,r=e.disconnect;e.connect=(s,l,f)=>{var m;return e._inputNodes||(e._inputNodes=[]),ht(m=e._inputNodes).call(m,s)||(s instanceof AudioNode?(e._inputNodes.push(s),t.call(e,s,l,f)):t.call(e,s,l)),e},e.disconnect=(s,l,f)=>{r.call(e),s?Qd(e._inputNodes,s):e._inputNodes=[];for(const m of e._inputNodes)t.call(e,m)}}let jx=null;function e1(e,t){let r=!1;const s=1/t;if(me("DISABLE_WEBAUDIO")){const l=window.setInterval(()=>{r?window.clearInterval(l):e(performance.now()/1e3)},1e3*s)}else{const l=RS();let f=l.createGain();f.gain.value=0,f.connect(l.destination);const m=()=>{if(r)return void(f=null);const E=l.createOscillator();E.onended=m,E.connect(f),E.start(0),E.stop(l.currentTime+s),e(l.currentTime)};m()}return()=>{r=!0}}class IS{constructor(){Pe(this,"context",void 0),Pe(this,"analyserNode",void 0),Pe(this,"sourceNode",void 0),this.context=RS(),this.analyserNode=this.context.createAnalyser(),this.analyserNode.fftSize=2048,this.analyserNode.smoothingTimeConstant=.4}updateSource(t){if(t!==this.sourceNode){if(this.sourceNode)try{this.sourceNode.disconnect(this.analyserNode)}catch{}this.sourceNode=t,t==null||t.connect(this.analyserNode)}}getVolumeLevel(){if(!this.sourceNode||(!this.context||to()||Ye()||this.context.state!=="running"&&this.context.resume(),!this.analyserNode))return 0;const t=new Float32Array(this.analyserNode.fftSize);if(this.analyserNode.getFloatTimeDomainData)this.analyserNode.getFloatTimeDomainData(t);else{const s=new Uint8Array(this.analyserNode.fftSize);this.analyserNode.getByteTimeDomainData(s);for(let l=0;l<t.length;++l)t[l]=s[l]/128-1}const r=wc(t).call(t,(s,l)=>s+l*l,0)/t.length;return Math.max(10*Math.log10(r)+100,0)/100}getAnalyserNode(){return this.analyserNode}rebuildAnalyser(){try{var t,r;(t=this.sourceNode)===null||t===void 0||t.disconnect(this.analyserNode),this.analyserNode=this.context.createAnalyser(),this.analyserNode.fftSize=2048,this.analyserNode.smoothingTimeConstant=.4,(r=this.sourceNode)===null||r===void 0||r.connect(this.analyserNode)}catch{G.warning("rebuild analyser node failed.")}}destroy(){this.updateSource(void 0)}}class bl extends Xt{get processSourceNode(){return this.sourceNode}set processedNode(t){var r;if(!this.isDestroyed&&this._processedNode!==t){try{var s;(s=this.sourceNode)===null||s===void 0||s.disconnect(this.outputNode)}catch{}(r=this._processedNode)===null||r===void 0||r.disconnect(),this._processedNode=t,this.connect()}}get processedNode(){return this._processedNode}constructor(){super(),Pe(this,"outputNode",void 0),Pe(this,"outputTrack",void 0),Pe(this,"isPlayed",!1),Pe(this,"sourceNode",void 0),Pe(this,"context",void 0),Pe(this,"audioBufferNode",void 0),Pe(this,"destNode",void 0),Pe(this,"audioOutputLevel",0),Pe(this,"volumeLevelAnalyser",void 0),Pe(this,"_processedNode",void 0),Pe(this,"playNode",void 0),Pe(this,"isDestroyed",!1),Pe(this,"onNoAudioInput",void 0),Pe(this,"isNoAudioInput",!1),Pe(this,"_noAudioInputCount",0),this.context=RS(),this.playNode=this.context.destination,this.outputNode=this.context.createGain(),ro(this.outputNode),this.volumeLevelAnalyser=new IS}startGetAudioBuffer(t){this.audioBufferNode||(this.audioBufferNode=this.context.createScriptProcessor(t),this.outputNode.connect(this.audioBufferNode),this.audioBufferNode.connect(this.context.destination),this.audioBufferNode.onaudioprocess=r=>{this.emit(Vc.ON_AUDIO_BUFFER,function(s){for(let l=0;l<s.outputBuffer.numberOfChannels;l+=1){const f=s.outputBuffer.getChannelData(l);for(let m=0;m<f.length;m+=1)f[m]=0}return s.inputBuffer}(r))})}stopGetAudioBuffer(){this.audioBufferNode&&(this.audioBufferNode.onaudioprocess=null,this.outputNode.disconnect(this.audioBufferNode),this.audioBufferNode=void 0)}createOutputTrack(){if(!zn().webAudioMediaStreamDest)throw new Ke(se.NOT_SUPPORTED,"your browser is not support audio processor");return this.destNode&&this.outputTrack||(this.destNode=this.context.createMediaStreamDestination(),this.outputNode.connect(this.destNode),this.outputTrack=this.destNode.stream.getAudioTracks()[0]),this.outputTrack}play(t){this.context.state!=="running"&&gL(()=>{Rr.emit("autoplay-failed")}),this.isPlayed=!0,this.playNode=t||this.context.destination,this.outputNode.connect(this.playNode)}stop(){if(this.isPlayed)try{this.outputNode.disconnect(this.playNode)}catch{}this.isPlayed=!1}getAccurateVolumeLevel(){return this.volumeLevelAnalyser.getVolumeLevel()}async checkHasAudioInput(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;if(t>5)return this.isNoAudioInput=!0,this.onNoAudioInput&&this.onNoAudioInput(),!1;to()||Ye()?this.context.state==="suspended"&&this.context.resume():this.context.state!=="running"&&this.context.resume();const r=this.volumeLevelAnalyser.getAnalyserNode();let s;r.getFloatTimeDomainData?(s=new Float32Array(r.fftSize),r.getFloatTimeDomainData(s)):(s=new Uint8Array(r.fftSize),r.getByteTimeDomainData(s));let l=!1;for(let f=0;f<s.length;f++)s[f]!==0&&(l=!0);return l?(this.isNoAudioInput=!1,!0):(await fs(200),await this.checkHasAudioInput(t?t+1:1)&&l)}getAudioVolume(){return this.outputNode.gain.value}setVolume(t){this.outputNode.gain.setValueAtTime(t,this.context.currentTime)}destroy(){this.disconnect(),this.stop(),this.isDestroyed=!0,this.onNoAudioInput=void 0}disconnect(){var t,r;(t=this.processedNode)===null||t===void 0||t.disconnect(),(r=this.sourceNode)===null||r===void 0||r.disconnect(),this.outputNode&&this.outputNode.disconnect()}connect(){var t;this.processedNode?(t=this.processedNode)===null||t===void 0||t.connect(this.outputNode):this.sourceNode&&this.sourceNode.connect(this.outputNode),this.volumeLevelAnalyser.updateSource(this.outputNode)}}class LL extends bl{get isFreeze(){return!1}constructor(t,r,s){var l;if(super(),Pe(this,"sourceNode",void 0),Pe(this,"track",void 0),Pe(this,"clonedTrack",void 0),Pe(this,"audioElement",void 0),Pe(this,"isCurrentTrackCloned",!1),Pe(this,"isRemoteTrack",!1),Pe(this,"originVolumeLevelAnalyser",void 0),Pe(this,"rebuildWebAudio",async()=>{if(G.debug("ready to rebuild web audio, state:",this.context.state),this.isNoAudioInput&&await this.checkHasAudioInput(),!this.isNoAudioInput||this.isDestroyed)return document.body.removeEventListener("click",this.rebuildWebAudio,!0),void G.debug("rebuild web audio success, current volume status",this.getAccurateVolumeLevel());this.context.resume().then(()=>G.info("resume success")),G.debug("rebuild web audio because of ios 12 bugs"),this.disconnect();const E=this.track;this.track=this.track.clone(),this.isCurrentTrackCloned?E.stop():this.isCurrentTrackCloned=!0;const y=new MediaStream([this.track]);this.sourceNode=this.context.createMediaStreamSource(y),ro(this.sourceNode),this.volumeLevelAnalyser.rebuildAnalyser();const b=this.outputNode.gain.value;this.outputNode=this.context.createGain(),this.outputNode.gain.setValueAtTime(b,this.context.currentTime),ro(this.outputNode),this.emit(Vc.UPDATE_SOURCE),this.connect(),this.audioElement.srcObject=y,this.isPlayed&&this.play(this.playNode),this.checkHasAudioInput()}),t.kind!=="audio")throw new Ke(se.UNEXPECTED_ERROR);this.track=t;const f=new MediaStream([this.track]);if(this.isRemoteTrack=!!r,this.sourceNode=this.context.createMediaStreamSource(f),ro(this.sourceNode),s){const E=s.clone();E.enabled=!0,this.clonedTrack=E,G.debug("create an unmuted track ".concat(E.id," from the original track ").concat(s.id," to get the volume"));const y=this.context.createMediaStreamSource(new MediaStream([E]));ro(y),this.originVolumeLevelAnalyser=new IS,this.originVolumeLevelAnalyser.updateSource(y)}this.connect(),this.audioElement=document.createElement("audio"),this.audioElement.srcObject=f;const m=qn();r&&m.os===mr.IOS&&Number((l=m.osVersion)===null||l===void 0?void 0:l.split(".")[0])<15&&(Rr.on(xa.STATE_CHANGE,()=>{this.context.state==="suspended"?document.body.addEventListener("click",this.rebuildWebAudio,!0):this.context.state==="running"&&this.rebuildWebAudio()}),this.checkHasAudioInput().then(E=>{E||document.body.addEventListener("click",this.rebuildWebAudio,!0)}))}updateTrack(t){this.sourceNode.disconnect(),this.track=t,this.isCurrentTrackCloned=!1;const r=new MediaStream([t]);this.sourceNode=this.context.createMediaStreamSource(r),ro(this.sourceNode),this.processedNode||this.sourceNode.connect(this.outputNode),this.emit(Vc.UPDATE_SOURCE),this.audioElement.srcObject=r}destroy(){var t;this.audioElement.srcObject=null,this.audioElement.remove(),Rr.off("state-change",this.rebuildWebAudio),(t=this.originVolumeLevelAnalyser)===null||t===void 0||t.destroy(),this.clonedTrack=void 0,super.destroy()}createMediaStreamSourceNode(t){return this.context.createMediaStreamSource(new MediaStream([t]))}updateOriginTrack(t){const r=t.clone();r.enabled=!0,this.clonedTrack&&(this.clonedTrack.stop(),this.clonedTrack=r),G.debug("create an unmuted track ".concat(r.id," from the original track ").concat(t.id," to get the volume"));const s=this.context.createMediaStreamSource(new MediaStream([r]));ro(s),this.originVolumeLevelAnalyser&&this.originVolumeLevelAnalyser.updateSource(s)}getOriginVolumeLevel(){return this.originVolumeLevelAnalyser?this.originVolumeLevelAnalyser.getVolumeLevel():this.getAccurateVolumeLevel()}}async function Cl(e,t,r){const s=(f,m)=>f?typeof f!="number"?f.max||f.exact||f.ideal||f.min||m:f:m,l={audio:!!r&&{mandatory:{chromeMediaSource:"desktop"}},video:{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:e,maxHeight:s(t.height,1080),maxWidth:s(t.width,1920)}}};return t.frameRate&&typeof t.frameRate!="number"?(l.video.mandatory.maxFrameRate=t.frameRate.max,l.video.mandatory.minFrameRate=t.frameRate.min):typeof t.frameRate=="number"&&(l.video.mandatory.maxFrameRate=t.frameRate),await navigator.mediaDevices.getUserMedia(l)}async function v8(e,t){const r=await Vx(e.mediaSource),{sourceId:s,audio:l}=await function(f){let m=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return new gt((E,y)=>{const b=document.createElement("div");b.innerText="share screen",b.setAttribute("style","text-align: center; height: 25px; line-height: 25px; border-radius: 4px 4px 0 0; background: #D4D2D4; border-bottom:  solid 1px #B9B8B9;");const A=document.createElement("div");A.setAttribute("style","width: 100%; height: 500px; padding: 15px 25px ; box-sizing: border-box;");const O=document.createElement("div");O.innerText="Agora Web Screensharing wants to share the contents of your screen with webdemo.agorabeckon.com. Choose what you'd like to share.",O.setAttribute("style","height: 12%;");const D=document.createElement("div");D.setAttribute("style","width: 100%; height: 80%; background: #FFF; border:  solid 1px #CBCBCB; display: flex; flex-wrap: wrap; justify-content: space-around; overflow-y: scroll; padding: 0 15px; box-sizing: border-box;");const P=document.createElement("div");P.setAttribute("style","display: flex; justify-content: space-between; padding: 16px 0;");const F=document.createElement("button");F.innerHTML="cancel",F.setAttribute("style","width: 85px;"),F.onclick=()=>{document.body.removeChild($);const ee=new Error("NotAllowedError");ee.name="NotAllowedError",y(ee)};let B=m;const Y=document.createElement("div");if(m){const ee=document.createElement("input");ee.setAttribute("type","checkbox");const Ee=document.createElement("span");ee.setAttribute("style","margin-right: 6px;"),Ee.innerText="Share audio",ee.checked=B,ee.onchange=()=>{B=ee.checked},Y.appendChild(ee),Y.appendChild(Ee)}P.appendChild(Y),P.appendChild(F),A.appendChild(O),A.appendChild(D),A.appendChild(P);const $=document.createElement("div");$.setAttribute("style","position: fixed; z-index: 99999999; top: 50%; left: 50%; width: 620px; height: 525px; background: #ECECEC; border-radius: 4px; -webkit-transform: translate(-50%,-50%); transform: translate(-50%,-50%);"),$.appendChild(b),$.appendChild(A),document.body.appendChild($),f.map(ee=>{if(ee.id){const Ee=document.createElement("div");Ee.setAttribute("style","width: 30%; height: 160px; padding: 20px 0; text-align: center;box-sizing: content-box;");let Re=ee.thumbnail;try{const{width:Ie}=Re.getSize();Ie>1920&&(Re=Re.resize({width:1920}))}catch(Ie){throw Ie&&Ie.message.startsWith("Illegal invocation")&&console.error("Operate thumbnail error, please try to set contextIsolation: false. (https://github.com/electron/electron/issues/34953)"),Ie}Ee.innerHTML='<div style="height: 120px; display: table-cell; vertical-align: middle;"><img style="width: 100%; background: #333333; box-shadow: 1px 1px 1px 1px rgba(0, 0, 0, 0.2);" src='+Re.toDataURL()+' /></div><span style="	height: 40px; line-height: 40px; display: inline-block; width: 70%; word-break: keep-all; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">'+ee.name.replace(/[\u00A0-\u9999<>\&]/g,function(Ie){return"&#"+Ie.charCodeAt(0)+";"})+"</span>",Ee.onclick=()=>{document.body.removeChild($),E({sourceId:ee.id,audio:B})},D.appendChild(Ee)}})})}(r,t);return await Cl(s,e,l)}async function Vx(e){let t=["window","screen"];e!=="application"&&e!=="window"||(t=["window"]),e==="screen"&&(t=["screen"]);const r=Uc();if(!r)throw console.error("failed to fetch electron, please mount it to window"),new Ke(se.ELECTRON_IS_NULL);let s=null;try{var l;s=((l=r.desktopCapturer)===null||l===void 0?void 0:l.getSources({types:t}))||r.ipcRenderer.invoke("DESKTOP_CAPTURER_GET_SOURCES",{types:t})}catch{s=null}s&&s.then||(s=new gt((f,m)=>{r.desktopCapturer.getSources({types:t},(E,y)=>{E?m(E):f(y)})}));try{return await s}catch(f){throw new Ke(se.ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR,f.toString())}}const Bx=new Gi("safari");let Go=!1,Xi=!1;async function wl(e,t){let r=0,s=null;for(;r<2;)try{s=await S8(e,t,r>0);break}catch(l){if(l instanceof Ke)throw G.error("[".concat(t,"] ").concat(l.toString())),l;const f=fI(l.name||l.code||l,l.message);if(f.code===se.MEDIA_OPTION_INVALID){G.debug("[".concat(t,"] detect media option invalid, retry")),r+=1,await fs(500);continue}throw G.error("[".concat(t,"] ").concat(f.toString())),f}if(!s)throw new Ke(se.UNEXPECTED_ERROR,"can not find stream after getUserMedia");return s}async function S8(e,t,r){if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new Ke(se.NOT_SUPPORTED,"can not find getUserMedia");r&&(e.video&&(delete e.video.width,delete e.video.height),e.screen&&(delete e.screen.width,delete e.screen.height));const s=zn(),l=new MediaStream;if(e.audioSource&&l.addTrack(e.audioSource),e.videoSource&&l.addTrack(e.videoSource),!e.audio&&!e.video&&!e.screen)return G.debug("Using Video Source/ Audio Source"),l;if(e.screen)if(Uc())e.screen.sourceId?AS(l,await Cl(e.screen.sourceId,e.screen,!!e.screenAudio)):AS(l,await v8(e.screen,!!e.screenAudio));else if(Up()&&e.screen.extensionId&&e.screen.mandatory){if(!s.getStreamFromExtension)throw new Ke(se.NOT_SUPPORTED,"This browser does not support screen sharing");G.debug("[".concat(t,'] Screen access on chrome stable, looking for extension"'));const D=await(m=e.screen.extensionId,E=t,new gt((P,F)=>{try{chrome.runtime.sendMessage(m,{getStream:!0},B=>{if(!B||!B.streamId)return G.error("[".concat(E,"] No response from Chrome Plugin. Plugin not installed properly"),B),void F(new Ke(se.CHROME_PLUGIN_NO_RESPONSE,"No response from Chrome Plugin. Plugin not installed properly"));P(B.streamId)})}catch(B){G.error("[".concat(E,"] AgoraRTC screensharing plugin is not accessible(").concat(m,")"),B.toString()),F(new Ke(se.CHROME_PLUGIN_NOT_INSTALL))}}));e.screen.mandatory.chromeMediaSourceId=D,AS(l,await navigator.mediaDevices.getUserMedia({video:{mandatory:e.screen.mandatory}}))}else if(s.getDisplayMedia){var f;e.screen.mediaSource&&OL(e.screen.mediaSource);const D={width:e.screen.width,height:e.screen.height,frameRate:e.screen.frameRate,displaySurface:(f=e.screen.displaySurface)!==null&&f!==void 0?f:e.screen.mediaSource==="screen"?"monitor":e.screen.mediaSource},{selfBrowserSurface:P,surfaceSwitching:F,systemAudio:B,preferCurrentTab:Y}=e.screen,$={selfBrowserSurface:P,surfaceSwitching:F,systemAudio:B,preferCurrentTab:Y};!P&&delete $.selfBrowserSurface,!F&&delete $.surfaceSwitching,!B&&delete $.systemAudio,!Y&&delete $.preferCurrentTab,G.debug("[".concat(t,"] getDisplayMedia:"),JSON.stringify({video:D,audio:e.screenAudio,controls:$})),AS(l,await navigator.mediaDevices.getDisplayMedia(fi({video:D,audio:e.screenAudio},$)))}else{if(!ei())throw G.error("[".concat(t,"] This browser does not support screenSharing")),new Ke(se.NOT_SUPPORTED,"This browser does not support screen sharing");{e.screen.mediaSource&&OL(e.screen.mediaSource);const D={video:{mediaSource:e.screen.mediaSource,width:e.screen.width,height:e.screen.height,frameRate:e.screen.frameRate}};G.debug("[".concat(t,"] getUserMedia: ").concat(JSON.stringify(D))),AS(l,await navigator.mediaDevices.getUserMedia(D))}}var m,E;if(!e.video&&!e.audio)return l;let y={video:e.video,audio:e.audio},b=me("MEDIA_DEVICE_CONSTRAINTS");if(b)try{typeof b=="string"&&(b=JSON.parse(b)),y=Gb(y,b)}catch{}G.debug("[".concat(t,"] GetUserMedia"),JSON.stringify(y)),qn();let A,O=null;(ns()||to()||tI())&&(O=await Bx.lock());try{A=await navigator.mediaDevices.getUserMedia(y)}catch(D){throw O&&O(),D}return y.audio&&(Go=!0),y.video&&(Xi=!0),AS(l,A),O&&O(),l}function fI(e,t){switch(e){case"Starting video failed":case"OverconstrainedError":case"TrackStartError":return new Ke(se.MEDIA_OPTION_INVALID,"".concat(e,": ").concat(t));case"NotFoundError":case"DevicesNotFoundError":return new Ke(se.DEVICE_NOT_FOUND,"".concat(e,": ").concat(t));case"NotSupportedError":return new Ke(se.NOT_SUPPORTED,"".concat(e,": ").concat(t));case"NotReadableError":return new Ke(se.NOT_READABLE,"".concat(e,": ").concat(t));case"InvalidStateError":case"NotAllowedError":case"PERMISSION_DENIED":case"PermissionDeniedError":return new Ke(se.PERMISSION_DENIED,"".concat(e,": ").concat(t));case"ConstraintNotSatisfiedError":return new Ke(se.CONSTRAINT_NOT_SATISFIED,"".concat(e,": ").concat(t));default:return G.error("getUserMedia unexpected error",e),new Ke(se.UNEXPECTED_ERROR,"".concat(e,": ").concat(t))}}function AS(e,t){const r=e.getVideoTracks()[0],s=e.getAudioTracks()[0],l=t.getVideoTracks()[0],f=t.getAudioTracks()[0];f&&(s&&e.removeTrack(s),e.addTrack(f)),l&&(r&&e.removeTrack(r),e.addTrack(l))}const Fc=new class extends Xt{get state(){return this._state}set state(e){e!==this._state&&(this.emit(no.STATE_CHANGE,e),this._state=e)}constructor(){super(),Pe(this,"_state",Qb.IDLE),Pe(this,"isAccessMicrophonePermission",!1),Pe(this,"isAccessCameraPermission",!1),Pe(this,"lastAccessMicrophonePermission",!1),Pe(this,"lastAccessCameraPermission",!1),Pe(this,"checkdeviceMatched",!1),Pe(this,"deviceInfoMap",new Map),this.init().then(()=>{navigator.mediaDevices.addEventListener&&navigator.mediaDevices.addEventListener("devicechange",this.updateDevicesInfo.bind(this)),window.setInterval(()=>{(me("ENUMERATE_DEVICES_INTERVAL")||(Pa()||jb()===mr.HARMONY_OS)&&fh())&&this.updateDevicesInfo()},me("ENUMERATE_DEVICES_INTERVAL_TIME"))}).catch(e=>G.error(e.toString()))}async enumerateDevices(e,t){let r=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(!navigator.mediaDevices||!navigator.mediaDevices.enumerateDevices)return new Ke(se.NOT_SUPPORTED,"enumerateDevices() not supported.").throw();const s=await navigator.mediaDevices.enumerateDevices(),l=this.checkMediaDeviceInfoIsOk(s);let f=!this.isAccessMicrophonePermission&&e,m=!this.isAccessCameraPermission&&t;l.audio&&(f=!1),l.video&&(m=!1);let E=null,y=null,b=null;if(!r&&(f||m)){if(Bx.isLocked&&(G.debug("[device manager] wait GUM lock"),(await Bx.lock())(),G.debug("[device manager] GUM unlock")),Go&&(f=!1,this.isAccessMicrophonePermission=!0),Xi&&(m=!1,this.isAccessCameraPermission=!0),G.debug("[device manager] check media device permissions",e,t,f,m),f&&m){try{b=await navigator.mediaDevices.getUserMedia({audio:!0,video:!0})}catch(A){const O=fI(A.name||A.code||A,A.message);if(O.code===se.PERMISSION_DENIED)throw O;G.warning("getUserMedia failed in getDevices",O)}this.isAccessCameraPermission=!0,this.isAccessMicrophonePermission=!0}else if(f){try{E=await navigator.mediaDevices.getUserMedia({audio:e})}catch(A){const O=fI(A.name||A.code||A,A.message);if(O.code===se.PERMISSION_DENIED)throw O;G.warning("getUserMedia failed in getDevices",O)}this.isAccessMicrophonePermission=!0}else if(m){try{y=await navigator.mediaDevices.getUserMedia({video:t})}catch(A){const O=fI(A.name||A.code||A,A.message);if(O.code===se.PERMISSION_DENIED)throw O;G.warning("getUserMedia failed in getDevices",O)}this.isAccessCameraPermission=!0}G.debug("[device manager] mic permission",e,"cam permission",t)}try{const A=await navigator.mediaDevices.enumerateDevices();return E&&E.getTracks().forEach(O=>O.stop()),y&&y.getTracks().forEach(O=>O.stop()),b&&b.getTracks().forEach(O=>O.stop()),E=null,y=null,b=null,A}catch(A){return E&&E.getTracks().forEach(O=>O.stop()),y&&y.getTracks().forEach(O=>O.stop()),b&&b.getTracks().forEach(O=>O.stop()),E=null,y=null,b=null,new Ke(se.ENUMERATE_DEVICES_FAILED,A.toString()).throw()}}async getRecordingDevices(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return(await this.enumerateDevices(!0,!1,e)).filter(t=>t.kind==="audioinput")}async getCamerasDevices(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return(await this.enumerateDevices(!1,!0,e)).filter(t=>t.kind==="videoinput")}async getSpeakers(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return(await this.enumerateDevices(!0,!1,e)).filter(t=>t.kind==="audiooutput")}searchDeviceIdByName(e){let t=null;return this.deviceInfoMap.forEach(r=>{r.device.label===e&&(t=r.device.deviceId)}),t}async getDeviceById(e){const t=(await this.enumerateDevices(!0,!0,!0)).find(r=>r.deviceId===e);if(!t)throw new Ke(se.DEVICE_NOT_FOUND,"deviceId: ".concat(e));return t}async init(){this.state=Qb.INITING;try{await this.updateDevicesInfo(),this.state=Qb.INITEND}catch(e){throw G.warning("Device Detection functionality cannot start properly.",e.toString()),this.state=Qb.IDLE,(typeof isSecureContext=="boolean"?isSecureContext:location.protocol==="https:"||location.protocol==="file:"||location.hostname==="localhost"||location.hostname==="127.0.0.1"||location.hostname==="::1")||new Ke(se.WEB_SECURITY_RESTRICT,"Your context is limited by web security, please try using https protocol or localhost.").throw(),e}}async updateDevicesInfo(){const e=await this.enumerateDevices(!0,!0,!0),t=Date.now(),r=[];if(e[0]&&e[0].label&&this.checkdeviceMatched===!1){this.checkdeviceMatched=!0;const l=e.find(m=>m.kind==="audioinput"&&m.deviceId==="default"),f=e.find(m=>m.kind==="audiooutput"&&m.deviceId==="default");l&&f?f.groupId===l.groupId?G.debug("[device-check] default input ".concat(l.label," and output ").concat(f.label," is the same group")):G.debug("[device-check] default input ".concat(l.label," and output ").concat(f.label," is not the same group")):G.debug("[device-check] default input or output not found")}const s=this.checkMediaDeviceInfoIsOk(e);if(e.forEach(l=>{if(!l.deviceId)return;const f=this.deviceInfoMap.get("".concat(l.kind,"_").concat(l.deviceId));if((f?f.state:"INACTIVE")!=="ACTIVE"){const m={initAt:t,updateAt:t,device:l,state:"ACTIVE"};this.deviceInfoMap.set("".concat(l.kind,"_").concat(l.deviceId),m),r.push(m)}f&&(f.updateAt=t)}),this.deviceInfoMap.forEach((l,f)=>{l.state==="ACTIVE"&&l.updateAt!==t&&(l.state="INACTIVE",r.push(l))}),this.state!==Qb.INITEND)return s.audio&&(this.lastAccessMicrophonePermission=!0,this.isAccessMicrophonePermission=!0),void(s.video&&(this.lastAccessCameraPermission=!0,this.isAccessCameraPermission=!0));r.forEach(l=>{switch(l.device.kind){case"audioinput":this.lastAccessMicrophonePermission&&this.isAccessMicrophonePermission&&this.emit(no.RECORDING_DEVICE_CHANGED,l);break;case"videoinput":this.lastAccessCameraPermission&&this.isAccessCameraPermission&&this.emit(no.CAMERA_DEVICE_CHANGED,l);break;case"audiooutput":this.lastAccessMicrophonePermission&&this.isAccessMicrophonePermission&&this.emit(no.PLAYOUT_DEVICE_CHANGED,l)}}),s.audio&&(this.lastAccessMicrophonePermission=!0,this.isAccessMicrophonePermission=!0),s.video&&(this.lastAccessCameraPermission=!0,this.isAccessCameraPermission=!0)}checkMediaDeviceInfoIsOk(e){const t=e.filter(l=>l.kind==="audioinput"),r=e.filter(l=>l.kind==="videoinput"),s={audio:!1,video:!1};for(const l of t)if(l.label&&l.deviceId){s.audio=!0;break}for(const l of r)if(l.label&&l.deviceId){s.video=!0;break}return s}};let Fx=!1;const Rl=new class extends Xt{constructor(){super(...arguments),Pe(this,"onAutoplayFailed",void 0),Pe(this,"onAudioAutoplayFailed",void 0)}};function hI(){if(qn(),!Fx){const e=t=>{t.preventDefault(),Fx=!1,Xd()?document.body.removeEventListener("click",e,!0):(document.body.removeEventListener("touchstart",e,!0),document.body.removeEventListener("mousedown",e,!0))};Fx=!0,Xd()?document.body.addEventListener("click",e,!0):(document.body.addEventListener("touchstart",e,!0),document.body.addEventListener("mousedown",e,!0)),G.info("detect media autoplay failed, document: https://docs.agora.io/cn/Voice/autoplay_policy_web_ng?platform=Web"),Rl.onAutoplayFailed?Rl.onAutoplayFailed():Rl.onAudioAutoplayFailed?G.warning(`AgoraRTC.onAudioAutoplayFailed has been deprecated in favor of AgoraRTC.onAutoplayFailed.

  Please refer to the Agora document to migrate the newer API, https://docs.agora.io/en/Voice/autoplay_policy_web_ng?platform=Web .`):G.warning(`We have detected a media autoplay failed event, and found out that you haven't implemented AgoraRTC.onAutoplayFailed callback yet.

  It will cause audio/video element not playing automatically on some browsers without user interaction, possibly hurting user experiences.

  Please refer to the Agora document to properly handle autoplay failed event, https://docs.agora.io/en/Voice/autoplay_policy_web_ng?platform=Web .`),Rl.emit("autoplay-failed")}}function Gx(e,t,r,s){if(!e)return;const l=Vt.getBaseInfoBySessionId(e);if(!l)return;const f=l.info,m=Date.now(),E=fi(fi({},f),{},{vid:f.vid===void 0?0:Number(f.vid),lts:m,elapse:m-l.startTime,cbRegistered:Rl.onAutoplayFailed||Rl.onAudioAutoplayFailed?1:-1,errorMsg:r,mediaType:t,trackId:s,extend:void 0});Vt.send({type:_r.AUTOPLAY_FAILED,data:E},!0)}const y8=["play","playing","loadeddata","canplay","pause","stalled","suspend","waiting","abort","emptied","ended","error"],dc=new class{constructor(){Pe(this,"onAutoplayFailed",void 0),Pe(this,"elementMap",new Map),Pe(this,"elementStateMap",new Map),Pe(this,"elementsNeedToResume",[]),Pe(this,"sinkIdMap",new Map),Pe(this,"autoResumeAfterInterruption",e=>{Array.from(this.elementMap.entries()).forEach(t=>{let[r,s]=t;const l=this.elementStateMap.get(r),f=s.srcObject.getAudioTracks()[0],m=f&&f.readyState;if(G.debug("resume after interrupted, ele: ".concat(l," audio: ").concat(m," ").concat(e)),m==="live"){if(e)return s.pause(),void s.play();if(Rr.curState==="running")return Ct()?(s.pause(),void s.play()):void(l&&l==="paused"&&s.play())}})}),Pe(this,"autoResumeAfterInterruptionOnIOS15_16",()=>{Array.from(this.elementMap.entries()).forEach(e=>{let[t,r]=e;const s=r.srcObject.getAudioTracks()[0];s&&s.readyState==="live"&&(G.debug("auto resume after interruption inside autoResumeAfterInterruptionOnIOS15"),r.pause(),r.play())})}),this.autoResumeAudioElement(),Rr.on(xa.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),Rr.on(xa.IOS_15_16_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15_16),Rr.on(xa.STATE_CHANGE,()=>{to()&&Rr.prevState==="suspended"&&Rr.curState==="running"&&this.autoResumeAfterInterruption()})}async setSinkID(e,t){const r=this.elementMap.get(e);if(this.sinkIdMap.set(e,t),r)try{await r.setSinkId(t)}catch(s){throw new Ke(se.PERMISSION_DENIED,"can not set sink id: "+s.toString())}}play(e,t,r,s){if(this.elementMap.has(t))return;const l=document.createElement("audio");l.autoplay=!0,l.srcObject=new MediaStream([e]),this.bindAudioElementEvents(t,l),this.elementMap.set(t,l),this.elementStateMap.set(t,Tn.INIT),this.setVolume(t,r);const f=this.sinkIdMap.get(t);if(f)try{l.setSinkId(f).catch(E=>{G.warning("[".concat(t,"] set sink id failed"),E.toString())})}catch(E){G.warning("[".concat(t,"] set sink id failed"),E.toString())}const m=l.play();m&&m.then&&m.catch(E=>{s&&Gx(s,"audio",E.message,t),G.warning("audio element play warning",E.toString()),this.elementMap.has(t)&&E.name==="NotAllowedError"&&(G.warning("detected audio element autoplay failed"),this.elementsNeedToResume.push(l),gL(()=>{this.onAutoplayFailed&&this.onAutoplayFailed(),hI()}))})}updateTrack(e,t){const r=this.elementMap.get(e);r&&(r.srcObject=new MediaStream([t]))}isPlaying(e){return this.elementMap.has(e)&&this.elementStateMap.get(e)==="playing"}setVolume(e,t){const r=this.elementMap.get(e);r&&(t=Math.max(0,Math.min(100,t)),r.volume=t/100)}stop(e){const t=this.elementMap.get(e);if(this.sinkIdMap.delete(e),!t)return;const r=this.elementsNeedToResume.indexOf(t);this.elementsNeedToResume.splice(r,1),t.srcObject=null,t.remove(),this.elementMap.delete(e),this.elementStateMap.delete(e)}bindAudioElementEvents(e,t){y8.forEach(r=>{t.addEventListener(r,s=>{const l=this.elementStateMap.get(e),f=s.type==="pause"?"paused":s.type;if(G.debug("[".concat(e,"] audio-element-status change ").concat(l," => ").concat(f)),s.type==="error"){const m=t==null?void 0:t.error;m&&G.error("[".concat(e,"] media error, code: ").concat(m.code,", message: ").concat(m.message))}this.elementStateMap.set(e,f)})})}getPlayerState(e){return this.elementStateMap.get(e)||"uninit"}autoResumeAudioElement(){const e=()=>{this.elementsNeedToResume.forEach(t=>{t.play().then(r=>{G.debug("Auto resume audio element success")}).catch(r=>{G.warning("Auto resume audio element failed!",r)})}),this.elementsNeedToResume=[]};new gt(t=>{document.body?t():window.addEventListener("load",()=>t())}).then(()=>{Xd()?document.body.addEventListener("click",e,!0):(document.body.addEventListener("touchstart",e,!0),document.body.addEventListener("mousedown",e,!0))})}};function Hi(){return function(e,t,r){const s=r.value;return typeof s=="function"&&(r.value=function(){this._isClosed&&new Ke(se.INVALID_OPERATION,"[".concat(this.getTrackId(),"] cannot operate a closed track")).print("warning",G);for(var l=arguments.length,f=new Array(l),m=0;m<l;m++)f[m]=arguments[m];const E=s.apply(this,f);return E instanceof gt?new gt((y,b)=>{E.then(y).catch(b)}):E}),r}}class DL extends Xt{constructor(t){super(),Pe(this,"name","VideoProcessorDestination"),Pe(this,"ID","0"),Pe(this,"_source",void 0),Pe(this,"videoContext",void 0),Pe(this,"inputTrack",void 0),this.videoContext=t}get kind(){return"video"}get enabled(){return!0}pipe(){throw new Ke(se.NOT_SUPPORTED,"VideoProcessor cannot pipe to any other Processor")}unpipe(){throw new Ke(se.NOT_SUPPORTED,"VideoProcessor cannot unpipe to any other Processor")}enable(){}disable(){}updateInput(t){if(t.context!==this.videoContext)throw new Error(`ProcessorContext passed to VideoTrack.processorDestination doesn't match it's belonging VideoTrack's context.
Probably you are making pipeline like this:
videoTrack1.pipe(processor).pipe(videoTrack2.processorDestination).`);t.track&&t.track!==this.inputTrack&&(this.videoContext.chained=!0,this.inputTrack=t.track,this.emit(So.ON_TRACK,t.track))}reset(){this.inputTrack=void 0,this.videoContext.chained=!1,this.emit(So.ON_TRACK,void 0)}}class zx extends Xt{set chained(t){this._chained=t}get chained(){return this._chained}constructor(t,r){super(),Pe(this,"constraintsMap",new Map),Pe(this,"statsRegistry",[]),Pe(this,"usageRegistry",[]),Pe(this,"trackId",void 0),Pe(this,"direction",void 0),Pe(this,"_chained",!1),this.trackId=t,this.direction=r}async getConstraints(){return await la(this,yo.REQUEST_CONSTRAINTS)}async requestApplyConstraints(t,r){var s;return G.info("processor ".concat(r.name," requestApplyConstraints for ").concat(this.trackId)),t&&this.constraintsMap.set(r,t),fr(this,yo.REQUEST_UPDATE_CONSTRAINTS,Array.from(oc(s=this.constraintsMap).call(s)))}async requestRevertConstraints(t){var r;if(this.constraintsMap.has(t))return G.info("processor ".concat(t.name," requestRevertConstraints for ").concat(this.trackId)),this.constraintsMap.delete(t),fr(this,yo.REQUEST_UPDATE_CONSTRAINTS,Array.from(oc(r=this.constraintsMap).call(r)))}registerStats(t,r,s){this.statsRegistry.find(l=>l.processorID===t.ID&&l.processorName===t.name&&l.type===r)||this.statsRegistry.push({processorName:t.name,processorID:t.ID,type:r,cb:s})}unregisterStats(t,r){const s=this.statsRegistry.findIndex(l=>l.processorID===t.ID&&l.processorName===t.name&&l.type===r);s!==-1&&this.statsRegistry.splice(s,1)}gatherStats(){const t=[];for(const{processorID:r,processorName:s,type:l,cb:f}of this.statsRegistry)try{const m=f();t.push({processorID:r,processorName:s,type:l,stats:m})}catch(m){G.error(new Ke(se.UNEXPECTED_ERROR,m.message))}return t}registerUsage(t,r){this.usageRegistry.find(s=>s.processorID===t.ID&&s.processorName===t.name)||this.usageRegistry.push({processorID:t.ID,processorName:t.name,cb:r})}unregisterUsage(t){const r=this.usageRegistry.findIndex(s=>s.processorID===t.ID&&s.processorName===t.name);r!==-1&&this.usageRegistry.splice(r,1)}async gatherUsage(){const t=[];if(!this.chained)return[];for(const{cb:r}of this.usageRegistry)try{let s=r();s instanceof gt&&(s=await s),t.push(fi(fi({},s),{},{direction:this.direction}))}catch(s){G.error("gather extension usage error",s)}return t}getDirection(){return this.direction}}class Hx extends Xt{constructor(t){super(),Pe(this,"name","AudioProcessorDestination"),Pe(this,"ID","0"),Pe(this,"inputTrack",void 0),Pe(this,"inputNode",void 0),Pe(this,"audioProcessorContext",void 0),Pe(this,"_source",void 0),this.audioProcessorContext=t}get kind(){return"audio"}get enabled(){return!0}pipe(){throw new Ke(se.NOT_SUPPORTED,"AudioProcessorDestination cannot pipe to any other Processor")}unpipe(){throw new Ke(se.NOT_SUPPORTED,"AudioProcessor cannot unpipe to any other Processor")}enable(){}disable(){}reset(){this.inputTrack=void 0,this.inputNode=void 0,this.audioProcessorContext.chained=!1,this.emit(So.ON_TRACK,void 0),this.emit(So.ON_NODE,void 0)}updateInput(t){if(t.context!==this.audioProcessorContext)throw new Error(`ProcessorContext passed to AudioTrack.processorDestination doesn't match it's belonging AudioTrack's context.
        Probably you are making pipeline like this: audioTrack1.pipe(processor).pipe(audioTrack2.processorDestination).`);t.track&&this.inputTrack!==t.track&&(this.audioProcessorContext.chained=!0,this.inputTrack=t.track,this.emit(So.ON_TRACK,this.inputTrack)),t.node&&this.inputNode!==t.node&&(this.audioProcessorContext.chained=!0,this.inputNode=t.node,this.emit(So.ON_NODE,this.inputNode))}}class Wx extends Xt{set chained(t){this._chained=t}get chained(){return this._chained}constructor(t,r,s){super(),Pe(this,"constraintsMap",new Map),Pe(this,"statsRegistry",[]),Pe(this,"audioContext",void 0),Pe(this,"trackId",void 0),Pe(this,"direction",void 0),Pe(this,"usageRegistry",[]),Pe(this,"_chained",!1),this.audioContext=t,this.trackId=r,this.direction=s}async getConstraints(){return la(this,yo.REQUEST_CONSTRAINTS)}getAudioContext(){return this.audioContext}async requestApplyConstraints(t,r){var s;return G.info("processor ".concat(r.name," requestApplyConstraints for ").concat(this.trackId)),t&&this.constraintsMap.set(r,t),fr(this,yo.REQUEST_UPDATE_CONSTRAINTS,Array.from(oc(s=this.constraintsMap).call(s)))}async requestRevertConstraints(t){var r;if(this.constraintsMap.has(t))return this.constraintsMap.delete(t),fr(this,yo.REQUEST_UPDATE_CONSTRAINTS,Array.from(oc(r=this.constraintsMap).call(r)))}registerStats(t,r,s){this.statsRegistry.find(l=>l.processorID===t.ID&&l.processorName===t.name&&l.type===r)||this.statsRegistry.push({processorName:t.name,processorID:t.ID,type:r,cb:s})}unregisterStats(t,r){const s=this.statsRegistry.findIndex(l=>l.processorID===t.ID&&l.processorName===t.name&&l.type===r);s!==-1&&this.statsRegistry.splice(s,1)}gatherStats(){const t=[];for(const{processorID:r,processorName:s,type:l,cb:f}of this.statsRegistry)try{const m=f();t.push({processorID:r,processorName:s,type:l,stats:m})}catch(m){G.error(new Ke(se.UNEXPECTED_ERROR,m.message))}return t}registerUsage(t,r){this.usageRegistry.find(s=>s.processorID===t.ID&&s.processorName===t.name)||this.usageRegistry.push({processorID:t.ID,processorName:t.name,cb:r})}unregisterUsage(t){const r=this.usageRegistry.findIndex(s=>s.processorID===t.ID&&s.processorName===t.name);r!==-1&&this.usageRegistry.splice(r,1)}async gatherUsage(){const t=[];if(!this.chained)return[];for(const{cb:r}of this.usageRegistry)try{let s=r();s instanceof gt&&(s=await s),t.push(fi(fi({},s),{},{direction:this.direction}))}catch(s){G.error("gather extension usage error",s)}return t}getDirection(){return this.direction}}class PL extends Xt{get isPlayed(){return!0}get isFreeze(){return!1}constructor(){super(),Pe(this,"context",void 0),Pe(this,"processSourceNode",void 0),Pe(this,"outputTrack",void 0),Pe(this,"processedNode",void 0),Pe(this,"clonedTrack",void 0),Pe(this,"outputNode",void 0),this.outputNode=new T8}setVolume(){}createOutputTrack(){throw new Ke(se.NOT_SUPPORTED,"can not create output MediaStreamTrack when WebAudio disabled")}getOriginVolumeLevel(){return 0}getAccurateVolumeLevel(){return 0}stopGetAudioBuffer(){}startGetAudioBuffer(){}play(){}stop(){}destroy(){}updateTrack(){}updateOriginTrack(){}createMediaStreamSourceNode(){}}class T8{disconnect(){}connect(){}}function Yx(e){return new gt((t,r)=>{let s=!1;const l=document.createElement("video");l.setAttribute("autoplay",""),l.setAttribute("muted",""),l.muted=!0,l.autoplay=!0,l.setAttribute("playsinline",""),l.setAttribute("style","position: fixed; top: 0; left: 0; width: 1px; height: 1px"),document.body.appendChild(l);const f=to()?"canplay":"playing";l.addEventListener(f,()=>{const m=l.videoWidth,E=l.videoHeight;!m&&ei()||(s=!0,l.srcObject=null,l.remove(),t([m,E]))}),l.srcObject=new MediaStream([e]),l.play().catch(Dg),setTimeout(()=>{s||(l.srcObject=null,l.remove(),t([l.videoWidth,l.videoHeight]))},4e3)})}function pI(e){const t={};e.facingMode&&(t.facingMode=e.facingMode),e.cameraId&&(t.deviceId={exact:e.cameraId});const r=Bo(e.encoderConfig);return r.width!=null&&(t.width=r.width),r.height!=null&&(t.height=r.height),!Ia()&&r.frameRate&&(t.frameRate=r.frameRate),Ex()&&typeof t.frameRate=="object"&&(t.frameRate.max=60),ei()&&(t.frameRate={ideal:30,max:30}),t}function Kx(e){const t={};return Ia()||(e.AGC!==void 0&&(t.autoGainControl=e.AGC),e.AEC!==void 0&&(t.echoCancellation=e.AEC),e.ANS!==void 0&&(t.noiseSuppression=e.ANS,Up()&&e.ANS&&(t.googHighpassFilter=e.ANS))),t}function qx(e){const t=Kx(e);if(e.encoderConfig){const r=lc(e.encoderConfig);t.channelCount=r.stereo?2:1,t.sampleRate=r.sampleRate,t.sampleSize=r.sampleSize}return e.microphoneId&&(t.deviceId={exact:e.microphoneId}),Pa()&&(t.sampleRate=void 0),t}const b8=e=>{const t=e._encoderConfig;if(!t)return;const{frameRate:r,width:s,height:l}=e.getMediaStreamTrackSettings();let{frameRate:f=r,width:m=s,height:E=l}=t;if(!f||!m||!E)return;m=zb(m),E=zb(E),f=zb(f);const{max:y,min:b}=function(P,F,B){const Y=200*Math.pow(B/15,.6)*Math.pow(P*F/640/360,.75);return{min:Math.floor(Y),max:Math.floor(4*Y)}}(m,E,f),{bitrateMax:A,bitrateMin:O}=t||{};A||G.debug("calculate bitrate: [w: ".concat(m,", h: ").concat(E,", fps: ").concat(f,"] => [brMax: ").concat(A,", brMin: ").concat(O,"]"));const{maxFramerate:D}=me("ENCODER_CONFIG_LIMIT");return D&&typeof D=="number"&&(f=Math.min(f,D)),{frameRate:f,bitrateMax:A||y,bitrateMin:O||b,scaleResolutionDownBy:1,scale:0}},Jx=async(e,t,r)=>await(async(s,l,f)=>{const m=function(b){const A=[];for(let O=0;O<b.length;O+=2)A.push(parseInt(b.slice(O,O+2),16));return Uint8Array.from(A)}(SL(""+l+f)).slice(0,16),E=m.slice(0,12),y=await window.crypto.subtle.importKey("raw",m,"AES-GCM",!0,["encrypt"]);return new Uint8Array(await window.crypto.subtle.encrypt({name:"AES-GCM",iv:E},y,s))})(e.buffer,t,r),ML=e=>{const t=document.createElement("canvas");return t.width=2,t.height=2,new gt((r,s)=>{t.toBlob(async l=>{if(t.remove(),l){const f=await Xx(l);r({buffer:f,width:t.width,height:t.height})}else s(new Ke(se.CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED))},e,1)})},Xx=async e=>{const t=await e.arrayBuffer();return new Uint8Array(t)};var Qx,Zx,$x,e3,t3,n3,yi,r3,i3,a3,s3,o3,c3,vh,l3,d3,u3,f3,Ti,h3,p3,m3,g3,_3,E3,Sh,v3,gs,Ui,mI,C8,va,w8,S3,kL,y3,T3,b3,C3,_s;let ji=(Qx=nn({argsMap:(e,t)=>[e.getTrackId(),t],throttleTime:300}),Zx=nn({argsMap:(e,t)=>[e.getTrackId(),t]}),$x=Hi(),e3=TS("LocalAudioTrack","_enabledMutex"),t3=nn({argsMap:(e,t)=>[e.getTrackId(),t]}),n3=Hi(),yi=TS("LocalAudioTrack","_enabledMutex"),r3=nn({argsMap:(e,t)=>[e.getTrackId(),t]}),i3=Hi(),a3=Hi(),s3=Hi(),o3=nn({argsMap:e=>[e.getTrackId()]}),c3=Hi(),vh=nn({argsMap:e=>[e.getTrackId()]}),l3=Hi(),d3=nn({argsMap:e=>[e.getTrackId()]}),u3=nn({argsMap:(e,t)=>[e.getTrackId(),t.name]}),f3=nn({argsMap:e=>[e.getTrackId()]}),jn((Ti=class extends $b{get _source(){return this.initWebAudio()}set _source(e){this._trackSource=e}get processorContext(){return this._processorContext||(this._processorContext=this.initProcessor().processorContext),this._processorContext}get processorDestination(){return this._processorDestination||(this._processorDestination=this.initProcessor().processorDestination),this._processorDestination}get isPlaying(){return this._useAudioElement?dc.isPlaying(this.getTrackId()):this._source.isPlayed}get __className__(){return"LocalAudioTrack"}constructor(e,t,r,s){super(e,r),Pe(this,"trackMediaType",yl.AUDIO),Pe(this,"_encoderConfig",void 0),Pe(this,"_trackSource",void 0),Pe(this,"metadata",[]),Pe(this,"_enabled",!0),Pe(this,"_volume",100),Pe(this,"_useAudioElement",!0),Pe(this,"_bypassWebAudio",!1),Pe(this,"processor",void 0),Pe(this,"_processorContext",void 0),Pe(this,"_processorDestination",void 0),Pe(this,"_getOriginVolumeLevel",void 0),this._encoderConfig=t,this._getOriginVolumeLevel=!!s,this._trackSource=new PL,me("DISABLE_WEBAUDIO")&&(this._bypassWebAudio=!0),me("LOCAL_AUDIO_TRACK_USES_WEB_AUDIO")&&(this._useAudioElement=!1),ns()&&!Bc?setTimeout(()=>this.initWebAudio()):this.initWebAudio()}setVolume(e){wr(e,"volume",0,1e3),this._volume=e,this._source.setVolume(e/100),this._useAudioElement&&dc.setVolume(this.getTrackId(),e);try{if(this._bypassWebAudio)return void G.debug("[".concat(this.getTrackId(),"] setVolume returned because no pass through WebAudio."));const t=this._source.createOutputTrack();this._mediaStreamTrack!==t&&(this._mediaStreamTrack=t,fr(this,Dt.NEED_REPLACE_TRACK,this).then(()=>{G.debug("[".concat(this.getTrackId(),"] replace web audio track success"))}).catch(r=>{G.warning("[".concat(this.getTrackId(),"] replace web audio track failed"),r)}))}catch{}}getVolumeLevel(){return this._muted&&this.enabled&&this._getOriginVolumeLevel?this._source.getOriginVolumeLevel():this._source.getAccurateVolumeLevel()}async setPlaybackDevice(e){if(!this._useAudioElement||!uI())throw new Ke(se.NOT_SUPPORTED,"your browser does not support setting the audio output device");await dc.setSinkID(this.getTrackId(),e)}async setEnabled(e,t,r){return this._setEnabled(e,t,r)}async _setEnabled(e,t,r){if(!r){if(e===this._enabled)return;this.stateCheck("enabled",e)}if(G.info("[".concat(this.getTrackId(),"] start setEnabled"),e),e){this._originMediaStreamTrack.enabled=!0;try{r||(this._enabled=!0),await fr(this,Dt.NEED_ENABLE_TRACK,this),G.info("[".concat(this.getTrackId(),"] setEnabled to ").concat(e," success"))}catch(s){throw r||(this._enabled=!1),G.error("[".concat(this.getTrackId(),"] setEnabled to true error"),s.toString()),s}}else{this._originMediaStreamTrack.enabled=!1,r||(this._enabled=!1);try{await fr(this,Dt.NEED_DISABLE_TRACK,this)}catch(s){throw r||(this._enabled=!0),G.error("[".concat(this.getTrackId(),"] setEnabled to false error"),s.toString()),s}}}async setMuted(e){e!==this._muted&&(this.stateCheck("muted",e),this._muted=e,this._originMediaStreamTrack.enabled=!e,G.debug("[".concat(this.getTrackId(),"] start set muted: ").concat(e)),e?await fr(this,Dt.NEED_MUTE_TRACK,this):await fr(this,Dt.NEED_UNMUTE_TRACK,this))}getStats(){return ph(()=>{G.warning("[deprecated] LocalAudioTrack.getStats will be removed in the future, use AgoraRTCClient.getLocalAudioStats instead")},"localAudioTrackGetStatsWarning"),Gs(this,Dt.GET_STATS)||fi({},Xb)}setAudioFrameCallback(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4096;if(!e)return this._source.removeAllListeners(Vc.ON_AUDIO_BUFFER),void this._source.stopGetAudioBuffer();this._source.startGetAudioBuffer(t),this._source.removeAllListeners(Vc.ON_AUDIO_BUFFER),this._source.on(Vc.ON_AUDIO_BUFFER,r=>e(r))}play(){G.debug("[".concat(this.getTrackId(),"] start audio playback")),this._useAudioElement?(G.debug("[".concat(this.getTrackId(),"] start audio playback in element")),dc.play(this._mediaStreamTrack,this.getTrackId(),this._volume)):this._source.play()}stop(){G.debug("[".concat(this.getTrackId(),"] stop audio playback")),this._useAudioElement?dc.stop(this.getTrackId()):this._source.stop()}close(){super.close(),this._processorDestination&&this.unbindProcessorDestinationEvents(this._processorDestination),this._processorContext&&this.unbindProcessorContextEvents(this._processorContext),this.unpipe(),this._processorDestination&&this._processorDestination._source&&this._processorDestination._source.unpipe(),this._source.destroy()}_updatePlayerSource(){let e=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];G.debug("[".concat(this.getTrackId(),"] update player source track")),e&&this._source.updateTrack(this._mediaStreamTrack),this._useAudioElement&&dc.updateTrack(this.getTrackId(),this._mediaStreamTrack)}async _updateOriginMediaStreamTrack(e,t){this._originMediaStreamTrack!==e&&(this._originMediaStreamTrack&&(this._originMediaStreamTrack.removeEventListener("ended",this._handleTrackEnded),t&&this._originMediaStreamTrack.stop()),e.addEventListener("ended",this._handleTrackEnded),this._originMediaStreamTrack=e,this._muted&&(this._originMediaStreamTrack.enabled=!1),this.processor&&this._processorContext&&this.processor.updateInput({track:e,context:this._processorContext}),this._mediaStreamTrack!==this._source.outputTrack?(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await fr(this,Dt.NEED_REPLACE_TRACK,this)):this._source.updateTrack(this._originMediaStreamTrack),this._getOriginVolumeLevel&&this._source.updateOriginTrack(e))}renewMediaStreamTrack(e){return gt.resolve(void 0)}pipe(e){if(this._bypassWebAudio)throw new Ke(se.INVALID_OPERATION,"Can not process AudioTrack when bypassWebAudio set to true.");if(this.processor===e)return e;if(e._source)throw new Ke(se.INVALID_OPERATION,"Processor ".concat(e.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=e,this.processor._source=this,e.updateInput({track:this._originMediaStreamTrack,node:this._source.processSourceNode,context:this.processorContext}),e}unpipe(){var e;if(!this.processor)return;const t=this.processor;(e=this._source.processSourceNode)===null||e===void 0||e.disconnect(),this.processor._source=!1,this.processor=void 0,t.reset()}bindProcessorDestinationEvents(e){e.on(So.ON_TRACK,async t=>{t?t!==this._mediaStreamTrack&&(this._mediaStreamTrack=t,this._updatePlayerSource(!1),this._source.processedNode=this._source.createMediaStreamSourceNode(t),await fr(this,Dt.NEED_REPLACE_TRACK,this)):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await fr(this,Dt.NEED_REPLACE_TRACK,this))}),e.on(So.ON_NODE,t=>{this._source.processedNode=t})}unbindProcessorDestinationEvents(e){e.removeAllListeners(So.ON_TRACK),e.removeAllListeners(So.ON_NODE)}bindProcessorContextEvents(e){e.on(yo.REQUEST_CONSTRAINTS,async t=>{t(this._originMediaStreamTrack.getSettings())})}unbindProcessorContextEvents(e){e.removeAllListeners(yo.REQUEST_CONSTRAINTS)}initWebAudio(){return this._trackSource instanceof PL&&(this._trackSource=new LL(this._mediaStreamTrack,!1,this._getOriginVolumeLevel?this._mediaStreamTrack:void 0)),this._trackSource}initProcessor(){const e=new Wx(this._source.context,this.getTrackId(),"local"),t=new Hx(e);return this._processorContext=e,this._processorDestination=t,this.bindProcessorContextEvents(e),this.bindProcessorDestinationEvents(t),this._source.on(Vc.UPDATE_SOURCE,()=>{this.processor&&this.processor.updateInput({node:this._source.processSourceNode,context:e})}),this._useAudioElement&&(this._useAudioElement=!1,this.isPlaying&&(dc.stop(this.getTrackId()),this._source.play()),fr(this,Dt.NEED_REPLACE_MIXING_TRACK,this).then(()=>{G.debug("[".concat(this.getTrackId(),"] replace from origin track to web audio track success"))}).catch(r=>{G.warning("[".concat(this.getTrackId(),"] replace from origin track to web audio track failed"),r)})),{processorContext:e,processorDestination:t}}}).prototype,"setVolume",[Qx],Object.getOwnPropertyDescriptor(Ti.prototype,"setVolume"),Ti.prototype),jn(Ti.prototype,"setPlaybackDevice",[Zx,$x],Object.getOwnPropertyDescriptor(Ti.prototype,"setPlaybackDevice"),Ti.prototype),jn(Ti.prototype,"setEnabled",[e3,t3,n3],Object.getOwnPropertyDescriptor(Ti.prototype,"setEnabled"),Ti.prototype),jn(Ti.prototype,"setMuted",[yi,r3,i3],Object.getOwnPropertyDescriptor(Ti.prototype,"setMuted"),Ti.prototype),jn(Ti.prototype,"getStats",[a3],Object.getOwnPropertyDescriptor(Ti.prototype,"getStats"),Ti.prototype),jn(Ti.prototype,"setAudioFrameCallback",[s3],Object.getOwnPropertyDescriptor(Ti.prototype,"setAudioFrameCallback"),Ti.prototype),jn(Ti.prototype,"play",[o3,c3],Object.getOwnPropertyDescriptor(Ti.prototype,"play"),Ti.prototype),jn(Ti.prototype,"stop",[vh,l3],Object.getOwnPropertyDescriptor(Ti.prototype,"stop"),Ti.prototype),jn(Ti.prototype,"close",[d3],Object.getOwnPropertyDescriptor(Ti.prototype,"close"),Ti.prototype),jn(Ti.prototype,"pipe",[u3],Object.getOwnPropertyDescriptor(Ti.prototype,"pipe"),Ti.prototype),jn(Ti.prototype,"unpipe",[f3],Object.getOwnPropertyDescriptor(Ti.prototype,"unpipe"),Ti.prototype),Ti),t1=(h3=nn({argsMap:(e,t)=>[e.getTrackId(),t]}),p3=Hi(),m3=TS("MicrophoneAudioTrack","_enabledMutex"),g3=nn({argsMap:(e,t,r)=>[e.getTrackId(),t,r]}),_3=Hi(),E3=nn({argsMap:e=>[e.getTrackId()]}),jn((Sh=class extends ji{get __className__(){return"MicrophoneAudioTrack"}constructor(e,t,r,s){super(e,t.encoderConfig?lc(t.encoderConfig):{},s,me("GET_VOLUME_OF_MUTED_AUDIO_TRACK")),Pe(this,"_config",void 0),Pe(this,"_deviceName","default"),Pe(this,"_constraints",void 0),Pe(this,"_originalConstraints",void 0),Pe(this,"_enabled",!0),this._config=t,this._constraints=r,this._originalConstraints=r,this._deviceName=e.label,typeof t.bypassWebAudio=="boolean"&&(this._bypassWebAudio=t.bypassWebAudio),(Ct()||un())&&Rr.bindInterruptDetectorTrack(this)}async setDevice(e){if(G.info("[".concat(this.getTrackId(),"] start set device to ").concat(e)),this._enabled)try{const t=await Fc.getDeviceById(e),r={};r.audio=fi({},this._constraints),r.audio.deviceId={exact:e},this._originMediaStreamTrack.stop();let s=null;try{s=await wl(r,this.getTrackId())}catch(l){throw G.error("[".concat(this.getTrackId(),"] setDevice failed"),l.toString()),s=await wl({audio:this._constraints},this.getTrackId()),await this._updateOriginMediaStreamTrack(s.getAudioTracks()[0],!1),l}await this._updateOriginMediaStreamTrack(s.getAudioTracks()[0],!1),this._deviceName=t.label,this._config.microphoneId=e,this._constraints.deviceId={exact:e}}catch(t){throw G.error("[".concat(this.getTrackId(),"] setDevice error"),t.toString()),t}else try{const t=await Fc.getDeviceById(e);this._deviceName=t.label,this._config.microphoneId=e,this._constraints.deviceId={exact:e}}catch(t){throw G.error("[".concat(this.getTrackId(),"] setDevice error"),t.toString()),t}G.info("[".concat(this.getTrackId(),"] set device to ").concat(e," success"))}async setEnabled(e,t,r){if(t)return G.debug("[".concat(this.getTrackId(),"] setEnabled false (do not close microphone)")),await super._setEnabled(e);if(!r){if(e===this._enabled)return;this.stateCheck("enabled",e)}if(G.info("[".concat(this.getTrackId(),"] start setEnabled"),e),me("AUTO_RESET_AUDIO_ROUTE")&&(to()||Ye())){const m=navigator.audioSession;m&&(e||(m.type="playback"),m.type="auto")}if(!e){var s;this._originMediaStreamTrack.onended=null,this._originMediaStreamTrack.stop(),(s=this._source.clonedTrack)===null||s===void 0||s.stop(),r||(this._enabled=!1);try{await fr(this,Dt.NEED_DISABLE_TRACK,this)}catch(m){throw G.error("[".concat(this.getTrackId(),"] setEnabled false failed"),m.toString()),m}return}const l=fi({},this._constraints),f=Fc.searchDeviceIdByName(this._deviceName);f&&!l.deviceId&&(l.deviceId=f);try{r||(this._enabled=!0);const m=await wl({audio:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(m.getAudioTracks()[0],!1),await fr(this,Dt.NEED_ENABLE_TRACK,this)}catch(m){throw r||(this._enabled=!1),G.error("[".concat(this.getTrackId(),"] setEnabled true failed"),m.toString()),m}G.info("[".concat(this.getTrackId(),"] setEnabled success"))}close(){super.close(),(Ct()||un())&&Rr.unbindInterruptDetectorTrack(this)}onTrackEnded(){if((to()||Ye())&&this._enabled&&!this._isClosed&&Rr.duringInterruption){const e=async()=>{Rr.off(xa.IOS_INTERRUPTION_END,e),this._enabled&&!this._isClosed&&(G.debug("[".concat(this.getTrackId(),"] try capture microphone media device for interrupted iOS device.")),await this.setEnabled(!1),await this.setEnabled(!0))};Rr.on(xa.IOS_INTERRUPTION_END,e)}else G.debug("[".concat(this.getTrackId(),"] track ended")),this.safeEmit(Zu.TRACK_ENDED)}async renewMediaStreamTrack(e){const t=e||this._constraints,r=Fc.searchDeviceIdByName(this._deviceName);if(r&&!t.deviceId&&(t.deviceId=r),this._constraints=t,this._enabled){this._originMediaStreamTrack.stop();const s=await wl({audio:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(s.getAudioTracks()[0],!0)}}bindProcessorContextEvents(e){super.bindProcessorContextEvents(e),e.on(yo.REQUEST_UPDATE_CONSTRAINTS,async(t,r,s)=>{try{const l=Object.assign({},this._originalConstraints,...t);await this.renewMediaStreamTrack(l),r()}catch(l){s(l)}})}unbindProcessorContextEvents(e){super.unbindProcessorContextEvents(e),e.removeAllListeners(yo.REQUEST_UPDATE_CONSTRAINTS)}}).prototype,"setDevice",[h3,p3],Object.getOwnPropertyDescriptor(Sh.prototype,"setDevice"),Sh.prototype),jn(Sh.prototype,"setEnabled",[m3,g3,_3],Object.getOwnPropertyDescriptor(Sh.prototype,"setEnabled"),Sh.prototype),jn(Sh.prototype,"close",[E3],Object.getOwnPropertyDescriptor(Sh.prototype,"close"),Sh.prototype),Sh),R8=(v3=nn({argsMap:(e,t)=>[e.getTrackId(),t,e.duration]}),gs=Hi(),Ui=nn({argsMap:e=>[e.getTrackId()]}),mI=Hi(),C8=nn({argsMap:e=>[e.getTrackId()]}),va=Hi(),w8=nn({argsMap:e=>[e.getTrackId()]}),S3=Hi(),kL=nn({argsMap:e=>[e.getTrackId()]}),y3=Hi(),T3=nn({argsMap:e=>[e.getTrackId()]}),b3=nn({argsMap:e=>[e.getTrackId()]}),C3=Hi(),jn((_s=class extends ji{get __className__(){return"BufferSourceAudioTrack"}constructor(e,t,r,s){super(t.createOutputTrack(),r,s),Pe(this,"source",void 0),Pe(this,"_bufferSource",void 0),this._useAudioElement=!1,this.source=e,this._bufferSource=t,this._bufferSource.on(Vc.AUDIO_SOURCE_STATE_CHANGE,l=>{this.safeEmit(Zu.SOURCE_STATE_CHANGE,l)});try{this._mediaStreamTrack=this._source.createOutputTrack()}catch{}}get currentState(){return this._bufferSource.currentState}get duration(){return this._bufferSource.duration}get playbackSpeed(){return this._bufferSource.playbackSpeed}getCurrentTime(){return this._bufferSource.currentTime}startProcessAudioBuffer(e){e&&this._bufferSource.updateOptions(e),this._bufferSource.startProcessAudioBuffer()}pauseProcessAudioBuffer(){this._bufferSource.pauseProcessAudioBuffer()}seekAudioBuffer(e){this._bufferSource.seekAudioBuffer(e)}resumeProcessAudioBuffer(){this._bufferSource.resumeProcessAudioBuffer()}stopProcessAudioBuffer(){this._bufferSource.stopProcessAudioBuffer()}close(){this.source=null,this._bufferSource.destroy(),super.close()}setAudioBufferPlaybackSpeed(e){wr(e,"speed",0),this._bufferSource.setAudioBufferPlaybackSpeed(e)}}).prototype,"startProcessAudioBuffer",[v3,gs],Object.getOwnPropertyDescriptor(_s.prototype,"startProcessAudioBuffer"),_s.prototype),jn(_s.prototype,"pauseProcessAudioBuffer",[Ui,mI],Object.getOwnPropertyDescriptor(_s.prototype,"pauseProcessAudioBuffer"),_s.prototype),jn(_s.prototype,"seekAudioBuffer",[C8,va],Object.getOwnPropertyDescriptor(_s.prototype,"seekAudioBuffer"),_s.prototype),jn(_s.prototype,"resumeProcessAudioBuffer",[w8,S3],Object.getOwnPropertyDescriptor(_s.prototype,"resumeProcessAudioBuffer"),_s.prototype),jn(_s.prototype,"stopProcessAudioBuffer",[kL,y3],Object.getOwnPropertyDescriptor(_s.prototype,"stopProcessAudioBuffer"),_s.prototype),jn(_s.prototype,"close",[T3],Object.getOwnPropertyDescriptor(_s.prototype,"close"),_s.prototype),jn(_s.prototype,"setAudioBufferPlaybackSpeed",[b3,C3],Object.getOwnPropertyDescriptor(_s.prototype,"setAudioBufferPlaybackSpeed"),_s.prototype),_s);class Sa extends ji{get __className__(){return"MixingAudioTrack"}get isActive(){for(const t of this.trackList)if(t._enabled&&!t._isClosed&&!t.muted)return!0;return!1}constructor(){const t=RS().createMediaStreamDestination();super(t.stream.getAudioTracks()[0],void 0,Br(8,"track-mix-")),Pe(this,"trackList",void 0),Pe(this,"destNode",void 0),this._useAudioElement=!1;try{this._mediaStreamTrack=this._source.createOutputTrack()}catch{}this.destNode=t,this.trackList=[]}hasAudioTrack(t){return this.trackList.indexOf(t)!==-1}addAudioTrack(t){this.trackList.indexOf(t)===-1?(G.debug("add ".concat(t.getTrackId()," to mixing track")),t._source.outputNode.connect(this.destNode),this.trackList.push(t),this.updateEncoderConfig()):G.debug("track ".concat(t.getTrackId()," is already added"))}removeAudioTrack(t){if(this.trackList.indexOf(t)!==-1){G.debug("remove ".concat(t.getTrackId()," from mixing track"));try{t._source.outputNode.disconnect(this.destNode)}catch{}Qd(this.trackList,t),this.updateEncoderConfig()}}updateEncoderConfig(){const t={};this.trackList.forEach(r=>{r._encoderConfig&&((r._encoderConfig.bitrate||0)>(t.bitrate||0)&&(t.bitrate=r._encoderConfig.bitrate),(r._encoderConfig.sampleRate||0)>(t.sampleRate||0)&&(t.sampleRate=r._encoderConfig.sampleRate),(r._encoderConfig.sampleSize||0)>(t.sampleSize||0)&&(t.sampleSize=r._encoderConfig.sampleSize),r._encoderConfig.stereo&&(t.stereo=!0))}),this._encoderConfig=t}_updateRtpTransceiver(t){this._rtpTransceiver!==t&&(this._rtpTransceiver=t,this.trackList.forEach(r=>{r instanceof Sa?r.emit(Eh.TRANSCEIVER_UPDATED,t):r._updateRtpTransceiver(t)}))}}class I8 extends bl{set currentState(t){t!==this._currentState&&(this._currentState=t,this.safeEmit(Vc.AUDIO_SOURCE_STATE_CHANGE,this._currentState))}get currentState(){return this._currentState}constructor(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Pe(this,"audioBuffer",void 0),Pe(this,"sourceNode",void 0),Pe(this,"startPlayTime",0),Pe(this,"startPlayOffset",0),Pe(this,"pausePlayTime",0),Pe(this,"options",void 0),Pe(this,"currentLoopCount",0),Pe(this,"currentPlaybackSpeed",100),Pe(this,"_currentState","stopped"),this.audioBuffer=t,this.options=r,this.startPlayOffset=this.options.startPlayTime||0}createWebAudioDiagram(){return this.context.createGain()}get duration(){return this.audioBuffer?this.audioBuffer.duration:0}get playbackSpeed(){return this.currentPlaybackSpeed}get currentTime(){return this.audioBuffer?this.currentState==="stopped"?0:this.currentState==="paused"?this.pausePlayTime:((this.context.currentTime-this.startPlayTime)*(this.playbackSpeed/100)+this.startPlayOffset)%this.audioBuffer.duration:0}updateOptions(t){this.currentState==="stopped"?(this.options=t,this.startPlayOffset=this.options.startPlayTime||0):G.warning("can not set audio source options")}startProcessAudioBuffer(){this.sourceNode&&this.stopProcessAudioBuffer(),this.sourceNode=this.createSourceNode(),this.startSourceNode(),this.currentState="playing"}pauseProcessAudioBuffer(){this.sourceNode&&this.currentState==="playing"&&(this.pausePlayTime=this.currentTime,this.sourceNode.onended=null,this.sourceNode.stop(),this.sourceNode.buffer=null,this.sourceNode=this.createSourceNode(),this.currentState="paused")}seekAudioBuffer(t){this.sourceNode&&(this.sourceNode.onended=null,this.currentState==="playing"&&this.sourceNode.stop(),this.sourceNode=this.createSourceNode(),this.currentState==="playing"?(this.startPlayOffset=t,this.startSourceNode()):this.currentState==="paused"&&(this.pausePlayTime=t))}resumeProcessAudioBuffer(){this.currentState==="paused"&&this.sourceNode&&(this.startPlayOffset=this.pausePlayTime,this.pausePlayTime=0,this.startSourceNode(),this.currentState="playing")}stopProcessAudioBuffer(){if(this.sourceNode){this.sourceNode.onended=null;try{this.sourceNode.stop()}catch{}this.reset()}}destroy(){this.audioBuffer=null,super.destroy()}setAudioBufferPlaybackSpeed(t){this.sourceNode&&(this.currentState==="playing"&&(this.startPlayOffset=this.currentTime,this.startPlayTime=this.context.currentTime),this.sourceNode.playbackRate.value=t/100),this.currentPlaybackSpeed=t}startSourceNode(){this.sourceNode&&this.sourceNode.buffer&&(this.sourceNode.start(0,this.startPlayOffset),this.startPlayTime=this.context.currentTime,this.sourceNode.onended=this.handleSourceNodeEnded.bind(this))}createSourceNode(){const t=this.context.createBufferSource();return t.buffer=this.audioBuffer,t.loop=!!this.options.loop,t.connect(this.outputNode),t.playbackRate.value=this.currentPlaybackSpeed/100,t}handleSourceNodeEnded(){if(this.currentLoopCount+=1,this.options.cycle&&this.options.cycle>this.currentLoopCount)return this.startPlayOffset=0,this.sourceNode=void 0,void this.startProcessAudioBuffer();this.reset()}reset(){this.startPlayOffset=this.options.startPlayTime||0,this.currentState="stopped",this.sourceNode&&(this.sourceNode.disconnect(),this.sourceNode=void 0),this.currentLoopCount=0}}const w3=new Map;function R3(e,t){if(e.length===0||t.length===0)return 1/0;const r=aI(e),s=aI(t);return Math.floor(s/r)}class xL{get rendFrameRate(){const t=Math.max(1,R3(this._render_interframe_delays_sizes,this._render_interframe_delays));return Math.floor(1e3/t)}get videoElementStatus(){return this._videoElementStatus}set videoElementStatus(t){t!==this._videoElementStatus&&(G.debug("[".concat(this.trackId,"] video-element-status change ").concat(this._videoElementStatus," => ").concat(t)),this._videoElementStatus=t)}get videoState(){return this._videoState}set videoState(t){var r;t!==this._videoState&&(this._videoState=t,(r=this.onVideoStateChanged)===null||r===void 0||r.call(this,this.videoState))}constructor(t){Pe(this,"trackId",void 0),Pe(this,"config",void 0),Pe(this,"onFirstVideoFrameDecoded",void 0),Pe(this,"onVideoStateChanged",void 0),Pe(this,"freezeTimeCounterList",[]),Pe(this,"renderFreezeAccTime",0),Pe(this,"renderFreezeAccTime2",0),Pe(this,"isKeepLastFrame",!1),Pe(this,"timeUpdatedCount",0),Pe(this,"freezeTime",0),Pe(this,"playbackTime",0),Pe(this,"lastTimeUpdatedTime",0),Pe(this,"autoplayFailed",!1),Pe(this,"videoTrack",void 0),Pe(this,"videoElement",void 0),Pe(this,"cacheVideoElement",void 0),Pe(this,"_render_interframe_delays",[]),Pe(this,"_render_interframe_delays_sizes",[]),Pe(this,"_videoState",Tl.VideoStateStopped),Pe(this,"videoElementCheckInterval",void 0),Pe(this,"videoElementFreezeTimeout",void 0),Pe(this,"_videoElementStatus",Tn.NONE),Pe(this,"isGettingVideoDimensions",!1),Pe(this,"startGetVideoDimensions",()=>{const r=()=>{if(this.isGettingVideoDimensions=!0,this.videoElement.videoWidth*this.videoElement.videoHeight>4)return G.debug("[".concat(this.trackId,"] current video dimensions:"),this.videoElement.videoWidth,this.videoElement.videoHeight),void(this.isGettingVideoDimensions=!1);setTimeout(r,500)};!this.isGettingVideoDimensions&&r()}),Pe(this,"autoResumeAfterInterruption",()=>{this.videoTrack&&this.videoTrack.readyState==="live"&&Rr.curState==="running"&&(G.debug("[track-".concat(this.trackId,"] video element paused, auto resume for ").concat(_x())),oe()?(this.videoElement.srcObject=null,this.videoElement.srcObject=new MediaStream([this.videoTrack]),this.videoElement.play()):(this.videoElement.pause(),this.videoElement.play()))}),Pe(this,"handleVideoEvents",r=>{switch(r.type){case"play":case"playing":this.startGetVideoDimensions(),this.videoElementStatus=Tn.PLAYING;break;case"loadeddata":if(this.videoState=Tl.VideoStateStarting,this.onFirstVideoFrameDecoded&&this.onFirstVideoFrameDecoded(),this.cacheVideoElement){try{this.cacheVideoElement.srcObject=null,this.cacheVideoElement.remove()}catch{}this.cacheVideoElement=void 0}break;case"canplay":this.videoElementStatus=Tn.CANPLAY;break;case"stalled":this.videoElementStatus=Tn.STALLED;break;case"suspend":this.videoElementStatus=Tn.SUSPEND;break;case"pause":this.videoElementStatus=Tn.PAUSED,to()||Ye()||ns()&&this.autoplayFailed||!this.videoTrack||this.videoTrack.readyState!=="live"||(G.debug("[track-".concat(this.trackId,"] video element paused, auto resume")),this.videoElement.play());break;case"waiting":this.videoElementStatus=Tn.WAITING;break;case"abort":this.videoElementStatus=Tn.ABORT;break;case"ended":this.videoElementStatus=Tn.ENDED;break;case"emptied":this.videoElementStatus=Tn.EMPTIED;break;case"error":{const s=this.videoElement.error;s&&(this.videoElementStatus=Tn.ERROR,G.error("[".concat(this.trackId,"] media error: ").concat(s.message," (").concat(s.code,")")));break}case"timeupdate":{const s=performance.now();if(this.timeUpdatedCount+=1,this.timeUpdatedCount<10)return void(this.lastTimeUpdatedTime=s);const l=s-this.lastTimeUpdatedTime,f=this.lastTimeUpdatedTime;if(this.lastTimeUpdatedTime=s,ef.lastVisibleTime<ef.lastHiddenTime||f<ef.lastHiddenTime||f<ef.lastVisibleTime)return;for(l>me("VIDEO_FREEZE_DURATION")&&(this.freezeTime+=l),this.playbackTime+=l;this.playbackTime>=6e3;){this.playbackTime-=6e3;const m=Math.min(6e3,this.freezeTime);this.freezeTimeCounterList.push(m),this.freezeTime=Math.max(0,this.freezeTime-6e3)}break}}}),Pe(this,"autoResumeAfterInterruptionOnIOS15_16",()=>{this.videoTrack&&this.videoTrack.readyState==="live"&&(G.debug("[track-".concat(this.trackId,"] video element paused, auto resume for ").concat(_x())),oe()?(this.videoElement.srcObject=null,this.videoElement.srcObject=new MediaStream([this.videoTrack]),this.videoElement.play()):(this.videoElement.pause(),this.videoElement.play()))}),this.trackId=t.trackId,this.config=t,t.element instanceof HTMLVideoElement?this.videoElement=t.element:this.videoElement=document.createElement("video"),Rr.on(xa.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),Rr.on(xa.IOS_15_16_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15_16)}getVideoElement(){return this.videoElement}getContainerElement(){var t;return(t=this.videoElement.parentElement)!==null&&t!==void 0?t:void 0}updateConfig(t){this.config=t,this.trackId=t.trackId,t.element!==this.videoElement&&(this.destroy(),this.videoElement=t.element),this.videoTrack&&this.initVideoElement()}updateVideoTrack(t){this.videoTrack!==t&&(this.videoTrack=t,this.initVideoElement())}play(t){const r=this.videoElement.play();r&&r.catch&&r.catch(l=>{t&&Gx(t,"video",l.message,this.trackId),l.name==="NotAllowedError"?(G.warning("detected video element autoplay failed",l),this.autoplayFailed=!0,this.handleAutoPlayFailed()):G.warning("[".concat(this.trackId,"] play warning: "),l)});const s=qn();if((s.name==="Safari"&&Number(s.version)===15||Ct())&&r&&r.then){const l=()=>{this.config.mirror&&(this.videoElement.style.transform="rotateY(180deg)")};r.then(l).catch(l)}}getCurrentFrame(){const t=document.createElement("canvas");t.width=this.videoElement.videoWidth,t.height=this.videoElement.videoHeight;const r=t.getContext("2d");if(!r)return G.error("create canvas context failed!"),new ImageData(2,2);r.drawImage(this.videoElement,0,0,t.width,t.height);const s=r.getImageData(0,0,t.width,t.height);return t.remove(),s}async getCurrentFrameToUint8Array(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;const s=document.createElement("canvas");s.width=this.videoElement.videoWidth,s.height=this.videoElement.videoHeight;const l=s.getContext("2d");return l?(l.drawImage(this.videoElement,0,0,s.width,s.height),new gt((f,m)=>{s.toBlob(async E=>{if(s.remove(),E){const y=await Xx(E);f({buffer:y,width:s.width,height:s.height})}else m(new Ke(se.CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED))},t,r<0?.1:r>1?1:r)})):await ML(t)}destroy(){Rr.off(xa.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),Rr.off(xa.IOS_15_16_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15_16),this.videoElement.srcObject=null,this.resetVideoElement(),this.freezeTimeCounterList=[],this.videoState=Tl.VideoStateStopped}initVideoElement(){if(this.videoElementStatus=Tn.INIT,!this.videoElementCheckInterval&&(I3.forEach(f=>{this.videoElement.addEventListener(f,this.handleVideoEvents)}),this.videoElementCheckInterval=window.setInterval(()=>{(function(f){return f!==document.body&&document.body.contains(f)})(this.videoElement)||(this.videoElementStatus=Tn.DESTROYED)},1e3),me("ENABLE_VIDEO_FRAME_CALLBACK"))){var t,r;let f;const m=()=>{document.visibilityState==="visible"&&(document.removeEventListener("visibilitychange",m),this.videoElementFreezeTimeout=window.setTimeout(E,me("VIDEO_FREEZE_DURATION")))},E=()=>{this.videoElementFreezeTimeout=void 0,this.videoState===Tl.VideoStateDecoding&&(document.visibilityState==="visible"?this.videoState=Tl.VideoStateFrozen:document.addEventListener("visibilitychange",m))},y=(b,A)=>{if(this.videoElementStatus===Tn.PLAYING){if(f){const P=A.presentationTime-f.presentationTime,F=A.presentedFrames-f.presentedFrames;this._render_interframe_delays_sizes.push(F),this._render_interframe_delays.push(P);const B=aI(this._render_interframe_delays_sizes),Y=B-this._render_interframe_delays_sizes[0];if(B>30&&Y>5&&(this._render_interframe_delays_sizes.shift(),this._render_interframe_delays.shift()),this.videoState===Tl.VideoStateStarting&&(this.videoState=Tl.VideoStateDecoding),this.videoState===Tl.VideoStateDecoding&&this.onVideoStateChanged&&(this.videoElementFreezeTimeout&&window.clearTimeout(this.videoElementFreezeTimeout),this.videoElementFreezeTimeout=window.setTimeout(E,me("VIDEO_FREEZE_DURATION"))),P<me("VIDEO_FREEZE_DURATION")&&this.videoState===Tl.VideoStateFrozen&&(this.videoState=Tl.VideoStateDecoding),P>me("VIDEO_FREEZE_DURATION")&&ef.lastVisibleTime>=ef.lastHiddenTime&&f.timestamp>ef.lastVisibleTime&&f.timestamp>ef.lastHiddenTime){const $=Math.min(66,R3(this._render_interframe_delays_sizes,this._render_interframe_delays)),ee=Math.max(0,P-(F-1)*$);this.renderFreezeAccTime2+=ee>$?ee:0,this.renderFreezeAccTime+=P}}f=fi(fi({},A),{},{timestamp:b})}var O,D;me("ENABLE_VIDEO_FRAME_CALLBACK")&&((O=(D=this.videoElement).requestVideoFrameCallback)===null||O===void 0||O.call(D,y))};(t=(r=this.videoElement).requestVideoFrameCallback)===null||t===void 0||t.call(r,y)}this.videoElement.controls=!1,this.videoElement.setAttribute("playsinline",""),Pa()&&!me("HIDE_NO_POSTER")&&(this.videoElement.poster="noposter");const s=qn();s.name==="Safari"&&Number(s.version)===15||Ct()||!this.config.mirror||(this.videoElement.style.transform="rotateY(180deg)"),this.config.fit?this.videoElement.style.objectFit=this.config.fit:this.videoElement.style.objectFit="cover",this.videoElement.setAttribute("muted",""),this.videoElement.muted=!0,this.videoElement.srcObject&&this.videoElement.srcObject instanceof MediaStream?this.videoElement.srcObject.getVideoTracks()[0]!==this.videoTrack&&(this.videoElement.srcObject=this.videoTrack?new MediaStream([this.videoTrack]):null,ei()&&this.videoElement.load()):(this.videoElement.srcObject=this.videoTrack?new MediaStream([this.videoTrack]):null,ei()&&this.videoElement.load());const l=this.videoElement.play();l!==void 0&&l.catch(f=>{G.debug("[".concat(this.trackId,"] playback interrupted"),f.toString())})}resetVideoElement(){I3.forEach(t=>{this.videoElement&&this.videoElement.removeEventListener(t,this.handleVideoEvents)}),this.videoElementCheckInterval&&(window.clearInterval(this.videoElementCheckInterval),this.videoElementCheckInterval=void 0),this.videoElementStatus=Tn.NONE}handleAutoPlayFailed(){const t=r=>{r.preventDefault(),this.videoElement.play().then(()=>{G.debug("[".concat(this.trackId,"] Video element for trackId:").concat(this.trackId," autoplay resumed."))}).catch(s=>{G.error(s)}),this.autoplayFailed=!1,Xd()?document.body.removeEventListener("click",t,!0):(document.body.removeEventListener("touchstart",t,!0),document.body.removeEventListener("mousedown",t,!0))};Xd()?document.body.addEventListener("click",t,!0):(document.body.addEventListener("touchstart",t,!0),document.body.addEventListener("mousedown",t,!0)),hI()}}const I3=["play","playing","loadeddata","canplay","pause","stalled","suspend","waiting","abort","emptied","ended","timeupdate","error"];class A3 extends xL{constructor(t){super(t),Pe(this,"container",void 0),Pe(this,"slot",void 0),this.slot=t.element,this.updateConfig(t)}updateConfig(t){this.config=t,this.trackId=t.trackId;const r=t.element;r!==this.slot&&(this.destroy(),this.slot=r),this.createElements()}updateVideoTrack(t){this.videoTrack!==t&&(this.videoTrack=t,this.createElements())}play(t){var r;(r=this.container)!==null&&r!==void 0&&r.contains(this.videoElement)&&super.play(t)}getCurrentFrame(){var t;return(t=this.container)!==null&&t!==void 0&&t.contains(this.videoElement)?super.getCurrentFrame():new ImageData(2,2)}async getCurrentFrameToUint8Array(t){var r;let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;return(r=this.container)!==null&&r!==void 0&&r.contains(this.videoElement)?await super.getCurrentFrameToUint8Array(t,s):await ML(t)}destroy(){if(super.destroy(),this.videoElement.remove(),this.videoElement=document.createElement("video"),this.container){try{this.container.remove(),this.slot.removeChild(this.container)}catch{}this.container=void 0}}createElements(){this.container||(this.container=document.createElement("div")),this.container.id="agora-video-player-".concat(this.trackId),this.container.style.width="100%",this.container.style.height="100%",this.container.style.position="relative",this.container.style.overflow="hidden",this.videoTrack?(this.container.style.backgroundColor="black",me("KEEP_LAST_FRAME")&&this.isKeepLastFrame&&this.videoElement.paused&&this.resetVideoElement(),this.mountedVideoElement()):this.unmountedVideoElement(),this.slot.appendChild(this.container)}mountedVideoElement(){var t;!this.container||(t=this.container)!==null&&t!==void 0&&t.contains(this.videoElement)||this.container.appendChild(this.videoElement),super.initVideoElement(),this.videoElement.id="video_".concat(this.trackId),this.videoElement.className="agora_video_player",this.videoElement.style.width="100%",this.videoElement.style.height="100%",this.videoElement.style.position="absolute",this.videoElement.style.left="0",this.videoElement.style.top="0"}unmountedVideoElement(){var t;if((t=this.container)!==null&&t!==void 0&&t.contains(this.videoElement)){super.resetVideoElement();try{this.container&&this.container.removeChild(this.videoElement)}catch{}this.videoElement=document.createElement("video")}}resetVideoElement(){var t;(t=this.container)!==null&&t!==void 0&&t.contains(this.videoElement)&&(super.resetVideoElement(),this.cacheVideoElement=this.videoElement,this.videoElement=document.createElement("video"))}getContainerElement(){return this.container}}var O3,N3,L3,D3,P3,M3,k3,x3,U3,j3,V3,Hn,B3,F3,G3,z3,H3,W3,Y3,K3,Il,ni,UL,jL,q3,J3,Pn,X3,rd,Q3,Z3,$3,eU,tU,nU,Wi;let Kr=(O3=nn({argsMap:(e,t,r)=>[e.getTrackId(),typeof t=="string"?t:t instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement",r]}),N3=Hi(),L3=nn({argsMap:e=>[e.getTrackId()]}),D3=TS("LocalVideoTrack","_enabledMutex"),P3=nn({argsMap:(e,t)=>[e.getTrackId(),t]}),M3=Hi(),k3=TS("LocalVideoTrack","_enabledMutex"),x3=nn({argsMap:(e,t)=>[e.getTrackId(),t]}),U3=Hi(),j3=nn({argsMap:(e,t)=>[e.getTrackId(),t,e._saveEncodeBitrateRatio]}),V3=Hi(),Hn=nn({argsMap:(e,t)=>[e.getTrackId(),t]}),B3=Hi(),F3=Hi(),G3=nn({argsMap:(e,t,r)=>[e.getTrackId(),t,r]}),z3=Hi(),H3=Hi(),W3=Hi(),Y3=Hi(),K3=Hi(),Il=Hi(),ni=Hi(),UL=nn({argsMap:(e,t)=>[e.getTrackId(),t.name]}),jL=nn({argsMap:e=>[e.getTrackId()]}),q3=nn({argsMap:e=>[e.getTrackId()]}),J3=nn({argsMap:(e,t,r)=>[e.getTrackId(),t.label,r]}),Pn=class mce extends $b{get videoHeight(){if(ns()){const{height:t}=this._mediaStreamTrack.getSettings();return this._videoHeight=t,this._videoHeight}return this._videoHeight}get videoWidth(){if(ns()){const{width:t}=this._mediaStreamTrack.getSettings();return this._videoWidth=t,this._videoWidth}return this._videoWidth}get isPlaying(){return!(!this._player||this._player.videoElementStatus!==Tn.PLAYING)}get processorDestination(){return this._processorDestination}get processorContext(){return this._processorContext}set processorContext(t){this._processorContext=t}get __className__(){return"LocalVideoTrack"}constructor(t,r,s,l,f,m){if(super(t,f),Pe(this,"trackMediaType",yl.VIDEO),Pe(this,"_player",void 0),Pe(this,"isUseScaleResolutionDownBy",!1),Pe(this,"_videoVisibleTimer",null),Pe(this,"_previousVideoVisibleStatus",void 0),Pe(this,"_clearPreviousVideoVisibleStatus",()=>this._previousVideoVisibleStatus=void 0),Pe(this,"_encoderConfig",void 0),Pe(this,"_scalabilityMode",{numSpatialLayers:1,numTemporalLayers:1}),Pe(this,"_optimizationMode",void 0),Pe(this,"_saveEncodeBitrateRatio",1),Pe(this,"_videoHeight",void 0),Pe(this,"_videoWidth",void 0),Pe(this,"_forceBitrateLimit",void 0),Pe(this,"_enabled",!0),Pe(this,"_processorDestination",void 0),Pe(this,"_processorContext",void 0),ns()){const{width:E,height:y}=t.getSettings();this._videoWidth=E,this._videoHeight=y}else this.updateMediaStreamTrackResolution();if(this._scalabilityMode=s,this._optimizationMode=l,this._hints=m||[],r&&this._hints.indexOf(xr.CUSTOM_TRACK)!==-1?this._encoderConfig=Mn(r):this._encoderConfig=r,this._hints.indexOf(xr.SCREEN_TRACK)===-1)this.updateBitrateFromProfile();else if(hL(sr.CHROME,115)&&jb().indexOf("Windows")!==-1){const E=function(y,b){if("VideoFrame"in window&&"TransformStream"in window&&zn().supportWebRTCInsertableStream){const A=new MediaStreamTrackProcessor(y),O=new MediaStreamTrackGenerator({kind:"video"});let D,P,F=Date.now();const B=()=>{Y&&(clearInterval(Y),Y=void 0),D&&(D.close(),D=void 0),y.stop(),P=void 0,O.removeEventListener("ended",B)};let Y=window.setInterval(()=>{if(P&&D&&Date.now()-F>1e3)try{O.readyState==="live"?P.enqueue(D.clone()):B()}catch{B()}},1e3);const $=new TransformStream({transform:(ee,Ee)=>{O.readyState==="live"?(P=Ee,F=Date.now(),D===void 0?(D=ee,Ee.enqueue(ee.clone())):(Ee.enqueue(D),D=ee)):ee.close()}});return O.addEventListener("ended",B),A.readable.pipeThrough($).pipeTo(O.writable),O}}(t);E&&(G.info("local screen video track begin to inject frame"),this._mediaStreamTrack=E)}r&&this._hints.indexOf(xr.CUSTOM_TRACK)!==-1&&this.setEncoderConfiguration(r),this._processorContext=new zx(this.getTrackId(),"local"),this._processorDestination=new DL(this.processorContext),this.bindProcessorDestinationEvents()}play(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(typeof t=="string"){const l=document.getElementById(t);l?t=l:(G.warning("[".concat(this.getTrackId(),'] can not find "#').concat(t,'" element, use document.body')),t=document.body)}G.debug("[".concat(this.getTrackId(),"] start video playback in ").concat(t instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement"),JSON.stringify(r));const s=fi(fi(fi({},this._getDefaultPlayerConfig()),r),{},{trackId:this.getTrackId(),element:t});this._player?this._player.updateConfig(s):(t instanceof HTMLVideoElement?this._player=new xL(s):this._player=new A3(s),this._player.updateVideoTrack(this._mediaStreamTrack)),this._player.play(),this._videoVisibleTimer&&window.clearInterval(this._videoVisibleTimer),this._clearPreviousVideoVisibleStatus(),this._videoVisibleTimer=window.setInterval(()=>{try{const l=this.getVideoElementVisibleStatus();this.safeEmit(Zu.VIDEO_ELEMENT_VISIBLE_STATUS,l)}catch{}},me("CHECK_VIDEO_VISIBLE_INTERVAL"))}stop(){this._player&&(this._videoVisibleTimer&&(window.clearInterval(this._videoVisibleTimer),this._videoVisibleTimer=null),this._clearPreviousVideoVisibleStatus(),this._player.destroy(),this._player=void 0,G.debug("[".concat(this.getTrackId(),"] stop video playback")))}async setEnabled(t,r){if(!r){if(t===this._enabled)return;this.stateCheck("enabled",t)}if(G.info("[".concat(this.getTrackId(),"] start setEnabled"),t),!t){this._originMediaStreamTrack.enabled=!1;try{await fr(this,Dt.NEED_DISABLE_TRACK,this)}catch(s){throw G.error("[".concat(this.getTrackId(),"] setEnabled to false error"),s.toString()),s}return r||(this._enabled=!1),void G.info("[".concat(this.getTrackId(),"] setEnabled to false success"))}this._originMediaStreamTrack.enabled=!0;try{await fr(this,Dt.NEED_ENABLE_TRACK,this)}catch(s){throw G.error("[".concat(this.getTrackId(),"] setEnabled to true error"),s.toString()),s}G.info("[".concat(this.getTrackId(),"] setEnabled to true success")),r||(this._enabled=!0)}async setMuted(t){t!==this._muted&&(this.stateCheck("muted",t),this._muted=t,this._originMediaStreamTrack.enabled=!t,G.debug("[".concat(this.getTrackId(),"] start set muted: ").concat(t)),t?await fr(this,Dt.NEED_MUTE_TRACK,this):await fr(this,Dt.NEED_UNMUTE_TRACK,this))}async setSaveEncodeBitrateRatio(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this._saveEncodeBitrateRatio;if(this._saveEncodeBitrateRatio!==1&&this._encoderConfig&&this._encoderConfig.bitrateMax&&this._encoderConfig.bitrateMin){this._encoderConfig.bitrateMin=Math.floor(this._encoderConfig.bitrateMin*t),this._encoderConfig.bitrateMax=Math.floor(this._encoderConfig.bitrateMax*t),G.debug("[".concat(this.getTrackId(),"] set save encode bitrate ratio, ").concat(t)),this._saveEncodeBitrateRatio=1;try{await fr(this,Dt.NEED_UPDATE_VIDEO_ENCODER,this)}catch(r){return r.throw(G)}}}async setEncoderConfiguration(t,r){if(!this._enabled)throw new Ke(se.TRACK_IS_DISABLED,"can not set encoder configuration when track is disabled");if(t=Bo(t),me("USE_STANDARD_BITRATE_DEFAULT")&&(delete t.bitrateMax,delete t.bitrateMin),this._forceBitrateLimit&&(t.bitrateMax=this._forceBitrateLimit.max_bitrate?this._forceBitrateLimit.max_bitrate:t.bitrateMax,t.bitrateMin=this._forceBitrateLimit.min_bitrate?this._forceBitrateLimit.min_bitrate:t.bitrateMin),t.width||t.height||t.frameRate){const s=pI({encoderConfig:t});(ns()||to()||Ye())&&(s.deviceId=void 0),G.debug("[".concat(this.getTrackId(),"] setEncoderConfiguration applyConstraints"),JSON.stringify(t),JSON.stringify(s));try{await this._originMediaStreamTrack.applyConstraints(s),this.updateMediaStreamTrackResolution()}catch(l){const f=new Ke(se.UNEXPECTED_ERROR,l.toString());throw G.error("[".concat(this.getTrackId(),"] applyConstraints error"),f.toString()),f}}this._encoderConfig=t,this._hints.indexOf(xr.SCREEN_TRACK)===-1&&this.updateBitrateFromProfile();try{await fr(this,Dt.NEED_UPDATE_VIDEO_ENCODER,this)}catch(s){return s.throw(G)}}getStats(){return ph(()=>{G.warning("[deprecated] LocalVideoTrack.getStats will be removed in the future, use AgoraRTCClient.getLocalVideoStats instead")},"localVideoTrackGetStatsWarning"),Gs(this,Dt.GET_STATS)||fi({},NL)}async setBeautyEffect(t){G.error("LocalVideoTrack.setBeautyEffect was deprecated, please migrate to agora-extension-beauty-effect")}getCurrentFrameData(){return this._player?this._player.getCurrentFrame():new ImageData(2,2)}async getCurrentFrameImage(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;return this._player?this._player.getCurrentFrameToUint8Array(t,r):await ML(t)}async setBitrateLimit(t){G.debug("[".concat(this.getTrackId(),"] set bitrate limit, ").concat(JSON.stringify(t))),t&&(this._forceBitrateLimit=t,this._encoderConfig&&(this._encoderConfig.bitrateMax?this._encoderConfig.bitrateMax=this._encoderConfig.bitrateMax<t.max_bitrate?this._encoderConfig.bitrateMax:t.max_bitrate:this._encoderConfig.bitrateMax=t.max_bitrate,this._encoderConfig.bitrateMin,this._encoderConfig.bitrateMin=t.min_bitrate))}async setOptimizationMode(t){if(t!=="motion"&&t!=="detail"&&t!=="balanced")return void G.error(se.INVALID_PARAMS,"optimization mode must be motion, detail or balanced");const r=this._optimizationMode;try{this._optimizationMode=t,await fr(this,Dt.NEED_UPDATE_VIDEO_SEND_PARAMETERS,this)}catch(s){throw this._optimizationMode=r,G.error("[".concat(this.getTrackId(),"] set optimization mode failed"),s.toString()),s}G.info("[".concat(this.getTrackId(),"] set optimization mode success (").concat(t,")"))}setScalabiltyMode(t){if(t.numSpatialLayers===1&&t.numTemporalLayers!==1)return G.error(se.INVALID_PARAMS,"scalability mode currently not supported, no SVC."),void(this._scalabilityMode={numSpatialLayers:1,numTemporalLayers:1});this._scalabilityMode=t,G.info("[".concat(this.getTrackId(),"] set scalability mode success (").concat(t,")"))}updateMediaStreamTrackResolution(){Yx(this._originMediaStreamTrack).then(t=>{let[r,s]=t;this._videoHeight=s,this._videoWidth=r}).catch(Dg)}_updatePlayerSource(){this._player&&this._player.updateVideoTrack(this._mediaStreamTrack)}_getDefaultPlayerConfig(){return{fit:"contain"}}async setSenderConfiguration(t){if(!this._enabled)throw new Ke(se.TRACK_IS_DISABLED,"can not set encoder configuration when track is disabled");G.debug("[".concat(this.getTrackId(),"] setSenderConfiguration applyConstraints"),JSON.stringify(t)),t=Bo(t),this._forceBitrateLimit&&(t.bitrateMax=this._forceBitrateLimit.max_bitrate?this._forceBitrateLimit.max_bitrate:t.bitrateMax,t.bitrateMin=this._forceBitrateLimit.min_bitrate?this._forceBitrateLimit.min_bitrate:t.bitrateMin),this._encoderConfig=t,this._hints.indexOf(xr.SCREEN_TRACK)===-1&&this.updateBitrateFromProfile();try{await fr(this,Dt.NEED_UPDATE_VIDEO_ENCODER,this)}catch(r){return r.throw(G)}}updateBitrateFromProfile(){if(!this._encoderConfig)return;const{width:t,height:r,frameRate:s}=this.getMediaStreamTrackSettings();if(!t||!r||!s)return;const{bitrateMax:l,bitrateMin:f}=this._encoderConfig;if(f==null||l==null){const{max:m,min:E}=function(y,b,A,O,D){const P=me("BITRATE_ADAPTER_TYPE");if(P==="DEFAULT_BITRATE")return{min:O,max:D};if(D===void 0){const F=Math.floor(200*Math.pow(A/15,.6)*Math.pow(y*b/640/360,.75));D=P==="STANDARD_BITRATE"?4*F:2*F,O=O??F}else O=O??Math.floor(D/10);return{min:O,max:D}}(t,r,s,f,l);if(this._encoderConfig.bitrateMin=E,this._encoderConfig.bitrateMax=m,me("VIDEO_STANDARD_BITRATE_VERSION")&&f==null&&l==null){const[y,b]=function(A,O,D){const P=4*Math.floor(2e5*Math.pow(D/15,.6)*Math.pow(A*O/230400,.75)),F=A*O,B=new Map([[19200,.9],[230400,.85],[518400,.75],[921600,.7],[2073600,.6],[3686400,.5]]),Y=new Map([[230400,.95],[518400,.9],[921600,.85],[2073600,.8]]);let $=oc(B).call(B).next().value,ee=1;if(B.has(F))$=B.get(F);else{var Ee;const Ve=sn(Ee=Array.from(B.entries())).call(Ee,(W,ce)=>{let[Se]=W,[Xe]=ce;return Se-Xe}),Be=Ve.find(W=>{let[ce]=W;return ce>F});if(Be){const W=Ve.indexOf(Be);if(W>0){const ce=Ve[W-1],Se=(F-ce[0])/(Be[0]-ce[0]);$=ce[1]+Se*(Be[1]-ce[1])}else $=Be[1]}else $=Ve[Ve.length-1][1]}if(Y.has(F))ee=Y.get(F);else{var Re;const Ve=sn(Re=Array.from(Y.entries())).call(Re,(W,ce)=>{let[Se]=W,[Xe]=ce;return Se-Xe}),Be=Ve.find(W=>{let[ce]=W;return ce>F});if(Be){const W=Ve.indexOf(Be);if(W>0){const ce=Ve[W-1],Se=(F-ce[0])/(Be[0]-ce[0]);ee=ce[1]+Se*(Be[1]-ce[1])}else ee=Be[1]}else ee=Ve[Ve.length-1][1]}const Ie=me("VIDEO_NEW_BITRATE_RATIO");Ie&&Ie>0&&($=Ie/100);const we=Math.floor(P*$),Ue=Math.floor(65e4*Math.pow(A*O/230400,.5)*Math.pow(D/15,.69));let ve=we;const Ne=me("VIDEO_STANDARD_BITRATE_VERSION");return Ne&&Ne>0&&(Ne===1?ve=P:Ne===2?ve=we:Ne===3&&(ve=Ue)),[Math.floor(ve/1e3),ee]}(t,r,s);this._encoderConfig.bitrateMax=y,this._encoderConfig.bitrateMin=E?Math.min(E,y):y,this._saveEncodeBitrateRatio=b,G.debug("[".concat(this.getTrackId(),"] update new bitrate from profile, [w: ").concat(t,", h: ").concat(r,", fps: ").concat(s,"] => [brMax: ").concat(this._encoderConfig.bitrateMax,", brMin: ").concat(this._encoderConfig.bitrateMin,", save_bitrate_ratio: ").concat(this._saveEncodeBitrateRatio,"]"))}else G.debug("[".concat(this.getTrackId(),"] update bitrate from profile, [w: ").concat(t,", h: ").concat(r,", fps: ").concat(s,"] => [brMax: ").concat(m,", brMin: ").concat(E,"]")),this._saveEncodeBitrateRatio=1}}getVideoElementVisibleStatus(){try{var t,r;const s=this==null||(t=this._player)===null||t===void 0?void 0:t.getContainerElement(),l={track:this,element:this==null||(r=this._player)===null||r===void 0?void 0:r.getVideoElement(),slot:s==null?void 0:s.parentElement},{element:f,slot:m}=l;if(this.isPlaying&&f instanceof HTMLVideoElement&&m instanceof HTMLElement){const E=ur.checkOneElementVisible(f),y=Object.assign({},E);if(y.visible!==this._previousVideoVisibleStatus){this._previousVideoVisibleStatus=y.visible;const b=Vt.reportApiInvoke(null,{tag:Bn.TRACER,name:Di.LOCAL_VIDEO_TRACK_GET_VIDEO_VISIBLE,options:[this.getTrackId()]});y.visible?b.onSuccess("Video is visible"):b.onSuccess("Invisible because of ".concat(y.reason))}return y}return}catch(s){throw new Ke(se.GET_VIDEO_ELEMENT_VISIBLE_ERROR,s.message)}}async renewMediaStreamTrack(t){}pipe(t){if(this.processor===t)return t;if(t._source)throw new Ke(se.INVALID_OPERATION,"Processor ".concat(t.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=t,this.processor._source=this,t.updateInput({track:this._originMediaStreamTrack,context:this.processorContext}),t}unpipe(){if(!this.processor)return;const t=this.processor;this.processor._source=void 0,this.processor=void 0,t.reset()}close(){super.close(),this.unbindProcessorDestinationEvents(),this.unbindProcessorContextEvents(),this.unpipe(),this.processorDestination._source&&this.processorDestination._source.unpipe()}clone(t){let r=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],s=this._encoderConfig;t&&(s=fi(fi({},s),Bo(t))),s=gr(s);const l=Br(8,"track-video-cloned-"),f=new mce(r?this._mediaStreamTrack.clone():this._mediaStreamTrack,s,gr(this._scalabilityMode),this._optimizationMode,l,gr(this._hints));return t&&s&&f.setEncoderConfiguration(s),G.debug("clone video track from ".concat(this.getTrackId()," to ").concat(l,", clone ").concat(r)),f}async replaceTrack(t,r){if(!(t instanceof MediaStreamTrack))throw new Ke(se.INVALID_PARAMS,"track should be an instance of MediaStreamTrack");if(t.kind!=="video")throw new Ke(se.INVALID_PARAMS,"track should be a video MediaStreamTrack");await this._updateOriginMediaStreamTrack(t,r,!0),this.updateMediaStreamTrackResolution()}sendSeiData(t){if(ph(()=>{Vt.reportApiInvoke(null,{name:Di.LOCAL_VIDEO_SEND_SEI_DATA,options:[],tag:Bn.TRACER}).onSuccess("")},this._mediaStreamTrack.id||this.getTrackId()),!me("ENABLE_VIDEO_SEI")||!me("ENABLE_ENCODED_TRANSFORM"))return void G.warning('To send/receive SEI, please call AgoraRTC.setParameter("ENABLE_VIDEO_SEI", true) before instantiate IAgoraRtcClient');if(t instanceof Uint8Array==0)return new Ke(se.INVALID_PARAMS,"Invalid argument type, ILocalVideoTrack.sendSeiData() only accept Uint8Array argument.").throw();const r=this.getRTCRtpTransceiver();if(!r)return void G.warning("Video track is not published, SEI can not be send");const s=r.sender.getParameters();if(s.codecs.length===0)return;const l=s.codecs[0].mimeType.toLocaleLowerCase();l==="video/h264"?this.safeEmit("sei-to-send",t):G.warning("SEI is not supported by ".concat(l))}bindProcessorDestinationEvents(){this.processorDestination.on(So.ON_TRACK,async t=>{t?t!==this._mediaStreamTrack&&(this._mediaStreamTrack=t,this._updatePlayerSource(),await fr(this,Dt.NEED_REPLACE_TRACK,this)):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await fr(this,Dt.NEED_REPLACE_TRACK,this))})}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(So.ON_TRACK)}unbindProcessorContextEvents(){this.processorContext.removeAllListeners(yo.REQUEST_UPDATE_CONSTRAINTS),this.processorContext.removeAllListeners(yo.REQUEST_CONSTRAINTS)}},jn(Pn.prototype,"play",[O3,N3],Object.getOwnPropertyDescriptor(Pn.prototype,"play"),Pn.prototype),jn(Pn.prototype,"stop",[L3],Object.getOwnPropertyDescriptor(Pn.prototype,"stop"),Pn.prototype),jn(Pn.prototype,"setEnabled",[D3,P3,M3],Object.getOwnPropertyDescriptor(Pn.prototype,"setEnabled"),Pn.prototype),jn(Pn.prototype,"setMuted",[k3,x3,U3],Object.getOwnPropertyDescriptor(Pn.prototype,"setMuted"),Pn.prototype),jn(Pn.prototype,"setSaveEncodeBitrateRatio",[j3,V3],Object.getOwnPropertyDescriptor(Pn.prototype,"setSaveEncodeBitrateRatio"),Pn.prototype),jn(Pn.prototype,"setEncoderConfiguration",[Hn,B3],Object.getOwnPropertyDescriptor(Pn.prototype,"setEncoderConfiguration"),Pn.prototype),jn(Pn.prototype,"getStats",[F3],Object.getOwnPropertyDescriptor(Pn.prototype,"getStats"),Pn.prototype),jn(Pn.prototype,"setBeautyEffect",[G3,z3],Object.getOwnPropertyDescriptor(Pn.prototype,"setBeautyEffect"),Pn.prototype),jn(Pn.prototype,"getCurrentFrameData",[H3],Object.getOwnPropertyDescriptor(Pn.prototype,"getCurrentFrameData"),Pn.prototype),jn(Pn.prototype,"getCurrentFrameImage",[W3],Object.getOwnPropertyDescriptor(Pn.prototype,"getCurrentFrameImage"),Pn.prototype),jn(Pn.prototype,"setBitrateLimit",[Y3],Object.getOwnPropertyDescriptor(Pn.prototype,"setBitrateLimit"),Pn.prototype),jn(Pn.prototype,"setOptimizationMode",[K3],Object.getOwnPropertyDescriptor(Pn.prototype,"setOptimizationMode"),Pn.prototype),jn(Pn.prototype,"setScalabiltyMode",[Il],Object.getOwnPropertyDescriptor(Pn.prototype,"setScalabiltyMode"),Pn.prototype),jn(Pn.prototype,"updateMediaStreamTrackResolution",[ni],Object.getOwnPropertyDescriptor(Pn.prototype,"updateMediaStreamTrackResolution"),Pn.prototype),jn(Pn.prototype,"pipe",[UL],Object.getOwnPropertyDescriptor(Pn.prototype,"pipe"),Pn.prototype),jn(Pn.prototype,"unpipe",[jL],Object.getOwnPropertyDescriptor(Pn.prototype,"unpipe"),Pn.prototype),jn(Pn.prototype,"close",[q3],Object.getOwnPropertyDescriptor(Pn.prototype,"close"),Pn.prototype),jn(Pn.prototype,"replaceTrack",[J3],Object.getOwnPropertyDescriptor(Pn.prototype,"replaceTrack"),Pn.prototype),Pn),j_=(X3=nn({argsMap:(e,t)=>[e.getTrackId(),t]}),rd=Hi(),Q3=TS("CameraVideoTrack","_enabledMutex"),Z3=nn({argsMap:(e,t)=>[e.getTrackId(),t]}),$3=Hi(),eU=nn({argsMap:(e,t)=>[e.getTrackId(),t]}),tU=Hi(),nU=nn({argsMap:e=>[e.getTrackId()]}),Wi=class gce extends Kr{get __className__(){return"CameraVideoTrack"}constructor(t,r,s,l,f,m){super(t,Bo(r.encoderConfig),l,f,m),Pe(this,"_config",void 0),Pe(this,"_originalConstraints",void 0),Pe(this,"_constraints",void 0),Pe(this,"_enabled",!0),Pe(this,"_deviceName","default"),Pe(this,"tryResumeVideoForIOS15_16WeChat",async()=>{(Ct()||un())&&!function(){const E=qn();if(E.os!==mr.IOS||!E.osVersion)return!1;const y=E.osVersion.split(".");return Number(y[0])===15&&Number(y[1])>=2}()&&Vp()&&this._enabled&&!this._isClosed&&(G.debug("[".concat(this.getTrackId(),"] try capture camera media device for interrupted iOS 15 device on WeChat.")),await this.renewMediaStreamTrack())}),this._config=r,this._originalConstraints=s,this._constraints=s,this._deviceName=t.label,this._encoderConfig=Bo(this._config.encoderConfig),Rr.on(xa.IOS_15_16_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat),Rr.on(xa.IOS_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat),this.bindProcessorContextEvents()}async setDevice(t){return typeof t=="string"?this._setDeviceById(t):t.deviceId?this._setDeviceById(t.deviceId):t.facingMode?this._setDeviceByFacingModel(t.facingMode):void 0}async _setDeviceById(t){if(G.info("[".concat(this.getTrackId(),"] set device to ").concat(t)),this._enabled)try{const r=await Fc.getDeviceById(t),s={};s.video=fi({},this._constraints),s.video.deviceId={exact:t},s.video.facingMode=void 0,this._originMediaStreamTrack.stop();let l=null;try{l=await wl(s,this.getTrackId())}catch(f){throw G.error("[".concat(this.getTrackId(),"] setDevice failed"),f.toString()),l=await wl({video:this._constraints},this.getTrackId()),await this._updateOriginMediaStreamTrack(l.getVideoTracks()[0],!1),f}await this._updateOriginMediaStreamTrack(l.getVideoTracks()[0],!1),this.updateMediaStreamTrackResolution(),this._deviceName=r.label,this._config.cameraId=t,this._constraints.deviceId={exact:t}}catch(r){throw G.error("[".concat(this.getTrackId(),"] setDevice error"),r.toString()),r}else try{const r=await Fc.getDeviceById(t);this._deviceName=r.label,this._config.cameraId=t,this._constraints.deviceId={exact:t}}catch(r){throw G.error("[".concat(this.getTrackId(),"] setDevice error"),r.toString()),r}G.info("[".concat(this.getTrackId(),"] setDevice success"))}async _setDeviceByFacingModel(t){G.info("[".concat(this.getTrackId(),"] set facingMode ").concat(t));const r={video:fi(fi({},this._constraints),{},{deviceId:void 0,facingMode:{exact:t}})};if(this._enabled){this._originMediaStreamTrack.stop();let s=null;try{s=await wl(r,this.getTrackId())}catch(l){throw G.error("[".concat(this.getTrackId(),"] setDeviceByFacingModel failed"),l.toString()),s=await wl({video:this._constraints},this.getTrackId()),await this._updateOriginMediaStreamTrack(s.getVideoTracks()[0],!1),l}await this._updateOriginMediaStreamTrack(s.getVideoTracks()[0],!1),this.updateMediaStreamTrackResolution()}this._deviceName="",this._config.facingMode=t,this._config.cameraId=void 0,this._constraints=fi({},r.video),G.info("[".concat(this.getTrackId(),"] setDeviceByFacingModel success"))}async setEnabled(t,r){if(!r){if(t===this._enabled)return;this.stateCheck("enabled",t)}if(G.info("[".concat(this.getTrackId(),"] start setEnabled"),t),t){try{if(this.isExternalTrack)this._originMediaStreamTrack.enabled=!0;else{const s=await wl({video:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(s.getVideoTracks()[0],!1)}await fr(this,Dt.NEED_ENABLE_TRACK,this)}catch(s){throw G.error("[".concat(this.getTrackId(),"] setEnabled true error"),s.toString()),s}this.updateMediaStreamTrackResolution(),G.info("[".concat(this.getTrackId(),"] setEnabled to true success")),r||(this._enabled=!0)}else{this.isExternalTrack?this._originMediaStreamTrack.enabled=!1:(this._originMediaStreamTrack.onended=null,this._originMediaStreamTrack.stop()),r||(this._enabled=!1);try{await fr(this,Dt.NEED_DISABLE_TRACK,this)}catch(s){throw G.error("[".concat(this.getTrackId(),"] setEnabled to false error"),s.toString()),s}G.info("[".concat(this.getTrackId(),"] setEnabled to false success"))}}async setEncoderConfiguration(t,r){if(!this._enabled)throw new Ke(se.TRACK_IS_DISABLED,"can not set encoder configuration when track is disabled");t=Bo(t),me("USE_STANDARD_BITRATE_DEFAULT")&&(delete t.bitrateMax,delete t.bitrateMin),this._forceBitrateLimit&&(t.bitrateMax=this._forceBitrateLimit.max_bitrate||t.bitrateMax,t.bitrateMin=this._forceBitrateLimit.min_bitrate||t.bitrateMin);const s=Mn(this._config);s.encoderConfig=t;const l=pI(s);(ns()||to()||Ye())&&(l.deviceId=void 0),G.debug("[".concat(this.getTrackId(),"] setEncoderConfiguration applyConstraints"),JSON.stringify(t),JSON.stringify(l));try{await this._originMediaStreamTrack.applyConstraints(l),this.updateMediaStreamTrackResolution()}catch(f){const m=new Ke(se.UNEXPECTED_ERROR,f.toString());throw G.error("[".concat(this.getTrackId(),"] applyConstraints error"),m.toString()),m}this._config=s,this._constraints=l,this._originalConstraints=l,this._encoderConfig=t,this._hints.indexOf(xr.SCREEN_TRACK)===-1&&this.updateBitrateFromProfile();try{await fr(this,Dt.NEED_UPDATE_VIDEO_ENCODER,this)}catch(f){return f.throw(G)}}_getDefaultPlayerConfig(){return{mirror:!0,fit:"cover"}}onTrackEnded(){if((to()||Ye())&&this._enabled&&!this._isClosed&&Rr.duringInterruption){const t=async()=>{Rr.off(xa.IOS_INTERRUPTION_END,t),this._enabled&&!this._isClosed&&(G.debug("[".concat(this.getTrackId(),"] try capture camera media device for interrupted iOS device.")),await this.setEnabled(!1),await this.setEnabled(!0))};Rr.on(xa.IOS_INTERRUPTION_END,t)}else G.debug("[".concat(this.getTrackId(),"] track ended")),this.safeEmit(Zu.TRACK_ENDED)}async renewMediaStreamTrack(t){const r=t||this._constraints,s=Fc.searchDeviceIdByName(this._deviceName);if(s&&!r.deviceId&&(r.deviceId={exact:s}),this._enabled){const l=await wl({video:r},this.getTrackId());this._constraints=r,await this._updateOriginMediaStreamTrack(l.getVideoTracks()[0],!0),this.updateMediaStreamTrackResolution()}}close(){super.close(),Rr.off(xa.IOS_15_16_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat),Rr.off(xa.IOS_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat)}clone(t){let r=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],s=this._encoderConfig;t&&(s=fi(fi({},s),Bo(t))),s=gr(s);const l=Br(8,"track-cam-cloned-"),f=new gce(r?this._mediaStreamTrack.clone():this._mediaStreamTrack,gr(fi(fi({},this._config),{},{encoderConfig:s})),gr(this._constraints),gr(this._scalabilityMode),this._optimizationMode,l);return t&&s&&f.setEncoderConfiguration(s),G.debug("clone track from ".concat(this.getTrackId()," to ").concat(l,", clone ").concat(r)),f}bindProcessorContextEvents(){this.processorContext.on(yo.REQUEST_UPDATE_CONSTRAINTS,async(t,r,s)=>{try{const l=Object.assign({},this._originalConstraints,...t);await this.renewMediaStreamTrack(l),r()}catch(l){s(l)}}),this.processorContext.on(yo.REQUEST_CONSTRAINTS,async t=>{t(this._originMediaStreamTrack.getSettings())})}},jn(Wi.prototype,"setDevice",[X3,rd],Object.getOwnPropertyDescriptor(Wi.prototype,"setDevice"),Wi.prototype),jn(Wi.prototype,"setEnabled",[Q3,Z3,$3],Object.getOwnPropertyDescriptor(Wi.prototype,"setEnabled"),Wi.prototype),jn(Wi.prototype,"setEncoderConfiguration",[eU,tU],Object.getOwnPropertyDescriptor(Wi.prototype,"setEncoderConfiguration"),Wi.prototype),jn(Wi.prototype,"close",[nU],Object.getOwnPropertyDescriptor(Wi.prototype,"close"),Wi.prototype),Wi);function V_(e,t,r,s){r.optimizationMode&&(s&&s.width&&s.height?(r.encoderConfig=fi(fi({},s),{},{bitrateMin:s.bitrateMin,bitrateMax:s.bitrateMax}),r.optimizationMode!=="motion"&&r.optimizationMode!=="detail"||(t.contentHint=r.optimizationMode,t.contentHint===r.optimizationMode?G.debug("[".concat(e,"] set content hint to"),r.optimizationMode):G.debug("[".concat(e,"] set content hint failed")))):G.warning("[".concat(e,"] can not apply optimization mode bitrate config, no encoderConfig")))}var zp,rU,A8,O8,Gc,iU,VL,BL,FL,aU,Hp,io;class gI extends xx{getUserId(){return this._userId}constructor(t,r,s,l){super(t,"track-".concat(t.kind,"-").concat(r,"-").concat(l.clientId,"_").concat(Br(5,""))),Pe(this,"_userId",void 0),Pe(this,"_uintId",void 0),Pe(this,"_isDestroyed",!1),Pe(this,"store",void 0),Pe(this,"processor",void 0),Pe(this,"processorContext",void 0),this._userId=r,this._uintId=s,this.store=l}_updateOriginMediaStreamTrack(t){this._originMediaStreamTrack=t,this._mediaStreamTrack=t,this._updatePlayerSource(),this.processor&&this.processor.updateInput({track:this._originMediaStreamTrack,context:this.processorContext})}_destroy(){this._isDestroyed=!0,G.info("[".concat(this.getTrackId(),"] is destroyed")),this.stop(),super.close()}getProcessorStats(){return this.processorContext.gatherStats()}getProcessorUsage(){return this.processorContext.gatherUsage()}}let xg=(zp=nn({argsMap:(e,t,r)=>[e.getTrackId(),typeof t=="string"?t:t instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement",r]}),rU=nn({argsMap:e=>[e.getTrackId()]}),A8=nn({argsMap:(e,t)=>[e.getTrackId(),t.name]}),O8=nn({argsMap:e=>[e.getTrackId()]}),jn((Gc=class extends gI{get isPlaying(){return!(!this._player||this._player.videoElementStatus!==Tn.PLAYING)}get __className__(){return"RemoteVideoTrack"}constructor(e,t,r,s){super(e,t,r,s),Pe(this,"_videoVisibleTimer",null),Pe(this,"_previousVideoVisibleStatus",void 0),Pe(this,"_clearPreviousVideoVisibleStatus",()=>this._previousVideoVisibleStatus=void 0),Pe(this,"trackMediaType",yl.VIDEO),Pe(this,"_videoWidth",void 0),Pe(this,"_videoHeight",void 0),Pe(this,"_player",void 0),Pe(this,"processorDestination",void 0),Pe(this,"processorContext",void 0),this.updateMediaStreamTrackResolution(),this.processorContext=new zx(this.getTrackId(),"remote"),this.processorDestination=new DL(this.processorContext),this.bindProcessorDestinationEvents()}getStats(){return ph(()=>{G.warning("[deprecated] RemoteVideoTrack.getStats will be removed in the future, use AgoraRTCClient.getRemoteVideoStats instead")},"remoteVideoTrackGetStatsWarning"),Gs(this,Dt.GET_STATS)||fi({},Xn)}play(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(typeof e=="string"){const s=document.getElementById(e);s?e=s:(G.warning("[".concat(this.getTrackId(),'] can not find "#').concat(e,'" element, use document.body')),e=document.body)}G.debug("[".concat(this.getTrackId(),"] start video playback in ").concat(e instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement"),JSON.stringify(t));const r=fi(fi({fit:"cover"},t),{},{trackId:this.getTrackId(),element:e});this._player?this._player.updateConfig(r):(e instanceof HTMLVideoElement?this._player=new xL(r):this._player=new A3(r),this._player.updateVideoTrack(this._mediaStreamTrack),this._player.onFirstVideoFrameDecoded=()=>{this.store.subscribe(this.getUserId(),"video",void 0,void 0,Date.now()),this.safeEmit(is.FIRST_FRAME_DECODED)},this._player.onVideoStateChanged=s=>{this.safeEmit(is.VIDEO_STATE_CHANGED,s)}),this._player.play(this.store.sessionId||void 0),this._videoVisibleTimer&&window.clearInterval(this._videoVisibleTimer),this._clearPreviousVideoVisibleStatus(),this._videoVisibleTimer=window.setInterval(()=>{try{const s=this.getVideoElementVisibleStatus();this.safeEmit(is.VIDEO_ELEMENT_VISIBLE_STATUS,s)}catch{}},me("CHECK_VIDEO_VISIBLE_INTERVAL"))}stop(){this._player&&(this._videoVisibleTimer&&(window.clearInterval(this._videoVisibleTimer),this._videoVisibleTimer=null),this._clearPreviousVideoVisibleStatus(),this._player.destroy(),this._player=void 0,G.debug("[".concat(this.getTrackId(),"] stop video playback")))}getCurrentFrameData(){return this._player?this._player.getCurrentFrame():new ImageData(2,2)}updateMediaStreamTrackResolution(){Yx(this._originMediaStreamTrack).then(e=>{let[t,r]=e;this._videoHeight=r,this._videoWidth=t}).catch(Dg)}_updatePlayerSource(){G.debug("[".concat(this.getTrackId(),"] update player source track")),this._player&&this._player.updateVideoTrack(this._mediaStreamTrack)}getVideoElementVisibleStatus(){try{var e,t;const r=this==null||(e=this._player)===null||e===void 0?void 0:e.getContainerElement(),s={track:this,element:this==null||(t=this._player)===null||t===void 0?void 0:t.getVideoElement(),slot:r==null?void 0:r.parentElement},{element:l,slot:f}=s;if(this.isPlaying&&l instanceof HTMLVideoElement&&f instanceof HTMLElement){const m=ur.checkOneElementVisible(l),E=Object.assign({},m);if(E.visible!==this._previousVideoVisibleStatus){this._previousVideoVisibleStatus=E.visible;const y=Vt.reportApiInvoke(null,{tag:Bn.TRACER,name:Di.REMOTE_VIDEO_TRACK_GET_VIDEO_VISIBLE,options:[this.getTrackId()]});E.visible?y.onSuccess("Video is visible"):y.onSuccess("Invisible because of ".concat(E.reason))}return E}return}catch(r){throw new Ke(se.GET_VIDEO_ELEMENT_VISIBLE_ERROR,r.message)}}pipe(e){if(this.processor===e)return e;if(e._source)throw new Ke(se.INVALID_OPERATION,"Processor ".concat(e.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=e,this.processor._source=this,e.updateInput({track:this._originMediaStreamTrack,context:this.processorContext}),e}unpipe(){if(!this.processor)return;const e=this.processor;this.processor._source=void 0,this.processor=void 0,e.reset()}bindProcessorDestinationEvents(){this.processorDestination.on(So.ON_TRACK,async e=>{e?e!==this._mediaStreamTrack&&(this._mediaStreamTrack=e,this._updatePlayerSource()):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource())})}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(So.ON_TRACK)}_destroy(){super._destroy(),this.unbindProcessorDestinationEvents()}_onSei(e){this.emit(Eh.SEI_RECEIVED,e)}}).prototype,"play",[zp],Object.getOwnPropertyDescriptor(Gc.prototype,"play"),Gc.prototype),jn(Gc.prototype,"stop",[rU],Object.getOwnPropertyDescriptor(Gc.prototype,"stop"),Gc.prototype),jn(Gc.prototype,"pipe",[A8],Object.getOwnPropertyDescriptor(Gc.prototype,"pipe"),Gc.prototype),jn(Gc.prototype,"unpipe",[O8],Object.getOwnPropertyDescriptor(Gc.prototype,"unpipe"),Gc.prototype),Gc),$u=(iU=nn({argsMap:(e,t)=>[e.getTrackId(),t],throttleTime:300}),VL=nn({argsMap:(e,t)=>[e.getTrackId(),t]}),BL=nn({argsMap:e=>[e.getTrackId()]}),FL=nn({argsMap:e=>[e.getTrackId()]}),aU=nn({argsMap:(e,t)=>[e.getTrackId(),t.name]}),Hp=nn({argsMap:e=>[e.getTrackId()]}),jn((io=class extends gI{get isPlaying(){return this._useAudioElement?dc.isPlaying(this.getTrackId()):this._source.isPlayed}get __className__(){return"RemoteAudioTrack"}constructor(e,t,r,s){super(e,t,r,s),Pe(this,"trackMediaType",yl.AUDIO),Pe(this,"_source",void 0),Pe(this,"_useAudioElement",!0),Pe(this,"_volume",100),Pe(this,"processorContext",void 0),Pe(this,"processorDestination",void 0),Pe(this,"_played",!1),Pe(this,"_bypassWebAudio",!1),me("DISABLE_WEBAUDIO")?(this._source=new PL,this._bypassWebAudio=!0,this._useAudioElement=!0):(this._source=new LL(e,!0),me("REMOTE_AUDIO_TRACK_USES_WEB_AUDIO")&&(this._useAudioElement=!1)),this._source.once(Vc.RECEIVE_TRACK_BUFFER,()=>{this.safeEmit(is.FIRST_FRAME_DECODED)}),this.processorContext=new Wx(this._source.context,this.getTrackId(),"remote"),this.processorDestination=new Hx(this.processorContext),this.bindProcessorDestinationEvents(),this._source.on(Vc.UPDATE_SOURCE,()=>{this.processor&&this.processor.updateInput({node:this._source.processSourceNode,context:this.processorContext})})}setAudioFrameCallback(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4096;if(!e)return this._source.removeAllListeners(Vc.ON_AUDIO_BUFFER),void this._source.stopGetAudioBuffer();this._source.startGetAudioBuffer(t),this._source.removeAllListeners(Vc.ON_AUDIO_BUFFER),this._source.on(Vc.ON_AUDIO_BUFFER,r=>e(r))}setVolume(e){this._volume=e,this._useAudioElement?dc.setVolume(this.getTrackId(),e):this._source.setVolume(e/100)}async setPlaybackDevice(e){if(!this._useAudioElement||!uI())throw new Ke(se.NOT_SUPPORTED,"your browser does not support setting the audio output device");await dc.setSinkID(this.getTrackId(),e)}getVolumeLevel(){return this._source.getAccurateVolumeLevel()}getStats(){return ph(()=>{G.warning("[deprecated] RemoteAudioTrack.getStats will be removed in the future, use AgoraRTCClient.getRemoteAudioStats instead")},"remoteAudioTrackGetStatsWarning"),Gs(this,Dt.GET_STATS)||fi({},ui)}play(){G.debug("[".concat(this.getTrackId(),"] start audio playback")),this._played=!0,this._useAudioElement?(G.debug("[".concat(this.getTrackId(),"] use audio element to play")),dc.play(this._mediaStreamTrack,this.getTrackId(),this._volume,this.store.sessionId||void 0)):this._source.play()}stop(){G.debug("[".concat(this.getTrackId(),"] stop audio playback")),this._played=!1,this._useAudioElement?dc.stop(this.getTrackId()):this._source.stop()}_destroy(){super._destroy(),this._played=!1,this.unbindProcessorDestinationEvents(),this._source.destroy()}_isFreeze(){return this._source.isFreeze}_updatePlayerSource(){let e=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];G.debug("[".concat(this.getTrackId(),"] update player source track")),e&&this._source.updateTrack(this._mediaStreamTrack),this._useAudioElement&&dc.updateTrack(this.getTrackId(),this._mediaStreamTrack)}pipe(e){if(this._bypassWebAudio)throw new Ke(se.NOT_SUPPORTED,"can not pipe extension when WebAudio disabled");if(this.processor===e)return e;if(e._source)throw new Ke(se.INVALID_OPERATION,"Processor ".concat(e.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=e,this.processor._source=this,e.updateInput({track:this._originMediaStreamTrack,node:this._source.processSourceNode,context:this.processorContext}),e}unpipe(){var e;if(this._bypassWebAudio)throw new Ke(se.NOT_SUPPORTED,"can not unpipe extension when WebAudio disabled");if(!this.processor)return;const t=this.processor;(e=this._source.processSourceNode)===null||e===void 0||e.disconnect(),this.processor._source=!1,this.processor=void 0,t.reset()}bindProcessorDestinationEvents(){this.processorDestination.on(So.ON_TRACK,async e=>{e?e!==this._mediaStreamTrack&&(this._mediaStreamTrack=e,this._updatePlayerSource(!1),this._source.processedNode=this._source.createMediaStreamSourceNode(e)):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource())}),this.processorDestination.on(So.ON_NODE,e=>{this._source.processedNode=e;const t=!e;this._useAudioElement!==t&&(this._played?(this.stop(),this._useAudioElement=t,this.play()):this._useAudioElement=t)})}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(So.ON_TRACK),this.processorDestination.removeAllListeners(So.ON_NODE)}}).prototype,"setVolume",[iU],Object.getOwnPropertyDescriptor(io.prototype,"setVolume"),io.prototype),jn(io.prototype,"setPlaybackDevice",[VL],Object.getOwnPropertyDescriptor(io.prototype,"setPlaybackDevice"),io.prototype),jn(io.prototype,"play",[BL],Object.getOwnPropertyDescriptor(io.prototype,"play"),io.prototype),jn(io.prototype,"stop",[FL],Object.getOwnPropertyDescriptor(io.prototype,"stop"),io.prototype),jn(io.prototype,"pipe",[aU],Object.getOwnPropertyDescriptor(io.prototype,"pipe"),io.prototype),jn(io.prototype,"unpipe",[Hp],Object.getOwnPropertyDescriptor(io.prototype,"unpipe"),io.prototype),io);const ef=new class extends Xt{get visibility(){return document.visibilityState}get lastHiddenTime(){return this._lastHiddenTime}get lastVisibleTime(){return this._lastVisibleTime}constructor(){super(),Pe(this,"_lastHiddenTime",0),Pe(this,"_lastVisibleTime",0),document.addEventListener("visibilitychange",()=>{document.visibilityState==="hidden"?this._lastHiddenTime=performance.now():this._lastVisibleTime=performance.now(),G.debug("current web page is ".concat(document.visibilityState)),this.emit("VISIBILITY_CHANGE",document.visibilityState)})}};class _I extends Xt{constructor(t,r){super(),Pe(this,"trackMediaType",yl.DATA),Pe(this,"_version",1),Pe(this,"_type",3),Pe(this,"_config",void 0),Pe(this,"_originDataChannel",void 0),Pe(this,"_dataStreamPacketHeader",new ArrayBuffer(4)),Pe(this,"_dataStreamPacketHandler",{serialize:s=>s,deserialize:s=>s}),Pe(this,"_datachannelEventMap",new Map),this._config=t,r&&(this._originDataChannel=r,this._bandDataChannelEvents(r)),this._initPacketHeader()}useDataStream(t){this._dataStreamPacketHandler=t}get id(){return this._config.id}get ordered(){return this._config.ordered}get maxRetransmits(){return me("DATASTREAM_MAX_RETRANSMITS")}get metadata(){return this._config.metadata}get readyState(){var t,r;return(t=(r=this._originDataChannel)===null||r===void 0?void 0:r.readyState)!==null&&t!==void 0?t:"connecting"}get _originDataChannelId(){var t,r;return(t=(r=this._originDataChannel)===null||r===void 0?void 0:r.id)!==null&&t!==void 0?t:null}getChannelId(){return this.id}getConfig(){return this._config}_close(){this._originDataChannel&&(this._unbindDataChannelEvents(this._originDataChannel),this._originDataChannel=void 0)}async _waitTillOpen(){return new gt((t,r)=>{if(this._originDataChannel){this._originDataChannel.readyState==="open"&&t();const s=setTimeout(()=>{var l;r(new Ke(se.DATACHANNEL_CONNECTION_TIMEOUT,"Cannot create datachannel, id: ".concat((l=this._originDataChannel)===null||l===void 0?void 0:l.id)))},1e4);this._originDataChannel.onopen=()=>{clearTimeout(s),this._originDataChannel&&this._bandDataChannelEvents(this._originDataChannel),t()},this._originDataChannel.onerror=()=>{throw clearTimeout(s),new Ke(se.DATACHANNEL_CONNECTION_TIMEOUT)}}else r(new Ke(se.DATACHANNEL_CONNECTION_TIMEOUT,"cannot find dataChannel"))})}_updateOriginDataChannel(t){this._originDataChannel=t,this._bandDataChannelEvents(t)}_initPacketHeader(){const t=new DataView(this._dataStreamPacketHeader);t.setUint16(0,this._version),t.setUint8(2,this._type),t.setUint8(3,this._config.id)}_bandDataChannelEvents(t){this._unbindDataChannelEvents(t),[Zb.OPEN,Zb.CLOSE,Zb.ERROR].forEach(r=>{const s=()=>{this.emit(r)};this._datachannelEventMap.set(r,s),t.addEventListener(r,s)})}_unbindDataChannelEvents(t){Array.from(this._datachannelEventMap.entries()).forEach(r=>{let[s,l]=r;t.removeEventListener(s,l)}),this._datachannelEventMap.clear()}}class sU extends _I{constructor(t){super(t),Pe(this,"_messageListener",void 0),this._messageListener=r=>{if(r.data.byteLength<this._dataStreamPacketHeader.byteLength)throw Error("invalid byteLength: the byte length must exceed "+this._dataStreamPacketHeader.byteLength);const s=r.data.slice(0,this._dataStreamPacketHeader.byteLength),l=new DataView(s).getUint8(3);if(l!==this.id)return void(me("SHOW_DATASTREAM2_LOG")&&G.debug("invalid datachannel id: ".concat(l," !== ").concat(this.id)));let f=r.data.slice(this._dataStreamPacketHeader.byteLength);f=this._dataStreamPacketHandler.deserialize(f),this.emit(Zb.MESSAGE,f)}}_updateOriginDataChannel(t){super._updateOriginDataChannel(t),this._bandRemoteDataChannelEvents()}_close(){this._originDataChannel&&(this._originDataChannel.removeEventListener("message",this._messageListener),super._close())}_bandRemoteDataChannelEvents(){this._originDataChannel&&this._originDataChannel.addEventListener("message",this._messageListener)}}class N8 extends _I{send(t){if(this._originDataChannel){let r=t;r=this._dataStreamPacketHandler.serialize(t);const s=new Uint8Array(this._dataStreamPacketHeader.byteLength+r.byteLength);s.set(new Uint8Array(this._dataStreamPacketHeader),0),s.set(new Uint8Array(r),this._dataStreamPacketHeader.byteLength),this._originDataChannel.send(s.buffer)}}}function GL(){const e=new Blob([atob("ZnVuY3Rpb24gdCh0LGUsbil7bGV0IGE9bmV3IFVpbnQ4QXJyYXkodCxlLG4pLG89W10scj0wO2Zvcig7by5sZW5ndGg8bjspciszPG4mJjA9PT1hW3JdJiYwPT09YVtyKzFdJiYzPT09YVtyKzJdJiYoMD09PWFbciszXXx8MT09PWFbciszXXx8Mj09PWFbciszXXx8Mz09PWFbciszXSk/KG8ucHVzaChhW3JdLGFbcisxXSxhW3IrM10pLHIrPTQpOihvLnB1c2goYVtyXSkscisrKTtyZXR1cm4gbmV3IFVpbnQ4QXJyYXkobyl9ZnVuY3Rpb24gZSh0LGUpe2NvbnN0IG49ZnVuY3Rpb24odCl7Y29uc3QgZT10Lmxlbmd0aDtsZXQgbj1bXSxhPTA7Zm9yKDthPGU7KWErMjxlJiYwPT09dFthXSYmMD09PXRbYSsxXSYmKDA9PT10W2ErMl18fDE9PT10W2ErMl18fDI9PT10W2ErMl18fDM9PT10W2ErMl0pPyhuLnB1c2godFthXSx0W2ErMV0sMyx0W2ErMl0pLGErPTMpOihuLnB1c2godFthXSksYSsrKTtyZXR1cm4gbmV3IFVpbnQ4QXJyYXkobil9KGUpLGE9bi5sZW5ndGgsbz1NYXRoLmZsb29yKGEvMjU1KSxyPWElMjU1LHM9bmV3IFVpbnQ4QXJyYXkoNitvKzErYSt0LmJ5dGVMZW5ndGgpO3NbMF09MCxzWzFdPTAsc1syXT0wLHNbM109MSxzWzRdPTYsc1s1XT0xMDE7bGV0IGk9MDtmb3IoO2k8bzspc1s2K2ldPTI1NSxpKys7cmV0dXJuIHNbNitpXT1yLGkrKyxzLnNldChuLDYraSkscy5zZXQobmV3IFVpbnQ4QXJyYXkodCksNitpK2EpLHMuYnVmZmVyfWNvbnN0IG49NzEsYT0xLG89MixyPTEscz0yO3ZhciBpOyFmdW5jdGlvbih0KXt0W3QuQVVESU9fTEVWRUw9MV09IkFVRElPX0xFVkVMIix0W3QuTUVUQURBVEE9Ml09Ik1FVEFEQVRBIix0W3QuQVVESU9fNjRfQklUX1BUUz0zXT0iQVVESU9fNjRfQklUX1BUUyJ9KGl8fChpPXt9KSk7bmF2aWdhdG9yLnVzZXJBZ2VudC5pbmRleE9mKCJTYWZhcmkiKT4tMSYmLTE9PT1uYXZpZ2F0b3IudXNlckFnZW50LmluZGV4T2YoIkNocm9tZSIpJiYoc2VsZi5vbnJ0Y3RyYW5zZm9ybT1mPT57Y29uc3QgdT1mLnRyYW5zZm9ybWVyO2xldCBkPVtdLGw9W107dS5vcHRpb25zLnBvcnQub25tZXNzYWdlPXQ9Pnt0LmRhdGEuc2VpJiZkLnB1c2godC5kYXRhLnNlaSksdC5kYXRhLm1ldGFkYXRhJiZsLnB1c2godC5kYXRhLm1ldGFkYXRhKX0sc2VsZi5wb3N0TWVzc2FnZSgic3RhcnRlZCIpO2NvbnN0IGc9dS5yZWFkYWJsZS5nZXRSZWFkZXIoKSxjPXUud3JpdGFibGUuZ2V0V3JpdGVyKCk7InNlaS1yeCI9PT11Lm9wdGlvbnMubmFtZT9mdW5jdGlvbiBlKG4pe2cucmVhZCgpLnRoZW4oKGE9PntpZighYS5kb25lKXtpZihhLnZhbHVlIGluc3RhbmNlb2YgUlRDRW5jb2RlZFZpZGVvRnJhbWUpe2NvbnN0IGU9ZnVuY3Rpb24oZSl7Y29uc3Qgbj1uZXcgRGF0YVZpZXcoZS5kYXRhKTtsZXQgYT0wO2Zvcig7YSs0PGUuZGF0YS5ieXRlTGVuZ3RoOyl7aWYoMD09PW4uZ2V0VWludDgoYSswKSYmMD09PW4uZ2V0VWludDgoYSsxKSYmMD09PW4uZ2V0VWludDgoYSsyKSYmMT09PW4uZ2V0VWludDgoYSszKSYmNj09PW4uZ2V0VWludDgoYSs0KSl7bGV0IG89YSs2LHI9MCxzPTA7Zm9yKDsyNTU9PT0ocz1uLmdldFVpbnQ4KG8rKykpOylyKz0yNTU7cis9cztjb25zdCBpPXQoZS5kYXRhLG8scik7cmV0dXJuIG5ldyBVaW50OEFycmF5KGkpfWErK31yZXR1cm4gbnVsbH0oYS52YWx1ZSk7ZSYmbi5vcHRpb25zLnBvcnQucG9zdE1lc3NhZ2Uoe3NlaTplfSl9Yy53cml0ZShhLnZhbHVlKSxuLm9wdGlvbnMucG9ydC5wb3N0TWVzc2FnZSh7dHJhbnNmb3JtZWQ6ITB9KSxlKG4pfX0pKX0odSk6InNlaS10eCI9PT11Lm9wdGlvbnMubmFtZT9mdW5jdGlvbiB0KG4pe2cucmVhZCgpLnRoZW4oKGE9PntpZighYS5kb25lKXtpZihhLnZhbHVlIGluc3RhbmNlb2YgUlRDRW5jb2RlZFZpZGVvRnJhbWUpe2NvbnN0IHQ9ZC5zaGlmdCgpO3QmJihhLnZhbHVlLmRhdGE9ZShhLnZhbHVlLmRhdGEsdCkpfWMud3JpdGUoYS52YWx1ZSksbi5vcHRpb25zLnBvcnQucG9zdE1lc3NhZ2Uoe3RyYW5zZm9ybWVkOiEwfSksdChuKX19KSl9KHUpOiJhdWRpby1tZXRhZGF0YS1yeCI9PT11Lm9wdGlvbnMubmFtZT9mdW5jdGlvbiB0KGUpe2cucmVhZCgpLnRoZW4oKGY9PntpZighZi5kb25lKXtpZihmLnZhbHVlIGluc3RhbmNlb2YgUlRDRW5jb2RlZEF1ZGlvRnJhbWUpe2NvbnN0IHQ9ZnVuY3Rpb24odCxlPSExKXtjb25zdCBmPXQuZ2V0VWludDgoMCk7aWYoZiE9PW4pcmV0dXJuO2NvbnN0IHU9dC5nZXRVaW50MTYoMSksZD1hK28rdSxsPW5ldyBVaW50OEFycmF5KHQuYnl0ZUxlbmd0aC1kKTtsLnNldChuZXcgVWludDhBcnJheSh0LmJ1ZmZlcixkLHQuYnl0ZUxlbmd0aC1kKSk7Y29uc3QgZz17bTpmLHRsdkxlbjp1LHRsdjpbXSxmcmFtZTpsfTtsZXQgYz1hK287Zm9yKDtjPGQ7KXtjb25zdCBuPXQuZ2V0VWludDgoYyksYT10LmdldFVpbnQxNihjK3IpLG89citzO2lmKG49PT1pLkFVRElPX0xFVkVMKXtsZXQgcj10LmdldFVpbnQ4KGMrbyk7Zm9yKGxldCBlPTE7ZTxhO2UrKylyPXI8PDh8dC5nZXRVaW50OChjK28rZSk7Zy50bHYucHVzaCh7dGFnOm4sbGVuZ3RoOmEsdmFsdWU6ZT8xMjdecj4+MToxMjcmcn0pfWVsc2UgaWYobj09PWkuTUVUQURBVEF8fG49PT1pLkFVRElPXzY0X0JJVF9QVFMpe2NvbnN0IGU9bmV3IFVpbnQ4QXJyYXkoYSk7Zm9yKGxldCBuPTA7bjxhO24rKyllW25dPXQuZ2V0VWludDgoYytvK24pO2cudGx2LnB1c2goe3RhZzpuLGxlbmd0aDphLHZhbHVlOmV9KX1jKz1vK2F9cmV0dXJuIGd9KG5ldyBEYXRhVmlldyhmLnZhbHVlLmRhdGEpKTtpZih0KXtjb25zdCBuPXQudGx2LmZpbmQoKHQ9PnQudGFnPT09aS5NRVRBREFUQXx8dC50YWc9PT1pLkFVRElPXzY0X0JJVF9QVFMpKTtuJiZuLnZhbHVlIGluc3RhbmNlb2YgVWludDhBcnJheSYmZS5vcHRpb25zLnBvcnQucG9zdE1lc3NhZ2Uoe21ldGFkYXRhOm4udmFsdWV9KSxmLnZhbHVlLmRhdGE9dC5mcmFtZS5idWZmZXJ9fWMud3JpdGUoZi52YWx1ZSksZS5vcHRpb25zLnBvcnQucG9zdE1lc3NhZ2Uoe3RyYW5zZm9ybWVkOiEwfSksdChlKX19KSl9KHUpOiJhdWRpby1tZXRhZGF0YS10eCI9PT11Lm9wdGlvbnMubmFtZSYmZnVuY3Rpb24gdChlKXtnLnJlYWQoKS50aGVuKChmPT57aWYoIWYuZG9uZSl7aWYoZS5vcHRpb25zLnBvcnQucG9zdE1lc3NhZ2Uoe2dldE1ldGFkYXRhOiEwfSksZi52YWx1ZSBpbnN0YW5jZW9mIFJUQ0VuY29kZWRBdWRpb0ZyYW1lKXtjb25zdCB0PWwuc2hpZnQoKTt0JiYoZi52YWx1ZS5kYXRhPWZ1bmN0aW9uKHQsZSxpKXtjb25zdCBmPWkuYnl0ZUxlbmd0aCx1PWYrcitzLGQ9YStvK3UsbD1uZXcgQXJyYXlCdWZmZXIodC5ieXRlTGVuZ3RoK2QpLGc9bmV3IERhdGFWaWV3KGwpO2cuc2V0VWludDgoMCxuKSxnLnNldFVpbnQxNigxLHUpLGcuc2V0VWludDgoMyxlKSxnLnNldFVpbnQxNig0LGYpO2ZvcihsZXQgdD0wO3Q8Zjt0KyspZy5zZXRVaW50OCg2K3QsaVt0XSk7Y29uc3QgYz1uZXcgVWludDhBcnJheShnLmJ1ZmZlcik7cmV0dXJuIGMuc2V0KG5ldyBVaW50OEFycmF5KHQpLGQpLGMuYnVmZmVyfShmLnZhbHVlLmRhdGEsaS5BVURJT182NF9CSVRfUFRTLHQpKX1jLndyaXRlKGYudmFsdWUpLGUub3B0aW9ucy5wb3J0LnBvc3RNZXNzYWdlKHt0cmFuc2Zvcm1lZDohMH0pLHQoZSl9fSkpfSh1KX0sc2VsZi5wb3N0TWVzc2FnZSgicmVnaXN0ZXJlZCIpKTsK")],{type:"text/javascript"});return setTimeout(()=>aN.revokeObjectURL(e),0),new Worker(aN.createObjectURL(e))}const oU=71,cU=1,EI=2,lU=1,OS=2;var To=function(e){return e[e.AUDIO_LEVEL=1]="AUDIO_LEVEL",e[e.METADATA=2]="METADATA",e[e.AUDIO_64_BIT_PTS=3]="AUDIO_64_BIT_PTS",e}(To||{});function vI(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];const r=e.getUint8(0);if(r!==oU)return;const s=e.getUint16(1),l=cU+EI+s,f=new Uint8Array(e.byteLength-l);f.set(new Uint8Array(e.buffer,l,e.byteLength-l));const m={m:r,tlvLen:s,tlv:[],frame:f};let E=cU+EI;for(;E<l;){const y=e.getUint8(E),b=e.getUint16(E+lU),A=lU+OS;if(y===To.AUDIO_LEVEL){let O=e.getUint8(E+A);for(let D=1;D<b;D++)O=O<<8|e.getUint8(E+A+D);m.tlv.push({tag:y,length:b,value:t?127^O>>1:127&O})}else if(y===To.METADATA||y===To.AUDIO_64_BIT_PTS){const O=new Uint8Array(b);for(let D=0;D<b;D++)O[D]=e.getUint8(E+A+D);m.tlv.push({tag:y,length:b,value:O})}E+=A+b}return m}const SI=new Map,Wp=127,uc=1e-10,n1=139/13,zL=new Map;function r1(e,t,r){const s="".concat(e,"-").concat(t,"-").concat(r);let l=0;return zL.has(s)?l=zL.get(s):(l=Math.log(function(m,E){const y=m-E;E<y&&(E=y);let b=1;for(let A=m,O=1;A>E;A--,O++)b=b*A/O;return b}(t,e))+e*Math.log(.5)+(t-e)*Math.log(1-.5)-Math.log(r)+r*e,zL.set(s,l)),l<uc&&(l=uc),l}function dU(e,t,r){const s=t.length,l=e.length/s;let f=!1;for(let m=0,E=0;m<s;m++){let y=0;for(let b=E+l;E<b;E++)e[E]>r&&y++;t[m]!==y&&(t[m]=y,f=!0)}return f}window.cache=zL;let HL=0;class L8{constructor(t){Pe(this,"id",void 0),Pe(this,"immediates",[]),Pe(this,"lastNonSilence",-1),Pe(this,"immediateSpeechActivityScore",uc),Pe(this,"lastLevelChangedTime",Date.now()),Pe(this,"levels",[]),Pe(this,"longs",[]),Pe(this,"longSpeechActivityScore",uc),Pe(this,"mediums",[]),Pe(this,"mediumSpeechActivityScore",uc),Pe(this,"minLevel",0),Pe(this,"nextMinLevel",0),Pe(this,"nextMinLevelWindowLength",0),Pe(this,"energyScore",0),this.id=t||"".concat(HL++),this.immediates.length=50,this.mediums.length=10,this.longs.length=1,this.levels.length=this.immediates.length}computeImmediates(){const t=this.immediates,r=this.levels,s=this.minLevel+n1;let l=!1;for(let f=0;f<t.length;++f){let m=r[f];m<s&&(m=0);const E=Math.floor(m/n1);t[f]!==E&&(t[f]=E,l=!0)}return l}computeLongs(){return dU(this.mediums,this.longs,4)}computeMediums(){return dU(this.immediates,this.mediums,7)}evaluateImmediateSpeechActivityScore(){this.immediateSpeechActivityScore=r1(this.immediates[0],13,.78)}evaluateLongSpeechActivityScore(t){this.longSpeechActivityScore=r1(this.longs[0],10,47),this.longSpeechActivityScore>uc&&(this.lastNonSilence=t)}evaluateMediumSpeechActivityScore(){this.mediumSpeechActivityScore=r1(this.mediums[0],5,24)}evaluateSpeechActivityScores(t){this.computeImmediates()&&(this.evaluateImmediateSpeechActivityScore(),this.computeMediums()&&(this.evaluateMediumSpeechActivityScore(),this.computeLongs()&&this.evaluateLongSpeechActivityScore(t)))}getLastLevelChangedTime(){return this.lastLevelChangedTime}getLevels(){var t;return"[".concat(Hy(t=[...this.levels]).call(t).join(),"]")}getSpeechActivityScore(t){switch(t){case 0:return this.immediateSpeechActivityScore;case 1:return this.mediumSpeechActivityScore;case 2:return this.longSpeechActivityScore;default:throw new Error("interval "+t)}}levelChanged(t,r){if(this.lastLevelChangedTime<=r){this.lastLevelChangedTime=r;let s=t;return t<0&&(s=0),t>Wp&&(s=Wp),this.levels.unshift(s),this.levels.length>this.immediates.length&&this.levels.pop(),this.updateMinLevel(s),s>=this.minLevel+n1?s:s/2}return-1}levelTimedOut(){this.levelChanged(0,this.lastLevelChangedTime)}updateMinLevel(t){if(t!==0){if(this.minLevel===0||this.minLevel>t)return this.minLevel=t,this.nextMinLevel=0,void(this.nextMinLevelWindowLength=0);if(this.nextMinLevel===0)return this.nextMinLevel=t,void(this.nextMinLevelWindowLength=1);if(this.nextMinLevel>t&&(this.nextMinLevel=t),this.nextMinLevelWindowLength++,this.nextMinLevelWindowLength>=750){let r=Math.sqrt(this.minLevel*this.nextMinLevel);r<0?r=0:r>Wp&&(r=Wp),this.minLevel=r,this.nextMinLevel=0,this.nextMinLevelWindowLength=0}}}}class hY{constructor(t){Pe(this,"algorithm",void 0),this.algorithm=t}execute(){let t=!this.algorithm;if(!t)try{const r=this.algorithm.runInDecisionMaker(this);r<=0?t=!0:setTimeout(this.execute.bind(this),r)}catch{t=!0}t&&this.algorithm&&this.algorithm.decisionMakerExited(this)}}class i1{constructor(t,r,s){Pe(this,"isDominant",void 0),Pe(this,"energyRanking",void 0),Pe(this,"energyScore",void 0),this.isDominant=t,this.energyRanking=r,this.energyScore=s}}class yI extends Xt{constructor(t){super(),Pe(this,"dominantId",null),Pe(this,"lastDecisionTime",0),Pe(this,"lastLevelChangedTime",0),Pe(this,"lastLevelIdleTime",0),Pe(this,"relativeSpeechActivities",[]),Pe(this,"speakers",new Map),Pe(this,"enableSilence",!1),Pe(this,"timeoutToSilenceInterval",0),Pe(this,"decisionMaker",null),Pe(this,"loudest",[]),Pe(this,"numLoudestToTrack",3),Pe(this,"energyExpireTimeMs",250),Pe(this,"energyAlphaPct",50),this.timeoutToSilenceInterval=t,this.enableSilence=t>0,this.relativeSpeechActivities.length=3}setLoudestConfig(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:3,r=arguments.length>1?arguments[1]:void 0,s=arguments.length>2?arguments[2]:void 0;this.numLoudestToTrack=t,r!=null&&(this.energyExpireTimeMs=r),s!=null&&(this.energyAlphaPct=s),this.loudest.length>t&&this.loudest.splice(t)}getDominantSpeaker(){return this.dominantId}isAmongLoudest(t){return this.loudest.some(r=>r.id===t)}levelChanged(t,r){const s=Date.now(),l=this.getOrCreateSpeaker(t);this.lastLevelChangedTime<s&&(this.lastLevelChangedTime=s,this.maybeStartDecisionMaker());const f=l.levelChanged(r,s);return this.updateLoudestList(l,f,s)}runInDecisionMaker(t){return this.decisionMaker!==t||this.lastDecisionTime>0&&this.lastDecisionTime-this.lastLevelChangedTime>=15e3?-1:this._runInDecisionMaker()}decisionMakerExited(t){this.decisionMaker===t&&(this.decisionMaker=null)}destroy(){this.decisionMaker=null,this.loudest.length=0,this.speakers.clear(),this.removeAllListeners()}addSpeakers(t){t.forEach(r=>{this.speakers.has(r.id)||this.speakers.set(r.id,r)})}removeSpeakers(t){t.forEach(r=>{this.speakers.delete(r.id)})}getOrCreateSpeaker(t){let r=this.speakers.get(t);return r||(r=new L8(t),this.speakers.set(t,r),this.maybeStartDecisionMaker()),r}updateLoudestList(t,r,s){const l=t.id===this.dominantId;if(r<0){let y=0;for(;y<this.loudest.length&&this.loudest[y]!==t;)++y;return new i1(l,y,t.energyScore)}if(t.energyScore=Math.floor((this.energyAlphaPct*r+(100-this.energyAlphaPct)*t.energyScore+50)/100),this.numLoudestToTrack===0)return new i1(l,0,t.energyScore);const f=s-this.energyExpireTimeMs;let m=0;for(;m<this.loudest.length;){const y=this.loudest[m];if(y.getLastLevelChangedTime()<f&&this.loudest.length>=this.numLoudestToTrack)this.loudest.splice(m,1);else if(y.id!==t.id)++m;else if(this.loudest.splice(m,1),this.loudest.length<this.numLoudestToTrack)break}let E=0;for(;E<this.loudest.length&&!(this.loudest[E].energyScore<t.energyScore);)++E;return E<this.numLoudestToTrack&&(this.loudest.splice(E,0,t),this.loudest.length>this.numLoudestToTrack&&this.loudest.splice(this.numLoudestToTrack,1)),new i1(l,E,t.energyScore)}maybeStartDecisionMaker(){!this.decisionMaker&&this.speakers.size>0&&(this.decisionMaker=new hY(this),this.decisionMaker.execute())}makeDecision(t){let r=null,s=null;const l=this.speakers.size;let f=null;if(l===0)f=null;else if(l===1){var m;const E=oc(m=this.speakers).call(m).next().value;this.enableSilence&&E&&(f=E.id,E.evaluateSpeechActivityScores(t),t-E.lastNonSilence>this.timeoutToSilenceInterval&&(f=null))}else{let E=this.dominantId==null?null:this.speakers.get(this.dominantId);if(E==null){const A=this.speakers.entries().next();A.value&&(f=A.value[0],E=A.value[1])}else f=E.id;E!=null&&E.evaluateSpeechActivityScores(t);const y=this.relativeSpeechActivities;let b=2;for(const A of this.speakers.entries()){const[O,D]=A;if(D===E)continue;D.evaluateSpeechActivityScores(t);for(let Y=0;Y<y.length;++Y){const $=E==null?uc:E.getSpeechActivityScore(Y);y[Y]=Math.log(D.getSpeechActivityScore(Y)/$)}const P=y[0],F=y[1],B=y[2];P>3&&F>2&&B>0&&F>b&&(b=F,f=O)}this.enableSilence&&E!=null&&f===E.id&&t-E.lastNonSilence>this.timeoutToSilenceInterval&&(f=null)}f==null&&!this.enableSilence||f===this.dominantId||(r=this.dominantId,this.dominantId=f,s=this.dominantId),s==null&&!this.enableSilence||s===r||this.emit("ActiveSpeakerChanged",s)}_runInDecisionMaker(){const t=Date.now(),r=300-(t-this.lastLevelIdleTime);let s=0;r<=0?(this.lastLevelIdleTime!==0&&this.timeoutIdleLevels(t),this.lastLevelIdleTime=t):s=r;let l=300-(t-this.lastDecisionTime);return l<=0&&(this.lastDecisionTime=t,this.makeDecision(t),l=300-(Date.now()-t)),l>0&&s>l&&(s=l),s}timeoutIdleLevels(t){const r=[];for(const l of oc(s=this.speakers).call(s)){var s;const f=t-l.getLastLevelChangedTime();36e5<f&&(this.dominantId==null||l.id!==this.dominantId)?r.push(l.id):300<f&&l.levelTimedOut()}r.forEach(l=>this.speakers.delete(l))}}const a1=new Map;let tf=null,Yp=null;const NS=3;let eu=[];const tu=new Map,WL=new Map;class D8{get samples(){return this.actives+this.inactives}get activeRate(){return this.actives/this.samples}constructor(t,r){Pe(this,"id",void 0),Pe(this,"track",void 0),Pe(this,"score",0),Pe(this,"active",!0),Pe(this,"muted",!1),Pe(this,"timer",0),Pe(this,"actives",0),Pe(this,"inactives",0),this.id=t,this.track=r,this.setActive(tu.size<3)}autoCheckActive(){this.autoSetActive(),this.autoAdjustActive(),this.resetTimer(),this.actives=0,this.inactives=0}autoSetActive(){const t=this.active;this.active=this.activeRate>=.8;const{actives:r,inactives:s}=function(){const l=[],f=[];return Array.from(oc(tu).call(tu)).forEach(m=>{m.active?l.push(m):f.push(m)}),{actives:l,inactives:f}}();if(r.length>3){let l;r.forEach(f=>{(!l||l.score>f.score)&&(l=f)}),l&&l.setActive(!1)}if(r.length<3&&s.length>0){let l;s.forEach(f=>{(!l||l.score<f.score)&&f.id!==this.id&&(l=f)}),l&&t&&!this.active&&(l.samples>40&&l.activeRate-this.activeRate>.4?l.setActive(!0):this.active=!0)}this.setMuted(!this.active)}setActive(t){this.active=t,this.resetTimer(),this.setMuted(!t)}autoAdjustActive(){this.active?this.autoSwitchToInactive():this.autoSwitchToActive()}autoSwitchToActive(){const t=function(r){let s;return Array.from(oc(tu).call(tu)).forEach(l=>{!l.active||l.id===r||l.samples<40||(!s||l.score<s.score)&&(s=l)}),s}(this.id);t&&this.activeRate-t.activeRate>.4&&(t.setActive(!1),this.setActive(!0))}autoSwitchToInactive(){const t=function(r){let s;return Array.from(oc(tu).call(tu)).forEach(l=>{l.active||l.id===r||l.samples<40||(!s||l.score>s.score)&&(s=l)}),s}(this.id);t&&t.activeRate-this.activeRate>.4&&(t.setActive(!0),this.setActive(!1))}addSample(t){t?this.actives+=1:this.inactives+=1,this.samples>66.66666666666667&&this.autoCheckActive()}setMuted(t){this.track&&(this.track.enabled=!t,this.muted=t)}resetTimer(){this.clearTimer(),this.timer=window.setTimeout(()=>{if(this.samples!==0)return this.samples<50?this.resetTimer():void this.autoCheckActive()},1e3)}clearTimer(){this.timer&&(clearTimeout(this.timer),this.timer=0)}}let YL;function P8(e){const t=tu.get(e);t&&(tu.delete(e),t.clearTimer())}const KL=new Map,pY=new Map;function mY(e,t,r){let s=new Uint8Array(e,t,r),l=[],f=0;for(;l.length<r;)f+3<r&&s[f]===0&&s[f+1]===0&&s[f+2]===3&&(s[f+3]===0||s[f+3]===1||s[f+3]===2||s[f+3]===3)?(l.push(s[f],s[f+1],s[f+3]),f+=4):(l.push(s[f]),f++);return new Uint8Array(l)}const s1=new Map,TI=new Map;(function(){const e=qn();zi.getDisplayMedia=!(!navigator.mediaDevices||!navigator.mediaDevices.getDisplayMedia),zi.getStreamFromExtension=e.name===sr.CHROME&&Number(e.version)>34,zi.supportUnifiedPlan=function(){if(!window.RTCRtpTransceiver||!("currentDirection"in RTCRtpTransceiver.prototype))return!1;const t=new RTCPeerConnection;let r=!1;try{t.addTransceiver("audio"),r=!0}catch{}return t.close(),r}(),zi.supportMinBitrate=e.name===sr.CHROME||e.name===sr.EDGE,zi.supportSetRtpSenderParameters=function(){const t=qn();return!!(window.RTCRtpSender&&window.RTCRtpSender.prototype.setParameters&&window.RTCRtpSender.prototype.getParameters)&&(!!fh()||!(!ns()&&!tI())||t.name===sr.FIREFOX&&Number(t.version)>=64)}(),e.name===sr.SAFARI&&(Number(e.version)>=14?zi.supportDualStream=!0:zi.supportDualStream=!1),zi.webAudioMediaStreamDest=function(){const t=qn();return!(t.name===sr.SAFARI&&Number(t.version)<12)}(),zi.supportReplaceTrack=!!window.RTCRtpSender&&typeof RTCRtpSender.prototype.replaceTrack=="function",zi.supportWebGL=typeof WebGLRenderingContext<"u",zi.supportRequestFrame=!!window.CanvasCaptureMediaStreamTrack,fh()||(zi.webAudioWithAEC=!0),zi.supportShareAudio=function(){const t=qn();return(t.os===mr.WIN_10||t.os===mr.WIN_81||t.os===mr.WIN_7||t.os===mr.LINUX||t.os===mr.MAC_OS||t.os===mr.CHROMIUM_OS)&&t.name===sr.CHROME&&Number(t.version)>=74}(),zi.supportDataChannel=!!(Vb(76)||function(t){const r=qn();return!(r.name!==sr.FIREFOX||!r.osVersion)&&Number(r.version)>=t}(68)||mL(14)),zi.supportPCSetConfiguration=function(){const t=window.RTCPeerConnection;return!ei()&&!!t&&t.prototype.setConfiguration instanceof Function}(),zi.supportWebRTCEncodedTransform=function(){const t=qn();return t.name==="Chrome"&&Number(t.version)>=87||t.name==="Safari"&&Number(t.version)>=15}(),zi.supportWebRTCInsertableStream=function(){const t=qn();return(t.name===sr.CHROME||t.name===sr.EDGE)&&Number(t.version)>=94&&"MediaStreamTrackGenerator"in window&&"MediaStreamTrackProcessor"in window}(),zi.supportRequestVideoFrameCallback="requestVideoFrameCallback"in HTMLVideoElement.prototype,zi.supportWebCrypto=typeof window<"u"&&window.crypto!==void 0&&window.crypto.subtle!==void 0,gL(()=>{zi.supportDualStreamEncoding=function(){const t=qn();return!!me("DISABLE_WEBAUDIO")||t.name==="Safari"&&Number(t.version)>=14||!!(t.name==="Chrome"&&/Windows/i.test(t.os||"")&&Number(t.version)>=100&&me("CHROME_DUAL_STREAM_USE_ENCODING"))}(),G.debug("browser ua: ",navigator.userAgent),G.info("browser info: ",e),G.info("browser compatibility: ",zi)})})();const gY=["CHINA","GLOBAL"],M8=[[0,1,2,3,4,5,5],[0,2,2,3,4,5,5],[0,3,3,3,4,5,5],[0,4,4,4,4,5,5],[0,5,5,5,5,5,5]],LS=[],DS=[];function B_(e,t){return!!t&&LS.some(r=>r.uid===e&&r.channelName===t)}function uU(){return DS.length>0}var _Y=eB.forEach,k8=Pm("forEach")?[].forEach:function(e){return _Y(this,e,arguments.length>1?arguments[1]:void 0)};pr({target:"Array",proto:!0,forced:[].forEach!==k8},{forEach:k8});var x8=il("Array","forEach"),EY=Pf,vY=Ga,U8=Q,SY=x8,fU=Array.prototype,yY={DOMTokenList:!0,NodeList:!0},TY=function(e){var t=e.forEach;return e===fU||U8(fU,e)&&t===fU.forEach||vY(yY,EY(e))?SY:t},bY=T(TY),CY=bd,j8=P0;pr({target:"Object",stat:!0,forced:I(function(){j8(1)})},{keys:function(e){return j8(CY(e))}});var hU=T(Ii.Object.keys),wY=T($h),RY=T(KC),IY=pr,V8=Fl,pU=_p,AY=dr,B8=xy,Ut=Yh,qL=Ri,mU=ZM,nf=ea,zo=xo,Zt=d4("slice"),qr=nf("species"),dn=Array,ln=Math.max;IY({target:"Array",proto:!0,forced:!Zt},{slice:function(e,t){var r,s,l,f=qL(this),m=Ut(f),E=B8(e,m),y=B8(t===void 0?m:t,m);if(V8(f)&&(r=f.constructor,(pU(r)&&(r===dn||V8(r.prototype))||AY(r)&&(r=r[qr])===null)&&(r=void 0),r===dn||r===void 0))return zo(f,E,y);for(s=new(r===void 0?dn:r)(ln(y-E,0)),l=0;E<y;E++,l++)E in f&&mU(s,l,f[E]);return s.length=l,s}});var bI=il("Array","slice"),kn=Q,Ho=bI,mn=Array.prototype,JL=function(e){var t=e.slice;return e===mn||kn(mn,e)&&t===mn.slice?Ho:t},XL=T(JL);function Ot(e,t,r,s,l){var f,m,E,y={};return bY(f=hU(s)).call(f,function(b){y[b]=s[b]}),y.enumerable=!!y.enumerable,y.configurable=!!y.configurable,("value"in y||y.initializer)&&(y.writable=!0),y=wY(m=RY(E=XL(r).call(r)).call(E)).call(m,function(b,A){return A(e,t,b)||b},y),l&&y.initializer!==void 0&&(y.value=y.initializer?y.initializer.call(l):void 0,y.initializer=void 0),y.initializer===void 0?(c4(e,t,y),null):y}let QL=function(e){return e[e.ACCESS_POINT=101]="ACCESS_POINT",e[e.UNILBS=201]="UNILBS",e[e.STRING_UID_ALLOCATOR=901]="STRING_UID_ALLOCATOR",e}({}),CI=function(e){return e[e.IIIEGAL_APPID=1]="IIIEGAL_APPID",e[e.IIIEGAL_UID=2]="IIIEGAL_UID",e[e.INTERNAL_ERROR=3]="INTERNAL_ERROR",e}({}),id=function(e){return e[e.INVALID_VENDOR_KEY=5]="INVALID_VENDOR_KEY",e[e.INVALID_CHANNEL_NAME=7]="INVALID_CHANNEL_NAME",e[e.INTERNAL_ERROR=8]="INTERNAL_ERROR",e[e.NO_AUTHORIZED=9]="NO_AUTHORIZED",e[e.DYNAMIC_KEY_TIMEOUT=10]="DYNAMIC_KEY_TIMEOUT",e[e.NO_ACTIVE_STATUS=11]="NO_ACTIVE_STATUS",e[e.DYNAMIC_KEY_EXPIRED=13]="DYNAMIC_KEY_EXPIRED",e[e.STATIC_USE_DYNAMIC_KEY=14]="STATIC_USE_DYNAMIC_KEY",e[e.DYNAMIC_USE_STATIC_KEY=15]="DYNAMIC_USE_STATIC_KEY",e[e.USER_OVERLOAD=16]="USER_OVERLOAD",e[e.FORBIDDEN_REGION=18]="FORBIDDEN_REGION",e[e.CANNOT_MEET_AREA_DEMAND=19]="CANNOT_MEET_AREA_DEMAND",e}({}),Wo=function(e){return e[e.NO_FLAG_SET=100]="NO_FLAG_SET",e[e.FLAG_SET_BUT_EMPTY=101]="FLAG_SET_BUT_EMPTY",e[e.INVALID_FALG_SET=102]="INVALID_FALG_SET",e[e.FLAG_SET_BUT_NO_RE=103]="FLAG_SET_BUT_NO_RE",e[e.INVALID_SERVICE_ID=104]="INVALID_SERVICE_ID",e[e.NO_SERVICE_AVAILABLE=200]="NO_SERVICE_AVAILABLE",e[e.NO_SERVICE_AVAILABLE_P2P=201]="NO_SERVICE_AVAILABLE_P2P",e[e.NO_SERVICE_AVAILABLE_VOICE=202]="NO_SERVICE_AVAILABLE_VOICE",e[e.NO_SERVICE_AVAILABLE_WEBRTC=203]="NO_SERVICE_AVAILABLE_WEBRTC",e[e.NO_SERVICE_AVAILABLE_CDS=204]="NO_SERVICE_AVAILABLE_CDS",e[e.NO_SERVICE_AVAILABLE_CDN=205]="NO_SERVICE_AVAILABLE_CDN",e[e.NO_SERVICE_AVAILABLE_TDS=206]="NO_SERVICE_AVAILABLE_TDS",e[e.NO_SERVICE_AVAILABLE_REPORT=207]="NO_SERVICE_AVAILABLE_REPORT",e[e.NO_SERVICE_AVAILABLE_APP_CENTER=208]="NO_SERVICE_AVAILABLE_APP_CENTER",e[e.NO_SERVICE_AVAILABLE_ENV0=209]="NO_SERVICE_AVAILABLE_ENV0",e[e.NO_SERVICE_AVAILABLE_VOET=210]="NO_SERVICE_AVAILABLE_VOET",e[e.NO_SERVICE_AVAILABLE_STRING_UID=211]="NO_SERVICE_AVAILABLE_STRING_UID",e[e.NO_SERVICE_AVAILABLE_WEBRTC_UNILBS=212]="NO_SERVICE_AVAILABLE_WEBRTC_UNILBS",e[e.NO_SERVICE_AVAILABLE_UNILBS_FLV=213]="NO_SERVICE_AVAILABLE_UNILBS_FLV",e}({}),Wt=function(e){return e[e.K_TIMESTAMP_EXPIRED=2]="K_TIMESTAMP_EXPIRED",e[e.K_CHANNEL_PERMISSION_INVALID=3]="K_CHANNEL_PERMISSION_INVALID",e[e.K_CERTIFICATE_INVALID=4]="K_CERTIFICATE_INVALID",e[e.K_CHANNEL_NAME_EMPTY=5]="K_CHANNEL_NAME_EMPTY",e[e.K_CHANNEL_NOT_FOUND=6]="K_CHANNEL_NOT_FOUND",e[e.K_TICKET_INVALID=7]="K_TICKET_INVALID",e[e.K_CHANNEL_CONFLICTED=8]="K_CHANNEL_CONFLICTED",e[e.K_SERVICE_NOT_READY=9]="K_SERVICE_NOT_READY",e[e.K_SERVICE_TOO_HEAVY=10]="K_SERVICE_TOO_HEAVY",e[e.K_UID_BANNED=14]="K_UID_BANNED",e[e.K_IP_BANNED=15]="K_IP_BANNED",e[e.K_CHANNEL_BANNED=16]="K_CHANNEL_BANNED",e[e.DATASTREAM2_NOT_AVAILABLE=27]="DATASTREAM2_NOT_AVAILABLE",e[e.K_AUTO_REBALANCE=28]="K_AUTO_REBALANCE",e[e.WARN_NO_AVAILABLE_CHANNEL=103]="WARN_NO_AVAILABLE_CHANNEL",e[e.WARN_LOOKUP_CHANNEL_TIMEOUT=104]="WARN_LOOKUP_CHANNEL_TIMEOUT",e[e.WARN_LOOKUP_CHANNEL_REJECTED=105]="WARN_LOOKUP_CHANNEL_REJECTED",e[e.WARN_OPEN_CHANNEL_TIMEOUT=106]="WARN_OPEN_CHANNEL_TIMEOUT",e[e.WARN_OPEN_CHANNEL_REJECTED=107]="WARN_OPEN_CHANNEL_REJECTED",e[e.WARN_REQUEST_DEFERRED=108]="WARN_REQUEST_DEFERRED",e[e.ERR_DYNAMIC_KEY_TIMEOUT=109]="ERR_DYNAMIC_KEY_TIMEOUT",e[e.ERR_NO_AUTHORIZED=110]="ERR_NO_AUTHORIZED",e[e.ERR_VOM_SERVICE_UNAVAILABLE=111]="ERR_VOM_SERVICE_UNAVAILABLE",e[e.ERR_NO_CHANNEL_AVAILABLE_CODE=112]="ERR_NO_CHANNEL_AVAILABLE_CODE",e[e.ERR_MASTER_VOCS_UNAVAILABLE=114]="ERR_MASTER_VOCS_UNAVAILABLE",e[e.ERR_INTERNAL_ERROR=115]="ERR_INTERNAL_ERROR",e[e.ERR_NO_ACTIVE_STATUS=116]="ERR_NO_ACTIVE_STATUS",e[e.ERR_INVALID_UID=117]="ERR_INVALID_UID",e[e.ERR_DYNAMIC_KEY_EXPIRED=118]="ERR_DYNAMIC_KEY_EXPIRED",e[e.ERR_STATIC_USE_DYANMIC_KE=119]="ERR_STATIC_USE_DYANMIC_KE",e[e.ERR_DYNAMIC_USE_STATIC_KE=120]="ERR_DYNAMIC_USE_STATIC_KE",e[e.ERR_NO_VOCS_AVAILABLE=2e3]="ERR_NO_VOCS_AVAILABLE",e[e.ERR_NO_VOS_AVAILABLE=2001]="ERR_NO_VOS_AVAILABLE",e[e.ERR_JOIN_CHANNEL_TIMEOUT=2002]="ERR_JOIN_CHANNEL_TIMEOUT",e[e.ERR_REPEAT_JOIN_CHANNEL=2003]="ERR_REPEAT_JOIN_CHANNEL",e[e.ERR_JOIN_BY_MULTI_IP=2004]="ERR_JOIN_BY_MULTI_IP",e[e.ERR_NOT_JOINED=2011]="ERR_NOT_JOINED",e[e.ERR_REPEAT_JOIN_REQUEST=2012]="ERR_REPEAT_JOIN_REQUEST",e[e.ERR_INVALID_VENDOR_KEY=2013]="ERR_INVALID_VENDOR_KEY",e[e.ERR_INVALID_CHANNEL_NAME=2014]="ERR_INVALID_CHANNEL_NAME",e[e.ERR_INVALID_STRINGUID=2015]="ERR_INVALID_STRINGUID",e[e.ERR_TOO_MANY_USERS=2016]="ERR_TOO_MANY_USERS",e[e.ERR_SET_CLIENT_ROLE_TIMEOUT=2017]="ERR_SET_CLIENT_ROLE_TIMEOUT",e[e.ERR_SET_CLIENT_ROLE_NO_PERMISSION=2018]="ERR_SET_CLIENT_ROLE_NO_PERMISSION",e[e.ERR_SET_CLIENT_ROLE_ALREADY_IN_USE=2019]="ERR_SET_CLIENT_ROLE_ALREADY_IN_USE",e[e.ERR_PUBLISH_REQUEST_INVALID=2020]="ERR_PUBLISH_REQUEST_INVALID",e[e.ERR_SUBSCRIBE_REQUEST_INVALID=2021]="ERR_SUBSCRIBE_REQUEST_INVALID",e[e.ERR_NOT_SUPPORTED_MESSAGE=2022]="ERR_NOT_SUPPORTED_MESSAGE",e[e.ERR_ILLEAGAL_PLUGIN=2023]="ERR_ILLEAGAL_PLUGIN",e[e.ERR_REJOIN_TOKEN_INVALID=2024]="ERR_REJOIN_TOKEN_INVALID",e[e.ERR_REJOIN_USER_NOT_JOINED=2025]="ERR_REJOIN_USER_NOT_JOINED",e[e.ERR_INVALID_OPTIONAL_INFO=2027]="ERR_INVALID_OPTIONAL_INFO",e[e.ILLEGAL_AES_PASSWORD=2028]="ILLEGAL_AES_PASSWORD",e[e.ILLEGAL_CLIENT_ROLE_LEVEL=2029]="ILLEGAL_CLIENT_ROLE_LEVEL",e[e.ERR_TOO_MANY_BROADCASTERS=2031]="ERR_TOO_MANY_BROADCASTERS",e[e.ERR_TOO_MANY_SUBSCRIBERS=2032]="ERR_TOO_MANY_SUBSCRIBERS",e[e.ERR_LICENSE_MISSING=32769]="ERR_LICENSE_MISSING",e[e.ERR_LICENSE_EXPIRED=32771]="ERR_LICENSE_EXPIRED",e[e.ERR_LICENSE_MINUTES_EXCEEDED=32773]="ERR_LICENSE_MINUTES_EXCEEDED",e[e.ERR_LICENSE_PERIOD_INVALID=32774]="ERR_LICENSE_PERIOD_INVALID",e[e.ERR_LICENSE_MULTIPLE_SDK_SERVICE=32778]="ERR_LICENSE_MULTIPLE_SDK_SERVICE",e[e.ERR_LICENSE_ILLEGAL=32783]="ERR_LICENSE_ILLEGAL",e[e.ERR_TEST_RECOVER=9e3]="ERR_TEST_RECOVER",e[e.ERR_TEST_TRYNEXT=9001]="ERR_TEST_TRYNEXT",e[e.ERR_TEST_RETRY=9002]="ERR_TEST_RETRY",e}({}),Fr=function(e){return e.CONNECTING="connecting",e.CONNECTED="connected",e.RECONNECTING="reconnecting",e.CLOSED="closed",e}({}),Ft=function(e){return e.WS_CONNECTED="ws_connected",e.WS_RECONNECTING="ws_reconnecting",e.WS_CLOSED="ws_closed",e.WS_RECONNECT_CREATE_CONNECTION="ws_reconnect_create_connection",e.ON_BINARY_DATA="on_binary_data",e.REQUEST_RECOVER="request_recover",e.REQUEST_JOIN_INFO="request_join_info",e.REQUEST_REJOIN_INFO="req_rejoin_info",e.IS_P2P_DISCONNECTED="is_p2p_dis",e.DISCONNECT_P2P="dis_p2p",e.ABORT_P2P_EXECUTION="abort_p2p_execution",e.NEED_RENEW_SESSION="need-sid",e.REPORT_JOIN_GATEWAY="report_join_gateway",e.REQUEST_TIMEOUT="request_timeout",e.REQUEST_SUCCESS="request_success",e.JOIN_RESPONSE="join_response",e.PRE_CONNECT_PC="pre_connect_pc",e.P2P_CONNECTION="p2p_connection",e.P2P_REMOTE_CANDIDATE_UPDATE="p2p_remote_candidate_update",e.P2P_SUBSCRIBE="p2p_subscribe",e.P2P_UNSUBSCRIBE="p2p_unsubscribe",e.P2P_EXCHANGE_SDP="p2p_exchange_sdp",e.P2P_ON_ADD_VIDEO_STREAM="p2p_on_add_video_stream",e.P2P_ON_ADD_AUDIO_STREAM="p2p_on_add_audio_stream",e.RECOVER_NOTIFICATION="recover_notification",e}({}),cn=function(e){return e.PING="ping",e.PING_BACK="ping_back",e.JOIN="join_v3",e.REJOIN="rejoin_v3",e.LEAVE="leave",e.SET_CLIENT_ROLE="set_client_role",e.PUBLISH="publish",e.PUBLISH_DATASTREAM="publish_datastream",e.UNPUBLISH="unpublish",e.UNPUBLISH_DATASTREAM="unpublish_datastream",e.SUBSCRIBE="subscribe",e.PRE_SUBSCRIBE="pre_subscribe",e.SUBSCRIBE_DATASTREAM="subscribe_datastream",e.SUBSCRIBE_STREAMS="subscribe_streams",e.UNSUBSCRIBE="unsubscribe",e.UNSUBSCRIBE_DATASTREAM="unsubscribe_datastream",e.UNSUBSCRIBE_STREAMS="unsubscribe_streams",e.SUBSCRIBE_CHANGE="subscribe_change",e.TRAFFIC_STATS="traffic_stats",e.RENEW_TOKEN="renew_token",e.SWITCH_VIDEO_STREAM="switch_video_stream",e.DEFAULT_VIDEO_STREAM="default_video_stream",e.SET_FALLBACK_OPTION="set_fallback_option",e.GATEWAY_INFO="gateway_info",e.CONTROL="control",e.SEND_METADATA="send_metadata",e.DATA_STREAM="data_stream",e.PICK_SVC_LAYER="pick_svc_layer",e.RESTART_ICE="restart_ice",e.CONNECT_PC="connect_pc",e.SET_VIDEO_PROFILE="set_video_profile",e.SET_PARAMETER="set_parameter",e.SET_RTM2_FLAG="set_rtm2_flag",e}({}),bs=function(e){return e.WRTC_STATS="wrtc_stats",e.WS_INFLATE_DATA_LENGTH="ws_inflate_data_length",e.DENOISER_STATS="denoiser_stats",e.EXTENSION_USAGE_STATS="extension_usage_stats",e}({}),yn=function(e){return e.ON_USER_ONLINE="on_user_online",e.ON_USER_OFFLINE="on_user_offline",e.ON_STREAM_FALLBACK_UPDATE="on_stream_fallback_update",e.ON_PUBLISH_STREAM="on_publish_stream",e.ON_UPLINK_STATS="on_uplink_stats",e.ON_P2P_LOST="on_p2p_lost",e.ON_REMOVE_STREAM="on_remove_stream",e.ON_ADD_AUDIO_STREAM="on_add_audio_stream",e.ON_ADD_VIDEO_STREAM="on_add_video_stream",e.ON_TOKEN_PRIVILEGE_WILL_EXPIRE="on_token_privilege_will_expire",e.ON_TOKEN_PRIVILEGE_DID_EXPIRE="on_token_privilege_did_expire",e.ON_USER_BANNED="on_user_banned",e.ON_USER_LICENSE_BANNED="on_user_license_banned",e.ON_NOTIFICATION="on_notification",e.ON_CRYPT_ERROR="on_crypt_error",e.MUTE_AUDIO="mute_audio",e.MUTE_VIDEO="mute_video",e.UNMUTE_AUDIO="unmute_audio",e.UNMUTE_VIDEO="unmute_video",e.ON_P2P_OK="on_p2p_ok",e.RECEIVE_METADATA="receive_metadata",e.ON_DATA_STREAM="on_data_stream",e.ON_RTP_CAPABILITY_CHANGE="on_rtp_capability_change",e.ON_REMOTE_DATASTREAM_UPDATE="on_remote_datastream_update",e.ON_REMOTE_FULL_DATASTREAM_INFO="on_remote_full_datastream_info",e.ENABLE_LOCAL_VIDEO="enable_local_video",e.DISABLE_LOCAL_VIDEO="disable_local_video",e.ENABLE_LOCAL_AUDIO="enable_local_audio",e.DISABLE_LOCAL_AUDIO="disable_local_audio",e.ON_PUBLISHED_USER_LIST="on_published_user_list",e}({}),Vi=function(e){return e.SEND_ONLY="SEND_ONLY",e.RECEIVE_ONLY="RECEIVE_ONLY",e}({}),hn=function(e){return e.CONNECTED="websocket:connected",e.RECONNECTING="websocket:reconnecting",e.WILL_RECONNECT="websocket:will_reconnect",e.CLOSED="websocket:closed",e.FAILED="websocket:failed",e.ON_MESSAGE="websocket:on_message",e.REQUEST_NEW_URLS="websocket:request_new_urls",e.RECONNECT_CREATE_CONNECTION="websocket:reconnect_create_connection",e.ON_TOKEN_PRIVILEGE_DID_EXPIRE="websocket:on_token_privilege_did_expire",e}({});function lr(e){if(typeof e!="string"||!/^[a-zA-Z0-9 \!\#\$\%\&\(\)\+\-\:\;\<\=\.\>\?\@\[\]\^\_\{\}\|\~\,]{1,64}$/.test(e))throw G.error("Invalid Channel Name ".concat(e)),new xe(se.INVALID_PARAMS,"The length must be within 64 bytes. The supported characters: a-z,A-Z,0-9,space,!, #, $, %, &, (, ), +, -, :, ;, <, =, ., >, ?, @, [, ], ^, _,  {, }, |, ~, ,")}function La(e){if(t=e,!(typeof t=="number"&&Math.floor(t)===t&&0<=t&&t<=4294967295||Li(e,1,255)))throw new xe(se.INVALID_PARAMS,"[String uid] Length of the string: [1,255]. ASCII characters only. [Number uid] The value range is [0,10000]");var t;typeof e=="string"&&G.warn("You input a string as the user ID, to ensure better end-user experience, Agora highly suggests not using a string as the user ID.")}let rf=function(e){return e.TRANSCODE="mix_streaming",e.RAW="raw_streaming",e}({});const Wa={alpha:1,height:640,width:360,x:0,y:0,zOrder:0,audioChannel:0},rr={x:0,y:0,width:160,height:160,zOrder:255,alpha:1};function ZL(e,t){Oa(e.url,"".concat(t,".url"),1,1e3,!1),bn(e.x)||wr(e.x,"".concat(t,".x"),0,1e4),bn(e.y)||wr(e.y,"".concat(t,".y"),0,1e4),bn(e.width)||wr(e.width,"".concat(t,".width"),0,1e4),bn(e.height)||wr(e.height,"".concat(t,".height"),0,1e4),bn(e.zOrder)||wr(e.zOrder,"".concat(t,".zOrder"),0,255),bn(e.alpha)||wr(e.alpha,"".concat(t,".alpha"),0,1,!1)}const zs={audioBitrate:48,audioChannels:1,audioSampleRate:48e3,backgroundColor:0,height:360,lowLatency:!1,videoBitrate:400,videoCodecProfile:100,videoCodecType:1,videoFrameRate:15,videoGop:30,width:640,images:[],userConfigs:[],userConfigExtraInfo:""};let yh=function(e){return e.WARNING="@live_uap-warning",e.ERROR="@line_uap-error",e.PUBLISH_STREAM_STATUS="@live_uap-publish-status",e.WORKER_STATUS="@live_uap-worker-status",e.REQUEST_NEW_ADDRESS="@live_uap-request-address",e}({}),PS=function(e){return e.REQUEST_WORKER_MANAGER_LIST="@live_req_worker_manager",e}({}),ya=function(e){return e[e.LIVE_STREAM_RESPONSE_SUCCEED=200]="LIVE_STREAM_RESPONSE_SUCCEED",e[e.LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM=454]="LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM",e[e.LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR=450]="LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR",e[e.LIVE_STREAM_RESPONSE_BAD_STREAM=451]="LIVE_STREAM_RESPONSE_BAD_STREAM",e[e.LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR=400]="LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR",e[e.LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST=404]="LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST",e[e.LIVE_STREAM_RESPONSE_NOT_AUTHORIZED=456]="LIVE_STREAM_RESPONSE_NOT_AUTHORIZED",e[e.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE=457]="LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE",e[e.LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN=429]="LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN",e[e.LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH=452]="LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH",e[e.LIVE_STREAM_RESPONSE_NOT_SUPPORTED=453]="LIVE_STREAM_RESPONSE_NOT_SUPPORTED",e[e.LIVE_STREAM_RESPONSE_MAX_STREAM_NUM=455]="LIVE_STREAM_RESPONSE_MAX_STREAM_NUM",e[e.LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR=500]="LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR",e[e.LIVE_STREAM_RESPONSE_WORKER_LOST=501]="LIVE_STREAM_RESPONSE_WORKER_LOST",e[e.LIVE_STREAM_RESPONSE_RESOURCE_LIMIT=502]="LIVE_STREAM_RESPONSE_RESOURCE_LIMIT",e[e.LIVE_STREAM_RESPONSE_WORKER_QUIT=503]="LIVE_STREAM_RESPONSE_WORKER_QUIT",e[e.ERROR_FAIL_SEND_MESSAGE=504]="ERROR_FAIL_SEND_MESSAGE",e[e.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE=30]="PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE",e[e.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT=31]="PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT",e[e.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH=32]="PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH",e[e.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN=33]="PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN",e}({});function gU(e){if(!e.channelName)throw new xe(se.INVALID_PARAMS,"invalid channelName in info");if(typeof e.uid!="number")throw new xe(se.INVALID_PARAMS,"invalid uid in info, uid must be a number");return e.token&&Oa(e.token,"info.token",1,2047),La(e.uid),lr(e.channelName),!0}let bo=function(e){return e[e.SetSdkProfile=0]="SetSdkProfile",e[e.SetSourceChannel=1]="SetSourceChannel",e[e.SetSourceUserId=2]="SetSourceUserId",e[e.SetDestChannel=3]="SetDestChannel",e[e.StartPacketTransfer=4]="StartPacketTransfer",e[e.StopPacketTransfer=5]="StopPacketTransfer",e[e.UpdateDestChannel=6]="UpdateDestChannel",e[e.Reconnect=7]="Reconnect",e[e.SetVideoProfile=8]="SetVideoProfile",e}({}),Tt=function(e){return e.NETWORK_DISCONNECTED="NETWORK_DISCONNECTED",e.NETWORK_CONNECTED="NETWORK_CONNECTED",e.PACKET_JOINED_SRC_CHANNEL="PACKET_JOINED_SRC_CHANNEL",e.PACKET_JOINED_DEST_CHANNEL="PACKET_JOINED_DEST_CHANNEL",e.PACKET_SENT_TO_DEST_CHANNEL="PACKET_SENT_TO_DEST_CHANNEL",e.PACKET_RECEIVED_VIDEO_FROM_SRC="PACKET_RECEIVED_VIDEO_FROM_SRC",e.PACKET_RECEIVED_AUDIO_FROM_SRC="PACKET_RECEIVED_AUDIO_FROM_SRC",e.PACKET_UPDATE_DEST_CHANNEL="PACKET_UPDATE_DEST_CHANNEL",e.PACKET_UPDATE_DEST_CHANNEL_REFUSED="PACKET_UPDATE_DEST_CHANNEL_REFUSED",e.PACKET_UPDATE_DEST_CHANNEL_NOT_CHANGE="PACKET_UPDATE_DEST_CHANNEL_NOT_CHANGE",e}({}),hi=function(e){return e.RELAY_STATE_IDLE="RELAY_STATE_IDLE",e.RELAY_STATE_CONNECTING="RELAY_STATE_CONNECTING",e.RELAY_STATE_RUNNING="RELAY_STATE_RUNNING",e.RELAY_STATE_FAILURE="RELAY_STATE_FAILURE",e}({}),ad=function(e){return e.RELAY_OK="RELAY_OK",e.SERVER_CONNECTION_LOST="SERVER_CONNECTION_LOST",e.SRC_TOKEN_EXPIRED="SRC_TOKEN_EXPIRED",e.DEST_TOKEN_EXPIRED="DEST_TOKEN_EXPIRED",e}({}),Er=function(e){return e.High="high",e.Low="low",e.Audio="audio",e.Screen="screen",e.ScreenLow="screen_low",e}({}),Qe=function(e){return e.DISCONNECT="disconnect",e.CONNECTION_STATE_CHANGE="connection-state-change",e.NETWORK_QUALITY="network-quality",e.STREAM_TYPE_CHANGE="stream-type-change",e.IS_P2P_DISCONNECTED="is-p2p-dis",e.DISCONNECT_P2P="dis-p2p",e.REQUEST_NEW_GATEWAY_LIST="req-gate-url",e.NEED_RENEW_SESSION="need-sid",e.REQUEST_P2P_CONNECTION_PARAMS="request-p2p-connection-params",e.JOIN_RESPONSE="join-response",e.RESET_CONNECTION_EVENTS="reset-connection-events",e.PRE_CONNECT_PC="pre-connect_pc",e.UPDATE_GATEWAY_CONFIG="update-gateway-config",e}({}),or=function(e){return e.P2P_DISCONNECTED="P2P_DISCONNECTED",e.A_ROUND_WS_FAILED="A_ROUND_WS_FAILED",e.TIMEOUT="TIMEOUT",e.UNKNOWN_REASON="UNKNOWN_REASON",e}({}),Mt=function(e){return e[e.Nothing=0]="Nothing",e[e.Audio=1]="Audio",e[e.LwoVideo=2]="LwoVideo",e[e.Video=4]="Video",e[e.Data=8]="Data",e[e.DataStream0=256]="DataStream0",e[e.DataStream1=512]="DataStream1",e[e.DataStream2=1024]="DataStream2",e[e.DataStream3=2048]="DataStream3",e[e.DataStream4=4096]="DataStream4",e[e.DataStream5=8192]="DataStream5",e[e.DataStream6=16384]="DataStream6",e[e.DataStream7=32768]="DataStream7",e}({}),An=function(e){return e.CHINA="CHINA",e.ASIA="ASIA",e.NORTH_AMERICA="NORTH_AMERICA",e.EUROPE="EUROPE",e.JAPAN="JAPAN",e.INDIA="INDIA",e.KOREA="KOREA",e.HKMC="HKMC",e.US="US",e.OCEANIA="OCEANIA",e.SOUTH_AMERICA="SOUTH_AMERICA",e.AFRICA="AFRICA",e.OVERSEA="OVERSEA",e.GLOBAL="GLOBAL",e.EXTENSIONS="EXTENSIONS",e}({});const nu=[An.AFRICA,An.ASIA,An.CHINA,An.EUROPE,An.GLOBAL,An.INDIA,An.JAPAN,An.NORTH_AMERICA,An.OCEANIA,An.OVERSEA,An.SOUTH_AMERICA];let Ir=function(e){return e.CHINA="CN",e.ASIA="AS",e.NORTH_AMERICA="NA",e.EUROPE="EU",e.JAPAN="JP",e.INDIA="IN",e.KOREA="KR",e.HKMC="HK",e.US="US",e.OCEANIA="OC",e.SOUTH_AMERICA="SA",e.AFRICA="AF",e.OVERSEA="OVERSEA",e.GLOBAL="GLOBAL",e.EXTENSIONS="GLOBAL",e}({});const wI={CHINA:{},ASIA:{CODE:Ir.ASIA,WEBCS_DOMAIN:["ap-web-1-asia.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-asia.agora.io"],PROXY_CS:["proxy-ap-web-asia.agora.io"],CDS_AP:["cds-ap-web-asia.agora.io","cds-ap-web-asia2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-asia.agora.io","sua-ap-web-asia2.agora.io"],UAP_AP:["uap-ap-web-asia.agora.io","uap-ap-web-asia2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-asia.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-asia.agora.io"],LOG_UPLOAD_SERVER:["logservice-asia.agora.io"],PROXY_SERVER_TYPE3:["southeast-asia.webrtc-cloud-proxy.sd-rtn.com"]},NORTH_AMERICA:{CODE:Ir.NORTH_AMERICA,WEBCS_DOMAIN:["ap-web-1-north-america.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-north-america.agora.io"],PROXY_CS:["proxy-ap-web-america.agora.io"],CDS_AP:["cds-ap-web-america.agora.io","cds-ap-web-america2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-america.agora.io","sua-ap-web-america2.agora.io"],UAP_AP:["uap-ap-web-america.agora.io","uap-ap-web-america2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-north-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-north-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-north-america.agora.io"],PROXY_SERVER_TYPE3:["east-usa.webrtc-cloud-proxy.sd-rtn.com"]},EUROPE:{CODE:Ir.EUROPE,WEBCS_DOMAIN:["ap-web-1-europe.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-europe.agora.io"],PROXY_CS:["proxy-ap-web-europe.agora.io"],CDS_AP:["cds-ap-web-europe.agora.io","cds-ap-web-europe2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-europe.agora.io","sua-ap-web-europe.agora.io"],UAP_AP:["uap-ap-web-europe.agora.io","uap-ap-web-europe2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-europe.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-europe.agora.io"],LOG_UPLOAD_SERVER:["logservice-europe.agora.io"],PROXY_SERVER_TYPE3:["europe.webrtc-cloud-proxy.sd-rtn.com"]},JAPAN:{CODE:Ir.JAPAN,WEBCS_DOMAIN:["ap-web-1-japan.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-japan.agora.io"],PROXY_CS:["proxy-ap-web-japan.agora.io"],CDS_AP:["cds-ap-web-japan.agora.io","cds-ap-web-japan2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-japan.agora.io","sua-ap-web-japan2.agora.io"],UAP_AP:["uap-ap-web-japan.agora.io","uap-ap-web-japan2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-japan.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-japan.agora.io"],LOG_UPLOAD_SERVER:["logservice-japan.agora.io"],PROXY_SERVER_TYPE3:["japan.webrtc-cloud-proxy.sd-rtn.com"]},INDIA:{CODE:Ir.INDIA,WEBCS_DOMAIN:["ap-web-1-india.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-india.agora.io"],PROXY_CS:["proxy-ap-web-india.agora.io"],CDS_AP:["cds-ap-web-india.agora.io","cds-ap-web-india2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-india.agora.io","sua-ap-web-india2.agora.io"],UAP_AP:["uap-ap-web-india.agora.io","uap-ap-web-india2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-india.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-india.agora.io"],LOG_UPLOAD_SERVER:["logservice-india.agora.io"],PROXY_SERVER_TYPE3:["india.webrtc-cloud-proxy.sd-rtn.com"]},KOREA:{CODE:Ir.KOREA,WEBCS_DOMAIN:["ap-web-1-korea.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-korea.agora.io"],PROXY_CS:["proxy-ap-web-korea.agora.io"],CDS_AP:["cds-ap-web-korea.agora.io","cds-ap-web-korea2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-korea.agora.io","sua-ap-web-korea2.agora.io"],UAP_AP:["uap-ap-web-korea.agora.io","uap-ap-web-korea2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-korea.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-korea.agora.io"],LOG_UPLOAD_SERVER:["logservice-korea.agora.io"],PROXY_SERVER_TYPE3:["korea.webrtc-cloud-proxy.sd-rtn.com"]},HKMC:{CODE:Ir.HKMC,WEBCS_DOMAIN:["ap-web-1-hkmc.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-hkmc.agora.io"],PROXY_CS:["proxy-ap-web-hkmc.agora.io"],CDS_AP:["cds-ap-web-hkmc.agora.io","cds-ap-web-hkmc2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-hkmc.agora.io","sua-ap-web-hkmc2.agora.io"],UAP_AP:["uap-ap-web-hkmc.agora.io","uap-ap-web-hkmc2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-hkmc.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-hkmc.agora.io"],LOG_UPLOAD_SERVER:["logservice-hkmc.agora.io"],PROXY_SERVER_TYPE3:["hkmc.webrtc-cloud-proxy.sd-rtn.com"]},US:{CODE:Ir.US,WEBCS_DOMAIN:["ap-web-1-us.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-us.agora.io"],PROXY_CS:["proxy-ap-web-us.agora.io"],CDS_AP:["cds-ap-web-us.agora.io","cds-ap-web-us2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-us.agora.io","sua-ap-web-us2.agora.io"],UAP_AP:["uap-ap-web-us.agora.io","uap-ap-web-us2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-us.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-us.agora.io"],LOG_UPLOAD_SERVER:["logservice-us.agora.io"],PROXY_SERVER_TYPE3:["us.webrtc-cloud-proxy.sd-rtn.com"]},OVERSEA:{CODE:Ir.OVERSEA,WEBCS_DOMAIN:["ap-web-1-oversea.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-oversea.agora.io"],PROXY_CS:["proxy-ap-web-oversea.agora.io"],CDS_AP:["cds-ap-web-oversea.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-oversea.agora.io"],UAP_AP:["uap-ap-web-oversea.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oversea.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oversea.agora.io"],LOG_UPLOAD_SERVER:["logservice-oversea.agora.io"],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.agora.io"]},GLOBAL:{CODE:Ir.GLOBAL,WEBCS_DOMAIN:["webrtc2-ap-web-1.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-ap-web-3.agora.io"],PROXY_CS:["ap-proxy-1.agora.io","ap-proxy-2.agora.io"],CDS_AP:["cds-ap-web-1.agora.io","cds-ap-web-3.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-1.agora.io","sua-ap-web-3.agora.io"],UAP_AP:["uap-ap-web-1.agora.io","uap-ap-web-3.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2.agora.io"],LOG_UPLOAD_SERVER:["logservice.agora.io"],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.sd-rtn.com"]},OCEANIA:{CODE:Ir.OCEANIA,WEBCS_DOMAIN:["ap-web-1-oceania.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-oceania.agora.io"],PROXY_CS:["proxy-ap-web-oceania.agora.io"],CDS_AP:["cds-ap-web-oceania.agora.io","cds-ap-web-oceania2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-oceania.agora.io","sua-ap-web-oceania2.agora.io"],UAP_AP:["uap-ap-web-oceania.agora.io","uap-ap-web-oceania2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oceania.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oceania.agora.io"],LOG_UPLOAD_SERVER:["logservice-oceania.agora.io"],PROXY_SERVER_TYPE3:["oceania.webrtc-cloud-proxy.sd-rtn.com"]},SOUTH_AMERICA:{CODE:Ir.SOUTH_AMERICA,WEBCS_DOMAIN:["ap-web-1-south-america.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-south-america.agora.io"],PROXY_CS:["proxy-ap-web-south-america.agora.io"],CDS_AP:["cds-ap-web-south-america.agora.io","cds-ap-web-south-america2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-south-america.agora.io","sua-ap-web-south-america2.agora.io"],UAP_AP:["uap-ap-web-south-america.agora.io","uap-ap-web-south-america2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-south-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-south-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-america.agora.io"],PROXY_SERVER_TYPE3:["south-america.webrtc-cloud-proxy.sd-rtn.com"]},AFRICA:{CODE:Ir.AFRICA,WEBCS_DOMAIN:["ap-web-1-africa.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-africa.agora.io"],PROXY_CS:["proxy-ap-web-africa.agora.io"],CDS_AP:["cds-ap-web-africa.agora.io","cds-ap-web-africa2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-africa.agora.io","sua-ap-web-africa2.agora.io"],UAP_AP:["uap-ap-web-africa.agora.io","uap-ap-web-africa2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-africa.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-africa.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-africa.agora.io"],PROXY_SERVER_TYPE3:["africa.webrtc-cloud-proxy.sd-rtn.com"]},EXTENSIONS:{}};Ln&&(wI.CHINA={CODE:Ir.CHINA,WEBCS_DOMAIN:["webrtc2-2.ap.sd-rtn.com"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-4.ap.sd-rtn.com"],PROXY_CS:["proxy-web.ap.sd-rtn.com"],CDS_AP:["cds-web-2.ap.sd-rtn.com","cds-web-4.ap.sd-rtn.com"],ACCOUNT_REGISTER:["sua-web-2.ap.sd-rtn.com","sua-web-4.ap.sd-rtn.com"],UAP_AP:["uap-web-2.ap.sd-rtn.com","uap-web-4.ap.sd-rtn.com"],EVENT_REPORT_DOMAIN:["web-3.statscollector.sd-rtn.com"],EVENT_REPORT_BACKUP_DOMAIN:["web-4.statscollector.sd-rtn.com"],LOG_UPLOAD_SERVER:["logservice-china.agora.io"],PROXY_SERVER_TYPE3:["east-cn.webrtc-cloud-proxy.sd-rtn.com"]});let sd=function(e){return e.UPDATE_BITRATE_LIMIT="update_bitrate_limit",e.UPDATE_CLIENT_ROLE_OPTIONS="update_client_role_options",e}({});function od(e){return!!e&&!(!e.uplink||!e.id)&&e.uplink.max_bitrate!==void 0&&e.uplink.min_bitrate!==void 0}class af extends Xt{constructor(t,r){super(),ne(this,"onICEConnectionStateChange",void 0),ne(this,"onConnectionStateChange",void 0),ne(this,"onDTLSTransportStateChange",void 0),ne(this,"onDTLSTransportError",void 0),ne(this,"onICETransportStateChange",void 0),ne(this,"onFirstAudioReceived",void 0),ne(this,"onFirstVideoReceived",void 0),ne(this,"onFirstAudioDecoded",void 0),ne(this,"onFirstVideoDecoded",void 0),ne(this,"onFirstVideoDecodedTimeout",void 0),ne(this,"onSelectedLocalCandidateChanged",void 0),ne(this,"onSelectedRemoteCandidateChanged",void 0),ne(this,"onICECandidateError",void 0),ne(this,"getLocalVideoStats",void 0)}}class MS extends af{constructor(t,r){super(t,r),ne(this,"establishPromise",void 0)}}let ut=function(e){return e.VIDEO="video",e.AUDIO="audio",e}({}),Ua=function(e){return e.UDP_RELAY="udp_relay",e.UDP_TCP_RELAY="udp_tcp_relay",e.TCP_RELAY="tcp_relay",e.RELAY="relay",e}({}),zc=function(e){return e[e.FIRST_CONNECTION=0]="FIRST_CONNECTION",e[e.UDP_TCP_RESTART=1]="UDP_TCP_RESTART",e[e.RELAY_RESTART=2]="RELAY_RESTART",e[e.TCP_RESTART=3]="TCP_RESTART",e[e.OLD_FIRST_CONNECTION=10]="OLD_FIRST_CONNECTION",e[e.OLD_RESTART=11]="OLD_RESTART",e[e.DISCONNECTED_OR_FAILED=20]="DISCONNECTED_OR_FAILED",e}({});const F8=["disconnected","failed"];let at=function(e){return e.LocalVideoTrack="videoTrack",e.LocalAudioTrack="audioTrack",e.LocalVideoLowTrack="videoLowTrack",e}({}),Qn=function(e){return e.New="new",e.Connected="connected",e.Reconnecting="reconnecting",e.Disconnected="disconnected",e}({}),Yt=function(e){return e.AudioMetadata="audioMetadata",e.StateChange="stateChange",e.IceConnectionStateChange="iceConnectionStateChange",e.RequestMuteLocal="requestMuteLocal",e.RequestUnmuteLocal="requestUnmuteLocal",e.RequestRePublish="requestRePublish",e.RequestRePublishDataChannel="requestRePublishDataChannel",e.RequestReSubscribe="requestReSubscribe",e.RequestUploadStats="requestUploadStats",e.RequestUpload="requestUpload",e.MediaReconnectStart="MediaReconnectStart",e.MediaReconnectEnd="MediaReconnectEnd",e.NeedSignalRTT="NeedSignalRTT",e.RequestRestartICE="RequestRestartIce",e.PeerConnectionStateChange="PeerConnectionStateChange",e.RequestReconnect="RequestReconnect",e.RequestReconnectPC="RequestReconnectPC",e.RequestUnpublishForReconnectPC="RequestUnpublishForReconnectPC",e.P2PLost="P2PLost",e.UpdateVideoEncoder="UpdateVideoEncoder",e.ConnectionTypeChange="ConnectionTypeChange",e.RequestLowStreamParameter="RequestLowStreamParameter",e.QueryClientConnectionState="QueryClientConnectionState",e.LocalCandidate="LocalCandidate",e.RequestP2PMuteLocal="requestP2PMuteLocal",e.RequestP2PUnPublish="RequestP2PUnPublish",e.RequestP2PUnmuteRemote="RequestP2PUnmuteRemote",e.RequestP2PMuteRemote="RequestP2PMuteRemote",e.RequestP2PRestartICE="RequestP2PRestartICE",e}({}),Hc=function(e){return e.CONNECTING="CONNECTING",e.RECONNECTING="RECONNECTING",e.CONNECTED="CONNECTED",e.CLOSED="CLOSED",e}({}),ru=function(e){return e[e.CONNECT_AP=0]="CONNECT_AP",e[e.AP_CONNECTED=1]="AP_CONNECTED",e[e.CONNECT_WORKER_MANAGER=2]="CONNECT_WORKER_MANAGER",e[e.WORKER_MANAGER_CONNECTED=3]="WORKER_MANAGER_CONNECTED",e[e.GET_WORKER_MANAGER_RESPONSE=4]="GET_WORKER_MANAGER_RESPONSE",e[e.CONNECT_WORKER=5]="CONNECT_WORKER",e[e.WORKER_CONNECTED=6]="WORKER_CONNECTED",e[e.CLOSED=7]="CLOSED",e}({}),ja=function(e){return e.CONNECTION_STATE_CHANGE="connection-state-change",e.STATE_CHANGE="state-change",e.INSPECT_RESULT="inspect-result",e.CLIENT_LOCAL_VIDEO_TRACK="client-local-video-track",e.REQUEST_NEW_WORKER_URL="request-new-worker-url",e}({}),_U=function(e){return e.CONNECTED="transmitter:connected",e.RECONNECTING="transmitter:reconnecting",e.WILL_RECONNECT="transmitter:will_reconnect",e.CLOSED="transmitter:closed",e.FAILED="transmitter:failed",e.ON_MESSAGE="transmitter:on_message",e.REQUEST_NEW_URLS="transmitter:request_new_urls",e.RECONNECT_CREATE_CONNECTION="transmitter:reconnect_create_connection",e.ON_TOKEN_PRIVILEGE_DID_EXPIRE="transmitter:on_token_privilege_did_expire",e.TO_CONNECT_DATACHANNEL="transmitter:to_connect_datachannel",e.FAILBACK="transmitter:failback",e.PRE_CONNECT_PC="transmitter:pre_connect_pc",e}({}),Kp=function(e){return e.CAMERA_CHANGED="camera-changed",e.MICROPHONE_CHANGED="microphone-changed",e.PLAYBACK_DEVICE_CHANGED="playback-device-changed",e.AUDIO_AUTOPLAY_FAILED="audio-autoplay-failed",e.AUTOPLAY_FAILED="autoplay-failed",e.AUDIO_CONTEXT_STATE_CHANGED="audio-context-state-changed",e.SECURITY_POLICY_VIOLATION="security-policy-violation",e}({}),iu=function(e){return e.CONNECTING="CONNECTING",e.RECONNECTING="RECONNECTING",e.CONNECTED="CONNECTED",e.CLOSED="CLOSED",e}({}),Th=function(e){return e.CONNECTION_STATE_CHANGE="connection-state-change",e.STATE_CHANGE="state-change",e.INSPECT_RESULT="inspect-result",e.CLIENT_LOCAL_VIDEO_TRACK="client-local-video-track",e.REQUEST_NEW_WORKER_URL="request-new-worker-url",e}({}),o1=function(e){return e[e.CONNECT_AP=0]="CONNECT_AP",e[e.AP_CONNECTED=1]="AP_CONNECTED",e[e.CONNECT_WORKER_MANAGER=2]="CONNECT_WORKER_MANAGER",e[e.WORKER_MANAGER_CONNECTED=3]="WORKER_MANAGER_CONNECTED",e[e.GET_WORKER_MANAGER_RESPONSE=4]="GET_WORKER_MANAGER_RESPONSE",e[e.CONNECT_WORKER=5]="CONNECT_WORKER",e[e.WORKER_CONNECTED=6]="WORKER_CONNECTED",e[e.CLOSED=7]="CLOSED",e}({}),ia=function(e){return e.CALL="call",e.CANDIDATE="candidate",e.PUBLISH="publish",e.UNPUBLISH="unpublish",e.CONTROL="control",e.RESTART_ICE="restart_ice",e.ACK="ack",e.RESPONSE="response",e.JOIN="join",e.CHECK="check",e}({}),c1=function(e){return e.ABORT="abort",e}({}),Ug=function(e){return e.MUTE_LOCAL_AUDIO="mute_local_audio",e.MUTE_LOCAL_VIDEO="mute_local_video",e.UNMUTE_LOCAL_AUDIO="unmute_local_audio",e.UNMUTE_LOCAL_VIDEO="unmute_local_video",e}({}),G8=function(e){return e.P2P_TOKEN_TIMEOUT="p2p_token_timeout",e.P2P_TOKEN_CHANGED="p2p_token_changed",e}({});const EU={[QL.ACCESS_POINT]:{[Wo.NO_FLAG_SET]:{desc:"flag is zero",retry:!1},[Wo.FLAG_SET_BUT_EMPTY]:{desc:"flag is empty",retry:!1},[Wo.INVALID_FALG_SET]:{desc:"invalid flag",retry:!1},[Wo.FLAG_SET_BUT_NO_RE]:{desc:"flag set unilbs but no request",retry:!1},[Wo.INVALID_SERVICE_ID]:{desc:"invalid service id",retry:!1},[Wo.NO_SERVICE_AVAILABLE]:{desc:"no service available",retry:!0},[Wo.NO_SERVICE_AVAILABLE_P2P]:{desc:"no unilbs p2p service available",retry:!0},[Wo.NO_SERVICE_AVAILABLE_VOICE]:{desc:"no unilbs voice service available",retry:!0},[Wo.NO_SERVICE_AVAILABLE_WEBRTC]:{desc:"no unilbs webrtc service available",retry:!0},[Wo.NO_SERVICE_AVAILABLE_CDS]:{desc:"no cds service available",retry:!0},[Wo.NO_SERVICE_AVAILABLE_CDN]:{desc:"no cdn dispatcher service available",retry:!0},[Wo.NO_SERVICE_AVAILABLE_TDS]:{desc:"no tds service available",retry:!0},[Wo.NO_SERVICE_AVAILABLE_REPORT]:{desc:"no unilbs report service available",retry:!0},[Wo.NO_SERVICE_AVAILABLE_APP_CENTER]:{desc:"no app center service available",retry:!0},[Wo.NO_SERVICE_AVAILABLE_ENV0]:{desc:"no unilbs sig env0 service available",retry:!0},[Wo.NO_SERVICE_AVAILABLE_VOET]:{desc:"no unilbs voet service available",retry:!0},[Wo.NO_SERVICE_AVAILABLE_STRING_UID]:{desc:"no string uid service available",retry:!0},[Wo.NO_SERVICE_AVAILABLE_WEBRTC_UNILBS]:{desc:"no webrtc unilbs service available",retry:!0}},[QL.UNILBS]:{[id.INVALID_VENDOR_KEY]:{desc:"invalid vendor key, can not find appid",retry:!1},[id.INVALID_CHANNEL_NAME]:{desc:"invalid channel name",retry:!1},[id.INTERNAL_ERROR]:{desc:"unilbs internal error",retry:!1},[id.NO_AUTHORIZED]:{desc:"invalid token, authorized failed",retry:!1},[id.DYNAMIC_KEY_TIMEOUT]:{desc:"dynamic key or token timeout",retry:!1},[id.NO_ACTIVE_STATUS]:{desc:"no active status",retry:!1},[id.DYNAMIC_KEY_EXPIRED]:{desc:"dynamic key expired",retry:!1},[id.STATIC_USE_DYNAMIC_KEY]:{desc:"static use dynamic key",retry:!1},[id.DYNAMIC_USE_STATIC_KEY]:{desc:"dynamic use static key",retry:!1},[id.USER_OVERLOAD]:{desc:"amount of users over load",retry:!1},[id.FORBIDDEN_REGION]:{desc:"the request is forbidden in this area",retry:!1},[id.CANNOT_MEET_AREA_DEMAND]:{desc:"unable to allocate services in this area",retry:!1}},[QL.STRING_UID_ALLOCATOR]:{[CI.IIIEGAL_APPID]:{desc:"invalid appid",retry:!1},[CI.IIIEGAL_UID]:{desc:"invalid string uid",retry:!1},[CI.INTERNAL_ERROR]:{desc:"string uid allocator internal error",retry:!0}}};function qp(e){const t=EU[Math.floor(e/1e4)];if(!t)return{desc:"unknown error",retry:!1};const r=t[e%1e4];if(!r){if(Math.floor(e/1e4)===QL.ACCESS_POINT){const s=e%1e4;if(s.toString()[0]==="1")return{desc:e.toString(),retry:!1};if(s.toString()[0]==="2")return{desc:e.toString(),retry:!0}}return{desc:"unknown error",retry:!1}}return r}const OY={[Wt.K_TIMESTAMP_EXPIRED]:{desc:"K_TIMESTAMP_EXPIRED",action:"failed"},[Wt.K_CHANNEL_PERMISSION_INVALID]:{desc:"K_CHANNEL_PERMISSION_INVALID",action:"failed"},[Wt.K_CERTIFICATE_INVALID]:{desc:"K_CERTIFICATE_INVALID",action:"failed"},[Wt.K_CHANNEL_NAME_EMPTY]:{desc:"K_CHANNEL_NAME_EMPTY",action:"failed"},[Wt.K_CHANNEL_NOT_FOUND]:{desc:"K_CHANNEL_NOT_FOUND",action:"failed"},[Wt.K_TICKET_INVALID]:{desc:"K_TICKET_INVALID",action:"failed"},[Wt.K_CHANNEL_CONFLICTED]:{desc:"K_CHANNEL_CONFLICTED",action:"failed"},[Wt.K_SERVICE_NOT_READY]:{desc:"K_SERVICE_NOT_READY",action:"tryNext"},[Wt.K_SERVICE_TOO_HEAVY]:{desc:"K_SERVICE_TOO_HEAVY",action:"tryNext"},[Wt.K_UID_BANNED]:{desc:"K_UID_BANNED",action:"failed"},[Wt.K_IP_BANNED]:{desc:"K_IP_BANNED",action:"failed"},[Wt.DATASTREAM2_NOT_AVAILABLE]:{desc:"DATASTREAM2_NOT_AVAILABLE",action:"quit"},[Wt.K_AUTO_REBALANCE]:{desc:"k_AUTO_REBALANCE",action:"recover"},[Wt.ERR_INVALID_VENDOR_KEY]:{desc:"ERR_INVALID_VENDOR_KEY",action:"failed"},[Wt.ERR_INVALID_CHANNEL_NAME]:{desc:"ERR_INVALID_CHANNEL_NAME",action:"failed"},[Wt.WARN_NO_AVAILABLE_CHANNEL]:{desc:"WARN_NO_AVAILABLE_CHANNEL",action:"failed"},[Wt.WARN_LOOKUP_CHANNEL_TIMEOUT]:{desc:"WARN_LOOKUP_CHANNEL_TIMEOUT",action:"tryNext"},[Wt.WARN_LOOKUP_CHANNEL_REJECTED]:{desc:"WARN_LOOKUP_CHANNEL_REJECTED",action:"failed"},[Wt.WARN_OPEN_CHANNEL_TIMEOUT]:{desc:"WARN_OPEN_CHANNEL_TIMEOUT",action:"tryNext"},[Wt.WARN_OPEN_CHANNEL_REJECTED]:{desc:"WARN_OPEN_CHANNEL_REJECTED",action:"failed"},[Wt.WARN_REQUEST_DEFERRED]:{desc:"WARN_REQUEST_DEFERRED",action:"failed"},[Wt.ERR_DYNAMIC_KEY_TIMEOUT]:{desc:"ERR_DYNAMIC_KEY_TIMEOUT",action:"failed"},[Wt.ERR_NO_AUTHORIZED]:{desc:"ERR_NO_AUTHORIZED",action:"failed"},[Wt.ERR_VOM_SERVICE_UNAVAILABLE]:{desc:"ERR_VOM_SERVICE_UNAVAILABLE",action:"tryNext"},[Wt.ERR_NO_CHANNEL_AVAILABLE_CODE]:{desc:"ERR_NO_CHANNEL_AVAILABLE_CODE",action:"failed"},[Wt.ERR_MASTER_VOCS_UNAVAILABLE]:{desc:"ERR_MASTER_VOCS_UNAVAILABLE",action:"tryNext"},[Wt.ERR_INTERNAL_ERROR]:{desc:"ERR_INTERNAL_ERROR",action:"tryNext"},[Wt.ERR_NO_ACTIVE_STATUS]:{desc:"ERR_NO_ACTIVE_STATUS",action:"failed"},[Wt.ERR_INVALID_UID]:{desc:"ERR_INVALID_UID",action:"failed"},[Wt.ERR_DYNAMIC_KEY_EXPIRED]:{desc:"ERR_DYNAMIC_KEY_EXPIRED",action:"failed"},[Wt.ERR_STATIC_USE_DYANMIC_KE]:{desc:"ERR_STATIC_USE_DYANMIC_KE",action:"failed"},[Wt.ERR_DYNAMIC_USE_STATIC_KE]:{desc:"ERR_DYNAMIC_USE_STATIC_KE",action:"failed"},[Wt.ERR_NO_VOCS_AVAILABLE]:{desc:"ERR_NO_VOCS_AVAILABLE",action:"tryNext"},[Wt.ERR_NO_VOS_AVAILABLE]:{desc:"ERR_NO_VOS_AVAILABLE",action:"tryNext"},[Wt.ERR_JOIN_CHANNEL_TIMEOUT]:{desc:"ERR_JOIN_CHANNEL_TIMEOUT",action:"tryNext"},[Wt.ERR_JOIN_BY_MULTI_IP]:{desc:"ERR_JOIN_BY_MULTI_IP",action:"recover"},[Wt.ERR_NOT_JOINED]:{desc:"ERR_NOT_JOINED",action:"failed"},[Wt.ERR_REPEAT_JOIN_REQUEST]:{desc:"ERR_REPEAT_JOIN_REQUEST",action:"quit"},[Wt.ERR_REPEAT_JOIN_CHANNEL]:{desc:"ERR_REPEAT_JOIN_CHANNEL",action:"quit"},[Wt.ERR_INVALID_STRINGUID]:{desc:"ERR_INVALID_STRINGUID",action:"failed"},[Wt.ERR_TOO_MANY_USERS]:{desc:"ERR_TOO_MANY_USERS",action:"tryNext"},[Wt.ERR_SET_CLIENT_ROLE_TIMEOUT]:{desc:"ERR_SET_CLIENT_ROLE_TIMEOUT",action:"failed"},[Wt.ERR_SET_CLIENT_ROLE_NO_PERMISSION]:{desc:"ERR_SET_CLIENT_ROLE_TIMEOUT",action:"failed"},[Wt.ERR_SET_CLIENT_ROLE_ALREADY_IN_USE]:{desc:"ERR_SET_CLIENT_ROLE_ALREADY_IN_USE",action:"success"},[Wt.ERR_PUBLISH_REQUEST_INVALID]:{desc:"ERR_PUBLISH_REQUEST_INVALID",action:"failed"},[Wt.ERR_SUBSCRIBE_REQUEST_INVALID]:{desc:"ERR_SUBSCRIBE_REQUEST_INVALID",action:"failed"},[Wt.ERR_NOT_SUPPORTED_MESSAGE]:{desc:"ERR_NOT_SUPPORTED_MESSAGE",action:"failed"},[Wt.ERR_ILLEAGAL_PLUGIN]:{desc:"ERR_ILLEAGAL_PLUGIN",action:"failed"},[Wt.ILLEGAL_CLIENT_ROLE_LEVEL]:{desc:"ILLEGAL_CLIENT_ROLE_LEVEL",action:"failed"},[Wt.ERR_REJOIN_TOKEN_INVALID]:{desc:"ERR_REJOIN_TOKEN_INVALID",action:"failed"},[Wt.ERR_REJOIN_USER_NOT_JOINED]:{desc:"ERR_REJOIN_NOT_JOINED",action:"failed"},[Wt.ERR_INVALID_OPTIONAL_INFO]:{desc:"ERR_INVALID_OPTIONAL_INFO",action:"quit"},[Wt.ERR_TEST_RECOVER]:{desc:"ERR_TEST_RECOVER",action:"recover"},[Wt.ERR_TEST_TRYNEXT]:{desc:"ERR_TEST_TRYNEXT",action:"recover"},[Wt.ERR_TEST_RETRY]:{desc:"ERR_TEST_RETRY",action:"recover"},[Wt.ILLEGAL_AES_PASSWORD]:{desc:"ERR_TEST_RETRY",action:"failed"},[Wt.ERR_TOO_MANY_BROADCASTERS]:{desc:"ERR_TOO_MANY_BROADCASTERS",action:"failed"},[Wt.ERR_TOO_MANY_SUBSCRIBERS]:{desc:"ERR_TOO_MANY_SUBSCRIBERS",action:"failed"},[Wt.ERR_LICENSE_ILLEGAL]:{desc:"ERR_LICENSE_ILLEGAL",action:"quit"},[Wt.ERR_LICENSE_MISSING]:{desc:"ERR_LICENSE_MISSING",action:"quit"},[Wt.ERR_LICENSE_EXPIRED]:{desc:"ERR_LICENSE_EXPIRED",action:"quit"},[Wt.ERR_LICENSE_MINUTES_EXCEEDED]:{desc:"ERR_LICENSE_MINUTES_EXCEEDED",action:"quit"},[Wt.ERR_LICENSE_PERIOD_INVALID]:{desc:"ERR_LICENSE_PERIOD_INVALID",action:"quit"},[Wt.ERR_LICENSE_MULTIPLE_SDK_SERVICE]:{desc:"ERR_LICENSE_MULTIPLE_SDK_SERVICE",action:"quit"}};function RI(e){return OY[e]||{desc:"UNKNOWN_ERROR_".concat(e),action:"failed"}}function aa(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),r.push.apply(r,s)}return r}function $L(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?aa(Object(r),!0).forEach(function(s){ne(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):aa(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function l1(e,t){if(typeof e=="string")return e;const{proxy:r,host:s,port:l}=e;if(t){const f=me("JOIN_GATEWAY_FALLBACK_PORT")||443;return f===443?"wss://".concat(s,"/ws/?p=").concat(Number(l)+150):"wss://".concat(s,":").concat(f,"/ws/?p=").concat(Number(l)+150)}return r?"wss://".concat(r,"/ws/?h=").concat(s,"&p=").concat(l):"wss://".concat(s,":").concat(l)}const F_=/wss:\/\/(.+)\/ws\/\?h=(.+)&p=([0-9]+)\/?/,vU=/wss:\/\/(.+)\/ws\/\?p=([0-9]+)\/?/,Al=/wss:\/\/(.+):([0-9]+)\/?/,z8=/wss:\/\/(.[^\/]+)\/?/;let H8=0;class II{constructor(t,r){ne(this,"id",0),ne(this,"store",void 0),ne(this,"recordIndex",void 0),ne(this,"websockets",[]),ne(this,"try443PortDuration",2e3),ne(this,"forceCloseWSDuration",5e3),ne(this,"try443PortTimeout",null),ne(this,"forceCloseTimeout",null),ne(this,"isTry443PortFailed",!1),ne(this,"isNormalPortFailed",!1),ne(this,"useDoubleDomain",!1),ne(this,"useProxy",!1),ne(this,"startTime",Date.now()),this.id=++H8,this.try443PortDuration=me("JOIN_GATEWAY_TRY_443PORT_DURATION")||2e3,this.forceCloseWSDuration=t||5e3,this.store=r}closeAllWebsockets(){this.websockets.forEach(t=>{t.onopen=null,t.onclose=null,t.onmessage=null,t.close()}),this.websockets.length=0}clearTimeout(){this.forceCloseTimeout&&clearTimeout(this.forceCloseTimeout),this.try443PortTimeout&&clearTimeout(this.try443PortTimeout),this.forceCloseTimeout=null,this.try443PortTimeout=null}logger(){var t;const r=Date.now()-this.startTime;for(var s=arguments.length,l=new Array(s),f=0;f<s;f++)l[f]=arguments[f];G.debug("[choose-best-ws ".concat((t=this.store)===null||t===void 0?void 0:t.clientId," ").concat(this.id,"] ").concat(r,"ms:"),...l)}createWebSocket(t,r,s){this.logger("createWebSocket:",t,{isTry443Port:r,hasTimeoutDetection:s});const l=me("GATEWAY_DOMAINS"),f=Date.now(),m=[],E=l.find(D=>{var P;return ht(P=t.host).call(P,D)});E||(this.useDoubleDomain=!1);const y=[];if(this.useDoubleDomain)l.forEach(D=>{y.push(l1($L($L({},t),{},{host:t.host.replace(E,D)}),r))});else{const D=$L({},t);if(r&&E){const P=l.find(F=>F!==E);P&&(D.host=D.host.replace(E,P))}y.push(l1(D,r))}try{y.forEach(D=>{const P=new WebSocket(D);P.binaryType="arraybuffer",m.push(P),this.logger("ws is connecting:",P.url)})}catch(D){if(this.logger("ws create failed"),m.forEach(P=>P.close()),m.length=0,this.useDoubleDomain)return this.useDoubleDomain=!1,this.createWebSocket(t,r,s);if(!r&&Number(t.port)!==443)return this.createWebSocket(t,!0,s);throw new xe(se.WS_ERR,"init websocket failed! Error: ".concat(D.toString()))}const b=N_();this.store&&this.store.recordJoinChannelService({urls:m.map(D=>D.url),service:"gateway"},this.recordIndex),m.forEach(D=>{D.onopen=()=>{this.logger("onopen: ws ".concat(D.url," open cost ").concat(Date.now()-f,"ms")),this.websockets.forEach(P=>{P!==D&&(P.onopen=null,P.onclose=null,P.onmessage=null,P.close(),this.logger("close backup websocket: ".concat(P.url)))}),this.websockets.length=0,b.resolve(D)},D.onclose=P=>{this.logger("onclose: ws ".concat(D.url," closed cost ").concat(Date.now()-f,"ms state: ").concat(D.readyState));const F=m.every(B=>B.readyState===WebSocket.CLOSED||B.readyState===WebSocket.CLOSING);this.logger("".concat(r?"443":"47xx"," websocket closed, all failed: ").concat(F)),F&&(r||this.isTry443PortFailed||this.useProxy)?(this.logger("onclose: all websocket is closed, ".concat(P.reason)),b.reject({code:P.code,reason:or.A_ROUND_WS_FAILED})):!r&&F&&!this.isNormalPortFailed&&this.try443PortTimeout&&(this.logger("all 47xx websocket is closed, try 443 port"),this.clearTimeout(),O()),r?this.isTry443PortFailed=F:this.isNormalPortFailed=F},D.onmessage=P=>this.logger("".concat(D.url," onmessage: ").concat(P.data))}),this.websockets.push(...m);const A=()=>{this.websockets.forEach(D=>D.readyState!==WebSocket.OPEN&&D.close())},O=()=>{if(b.isResolved)return A();qn().os===mr.MAC_OS&&ei()&&A(),this.createWebSocket(t,!0,!0).then(D=>{b.resolve(D)}).catch(D=>{this.isNormalPortFailed&&b.reject(D),this.logger("try 443 port to create ws failed")}),this.forceCloseTimeout=window.setTimeout(()=>{this.logger("5s timeout close un-opens, isWebsocket created: ",b.isResolved),this.forceCloseTimeout=null,A()},this.forceCloseWSDuration)};return s||(()=>{if(r||this.useProxy)return this.logger("add 5s timeout at ".concat(r?"try-443":"proxy"," condition")),this.forceCloseTimeout=window.setTimeout(()=>{this.forceCloseTimeout=null,A()},this.forceCloseWSDuration);this.try443PortTimeout=window.setTimeout(()=>{this.logger("2s timeout, isWebsocket created: ",b.isResolved),this.try443PortTimeout=null,O()},this.try443PortDuration)})(),b.promise}chooseBestWebsocket(t,r,s,l){return this.useDoubleDomain=!!r,typeof t=="string"&&(t=function(f){let m,E,y;return[,m,E,y]=f.match(F_)||[],m||([,E,y]=f.match(vU)||[]),E&&y||([,E,y]=f.match(Al)||[]),E&&y||([,E]=f.match(z8)||[]),E||G.warning("un-destructible url: ",f),{proxy:m,host:E,port:y||"443"}}(t)),this.recordIndex=l,this.useProxy=!!t.proxy,s&&this.useProxy&&(G.warn("cannot use 443 only when use proxy"),s=!1),this.createWebSocket(t,!!s,!1).finally(()=>this.clearTimeout())}}function SU(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),r.push.apply(r,s)}return r}class eD extends Xt{get url(){return this.websocket&&this.websocket.url||this._websocketUrl}get reconnectMode(){return this._reconnectMode}set reconnectMode(t){var r;ht(r=["tryNext","recover"]).call(r,t)&&this.resetReconnectCount(t),this._reconnectMode=t}get state(){return this._state}set state(t){t!==this._state&&(this._state=t,this._state==="reconnecting"?this.emit(hn.RECONNECTING,this.reconnectReason):this._state==="connected"?this.emit(hn.CONNECTED):this._state==="closed"?this.emit(hn.CLOSED):this._state==="failed"&&this.emit(hn.FAILED))}resetReconnectCount(t){G.debug("websocket reset reconnect count, reason: "+t),this.reconnectCount=0}constructor(t,r){let s=arguments.length>2&&arguments[2]!==void 0&&arguments[2],l=arguments.length>3&&arguments[3]!==void 0&&arguments[3],f=arguments.length>4&&arguments[4]!==void 0&&arguments[4],m=arguments.length>5?arguments[5]:void 0;super(),ne(this,"_websocketUrl",null),ne(this,"connectionID",0),ne(this,"currentURLIndex",0),ne(this,"urls",[]),ne(this,"_reconnectMode","tryNext"),ne(this,"reconnectReason",void 0),ne(this,"_initMutex",void 0),ne(this,"name",void 0),ne(this,"_state","closed"),ne(this,"reconnectInterrupter",void 0),ne(this,"websocket",void 0),ne(this,"retryConfig",void 0),ne(this,"reconnectCount",0),ne(this,"forceCloseTimeout",5e3),ne(this,"onlineReconnectListener",void 0),ne(this,"useCompress",void 0),ne(this,"tryDoubleDomain",!1),ne(this,"use443PortOnly",!1),ne(this,"wsInflateLength",0),ne(this,"wsDeflateLength",0),ne(this,"closeEstablishingWs",()=>{}),ne(this,"store",void 0),ne(this,"joinGatewayRecordIndex",void 0),this.store=m,this.name=t,this.retryConfig=function(O){for(var D=1;D<arguments.length;D++){var P=arguments[D]!=null?arguments[D]:{};D%2?SU(Object(P),!0).forEach(function(F){ne(O,F,P[F])}):Object.getOwnPropertyDescriptors?Object.defineProperties(O,Object.getOwnPropertyDescriptors(P)):SU(Object(P)).forEach(function(F){Object.defineProperty(O,F,Object.getOwnPropertyDescriptor(P,F))})}return O}({},r),this.useCompress=s,this.tryDoubleDomain=l,this.use443PortOnly=f,this._initMutex=new Gi("websocket",m?m.clientId:void 0);const{timeout:E,timeoutFactor:y}=r,b=Math.max(300,Math.floor(3*E/5)),A=Math.max(1.2,Math.floor(8*y)/10);Fs.ONLINE&&(this.retryConfig.timeout=b,this.retryConfig.timeoutFactor=A),na.on(SS.NETWORK_STATE_CHANGE,(O,D)=>{O!==D&&(this.resetReconnectCount("network state change: ".concat(D," -> ").concat(O)),O===Fs.ONLINE?(this.retryConfig.timeout=b,this.retryConfig.timeoutFactor=A):(this.retryConfig.timeout=E,this.retryConfig.timeoutFactor=y))})}getConnection(){return this.websocket||void 0}async init(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5e3;const s=await this._initMutex.lock();this._reconnectMode="tryNext",this.forceCloseTimeout=r,this.urls=t,this.state="connecting";try{const l=N_(),f=this.urls[this.currentURLIndex];me("ENABLE_PREALLOC_PC")&&this.emit(_U.PRE_CONNECT_PC),this.createWebSocketConnection(f).then(l.resolve).catch(l.reject),this.once(hn.CLOSED,()=>{l.reject(new Ke(se.WS_DISCONNECT))}),this.once(hn.CONNECTED,l.resolve),await l.promise}catch{}finally{s()}}close(t,r){if(this.currentURLIndex=0,this.resetReconnectCount("close"),this.reconnectInterrupter&&this.reconnectInterrupter(),this.websocket){this.websocket.onclose=null,this.websocket.onopen=null,this.websocket.onmessage=null;const s=this.websocket;r?setTimeout(()=>s.close(),500):s.close(),this.websocket=void 0,this._websocketUrl=null}this.state=t?"failed":"closed",this.closeEstablishingWs&&this.closeEstablishingWs()}reconnect(t,r){if(!this.websocket)return void G.warning("[".concat(this.name,"] can not reconnect, no websocket"));t!==void 0&&(this.reconnectMode=t),G.debug("[".concat(this.name,"] reconnect is triggered initiative")),typeof this.joinGatewayRecordIndex=="number"&&this.store&&this.store.recordJoinChannelService({status:"error",errors:[new Error(r)]},this.joinGatewayRecordIndex);const s=this.websocket.onclose;this.websocket.onclose=null,this.websocket.close(),s&&s.bind(this.websocket)({code:9999,reason:r})}sendMessage(t){let r=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(!this.websocket||this.websocket.readyState!==WebSocket.OPEN)throw new Ke(se.WS_ABORT,"websocket is not ready");try{r||(t=JSON.stringify(t)),this.websocket.send(t)}catch(s){throw new Ke(se.WS_ERR,"send websocket message error"+s.toString())}}setWsInflateData(t){this.wsDeflateLength=this.wsDeflateLength+t.originLength,this.wsInflateLength=this.wsInflateLength+t.compressedLength}getWsInflateData(){const t=this.wsInflateLength,r=this.wsDeflateLength;return this.clearWsInflateData(),{wsInflateLength:t,wsDeflateLength:r}}clearWsInflateData(){this.wsInflateLength=0,this.wsDeflateLength=0}async createWebSocketConnection(t){var r;const s=N_();this.connectionID+=1,this.joinGatewayRecordIndex=void 0;const l=A=>{var O;(O=this.store)===null||O===void 0||O.signalChannelOpen(),G.debug("[".concat(this.name,"] websocket opened:"),A),this.reconnectMode="retry",this.state="connected",this.resetReconnectCount("opened"),s.resolve()},f=async A=>{var O;if(G.debug("[".concat(this.name,"] websocket close ").concat((O=this.websocket)===null||O===void 0?void 0:O.url,", code: ").concat(A.code,", reason: ").concat(A.reason,", current mode: ").concat(this.reconnectMode)),this.reconnectCount>=this.retryConfig.maxRetryCount)s.reject(new Ke(se.WS_DISCONNECT,"websocket close: ".concat(A.code))),this.close();else{this.state==="connected"&&(this.reconnectReason=A.reason,this.state="reconnecting");const D=Gs(this,hn.WILL_RECONNECT,this.reconnectMode,A.reason)||this.reconnectMode,P=await this.reconnectWithAction(D);if(this.state==="closed")return void G.debug("[".concat(this.connectionID,"] ws is closed, no need to reconnect"));if(!P)return s.reject(new Ke(se.WS_DISCONNECT,"websocket reconnect failed: ".concat(A.code))),this.close(!0);s.resolve()}},m=A=>{this.emit(hn.ON_MESSAGE,A)},E=A=>{G.warn("[".concat(this.connectionID,"] ws open error ").concat(A))};this.websocket&&(this.websocket.onclose=null,this.websocket.close()),me("GATEWAY_WSS_ADDRESS")&&this.name.startsWith("gateway")&&(t=me("GATEWAY_WSS_ADDRESS")),G.debug("[".concat(this.name,"] start connect, url:"),t);const y=(r=this.store)===null||r===void 0?void 0:r.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"gateway"});try{var b;this._websocketUrl=l1(t);const A=await this.chooseBestWebsocketConnection(t);this.websocket=A,l&&l(this.websocket.url),this.websocket.onclose=f,this.websocket.onmessage=m,this.websocket.onerror=E,(b=this.store)===null||b===void 0||b.recordJoinChannelService({endTs:Date.now(),status:"success"},y),this.joinGatewayRecordIndex=y}catch(A){const O=this.state==="closed",D=A instanceof Ke,P=D&&A.code===se.WS_ABORT,F=D&&A.code===se.WS_ERR,B=D?A.message:A&&(A.reason||A.toString());G.warning("[choose-best-ws] chooseBestWebsocket error: ".concat(B)),this.store&&this.store.recordJoinChannelService({endTs:Date.now(),status:P?"aborted":"error",errors:[A]},y),O||F?(s.reject(O?new Ke(se.WS_DISCONNECT,"websocket is closed: ".concat(B)):new Ke(se.WS_ERR,"init websocket failed: ".concat(B))),F&&G.error("[".concat(this.name,"] init websocket failed: ").concat(B))):f&&f(A)}return s.promise}async reconnectWithAction(t){let r=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(this.reconnectCount>=this.retryConfig.maxRetryCount||this.urls.length===0||this.state==="closed")return!1;G.warning("[choose-best-ws] action: =>",t),this.onlineReconnectListener||na.isOnline||!na.onlineWaiter||(this.onlineReconnectListener=na.onlineWaiter.then(()=>{this.onlineReconnectListener=void 0}));let s=!0;if(this.reconnectInterrupter=()=>s=!1,r){const m=Qu(this.reconnectCount,this.retryConfig);G.debug("[".concat(this.name,"] wait ").concat(m,"ms to reconnect websocket, mode: ").concat(t)),await gt.race([fs(m),this.onlineReconnectListener||new gt(()=>{})])}if(this._state==="closed"||!s)return!1;this.reconnectCount+=1;const l=async(m,E)=>{this.emit(hn.RECONNECT_CREATE_CONNECTION,E),await this.createWebSocketConnection(m)};try{if(t==="retry")await l(this.urls[this.currentURLIndex],t);else if(t==="tryNext"){if(this.currentURLIndex+=1,this.currentURLIndex>=this.urls.length)return this.reconnectWithAction("recover",!1);G.debug("[".concat(this.name,"] websocket url length: ").concat(this.urls.length," current index: ").concat(this.currentURLIndex)),await l(this.urls[this.currentURLIndex],t)}else t==="recover"&&(G.debug("[".concat(this.name,"] request new urls")),this.resetReconnectCount("recover mode"),this.urls=await la(this,hn.REQUEST_NEW_URLS),this.currentURLIndex=0,await l(this.urls[this.currentURLIndex],t))}catch(m){var f;G.error("[".concat(this.name,"] reconnect failed ").concat(m&&m.toString()));const E=m==null||(f=m.data)===null||f===void 0?void 0:f.desc;return Array.isArray(E)&&ht(E).call(E,"dynamic key expired")?(this.emit(hn.ON_TOKEN_PRIVILEGE_DID_EXPIRE),!1):this.reconnectWithAction(t,r)}return!0}}class Jp extends eD{constructor(t,r){super(t,r,arguments.length>2&&arguments[2]!==void 0&&arguments[2],arguments.length>3&&arguments[3]!==void 0&&arguments[3],arguments.length>4&&arguments[4]!==void 0&&arguments[4],arguments.length>5?arguments[5]:void 0)}async chooseBestWebsocketConnection(t,r){const s=N_(),l=function(m,E){return new II(m,E)}(this.forceCloseTimeout,this.store);this.closeEstablishingWs=()=>{G.debug("[choose-best-ws] close establishing websockets"),l.closeAllWebsockets(),s.reject(new Ke(se.WS_ABORT,"choose best websocket aborted"))};const f=me("GATEWAY_DOMAINS");return G.debug("[choose-best-ws] currentDomain: ",t,", domains: ",f,"total: ".concat(this.urls.length),"current: ".concat(this.currentURLIndex+1)),l.chooseBestWebsocket(t,this.tryDoubleDomain,this.use443PortOnly,r).then(s.resolve).catch(s.reject),s.promise.finally(()=>{this.closeEstablishingWs=void 0})}}class G_ extends eD{constructor(t,r){super(t,r,arguments.length>2&&arguments[2]!==void 0&&arguments[2],arguments.length>3&&arguments[3]!==void 0&&arguments[3],arguments.length>4&&arguments[4]!==void 0&&arguments[4],arguments.length>5?arguments[5]:void 0)}async chooseBestWebsocketConnection(t,r){return new gt((s,l)=>{let f=!1;const m=[];this.closeEstablishingWs=()=>{G.debug("[choose-best-ws] close establishing websockets"),m.forEach(F=>{F.onclose=null,F.onopen=null,F.onmessage=null,F.close()}),l(new Ke(se.WS_ABORT,"choose best websocket aborted"))};const E=me("GATEWAY_DOMAINS");let y;const b=t.indexOf("?h="),A=E.find(F=>b!==-1?ht(t).call(t,F,b):ht(t).call(t,F));G.debug("[choose-best-ws] currentDomain: ",A,", domains: ",E);let O=!this.tryDoubleDomain||!A;if(!O&&A){var D;const F=Date.now();try{E.forEach(B=>{const Y=b===-1?t.replace(A,B):t.substr(0,b)+t.substr(b).replace(A,B),$=new WebSocket(Y);$.binaryType="arraybuffer",m.push($),G.debug("[choose-best-ws] ws is connecting:",$.url)})}catch{for(G.debug("[choose-best-ws] ws create failed, fallback to single url"),m.forEach(Y=>Y.close());m.length;)m.pop();O=!0}(D=this.store)===null||D===void 0||D.recordJoinChannelService({urls:m.map(B=>B.url),service:"gateway"},r),m.forEach(B=>{B.onopen=()=>{if(f)return;const Y=Date.now()-F;G.debug("[choose-best-ws] ws open cost ".concat(Y,"ms")),m.filter($=>$!==B).forEach($=>{G.debug("[choose-best-ws]close backup websocket: ".concat($.url)),$.close()}),f=!0,s(B)},B.onclose=Y=>{y=Y,!f&&(m.find($=>!($.readyState===WebSocket.CLOSED||$.readyState===WebSocket.CLOSING))||(G.debug("[choose-best-ws] all websocket is closed"),f=!0,l(y)))},B.onmessage=Y=>{G.debug("[choose-best-ws]".concat(B.url," onmessage: ").concat(Y.data))}}),fs(this.forceCloseTimeout).then(()=>{m.forEach(B=>{B.readyState!==WebSocket.OPEN&&B.close()})})}if(O){var P;let F;G.debug("[choose-best-ws] use single url: ",t),(P=this.store)===null||P===void 0||P.recordJoinChannelService({urls:[t],service:"gateway"},r);try{F=new WebSocket(t),m.push(F),F.binaryType="arraybuffer"}catch(B){const Y=new Ke(se.WS_ERR,"init websocket failed! Error: ".concat(B.toString()));return G.error("[".concat(this.name,"]").concat(Y)),void l(Y)}F.onopen=()=>{s(F)},F.onclose=B=>{l(B)},F.onmessage=B=>{G.debug("[choose-best-ws]".concat(F.url," onmessage: ").concat(B.data))},fs(this.forceCloseTimeout).then(()=>{F&&F.readyState!==WebSocket.OPEN&&F.close()})}}).then(s=>(this.closeEstablishingWs=void 0,s)).catch(s=>{throw this.closeEstablishingWs=void 0,s})}}class W8 extends Xt{get connectionState(){return this._connectionState}set connectionState(t){t!==this._connectionState&&(this._connectionState=t,t===Fr.CONNECTED?this.emit(Ft.WS_CONNECTED):t===Fr.RECONNECTING?this.emit(Ft.WS_RECONNECTING,this._websocketReconnectReason):t===Fr.CLOSED&&this.emit(Ft.WS_CLOSED,this._disconnectedReason))}get currentURLIndex(){return this.websocket.currentURLIndex}get url(){return this.websocket&&this.websocket.url||null}get rtt(){return this.rttRolling.mean()}constructor(t,r){super(),ne(this,"_disconnectedReason",void 0),ne(this,"_websocketReconnectReason",void 0),ne(this,"_connectionState",Fr.CLOSED),ne(this,"reconnectToken",void 0),ne(this,"websocket",void 0),ne(this,"openConnectionTime",void 0),ne(this,"clientId",void 0),ne(this,"lastMsgTime",Date.now()),ne(this,"uploadCache",[]),ne(this,"uploadCacheInterval",void 0),ne(this,"rttRolling",new Rx(5)),ne(this,"pingpongTimer",void 0),ne(this,"wsInflateDataTimer",void 0),ne(this,"pingpongTimeoutCount",0),ne(this,"joinResponse",void 0),ne(this,"multiIpOption",void 0),ne(this,"initError",void 0),ne(this,"spec",void 0),ne(this,"store",void 0),ne(this,"onWebsocketMessage",s=>{if(s.data instanceof ArrayBuffer)return void this.emit(Ft.ON_BINARY_DATA,s.data);const l=JSON.parse(s.data);if(this.lastMsgTime=Date.now(),Object.prototype.hasOwnProperty.call(l,"_id")){const f="res-@".concat(l._id);this.emit(f,l._result,l._message)}else if(Object.prototype.hasOwnProperty.call(l,"_type")){if(this.emit(l._type,l._message),l._type===yn.ON_NOTIFICATION&&this.handleNotification(l._message),l._type===yn.ON_USER_BANNED)switch(l._message.error_code){case 14:this.close(nr.UID_BANNED);break;case 15:this.close(nr.IP_BANNED);break;case 16:this.close(nr.CHANNEL_BANNED)}if(l._type===yn.ON_USER_LICENSE_BANNED)switch(l._message.error_code){case Wt.ERR_LICENSE_MISSING:this.close(nr.LICENSE_MISSING);break;case Wt.ERR_LICENSE_EXPIRED:this.close(nr.LICENSE_EXPIRED);break;case Wt.ERR_LICENSE_MINUTES_EXCEEDED:this.close(nr.LICENSE_MINUTES_EXCEEDED);break;case Wt.ERR_LICENSE_PERIOD_INVALID:this.close(nr.LICENSE_PERIOD_INVALID);break;case Wt.ERR_LICENSE_MULTIPLE_SDK_SERVICE:this.close(nr.LICENSE_MULTIPLE_SDK_SERVICE);break;case Wt.ERR_LICENSE_ILLEGAL:this.close(nr.LICENSE_ILLEGAL);break;default:this.close()}}}),this.clientId=t.clientId,this.spec=t,this.store=r,this.websocket=new Jp("gateway-".concat(this.clientId),this.spec.retryConfig,!0,me("JOIN_GATEWAY_USE_DUAL_DOMAIN"),me("JOIN_GATEWAY_USE_443PORT_ONLY"),r),this.handleWebsocketEvents(),window.addEventListener("offline",()=>{this.connectionState===Fr.CONNECTED&&this.reconnect("retry",Fn.OFFLINE)})}async request(t,r,s,l){const f=Br(6,""),m={_id:f,_type:t,_message:r},E=this.websocket.connectionID,y=()=>new gt((F,B)=>{if(this.connectionState===Fr.CONNECTED)return F();const Y=()=>{this.off(Ft.WS_CLOSED,$),F()},$=()=>{this.off(Ft.WS_CONNECTED,Y),B(new xe(se.WS_ABORT))};this.once(Ft.WS_CONNECTED,Y),this.once(Ft.WS_CLOSED,$),t!==cn.PUBLISH&&t!==cn.PUBLISH_DATASTREAM&&t!==cn.SUBSCRIBE&&t!==cn.SUBSCRIBE_DATASTREAM&&t!==cn.UNSUBSCRIBE&&t!==cn.UNSUBSCRIBE_DATASTREAM&&t!==cn.UNPUBLISH&&t!==cn.UNPUBLISH_DATASTREAM&&t!==cn.CONTROL&&t!==cn.RESTART_ICE||this.once(Ft.DISCONNECT_P2P,()=>{B(new xe(se.DISCONNECT_P2P))}),t!==cn.PUBLISH&&t!==cn.RESTART_ICE||this.once(Ft.ABORT_P2P_EXECUTION,()=>{B(new xe(se.DISCONNECT_P2P))})});if(this.connectionState!==Fr.CONNECTING&&this.connectionState!==Fr.RECONNECTING||t===cn.JOIN||t===cn.REJOIN||await y(),this.websocket.sendMessage(m,!0),l)return;const b=new gt((F,B)=>{let Y=!1;const $=(Ee,Re)=>{Y=!0,F({isSuccess:Ee==="success",message:Re||{}}),this.off(Ft.WS_CLOSED,ee),this.off(Ft.WS_RECONNECTING,ee),this.emit(Ft.REQUEST_SUCCESS,t,r)};this.once("res-@".concat(f),$);const ee=()=>{B(new xe(se.WS_ABORT,"type: ".concat(t))),this.off(Ft.WS_CLOSED,ee),this.off(Ft.WS_RECONNECTING,ee),this.off("res-@".concat(f),$)};this.once(Ft.WS_CLOSED,ee),this.once(Ft.WS_RECONNECTING,ee),fs(me("SIGNAL_REQUEST_TIMEOUT")).then(()=>{this.websocket.connectionID!==E||Y||(G.warning("[".concat(this.clientId,"] ws request timeout, type: ").concat(t)),this.emit(Ft.REQUEST_TIMEOUT,t,r))})});let A=null;try{A=await b}catch(F){if(this.connectionState===Fr.CLOSED||t===cn.LEAVE)throw new xe(se.WS_ABORT);return!this.spec.forceWaitGatewayResponse||s?F.throw():t===cn.JOIN||t===cn.REJOIN?null:(await y(),await this.request(t,r))}if(A.isSuccess)return A.message;const O=Number(A.message.error_code||A.message.code),D=RI(O),P=new xe(se.UNEXPECTED_RESPONSE,"".concat(D.desc,": ").concat(A.message.error_str),{code:O,data:A.message,desc:D.desc});return D.action==="success"?A.message:(G.warning("[".concat(this.clientId,"] [").concat(this.websocket.connectionID,"] unexpected response from type ").concat(t,", error_code: ").concat(O,", message: ").concat(D.desc,", action: ").concat(D.action)),O===Wt.ERR_TOO_MANY_BROADCASTERS?((t===cn.JOIN||t===cn.REJOIN)&&(this.initError=P,this.close()),P.throw()):D.action==="failed"?P.throw():D.action==="quit"?(this.initError=P,this.close(),P.throw()):(O===Wt.ERR_JOIN_BY_MULTI_IP?(this.multiIpOption=A.message.option,G.warning("[".concat(this.clientId,"] detect multi ip, recover")),this.reconnect("recover",Fn.MULTI_IP)):this.reconnect(D.action,Fn.SERVER_ERROR),t===cn.JOIN||t===cn.REJOIN?null:await this.request(t,r)))}waitMessage(t,r){return new gt(s=>{const l=f=>{(!r||r(f))&&(this.off(t,l),s(f))};this.on(t,l)})}uploadWRTCStats(t){if(!this.store.sessionId)return void G.warn("[".concat(this.clientId,"] no session id when upload wrtc stats"));const r={lts:Date.now(),sid:this.store.sessionId,uid:this.store.intUid,stats:t};this.upload(bs.WRTC_STATS,r)}upload(t,r){const s={_type:t,_message:r};try{this.websocket.sendMessage(s)}catch{const f=me("MAX_UPLOAD_CACHE")||50;this.uploadCache.push(s),this.uploadCache.length>f&&this.uploadCache.splice(0,1),this.uploadCache.length>0&&!this.uploadCacheInterval&&(this.uploadCacheInterval=window.setInterval(()=>{if(this.connectionState!==Fr.CONNECTED)return;const m=this.uploadCache.splice(0,1)[0];this.uploadCache.length===0&&(window.clearInterval(this.uploadCacheInterval),this.uploadCacheInterval=void 0),this.upload(m._type,m._message)},me("UPLOAD_CACHE_INTERVAL")||2e3))}}send(t,r){const s={_type:t,_message:r};this.websocket.sendMessage(s)}init(t){return this.initError=void 0,this.multiIpOption=void 0,this.joinResponse=void 0,this.reconnectToken=void 0,this.openConnectionTime=void 0,new gt((r,s)=>{this.once(Ft.WS_CONNECTED,()=>r(this.joinResponse)),this.once(Ft.WS_CLOSED,l=>s(this.initError||new xe(se.WS_ABORT,l))),this.connectionState=Fr.CONNECTING,this.websocket.init(t).catch(s),this.wsInflateDataTimer&&window.clearInterval(this.wsInflateDataTimer),this.wsInflateDataTimer=window.setInterval(()=>{this.handleWsInflateData()},2e4)})}close(t){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.wsInflateDataTimer&&(this.handleWsInflateData(),window.clearInterval(this.wsInflateDataTimer),this.wsInflateDataTimer=void 0),this.reconnectToken=void 0,this.joinResponse=void 0,this._disconnectedReason=t||nr.LEAVE,this.connectionState=Fr.CLOSED,G.debug("[".concat(this.clientId,"] ")+"will close websocket in signal"),this.websocket.close()}async join(){if(!this.joinResponse){this.emit(Ft.ABORT_P2P_EXECUTION);const t=await la(this,Ft.REQUEST_JOIN_INFO),r=await this.request(cn.JOIN,t);if(!r)return this.emit(Ft.REPORT_JOIN_GATEWAY,or.TIMEOUT,this.url||""),!1;this.joinResponse=r,this.emit(Ft.JOIN_RESPONSE,this.joinResponse),this.reconnectToken=this.joinResponse.rejoin_token}return this.connectionState=Fr.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),!0}async rejoin(){if(!this.reconnectToken)throw new xe(se.UNEXPECTED_ERROR,"can not rejoin, no rejoin token");const t=Fb(this,Ft.REQUEST_REJOIN_INFO);t.token=this.reconnectToken;const r=await this.request(cn.REJOIN,t);return!!r&&(this.connectionState=Fr.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),r.peers&&r.peers.forEach(s=>{this.emit(yn.ON_USER_ONLINE,{uid:s.uid}),s.audio&&this.emit(yn.ON_ADD_AUDIO_STREAM,{uid:s.uid,uint_id:s.uint_id,audio:!0,ssrcId:s.audio_ssrc}),s.video&&this.emit(yn.ON_ADD_VIDEO_STREAM,{uid:s.uid,uint_id:s.uint_id,video:!0,ssrcId:s.video_ssrc}),s.audio_mute?this.emit(yn.MUTE_AUDIO,{uid:s.uid}):this.emit(yn.UNMUTE_AUDIO,{uid:s.uid}),s.video_mute?this.emit(yn.MUTE_VIDEO,{uid:s.uid}):this.emit(yn.UNMUTE_VIDEO,{uid:s.uid}),s.audio_enable_local?this.emit(yn.ENABLE_LOCAL_AUDIO,{uid:s.uid}):this.emit(yn.DISABLE_LOCAL_AUDIO,{uid:s.uid}),s.video_enable_local?this.emit(yn.ENABLE_LOCAL_VIDEO,{uid:s.uid}):this.emit(yn.DISABLE_LOCAL_VIDEO,{uid:s.uid}),s.audio||s.video||this.emit(yn.ON_REMOVE_STREAM,{uid:s.uid,uint_id:s.uint_id})}),!0)}reconnect(t,r){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.websocket.reconnect(t,r)}handleNotification(t){G.debug("[".concat(this.clientId,"] receive notification: "),t);const r=RI(t.code);if(t.code===28&&"detail"in t&&(G.info("[".concat(this.clientId,"] receive recover notification: "),t.detail),this.emit(Ft.RECOVER_NOTIFICATION,t.detail)),r.action!=="success"){if(r.action!=="failed")return r.action==="quit"?(r.desc==="ERR_REPEAT_JOIN_CHANNEL"&&this.close(nr.UID_BANNED),void this.close()):void this.reconnect(r.action,Fn.SERVER_ERROR);G.error("[".concat(this.clientId,"] ignore error: "),r.desc)}}handlePingPong(){if(!this.websocket||this.websocket.state!=="connected")return;this.pingpongTimeoutCount>0&&this.rttRolling.add(3e3),this.pingpongTimeoutCount+=1;const t=me("PING_PONG_TIME_OUT"),r=Date.now();this.pingpongTimeoutCount>=t&&(G.warning("[".concat(this.clientId,"] PING-PONG Timeout. Last Socket Message: ").concat(r-this.lastMsgTime,"ms")),r-this.lastMsgTime>me("WEBSOCKET_TIMEOUT_MIN"))?this.reconnect("retry",Fn.TIMEOUT):this.request(cn.PING,void 0,!0).then(()=>{this.pingpongTimeoutCount=0;const s=Date.now()-r;this.rttRolling.add(s),me("REPORT_STATS")&&this.send(cn.PING_BACK,{pingpongElapse:s})}).catch(s=>{})}handleWsInflateData(){const{wsInflateLength:t,wsDeflateLength:r}=this.websocket.getWsInflateData();t!==0&&r!==0&&this.upload(bs.WS_INFLATE_DATA_LENGTH,{ws_deflate_length:r,ws_inflate_length:t})}handleWebsocketEvents(){this.websocket.on(hn.RECONNECT_CREATE_CONNECTION,t=>{this.emit(Ft.WS_RECONNECT_CREATE_CONNECTION,t)}),this.websocket.on(hn.ON_MESSAGE,this.onWebsocketMessage),this.websocket.on(hn.CLOSED,()=>{this.connectionState=Fr.CLOSED}),this.websocket.on(hn.FAILED,()=>{this._disconnectedReason=nr.NETWORK_ERROR,this.connectionState=Fr.CLOSED}),this.websocket.on(hn.RECONNECTING,t=>{this._websocketReconnectReason=t,this.joinResponse=void 0,this.connectionState===Fr.CONNECTED?this.connectionState=Fr.RECONNECTING:this.connectionState=Fr.CONNECTING}),this.websocket.on(hn.WILL_RECONNECT,(t,r,s)=>{const l=Fb(this,Ft.IS_P2P_DISCONNECTED),f=l||t!=="retry";l&&t==="retry"&&(G.debug("".concat(this.clientId," reconnect mode is retry, but p2p lost, change to tryNext")),t="tryNext",r=or.P2P_DISCONNECTED),f&&(G.debug("".concat(this.clientId," will renewSession, reconnect mode: ").concat(t)),this.emit(Ft.REPORT_JOIN_GATEWAY,r||or.UNKNOWN_REASON,this.url||""),this.reconnectToken=void 0,this.emit(Ft.DISCONNECT_P2P)),s(t)}),this.websocket.on(hn.CONNECTED,()=>{this.openConnectionTime=Date.now(),this.reconnectToken?this.rejoin().catch(t=>{G.warning("[".concat(this.clientId,"] rejoin failed ").concat(t)),this.reconnect("tryNext",Fn.SERVER_ERROR)}):this.join().catch(t=>{if(this.emit(Ft.REPORT_JOIN_GATEWAY,t,this.url||""),t instanceof xe){if(t.code===se.UNEXPECTED_RESPONSE&&t.data.code===Wt.ERR_NO_AUTHORIZED)return this.initError=new xe(se.TOKEN_EXPIRE,"dynamic key expired"),void this.close(nr.TOKEN_EXPIRE);G.error("[".concat(this.clientId,"] join gateway request failed"),t.toString()),this.spec.forceWaitGatewayResponse?this.reconnect("tryNext",Fn.SERVER_ERROR):(this.initError=t,this.close())}})}),this.websocket.on(hn.REQUEST_NEW_URLS,(t,r)=>{la(this,Ft.REQUEST_RECOVER,this.multiIpOption).then(t).catch(r)}),this.websocket.on(hn.ON_TOKEN_PRIVILEGE_DID_EXPIRE,()=>{this.emit(yn.ON_TOKEN_PRIVILEGE_DID_EXPIRE)}),this.websocket.on(_U.PRE_CONNECT_PC,()=>{this.emit(Ft.PRE_CONNECT_PC)})}}let tD=function(e){return e.NATIVE_RTC="native_rtc",e.NATIVE_RTM="native_rtm",e.WEB_RTC="web_rtc",e.WEB_RTM="web_rtm",e}({}),Pi=function(e){return e[e.CHOOSE_SERVER=11]="CHOOSE_SERVER",e[e.CLOUD_PROXY=18]="CLOUD_PROXY",e[e.CLOUD_PROXY_5=20]="CLOUD_PROXY_5",e[e.CLOUD_PROXY_FALLBACK=26]="CLOUD_PROXY_FALLBACK",e}({});function yU(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),r.push.apply(r,s)}return r}function kS(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?yU(Object(r),!0).forEach(function(s){ne(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):yU(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function jg(e){return e.match(/^[\.\:\d]+$/)?"".concat(e.replace(/[^\d]/g,"-"),".").concat(me("TURN_DOMAIN")):(G.debug("Cannot recognized as ip address: ".concat(e,", use as host")),e)}function nD(e,t){e.addresses||(e.addresses=[]);const r=function(E,y){if(me("CONNECT_GATEWAY_WITHOUT_DOMAIN"))return E.map(O=>{let{ip:D,port:P}=O;return{address:"".concat(D,":").concat(P)}});const b=me("GATEWAY_DOMAINS");let A=b[1]&&ht(y).call(y,b[1])?1:0;return E.map(O=>{let{domain_prefix:D,port:P,ip:F}=O;if(D)return{address:"".concat(D,".").concat(b[A++%b.length],":").concat(P)};const B=/^[\.\:\d]+$/.test(F),Y=B?"".concat(F.replace(/[^\d]/g,"-"),".").concat(b[A++%b.length],":").concat(P):"".concat(F,":").concat(P);return B||G.debug("Cannot recognized as ip address: ".concat(F,", use as host")),{ip:F,port:P,address:Y}})}(e.addresses,t),s=Array.isArray(e.detail)&&e.detail[18];if(s&&typeof s=="string"){const E=s.split(";");for(let y=0;y<E.length;y++){var l;const b=Eo(l=E[y]).call(l);r[y]&&b&&(r[y].ip6=b)}}const f=e.detail&&e.detail.candidate;let m;if(f){const[E,y]=f.split(":");E&&y&&(m={port:Number(y),ip:E,address:"".concat(E,":").concat(y)})}return{gatewayAddrs:r,apGatewayAddress:m,uid:e.uid,cid:e.cid,cert:e.cert,vid:e.detail&&e.detail[8],uni_lbs_ip:e.detail&&e.detail[1],res:e,csIp:e.detail&&e.detail[502]}}function Co(e){return typeof e=="number"?e:e.exact||e.ideal||e.max||e.min||0}function Vg(e){const t=e._encoderConfig;if(!t)return{};const r={resolution:t.width&&t.height?"".concat(Co(t.width),"x").concat(Co(t.height)):void 0,maxVideoBW:t.bitrateMax,minVideoBW:t.bitrateMin};return typeof t.frameRate=="number"?(r.maxFrameRate=t.frameRate,r.minFrameRate=t.frameRate):t.frameRate&&(r.maxFrameRate=t.frameRate.max||t.frameRate.ideal||t.frameRate.exact||t.frameRate.min,r.minFrameRate=t.frameRate.min||t.frameRate.ideal||t.frameRate.exact||t.frameRate.max),r}function TU(e){return e>=0&&e<.17?1:e>=.17&&e<.36?2:e>=.36&&e<.59?3:e>=.59&&e<=1?4:e>1?5:0}function d1(e,t){let r,s,l;switch(t){case Pi.CHOOSE_SERVER:s=4096,l="choose server";break;case Pi.CLOUD_PROXY:s=1048576,l="proxy";break;case Pi.CLOUD_PROXY_5:s=4194304,l="proxy5";break;case Pi.CLOUD_PROXY_FALLBACK:s=4194310,l="proxy fallback";break;default:throw new xe(se.UNEXPECTED_ERROR,"multi unlibs response transformer get unknown service id",{csIp:e.detail&&e.detail[502],retry:!1})}if(e.response_body.forEach(f=>{f.buffer&&f.buffer.flag===s&&(r={code:f.buffer.code,addresses:(f.buffer.edges_services||[]).map(m=>kS(kS({},m),{},{ticket:f.buffer.cert})),server_ts:e.enter_ts,uid:f.buffer.uid,cid:f.buffer.cid,cname:f.buffer.cname,detail:kS(kS({},f.buffer.detail),e.detail),flag:f.buffer.flag,opid:e.opid,cert:f.buffer.cert})}),!r)throw new xe(se.MULTI_UNILBS_RESPONSE_ERROR,"cannot parse response ".concat(l," from multi unilbs response"),{csIp:e.detail&&e.detail[502]});return r}async function bU(e,t){return await gt.all(e.addresses.map(async r=>({address:me("USE_TURN_IP")?r.ip:jg(r.ip),tcpport:r.port,udpport:r.port,username:t&&me("ENCRYPT_PROXY_USERNAME_AND_PSW")&&window.isSecureContext?t.toString():ps.username,password:t&&me("ENCRYPT_PROXY_USERNAME_AND_PSW")&&window.isSecureContext?await rI(t.toString()):ps.password})))}function Bg(e,t){const r=t.getMediaStreamTrack(!0).getSettings(),s=t.videoHeight||r.height,l=t.videoWidth||r.width;return s&&l?Math.max(Math.min(s,l)/Math.min(Co(e.height),Co(e.width)),1):(G.warning("can't get ori-track's height, default scale down 4 times for low stream"),4)}function au(e){let{candidateType:t,relayProtocol:r,type:s,address:l,port:f,protocol:m}=e;const E={candidateType:t,relayProtocol:r,protocol:m};if(s!=="local-candidate"){const y=l.split(".");y.length>=4&&(y[1]="*",y[2]="*"),E.address=y.join("."),E.port=f}return E}function u1(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:me("SVC_MODE");if(me("ENABLE_SVC"))return function(t){return t in Fp}(e)?e:Fp.L1T3}const rD={[ut.VIDEO]:[{key:"abs-send-time",extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"},{key:"video-orientation",extensionName:"urn:3gpp:video-orientation"},{key:"draft-holmer-rmcat-transport-wide-cc-extensions-01",extensionName:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"},{key:"playout-delay",extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/playout-delay"},{key:"video-content-type",extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/video-content-type"},{key:"color-space",extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/color-space"},{key:"video-timing",extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/video-timing"}],[ut.AUDIO]:[{key:"ssrc-audio-level",extensionName:"urn:ietf:params:rtp-hdrext:ssrc-audio-level"},{key:"draft-holmer-rmcat-transport-wide-cc-extensions-01",extensionName:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"},{key:"abs-send-time",extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"}]};function AI(e,t,r){t.forEach(s=>{var l;const f=rD[e].find(E=>{var y;let{key:b}=E;return ht(y=s.extensionName).call(y,b)});if(!f)return;const m=r.find(E=>{let{extensionName:y}=E;return ht(y).call(y,f.key)});m&&ht(l=m.extensionName).call(l,"gdpr_forbidden")&&(s.extensionName=m.extensionName)})}function Fg(e,t){t.forEach(r=>{var s;const l=rD[e].find(f=>{var m;let{key:E}=f;return ht(m=r.extensionName).call(m,E)});ht(s=r.extensionName).call(s,"gdpr_forbidden")&&l&&(r.extensionName=l.extensionName)})}function CU(e){return e==="http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"||ht(e).call(e,"abs-send-time")}function OI(e){return e==="http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"||ht(e).call(e,"draft-holmer-rmcat-transport-wide-cc-extensions-01")}function wU(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),r.push.apply(r,s)}return r}function su(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?wU(Object(r),!0).forEach(function(s){ne(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):wU(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function z_(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s=arguments.length>3?arguments[3]:void 0;const{filterRTX:l,filterVideoFec:f,filterAudioFec:m,filterAudioCodec:E,filterVideoCodec:y}=t,{useXR:b}=r;let A=[],O=[],D=[],P=[],F=!1,B=!1;if(on(e).mediaDescriptions.forEach($=>{s&&s!==$.attributes.direction||($.media.mediaType!=="video"||F||(O=$.attributes.payloads,P=$.attributes.extmaps,F=!0),$.media.mediaType!=="audio"||B||(A=$.attributes.payloads,D=$.attributes.extmaps,B=!0))}),!P||O.length===0)throw new Error("Cannot get video capabilities from SDP.");if(!D||A.length===0)throw new Error("Cannot get audio capabilities from SDP.");if(O.forEach($=>{var ee;(ee=$.rtpMap)!==null&&ee!==void 0&&ee.clockRate&&($.rtpMap.clockRate=parseInt($.rtpMap.clockRate)),b&&$.rtcpFeedbacks.push({type:"rrtr"})}),A.forEach($=>{var ee;(ee=$.rtpMap)!==null&&ee!==void 0&&ee.clockRate&&($.rtpMap.clockRate=parseInt($.rtpMap.clockRate)),b&&$.rtcpFeedbacks.push({type:"rrtr"})}),l&&(A=A.filter($=>{var ee;return((ee=$.rtpMap)===null||ee===void 0?void 0:ee.encodingName.toLowerCase())!=="rtx"}),O=O.filter($=>{var ee;return((ee=$.rtpMap)===null||ee===void 0?void 0:ee.encodingName.toLowerCase())!=="rtx"})),f&&(O=O.filter($=>{var ee;return!/(red)|(ulpfec)|(flexfec)/i.test(((ee=$.rtpMap)===null||ee===void 0?void 0:ee.encodingName)||"")})),m&&(A=A.filter($=>{var ee;return!/(red)|(ulpfec)|(flexfec)/i.test(((ee=$.rtpMap)===null||ee===void 0?void 0:ee.encodingName)||"")})),E&&(E==null?void 0:E.length)>0&&(A=A.filter($=>{var ee;return ht(E).call(E,((ee=$.rtpMap)===null||ee===void 0?void 0:ee.encodingName.toLowerCase())||"")})),y&&(y==null?void 0:y.length)>0){const $=O.filter(ee=>{var Ee;return ht(y).call(y,((Ee=ee.rtpMap)===null||Ee===void 0?void 0:Ee.encodingName.toLowerCase())||"")});O=$.concat(l?[]:bh($,O))}const Y=me("UNSUPPORTED_VIDEO_CODEC");return Y&&Y.length>0&&(O=O.filter($=>!($.rtpMap&&ht(Y).call(Y,$.rtpMap.encodingName.toLowerCase())))),{audioCodecs:A,videoCodecs:O,audioExtensions:D,videoExtensions:P}}function ou(e){const t=on(e);let r,s;for(const l of t.mediaDescriptions){if(!r){const f=l.attributes.iceUfrag,m=l.attributes.icePwd;if(!f||!m)throw new Error("Cannot get iceUfrag or icePwd from SDP.");r={iceUfrag:f,icePwd:m}}if(!s){const f=l.attributes.fingerprints;f.length>0&&(s={fingerprints:f})}}if(!s&&t.attributes.fingerprints.length>0&&(s={fingerprints:t.attributes.fingerprints}),!s||!r)throw new Error("Cannot get iceParameters or dtlsParameters from SDP.");return{iceParameters:r,dtlsParameters:s}}function f1(e,t){const r=[],s=e.attributes.ssrcGroups.filter(m=>m.semantic==="FID"),l=e.attributes.ssrcGroups.find(m=>m.semantic==="SIM"),f=e.attributes.ssrcs;if(l)l.ssrcIds.forEach(m=>{var E;const y=(E=s.find(b=>b.ssrcIds[0]===m))===null||E===void 0?void 0:E.ssrcIds[1];r.push({ssrcId:m,rtx:t?y:void 0})});else if(s.length>0){const m=s[0].ssrcIds[0],E=s[0].ssrcIds[1];r.push({ssrcId:m,rtx:t?E:void 0})}else{if(f.length===0)throw new Error("No ssrcs found on local media description.");r.push({ssrcId:f[0].ssrcId})}return r}function iD(e,t,r){const{cname:s}=e;let l=[];t&&(l=h1(t)),l.length===0&&(l=e.iceParameters.candidates.map(A=>({foundation:A.foundation,componentId:"1",transport:A.protocol,priority:A.priority.toString(),connectionAddress:A.ip,port:A.port.toString(),type:A.type,extension:{}})),G.debug("Using candidates from gateway."));const f={fingerprints:e.dtlsParameters.fingerprints.map(A=>({hashFunction:A.algorithm,fingerprint:A.fingerprint}))},m={iceUfrag:e.iceParameters.iceUfrag,icePwd:e.iceParameters.icePwd};let E;switch(e.dtlsParameters.role){case"server":E="passive";break;case"client":E="active";break;case"auto":E="actpass"}const y=NI(e.rtpCapabilities),b=[];return Array.isArray(r)&&r.length>0&&r.forEach(A=>{b.push({kind:ut.VIDEO,ssrcId:A.v,rtx:A.v_rtx,mslabel:"".concat(A.v,"_").concat(A.a)},{kind:ut.AUDIO,ssrcId:A.a,mslabel:"".concat(A.v,"_").concat(A.a)})}),{dtlsParameters:f,iceParameters:m,candidates:l,rtpCapabilities:y,setup:E,cname:s,preSSRCs:b}}function h1(e){let t=[];return e.ip&&typeof e.port=="number"&&(t=[{foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:e.ip,port:e.port.toString(),type:"host",extension:{}}],G.debug("Using remote candidate from AP ".concat(e.ip,":").concat(e.port)),e.ip6&&(t.push({foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:e.ip6,port:e.port.toString(),type:"host",extension:{}}),G.debug("Using IPV6 remote candidate from AP ".concat(e.ip6,":").concat(e.port)))),t}function H_(e,t,r){const s=[],l=[];return e.forEach(f=>{let{ssrcId:m,rtx:E}=f;const y=Br(8,"track-"),b={ssrcId:m,attributes:su({label:y,mslabel:r=r||Br(10,""),msid:"".concat(r," ").concat(y)},t&&{cname:t})};if(s.push(b),E!==void 0){const A={ssrcId:E,attributes:su({label:y,mslabel:r,msid:"".concat(r," ").concat(y)},t&&{cname:t})};s.push(A),l.push({semantic:"FID",ssrcIds:[m,E]})}}),e.length>1&&l.push({semantic:"SIM",ssrcIds:e.map(f=>{let{ssrcId:m}=f;return m})}),{ssrcs:s,ssrcGroups:l}}function xS(e,t){t instanceof ji&&e.attributes.payloads.forEach(r=>{var s;const l=(s=r.rtpMap)===null||s===void 0?void 0:s.encodingName.toLowerCase();if(!l||["opus","pcmu","pcma","g722"].indexOf(l)===-1)return;r.fmtp||(r.fmtp={parameters:{}}),l==="opus"&&typeof me("OPUS_PTIME")=="number"?r.fmtp.parameters.ptime=me("OPUS_PTIME"):r.fmtp.parameters.minptime="10",r.fmtp.parameters.useinbandfec="1";const f=t._encoderConfig;f&&(l!=="pcmu"&&l!=="pcma"&&l!=="g722"&&(f.bitrate&&!ei()&&(r.fmtp.parameters.maxaveragebitrate="".concat(Math.floor(1e3*f.bitrate))),f.sampleRate&&(r.fmtp.parameters.maxplaybackrate="".concat(f.sampleRate),r.fmtp.parameters["sprop-maxcapturerate"]="".concat(f.sampleRate)),f.stereo&&(r.fmtp.parameters.stereo="1",r.fmtp.parameters["sprop-stereo"]="1")),t instanceof t1&&l==="opus"&&t._config.DTX&&(r.fmtp.parameters.usedtx="1"))})}function aD(e){const t=e.attributes.unrecognized.findIndex(r=>r.attField==="x-google-flag"&&r.attValue==="conference");t!==-1&&e.attributes.unrecognized.splice(t,1)}function sD(e,t){var r;if(!(t instanceof Kr&&t._encoderConfig&&t._hints.indexOf(xr.SCREEN_TRACK)===-1))return;const s=t._encoderConfig;zn().supportMinBitrate&&s.bitrateMin&&e.attributes.payloads.forEach(l=>{var f,m;ht(f=["h264","h265","vp8","vp9","av1"]).call(f,((m=l.rtpMap)===null||m===void 0?void 0:m.encodingName.toLowerCase())||"")&&(l.fmtp||(l.fmtp={parameters:{}}),l.fmtp.parameters["x-google-min-bitrate"]="".concat(s.bitrateMin))}),zn().supportMinBitrate&&!ht(r=t._hints).call(r,xr.LOW_STREAM)&&s.bitrateMax&&e.attributes.payloads.forEach(l=>{var f,m;ht(f=["h264","h265","vp8","vp9","av1"]).call(f,((m=l.rtpMap)===null||m===void 0?void 0:m.encodingName.toLowerCase())||"")&&(l.fmtp||(l.fmtp={parameters:{}}),l.fmtp.parameters["x-google-start-bitrate"]="".concat(me("X_GOOGLE_START_BITRATE")||Math.floor(s.bitrateMax)))})}function RU(e){if(e.media.mediaType!=="video")return;const t=qn();if(t.name!==sr.SAFARI&&t.os!==mr.IOS)return;const r=e.attributes.extmaps.findIndex(s=>/video-orientation/g.test(s.extensionName));r!==-1&&e.attributes.extmaps.splice(r,1)}function Wc(e,t,r){if(!t)return;let s,l;if(e.media.mediaType==="video"?(s=r.videoExtensions,l=r.videoCodecs):(s=r.audioExtensions,l=r.audioCodecs),t.twcc===!0){const f=s.find(m=>OI(m.extensionName));if(f){const m=f.extensionName;e.attributes.extmaps.find(y=>OI(y.extensionName))||e.attributes.extmaps.push({entry:f.entry,extensionName:m}),function(y,b){return b.filter(A=>!!y.find(O=>O.payloadType===A.payloadType&&!!O.rtcpFeedbacks.find(D=>D.type==="transport-cc")))}(l,e.attributes.payloads).forEach(y=>{y.rtcpFeedbacks.find(b=>b.type==="transport-cc")||y.rtcpFeedbacks.push({type:"transport-cc"})})}}else if(t.twcc===!1){const f=e.attributes.extmaps.findIndex(m=>OI(m.extensionName));f!==-1&&e.attributes.extmaps.splice(f,1),e.attributes.payloads.forEach(m=>{const E=m.rtcpFeedbacks.findIndex(y=>y.type==="transport-cc");E!==-1&&m.rtcpFeedbacks.splice(E,1)})}if(t.remb===!0){const f=s.find(m=>CU(m.extensionName));if(f){const m=f.extensionName;e.attributes.extmaps.find(y=>y.extensionName===m)||e.attributes.extmaps.push({entry:f.entry,extensionName:m}),function(y,b){return b.filter(A=>!!y.find(O=>O.payloadType===A.payloadType&&!!O.rtcpFeedbacks.find(D=>D.type==="goog-remb")))}(l,e.attributes.payloads).forEach(y=>{y.rtcpFeedbacks.find(b=>b.type==="goog-remb")||y.rtcpFeedbacks.push({type:"goog-remb"})})}}else if(t.remb===!1){const f=e.attributes.extmaps.findIndex(m=>CU(m.extensionName));f!==-1&&e.attributes.extmaps.splice(f,1),e.attributes.payloads.forEach(m=>{const E=m.rtcpFeedbacks.findIndex(y=>y.type==="goog-remb");E!==-1&&m.rtcpFeedbacks.splice(E,1)})}}function Y8(e,t,r){if(ei()||e.media.mediaType!=="video"||!(t instanceof Kr)||r!=="vp9"&&r!=="vp8"||r==="vp8"&&!me("SIMULCAST")||r==="vp9"&&me("ENABLE_SVC")||t._scalabilityMode===void 0||t._scalabilityMode.numSpatialLayers<=1)return;const s=r==="vp8"?2:t._scalabilityMode.numSpatialLayers,l=e.attributes.ssrcs[0],f=e.attributes.ssrcGroups.find(E=>E.semantic==="FID"&&E.ssrcIds[0]===l.ssrcId),m={semantic:"SIM",ssrcIds:[l.ssrcId]};for(let E=1;E<s;E++)e.attributes.ssrcs.push({ssrcId:l.ssrcId+E,attributes:Mn(l.attributes)}),m.ssrcIds.push(l.ssrcId+E),f&&(e.attributes.ssrcs.push({ssrcId:f.ssrcIds[1]+E,attributes:Mn(l.attributes)}),e.attributes.ssrcGroups.push({semantic:"FID",ssrcIds:[l.ssrcId+E,f.ssrcIds[1]+E]}));e.attributes.ssrcGroups.unshift(m)}async function IU(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=new RTCPeerConnection;r.addTransceiver("video",{direction:"sendonly"}),r.addTransceiver("audio",{direction:"sendonly"}),r.addTransceiver("video",{direction:"recvonly"}),r.addTransceiver("audio",{direction:"recvonly"});const s=(await r.createOffer()).sdp,{send:l,recv:f,sendrecv:m}=function(){let E=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},b=arguments.length>2?arguments[2]:void 0;const A=z_(b,E,y,"sendonly"),O=z_(b,E,y,"recvonly"),D={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},P={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},F={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]};if(ao(A,O,"videoExtensions",D,P,F),ao(A,O,"videoCodecs",D,P,F),ao(A,O,"audioExtensions",D,P,F),ao(A,O,"audioCodecs",D,P,F),me("RAISE_H264_BASELINE_PRIORITY")){const B=[],Y=[];F.videoCodecs.forEach(($,ee)=>{var Ee;if(((Ee=$.rtpMap)===null||Ee===void 0?void 0:Ee.encodingName.toLocaleLowerCase())==="h264"){var Re,Ie;const we=F.videoCodecs[ee+1],Ue=we&&sf($,we),ve=(Re=$.fmtp)===null||Re===void 0?void 0:Re.parameters["profile-level-id"],Ne=(Ie=$.fmtp)===null||Ie===void 0?void 0:Ie.parameters["packetization-mode"];!ve||ve!==me("FIRST_H264_PROFILE_LEVEL_ID")||me("FIRST_PACKETIZATION_MODE")&&Ne!==me("FIRST_PACKETIZATION_MODE")?Ue?Y.push([$,we]):Y.push([$]):Ue?B.push([$,we]):B.push([$])}}),B.length>0&&Y.length>0&&(G.debug("raising H264 baseline profile priority"),F.videoCodecs.forEach(($,ee)=>{var Ee;if(((Ee=$.rtpMap)===null||Ee===void 0?void 0:Ee.encodingName.toLocaleLowerCase())==="h264"){const Re=sf($,F.videoCodecs[ee+1]),Ie=B.shift()||Y.shift()||[];Ie.length>0&&(Re?F.videoCodecs.splice(ee,2,...Ie):F.videoCodecs.splice(ee,1,...Ie))}}),P.videoCodecs=P.videoCodecs.filter($=>{var ee,Ee;return!(((ee=$.rtpMap)===null||ee===void 0?void 0:ee.encodingName.toLocaleLowerCase())==="h264"&&((Ee=$.fmtp)===null||Ee===void 0?void 0:Ee.parameters["profile-level-id"])!==me("FIRST_H264_PROFILE_LEVEL_ID"))}),me("FILTER_SEND_H264_BASELINE")&&(D.videoCodecs=D.videoCodecs.filter($=>{var ee,Ee;return!(((ee=$.rtpMap)===null||ee===void 0?void 0:ee.encodingName.toLocaleLowerCase())==="h264"&&((Ee=$.fmtp)===null||Ee===void 0?void 0:Ee.parameters["profile-level-id"])!==me("FIRST_H264_PROFILE_LEVEL_ID"))})))}return{send:D,recv:P,sendrecv:F}}(e,t,s);try{r.close()}catch{}return{send:l,recv:f,sendrecv:m}}function Gg(){const e={audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]},t=z_(arguments.length>2?arguments[2]:void 0,arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},"recvonly"),r={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},s={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},l={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]};if(ao(e,t,"videoExtensions",r,s,l),ao(e,t,"videoCodecs",r,s,l),ao(e,t,"audioExtensions",r,s,l),ao(e,t,"audioCodecs",r,s,l),me("RAISE_H264_BASELINE_PRIORITY")){const f=l.videoCodecs.findIndex(m=>m.rtpMap&&m.rtpMap.encodingName.toLocaleLowerCase()==="h264"&&m.fmtp&&m.fmtp.parameters["profile-level-id"]==="42001f");if(f!==-1){const m=l.videoCodecs.findIndex(E=>E.rtpMap&&E.rtpMap.encodingName.toLocaleLowerCase()==="h264");if(m<f){G.debug("raising H264 baseline profile priority");const E=l.videoCodecs[f];l.videoCodecs.splice(f,1),l.videoCodecs.splice(m,0,E)}m!==-1&&(s.videoCodecs=s.videoCodecs.filter(E=>!(E.rtpMap&&E.rtpMap.encodingName.toLocaleLowerCase()==="h264"&&E.fmtp&&E.fmtp.parameters["profile-level-id"]!=="42001f")))}}return{send:r,recv:s,sendrecv:l}}function ao(e,t,r,s,l,f){if(r==="videoExtensions"||r==="audioExtensions"){const m=[];return e[r].forEach(E=>{t[r].some((y,b)=>{if(E.entry===y.entry&&E.extensionName===y.extensionName)return m.push(b),!0})?f[r].push(E):s[r].push(E)}),void t[r].forEach((E,y)=>{m.indexOf(y)===-1&&l[r].push(E)})}if(r==="videoCodecs"||r==="audioCodecs"){const m=[];return e[r].forEach(E=>{t[r].some((y,b)=>{if(E.payloadType===y.payloadType&&JSON.stringify(E)===JSON.stringify(y))return m.push(b),!0})?f[r].push(E):s[r].push(E)}),void t[r].forEach((E,y)=>{m.indexOf(y)===-1&&l[r].push(E)})}}function NI(e){const{send:t,recv:r,sendrecv:s}=e;if(!s){if(!t||!r)throw new Error("cannot merge rtp capabilities because one of send or recv is empty!");return{send:t,recv:r}}let l,f;return t?(l={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},l.audioCodecs=[...t.audioCodecs,...s.audioCodecs],l.videoCodecs=[...t.videoCodecs,...s.videoCodecs],l.audioExtensions=[...t.audioExtensions,...s.audioExtensions],l.videoExtensions=[...t.videoExtensions,...s.videoExtensions]):l=s,r?(f={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},f.audioCodecs=[...r.audioCodecs,...s.audioCodecs],f.videoCodecs=[...r.videoCodecs,...s.videoCodecs],f.audioExtensions=[...r.audioExtensions,...s.audioExtensions],f.videoExtensions=[...r.videoExtensions,...s.videoExtensions]):f=s,{send:l,recv:f}}function zg(e){e.media.mediaType==="audio"&&e.attributes.payloads.filter(t=>{var r;return((r=t.rtpMap)===null||r===void 0?void 0:r.encodingName.toLowerCase())==="opus"}).forEach(t=>{t.fmtp||(t.fmtp={parameters:{}}),t.fmtp.parameters.stereo="1",t.fmtp.parameters["sprop-stereo"]="1"})}function p1(e,t,r,s){let l=[];if(e===ut.VIDEO){if(me("H264_PROFILE_LEVEL_ID")&&s==="h264"&&(l=t.videoCodecs.filter(f=>{var m;return ht(m=f.rtpMap&&f.rtpMap.encodingName.toLowerCase()||"").call(m,s)&&f&&f.fmtp&&f.fmtp.parameters["profile-level-id"]===me("H264_PROFILE_LEVEL_ID")})),!Array.isArray(l)||l.length===0){let f=[];const m=[],E=[],y=[];if(r.videoCodecs.forEach(b=>{const A=b.rtpMap&&b.rtpMap.encodingName.toLowerCase()||"";ht(A).call(A,s)?f.push(b):ht(A).call(A,"vp9")?m.push(b):ht(A).call(A,"vp8")?E.push(b):ht(A).call(A,"h264")&&y.push(b)}),f.length===0){let b="";m.length!==0?(f=m,b="vp9"):E.length!==0?(f=E,b="vp8"):y.length!==0&&(f=y,b="h264"),G.warning("codec ".concat(s," not included in rtpCapabilities, fallback to default payloads: ").concat(b))}f.length!==0&&(l=t.videoCodecs.filter(b=>f.some(A=>A.payloadType===b.payloadType)))}if(l.length===0&&(G.warning("codec ".concat(s," not included in rtpCapabilities, fallback to default payloads: ").concat(t.videoCodecs[0].rtpMap&&t.videoCodecs[0].rtpMap.encodingName)),l=t.videoCodecs),me("USE_PUB_RTX")||me("USE_SUB_RTX")){const f=bh(l,t.videoCodecs);l=[...l,...f]}}else{l=t.audioCodecs.filter(m=>{var E;return ht(E=m.rtpMap&&m.rtpMap.encodingName.toLowerCase()||"").call(E,s)});const f=t.audioCodecs.filter(m=>{var E;return ht(E=m.rtpMap&&m.rtpMap.encodingName.toLowerCase()||"").call(E,"red")});l.length===0&&(G.warning("codec ".concat(s," not included in rtpCapabilities, fallback to opus")),l=t.audioCodecs.filter(m=>{var E;return ht(E=m.rtpMap&&m.rtpMap.encodingName.toLowerCase()||"").call(E,"opus")})),me("ENABLE_AUDIO_RED")&&f.length!==0&&(l=[...f,...l])}return l}function bh(e,t){const r=e.map(s=>s.payloadType.toString());return t.filter(s=>s.rtpMap&&s.rtpMap.encodingName==="rtx"&&s.fmtp&&s.fmtp.parameters.apt&&ht(r).call(r,s.fmtp&&s.fmtp.parameters.apt))}async function US(e,t,r){const s=t.toString(),l=LI(s,"offer","remote","exchangeSDP");await e.setRemoteDescription({type:"offer",sdp:s});const f=await e.createAnswer();if(!f.sdp)throw new Error("cannot get answer sdp");let m=f.sdp;m=K8(m,r||{}),l==null||l(m||""),await e.setLocalDescription({type:"answer",sdp:m})}function K8(e,t,r){const s=on(e),{useXR:l}=t;return s.mediaDescriptions.forEach(f=>{var m;f.attributes.mid&&(Array.isArray(r)&&!ht(r).call(r,f.attributes.mid)||(f.media.mediaType==="audio"&&zg(f),l&&ht(m=["audio","video"]).call(m,f.media.mediaType)&&f.attributes.payloads.forEach(E=>{E.rtcpFeedbacks.findIndex(y=>y.type==="rrtr")===-1&&E.rtcpFeedbacks.push({type:"rrtr"})})))}),zr(s)}function LI(e,t,r,s){if(me("SDP_LOGGING"))return G.upload("exchanging ".concat(r," ").concat(t," SDP during P2PConnection.").concat(s,`
`),e),t==="offer"?l=>{LI(l,"answer",r==="local"?"remote":"local",s)}:void 0}function oD(e){const t=me("COMPATIBLE_SDP_EXTENSION");return!!(Array.isArray(t)&&t.length>0)&&t.some(r=>ht(e).call(e,r))}function sf(e,t){try{var r;return((r=e.fmtp)===null||r===void 0?void 0:r.parameters.apt)===t.payloadType.toString()}catch{return!1}}function m1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),r.push.apply(r,s)}return r}function Yc(e,t){return typeof me(e)===t?me(e):void 0}function NY(){try{const e=me("EXPERIMENTS")||{};return typeof e=="string"||Array.isArray(e)?{}:function(t){for(var r=1;r<arguments.length;r++){var s=arguments[r]!=null?arguments[r]:{};r%2?m1(Object(s),!0).forEach(function(l){ne(t,l,s[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):m1(Object(s)).forEach(function(l){Object.defineProperty(t,l,Object.getOwnPropertyDescriptor(s,l))})}return t}({},e)}catch(e){return G.debug("handle gateway attributes failed: ",e),{}}}const DI={};function Ch(e){(!(arguments.length>1&&arguments[1]!==void 0)||arguments[1])&&G.debug("install service ".concat(e.name)),DI[e.name]=e}function wh(e){const t=DI[e];if(!t)throw new Ke(se.INVALID_OPERATION,"".concat(e," not found, please use AgoraRTC.use(").concat(e,"Service) to load it first"));return t}function q8(e,t){return wh("DataStream").create(e,t)}function PI(){return wh("InterceptFrame").create()}function cD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),r.push.apply(r,s)}return r}function Rh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?cD(Object(r),!0).forEach(function(s){ne(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):cD(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}const of=new Map;class AU extends Xt{get state(){return this._state}set state(t){if(t===this._state)return;const r=this._state;this._state=t,t==="DISCONNECTED"&&this._disconnectedReason?this.emit(Qe.CONNECTION_STATE_CHANGE,t,r,this._disconnectedReason):this.emit(Qe.CONNECTION_STATE_CHANGE,t,r)}get joinGatewayStartTime(){return this._joinGatewayStartTime}set joinGatewayStartTime(t){G.debug("[".concat(this.store.clientId,"] set joinGatewayStartTime at ").concat(t)),this._joinGatewayStartTime=t}constructor(t,r){var s,l,f;super(),ne(this,"store",void 0),ne(this,"joinInfo",void 0),ne(this,"key",void 0),ne(this,"ntpOffset",0),ne(this,"signal",void 0),ne(this,"role",void 0),ne(this,"inChannelInfo",{joinAt:null,duration:0}),ne(this,"spec",void 0),ne(this,"_state","DISCONNECTED"),ne(this,"_statsCollector",void 0),ne(this,"_disconnectedReason",void 0),ne(this,"isSignalRecover",!1),ne(this,"hasChangeBGPAddress",!1),ne(this,"trafficStatsInterval",void 0),ne(this,"networkQualityInterval",void 0),ne(this,"_joinGatewayStartTime",0),ne(this,"_signalTimeout",!1),ne(this,"_clientRoleOptions",void 0),ne(this,"_isProactiveJoin",!1),this.store=t,this.spec=r,this.signal=this.store.useP2P?(s={spec:Rh(Rh({},r),{},{retryConfig:r.websocketRetryConfig}),store:t},(l=(f=wh("P2PChannel")).createSubmodule)===null||l===void 0?void 0:l.call(f,s)):new W8(Rh(Rh({},r),{},{retryConfig:r.websocketRetryConfig}),t),this._statsCollector=r.statsCollector,this.role=r.role||"audience",this._clientRoleOptions=r.clientRoleOptions,this.handleSignalEvents()}async join(t,r,s){this.store.joinGatewayStart(),t.cloudProxyServer!=="disabled"&&(this.hasChangeBGPAddress=!0);const l=Date.now();let f=of.get(t.cname);if(f||(f=new Map,of.set(t.cname,f)),this._isProactiveJoin=!0,f.has(t.uid)){const b=new xe(se.UID_CONFLICT);throw Vt.joinGateway(t.sid,{lts:l,succ:!1,ec:b.code,addr:null,uid:t.uid,cid:t.cid,firstSuccess:this._isProactiveJoin,isProxy:!!t.proxyServer,signalChannel:"0",preload:t.preload}),b}f.set(t.uid,!0),this.joinInfo=t,this.key=r;let m=0;this.joinGatewayStartTime=l;const E=t.proxyServer;try{G.debug("[".concat(this.store.clientId,"] use websocket join uid ").concat(m));const b=t.gatewayAddrs.map(A=>{let{address:O}=A;const[D,P]=O.split(":"),F={host:D,port:P};return t.proxyServer&&(F.proxy=t.proxyServer),F});m=(await this.signal.init(b)).uid,G.debug("[".concat(this.store.clientId,"] websocket join uid ").concat(m," cost ").concat(Date.now()-this.joinGatewayStartTime))}catch(b){var y;throw G.error("[".concat(this.store.clientId,"] User join failed"),b.toString()),Vt.joinGateway(t.sid,{lts:l,succ:!1,ec:((y=b.data)===null||y===void 0?void 0:y.desc)||b.code,errorMsg:b.message,addr:this.signal.url,uid:t.uid,cid:t.cid,firstSuccess:this._isProactiveJoin,isProxy:!!E,signalChannel:"0",preload:t.preload}),f.delete(t.uid),this.signal.close(),b}return this.state="CONNECTED",this.inChannelInfo.joinAt=Date.now(),G.debug("[".concat(this.store.clientId,"] Connected to gateway server")),this.trafficStatsInterval=window.setInterval(()=>{this.updateTrafficStats().catch(b=>{G.warning("[".concat(this.store.clientId,"] get traffic stats error"),b.toString())})},3e3),this.networkQualityInterval=window.setInterval(()=>{navigator&&navigator.onLine!==void 0&&!navigator.onLine?this.emit(Qe.NETWORK_QUALITY,{downlinkNetworkQuality:6,uplinkNetworkQuality:6}):this._signalTimeout?this.emit(Qe.NETWORK_QUALITY,{downlinkNetworkQuality:5,uplinkNetworkQuality:5}):this.state==="CONNECTED"&&this._statsCollector.trafficStats?this.emit(Qe.NETWORK_QUALITY,{uplinkNetworkQuality:TU(this._statsCollector.trafficStats.B_unq),downlinkNetworkQuality:TU(this._statsCollector.trafficStats.B_dnq)}):this.emit(Qe.NETWORK_QUALITY,{uplinkNetworkQuality:0,downlinkNetworkQuality:0})},2e3),this.store.joinGatewayEnd(),m}async leave(){let t=arguments.length>0&&arguments[0]!==void 0&&arguments[0],r=arguments.length>1?arguments[1]:void 0;if(this.state!=="DISCONNECTED"){r!==nr.FALLBACK&&(this.state="DISCONNECTING");try{t||this.signal.connectionState!==Fr.CONNECTED||await function(s,l){return l===1/0?s:gt.race([s,d8(l)])}(this.signal.request(cn.LEAVE,void 0,!0),3e3)}catch(s){G.warning("[".concat(this.store.clientId,"] leave request failed, ignore"),s)}this.signal.close(r),r!==nr.FALLBACK&&(this.state="DISCONNECTED"),this.reset()}}async publish(t,r,s){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new xe(se.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));const l={state:"offer",p2p_id:this.store.p2pId,ortc:r,mode:this.spec.mode,extend:me("PUB_EXTEND"),twcc:!!me("PUBLISH_TWCC"),rtx:!!me("USE_PUB_RTX")};try{return(await this.signal.request(cn.PUBLISH,l,!0))._message}catch(f){if(s&&f.data&&f.data.code===Wt.ERR_PUBLISH_REQUEST_INVALID)return G.warning("[".concat(this.store.clientId,"] receive publish error code, retry"),f.toString()),await this.tryUnpubBeforeRepub(t,r),this.publish(t,r,!1);throw f}}async publishDataChannel(t,r,s){var l;if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new xe(se.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));const f={stream_id:r.streamId,ordered:r.ordered?1:0,max_retrans_times:(l=r.maxRetransmits)!==null&&l!==void 0?l:10,channel_id:r.channelId,metadata:r.metadata};try{await this.signal.request(cn.PUBLISH_DATASTREAM,f,!0)}catch(m){if(s&&m.data&&m.data.code===Wt.ERR_PUBLISH_REQUEST_INVALID)return G.warning("[".concat(this.store.clientId,"] receive publish datachannels error code, retry"),m.toString()),await this.tryUnpubDataChannelBeforeRepub(t,r),this.publishDataChannel(t,r,!1);throw m}}async unpublish(t,r){try{if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new xe(se.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));await this.signal.request(cn.UNPUBLISH,{stream_id:r,ortc:t},!0)}catch(s){G.warning("[".concat(this.store.clientId,"] unpublish warning: "),s)}}async unpublishDataChannel(t){try{if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new xe(se.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));await gt.all(t.map(r=>this.signal.request(cn.UNPUBLISH_DATASTREAM,{channel_id:r},!0)))}catch(r){G.warning("unpublish datachannels warning: ",r)}}async presubscribe(t,r,s){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new xe(se.INVALID_OPERATION,"can not presubscribe when connection state is ".concat(this.state));const l={stream_id:t,stream_type:r,mode:this.spec.mode,codec:this.spec.codec,p2p_id:this.store.p2pId,twcc:!!me("SUBSCRIBE_TWCC"),rtx:!!me("USE_SUB_RTX")||void 0,extend:me("SUB_EXTEND"),svc:Array.isArray(me("SVC"))&&me("SVC").length!==0?me("SVC"):void 0};try{return await this.signal.request(cn.PRE_SUBSCRIBE,l,!0)}catch(f){if(s&&f.data&&f.data.code===Wt.ERR_SUBSCRIBE_REQUEST_INVALID)return G.warning("[".concat(this.store.clientId,"] pre-subscribe error, retry"),f.toString()),this.presubscribe(t,r,!1);throw f}}async subscribe(t,r,s){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new xe(se.INVALID_OPERATION,"can not subscribe when connection state is ".concat(this.state));const l={stream_id:t,stream_type:r.stream_type,mode:this.spec.mode,codec:this.spec.codec,p2p_id:this.store.p2pId,twcc:!!me("SUBSCRIBE_TWCC"),rtx:!!me("USE_SUB_RTX"),extend:me("SUB_EXTEND"),ssrcId:r.ssrcId,svc:Array.isArray(me("SVC"))&&me("SVC").length!==0?me("SVC"):void 0};try{return(await this.signal.request(cn.SUBSCRIBE,l,!0))._message}catch(f){if(s&&f.data&&f.data.code===Wt.ERR_SUBSCRIBE_REQUEST_INVALID)return G.warning("[".concat(this.store.clientId,"] receiver subscribe error code, retry"),f.toString()),await this.tryUnsubBeforeResub(t,r),await this.subscribe(t,r,!1);throw f}}async subscribeDataChannel(t,r,s){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new xe(se.INVALID_OPERATION,"can not subscribe datachannel when connection state is ".concat(this.state));const l={uid:t,stream_id:r.id,channel_id:r.datachannelId};try{return void await this.signal.request(cn.SUBSCRIBE_DATASTREAM,l,!0)}catch(f){if(s&&f.data&&f.data.code===Wt.ERR_SUBSCRIBE_REQUEST_INVALID)return G.warning("[".concat(this.store.clientId,"] receiver subscribe datachannel error code, retry"),f.toString()),await this.tryUnsubDataChannelBeforeResub(t,r),await this.subscribeDataChannel(t,r,!1);throw f}}async subscribeAll(t,r){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new xe(se.INVALID_OPERATION,"can not massSubscribe when connection state is ".concat(this.state));const s={p2p_id:this.store.p2pId,users:t,dtx:!1,rtx:!!me("USE_SUB_RTX"),twcc:!!me("SUBSCRIBE_TWCC"),svc:Array.isArray(me("SVC"))&&me("SVC").length!==0?me("SVC"):void 0};try{return await this.signal.request(cn.SUBSCRIBE_STREAMS,s,!0)}catch(l){if(r&&l.data&&l.data.code===Wt.ERR_SUBSCRIBE_REQUEST_INVALID)return G.warning("[".concat(this.store.clientId,"] receiver massSubscribe error code, retry"),l.toString()),await this.tryMassUnsubBeforeResub(t),await this.subscribeAll(t,!1);throw l}}async setVideoProfile(t){const r=function(s){if(!(s.bitrateMax&&s.bitrateMin&&s.frameRate&&s.height&&s.width))return;let l=s.frameRate,f=s.width,m=s.height,E=!0;return typeof l!="number"&&(l=l.exact||l.ideal||l.max||l.min||0,l||(E=!1)),typeof f!="number"&&(f=f.exact||f.ideal||f.max||f.min||0,f||(E=!1)),typeof m!="number"&&(m=m.exact||m.ideal||m.max||m.min||0,l||(E=!1)),E?{stream_type:0,width:f,height:m,fps:l,start_bps:1e3*s.bitrateMax,min_bps:1e3*s.bitrateMin,target_bps:1e3*s.bitrateMax}:void 0}(t);if(r)return this.signal.request(cn.SET_VIDEO_PROFILE,r);G.debug("[".concat(this.store.clientId,"] encoder config is not complete, do not report to gateway"))}async unsubscribe(t,r){try{await this.signal.request(cn.UNSUBSCRIBE,{p2p_id:this.store.p2pId,ortc:t,stream_id:r},!0)}catch(s){G.warning("[".concat(this.store.clientId,"] unsubscribe warning: "),s)}}async unsubscribeDataChannel(t,r){try{if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new xe(se.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));await gt.all(t.map(s=>this.signal.request(cn.UNSUBSCRIBE_DATASTREAM,{stream_id:s,uid:r},!0)))}catch(s){G.warning("unsubscribeDataChannel warning: ",s)}}async massUnsubscribe(t){try{await this.signal.request(cn.UNSUBSCRIBE_STREAMS,t,!0)}catch(r){G.warning("[".concat(this.store.clientId,"] massUnsubscribeAll warning: "),r)}}async reconnectPC(t){const{iceParameters:r,dtlsParameters:s,rtpCapabilities:l}=t;return{gatewayEstablishParams:await this.signal.request(cn.CONNECT_PC,{p2p_id:this.store.p2pId,stream_id:this.store.uid,ortc:{iceParameters:r,dtlsParameters:s,rtpCapabilities:l}},!0),gatewayAddress:this.getCurrentGatewayAddress()}}getGatewayInfo(){return this.signal.request(cn.GATEWAY_INFO)}async renewToken(t){await this.signal.request(cn.RENEW_TOKEN,t),this.key=t.token}updateClientRole(t,r){r&&(this._clientRoleOptions=Object.assign({},r)),me("CLIENT_ROLE_OPTIONS")&&(G.debug("[".concat(this.store.clientId,"] Set roleOptions for ").concat(JSON.stringify(me("CLIENT_ROLE_OPTIONS"))," instead of ").concat(JSON.stringify(this._clientRoleOptions)," ")),this._clientRoleOptions=Object.assign({},me("CLIENT_ROLE_OPTIONS"))),this.role=t}async setClientRole(t,r){if(r&&(this._clientRoleOptions=Object.assign({},r)),me("CLIENT_ROLE_OPTIONS")&&(this._clientRoleOptions=Object.assign({},me("CLIENT_ROLE_OPTIONS")),G.debug("[".concat(this.store.clientId,"] Set roleOptions for ").concat(JSON.stringify(me("CLIENT_ROLE_OPTIONS"))," instead of ").concat(JSON.stringify(this._clientRoleOptions)," "))),this.state!=="CONNECTED")return void(this.role=t);let s,l=0;t==="audience"?this._clientRoleOptions&&this._clientRoleOptions.delay?(s=this._clientRoleOptions.delay,l=1):l=this._clientRoleOptions&&this._clientRoleOptions.level?this._clientRoleOptions.level:2:l=0,await this.signal.request(cn.SET_CLIENT_ROLE,{role:t,level:l,delay:s,client_ts:Date.now()}),this.role=t}async setRemoteVideoStreamType(t,r){await this.signal.request(cn.SWITCH_VIDEO_STREAM,{stream_id:t,stream_type:r})}async setDefaultRemoteVideoStreamType(t){await this.signal.request(cn.DEFAULT_VIDEO_STREAM,{stream_type:t})}async setStreamFallbackOption(t,r){await this.signal.request(cn.SET_FALLBACK_OPTION,{stream_id:t,fallback_type:r})}async pickSVCLayer(t,r){await this.signal.request(cn.PICK_SVC_LAYER,{stream_id:t,spatial_layer:r.spatialLayer,temporal_layer:r.temporalLayer})}async setRTM2Flag(t){await this.signal.request(cn.SET_RTM2_FLAG,{rtm2_flag:t})}async sendExtensionMessage(t,r,s){if(this.store.useP2P)return this.signal.sendExtensionMessage(t,r,s)}getInChannelInfo(){return this.inChannelInfo.joinAt&&(this.inChannelInfo.duration=Date.now()-this.inChannelInfo.joinAt),Rh({},this.inChannelInfo)}async getGatewayVersion(){return(await this.signal.request(cn.GATEWAY_INFO)).version}reset(){if(this.inChannelInfo.joinAt&&(this.inChannelInfo.duration=Date.now()-this.inChannelInfo.joinAt,this.inChannelInfo.joinAt=null),this.trafficStatsInterval&&(window.clearInterval(this.trafficStatsInterval),this.trafficStatsInterval=void 0),this.joinInfo){const t=of.get(this.joinInfo.cname);t&&t.delete(this.joinInfo.uid)}this.joinInfo=void 0,this.key=void 0,this.networkQualityInterval&&(window.clearInterval(this.networkQualityInterval),this.networkQualityInterval=void 0)}updateTurnConfigFromSignal(){if(!this.joinInfo)return;const t=function(r){let s;return s=r.startsWith("dc")?r.match(/(dc\:\/\/)?([^:]+):(\d+)/):r.match(/(wss\:\/\/)?([^:]+):(\d+)/),s?{username:ps.username,password:ps.password,turnServerURL:s[2],tcpport:parseInt(s[3])+30,udpport:parseInt(s[3])+30,forceturn:!1}:null}((this.joinInfo.cloudProxyServer==="disabled"?this.signal.url:this.joinInfo.gatewayAddrs[this.signal.currentURLIndex].address)||"");this.joinInfo.turnServer.serversFromGateway=[],t&&this.joinInfo.turnServer.mode!=="off"&&this.joinInfo.cloudProxyServer==="disabled"&&this.joinInfo.turnServer.serversFromGateway.push(Rh(Rh({},ps),{},{turnServerURL:t.turnServerURL,tcpport:t.tcpport,udpport:t.udpport,username:this.joinInfo.uid.toString(),password:this.joinInfo.token}))}async updateTrafficStats(){if(this.state!=="CONNECTED")return;const t=await this.signal.request(cn.TRAFFIC_STATS,void 0,!0);t.timestamp=Date.now(),t.ntp_offset!=null&&(this.ntpOffset=t.ntp_offset),t.peer_delay.forEach(r=>{const s=this._statsCollector.trafficStats&&this._statsCollector.trafficStats.peer_delay.find(l=>l.peer_uid===r.peer_uid);s&&s.B_st!==r.B_st&&gL(()=>{this.emit(Qe.STREAM_TYPE_CHANGE,r.peer_uid,r.B_st)})}),this._statsCollector.updateTrafficStats(t)}getJoinMessage(t){var r;if(!this.joinInfo||!this.key)throw new xe(se.UNEXPECTED_ERROR,"can not generate join message, no join info");const s=Object.assign({},this.joinInfo.apResponse);let l=me("REPORT_APP_SCENARIO");if(typeof l!="string")try{l=JSON.stringify(l)}catch{l=void 0}var f;l&&l.length>128&&(l=void 0),this.store.hasStartJoinChannel=!0,this.store.isABTestSuccess||this.emit(Qe.UPDATE_GATEWAY_CONFIG),f=this.store.clientId,ht(DS).call(DS,f)||DS.push(f);const m=!(ei()||Jd(87)||E8())&&typeof me("ENABLE_PRE_SUB")=="boolean"&&me("ENABLE_PRE_SUB"),E=!E8()&&Yc("ENABLE_PREALLOC_PC","boolean"),y=NY(),b=Vb(87)||function(){const O=qn();if(O.name!==sr.SAFARI||!O.browserVersion)return!1;const D=O.browserVersion.split(".");return Number(D[0])>15||Number(D[0])===15&&Number(D[1])>=4}(),A=Rh({license:this.joinInfo.license,p2p_id:this.store.p2pId,session_id:this.joinInfo.sid,app_id:this.joinInfo.appId,channel_key:this.key,channel_name:this.joinInfo.cname,sdk_version:hs,browser:navigator.userAgent,process_id:me("PROCESS_ID"),mode:this.store.useP2P?"p2p":this.spec.mode,codec:this.spec.codec,role:this.role,has_changed_gateway:this.hasChangeBGPAddress,ap_response:s,extend:me("JOIN_EXTEND"),details:{6:this.joinInfo.stringUid,cservice_map:this.joinInfo.cloudProxyServer==="proxy3"?"1":this.joinInfo.cloudProxyServer==="proxy5"?"2":void 0},features:{rejoin:!0},optionalInfo:this.joinInfo.optionalInfo,appScenario:l,attributes:{userAttributes:Rh(Rh({enableEncodedTransform:!!me("ENABLE_AUDIO_METADATA")&&b||!!me("ENABLE_AUDIO_TOPN")&&hL(sr.CHROME,87,116)||void 0,enableAudioMetadata:!!me("ENABLE_AUDIO_METADATA")&&b,enableAudioPts:!!me("ENABLE_AUDIO_PTS_METADATA")&&b,topnSmoothLevel:me("TOPN_SMOOTH_LEVEL"),topnNewSpeakerDelay:me("TOPN_NEW_SPEAKER_DELAY"),topnSwitchHoldMs:me("TOPN_SWITCH_HOLD_MS"),topnAudioGain:me("TOPN_AUDIO_GAIN"),enablePublishedUserList:me("ENABLE_PUBLISHED_USER_LIST"),maxSubscription:me("MAX_SUBSCRIPTION"),subscribeAudioFilterTopN:Yc("SUBSCRIBE_AUDIO_FILTER_TOPN","number"),enablePublishAudioFilter:Yc("ENABLE_PUBLISH_AUDIO_FILTER","boolean"),enableUserLicenseCheck:Yc("ENABLE_USER_LICENSE_CHECK","boolean"),enableRTX:me("USE_PUB_RTX")===!0||me("USE_SUB_RTX")===!0||void 0,disableFEC:me("DISABLE_FEC"),enableNTPReport:!!me("ENABLE_NTP_REPORT")||void 0,enableInstantVideo:!!me("ENABLE_INSTANT_VIDEO")||void 0,enableFulllinkAvSync:!!me("ENABLE_FULL_LINK_AV_SYNC")||void 0,enableDataStream2:Yc("ENABLE_DATASTREAM_2","boolean"),enableAutFeedback:!!me("ENABLE_AUT_FEEDBACK")||void 0,rtm2Flag:typeof this.joinInfo.rtmFlag=="number"?this.joinInfo.rtmFlag:void 0,enableUserAutoRebalanceCheck:!!me("ENABLE_USER_AUTO_REBALANCE_CHECK"),enableXR:Yc("USE_XR","boolean"),enableLossbasedBwe:Yc("ENABLE_LOSSBASED_BWE","boolean"),enableAutCC:!!me("ENABLE_AUT_CC")||void 0,enableCCFallback:Yc("ENABLE_CC_FALLBACK","boolean"),enablePreallocPC:E,preSubNum:m?Yc("PRE_SUB_NUM","number"):void 0,enablePubTWCC:Yc("PUBLISH_TWCC","boolean"),enableSubTWCC:Yc("SUBSCRIBE_TWCC","boolean"),enablePubRTX:Yc("USE_PUB_RTX","boolean"),enableSubRTX:Yc("USE_SUB_RTX","boolean"),enableSubSVC:me("ENABLE_SVC")?me("ENABLE_SVC_DEFAULT_CODECS"):Array.isArray(me("SVC"))&&me("SVC").length!==0?me("SVC"):void 0,enableSvcExtended:me("ENABLE_SVC")&&Array.isArray(me("SVC_EXTENDED"))&&me("SVC_EXTENDED").length!==0?me("SVC_EXTENDED"):void 0},y),{},{audioDuplicate:Yc("ENABLE_AUDIO_RED","boolean")?(r=Yc("AUDIO_DUPLICATE_NUM","number"))!==null&&r!==void 0?r:2:void 0})},join_ts:this.joinGatewayStartTime},t);return this.joinInfo.stringUid&&(A.string_uid=this.joinInfo.stringUid),this.joinInfo.aesmode&&this.joinInfo.aespassword&&(A.aes_mode=this.joinInfo.aesmode,me("ENCRYPT_AES")?(A.aes_secret=this.joinInfo.aespassword,A.aes_encrypt=!0):A.aes_secret=this.joinInfo.aespassword,this.joinInfo.aessalt&&(A.aes_salt=this.joinInfo.aessalt)),s.addresses[this.signal.websocket.currentURLIndex]&&(A.ap_response.ticket=s.addresses[this.signal.websocket.currentURLIndex].ticket,delete s.addresses),this.joinInfo.defaultVideoStream!==void 0&&(A.default_video_stream=this.joinInfo.defaultVideoStream),A}getRejoinMessage(){if(!this.joinInfo)throw new xe(se.UNEXPECTED_ERROR,"can not generate rejoin message, no join info");return{session_id:this.joinInfo.sid,channel_name:this.joinInfo.cname,cid:this.joinInfo.cid,uid:this.joinInfo.uid,vid:Number(this.joinInfo.vid)}}handleSignalEvents(){this.signal.on(Ft.WS_RECONNECT_CREATE_CONNECTION,t=>{this.joinGatewayStartTime=Date.now()}),this.signal.on(Ft.WS_RECONNECTING,t=>{this.joinInfo&&Vt.WebSocketQuit(this.joinInfo.sid,{lts:Date.now(),succ:-1,cname:this.joinInfo.cname,uid:this.joinInfo.uid,cid:this.joinInfo.cid,errorCode:t||Fn.NETWORK_ERROR}),this.joinInfo&&(this.state="RECONNECTING",Vt.sessionInit(this.joinInfo.sid,{lts:new Date().getTime(),extend:this.isSignalRecover?{recover:!0}:{rejoin:!0},cname:this.joinInfo.cname,appid:this.joinInfo.appId,mode:this.spec.mode,stringUid:this.joinInfo.stringUid,channelProfile:this.spec.mode==="live"?1:0,channelMode:0,lsid:this.joinInfo.sid,clientRole:this.role==="audience"?2:1,buildFormat:1}),this.isSignalRecover=!1,this.joinGatewayStartTime=Date.now())}),this.signal.on(Ft.WS_CLOSED,t=>{let r;switch(t){case nr.LEAVE:r=Fn.LEAVE;break;case nr.UID_BANNED:case nr.IP_BANNED:case nr.CHANNEL_BANNED:case nr.SERVER_ERROR:r=Fn.SERVER_ERROR;break;case nr.FALLBACK:r=Fn.FALLBACK;break;case nr.LICENSE_MISSING:case nr.LICENSE_EXPIRED:case nr.LICENSE_MINUTES_EXCEEDED:case nr.LICENSE_PERIOD_INVALID:case nr.LICENSE_MULTIPLE_SDK_SERVICE:case nr.LICENSE_ILLEGAL:case nr.TOKEN_EXPIRE:r=t;break;default:r=Fn.NETWORK_ERROR}G.debug("[".concat(this.store.clientId,"] [signal] websocket closed, reason: ").concat(r||"undefined -> "+Fn.NETWORK_ERROR)),this.joinInfo&&Vt.WebSocketQuit(this.joinInfo.sid,{lts:Date.now(),succ:t===nr.LEAVE?1:-1,cname:this.joinInfo.cname,uid:this.joinInfo.uid,cid:this.joinInfo.cid,errorCode:r}),this._disconnectedReason=t,t!==nr.FALLBACK&&(this.state="DISCONNECTED"),this.reset()}),this.signal.on(Ft.WS_CONNECTED,()=>{if(this.updateTurnConfigFromSignal(),this.state="CONNECTED",this.joinInfo){if(this.role==="audience"){const t=me("CLIENT_ROLE_OPTIONS")||this._clientRoleOptions;t&&(t.level||t.delay)&&(G.debug("[".concat(this.store.clientId,"] patch to send set client role, role: ").concat(this.role,", mode: ").concat(this.spec.mode,", level: ").concat(t.level,", delay: ").concat(t.delay)),this.setClientRole(this.role,t))}if(Vt.joinGateway(this.joinInfo.sid,{lts:this.joinGatewayStartTime,succ:!0,ec:null,vid:this.joinInfo.vid,addr:this.signal.url,uid:this.joinInfo.uid,cid:this.joinInfo.cid,firstSuccess:this._isProactiveJoin,isProxy:!!this.joinInfo.proxyServer,signalChannel:"0",preload:this.joinInfo.preload,isABTestSuccess:this.store.isABTestSuccess}),this._isProactiveJoin=!1,this.joinInfo.useLocalAccessPoint&&this.joinInfo.setLocalAPVersion===1){const t=this.signal.url&&this.signal.url.match(/wss\:\/\/([^:]+):(\d+)/);if(!t)return void G.error("[".concat(this.store.clientId,"] set local access point after joined failed: ").concat(t));Dn("EVENT_REPORT_DOMAIN",t[1]),Dn("EVENT_REPORT_BACKUP_DOMAIN",t[1]),Dn("LOG_UPLOAD_SERVER","".concat(t[1],":6444"))}}}),this.signal.on(yn.ON_UPLINK_STATS,t=>{this._statsCollector.updateUplinkStats(t)}),this.signal.on(Ft.REQUEST_RECOVER,(t,r,s)=>{if(!this.joinInfo)return s(new xe(se.UNEXPECTED_ERROR,"gateway: can not recover, no join info"));t&&(this.joinInfo.multiIP=t,this.hasChangeBGPAddress=!0),this.isSignalRecover=!0,la(this,Qe.REQUEST_NEW_GATEWAY_LIST).then(r).catch(s)}),this.signal.on(Ft.REQUEST_JOIN_INFO,async(t,r,s)=>{var l;if(this.updateTurnConfigFromSignal(),this.store.useP2P)return void t(this.getJoinMessage({ortc:{}}));const f=Mn((l=this.joinInfo)===null||l===void 0?void 0:l.turnServer);if(me("NEW_TURN_MODE")&&f){let b=f.servers,A=f.serversFromGateway;const O=this.signal.currentURLIndex;b.length>0&&(b=[b[O%b.length]],f.servers=b),Array.isArray(A)&&A.length>0&&(A=[A[0]],f.serversFromGateway=A),G.debug("[".concat(this.store.clientId,"] use single turn, use turn server index: ").concat(O))}const{iceParameters:m,dtlsParameters:E,rtpCapabilities:y}=await la(this,Qe.REQUEST_P2P_CONNECTION_PARAMS,{turnServer:f});try{t(this.getJoinMessage({ortc:{iceParameters:m,dtlsParameters:E,rtpCapabilities:y,version:"2"}}))}catch(b){r(b)}}),this.signal.on(Ft.REQUEST_REJOIN_INFO,t=>{t(this.getRejoinMessage())}),this.signal.on(Ft.REPORT_JOIN_GATEWAY,(t,r)=>{if(!this.joinInfo)return;let s,l="";var f;t instanceof xe?(s=((f=t.data)===null||f===void 0?void 0:f.desc)||t.code,l=t.message):s=t,Vt.joinGateway(this.joinInfo.sid,{lts:this.joinGatewayStartTime,succ:!1,ec:s,errorMsg:l,addr:r,uid:this.joinInfo.uid,cid:this.joinInfo.cid,firstSuccess:this._isProactiveJoin,isProxy:!!this.joinInfo.proxyServer,signalChannel:"0",preload:this.joinInfo.preload})}),this.signal.on(Ft.IS_P2P_DISCONNECTED,t=>{t(Fb(this,Qe.IS_P2P_DISCONNECTED))}),this.signal.on(Ft.DISCONNECT_P2P,()=>{this.emit(Qe.DISCONNECT_P2P)}),this.signal.on(Ft.REQUEST_SUCCESS,()=>{this._signalTimeout=!1}),this.signal.on(Ft.REQUEST_TIMEOUT,()=>{this._signalTimeout=!0}),this.signal.on(Ft.JOIN_RESPONSE,t=>{const r=this.getCurrentGatewayAddress();this.emit(Qe.JOIN_RESPONSE,t,r)}),this.signal.on(Ft.PRE_CONNECT_PC,async()=>{if(this.joinInfo){this.updateTurnConfigFromSignal();const t=this.getCurrentGatewayAddress(),r=me("FINGERPRINT")||this.joinInfo.apResponse.addresses[this.signal.currentURLIndex].fingerprint;if(t&&r){const s=h1(t);this.emit(Qe.PRE_CONNECT_PC,{candidates:s,fingerprint:r})}}}),this.signal.on(Ft.RECOVER_NOTIFICATION,t=>{this.joinInfo&&typeof me("AP_REQUEST_DETAIL")=="string"&&(this.joinInfo.apRequestDetail="".concat(me("AP_REQUEST_DETAIL"),";").concat(t))})}async tryUnsubBeforeResub(t,r){try{await this.signal.request(cn.UNSUBSCRIBE,{p2p_id:this.store.p2pId,stream_id:t,ortc:[r]},!0)}catch(s){throw G.warning("[".concat(this.store.clientId,"] tryUnsubBeforeResub warning"),s),s}}async tryUnsubDataChannelBeforeResub(t,r){try{await this.signal.request(cn.UNSUBSCRIBE,{stream_id:r.id},!0)}catch(s){throw G.warning("unsubscribe datachannel warning",s),s}}async tryUnpubBeforeRepub(t,r){try{await this.signal.request(cn.UNPUBLISH,{stream_id:t,ortc:r},!0)}catch(s){throw G.warning("[".concat(this.store.clientId,"] tryUnpubBeforeRepub warning: "),s),s}}async tryUnpubDataChannelBeforeRepub(t,r){try{await this.signal.request(cn.UNPUBLISH_DATASTREAM,{channnel_id:r.channelId},!0)}catch(s){throw G.warning("unpublish datastream warning: ",s),s}}async tryMassUnsubBeforeResub(t){const r={users:t.map(s=>({stream_id:s.stream_id,stream_type:s.stream_type}))};try{await this.signal.request(cn.UNSUBSCRIBE_STREAMS,r,!0)}catch(s){throw G.warning("[".concat(this.store.clientId,"] tryMassUnsubBeforeResub warning"),s),s}}async muteLocal(t,r){const s={action:t.find(l=>l.stream_type===Er.Audio)?"mute_local_audio":"mute_local_video",p2p_id:this.store.p2pId,ortc:t,stream_id:r};try{await this.signal.request(cn.CONTROL,s,!0,!0)}catch(l){throw G.warning("[".concat(this.store.clientId,"] gateway muteLocal warning: "),l),l}}async unmuteLocal(t,r){const s={action:t.find(l=>l.stream_type===Er.Audio)?"unmute_local_audio":"unmute_local_video",p2p_id:this.store.p2pId,ortc:t,stream_id:r};try{await this.signal.request(cn.CONTROL,s,!0,!0)}catch(l){throw G.warning("[".concat(this.store.clientId,"] gateway unmuteLocal warning: "),l),l}}async muteRemote(t,r){const s={action:t===ut.AUDIO?"mute_remote_audio":"mute_remote_video",p2p_id:this.store.p2pId,stream_id:r};try{await this.signal.request(cn.CONTROL,s,!0,!0)}catch(l){throw G.warning("[".concat(this.store.clientId,"] gateway muteRemote warning: "),l),l}}async unmuteRemote(t,r){const s={action:t===ut.AUDIO?"unmute_remote_audio":"unmute_remote_video",p2p_id:this.store.p2pId,stream_id:r};try{await this.signal.request(cn.CONTROL,s,!0,!0)}catch(l){throw G.warning("[".concat(this.store.clientId,"] gateway unmuteRemote warning: "),l),l}}uploadWRTCStats(t){this.signal.uploadWRTCStats(t)}upload(t,r){this.signal.upload(t,r)}getSignalRTT(){return this.signal.rtt}async restartICE(t){const r={p2p_id:this.store.p2pId,stream_id:this.store.uid,ortc:t};try{return await this.signal.request(cn.RESTART_ICE,r,!0)}catch(s){throw G.warning("[".concat(this.store.clientId,"] P2PChannel.restartICE warning: "),s),s}}reconnect(t,r){this.state==="CONNECTED"&&this.signal.reconnect(t||void 0,r||Fn.P2P_FAILED)}getCurrentGatewayAddress(){var t,r;if(!me("GATEWAY_WSS_ADDRESS"))return me("USE_CANDIDATE_FROM_AP_DETAIL")&&(t=this.joinInfo)!==null&&t!==void 0&&t.apGatewayAddress?(G.debug("[".concat(this.store.clientId,"] use candidate from ap detail, ").concat(JSON.stringify(this.joinInfo.apGatewayAddress))),this.joinInfo.apGatewayAddress):(r=this.joinInfo)!==null&&r!==void 0&&r.gatewayAddrs?this.joinInfo.gatewayAddrs[this.signal.currentURLIndex]:void 0}async setPublishAudioFilterEnabled(t){await this.signal.request(cn.SET_PARAMETER,{enablePublishAudioFilter:t})}}let lD=0,MI=0;function cf(e,t,r,s){return new gt((l,f)=>{t.timeout=t.timeout||me("HTTP_CONNECT_TIMEOUT"),t.responseType=t.responseType||"json",t.data&&!r?(t.data=JSON.stringify(t.data),lD+=mh(t.data)):r&&(t.data.size?lD+=t.data.size:t.data instanceof FormData?lD+=EL(t.data):lD+=mh(JSON.stringify(t.data))),t.headers=t.headers||{},t.headers["Content-Type"]=t.headers["Content-Type"]||"application/json",t.method="POST",t.url=e,En.request(t).then(m=>{typeof m.data=="string"?MI+=mh(m.data):m.data instanceof ArrayBuffer||m.data instanceof Uint8Array?MI+=m.data.byteLength:MI+=mh(JSON.stringify(m.data)),s&&l({data:m.data,headers:m.headers}),l(m.data)}).catch(m=>{En.isCancel(m)?f(new xe(se.OPERATION_ABORTED,"cancel token canceled")):m.code==="ECONNABORTED"?f(new xe(se.NETWORK_TIMEOUT,m.message)):m.response?f(new xe(se.NETWORK_RESPONSE_ERROR,m.response.status)):f(new xe(se.NETWORK_ERROR,m.message))})})}/*! formdata-polyfill. MIT License. Jimmy W?rting <https://jimmy.warting.se/opensource> */(function(){var e;function t(He){var tt=0;return function(){return tt<He.length?{done:!1,value:He[tt++]}:{done:!0}}}var r=typeof Object.defineProperties=="function"?Object.defineProperty:function(He,tt,St){return He==Array.prototype||He==Object.prototype||(He[tt]=St.value),He},s,l=function(He){He=[typeof globalThis=="object"&&globalThis,He,typeof window=="object"&&window,typeof self=="object"&&self,typeof g=="object"&&g];for(var tt=0;tt<He.length;++tt){var St=He[tt];if(St&&St.Math==Math)return St}throw Error("Cannot find global object")}(this);function f(He,tt){if(tt)e:{var St=l;He=He.split(".");for(var Ze=0;Ze<He.length-1;Ze++){var J=He[Ze];if(!(J in St))break e;St=St[J]}(tt=tt(Ze=St[He=He[He.length-1]]))!=Ze&&tt!=null&&r(St,He,{configurable:!0,writable:!0,value:tt})}}function m(He){return(He={next:He})[Symbol.iterator]=function(){return this},He}function E(He){var tt=typeof Symbol<"u"&&Symbol.iterator&&He[Symbol.iterator];return tt?tt.call(He):{next:t(He)}}if(f("Symbol",function(He){function tt(J,_e){this.A=J,r(this,"description",{configurable:!0,writable:!0,value:_e})}if(He)return He;tt.prototype.toString=function(){return this.A};var St="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",Ze=0;return function J(_e){if(this instanceof J)throw new TypeError("Symbol is not a constructor");return new tt(St+(_e||"")+"_"+Ze++,_e)}}),f("Symbol.iterator",function(He){if(He)return He;He=Symbol("Symbol.iterator");for(var tt="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),St=0;St<tt.length;St++){var Ze=l[tt[St]];typeof Ze=="function"&&typeof Ze.prototype[He]!="function"&&r(Ze.prototype,He,{configurable:!0,writable:!0,value:function(){return m(t(this))}})}return He}),typeof Object.setPrototypeOf=="function")s=Object.setPrototypeOf;else{var y;e:{var b={};try{b.__proto__={a:!0},y=b.a;break e}catch{}y=!1}s=y?function(He,tt){if(He.__proto__=tt,He.__proto__!==tt)throw new TypeError(He+" is not extensible");return He}:null}var A=s;function O(){this.m=!1,this.j=null,this.v=void 0,this.h=1,this.u=this.C=0,this.l=null}function D(He){if(He.m)throw new TypeError("Generator is already running");He.m=!0}function P(He,tt){return He.h=3,{value:tt}}function F(He){this.g=new O,this.G=He}function B(He,tt,St,Ze){try{var J=tt.call(He.g.j,St);if(!(J instanceof Object))throw new TypeError("Iterator result "+J+" is not an object");if(!J.done)return He.g.m=!1,J;var _e=J.value}catch(be){return He.g.j=null,He.g.s(be),Y(He)}return He.g.j=null,Ze.call(He.g,_e),Y(He)}function Y(He){for(;He.g.h;)try{var tt=He.G(He.g);if(tt)return He.g.m=!1,{value:tt.value,done:!1}}catch(St){He.g.v=void 0,He.g.s(St)}if(He.g.m=!1,He.g.l){if(tt=He.g.l,He.g.l=null,tt.F)throw tt.D;return{value:tt.return,done:!0}}return{value:void 0,done:!0}}function $(He){this.next=function(tt){return He.o(tt)},this.throw=function(tt){return He.s(tt)},this.return=function(tt){return function(St,Ze){D(St.g);var J=St.g.j;return J?B(St,"return"in J?J.return:function(_e){return{value:_e,done:!0}},Ze,St.g.return):(St.g.return(Ze),Y(St))}(He,tt)},this[Symbol.iterator]=function(){return this}}function ee(He,tt){return tt=new $(new F(tt)),A&&He.prototype&&A(tt,He.prototype),tt}if(O.prototype.o=function(He){this.v=He},O.prototype.s=function(He){this.l={D:He,F:!0},this.h=this.C||this.u},O.prototype.return=function(He){this.l={return:He},this.h=this.u},F.prototype.o=function(He){return D(this.g),this.g.j?B(this,this.g.j.next,He,this.g.o):(this.g.o(He),Y(this))},F.prototype.s=function(He){return D(this.g),this.g.j?B(this,this.g.j.throw,He,this.g.o):(this.g.s(He),Y(this))},f("Array.prototype.entries",function(He){return He||function(){return function(tt,St){tt instanceof String&&(tt+="");var Ze=0,J=!1,_e={next:function(){if(!J&&Ze<tt.length){var be=Ze++;return{value:St(be,tt[be]),done:!1}}return J=!0,{done:!0,value:void 0}}};return _e[Symbol.iterator]=function(){return _e},_e}(this,function(tt,St){return[tt,St]})}}),typeof Blob<"u"&&(typeof FormData>"u"||!FormData.prototype.keys)){var Ee=function(He,tt){for(var St=0;St<He.length;St++)tt(He[St])},Re=function(He){return He.replace(/\r?\n|\r/g,`\r
`)},Ie=function(He,tt,St){return tt instanceof Blob?(St=St!==void 0?St+"":typeof tt.name=="string"?tt.name:"blob",tt.name===St&&Object.prototype.toString.call(tt)!=="[object Blob]"||(tt=new File([tt],St)),[String(He),tt]):[String(He),String(tt)]},we=function(He,tt){if(He.length<tt)throw new TypeError(tt+" argument required, but only "+He.length+" present.")},Ue=typeof globalThis=="object"?globalThis:typeof window=="object"?window:typeof self=="object"?self:this,ve=Ue.FormData,Ne=Ue.XMLHttpRequest&&Ue.XMLHttpRequest.prototype.send,Ve=Ue.Request&&Ue.fetch,Be=Ue.navigator&&Ue.navigator.sendBeacon,W=Ue.Element&&Ue.Element.prototype,ce=Ue.Symbol&&Symbol.toStringTag;ce&&(Blob.prototype[ce]||(Blob.prototype[ce]="Blob"),"File"in Ue&&!File.prototype[ce]&&(File.prototype[ce]="File"));try{new File([],"")}catch{Ue.File=function(tt,St,Ze){return tt=new Blob(tt,Ze||{}),Object.defineProperties(tt,{name:{value:St},lastModified:{value:+(Ze&&Ze.lastModified!==void 0?new Date(Ze.lastModified):new Date)},toString:{value:function(){return"[object File]"}}}),ce&&Object.defineProperty(tt,ce,{value:"File"}),tt}}var Se=function(He){return He.replace(/\n/g,"%0A").replace(/\r/g,"%0D").replace(/"/g,"%22")},Xe=function(He){this.i=[];var tt=this;He&&Ee(He.elements,function(St){if(St.name&&!St.disabled&&St.type!=="submit"&&St.type!=="button"&&!St.matches("form fieldset[disabled] *"))if(St.type==="file"){var Ze=St.files&&St.files.length?St.files:[new File([],"",{type:"application/octet-stream"})];Ee(Ze,function(J){tt.append(St.name,J)})}else St.type==="select-multiple"||St.type==="select-one"?Ee(St.options,function(J){!J.disabled&&J.selected&&tt.append(St.name,J.value)}):St.type==="checkbox"||St.type==="radio"?St.checked&&tt.append(St.name,St.value):(Ze=St.type==="textarea"?Re(St.value):St.value,tt.append(St.name,Ze))})};if((e=Xe.prototype).append=function(He,tt,St){we(arguments,2),this.i.push(Ie(He,tt,St))},e.delete=function(He){we(arguments,1);var tt=[];He=String(He),Ee(this.i,function(St){St[0]!==He&&tt.push(St)}),this.i=tt},e.entries=function He(){var tt,St=this;return ee(He,function(Ze){if(Ze.h==1&&(tt=0),Ze.h!=3)return tt<St.i.length?Ze=P(Ze,St.i[tt]):(Ze.h=0,Ze=void 0),Ze;tt++,Ze.h=2})},e.forEach=function(He,tt){we(arguments,1);for(var St=E(this),Ze=St.next();!Ze.done;Ze=St.next()){var J=E(Ze.value);Ze=J.next().value,J=J.next().value,He.call(tt,J,Ze,this)}},e.get=function(He){we(arguments,1);var tt=this.i;He=String(He);for(var St=0;St<tt.length;St++)if(tt[St][0]===He)return tt[St][1];return null},e.getAll=function(He){we(arguments,1);var tt=[];return He=String(He),Ee(this.i,function(St){St[0]===He&&tt.push(St[1])}),tt},e.has=function(He){we(arguments,1),He=String(He);for(var tt=0;tt<this.i.length;tt++)if(this.i[tt][0]===He)return!0;return!1},e.keys=function He(){var tt,St,Ze,J,_e=this;return ee(He,function(be){if(be.h==1&&(tt=E(_e),St=tt.next()),be.h!=3)return St.done?void(be.h=0):(Ze=St.value,J=E(Ze),P(be,J.next().value));St=tt.next(),be.h=2})},e.set=function(He,tt,St){we(arguments,2),He=String(He);var Ze=[],J=Ie(He,tt,St),_e=!0;Ee(this.i,function(be){be[0]===He?_e&&(_e=!Ze.push(J)):Ze.push(be)}),_e&&Ze.push(J),this.i=Ze},e.values=function He(){var tt,St,Ze,J,_e=this;return ee(He,function(be){if(be.h==1&&(tt=E(_e),St=tt.next()),be.h!=3)return St.done?void(be.h=0):(Ze=St.value,(J=E(Ze)).next(),P(be,J.next().value));St=tt.next(),be.h=2})},Xe.prototype._asNative=function(){for(var He=new ve,tt=E(this),St=tt.next();!St.done;St=tt.next()){var Ze=E(St.value);St=Ze.next().value,Ze=Ze.next().value,He.append(St,Ze)}return He},Xe.prototype._blob=function(){var He="----formdata-polyfill-"+Math.random(),tt=[],St="--"+He+`\r
Content-Disposition: form-data; name="`;return this.forEach(function(Ze,J){return typeof Ze=="string"?tt.push(St+Se(Re(J))+`"\r
\r
`+Re(Ze)+`\r
`):tt.push(St+Se(Re(J))+'"; filename="'+Se(Ze.name)+`"\r
Content-Type: `+(Ze.type||"application/octet-stream")+`\r
\r
`,Ze,`\r
`)}),tt.push("--"+He+"--"),new Blob(tt,{type:"multipart/form-data; boundary="+He})},Xe.prototype[Symbol.iterator]=function(){return this.entries()},Xe.prototype.toString=function(){return"[object FormData]"},W&&!W.matches&&(W.matches=W.matchesSelector||W.mozMatchesSelector||W.msMatchesSelector||W.oMatchesSelector||W.webkitMatchesSelector||function(He){for(var tt=(He=(this.document||this.ownerDocument).querySelectorAll(He)).length;0<=--tt&&He.item(tt)!==this;);return-1<tt}),ce&&(Xe.prototype[ce]="FormData"),Ne){var en=Ue.XMLHttpRequest.prototype.setRequestHeader;Ue.XMLHttpRequest.prototype.setRequestHeader=function(He,tt){en.call(this,He,tt),He.toLowerCase()==="content-type"&&(this.B=!0)},Ue.XMLHttpRequest.prototype.send=function(He){He instanceof Xe?(He=He._blob(),this.B||this.setRequestHeader("Content-Type",He.type),Ne.call(this,He)):Ne.call(this,He)}}Ve&&(Ue.fetch=function(He,tt){return tt&&tt.body&&tt.body instanceof Xe&&(tt.body=tt.body._blob()),Ve.call(this,He,tt)}),Be&&(Ue.navigator.sendBeacon=function(He,tt){return tt instanceof Xe&&(tt=tt._asNative()),Be.call(this,He,tt)}),Ue.FormData=Xe}})();const g1=()=>{const e=me("AREAS");return e.length===0&&e.push(An.GLOBAL),wc(e).call(e,(t,r,s)=>{const l=OU(r);return l?s===0?l:"".concat(t,",").concat(l):t},"")},OU=e=>e===An.OVERSEA?"".concat(Ir.ASIA,",").concat(Ir.EUROPE,",").concat(Ir.AFRICA,",").concat(Ir.NORTH_AMERICA,",").concat(Ir.SOUTH_AMERICA,",").concat(Ir.OCEANIA):Ir[e],NU=e=>{const t={CODE:"",WEBCS_DOMAIN:[],WEBCS_DOMAIN_BACKUP_LIST:[],PROXY_CS:[],CDS_AP:[],ACCOUNT_REGISTER:[],UAP_AP:[],EVENT_REPORT_DOMAIN:[],EVENT_REPORT_BACKUP_DOMAIN:[],LOG_UPLOAD_SERVER:[],PROXY_SERVER_TYPE3:[]};return e.map(r=>{const s=wI[r],l=Object.keys(s);l&&l.map(f=>{f!=="CODE"&&(t[f]=t[f].concat(s[f]))})}),t},dD={GLOBAL:{ASIA:[An.CHINA,An.JAPAN,An.INDIA,An.KOREA,An.HKMC],EUROPE:[],NORTH_AMERICA:[An.US],SOUTH_AMERICA:[],OCEANIA:[],AFRICA:[]}},_1=Object.keys(dD[An.GLOBAL]),LU=[An.CHINA,An.NORTH_AMERICA,An.EUROPE,An.ASIA,An.JAPAN,An.INDIA,An.OCEANIA,An.SOUTH_AMERICA,An.AFRICA,An.KOREA,An.HKMC,An.US],E1=function(e,t){let r=[];if(ht(e).call(e,An.GLOBAL)){const f=[An.GLOBAL,An.OVERSEA],m=Object.keys(wI);if(t===An.GLOBAL)throw new xe(se.INVALID_PARAMS,"GLOBAL is an invalid excludedArea value");if(t===An.CHINA)r=[An.OVERSEA];else if(l=t,ht(_1).call(_1,l)){const E=(s=t,dD[An.GLOBAL][s]||[]),y=[...f,t,...E];r=m.filter(b=>!ht(y).call(y,b))}else if(function(E){let y=!1;return _1.forEach(b=>{var A;ht(A=dD[An.GLOBAL][b]).call(A,E)&&(y=!0)}),y}(t)){const E=function(b){let A;return _1.forEach(O=>{var D;ht(D=dD[An.GLOBAL][O]).call(D,b)&&(A=O)}),A}(t),y=[...f,E,t];r=m.filter(b=>!ht(y).call(y,b))}else r=e;r=function(E){const y=[];return LU.forEach(b=>{ht(E).call(E,b)&&y.push(b)}),y.concat(E.filter(b=>!ht(LU).call(LU,b)))}(r)}else r=e;var s,l;return r};function jS(e){var t,r;if(!e&&ht(t=me("AREAS")).call(t,An.EXTENSIONS))return G.debug("update area from ap : reset"),void VS(gY,!0);if(!ht(r=me("AREAS")).call(r,An.GLOBAL)||!e)return;let s=wI.EXTENSIONS;s&&(s={CODE:OU(An.EXTENSIONS),WEBCS_DOMAIN:["ap-web-1-".concat(e,".agora.io")],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-".concat(e,".ap.sd-rtn.com")],PROXY_CS:["proxy-ap-web-".concat(e,".agora.io")],CDS_AP:["cds-ap-web-1-".concat(e,".agora.io"),"cds-ap-web-2-".concat(e,".ap.sd-rtn.com")],ACCOUNT_REGISTER:["sua-ap-web-1-".concat(e,".agora.io"),"sua-ap-web-2-".concat(e,".ap.sd-rtn.com")],UAP_AP:["uap-ap-web-1-".concat(e,".agora.io"),"uap-ap-web-2-".concat(e,".ap.sd-rtn.com")],EVENT_REPORT_DOMAIN:["statscollector-1-".concat(e,".agora.io")],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-".concat(e,".agora.io")],LOG_UPLOAD_SERVER:["logservice-".concat(e,".agora.io")],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy-".concat(e,".agora.io")]},G.debug("update area from ap success: ".concat(e,",config is "),s),Dn("AREAS",[An.EXTENSIONS],!0),Object.keys(s).map(l=>{l==="LOG_UPLOAD_SERVER"||l==="EVENT_REPORT_DOMAIN"||l==="EVENT_REPORT_BACKUP_DOMAIN"||l==="PROXY_SERVER_TYPE3"?Dn(l,s[l][0]):Dn(l,s[l])}))}function VS(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];const r=Vt.reportApiInvoke(null,{name:Di.SET_AREA,options:e,tag:Bn.TRACER});try{let s=[];if(typeof e=="string"&&(s=[e]),Array.isArray(e)&&(e.forEach(f=>{if(!ht(nu).call(nu,f))throw new xe(se.INVALID_PARAMS,"invalid area code")}),s=e),Object.prototype.toString.call(e)==="[object Object]"){const{areaCode:f,excludedArea:m}=e;if(!f)throw new xe(se.INVALID_PARAMS,"area code is needed");let E=f;typeof f=="string"&&(E=[f]),s=m?E1(E,m):E}if(!t){if(gh.AREAS){const f=new xe(se.PROHIBITED_OPERATION,"setArea is prohibited because of config-distribute");return r.onError(f),void G.warning("setArea is prohibited because of config-distribute")}if(ht(s).call(s,An.GLOBAL)&&me("AREAS")===An.EXTENSIONS){const f=new xe(se.PROHIBITED_OPERATION,"setArea is prohibited because of ap extensions");return r.onError(f),void G.warning("setArea is prohibited because of ap extensions")}}Dn("AREAS",s,t);const l=NU(s);Object.keys(l).map(f=>{f==="LOG_UPLOAD_SERVER"||f==="EVENT_REPORT_DOMAIN"||f==="EVENT_REPORT_BACKUP_DOMAIN"||f==="PROXY_SERVER_TYPE3"?Dn(f,l[f][0]):Dn(f,l[f])}),G.debug("set area success:",s.join(","))}catch(s){throw r.onError(s),s}r.onSuccess()}function DU(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),r.push.apply(r,s)}return r}function lf(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?DU(Object(r),!0).forEach(function(s){ne(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):DU(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}let uD=1;function J8(e,t,r,s,l){uD+=1;const f={sid:r.sid,command:"convergeAllocateEdge",uid:"666",appId:r.appId,ts:Math.floor(Date.now()/1e3),seq:uD,requestId:uD,version:hs,cname:r.cname},m={service_name:t,json_body:JSON.stringify(f)};let E,y,b=e[0];return _l(async()=>{E=Date.now();const A=await cf(b,{data:m,cancelToken:s,headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"61"}});if(y=Date.now()-E,A.code!==0){const P=new xe(se.UNEXPECTED_RESPONSE,"live streaming ap error, code"+A.code,{retry:!0,responseTime:y});throw G.error(P.toString()),P}const O=JSON.parse(A.json_body);if(O.code!==200){const P=new xe(se.UNEXPECTED_RESPONSE,"live streaming app center error, code: ".concat(O.code,", reason: ").concat(O.reason),{code:O.code,responseTime:y});throw G.error(P.toString()),P}if(!O.servers||O.servers.length===0){const P=new xe(se.UNEXPECTED_RESPONSE,"live streaming app center empty server",{code:O.code,responseTime:y});throw G.error(P.toString()),P}const D=function(P,F){return{addressList:P.servers.map(B=>"wss://".concat(B.address.replace(/\./g,"-"),".").concat(me("WORKER_DOMAIN"),":").concat(B.wss,"?serviceName=").concat(encodeURIComponent(F))),workerToken:P.workerToken,vid:P.vid}}(O,t);return me("LIVE_STREAMING_ADDRESS")&&(D.addressList=me("LIVE_STREAMING_ADDRESS")instanceof Array?me("LIVE_STREAMING_ADDRESS"):[me("LIVE_STREAMING_ADDRESS")]),lf(lf({},D),{},{responseTime:y})},(A,O)=>(Vt.apworkerEvent(r.sid,{success:!0,sc:200,serviceName:t,responseDetail:JSON.stringify(A.addressList),firstSuccess:O===0,responseTime:y,serverIp:e[O%e.length]}),!1),(A,O)=>(Vt.apworkerEvent(r.sid,{success:!1,sc:A.data&&A.data.code||200,serviceName:t,responseTime:y,serverIp:e[O%e.length]}),!!(A.code!==se.OPERATION_ABORTED&&A.code!==se.UNEXPECTED_RESPONSE||A.data&&A.data.retry)&&(b=e[(O+1)%e.length],!0)),l)}let PU=1;function X8(e,t,r,s){let{url:l,areaCode:f}=e;const{clientId:m,sid:E}=t,y=Date.now();let b;const A=t.role,[O,D]=fD(t,f,[Pi.CHOOSE_SERVER]);let P=na.networkState;return _l(async()=>{P&&na.networkState===Fs.OFFLINE&&na.onlineWaiter&&await gt.race([na.onlineWaiter,fs(s&&s.maxRetryTimeout||ra.maxRetryTimeout)]),P=na.networkState;const{data:F,headers:B}=await cf(l,{data:O,cancelToken:r,headers:{"Content-Type":"multipart/form-data;"}},!0,!0);b=B.http3==="1"?1:-1,Vt.reportResourceTiming(l,E),kU(F,l,t,y,[Pi.CHOOSE_SERVER],b);const Y=d1(F,Pi.CHOOSE_SERVER);return xU(Y),nD(Y,l)},F=>(F&&Vt.joinChooseServer(E,{role:A,lts:y,succ:!0,csAddr:l,opid:D,serverList:F.gatewayAddrs.map(B=>B.address),ec:null,cid:F.cid.toString(),uid:F.uid.toString(),csIp:F.csIp,unilbsServerIds:[Pi.CHOOSE_SERVER].toString(),isHttp3:b,corssRegionTagReq:t.apRequestDetail,corssRegionTagRes:F.res.detail&&F.res.detail[38]}),!1),F=>F.code!==se.OPERATION_ABORTED&&(F.code===se.CAN_NOT_GET_GATEWAY_SERVER?F.data.retry:(Vt.joinChooseServer(E,{role:A,lts:y,succ:!1,csAddr:l,serverList:null,opid:D,ec:F.code,csIp:F.data&&F.data.csIp,unilbsServerIds:[Pi.CHOOSE_SERVER].toString(),extend:JSON.stringify({networkState:P}),isHttp3:b,corssRegionTagReq:t.apRequestDetail}),G.warning("[".concat(m||"sid-".concat(E.slice(0,6)),"] Choose server network error, retry"),F),!0)),s)}function MU(e,t,r,s){let l,{url:f,areaCode:m,serviceIds:E}=e;const y=Date.now(),b=t.role,[A,O]=fD(t,m,E);let D;return _l(async()=>{D&&na.networkState===Fs.OFFLINE&&na.onlineWaiter&&await gt.race([na.onlineWaiter,fs(s&&s.maxRetryTimeout||ra.maxRetryTimeout)]),D=na.networkState;const{data:P,headers:F}=await cf(f,{data:A,cancelToken:r,headers:{"Content-Type":"multipart/form-data;"}},!0,!0);l=F.http3==="1"?1:-1,Vt.reportResourceTiming(f,t.sid),kU(P,f,t,y,E,l);const B=d1(P,Pi.CHOOSE_SERVER),Y=d1(P,t.cloudProxyServer==="proxy5"?Pi.CLOUD_PROXY_5:t.cloudProxyServer==="proxy3"||t.cloudProxyServer==="proxy4"?Pi.CLOUD_PROXY:Pi.CLOUD_PROXY_FALLBACK);return xU(B),{gatewayInfo:nD(B,f),proxyInfo:Y,url:f}},P=>(P.gatewayInfo&&Vt.joinChooseServer(t.sid,{role:b,lts:y,succ:!0,csAddr:f,serverList:P.gatewayInfo.gatewayAddrs.map(F=>F.address),ec:null,opid:O,cid:P.gatewayInfo.cid.toString(),uid:P.gatewayInfo.uid.toString(),csIp:P.gatewayInfo.csIp,unilbsServerIds:E.toString(),isHttp3:l,corssRegionTagReq:t.apRequestDetail,corssRegionTagRes:P.gatewayInfo.res.detail&&P.gatewayInfo.res.detail[38]}),P.proxyInfo&&Vt.joinWebProxyAP(t.sid,{lts:y,sucess:1,apServerAddr:f,turnServerAddrList:P.proxyInfo.addresses.map(F=>F.ip).join(","),errorCode:null,eventType:t.cloudProxyServer,unilbsServerIds:E.toString()}),!1),P=>P.code!==se.OPERATION_ABORTED&&(P.code===se.CAN_NOT_GET_GATEWAY_SERVER?P.data.retry:(Vt.joinWebProxyAP(t.sid,{lts:y,sucess:0,apServerAddr:f,turnServerAddrList:null,errorCode:P.code,eventType:t.cloudProxyServer,unilbsServerIds:E.toString(),extend:JSON.stringify({networkState:D})}),G.warning("[".concat(t.clientId,"] multi unilbs network error, retry"),P),!0)),s)}const kU=(e,t,r,s,l,f)=>{const{sid:m,clientId:E,cloudProxyServer:y}=r,b=[],A=O=>{O.flag===4096?Vt.joinChooseServer(m,{role:r.role,lts:s,succ:!1,csAddr:t,opid:e.opid,serverList:null,ec:O.error.message,csIp:O.error.data&&O.error.data.csIp,unilbsServerIds:l.toString(),isHttp3:f,corssRegionTagReq:r.apRequestDetail}):O.flag!==1048576&&O.flag!==4194304&&O.flag!==4194310||Vt.joinWebProxyAP(m,{lts:s,sucess:0,apServerAddr:t,turnServerAddrList:null,errorCode:O.error.code,eventType:y,unilbsServerIds:l.toString()})};if(e.response_body.forEach(O=>{const D=O.buffer.code;if(O.uri===23&&D===0&&!O.buffer.edges_services)if(O.buffer.flag===4194310)G.warning("no edge services in ap response of proxy fallback, will not set proxy in iceServers"),O.buffer.edges_services=[];else{const P={error:new xe(se.CAN_NOT_GET_GATEWAY_SERVER,"no edge services in ap response",{retry:!0,csIp:e.detail[502]}),flag:O.buffer.flag};b.push(P),A(P)}if(D!==0){const P=qp(D),F={error:new xe(se.CAN_NOT_GET_GATEWAY_SERVER,P.desc,{desc:P.desc,retry:P.retry,csIp:e.detail[502]}),flag:O.buffer.flag};O.buffer.flag===4194310?G.warning(F.error.toString()):b.push(F),A(F)}}),b.length)throw G.warning("[".concat(E||"sid-".concat(m.slice(0,6)),"] multi unilbs ").concat(t," failed, ").concat(b.map(O=>"flag: ".concat(O.flag,", message: ").concat(O.error.message,", retry: ").concat(O.error.data.retry)).join(" | "))),new xe(se.CAN_NOT_GET_GATEWAY_SERVER,b.map(O=>"flag: ".concat(O.flag,", message: ").concat(O.error.message)).join(" | "),{retry:!!b.find(O=>O.error.data.retry),csIp:e.detail[502],desc:[...new Set(b.map(O=>{var D;return O==null||(D=O.error)===null||D===void 0||(D=D.data)===null||D===void 0?void 0:D.desc}).filter(O=>!!O))]})},xU=e=>{var t,r,s,l;if(e.addresses&&e.addresses.length===0&&e.code===0)throw new xe(se.CAN_NOT_GET_GATEWAY_SERVER,"void gateway address",{retry:!0,csIp:e.detail&&e.detail[502]});if(me("AP_AREA")&&((s=e.detail)!==null&&s!==void 0&&s[23]&&typeof((l=e.detail)===null||l===void 0?void 0:l[23])=="string"?jS(e.detail[23].toLowerCase()):jS()),(t=e.detail)!==null&&t!==void 0&&t[19]&&typeof((r=e.detail)===null||r===void 0?void 0:r[19])=="string"){const m=e.detail[19],E=m==null?void 0:m.split(";");for(let y=0;y<E.length;y++){var f;const b=Eo(f=E[y]).call(f);e.addresses[y]&&E&&(e.addresses[y].fingerprint=b)}}if(me("GATEWAY_ADDRESS")&&me("GATEWAY_ADDRESS").length>0){G.debug("assign gateway address to",me("GATEWAY_ADDRESS"));const m=me("GATEWAY_ADDRESS").map(E=>{var y,b;const A=(y=(b=e.addresses.find(O=>O.ip===E.ip&&O.port===E.port))===null||b===void 0?void 0:b.fingerprint)!==null&&y!==void 0?y:"";return{ip:E.ip,port:E.port,ticket:e.addresses[0]&&e.addresses[0].ticket,fingerprint:A}});e.addresses=m}},LY=(e,t)=>{if(e.response_body&&e.response_body.length){const r=e.response_body[0];if(r.buffer.code!==0){const s=qp(r.buffer.code);throw new xe(se.UPDATE_TICKET_FAILED,"[".concat(r.buffer.code,"]: ").concat(s.desc),{retry:s.retry})}return r.buffer.ticket}throw G.debug("update ticket request received ap response without response body:",t),new xe(se.UPDATE_TICKET_FAILED,"cannot find response body from ap response",{retry:!1})},fD=(e,t,r)=>{const s=Math.floor(Math.random()*1e12),l=e.role==="host"?"1":e.role==="audience"?"2":void 0,f={appid:e.appId,client_ts:Date.now(),opid:s,sid:e.sid,request_bodies:[{uri:22,buffer:{cname:e.cname,detail:lf(lf(lf({6:e.stringUid,11:t,12:me("USE_NEW_TOKEN")?"1":void 0},l?{17:l}:{}),{},{22:t},e.apRequestDetail?{33:e.apRequestDetail}:{}),e.apRTM?{26:"RTM2"}:{}),key:e.token,service_ids:r,uid:e.uid||0}}]};f.request_bodies.forEach(E=>{e.multiIP&&e.multiIP.gateway_ip&&(E.buffer.detail[5]=JSON.stringify({vocs_ip:[e.multiIP.uni_lbs_ip],vos_ip:[e.multiIP.gateway_ip]}))});const m=new FormData;return m.append("request",JSON.stringify(f)),[m,s]},UU=(e,t)=>{const r=Math.floor(Math.random()*1e12),s={appid:e.appId,client_ts:Date.now(),opid:r,sid:e.sid,request_bodies:[{uri:28,buffer:{cname:e.cname,detail:{1:"",6:e.stringUid,12:"1"},token:e.token,service_ids:t,uid:e.uid||0,edges_services:e.apResponse.addresses.map(f=>({ip:f.ip,port:f.port}))}}]},l=new FormData;return l.append("request",JSON.stringify(s)),[l,r]};let v1=0;function S1(e){return gt.all(e.map(t=>t.then(r=>{throw r},r=>r))).then(t=>{throw t},t=>t)}const y1=async e=>{let{fragementLength:t,referenceList:r,asyncMapHandler:s,allFailedhandler:l,promisesCollector:f}=e,m=0;const E=t;let y,b=0;const A=async()=>{const O=(()=>{const D=m*E,P=D+E;return r.slice(D,P).map(s)})();f&&f.push(...O);try{y=await S1(O)}catch(D){if(b+=E,m++,!(b>=r.length))return void await A();l(D)}O.forEach(D=>D.cancel())};return await A(),y},Cs=async e=>{let{referenceList:t,asyncMapHandler:r,closeFn:s}=e;const l=t.length;let f=0;const m=async()=>{const E=r(t.shift());try{return await E}catch(y){if(f++,f>=l||s!=null&&s(y))throw y;return m()}};return m()};async function hD(e,t,r,s){return{gatewayInfo:await async function(f,m,E,y){let b=null;const A=[],O=async()=>{const P=me("WEBCS_DOMAIN").slice(0,me("AJAX_REQUEST_CONCURRENT")).map(Y=>({url:f.proxyServer?"https://".concat(f.proxyServer,"/ap/?url=").concat(Y+"/api/v2/transpond/webrtc?v=2"):"https://".concat(Y,"/api/v2/transpond/webrtc?v=2"),areaCode:g1()})),F=y.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:P.map(Y=>Y.url)}),B=await y1({fragementLength:me("FRAGEMENT_LENGTH"),referenceList:P,asyncMapHandler:Y=>(G.debug("[".concat(f.clientId,"] Connect to choose_server:"),Y.url),X8(Y,f,m,E)),allFailedhandler:Y=>{throw y.recordJoinChannelService({endTs:Date.now(),status:"error",errors:Y},F),Y[0]},promisesCollector:A});return y.recordJoinChannelService({endTs:Date.now(),status:"success"},F),B},D=async()=>{if(await fs(1e3),b!==null)return b;const P=me("WEBCS_DOMAIN_BACKUP_LIST").map(Y=>({url:f.proxyServer?"https://".concat(f.proxyServer,"/ap/?url=").concat(Y+"/api/v2/transpond/webrtc?v=2"):"https://".concat(Y,"/api/v2/transpond/webrtc?v=2"),areaCode:g1()})),F=y.recordJoinChannelService({endTs:void 0,startTs:Date.now(),status:"pending",service:"chooseServer",urls:P.map(Y=>Y.url)}),B=await y1({fragementLength:me("FRAGEMENT_LENGTH"),referenceList:P,asyncMapHandler:Y=>(G.debug("[".concat(f.clientId,"] Connect to backup choose_server:"),Y.url),X8(Y,f,m,E)),allFailedhandler:Y=>{throw y.recordJoinChannelService({endTs:Date.now(),status:"error",errors:Y},F),Y[0]},promisesCollector:A});return y.recordJoinChannelService({endTs:Date.now(),status:"success"},F),B};try{return b=await S1([O(),D()]),A.length&&A.forEach(P=>P.cancel&&typeof P.cancel=="function"&&P.cancel()),b}catch(P){throw P[0]}}(e,t,r,s)}}async function W_(e,t,r,s,l){const f=e.cloudProxyServer;if(f==="disabled"){if(e.useLocalAccessPoint)return await hD(e,t,r,l);if(me("JOIN_WITH_FALLBACK_MEDIA_PROXY")){const{gatewayInfo:D,proxyInfo:P}=await jU(e,t,r,l);if(e.turnServer&&e.turnServer.mode!=="auto")return{gatewayInfo:D};const F=P.map(B=>({turnServerURL:B.address,tcpport:B.tcpport||ps.tcpport,udpport:B.udpport||ps.udpport,username:B.username||ps.username,password:B.password||ps.password,forceturn:!1,security:!0}));if(l.useP2P){var m;const B=(m=e.uid)!==null&&m!==void 0?m:D.uid,Y="glb:".concat(B.toString()),$=await rI(Y),ee=P.map(Ee=>({turnServerURL:Ee.address,tcpport:Ee.tcpport||ps.tcpport,udpport:Ee.udpport||ps.udpport,username:Y,password:$,forceturn:!1,security:!0}));F.push(...ee)}return e.turnServer={mode:"manual",servers:F},{gatewayInfo:D}}return await hD(e,t,r,l)}const{proxyInfo:E,gatewayInfo:y}=await jU(e,t,r,l),b={gatewayInfo:y},A=E.map(D=>({turnServerURL:D.address,tcpport:f==="proxy3"?void 0:D.tcpport?D.tcpport:ps.tcpport,udpport:f==="proxy4"?void 0:D.udpport?D.udpport:ps.udpport,username:D.username||ps.username,password:D.password||ps.password,forceturn:f!=="proxy4",security:f==="proxy5"}));if(l.useP2P){var O;const D=(O=e.uid)!==null&&O!==void 0?O:y.uid,P="glb:".concat(D.toString()),F=await rI(P),B=E.map(Y=>({turnServerURL:Y.address,tcpport:f==="proxy3"?void 0:Y.tcpport||ps.tcpport,udpport:f==="proxy4"?void 0:Y.udpport||ps.udpport,username:P,password:F,forceturn:f!=="proxy4",security:f==="proxy5"}));A.push(...B)}return e.turnServer={mode:"manual",servers:A},G.debug("[".concat(e.clientId,"] set proxy server: ").concat(e.proxyServer,", mode: ").concat(f)),b}async function T1(e,t,r,s,l){const f=me("ACCOUNT_REGISTER").slice(0,me("AJAX_REQUEST_CONCURRENT"));let m=[];m=t.proxyServer?f.map(y=>"https://".concat(t.proxyServer,"/ap/?url=").concat(y+"/api/v1")):f.map(y=>"https://".concat(y,"/api/v1"));const E=l==null?void 0:l.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"stringUID",urls:m});try{const y=await async function(b,A,O,D,P){const F=Date.now(),B={sid:O.sid,opid:10,appid:O.appId,string_uid:A};let Y=b[0];const $=await _l(()=>cf(Y+"".concat(Y.indexOf("?")===-1?"?":"&","action=stringuid"),{data:B,cancelToken:D,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":72}}),(ee,Ee)=>{if(ee.code===0){if(ee.uid<=0||ee.uid>=Math.pow(2,32))throw G.error("Invalid Uint Uid ".concat(A," => ").concat(ee.uid),ee),Vt.reqUserAccount(B.sid,{lts:F,success:!1,serverAddr:Y,stringUid:B.string_uid,uid:ee.uid,errorCode:se.INVALID_UINT_UID_FROM_STRING_UID,extend:B}),new xe(se.INVALID_UINT_UID_FROM_STRING_UID);return Vt.reqUserAccount(B.sid,{lts:F,success:!0,serverAddr:Y,stringUid:B.string_uid,uid:ee.uid,errorCode:null,extend:B}),!1}const Re=qp(ee.code);return Re.retry&&(Y=b[(Ee+1)%b.length]),Vt.reqUserAccount(B.sid,{lts:F,success:!1,serverAddr:Y,stringUid:B.string_uid,uid:ee.uid,errorCode:Re.desc,extend:B}),Re.retry},(ee,Ee)=>ee.code!==se.OPERATION_ABORTED&&(Vt.reqUserAccount(B.sid,{lts:F,success:!1,serverAddr:Y,stringUid:B.string_uid,uid:null,errorCode:ee.code,extend:B}),Y=b[(Ee+1)%b.length],!0),P);if($.code!==0){const ee=qp($.code);throw new xe(se.UNEXPECTED_RESPONSE,ee.desc)}return $}(m,e,t,r,s);return l==null||l.recordJoinChannelService({status:"success",endTs:Date.now()},E),y.uid}catch(y){throw l==null||l.recordJoinChannelService({status:"error",endTs:Date.now(),errors:[y]},E),y}}async function Q8(e,t,r){const s=me("ACCOUNT_REGISTER");let l=[];l=t.proxyServer?s.map(f=>"https://".concat(t.proxyServer,"/ap/?url=").concat(f+"/api/v1")):s.map(f=>"https://".concat(f,"/api/v1"));try{return await Cs({referenceList:l,asyncMapHandler:m=>async function(E,y,b,A){const O=Date.now(),D={sid:b.sid,opid:10,appid:b.appId,string_uid:y};try{const P=await cf(E+"".concat(E.indexOf("?")===-1?"?":"&","action=stringuid"),{data:D,cancelToken:A,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":72}});if(P.code!==0){const F=qp(P.code);throw new xe(se.UNEXPECTED_RESPONSE,"preload sua error:".concat(F.desc),F)}if(P.uid<=0||P.uid>=Math.pow(2,32))throw new xe(se.INVALID_UINT_UID_FROM_STRING_UID);return{requestTime:O,url:E,req:D,uid:P.uid,elapse:Date.now()-O}}catch(P){throw P}}(m,e,t,r),closeFn:m=>m.code===se.OPERATION_ABORTED||m.code===se.UNEXPECTED_RESPONSE&&!m.data.retry})}catch(f){throw f}}async function Z8(e,t,r){const s=me("CDS_AP").slice(0,me("AJAX_REQUEST_CONCURRENT")).map(y=>e.proxyServer?"https://".concat(e.proxyServer,"/ap/?url=").concat(y+"/api/v1"):"https://".concat(y,"/api/v1?action=config")),l=s.map(y=>function(b,A,O,D){const P=qn(),F={flag:64,cipher_method:0,features:lf(lf(lf(lf(lf({install_id:wL(),device:P.name,system:P.os,system_general:navigator.userAgent,vendor:A.appId,version:hs,cname:A.cname,session_id:A.sid,proxyServer:A.proxyServer,sdk_type:tD.WEB_RTC,browser_name:P.name,browser_version:P.version,user_agent:navigator.userAgent,channel_name:A.cname},A.stringUid&&{string_uid:A.stringUid}),A.uid&&{uid:A.uid+""}),P.os&&{os_name:P.os}),P.osVersion&&{os_version:P.osVersion}),{},{detail:""})};return _l(()=>cf(b,{data:F,timeout:1e3,cancelToken:O,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":54}}),void 0,B=>B.code!==se.OPERATION_ABORTED,D)}(y,e,t,r));let f=null,m=null,E={};try{f=await S1(l)}catch(y){if(y.code===se.OPERATION_ABORTED)throw y;m=y}if(l.forEach(y=>y.cancel()),Vt.reportApiInvoke(e.sid,{name:Di.REQUEST_CONFIG_DISTRIBUTE,options:{error:m,res:f}}).onSuccess(),f&&f.test_tags)try{E=function(y){if(!y.test_tags)return{};const b=y.test_tags,A=Object.keys(b),O={};return A.forEach(D=>{var P;const F=Eo(P=D.slice(4)).call(P),B=JSON.parse(b[D]),Y=B[1];O[F]={tag:B[0]||"",value:Y}}),O}(f)}catch{}return E}async function Hg(e,t){const r=me("WEBCS_DOMAIN").concat(me("WEBCS_DOMAIN_BACKUP_LIST")).map(s=>({url:"https://".concat(s,"/api/v2/transpond/webrtc?v=2"),areaCode:g1(),serviceIds:[Pi.CHOOSE_SERVER,Pi.CLOUD_PROXY_FALLBACK]}));try{return await Cs({referenceList:r,asyncMapHandler:l=>async function(f,m,E){let y,{url:b,areaCode:A,serviceIds:O}=f;const D=Date.now(),[P,F]=fD(m,A,O);let B=na.networkState;try{B&&na.networkState===Fs.OFFLINE&&na.onlineWaiter&&await gt.race([na.onlineWaiter,fs(ra.maxRetryTimeout)]),B=na.networkState;const{data:Y,headers:$}=await cf(b,{data:P,cancelToken:E,headers:{"Content-Type":"multipart/form-data;"}},!0,!0);y=$.http3==="1"?1:-1,(Ie=>{const we=[];if(Ie.response_body.forEach(Ue=>{const ve=Ue.buffer.code;if(Ue.uri===23&&ve===0&&!Ue.buffer.edges_services)if(Ue.buffer.flag===4194310)Ue.buffer.edges_services=[];else{const Ne={error:new xe(se.CAN_NOT_GET_GATEWAY_SERVER,"no edge services in ap response",{retry:!0,csIp:Ie.detail[502]}),flag:Ue.buffer.flag};we.push(Ne)}if(ve!==0){const Ne=qp(ve),Ve={error:new xe(se.CAN_NOT_GET_GATEWAY_SERVER,Ne.desc,{desc:Ne.desc,retry:Ne.retry,csIp:Ie.detail[502]}),flag:Ue.buffer.flag};Ue.buffer.flag===4194310?G.warning(Ve.error.toString()):we.push(Ve)}}),we.length)throw new xe(se.CAN_NOT_GET_GATEWAY_SERVER,we.map(Ue=>"flag: ".concat(Ue.flag,", message: ").concat(Ue.error.message)).join(" | "),{retry:!!we.find(Ue=>Ue.error.data.retry),csIp:Ie.detail[502],desc:[...new Set(we.map(Ue=>{var ve;return Ue==null||(ve=Ue.error)===null||ve===void 0||(ve=ve.data)===null||ve===void 0?void 0:ve.desc}).filter(Ue=>!!Ue))]})})(Y);const Ee=d1(Y,Pi.CHOOSE_SERVER),Re=d1(Y,Pi.CLOUD_PROXY_FALLBACK);return xU(Ee),{gatewayInfo:nD(Ee,b),proxyInfo:Re,opid:F,requestTime:D,url:b,isHttp3:y,elapse:Date.now()-D}}catch(Y){throw Y}}(l,e,t),closeFn:l=>l.code===se.OPERATION_ABORTED||l.code===se.CAN_NOT_GET_GATEWAY_SERVER&&!l.data.retry})}catch(s){throw s}}async function jU(e,t,r,s){const l=me("PROXY_SERVER_TYPE3"),f=(P,F,B)=>{let Y=B||l;return Array.isArray(Y)&&(Y=F%2==0?l[1]:l[0]),"https://".concat(Y,"/ap/?url=").concat(P)};let m=null;const E=[],y=async()=>{const P=me("WEBCS_DOMAIN").slice(0,me("AJAX_REQUEST_CONCURRENT")).map((Y,$)=>{let ee;return ee=e.cloudProxyServer==="disabled"&&e.proxyServer?f("".concat(Y,"/api/v2/transpond/webrtc?v=2"),$,e.proxyServer):e.cloudProxyServer==="disabled"||e.cloudProxyServer==="fallback"?"https://".concat(Y,"/api/v2/transpond/webrtc?v=2"):f("".concat(Y,"/api/v2/transpond/webrtc?v=2"),$),{url:ee,areaCode:g1(),serviceIds:[Pi.CHOOSE_SERVER,e.cloudProxyServer==="proxy5"?Pi.CLOUD_PROXY_5:e.cloudProxyServer==="proxy3"||e.cloudProxyServer==="proxy4"?Pi.CLOUD_PROXY:Pi.CLOUD_PROXY_FALLBACK]}}),F=s.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:P.map(Y=>Y.url)}),B=await y1({fragementLength:me("FRAGEMENT_LENGTH"),referenceList:P,asyncMapHandler:Y=>(G.debug("[".concat(e.clientId,"] Connect to choose_server:"),Y.url),MU(Y,e,t,r)),allFailedhandler:Y=>{throw s.recordJoinChannelService({endTs:Date.now(),status:"error",errors:Y},F),Y[0]},promisesCollector:E});return s.recordJoinChannelService({endTs:Date.now(),status:"success"},F),B},b=async()=>{if(await fs(1e3),m!==null)return m;const P=me("WEBCS_DOMAIN_BACKUP_LIST").map((Y,$)=>{let ee;return ee=e.cloudProxyServer==="disabled"&&e.proxyServer?f("".concat(Y,"/api/v2/transpond/webrtc?v=2"),$,e.proxyServer):e.cloudProxyServer==="disabled"||e.cloudProxyServer==="fallback"?"https://".concat(Y,"/api/v2/transpond/webrtc?v=2"):f("".concat(Y,"/api/v2/transpond/webrtc?v=2"),$),{url:ee,areaCode:g1(),serviceIds:[Pi.CHOOSE_SERVER,e.cloudProxyServer==="proxy5"?Pi.CLOUD_PROXY_5:e.cloudProxyServer==="proxy3"||e.cloudProxyServer==="proxy4"?Pi.CLOUD_PROXY:Pi.CLOUD_PROXY_FALLBACK]}}),F=s.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:P.map(Y=>Y.url)}),B=await y1({fragementLength:me("FRAGEMENT_LENGTH"),referenceList:P,asyncMapHandler:Y=>(G.debug("[".concat(e.clientId,"] Connect to backup choose_server:"),Y.url),MU(Y,e,t,r)),allFailedhandler:Y=>{throw s.recordJoinChannelService({endTs:Date.now(),status:"error",errors:Y},F),Y[0]},promisesCollector:E});return s.recordJoinChannelService({endTs:Date.now(),status:"success"},F),B};let A,O,D;try{({gatewayInfo:A,proxyInfo:O,url:D}=await S1([y(),b()]))}catch(P){throw P[0]}if(E.length&&E.forEach(P=>P.cancel&&typeof P.cancel=="function"&&P.cancel()),!A||!O)throw new xe(se.UNEXPECTED_ERROR,"missing gateway or proxy response").print();if(e.apUrl=D,e.cloudProxyServer!=="disabled"&&Array.isArray(l)&&D){const P=/^https?:\/\/(.+?)(\/.*)?$/.exec(D)[1];ht(l).call(l,P)&&(e.proxyServer=P,G.setProxyServer(P),Vt.setProxyServer(P))}return m={gatewayInfo:A,proxyInfo:await bU(O,A.uid)},m}async function $8(e,t,r){const s=me("UAP_AP").slice(0,me("AJAX_REQUEST_CONCURRENT")).map(f=>e.proxyServer?"https://".concat(e.proxyServer,"/ap/?url=").concat(f+"/api/v1?action=uap"):"https://".concat(f,"/api/v1?action=uap")),l=s.map(f=>function(m,E,y,b){const A={command:"convergeAllocateEdge",sid:E.sid,appId:E.appId,token:E.token,ts:Date.now(),version:hs,cname:E.cname,uid:E.uid.toString(),requestId:PU,seq:PU};PU+=1;const O={service_name:"tele_channel",json_body:JSON.stringify(A)};return _l(async()=>{const D=await cf(m,{data:O,cancelToken:y,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":61}});if(D.code!==0){const F=new xe(se.UNEXPECTED_RESPONSE,"cross channel ap error, code"+D.code,{retry:!0});throw G.error(F.toString()),F}const P=JSON.parse(D.json_body);if(P.code!==200){const F=new xe(se.UNEXPECTED_RESPONSE,"cross channel app center error, code: ".concat(P.code,", reason: ").concat(P.reason));throw G.error(F.toString()),F}if(!P.servers||P.servers.length===0){const F=new xe(se.UNEXPECTED_RESPONSE,"cross channel app center empty server");throw G.error(F.toString()),F}return{vid:P.vid,workerToken:P.workerToken,addressList:(me("CHANNEL_MEDIA_RELAY_SERVERS")||P.servers).map(F=>"wss://".concat(F.address.replace(/\./g,"-"),".").concat(me("WORKER_DOMAIN"),":").concat(F.wss))}},void 0,D=>!!(D.code!==se.OPERATION_ABORTED&&D.code!==se.UNEXPECTED_RESPONSE||D.data&&D.data.retry),b)}(f,e,t,r));try{const f=await S1(l);return l.forEach(m=>m.cancel()),f}catch(f){throw f[0]}}async function kI(e,t,r){let s=null;const l=[],f=async m=>{const E=me(m?"WEBCS_DOMAIN_BACKUP_LIST":"WEBCS_DOMAIN").map(y=>e.proxyServer?"https://".concat(e.proxyServer,"/ap/?url=").concat(y+"/api/v2/transpond/webrtc?v=2"):"https://".concat(y,"/api/v2/transpond/webrtc?v=2"));return m&&(await fs(1e3),s!==null)?s:await y1({fragementLength:me("FRAGEMENT_LENGTH"),referenceList:E,asyncMapHandler:y=>(G.debug("[".concat(e.clientId,"] update ticket, Connect to ").concat(m?"backup":""," choose_server:"),y),function(b,A,O,D){const[P]=UU(A,[Pi.CHOOSE_SERVER]);let F=na.networkState;return _l(async()=>{F&&na.networkState===Fs.OFFLINE&&na.onlineWaiter&&await gt.race([na.onlineWaiter,fs(D&&D.maxRetryTimeout||ra.maxRetryTimeout)]),F=na.networkState;const B=await cf(b,{data:P,cancelToken:O,headers:{"Content-Type":"multipart/form-data;"}},!0);return LY(B,b)},()=>!1,B=>B.code!==se.OPERATION_ABORTED&&(B.code===se.UPDATE_TICKET_FAILED?B.data.retry:(G.warning("[".concat(A.clientId,"] update ticket network error, retry"),B),!0)),D)}(y,e,t,r)),allFailedhandler:y=>{throw y[0]},promisesCollector:l})};try{return s=await S1([f(!1),f(!0)]),l.length&&l.forEach(m=>m.cancel&&typeof m.cancel=="function"&&m.cancel()),s}catch(m){throw m[0]}}function VU(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),r.push.apply(r,s)}return r}function pD(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?VU(Object(r),!0).forEach(function(s){ne(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):VU(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}class Wg extends Xt{get isSuccess(){return!!this.configs}constructor(t,r){super(),ne(this,"configs",void 0),ne(this,"store",void 0),ne(this,"joinInfo",void 0),ne(this,"cancelToken",void 0),ne(this,"retryConfig",{timeout:3e3,timeoutFactor:1.5,maxRetryCount:1,maxRetryTimeout:1e4}),ne(this,"interval",void 0),ne(this,"mutex",void 0),ne(this,"mutableParamsRead",!1),ne(this,"configCache",{}),ne(this,"limit_bitrate",void 0),this.mutex=new Gi("config-distribute",t),this.store=r}startGetConfigDistribute(t,r){this.joinInfo=t,this.cancelToken=r,this.interval&&this.stopGetConfigDistribute(),me("ENABLE_CONFIG_DISTRIBUTE")&&(this.updateConfigDistribute(),this.interval=window.setInterval(()=>{this.updateConfigDistribute()},me("CONFIG_DISTRIBUTE_INTERVAL")))}stopGetConfigDistribute(){this.interval&&clearInterval(this.interval),this.interval=void 0,this.joinInfo=void 0,this.cancelToken=void 0,this.configs=void 0,this.limit_bitrate=void 0}async awaitConfigDistributeComplete(){this.mutex.isLocked&&(await this.mutex.lock())()}async updateConfigDistribute(){if(this.mutableParamsRead||(this.mutableParamsRead=!0,Vt.reportApiInvoke(null,{options:void 0,name:Di.LOAD_CONFIG_FROM_LOCALSTORAGE,tag:Bn.TRACER}).onSuccess(JSON.stringify(gh))),!this.joinInfo||!this.cancelToken||!this.retryConfig)return void G.debug("[config-distribute] get config distribute interrupted have no joininfo");let t;const r=await this.mutex.lock();try{t=await Z8(this.joinInfo,this.cancelToken,this.retryConfig),G.debug("[config-distribute] get config distribute",JSON.stringify(t));const s=function(l){var f;const m=sn(f=Object.keys(l).filter(b=>/^webrtc_ng_global_parameter/.test(b))).call(f);for(let b=0;b<m.length;b++)for(let A=m.length-1;A>b;A--){const O=m[A],D=l[O].value;if(typeof D.__priority=="number"){const P=D.__priority,F=m[A-1],B=l[F].value;if(typeof B.__priority=="number"){if(!(P>B.__priority))continue;{const Y=O;m[A]=m[A-1],m[A-1]=Y}}else{const Y=O;m[A]=m[A-1],m[A-1]=Y}}}const E=Date.now();let y={};return m.forEach(b=>{const A=l[b].value.__expires;A&&A<=E||(y[b]=l[b])}),y}(t);this.cacheGlobalParameterConfig(s),this.store.hasStartJoinChannel||(this.store.isABTestSuccess=!0),this.configs=s}catch(s){const l=new xe(se.NETWORK_RESPONSE_ERROR,s);G.warning("[config-distribute] ".concat(l.toString()))}finally{r()}}getBitrateLimit(){return this.limit_bitrate||void 0}handleBitrateLimit(t){od(t)&&(this.limit_bitrate?this.limit_bitrate&&this.limit_bitrate.id!==t.id&&this.emit(sd.UPDATE_BITRATE_LIMIT,t):this.emit(sd.UPDATE_BITRATE_LIMIT,t))}getLowStreamConfigDistribute(){return this.limit_bitrate&&pD({},this.limit_bitrate.low_stream_uplink)}handleABTestConfigDistribute(t){try{const r={},s=Object.keys(t),l=[];s.forEach(f=>{const m=t[f].value;r[f]=m;const E=m.__id;if(E&&this.configCache[f]&&this.configCache[f].__id===E)return;const y=m.__type,b=t[f].value,A=t[f].tag;let O=0;y?y===f8.REALTIME&&(O=1):Object.keys(b).some(D=>Object.prototype.hasOwnProperty.call(Ox,D)||!uU()&&Object.prototype.hasOwnProperty.call(RL,D)?(O=1,!0):void 0),l.push({tag:A,isApplied:O,feature:f,params:JSON.stringify(m)})}),l.forEach(f=>{let{tag:m,feature:E,params:y,isApplied:b}=f;this.store.sessionId&&Vt.abTest(this.store.sessionId,{intSucc:1,isApplied:b,tag:m,feature:E,params:y,cid:this.store.cid,uid:this.store.intUid})}),this.configCache=r}catch(r){G.debug("handleABTestConfigDistribute error",r)}}cacheGlobalParameterConfig(t){const r=function(l){const f={};return Object.keys(l).forEach(m=>{const E=l[m].value,y=E.__expires,b=E.__type;Object.keys(E).forEach(A=>{A==="__id"||A==="__type"||A==="__priority"||A==="__expires"||Object.prototype.hasOwnProperty.call(f,A)||(f[A]=pD(pD({value:E[A]},y&&{expires:y}),b&&{type:b}))})}),f}(t);try{var s;const l=(s=r.LIMIT_BITRATE)===null||s===void 0?void 0:s.value;delete r.LIMIT_BITRATE,l&&od(l)&&this.handleBitrateLimit(l),this.limit_bitrate=l,this.handleGlobalParameterConfig(r),this.handleABTestConfigDistribute(t),function(E){try{const y=Date.now();Object.keys(E).forEach(b=>{const{value:A,type:O,expires:D}=E[b];D&&D<=y||((O===f8.REALTIME||Object.prototype.hasOwnProperty.call(Ox,b))&&(gh[b]=A,ti[b]=A,G.debug("Update realtime parameters from config distribute",b,A)),O||uU()||!Object.prototype.hasOwnProperty.call(RL,b)||(gh[b]=A,ti[b]=A,G.debug("Update gateway parameters from config distribute",b,A)))})}catch(y){G.error("Error update config immediately: ".concat(E),y.message)}}(r);const f=JSON.stringify(r),m=window.btoa(f);window.localStorage.setItem("websdk_ng_global_parameter",m),G.debug("Caching global parameters ".concat(f))}catch(l){G.error("Error caching global parameters:",l.message)}}handleGlobalParameterConfig(t){try{const r=Date.now();Object.keys(t).forEach(s=>{if(s==="CLIENT_ROLE_OPTIONS"&&Object.prototype.hasOwnProperty.call(ti,s)){const{value:l,expires:f}=t[s];if(f&&f<=r)return;(function(m,E){try{return typeof m=="object"&&typeof E=="object"&&JSON.stringify(m)===JSON.stringify(E)}catch{return!1}})(ti[s],l)||(gh[s]=l,ti[s]=l,this.emit(sd.UPDATE_CLIENT_ROLE_OPTIONS,l),G.debug("Updating client role options: ".concat(JSON.stringify(l))))}})}catch(r){G.error("Error handling global parameter config:",r.message)}}}class b1 extends Xt{constructor(){super(...arguments),ne(this,"resultStorage",new Map)}setLocalAudioStats(t,r,s){this.record("AUDIO_INPUT_LEVEL_TOO_LOW",t,this.checkAudioInputLevel(s,r)),this.record("SEND_AUDIO_BITRATE_TOO_LOW",t,this.checkSendAudioBitrate(s,r))}setLocalVideoStats(t,r,s){this.record("SEND_VIDEO_BITRATE_TOO_LOW",t,this.checkSendVideoBitrate(s,r)),this.record("FRAMERATE_INPUT_TOO_LOW",t,this.checkFramerateInput(s,r)),this.record("FRAMERATE_SENT_TOO_LOW",t,this.checkFramerateSent(s))}setRemoteAudioStats(t,r){const s=t.getUserId();this.record("AUDIO_OUTPUT_LEVEL_TOO_LOW",s,this.checkAudioOutputLevel(r))}setRemoteVideoStats(t,r){const s=t.getUserId();this.record("RECV_VIDEO_DECODE_FAILED",s,this.checkVideoDecode(r))}record(t,r,s){if(me("STATS_UPDATE_INTERVAL")>500)return;this.resultStorage.has(t)||this.resultStorage.set(t,{result:[],isPrevNormal:!0});const l=this.resultStorage.get(t);if(l&&(l.result.push(s),l.result.length>=5)){var f;const m=ht(f=l.result).call(f,!0);l.isPrevNormal&&!m&&this.emit("exception",xI[t],t,r),!l.isPrevNormal&&m&&this.emit("exception",xI[t]+2e3,t+"_RECOVER",r),l.isPrevNormal=m,l.result=[]}}checkAudioOutputLevel(t){return!(t.receiveBitrate>0&&t.receiveLevel===0)}checkAudioInputLevel(t,r){return r instanceof Sa&&!r.isActive||!!r.muted||t.sendVolumeLevel!==0}checkFramerateInput(t,r){let s=null;r._encoderConfig&&r._encoderConfig.frameRate&&(s=Co(r._encoderConfig.frameRate));const l=t.captureFrameRate;return!s||!l||!(s>10&&l<5||s<10&&s>=5&&l<=1)}checkFramerateSent(t){return!(t.captureFrameRate&&t.sendFrameRate&&t.captureFrameRate>5&&t.sendFrameRate<=1)}checkSendVideoBitrate(t,r){return!!r.muted||t.sendBitrate!==0}checkSendAudioBitrate(t,r){return r instanceof Sa&&!r.isActive||!!r.muted||t.sendBitrate!==0}checkVideoDecode(t){return t.receiveBitrate===0||t.decodeFrameRate!==0}}const xI={FRAMERATE_INPUT_TOO_LOW:1001,FRAMERATE_SENT_TOO_LOW:1002,SEND_VIDEO_BITRATE_TOO_LOW:1003,RECV_VIDEO_DECODE_FAILED:1005,AUDIO_INPUT_LEVEL_TOO_LOW:2001,AUDIO_OUTPUT_LEVEL_TOO_LOW:2002,SEND_AUDIO_BITRATE_TOO_LOW:2003},ws=new class{markSubscribeStart(e,t){performance.mark("agora-web-sdk/".concat(e,"/subscribe-").concat(t))}markPublishStart(e,t){performance.mark("agora-web-sdk/".concat(e,"/publish-").concat(t))}measureFromSubscribeStart(e,t){const r=performance.getEntriesByName("agora-web-sdk/".concat(e,"/subscribe-").concat(t));if(r.length>0){const s=r[r.length-1];return Math.round(performance.now()-s.startTime)}return 0}measureFromPublishStart(e,t){const r=performance.getEntriesByName("agora-web-sdk/".concat(e,"/publish-").concat(t));if(r.length>0){const s=r[r.length-1];return Math.round(performance.now()-s.startTime)}return 0}};function BU(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),r.push.apply(r,s)}return r}function Y_(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?BU(Object(r),!0).forEach(function(s){ne(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):BU(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}class UI{constructor(t){ne(this,"store",void 0),ne(this,"onStatsException",void 0),ne(this,"onUploadPublishDuration",void 0),ne(this,"onStatsChanged",void 0),ne(this,"onVideoCodecChanged",void 0),ne(this,"localStats",new Map),ne(this,"remoteStats",new Map),ne(this,"updateStatsInterval",void 0),ne(this,"trafficStats",void 0),ne(this,"trafficStatsPeerList",[]),ne(this,"uplinkStats",void 0),ne(this,"exceptionMonitor",void 0),ne(this,"p2pChannel",void 0),ne(this,"scalabilityMode",Fp.L1T1),ne(this,"updateStats",()=>{this.p2pChannel&&(this.updateRemoteStats(this.p2pChannel),this.updateLocalStats(this.p2pChannel))}),this.store=t,this.exceptionMonitor=new b1,this.exceptionMonitor.on("exception",(r,s,l)=>{this.onStatsException&&this.onStatsException(r,s,l)})}startUpdateStats(){this.updateStatsInterval||(this.updateStatsInterval=window.setInterval(this.updateStats,1e3))}stopUpdateStats(){this.updateStatsInterval&&(window.clearInterval(this.updateStatsInterval),this.updateStatsInterval=void 0)}reset(){this.localStats=new Map,this.remoteStats=new Map,this.trafficStats=void 0,this.trafficStatsPeerList=[],this.uplinkStats=void 0}getLocalAudioTrackStats(){return this.localStats.get(at.LocalAudioTrack)||Y_({},Xb)}getLocalVideoTrackStats(){return this.localStats.get(at.LocalVideoTrack)||Y_({},NL)}getRemoteAudioTrackStats(t){const r=(f,m)=>{if(!this.trafficStats)return m;const E=this.trafficStats.peer_delay.find(y=>y.peer_uid===f);return E&&(m.publishDuration=E.B_ppad+(Date.now()-this.trafficStats.timestamp)),m},s={};if(t){var l;const f=(l=this.remoteStats.get(t))===null||l===void 0?void 0:l.audioStats;f&&(s[t]=r(t,f))}else Array.from(this.remoteStats.entries()).forEach(f=>{let[m,{audioStats:E}]=f;E&&(s[m]=r(m,E))});return s}getRemoteNetworkQualityStats(t){const r={};if(t){var s;const l=(s=this.remoteStats.get(t))===null||s===void 0?void 0:s.networkStats;l&&(r[t]=l)}else Array.from(this.remoteStats.entries()).forEach(l=>{let[f,{networkStats:m}]=l;m&&(r[f]=m)});return r}getRemoteVideoTrackStats(t){const r=(f,m)=>{if(!this.trafficStats)return m;const E=this.trafficStats.peer_delay.find(y=>y.peer_uid===f);return E&&(m.publishDuration=E.B_ppvd+(Date.now()-this.trafficStats.timestamp)),m},s={};if(t){var l;const f=(l=this.remoteStats.get(t))===null||l===void 0?void 0:l.videoStats;f&&(s[t]=r(t,f))}else Array.from(this.remoteStats.entries()).forEach(f=>{let[m,{videoStats:E}]=f;E&&(s[m]=r(m,E))});return s}getRTCStats(){let t=0,r=0,s=0,l=0;const f=this.localStats.get(at.LocalAudioTrack);f&&(t+=f.sendBytes,r+=f.sendBitrate);const m=this.localStats.get(at.LocalVideoTrack);m&&(t+=m.sendBytes,r+=m.sendBitrate);const E=this.localStats.get(at.LocalVideoLowTrack);E&&(t+=E.sendBytes,r+=E.sendBitrate),this.remoteStats.forEach(b=>{let{audioStats:A,videoStats:O}=b;A&&(s+=A.receiveBytes,l+=A.receiveBitrate),O&&(s+=O.receiveBytes,l+=O.receiveBitrate)});let y=1;return this.trafficStats&&(y+=this.trafficStats.peer_delay.length),{Duration:0,UserCount:y,SendBitrate:r,SendBytes:t,RecvBytes:s,RecvBitrate:l,OutgoingAvailableBandwidth:this.uplinkStats?this.uplinkStats.B_uab/1e3:0,RTT:this.trafficStats?2*this.trafficStats.B_acd:0}}addLocalStats(t){this.localStats.set(t,void 0)}removeLocalStats(t){t?this.localStats.delete(t):this.localStats.clear()}addRemoteStats(t){this.remoteStats.set(t,{})}removeRemoteStats(t){t?this.remoteStats.delete(t):this.remoteStats.clear()}addP2PChannel(t){this.p2pChannel=t}updateTrafficStats(t){t.peer_delay=t.peer_delay.filter(r=>r.B_ppad!==void 0||r.B_ppvd!==void 0),t.peer_delay.filter(r=>this.trafficStatsPeerList.indexOf(r.peer_uid)===-1).forEach(r=>{var s;const l=(s=this.p2pChannel)===null||s===void 0?void 0:s.getRemoteMedia(r.peer_uid),f=l!=null&&l.videoSSRC?ws.measureFromSubscribeStart(this.store.clientId,l.videoSSRC):0,m=l!=null&&l.audioSSRC?ws.measureFromSubscribeStart(this.store.clientId,l.audioSSRC):0;r.B_ppad!==void 0&&r.B_ppvd!==void 0&&(this.onUploadPublishDuration&&this.onUploadPublishDuration(r.peer_uid,r.B_ppad,r.B_ppvd,f>m?f:m),this.trafficStatsPeerList.push(r.peer_uid))}),this.trafficStats=t}updateUplinkStats(t){this.uplinkStats&&this.uplinkStats.B_fir!==t.B_fir&&G.debug("[".concat(this.store.clientId,"]: Period fir changes to ").concat(t.B_fir)),this.uplinkStats=t}static isRemoteVideoFreeze(t,r,s){if(!t)return!1;const l=!!s&&r.framesDecodeFreezeTime>s.framesDecodeFreezeTime,f=!s||r.framesDecodeCount>s.framesDecodeCount;return l||!f}static isRemoteAudioFreeze(t){return!!t&&t._isFreeze()}isLocalVideoFreeze(t){return!(!t.inputFrame||!t.sentFrame)&&t.inputFrame.frameRate>5&&t.sentFrame.frameRate<3}updateLocalStats(t){Array.from(this.localStats.entries()).forEach(r=>{let[s,l]=r;switch(s){case at.LocalVideoTrack:case at.LocalVideoLowTrack:{const E=l,y=Y_({},NL),b=t.getStats(),A=t.getLocalMedia(s);if(b){const O=b.videoSend.find(D=>D.ssrc===(A==null?void 0:A.ssrcs[0].ssrcId));if(O){const D=t.getLocalVideoSize(),P=t.getEncoderConfig(at.LocalVideoTrack);var f;(O.codec==="H264"||O.codec==="H265"||O.codec==="VP8"||O.codec==="VP9"||O.codec==="AV1X"||O.codec==="AV1")&&(y.codecType=O.codec,(E==null?void 0:E.codecType)!==O.codec&&((f=this.onVideoCodecChanged)===null||f===void 0||f.call(this,O.codec.toLocaleLowerCase()))),y.sendBytes=O.bytes,y.sendBitrate=E?8*Math.max(0,y.sendBytes-E.sendBytes):0,O.inputFrame?(y.captureFrameRate=O.inputFrame.frameRate,y.captureResolutionHeight=O.inputFrame.height,y.captureResolutionWidth=O.inputFrame.width):D&&(y.captureResolutionWidth=D.width,y.captureResolutionHeight=D.height),O.sentFrame?(y.sendFrameRate=O.sentFrame.frameRate,y.sendResolutionHeight=O.sentFrame.height,y.sendResolutionWidth=O.sentFrame.width):D&&(y.sendResolutionWidth=D.width,y.sendResolutionHeight=D.height),O.avgEncodeMs&&(y.encodeDelay=O.avgEncodeMs),P&&P.bitrateMax?y.targetSendBitrate=1e3*P.bitrateMax:O.targetBitrate&&(y.targetSendBitrate=O.targetBitrate),y.sendPackets=O.packets,y.sendPacketsLost=O.packetsLost,y.sendJitterMs=O.jitterMs,y.sendRttMs=O.rttMs,y.totalDuration=E?E.totalDuration+1:1,y.totalFreezeTime=E?E.totalFreezeTime:0,this.isLocalVideoFreeze(O)&&(y.totalFreezeTime+=1),O.scalabilityMode&&this.scalabilityMode!==O.scalabilityMode&&(G.debug("[".concat(this.store.clientId,"]: The scalabilityMode of the video sending stream is ").concat(O.scalabilityMode)),this.scalabilityMode=O.scalabilityMode)}this.trafficStats&&(y.currentPacketLossRate=(this.trafficStats.B_pvlr4||0)/100)}var m;this.localStats.set(s,y),((E==null?void 0:E.sendResolutionWidth)!==y.sendResolutionWidth||(E==null?void 0:E.sendResolutionHeight)!==y.sendResolutionHeight)&&((m=this.onStatsChanged)===null||m===void 0||m.call(this,"resolution",{width:y.sendResolutionWidth,height:y.sendResolutionHeight})),y&&A&&this.exceptionMonitor.setLocalVideoStats(this.store.uid,A.track,y);break}case at.LocalAudioTrack:{const E=l,y=Y_({},Xb),b=t.getStats(),A=t.getLocalMedia(s);if(b){const O=b.audioSend.find(D=>D.ssrc===(A==null?void 0:A.ssrcs[0].ssrcId));if(O){if(O.codec!=="opus"&&O.codec!=="aac"&&O.codec!=="PCMU"&&O.codec!=="PCMA"&&O.codec!=="G722"||(y.codecType=O.codec),O.inputLevel)y.sendVolumeLevel=Math.round(32767*O.inputLevel);else{const D=t.getLocalAudioVolume();D&&(y.sendVolumeLevel=Math.round(32767*D))}y.sendBytes=O.bytes,y.sendPackets=O.packets,y.sendPacketsLost=O.packetsLost,y.sendJitterMs=O.jitterMs,y.sendRttMs=O.rttMs,y.sendBitrate=E?8*Math.max(0,y.sendBytes-E.sendBytes):0}}this.trafficStats&&(y.currentPacketLossRate=(this.trafficStats.B_palr4||0)/100),this.localStats.set(at.LocalAudioTrack,y),y&&A&&this.exceptionMonitor.setLocalAudioStats(this.store.uid,A.track,y);break}}})}updateRemoteStats(t){Array.from(this.remoteStats.entries()).forEach(r=>{var s,l;let[f,{videoStats:m,audioStats:E,videoPcStats:y}]=r;const b=E,A=m,O=y,D=Y_({},ui),P=Y_({},Xn),F=Y_({},Me),{audioTrack:B,videoTrack:Y,audioSSRC:$,videoSSRC:ee}=t.getRemoteMedia(f);let Ee;Ee=this.store.useP2P?t.getStats(!0):t.getStats();const Re=(s=Ee)===null||s===void 0?void 0:s.audioRecv.find(ve=>ve.ssrc===$),Ie=(l=Ee)===null||l===void 0?void 0:l.videoRecv.find(ve=>ve.ssrc===ee),we=this.trafficStats&&this.trafficStats.peer_delay.find(ve=>ve.peer_uid===f);if(Re&&(Re.codec!=="opus"&&Re.codec!=="aac"&&Re.codec!=="PCMU"&&Re.codec!=="PCMA"&&Re.codec!=="G722"||(D.codecType=Re.codec),Re.outputLevel?D.receiveLevel=Math.round(32767*Re.outputLevel):B&&(D.receiveLevel=Math.round(32767*B.getVolumeLevel())),D.receiveBytes=Re.bytes,D.receivePackets=Re.packets,D.receivePacketsLost=Re.packetsLost,D.receivePacketsDiscarded=Re.packetsDiscarded,D.packetLossRate=D.receivePacketsLost/(D.receivePackets+D.receivePacketsLost),D.receiveBitrate=b?8*Math.max(0,D.receiveBytes-b.receiveBytes):0,D.totalDuration=b?b.totalDuration+1:1,D.totalFreezeTime=b?b.totalFreezeTime:0,D.freezeRate=D.totalFreezeTime/D.totalDuration,D.receiveDelay=Re.jitterBufferMs,D.totalDuration>10&&UI.isRemoteAudioFreeze(B)&&(D.totalFreezeTime+=1)),Ie){var Ue;Ie.codec!=="H264"&&Ie.codec!=="H265"&&Ie.codec!=="VP8"&&Ie.codec!=="VP9"&&Ie.codec!=="AV1X"&&Ie.codec!=="AV1"||(P.codecType=Ie.codec),P.receiveBytes=Ie.bytes,P.receiveBitrate=A?8*Math.max(0,P.receiveBytes-A.receiveBytes):0,P.decodeFrameRate=Ie.decodeFrameRate<0?0:Ie.decodeFrameRate,P.renderFrameRate=Ie.decodeFrameRate<0?0:Ie.decodeFrameRate,Ie.outputFrame&&(P.renderFrameRate=Ie.outputFrame.frameRate),Ie.receivedFrame?(P.receiveFrameRate=Ie.receivedFrame.frameRate,P.receiveResolutionHeight=Ie.receivedFrame.height,P.receiveResolutionWidth=Ie.receivedFrame.width):Y&&(P.receiveResolutionHeight=Y._videoHeight||0,P.receiveResolutionWidth=Y._videoWidth||0),Ie.framesRateFirefox!==void 0&&(P.receiveFrameRate=Math.round(Ie.framesRateFirefox)),P.receivePackets=Ie.packets,P.receivePacketsLost=Ie.packetsLost,P.packetLossRate=P.receivePacketsLost/(P.receivePackets+P.receivePacketsLost);const ve=A?A.totalFreezeTime:0,Ne=A?A.totalDuration:0;P.totalDuration=A?A.totalDuration+1:1,P.totalFreezeTime=(Ue=Ie.totalFreezesDuration)!==null&&Ue!==void 0?Ue:ve||0,P.receiveDelay=Ie.jitterBufferMs||0;const Ve=!!ee&&t.getRemoteVideoIsReady(ee);Ie.totalFreezesDuration===void 0&&Y&&Ve&&UI.isRemoteVideoFreeze(Y,Ie,O)&&(P.totalFreezeTime+=1),P.freezeRate=Math.max(0,Math.min((P.totalFreezeTime-ve)/(P.totalDuration-Ne),1))}we&&(D.end2EndDelay=we.B_ad,P.end2EndDelay=we.B_vd,D.transportDelay=we.B_ed,P.transportDelay=we.B_ed,D.currentPacketLossRate=we.B_ealr4/100,P.currentPacketLossRate=we.B_evlr4/100,F.uplinkNetworkQuality=we.B_punq?we.B_punq:0,F.downlinkNetworkQuality=we.B_pdnq?we.B_pdnq:0),this.remoteStats.set(f,{audioStats:D,videoStats:P,videoPcStats:Ie,networkStats:F}),B&&this.exceptionMonitor.setRemoteAudioStats(B,D),Y&&this.exceptionMonitor.setRemoteVideoStats(Y,P)})}}class FU{constructor(){ne(this,"destChannelMediaInfos",new Map),ne(this,"srcChannelMediaInfo",void 0)}setSrcChannelInfo(t){gU(t),this.srcChannelMediaInfo=t}addDestChannelInfo(t){gU(t),this.destChannelMediaInfos.set(t.channelName,t)}removeDestChannelInfo(t){lr(t),this.destChannelMediaInfos.delete(t)}getSrcChannelMediaInfo(){return this.srcChannelMediaInfo}getDestChannelMediaInfo(){return this.destChannelMediaInfos}}function mD(e){if(!(e instanceof FU))return new xe(se.INVALID_PARAMS,"Config should be instance of [ChannelMediaRelayConfiguration]").throw();const t=e.getSrcChannelMediaInfo(),r=e.getDestChannelMediaInfo();if(!t)return new xe(se.INVALID_PARAMS,"srcChannelMediaInfo should not be empty").throw();if(r.size===0)return new xe(se.INVALID_PARAMS,"destChannelMediaInfo should not be empty").throw()}class K_{get hasVideo(){return this._video_enabled_&&!this._video_muted_&&this._video_added_}get hasAudio(){return this._audio_enabled_&&!this._audio_muted_&&this._audio_added_}get audioTrack(){if(this.hasAudio||this._audio_pre_subscribed)return this._audioTrack}get videoTrack(){if(this.hasVideo||this._video_pre_subscribed)return this._videoTrack}get dataChannels(){return this._dataChannels}constructor(t,r){ne(this,"uid",void 0),ne(this,"_uintid",void 0),ne(this,"_trust_in_room_",!0),ne(this,"_trust_audio_enabled_state_",!0),ne(this,"_trust_video_enabled_state_",!0),ne(this,"_trust_audio_mute_state_",!0),ne(this,"_trust_video_mute_state_",!0),ne(this,"_audio_muted_",!1),ne(this,"_video_muted_",!1),ne(this,"_audio_enabled_",!0),ne(this,"_video_enabled_",!0),ne(this,"_audio_added_",!1),ne(this,"_video_added_",!1),ne(this,"_is_pre_created",!1),ne(this,"_video_pre_subscribed",!1),ne(this,"_audio_pre_subscribed",!1),ne(this,"_trust_video_stream_added_state_",!0),ne(this,"_trust_audio_stream_added_state_",!0),ne(this,"_audioTrack",void 0),ne(this,"_videoTrack",void 0),ne(this,"_dataChannels",[]),ne(this,"_audioSSRC",void 0),ne(this,"_videoSSRC",void 0),ne(this,"_audioOrtc",void 0),ne(this,"_videoOrtc",void 0),ne(this,"_cname",void 0),ne(this,"_rtxSsrcId",void 0),ne(this,"_videoMid",void 0),ne(this,"_audioMid",void 0),this.uid=t,this._uintid=r}}function jI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),r.push.apply(r,s)}return r}function VI(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?jI(Object(r),!0).forEach(function(s){ne(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):jI(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}const BI="9",gD=4e4;function _D(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),r.push.apply(r,s)}return r}function Yg(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_D(Object(r),!0).forEach(function(s){ne(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_D(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}var Kg=function(e){return e[e.DOWN=0]="DOWN",e[e.UP=1]="UP",e}(Kg||{});const C1=new Map;function GU(e,t,r,s){let{scale:l}=e;if(l===0&&s===Kg.UP||l>=t.length-1&&s===Kg.DOWN)return e;let f=Yg(Yg({},e),{},{scale:s===Kg.DOWN?++l:--l});switch(r){case"maintain-framerate":f=Yg(Yg({},f),t[l].motion);break;case"maintain-resolution":f=Yg(Yg({},f),t[l].detail);break;case"balanced":f=Yg(Yg({},f),t[l].balanced)}return f}function Wn(e,t){if(t){const r={overUse:0,underUse:0,adaptationList:zU(t)};C1.set(e,r)}else C1.delete(e)}function zU(e){const t=Yg({},e),{bitrateMax:r,frameRate:s,scaleResolutionDownBy:l,bitrateMin:f}=t,{MIN_FRAME_RATE:m,MAX_THRESHOLD_FRAMERATE:E,MAX_SCALE:y,BITRATE_MIN_THRESHOLD:b,BITRATE_MAX_THRESHOLD:A,BWE_SCALE_UP_THRESHOLD:O,BWE_SCALE_DOWN_THRESHOLD:D,PERF_SCALE_DOWN_THRESHOLD:P,PERF_SCALE_UP_THRESHOLD:F,BALANCE_BITRATE_FACTOR:B,BALANCE_FRAMERATE_FACTOR:Y,BALANCE_RESOLUTION_FACTOR:$,MOTION_RESOLUTION_FACTOR:ee,MOTION_BITRATE_FACTOR:Ee,DETAIL_FRAMERATE_FACTOR:Re,DETAIL_BITRATE_FACTOR:Ie}=IL,we=Math.min(t.frameRate,E),Ue=[{scale:0,threshold:{bwe_down:Math.round(Math.pow(D,1)*r),bwe_up:r,fps_down:Math.round(Math.pow(P,1)*we),fps_up:s},balanced:{scaleResolutionDownBy:1,frameRate:s,bitrateMax:r,bitrateMin:f},motion:{scaleResolutionDownBy:1,frameRate:s,bitrateMax:r,bitrateMin:f},detail:{scaleResolutionDownBy:1,frameRate:s,bitrateMax:r,bitrateMin:f}}];for(let ve=1;ve<=y;ve++){const Ne={bwe_up:Math.round(Math.pow(O,ve)*r),bwe_down:Math.round(Math.pow(D,ve+1)*r),fps_up:Math.round(Math.pow(F,ve)*we),fps_down:Math.round(Math.pow(P,ve+1)*we)},Ve={scaleResolutionDownBy:l/Math.pow($,ve),frameRate:Math.max(Math.round(Math.pow(Y,ve)*s),m),bitrateMax:Math.max(Math.round(Math.pow(B,ve)*r),A),bitrateMin:Math.max(Math.round(Math.pow(B,ve)*f),b)},Be={scaleResolutionDownBy:l/Math.pow(ee,ve),frameRate:s,bitrateMax:Math.max(Math.round(Math.pow(Ee,ve)*r),A),bitrateMin:Math.max(Math.round(Math.pow(Ee,ve)*f),b)},W={scaleResolutionDownBy:1,frameRate:Math.max(Math.round(Math.pow(Re,ve)*s),m),bitrateMax:Math.max(Math.round(Math.pow(Ie,ve)*r),A),bitrateMin:Math.max(Math.round(Math.pow(Ie,ve)*f),b)};Ue.push({scale:ve,threshold:Ne,balanced:Ve,motion:Be,detail:W})}return Ue}function Ih(e,t,r,s,l,f){const m=C1.get(e)||{overUse:0,underUse:0,adaptationList:zU(l)},{adaptationList:E}=m;C1.set(e,m);const{OVERUSE_TIMES_THRESHOLD:y,UNDERUSE_TIMES_THRESHOLD:b}=IL,{scale:A}=s;let O,D;return typeof t=="number"&&t>0&&function(P,F,B,Y){if(F>=B.length)return!1;let{threshold:{fps_down:$}}=B[F];return me("FORCE_AG_HIGH_FRAMERATE")&&Y==="maintain-framerate"&&($=B[0].threshold.fps_down),P<$}(t,A,E,f)&&(m.overUse++,D=bS.CPU,m.overUse>y)||typeof r=="number"&&r>0&&function(P,F,B){if(F>=B.length)return!1;const{threshold:{bwe_down:Y}}=B[F];return P<Y}(r,A,E)&&(m.overUse++,D=bS.BANDWIDTH,m.overUse>y)?(m.overUse=0,m.underUse=0,O=GU(s,E,f,Kg.DOWN),[O,D]):(typeof t=="number"&&t>0&&typeof r=="number"&&r>0&&function(P,F,B,Y){if(F===0)return;let{threshold:{fps_up:$}}=B[F];return me("FORCE_AG_HIGH_FRAMERATE")&&Y==="maintain-framerate"&&($=B[1].threshold.fps_up),P>$}(t,A,E,f)&&function(P,F,B){if(F===0)return;const{threshold:{bwe_up:Y}}=B[F];return P>Y}(r,A,E)&&(m.underUse++,m.underUse>b&&(m.overUse=0,m.underUse=0,O=GU(s,E,f,Kg.UP),O.scale===0&&(D=bS.NONE))),[O,D])}function Ah(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),r.push.apply(r,s)}return r}function wo(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Ah(Object(r),!0).forEach(function(s){ne(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ah(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function HU(e){var t;return!!me("ENABLE_AG_ADAPTATION")&&!!(e instanceof j_||ht(t=e._hints).call(t,xr.CUSTOM_TRACK))&&(!!me("FORCE_SUPPORT_AG_ADAPTATION")||!!(function(r){const s=qn();if(s.os!==mr.IOS||!s.osVersion)return!1;const l=s.osVersion.split(".");return Number(l[0])>=r}(14)&&jp(17,4)||mL(14)&&nI(17,4,!0)))}const BS=new Map;function Yi(e,t){const r=BS.get(e);if(r){const{timer:s}=r;window.clearTimeout(s),BS.delete(e)}t.qualityLimitationReason=bS.NONE,Wn(e)}function FS(e,t){var r;let s;switch(t){case at.LocalAudioTrack:s=Er.Audio;break;case at.LocalVideoTrack:s=ht(r=e._hints).call(r,xr.SCREEN_TRACK)?Er.Screen:Er.High;break;case at.LocalVideoLowTrack:s=Er.Low}return s}function Qi(e){const t=zn();if(e.some(r=>r._bypassWebAudio))throw new Ke(se.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");if(!t.webAudioMediaStreamDest)throw new Ke(se.NOT_SUPPORTED,"cannot publish multiple tracks because your browser does not support audio mixing")}function qg(e,t){Qi(e);const r=new Sa;return e.forEach(s=>r.addAudioTrack(s)),r}const eF=!zn().supportUnifiedPlan||me("CHROME_FORCE_PLAN_B")&&fh();function cu(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var r;return eF?(r={spec:t,store:e},wh("PlanBConnection").create(r)):new Kc(t,e)}function Ro(e){return e&&(e.iceConnectionState==="disconnected"||e.iceConnectionState==="checking"||e.iceConnectionState==="failed")}function WU(e){try{if(e.iceServers)return!1;if(e.turnServer&&e.turnServer.mode!=="off"){if(ki(e.turnServer.servers))return!1;if(me("FORCE_TURN_TCP")||e.turnServer.servers.concat(e.turnServer.serversFromGateway||[]).some(t=>t.forceturn))return!0}return!1}catch{return!1}}var gn;function FI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),r.push.apply(r,s)}return r}function fc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?FI(Object(r),!0).forEach(function(s){ne(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):FI(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}let Kc=(gn=class wA extends MS{get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get dtlsTransportState(){var t,r;return(t=(r=this.peerConnection.getReceivers()[0])===null||r===void 0||(r=r.transport)===null||r===void 0?void 0:r.state)!==null&&t!==void 0?t:null}get localCodecs(){return[...new Set(this.localCapabilities&&this.localCapabilities.send.videoCodecs.map(t=>t.rtpMap&&t.rtpMap.encodingName.toLowerCase()||"").filter(t=>{var r;return ht(r=Object.keys(AL)).call(r,t)}))]}constructor(t,r){super(t,r),ne(this,"id",Br(5,"connection-")),ne(this,"store",void 0),ne(this,"peerConnection",void 0),ne(this,"forceTurn",!1),ne(this,"remoteSDP",void 0),ne(this,"initialOffer",void 0),ne(this,"transportEventReceiver",void 0),ne(this,"statsFilter",void 0),ne(this,"extension",{useXR:me("USE_XR")}),ne(this,"localCapabilities",void 0),ne(this,"remoteCodecs",void 0),ne(this,"localCandidateCount",0),ne(this,"allCandidatesReceived",!1),ne(this,"isPreallocation",!1),ne(this,"preSSRCMap",new Map),ne(this,"dataStreamChannelMap",new Map),ne(this,"establishPromise",void 0),ne(this,"recoveredDataChannelIds",[]),ne(this,"currentDataChannelId",1),ne(this,"supportAV1RtpSpec",!1),ne(this,"mutex",void 0),ne(this,"qualityLimitationReason",bS.NONE),ne(this,"isFirstConnected",!1),this.store=r,this.forceTurn=WU(t),this.mutex=new Gi("P2PConnection-mutex",r.clientId),this.peerConnection=new RTCPeerConnection(wA.resolvePCConfiguration(t),{optional:[{googDscp:!0}]}),this.isFirstConnected=!1,this.statsFilter=Sr(this.peerConnection,me("STATS_UPDATE_INTERVAL"),void 0,ei()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1,this.establishPromise=this.establish()}getPreMedia(t){const r=this.preSSRCMap.get(t);if(r!==void 0){const s=this.peerConnection.getTransceivers().find(l=>l.mid===r);if(s)return{transceiver:s,track:s.receiver.track,id:r}}}async updateRemoteRTPCapabilities(t,r){if(this.remoteCodecs=r,!this.remoteSDP)return void G.debug("[P2PConnection] cannot updateRemoteRTPCapabilities before remote SDP created, local codecs: ".concat(this.localCodecs,", codecs: ").concat(r));if(this.remoteSDP.updateRemoteCodec(t,r,this.store.codec)){const s=await this.peerConnection.createOffer(),l=this.logSDPExchange(s.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(s);const f=this.remoteSDP.toString();l==null||l(f),await this.peerConnection.setRemoteDescription({type:"answer",sdp:f})}else G.debug("[P2PConnection] updateRemoteRTPCapabilities no need to exchange SDP.")}async establish(){try{this.peerConnection.addTransceiver("video",{direction:"recvonly"}),this.peerConnection.addTransceiver("audio",{direction:"recvonly"});const s=await this.peerConnection.createOffer();if(!s.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const l=ou(s.sdp),f=await IU({filterRTX:!me("USE_PUB_RTX")&&!me("USE_SUB_RTX"),filterVideoFec:me("FILTER_VIDEO_FEC"),filterAudioFec:me("FILTER_AUDIO_FEC"),filterVideoCodec:me("FILTER_VIDEO_CODEC")},this.extension);if(this.localCapabilities=NI(f),this.initialOffer=s,me("ENABLE_SVC")&&this.store.codec=="av1"){const E=await async function(){try{const y=new RTCPeerConnection;y.addTransceiver("video",{direction:"sendonly",sendEncodings:[{scalabilityMode:Fp.L1T3}]});const b=await y.createOffer();if(!b.sdp)return void y.close();const A=on(b.sdp).mediaDescriptions[0];if(!A)return;const O=A.attributes.extmaps.find(D=>D.extensionName==="https://aomediacodec.github.io/av1-rtp-spec/#dependency-descriptor-rtp-header-extension");return y.close(),O}catch{return}}();var t;E&&(this.supportAV1RtpSpec=!0,(t=f.send)===null||t===void 0||t.videoExtensions.push(E))}let m;return s.sdp&&oD(s.sdp)&&(m=Mn(f),(r=m).send&&(Fg(ut.VIDEO,r.send.videoExtensions),Fg(ut.AUDIO,r.send.audioExtensions)),r.recv&&(Fg(ut.VIDEO,r.recv.videoExtensions),Fg(ut.AUDIO,r.recv.audioExtensions)),r.sendrecv&&(Fg(ut.VIDEO,r.sendrecv.videoExtensions),Fg(ut.AUDIO,r.sendrecv.audioExtensions))),fc(fc({},l),{},{rtpCapabilities:m||f,offerSDP:s.sdp})}catch(s){throw new Ke(se.GET_LOCAL_CONNECTION_PARAMS_FAILED,s.toString())}var r}async connect(t){try{if(!this.initialOffer)throw new Error("Cannot establish P2PConnection without initial offer.");this.initialOffer.sdp&&oD(this.initialOffer.sdp)&&(r=t.rtpCapabilities,s=this.localCapabilities,r.send&&(AI(ut.VIDEO,r.send.videoExtensions,s.send.videoExtensions),AI(ut.AUDIO,r.send.audioExtensions,s.send.audioExtensions)),r.recv&&(AI(ut.VIDEO,r.recv.videoExtensions,s.recv.videoExtensions),AI(ut.AUDIO,r.recv.audioExtensions,s.recv.audioExtensions))),this.remoteSDP=new class{get localCapabilities(){return Mn(this._localCapabilities)}get rtpCapabilities(){return Mn(this._rtpCapabilities)}get candidates(){return Mn(this._candidates)}get iceParameters(){return Mn(this._iceParameters)}get dtlsParameters(){return Mn(this._dtlsParameters)}constructor(b){let A=arguments.length>1&&arguments[1]!==void 0&&arguments[1];ne(this,"sessionDesc",void 0),ne(this,"_localCapabilities",void 0),ne(this,"_rtpCapabilities",void 0),ne(this,"_candidates",void 0),ne(this,"_originCandidates",void 0),ne(this,"_iceParameters",void 0),ne(this,"_isUseExtmapAllowMixed",void 0),ne(this,"_dtlsParameters",void 0),ne(this,"setup",void 0),ne(this,"currentMidIndex",void 0),ne(this,"cname",void 0),ne(this,"firefoxSsrcMidMap",new Map),this._isUseExtmapAllowMixed=A,b=Mn(b);const{iceParameters:O,dtlsParameters:D,candidates:P,rtpCapabilities:F,setup:B,localCapabilities:Y,cname:$}=b;this._rtpCapabilities=F,this._candidates=P,this._originCandidates=Mn(P),this._iceParameters=O,this._dtlsParameters=D,this._localCapabilities=Y,this.setup=B,this.cname=$,this.sessionDesc=this.updateRemoteRTPCapabilities(F),this.currentMidIndex=this.sessionDesc.mediaDescriptions.length-1}preloadRemoteMedia(b){const A=this.candidates,O=this.dtlsParameters,D=this.iceParameters,P=this.rtpCapabilities.send;let F=this.sessionDesc.mediaDescriptions.length-1;for(let B=1;B<b;B++){const Y=2*B+2e4,$=2*B+gD,{ssrcs:ee,ssrcGroups:Ee}=H_([{ssrcId:Y}],this.cname),{ssrcs:Re,ssrcGroups:Ie}=H_([{ssrcId:$,rtx:me("USE_SUB_RTX")?$+1:void 0}],this.cname);this.sessionDesc.mediaDescriptions.push({media:{mediaType:"video",port:BI,protos:["UDP","TLS","RTP","SAVPF"],fmts:P.videoCodecs.map(we=>we.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:D.iceUfrag,icePwd:D.icePwd,unrecognized:[],candidates:A,extmaps:P.videoExtensions,fingerprints:O.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:Re,ssrcGroups:Ie,rtcpFeedbackWildcards:[],payloads:P.videoCodecs,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:"sendonly",rtcpMux:!0,rtcpRsize:!0,mid:"".concat(++F)}}),this.sessionDesc.mediaDescriptions.push({media:{mediaType:"audio",port:BI,protos:["UDP","TLS","RTP","SAVPF"],fmts:P.audioCodecs.map(we=>we.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:D.iceUfrag,icePwd:D.icePwd,unrecognized:[],candidates:A,extmaps:P.audioExtensions,fingerprints:O.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:ee,ssrcGroups:Ee,rtcpFeedbackWildcards:[],payloads:P.audioCodecs,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:"sendonly",rtcpMux:!0,rtcpRsize:!0,mid:"".concat(++F)}}),this.currentMidIndex+=2}this.updateBundleMids()}toString(){return zr(this.sessionDesc)}send(b,A,O,D){const{ssrcs:P,ssrcGroups:F}=H_(A,this.cname,me("SYNC_GROUP")?O:void 0),B=this.findPreloadMediaDesc(P);if(B){if(ei()&&this.firefoxSsrcMidMap.set(P[0].ssrcId,B.attributes.mid),D&&(D.twcc||D.remb)){const Y=this.sessionDesc.mediaDescriptions.indexOf(B);return this.sessionDesc.mediaDescriptions[Y]=this.mungSendMediaDesc(B,D),{mid:B.attributes.mid,needExchangeSDP:!0}}return{mid:B.attributes.mid,needExchangeSDP:!1}}{const Y=this.findAvailableMediaIndex(b,P);let $;return Y===-1||Y===1&&(ns()||function(){const ee=qn();return!(ee.name!==sr.CHROME||!ee.osVersion)&&Number(ee.version)<=90}()||me("ENABLE_ENCODED_TRANSFORM")&&Up())||Y===0&&me("USE_SUB_RTX")||vx()?($=this.createOrRecycleSendMedia(b,P,F,"sendonly",D),this.updateBundleMids()):($=Mn(this.sessionDesc.mediaDescriptions[Y]),$.attributes.direction="sendonly",$.attributes.ssrcs=P,$.attributes.ssrcGroups=F,this.sessionDesc.mediaDescriptions[Y]=this.mungSendMediaDesc($,D)),ei()&&this.firefoxSsrcMidMap.set(P[0].ssrcId,$.attributes.mid),{mid:$.attributes.mid,needExchangeSDP:!0}}}sendDataChannel(){const{mediaDesc:b,needExchangeSDP:A}=this.createOrRecycleDataChannel();return this.updateBundleMids(),{mid:b.attributes.mid,needExchangeSDP:A}}batchSend(b){const A=b.map(P=>{let{kind:F,ssrcMsg:B,mslabel:Y}=P;return this.send(F,B,Y)}),O=[];let D=!1;return A.forEach(P=>{let{mid:F,needExchangeSDP:B}=P;B&&(D=!0),O.push(F)}),{mids:O,needExchangeSDP:D}}stopSending(b){const A=this.sessionDesc.mediaDescriptions.filter(O=>O.attributes.mid&&b.indexOf(O.attributes.mid)!==-1);if(A.length!==b.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.stopSending.");A.forEach(O=>{O.attributes.mid==="0"||ei()||vx()?O.attributes.ssrcs=[]:(O.attributes.ssrcs=[],O.attributes.direction="inactive",O.media.port="0")}),this.updateBundleMids()}mute(b){const A=this.sessionDesc.mediaDescriptions.find(O=>O.attributes.mid===b);if(!A)throw new Error("mediaDescription not found with ".concat(b," in remote SDP when calling RemoteSDP.mute."));A.attributes.direction="inactive"}unmute(b){const A=this.sessionDesc.mediaDescriptions.find(O=>O.attributes.mid===b);if(!A)throw new Error("mediaDescription not found with ".concat(b," in remote SDP when calling RemoteSDP.unmute."));A.attributes.direction="sendonly"}muteRemote(b){const A=this.sessionDesc.mediaDescriptions.filter(O=>ht(b).call(b,O.attributes.mid||""));if(A.length!==b.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");A.forEach(O=>{O.attributes.direction="inactive"})}unmuteRemote(b){const A=this.sessionDesc.mediaDescriptions.filter(O=>ht(b).call(b,O.attributes.mid||""));if(A.length!==b.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");A.forEach(O=>{O.attributes.direction="recvonly"})}receive(b,A,O,D){b.forEach((P,F)=>{this.createOrRecycleRecvMedia(P,[],"recvonly",A,O,D[F])}),this.updateBundleMids()}stopReceiving(b){const A=this.sessionDesc.mediaDescriptions.filter(O=>b.indexOf(O.attributes.mid)!==-1);if(A.length!==b.length)throw new Error("MediaDescriptions' length doesn't match mids's length when calling RemoteSDP.receive.");A.forEach(O=>{O.media.port="0",O.attributes.direction="inactive"}),this.updateBundleMids()}updateRemoteRTPCapabilities(b){const A=this.sessionDesc||on((O=this._isUseExtmapAllowMixed,`v=0
o=- 0 0 IN IP4 127.0.0.1
s=AgoraGateway
t=0 0
a=group:BUNDLE 0 1
a=msid-semantic: WMS
a=ice-lite`.concat(O?`
a=extmap-allow-mixed`:"",`
m=video 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendonly
a=rtcp-mux
a=rtcp-rsize
a=mid:0
m=audio 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendonly
a=rtcp-mux
a=rtcp-rsize
a=mid:1
`)));var O;this._rtpCapabilities=b;const D=this.rtpCapabilities.send,P=this.localCapabilities.send;for(const F of A.mediaDescriptions){if(F.attributes.iceUfrag=this._iceParameters.iceUfrag,F.attributes.icePwd=this._iceParameters.icePwd,F.attributes.fingerprints=this._dtlsParameters.fingerprints,F.attributes.candidates=this._candidates,F.attributes.setup=this.setup,F.media.mediaType==="application"&&(F.attributes.sctpPort="5000"),F.media.mediaType==="video"){if(D.videoCodecs.length===0){const B=P.videoCodecs.filter(Y=>{var $,ee;return($=Y.rtpMap)===null||$===void 0?void 0:ht(ee=$.encodingName.toLowerCase()).call(ee,"vp8")})||[P.videoCodecs[0]];F.media.fmts=B.map(Y=>Y.payloadType.toString(10)),F.attributes.payloads=B,F.attributes.extmaps=[]}else if(F.media.fmts=D.videoCodecs.map(B=>B.payloadType.toString(10)),F.attributes.payloads=D.videoCodecs,F.attributes.extmaps=D.videoExtensions,me("PRELOAD_MEDIA_COUNT")>0){const{ssrcs:B,ssrcGroups:Y}=H_([{ssrcId:gD,rtx:me("USE_SUB_RTX")?40001:void 0}],this.cname);F.attributes.ssrcs=B,F.attributes.ssrcGroups=Y}}if(F.media.mediaType==="audio"){if(D.audioCodecs.length===0){const B=P.audioCodecs.filter(Y=>{var $,ee;return($=Y.rtpMap)===null||$===void 0?void 0:ht(ee=$.encodingName.toLowerCase()).call(ee,"opus")})||[P.audioCodecs[0]];F.media.fmts=B.map(Y=>Y.payloadType.toString(10)),F.attributes.payloads=B,F.attributes.extmaps=[]}else if(F.media.fmts=D.audioCodecs.map(B=>B.payloadType.toString(10)),F.attributes.payloads=D.audioCodecs,F.attributes.extmaps=D.audioExtensions,zg(F),me("PRELOAD_MEDIA_COUNT")>0){const{ssrcs:B,ssrcGroups:Y}=H_([{ssrcId:2e4}],this.cname);F.attributes.ssrcs=B,F.attributes.ssrcGroups=Y}}}return this.sessionDesc=A,this.currentMidIndex=A.mediaDescriptions.length-1,this.sessionDesc}updateCandidates(b){const A=this._originCandidates.filter(D=>D.transport==="udp"),O=[];if(A.forEach(D=>{O.push(VI(VI({},D),{},{foundation:"tcpcandidate",priority:Number(D.priority)-1+"",transport:"tcp",port:Number(D.port)+90+""}))}),A.length!==0){switch(b){case Ua.TCP_RELAY:this._candidates=O;break;case Ua.UDP_TCP_RELAY:case Ua.RELAY:this._candidates=[...A,...O];break;default:this._candidates=A}for(const D of this.sessionDesc.mediaDescriptions)D.attributes.candidates=this.candidates}}restartICE(b){b=Mn(b),this._iceParameters=b,this.sessionDesc.mediaDescriptions.forEach(A=>{A.attributes.iceUfrag=b.iceUfrag,A.attributes.icePwd=b.icePwd})}predictReceivingMids(b){const A=[];for(let O=0;O<b;O++)A.push((this.currentMidIndex+O+1).toString(10));return A}findAvailableMediaIndex(b,A){return this.sessionDesc.mediaDescriptions.findIndex(O=>{const D=O.media.mediaType===b&&O.media.port!=="0"&&(O.attributes.direction==="sendonly"||O.attributes.direction==="sendrecv")&&O.attributes.ssrcs.length===0;if(ei()){if(D){const P=this.firefoxSsrcMidMap.get(A[0].ssrcId);return!(P||O.attributes.mid!=="0"&&O.attributes.mid!=="1")||!(!P||P!==O.attributes.mid)}return!1}return D})}createOrRecycleDataChannel(){for(const O of this.sessionDesc.mediaDescriptions)if(O.media.mediaType==="application")return{mediaDesc:O,needExchangeSDP:!1};this.currentMidIndex+=1;const b="".concat(this.currentMidIndex),A={media:{mediaType:"application",port:BI,protos:["UDP","DTLS","SCTP"],fmts:["webrtc-datachannel"]},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:[],fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:[],ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:[],rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,mid:"".concat(b),sctpPort:"5000"}};return this.sessionDesc.mediaDescriptions.push(A),{mediaDesc:A,needExchangeSDP:!0}}createOrRecycleRecvMedia(b,A,O,D,P,F){const B=b._mediaStreamTrack.kind,Y=this.rtpCapabilities.recv,$=p1(B,Y,this.localCapabilities.send,B===ut.VIDEO?D:P),ee=B===ut.VIDEO?Y.videoExtensions:Y.audioExtensions;this.currentMidIndex+=1;const Ee="".concat(this.currentMidIndex);let Re={media:{mediaType:B,port:BI,protos:["UDP","TLS","RTP","SAVPF"],fmts:$.map(we=>we.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:ee,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:A,ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:$,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:O,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(Ee)}};Re=this.mungRecvMediaDsec(Re,b,F);const Ie=this.findFirstClosedMedia(B);if(Ie){const we=this.sessionDesc.mediaDescriptions.indexOf(Ie);this.sessionDesc.mediaDescriptions[we]=Re}else this.sessionDesc.mediaDescriptions.push(Re);return Re}updateRemoteCodec(b,A,O){const D=[...new Set(this._rtpCapabilities.recv.videoCodecs.map(Re=>Re.rtpMap&&Re.rtpMap.encodingName.toLowerCase()||"").filter(Re=>{var Ie;return ht(Ie=Object.keys(AL)).call(Ie,Re)}))],P=new Set(A);if(D.every(Re=>P.has(Re)))return G.debug("codecs has not changed, no need to updateRemoteCodec, codecs: ".concat(A)),!1;const F=this._rtpCapabilities.recv.videoCodecs.filter(Re=>A.some(Ie=>{var we;return ht(we=Re.rtpMap&&Re.rtpMap.encodingName.toLowerCase()||"").call(we,Ie)}));if(F.length===0)return G.debug("updateRemoteCodec failed, because cannot find matched codec, remoteCapabilities codecs: ".concat(D," codecs: ").concat(A)),!1;const B=[...new Set(F.map(Re=>Re.rtpMap&&Re.rtpMap.encodingName.toLowerCase()||""))];let Y;if(G.debug("updateRemoteCodec, from ".concat(D," to ").concat(B)),b.length===0)Y=this.sessionDesc.mediaDescriptions.filter(Re=>Re.media.mediaType==="video"&&Re.attributes.direction==="recvonly");else if(Y=this.sessionDesc.mediaDescriptions.filter(Re=>Re.attributes.mid&&Re.media.mediaType==="video"&&ht(b).call(b,Re.attributes.mid)&&Re.attributes.direction==="recvonly"),Y.length!==b.length)return G.debug("updateRemoteCodec failed, because cannot find mids, mids: ".concat(b,", codecs: ").concat(A)),!1;if(me("USE_PUB_RTX")||me("USE_SUB_RTX")){const Re=bh(F,this.rtpCapabilities.recv.videoCodecs);F.push(...Re)}this._rtpCapabilities.recv.videoCodecs=F;const $=this.localCapabilities.send,ee=this.rtpCapabilities.recv,Ee=p1(ut.VIDEO,ee,$,O);return Y.forEach(Re=>{const Ie=Ee.map(we=>we.payloadType.toString(10));G.debug("updateRemoteCodec mid: ".concat(Re.attributes.mid,", from"),Re.attributes.payloads,"to",Ee),Re.attributes.payloads=Ee,Re.media.fmts=Ie}),!0}createOrRecycleSendMedia(b,A,O,D,P){const F=this.rtpCapabilities.send,B=b===ut.VIDEO?F.videoCodecs:F.audioCodecs,Y=b===ut.VIDEO?F.videoExtensions:F.audioExtensions;this.currentMidIndex+=1;const $="".concat(this.currentMidIndex);let ee={media:{mediaType:b,port:BI,protos:["UDP","TLS","RTP","SAVPF"],fmts:B.map(Re=>Re.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:Y,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:A,ssrcGroups:O,rtcpFeedbackWildcards:[],payloads:B,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:D,rtcpMux:!0,rtcpRsize:!0,mid:"".concat($)}};ee=this.mungSendMediaDesc(ee,P);const Ee=this.findFirstClosedMedia(b);if(Ee){const Re=this.sessionDesc.mediaDescriptions.indexOf(Ee);this.sessionDesc.mediaDescriptions[Re]=ee}else this.sessionDesc.mediaDescriptions.push(ee);return ee}updateBundleMids(){this.sessionDesc.attributes.groups[0].identificationTag=this.sessionDesc.mediaDescriptions.filter(b=>b.media.port!=="0").map(b=>b.attributes.mid)}mungRecvMediaDsec(b,A,O){const D=Mn(b);return aD(D),xS(D,A),sD(D,A),RU(D),Wc(D,O,this.localCapabilities.send),D}mungSendMediaDesc(b,A){const O=Mn(b);return Wc(O,A,this.localCapabilities.recv),zg(O),O}updateRecvMedia(b,A){const O=this.sessionDesc.mediaDescriptions.findIndex(D=>D.attributes.mid===b);if(O!==-1){const D=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[O],A);this.sessionDesc.mediaDescriptions[O]=D}}bumpMid(b){this.currentMidIndex+=b}findFirstClosedMedia(b){return this.sessionDesc.mediaDescriptions.find(A=>ei()?A.media.port==="0"&&A.media.mediaType===b:A.media.port==="0")}findPreloadMediaDesc(b){return this.sessionDesc.mediaDescriptions.find(A=>{var O;return((O=A.attributes)===null||O===void 0||(O=O.ssrcs[0])===null||O===void 0?void 0:O.ssrcId)===b[0].ssrcId})}getSSRC(b){var A;return(A=this.sessionDesc.mediaDescriptions.find(O=>O.attributes.mid===b))===null||A===void 0?void 0:A.attributes.ssrcs}}(fc(fc({},t),{},{localCapabilities:this.localCapabilities}),this.supportAV1RtpSpec),t.preallocation&&(this.isPreallocation=!0),Array.isArray(this.remoteCodecs)&&this.remoteCodecs.length>0&&this.remoteSDP.updateRemoteCodec([],this.remoteCodecs,this.store.codec);const l=this.remoteSDP.toString(),f=K8(this.initialOffer.sdp,this.extension),m=this.logSDPExchange(f||"","offer","local","connect");this.store.descriptionStart(),await this.peerConnection.setLocalDescription({type:"offer",sdp:f}),m==null||m(l),await this.peerConnection.setRemoteDescription({type:"answer",sdp:l});const E=this.peerConnection.getTransceivers()[0];if(E!=null&&E.receiver&&this.tryBindTransportEvents(E.receiver),me("PRELOAD_MEDIA_COUNT")>0){this.remoteSDP.preloadRemoteMedia(me("PRELOAD_MEDIA_COUNT"));const b=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:b});const A=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(A)}const{preSSRCs:y}=t;if(Array.isArray(y)&&y.length>0){const{mids:b}=this.remoteSDP.batchSend(y.map(A=>({kind:A.kind,ssrcMsg:[{ssrcId:A.ssrcId,rtx:A.rtx}],mslabel:A.mslabel})));b.forEach((A,O)=>{this.preSSRCMap.set(y[O].ssrcId,A)}),await US(this.peerConnection,this.remoteSDP,this.extension),G.debug("[".concat(this.store.clientId,"] [P2PConnection] pre-batchReceive exchange SDP."))}}catch(l){throw new Ke(se.EXCHANGE_SDP_FAILED,"P2PConnection.connect failed; ".concat(l.toString()))}var r,s}async updateRemoteConnect(t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateRemoteConnect before remote SDP created");const{rtpCapabilities:r}=t;this.remoteSDP.updateRemoteRTPCapabilities(r),Array.isArray(this.remoteCodecs)&&this.remoteCodecs.length>0&&this.remoteSDP.updateRemoteCodec([],this.remoteCodecs,this.store.codec);const{preSSRCs:s}=t;if(Array.isArray(s)&&s.length>0){const{mids:l}=this.remoteSDP.batchSend(s.map(f=>Object.assign({},{kind:f.kind,ssrcMsg:[{ssrcId:f.ssrcId,rtx:f.rtx}],mslabel:f.mslabel})));l.forEach((f,m)=>{this.preSSRCMap.set(s[m].ssrcId,f)})}await US(this.peerConnection,this.remoteSDP,this.extension),G.debug("[P2PConnection] updateRemoteRTPCapabilities by exchanging SDP.")}catch(r){throw new Ke(se.EXCHANGE_SDP_FAILED,"P2PConnection.updateRemoteConnect failed; ".concat(r.toString()))}}send(t,r,s){var l=this;return $l(function*(){const f=yield xn(l.mutex.lock("From P2PConnection.send"));try{if(!l.remoteSDP)throw new Error("Cannot call P2PConnection.send before remote SDP created");const m=[],E=u1();t.forEach(Y=>{const $=l.peerConnection.addTransceiver(Y._mediaStreamTrack,fc({direction:"sendonly"},Y.trackMediaType==="video"&&l.supportAV1RtpSpec&&E?{sendEncodings:[{scalabilityMode:E}]}:{}));m.push($),Y._updateRtpTransceiver($)}),ei()&&me("SIMULCAST")===!0&&(yield xn(l.applySimulcastForFirefox(m,t)));const y=yield xn(l.peerConnection.createOffer()),b=l.remoteSDP.predictReceivingMids(t.length),A=l.mungSendOfferSDP(y.sdp,t,b),O=on(A),D=b.map(Y=>{const $=O.mediaDescriptions.find(ee=>ee.attributes.mid===Y);if(!$)throw new Error("Cannot extract ssrc from mediaDescription.");return f1($,me("USE_PUB_RTX"))});let P;try{P=yield D}catch(Y){P=[],l.remoteSDP.receive(t,r,s,P);const $=l.remoteSDP.toString();throw yield xn(l.peerConnection.setLocalDescription({type:"offer",sdp:A})),yield xn(l.peerConnection.setRemoteDescription({type:"answer",sdp:$})),yield xn(l.stopSending(b,!0)),Y}l.remoteSDP.receive(t,r,s,P);const F=l.remoteSDP.toString(),B=l.logSDPExchange(A,"offer","local","send");return yield xn(l.peerConnection.setLocalDescription({type:"offer",sdp:A})),yield xn(l.applySimulcastEncodings(m,t)),yield xn(l.applySendEncodings(m,t)),B==null||B(F),yield xn(l.peerConnection.setRemoteDescription({type:"answer",sdp:F})),m.map((Y,$)=>{const ee=b[$];return{localSSRC:D[$],id:ee,transceiver:Y}})}catch(m){throw m instanceof Ke?m:new Ke(se.EXCHANGE_SDP_FAILED,"P2PConnection.send failed; ".concat(m.toString()))}finally{f()}})()}async createDataChannels(t,r){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.createDataChannels before remote SDP created");let s=this.dataStreamChannelMap.get(t);if(s&&s.readyState==="open")G.debug("[P2PConnection] Channels are already available and can be reused directly.");else{const f=this.currentDataChannelId<1023?this.currentDataChannelId++:this.recoveredDataChannelIds.shift();if(typeof f!="number")throw new Error("create DataChannel error, because cannot get dc id");s=this.peerConnection.createDataChannel("datastream-channel",{id:f,negotiated:!0,ordered:!1,maxRetransmits:me("DATASTREAM_MAX_RETRANSMITS")}),s.binaryType="arraybuffer",this.dataStreamChannelMap.set(t,s)}r.forEach(f=>{f._updateOriginDataChannel(s)});const{needExchangeSDP:l}=this.remoteSDP.sendDataChannel();if(l){const f=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:f});const m=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(m),G.debug("[P2PConnection] createDataChannels by exchanging SDP.")}else G.debug("[P2PConnection] createDataChannels no need to exchange SDP.");return}catch(s){throw s instanceof Ke?s:new Ke(se.EXCHANGE_SDP_FAILED,"P2PConnection.createDataChannels failed; ".concat(s.toString()))}}async stopDataChannels(t){try{const r=this.dataStreamChannelMap.get(t);return r&&(r.id&&this.recoveredDataChannelIds.push(r.id),r.close()),void this.dataStreamChannelMap.delete(t)}catch(r){throw r instanceof Ke?r:new Ke(se.DATACHANNEL_FAILED,"P2PConnection.stopDataChannels failed; ".concat(r.toString()))}}async stopSending(t,r){const s=r?void 0:await this.mutex.lock("From P2PConnection.stopSending");try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopSending before remote SDP created");const l=this.peerConnection.getTransceivers().filter(y=>t.indexOf(y.mid)!==-1);if(l.length!==t.length)throw new Error("Transceivers' length doesn't match mids' length when trying to call P2PConnection.stopSending.");l.map(y=>{var b;Yi(this.id+y.mid,this),y.direction="inactive",(b=y.stop)===null||b===void 0||b.call(y)});const f=await this.peerConnection.createOffer(),m=this.logSDPExchange(f.sdp||"","offer","local","stopSending");await this.peerConnection.setLocalDescription(f),this.remoteSDP.stopReceiving(t);const E=this.remoteSDP.toString();m==null||m(E),await this.peerConnection.setRemoteDescription({type:"answer",sdp:E})}catch(l){throw new Ke(se.EXCHANGE_SDP_FAILED,"P2PConnection.stopSending failed; ".concat(l.toString()))}finally{s&&s()}}async receive(t,r,s,l){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(t," before remoteSDP created."));const{mid:f,needExchangeSDP:m}=this.remoteSDP.send(t,r,s,l);m&&(await US(this.peerConnection,this.remoteSDP,this.extension),G.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(t," by exchanging SDP.")));const E=this.peerConnection.getTransceivers().find(y=>y.mid===f);if(!E)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:E.receiver.track,id:f,transceiver:E}}catch(f){throw new Ke(se.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(f.toString()))}}async batchReceive(t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.batchReceive before remoteSDP created.");const{mids:r,needExchangeSDP:s}=this.remoteSDP.batchSend(t);return s&&(await US(this.peerConnection,this.remoteSDP,this.extension),G.debug("[".concat(this.store.clientId,"] [P2PConnection] batchReceive by exchanging SDP."))),r.map(l=>{const f=this.peerConnection.getTransceivers().find(m=>m.mid===l);if(!f)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:f.receiver.track,id:l,transceiver:f}})}catch(r){throw new Ke(se.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(r.toString()))}}async stopReceiving(t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");t.forEach(f=>{Array.from(this.preSSRCMap.entries()).some(m=>{let[E,y]=m;if(y===f)return this.preSSRCMap.delete(E),!0})}),this.remoteSDP.stopSending(t);const r=this.remoteSDP.toString(),s=this.logSDPExchange(r,"offer","remote","stopReceiving");await this.peerConnection.setRemoteDescription({type:"offer",sdp:r});const l=await this.peerConnection.createAnswer();s==null||s(l.sdp||""),await this.peerConnection.setLocalDescription(l)}catch(r){throw new Ke(se.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(r.toString()))}}async muteRemote(t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteRemote mid=".concat(t," before remote SDP created."));this.remoteSDP.mute(t);const r=this.remoteSDP.toString(),s=this.logSDPExchange(r,"offer","remote","muteRemote");await this.peerConnection.setRemoteDescription({type:"offer",sdp:r});const l=await this.peerConnection.createAnswer();s==null||s(l.sdp||""),await this.peerConnection.setLocalDescription(l)}catch(r){throw new Ke(se.EXCHANGE_SDP_FAILED,"P2PConnection.muteRemote failed; ".concat(r.toString()))}}async unmuteRemote(t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteRemote mid=".concat(t," before remote SDP created."));this.remoteSDP.unmute(t);const r=this.remoteSDP.toString(),s=this.logSDPExchange(r,"offer","remote","unmuteRemote");await this.peerConnection.setRemoteDescription({type:"offer",sdp:r});const l=await this.peerConnection.createAnswer();s==null||s(l.sdp||""),await this.peerConnection.setLocalDescription(l)}catch(r){throw new Ke(se.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteRemote failed; ".concat(r.toString()))}}async muteLocal(t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteLocal before remote SDP created.");const r=this.peerConnection.getTransceivers().filter(m=>m.mid&&t.indexOf(m.mid)!==-1);if(r.length!==t.length)throw new Error("Transceivers' length doesn't match mids' length.");r.map(m=>{m.direction="inactive"});const s=await this.peerConnection.createOffer(),l=this.logSDPExchange(s.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(s),this.remoteSDP.muteRemote(t);const f=this.remoteSDP.toString();l==null||l(f),await this.peerConnection.setRemoteDescription({type:"answer",sdp:f})}catch(r){throw new Ke(se.EXCHANGE_SDP_FAILED,"P2PConnection.muteLocal failed; ".concat(r.toString()))}}async unmuteLocal(t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteLocal before remote SDP created.");const r=this.peerConnection.getTransceivers().filter(m=>m.mid&&t.indexOf(m.mid)!==-1);if(r.length!==t.length)throw new Error("Transceivers' length doesn't match mids' length.");r.map(async(m,E)=>{m.direction="sendonly"});const s=await this.peerConnection.createOffer(),l=this.logSDPExchange(s.sdp||"","offer","local","unmuteLocal");await this.peerConnection.setLocalDescription(s),this.remoteSDP.unmuteRemote(t),Array.isArray(this.remoteCodecs)&&this.remoteCodecs.length>0&&this.remoteSDP.updateRemoteCodec(t,this.remoteCodecs,this.store.codec);const f=this.remoteSDP.toString();l==null||l(f),await this.peerConnection.setRemoteDescription({type:"answer",sdp:f})}catch(r){throw new Ke(se.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteLocal failed; ".concat(r.toString()))}}restartICE(t){var r=this;return $l(function*(){const s=yield xn(r.mutex.lock("From P2PConnection.restartICE"));try{if(!r.remoteSDP)throw new Error("Cannot restartICE before remoteSDP created.");const l=zn().supportPCSetConfiguration,f=me("FORCE_TURN_TCP")||r.forceTurn;if(t===Ua.RELAY&&!l)return;if(l&&!f){const O=t===Ua.RELAY?"relay":"all",D=r.peerConnection.getConfiguration();D.iceTransportPolicy!==O&&(G.debug("[".concat(r.store.clientId,"] restartICE change iceTransportPolicy from [").concat(D.iceTransportPolicy,"] to [").concat(O,"]")),D.iceTransportPolicy=O,r.peerConnection.setConfiguration(D))}r.remoteSDP.updateCandidates(t);const m=yield xn(r.peerConnection.createOffer({iceRestart:!0}));if(!m.sdp)throw new Error("Cannot restartICE because restart offer SDP does not exist.");const E=ou(m.sdp),{remoteIceParameters:y}=yield E.iceParameters;r.remoteSDP.restartICE(y);const b=r.remoteSDP.toString(),A=r.logSDPExchange(m.sdp||"","offer","local","restartICE");r.store.descriptionStart(),yield xn(r.peerConnection.setLocalDescription(m)),A==null||A(b),yield xn(r.peerConnection.setRemoteDescription({type:"answer",sdp:b}))}catch(l){G.warning("[".concat(r.store.clientId,"] restart ICE failed, abort operation"),l)}finally{s()}})()}async extendCandidate(){if(!this.remoteSDP||this.isFirstConnected)return;const t=await this.mutex.lock("From P2PConnection.extendCandidate");try{this.remoteSDP.updateCandidates(Ua.TCP_RELAY),await US(this.peerConnection,this.remoteSDP,this.extension)}catch(r){G.warning("[".concat(this.store.clientId,"] extend candidate failed, abort operation"),r)}finally{t()}}close(){var t;this.peerConnection.getTransceivers().forEach(r=>{Yi(this.id+r.mid,this)}),this.preSSRCMap.clear(),this.peerConnection.close(),(t=this.onConnectionStateChange)===null||t===void 0||t.call(this,"closed"),this.tryUnbindTransportEvents(),this.unbindPCEvents(),this.unbindStatsEvents(),this.removeAllListeners(),this.transportEventReceiver=void 0,this.statsFilter.destroy(),this.dataStreamChannelMap.clear(),this.recoveredDataChannelIds=[],this.currentDataChannelId=1}getStats(){return fc(fc({},this.statsFilter.getStats()),{},{qualityLimitationReason:this.qualityLimitationReason})}getRemoteVideoIsReady(t){return this.statsFilter.getVideoIsReady(t)}async updateEncoderConfig(t,r){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateEncoderConfig before remote SDP created.");const s=await this.peerConnection.createOffer(),l=this.mungSendOfferSDP(s.sdp,[r],[t]);this.remoteSDP.updateRecvMedia(t,r);const f=this.remoteSDP.toString(),m=this.logSDPExchange(l,"offer","local","updateEncoderConfig");await this.peerConnection.setLocalDescription({type:"offer",sdp:l}),m==null||m(f),await this.peerConnection.setRemoteDescription({type:"answer",sdp:f})}catch(s){throw new Ke(se.EXCHANGE_SDP_FAILED,s.toString())}}async updateSendParameters(t,r){const s=this.peerConnection.getTransceivers().filter(l=>l.mid===t);s.length===1&&(this.isVP8Simulcast(r)?ei()||await this.applySimulcastEncodings(s,[r]):await this.applySendEncodings(s,[r]))}setStatsRemoteVideoIsReady(t,r){this.statsFilter.setVideoIsReady2(t,r)}async replaceTrack(t,r){const s=this.peerConnection.getTransceivers().find(l=>l.mid===r);s&&await s.sender.replaceTrack(t._mediaStreamTrack)}async getSelectedCandidatePair(){const t=this.peerConnection.getReceivers();if(t.length>0&&t[0].transport&&t[0].transport.iceTransport&&t[0].transport.iceTransport.getSelectedCandidatePair&&t[0].transport.iceTransport.getSelectedCandidatePair()){const r=t[0].transport.iceTransport,{local:s,remote:l}=r.getSelectedCandidatePair();return{local:fc(fc({},vl),{},{candidateType:s.type,protocol:s.protocol,address:s.address,port:s.port}),remote:fc(fc({},vl),{},{candidateType:l.type,protocol:l.protocol,address:l.address,port:l.port})}}return this.statsFilter.getSelectedCandidatePair()}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var t;(t=this.onICEConnectionStateChange)===null||t===void 0||t.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var t;this.peerConnection.connectionState==="connected"&&(this.isFirstConnected=!0),(t=this.onConnectionStateChange)===null||t===void 0||t.call(this,this.peerConnection.connectionState)},this.peerConnection.onicecandidateerror=t=>{if(t&&(t.errorCode||t.errorText)){var r;const s="code: ".concat(t.errorCode,", message: ").concat(t.errorText),l=t.port?"local: ".concat(t.port):"";G.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICECandidateError(").concat(s,"), url: ").concat(t.url||"",", host_candidate:").concat(l)),(r=this.onICECandidateError)===null||r===void 0||r.call(this,s)}},this.peerConnection.onicegatheringstatechange=t=>{t&&t.target&&"iceGatheringState"in t.target&&G.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] RTCPeerConnection.onicegatheringstatechange(").concat(t.target.iceGatheringState,")"))},this.peerConnection.onicecandidate=t=>{t.candidate?this.localCandidateCount+=1:(this.peerConnection.onicecandidate=null,this.allCandidatesReceived=!0,G.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount))},setTimeout(()=>{this.allCandidatesReceived||(this.allCandidatesReceived=!0,G.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] onicecandidate timeout, local candidate count"),this.localCandidateCount))},me("CANDIDATE_TIMEOUT"))}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(t){const r={iceServers:[]};return t.iceServers?r.iceServers=t.iceServers:t.turnServer&&(ki(t.turnServer.servers)?r.iceServers=t.turnServer.servers:me("NEW_TURN_MODE")&&r.iceServers?(me("USE_TURN_SERVER_OF_GATEWAY")?t.turnServer.serversFromGateway&&r.iceServers.push(...wA.newTurnServerConfigToIceServers(t.turnServer.serversFromGateway)):r.iceServers.push(...wA.newTurnServerConfigToIceServers(t.turnServer.servers)),me("NEW_FORCE_TURN")&&(r.iceTransportPolicy="relay")):t.turnServer.mode!=="off"&&(r.iceServers&&r.iceServers.push(...wA.turnServerConfigToIceServers(t.turnServer.servers)),me("USE_TURN_SERVER_OF_GATEWAY")&&r.iceServers&&t.turnServer.serversFromGateway&&r.iceServers.push(...wA.turnServerConfigToIceServers(t.turnServer.serversFromGateway)),me("FORCE_TURN_TCP")?r.iceTransportPolicy="relay":t.turnServer.servers.concat(t.turnServer.serversFromGateway||[]).forEach(s=>{s.forceturn&&(r.iceTransportPolicy="relay")}))),me("ENABLE_ENCODED_TRANSFORM")&&zn().supportWebRTCEncodedTransform&&(r.encodedInsertableStreams=!0),r}static turnServerConfigToIceServers(t){const r=[];return t.forEach(s=>{s.security?s.tcpport&&r.push({username:s.username,credential:s.password,credentialType:"password",urls:"turns:".concat(jg(s.turnServerURL),":").concat(s.tcpport,"?transport=tcp")}):(s.udpport&&!me("FORCE_TURN_TCP")&&r.push({username:s.username,credential:s.password,credentialType:"password",urls:"turn:".concat(s.turnServerURL,":").concat(s.udpport,"?transport=udp")}),s.tcpport&&r.push({username:s.username,credential:s.password,credentialType:"password",urls:"turn:".concat(s.turnServerURL,":").concat(s.tcpport,"?transport=tcp")}))}),r}static newTurnServerConfigToIceServers(t){const r=[];return t.forEach(s=>{const l=me("NEW_TURN_MODE");l===1?r.push({username:s.username,credential:s.password,credentialType:"password",urls:"turn:".concat(s.turnServerURL,":3478?transport=udp")}):l===2?r.push({username:s.username,credential:s.password,credentialType:"password",urls:"turn:".concat(s.turnServerURL,":3478?transport=tcp")}):l===3?r.push({username:s.username,credential:s.password,credentialType:"password",urls:"turns:".concat(jg(s.turnServerURL),":443?transport=tcp")}):l===4&&(r.push({username:s.username,credential:s.password,credentialType:"password",urls:"turn:".concat(s.turnServerURL,":3478?transport=udp")}),r.push({username:s.username,credential:s.password,credentialType:"password",urls:"turn:".concat(s.turnServerURL,":3478?transport=tcp")}),r.push({username:s.username,credential:s.password,credentialType:"password",urls:"turns:".concat(jg(s.turnServerURL),":443?transport=tcp")}))}),r}tryBindTransportEvents(t){const r=t.transport;if(r){this.transportEventReceiver=t,r.onstatechange=()=>{var l;r!=null&&r.state&&((l=this.onDTLSTransportStateChange)===null||l===void 0||l.call(this,r.state))},r.onerror=l=>{var f;(f=this.onDTLSTransportError)===null||f===void 0||f.call(this,"error"in l?l.error:l)};const s=r.iceTransport;s&&(s.onstatechange=()=>{const l=r==null?void 0:r.iceTransport.state;var f;l&&((f=this.onICETransportStateChange)===null||f===void 0||f.call(this,l))},s.getSelectedCandidatePair&&(s.onselectedcandidatepairchange=()=>{if(s.getSelectedCandidatePair()){const{local:l,remote:f}=s.getSelectedCandidatePair();G.info("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] selectedcandidatepairchange: local ").concat(JSON.stringify({candidateType:l.type,protocol:l.protocol}),", remote ").concat(JSON.stringify({candidateType:f.type,protocol:f.protocol,address:f.address,port:f.port})," )"))}}))}}tryUnbindTransportEvents(){this.transportEventReceiver&&this.transportEventReceiver.transport&&(this.transportEventReceiver.transport.onstatechange=null,this.transportEventReceiver.transport.onerror=null,this.transportEventReceiver.transport.iceTransport&&(this.transportEventReceiver.transport.iceTransport.onstatechange=null))}async updateRtpSenderEncodings(t,r){var s,l;if(r||(r=this.peerConnection.getSenders().find(Y=>Y.track===t._mediaStreamTrack)),!r)return G.warn("[".concat(t.getTrackId(),"] no rtpSender found}"));if(this.isVP8Simulcast(t))return G.warn("[updateRtpSenderEncodings] Track is VP8 simulcast, please apply simulcast encodings");if(!zn().supportSetRtpSenderParameters)return G.warn("[updateRtpSenderEncodings] Browser not support set rtp-sender parameters");const f={},m={};switch(t._optimizationMode){case"motion":f.degradationPreference="maintain-framerate";break;case"detail":f.degradationPreference="maintain-resolution";break;case"balanced":f.degradationPreference="balanced"}const E=function(B,Y){return B.getTransceivers().find($=>$.sender.track===Y||$.receiver.track===Y)}(this.peerConnection,t._mediaStreamTrack),y=b8(t);if(HU(t)&&E&&r&&y&&this.getLocalVideoStats&&ht(s=["vp8","vp9"]).call(s,this.store.codec)){var b;const B=f.degradationPreference||(ht(b=t._hints).call(b,xr.CUSTOM_TRACK)?me("CUSTOM_ADAPTATION_DEFAULT_MODE"):"maintain-framerate");(function(Y,$,ee,Ee,Re,Ie){if(Yi(Y,ee),Re($),Ee!=="balanced"&&Ee!=="maintain-framerate"&&Ee!=="maintain-resolution")return;let we=-1;Wn(Y,$);const Ue=window.setInterval(()=>{const Ne=BS.get(Y);if(!me("ENABLE_AG_ADAPTATION")||!Ne)return Yi(Y,ee),void Re($);const Ve=Ie();if(Ve.sendPackets>0&&Ve.OutgoingAvailableBandwidth>0){if(we===-1)return void(we=Date.now());if(Date.now()-we<1e3)return;const Be=Ve.sendFrameRate,W=Ve.OutgoingAvailableBandwidth,[ce,Se]=Ih(Y,Be,W,Ne.adaptationConfig,$,Ee);Se&&(ee.qualityLimitationReason=Se),ce&&Ne.adaptationConfig.scale!==ce.scale&&(G.debug("[".concat(Y,"] applyAdaptation: ").concat(ee.qualityLimitationReason,`
           sendFps `).concat(Be,", bwe ").concat(W,", switch from ").concat(Ne.adaptationConfig.scale," to ").concat(ce.scale," ")),Ne.adaptationConfig=wo(wo({},Ne.adaptationConfig),ce),Re(ce))}},me("CHECK_LOCAL_STATS_INTERVAL")),ve=wo({},$);BS.set(Y,{timer:Ue,adaptationConfig:ve,originConfig:$,adaptationFunc:Re}),G.debug("[".concat(Y,"] start adaptation, originConfig: ").concat(JSON.stringify($),", degradationPreference: ").concat(Ee))})(this.id+E.mid,y,this,B,Y=>{r&&this.updateAdaptation(r,Y)},this.getLocalVideoStats.bind(this))}if(t._encoderConfig){var A;const{bitrateMax:B,frameRate:Y,scaleResolutionDownBy:$}=t._encoderConfig;B&&(m.maxBitrate=1e3*B),(ht(A=t._hints).call(A,xr.LOW_STREAM)||t.isUseScaleResolutionDownBy)&&(Y&&(m.maxFramerate=Co(Y)),$&&$>=1&&(m.scaleResolutionDownBy=$))}const{maxFramerate:O}=me("ENCODER_CONFIG_LIMIT");if(O&&typeof O=="number"&&(m.maxFramerate=m.maxFramerate?Math.min(m.maxFramerate,O):O),me("DSCP_TYPE")&&fh()){var D;const B=me("DSCP_TYPE");ht(D=["very-low","low","medium","high"]).call(D,B)&&(m.networkPriority=B)}const P=r.getParameters(),F=(l=P.encodings)===null||l===void 0?void 0:l[0];ei()&&!F&&(f.encodings=[m]),F&&Object.assign(F,m),Object.assign(P,f),G.debug("[".concat(t.getTrackId(),"] updateRtpSenderEncodings: ").concat(JSON.stringify(P.encodings))),await r.setParameters(P),await async function(B,Y,$){try{var ee;if(!zn().supportSetRtpSenderParameters||!function(Ue){return Ue==="vp9"||Ue==="av1"}(B)||!me("ENABLE_SVC"))return;const Ee={},Re={},Ie=Y.getParameters(),we=(ee=Ie.encodings)===null||ee===void 0?void 0:ee[0];Re.scalabilityMode=u1($),we&&Object.assign(we,Re),Object.assign(Ie,Ee),await Y.setParameters(Ie),G.debug("[updateAdaptation] updateRtpSenderEncodings scalabilityMode success: ".concat(JSON.stringify(Ie.encodings)))}catch(Ee){G.debug("[updateAdaptation] updateRtpSenderEncodings scalabilityMode failed",Ee)}}(this.store.codec,r,me("SVC_MODE"))}async updateAdaptation(t,r){var s,l;if(!t)return G.debug("[updateAdaptation] no rtpSender found");if(!zn().supportSetRtpSenderParameters)return G.debug("[updateAdaptation] Browser not support set rtp-sender parameters");const f={},{bitrateMax:m,frameRate:E,scaleResolutionDownBy:y}=r;m&&(f.maxBitrate=1e3*m),E&&(f.maxFramerate=Co(E)),y&&y>=1&&ht(s=["vp8","vp9"]).call(s,this.store.codec)&&(f.scaleResolutionDownBy=y);const b=t.getParameters(),A=(l=b.encodings)===null||l===void 0?void 0:l[0];A&&Object.assign(A,f),Object.assign(b,{});try{await t.setParameters(b),G.debug("[updateAdaptation] updateRtpSenderEncodings: ".concat(JSON.stringify(b.encodings)))}catch(O){!("transport"in t)||t.transport&&t.transport.state==="connected"?this.peerConnectionState!=="connected"?G.debug("[updateAdaptation] peerConnection not connected}"):G.debug("[updateAdaptation] updateRtpSenderEncodings failed",O):G.debug("[updateAdaptation] rtpSender transport not connected}")}}async applySendEncodings(t,r){try{if(!zn().supportSetRtpSenderParameters||t.length!==r.length)return;for(let s=0;s<t.length;s++){const l=t[s],f=r[s];f instanceof Kr&&!this.isVP8Simulcast(f)&&await this.updateRtpSenderEncodings(f,l.sender)}}catch{G.debug("[".concat(this.store.clientId,"] Apply RTPSendEncodings failed."))}}mungSendOfferSDP(t,r,s){const l=on(t);return r.forEach((f,m)=>{const E=s[m],y=l.mediaDescriptions.find(b=>b.attributes.mid===E);y&&(xS(y,f),Y8(y,f,this.store.codec))}),zr(l)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=t=>{var r;(r=this.onFirstAudioReceived)===null||r===void 0||r.call(this,t)},this.statsFilter.onFirstVideoReceived=t=>{var r;(r=this.onFirstVideoReceived)===null||r===void 0||r.call(this,t)},this.statsFilter.onFirstAudioDecoded=t=>{var r;(r=this.onFirstAudioDecoded)===null||r===void 0||r.call(this,t)},this.statsFilter.onFirstVideoDecoded=(t,r,s)=>{var l;(l=this.onFirstVideoDecoded)===null||l===void 0||l.call(this,t,r,s)},this.statsFilter.onSelectedLocalCandidateChanged=(t,r)=>{var s;(s=this.onSelectedLocalCandidateChanged)===null||s===void 0||s.call(this,t,r)},this.statsFilter.onSelectedRemoteCandidateChanged=(t,r)=>{var s;(s=this.onSelectedRemoteCandidateChanged)===null||s===void 0||s.call(this,t,r)},this.statsFilter.onFirstVideoDecodedTimeout=t=>{var r;(r=this.onFirstVideoDecodedTimeout)===null||r===void 0||r.call(this,t)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0,this.statsFilter.onFirstVideoDecodedTimeout=void 0}async applySimulcastForFirefox(t,r){if(t.length===r.length)for(let y=0;y<t.length;y++){var s,l,f,m,E;const b=t[y],A=r[y];if(A instanceof Kr&&!ht(s=A._hints).call(s,xr.LOW_STREAM)&&(l=A._encoderConfig)!==null&&l!==void 0&&l.bitrateMax&&((f=A._encoderConfig)===null||f===void 0?void 0:f.bitrateMax)>200&&(m=A._scalabilityMode)!==null&&m!==void 0&&m.numSpatialLayers&&((E=A._scalabilityMode)===null||E===void 0?void 0:E.numSpatialLayers)>1&&this.store.codec==="vp8"){const O={},D={high:1e3*(A._encoderConfig.bitrateMax-50),medium:5e4};O.encodings=[{rid:"m",active:!0,maxBitrate:D.medium,scaleResolutionDownBy:4},{rid:"h",active:!0,maxBitrate:D.high}];const P=b.sender.getParameters();await b.sender.setParameters(Object.assign(P,O))}}}async applySimulcastEncodings(t,r){if(!ei()&&t.length===r.length)for(let s=0;s<t.length;s++){const l=r[s];if(l instanceof Kr&&this.isVP8Simulcast(l)){const f=t[s],m={},E={high:1e3*(l._encoderConfig.bitrateMax-50),medium:5e4};m.encodings=[{active:!0,adaptivePtime:!1,networkPriority:"high",priority:"high",maxBitrate:E.high},{active:!0,adaptivePtime:!1,networkPriority:"low",priority:"low",maxBitrate:E.medium,scaleResolutionDownBy:4}];const y=f.sender.getParameters();await f.sender.setParameters(Object.assign(y,m))}}}isVP8Simulcast(t){var r,s,l,f,m;return!!(t instanceof Kr&&me("SIMULCAST")&&this.store.codec==="vp8"&&!ht(r=t._hints).call(r,xr.LOW_STREAM)&&(s=t._encoderConfig)!==null&&s!==void 0&&s.bitrateMax&&((l=t._encoderConfig)===null||l===void 0?void 0:l.bitrateMax)>200&&(f=t._scalabilityMode)!==null&&f!==void 0&&f.numSpatialLayers&&((m=t._scalabilityMode)===null||m===void 0?void 0:m.numSpatialLayers)>1)}logSDPExchange(t,r,s,l){if(me("SDP_LOGGING"))return G.upload("[".concat(this.store.clientId,"] exchanging ").concat(s," ").concat(r," SDP during P2PConnection.").concat(l,`
`),t),r==="offer"?f=>{this.logSDPExchange(f,"answer",s==="local"?"remote":"local",l)}:void 0}async getRemoteSSRC(t){if(!this.remoteSDP)return;const r=this.remoteSDP.getSSRC(t);return r&&r.length!==0?r[0].ssrcId:void 0}setConfiguration(t){if(zn().supportPCSetConfiguration){const r=wA.resolvePCConfiguration(t);this.peerConnection.setConfiguration(r)}}},Ot(gn.prototype,"updateRemoteRTPCapabilities",[so],Object.getOwnPropertyDescriptor(gn.prototype,"updateRemoteRTPCapabilities"),gn.prototype),Ot(gn.prototype,"connect",[so],Object.getOwnPropertyDescriptor(gn.prototype,"connect"),gn.prototype),Ot(gn.prototype,"updateRemoteConnect",[so],Object.getOwnPropertyDescriptor(gn.prototype,"updateRemoteConnect"),gn.prototype),Ot(gn.prototype,"createDataChannels",[so],Object.getOwnPropertyDescriptor(gn.prototype,"createDataChannels"),gn.prototype),Ot(gn.prototype,"receive",[so],Object.getOwnPropertyDescriptor(gn.prototype,"receive"),gn.prototype),Ot(gn.prototype,"batchReceive",[so],Object.getOwnPropertyDescriptor(gn.prototype,"batchReceive"),gn.prototype),Ot(gn.prototype,"stopReceiving",[so],Object.getOwnPropertyDescriptor(gn.prototype,"stopReceiving"),gn.prototype),Ot(gn.prototype,"muteRemote",[so],Object.getOwnPropertyDescriptor(gn.prototype,"muteRemote"),gn.prototype),Ot(gn.prototype,"unmuteRemote",[so],Object.getOwnPropertyDescriptor(gn.prototype,"unmuteRemote"),gn.prototype),Ot(gn.prototype,"muteLocal",[so],Object.getOwnPropertyDescriptor(gn.prototype,"muteLocal"),gn.prototype),Ot(gn.prototype,"unmuteLocal",[so],Object.getOwnPropertyDescriptor(gn.prototype,"unmuteLocal"),gn.prototype),Ot(gn.prototype,"close",[so],Object.getOwnPropertyDescriptor(gn.prototype,"close"),gn.prototype),Ot(gn.prototype,"updateEncoderConfig",[so],Object.getOwnPropertyDescriptor(gn.prototype,"updateEncoderConfig"),gn.prototype),Ot(gn.prototype,"updateSendParameters",[so],Object.getOwnPropertyDescriptor(gn.prototype,"updateSendParameters"),gn.prototype),Ot(gn.prototype,"replaceTrack",[so],Object.getOwnPropertyDescriptor(gn.prototype,"replaceTrack"),gn.prototype),Ot(gn.prototype,"updateAdaptation",[so],Object.getOwnPropertyDescriptor(gn.prototype,"updateAdaptation"),gn.prototype),Ot(gn.prototype,"getRemoteSSRC",[so],Object.getOwnPropertyDescriptor(gn.prototype,"getRemoteSSRC"),gn.prototype),gn);function so(e,t,r){const s=e[t];if(typeof s!="function")throw new Error("Cannot use mutex on object property.");return r.value=async function(){const l=this.mutex,f=await l.lock("From P2PConnection.".concat(t));try{for(var m=arguments.length,E=new Array(m),y=0;y<m;y++)E[y]=arguments[y];return await s.apply(this,E)}finally{f()}},r}function YU(e,t){let r=document.createElement("video"),s=document.createElement("canvas");r.setAttribute("style","display:none"),s.setAttribute("style","display:none"),r.setAttribute("muted",""),r.muted=!0,r.setAttribute("autoplay",""),r.autoplay=!0,r.setAttribute("playsinline",""),s.width=Co(t.width),s.height=Co(t.height);const l=Co(t.framerate||15);document.body.append(r),document.body.append(s);let f=e._mediaStreamTrack;r.srcObject=new MediaStream([f]),r.play();const m=s.getContext("2d");if(!m)throw new xe(se.UNEXPECTED_ERROR,"can not get canvas context");const E=zn(),y=s.captureStream(E.supportRequestFrame?0:l).getVideoTracks()[0];y.canvas||(y.canvas=s),s.startCapture=()=>{if(!r)return s.stopCapture&&s.stopCapture();if(r.paused&&r.play(),r.videoHeight>2&&r.videoWidth>2){const A=r.videoWidth,O=r.videoHeight/A,D=s.width*O;Math.abs(D-s.height)>=2&&(G.debug("adjust low stream resolution","".concat(s.width,"x").concat(s.height," -> ").concat(s.width,"x").concat(D)),s.height=D)}m.drawImage(r,0,0,s.width,s.height),y.requestFrame&&y.requestFrame(),f!==e._mediaStreamTrack&&(f=e._mediaStreamTrack,r.srcObject=new MediaStream([f]))},s.stopCapture=e1(()=>s.startCapture&&s.startCapture(),l);const b=y.stop;return y.stop=()=>{b.call(y),r&&(r.remove(),r.srcObject=null,r=null),s&&(s.width=0,s.remove(),s.stopCapture&&s.stopCapture(),s.startCapture=void 0,s.stopCapture=void 0,s=null),G.debug("clean low stream renderer")},y}var Kt=function(e){return e[e.Video_Send_Qp_Sum=2143]="Video_Send_Qp_Sum",e[e.Video_Send_Freeze=2082]="Video_Send_Freeze",e[e.Video_Recv_Qp_Sum=2144]="Video_Recv_Qp_Sum",e[e.Video_Recv_Freeze=2084]="Video_Recv_Freeze",e[e.Video_Render_Freeze_Time=2109]="Video_Render_Freeze_Time",e[e.Video_Render_Freeze_Time_Render=2147]="Video_Render_Freeze_Time_Render",e[e.Video_Render_Freeze_Time_Render2=2223]="Video_Render_Freeze_Time_Render2",e[e.Audio_Recv_Freeze=2083]="Audio_Recv_Freeze",e[e.Video_Send_Type=2225]="Video_Send_Type",e}(Kt||{}),pn=function(e){return e[e.Video_Send_Retransmit=2062]="Video_Send_Retransmit",e[e.Video_Send_Target_Encoded=2064]="Video_Send_Target_Encoded",e[e.Video_Send_Actual_Encoded=2060]="Video_Send_Actual_Encoded",e[e.Video_Send_Transmit=2066]="Video_Send_Transmit",e[e.Video_Send_Bandwidth=2061]="Video_Send_Bandwidth",e[e.Video_Capture_Height=2033]="Video_Capture_Height",e[e.Video_Capture_Width=2035]="Video_Capture_Width",e[e.Video_Capture_Frame_Rate=2034]="Video_Capture_Frame_Rate",e[e.Video_Send_Low_Height=2073]="Video_Send_Low_Height",e[e.Video_Send_Low_Frame_Rate=2075]="Video_Send_Low_Frame_Rate",e[e.Video_Send_Low_Width=2077]="Video_Send_Low_Width",e[e.Video_Send_Low_Bitrate=2069]="Video_Send_Low_Bitrate",e[e.Video_Send_Low_Package_Lost=2070]="Video_Send_Low_Package_Lost",e[e.Video_Send_Low_Package_Rate=2071]="Video_Send_Low_Package_Rate",e[e.Video_Send_Frame_Rate=2002]="Video_Send_Frame_Rate",e[e.Video_Send_Width=2003]="Video_Send_Width",e[e.Video_Send_Height=2004]="Video_Send_Height",e[e.Video_Send_Disabled=2095]="Video_Send_Disabled",e[e.Video_Send_Adaptation=2032]="Video_Send_Adaptation",e[e.Video_Send_Player_Status=2128]="Video_Send_Player_Status",e[e.Video_Send_Nacks=2009]="Video_Send_Nacks",e[e.Video_Send_Plis=2010]="Video_Send_Plis",e[e.Video_Send_Firs=2011]="Video_Send_Firs",e[e.Video_Send_Avg_Encode=2007]="Video_Send_Avg_Encode",e[e.Video_Send_Huge_Frame_Sent=2174]="Video_Send_Huge_Frame_Sent",e[e.Video_Send_Bytes_Retransmit=2173]="Video_Send_Bytes_Retransmit",e[e.Video_Send_Packages_Retransmit=2172]="Video_Send_Packages_Retransmit",e[e.Video_Send_Key_Frames_Encoded=2207]="Video_Send_Key_Frames_Encoded",e[e.Video_Send_Bitrate=2012]="Video_Send_Bitrate",e[e.Video_Send_Package_Rate=2031]="Video_Send_Package_Rate",e[e.Video_Send_Package_Lost=2005]="Video_Send_Package_Lost",e[e.Audio_Capture_PCM_Level=2104]="Audio_Capture_PCM_Level",e[e.Audio_Send_Level=2038]="Audio_Send_Level",e[e.Audio_Send_Bitrate=2039]="Audio_Send_Bitrate",e[e.Audio_Send_Package_Rate=2040]="Audio_Send_Package_Rate",e[e.Audio_Send_AEC_Return_Loss=2041]="Audio_Send_AEC_Return_Loss",e[e.Audio_Send_AEC_Return_Loss_Enhancement=2042]="Audio_Send_AEC_Return_Loss_Enhancement",e[e.Audio_Send_Freeze=2081]="Audio_Send_Freeze",e[e.Audio_Send_Disabled=2096]="Audio_Send_Disabled",e[e.Audio_Send_Bytes_Retransmit=2179]="Audio_Send_Bytes_Retransmit",e[e.Audio_Send_Packages_Retransmit=2180]="Audio_Send_Packages_Retransmit",e[e.Video_Recv_Height=2019]="Video_Recv_Height",e[e.Video_Recv_Width=2018]="Video_Recv_Width",e[e.Video_Recv_Frame_Rate_Output=2155]="Video_Recv_Frame_Rate_Output",e[e.Video_Recv_Jitter_Buffer=2023]="Video_Recv_Jitter_Buffer",e[e.Video_Recv_Current_Delay=2024]="Video_Recv_Current_Delay",e[e.Video_Recv_Nacks=2026]="Video_Recv_Nacks",e[e.Video_Recv_Plis=2027]="Video_Recv_Plis",e[e.Video_Recv_Firs=2028]="Video_Recv_Firs",e[e.Video_Recv_Disabled=2101]="Video_Recv_Disabled",e[e.Video_Recv_Player_Status=2129]="Video_Recv_Player_Status",e[e.Video_Recv_I_Frame_Delay=2149]="Video_Recv_I_Frame_Delay",e[e.Video_Render_Frame_Rate_Render=2022]="Video_Render_Frame_Rate_Render",e[e.Video_Render_Freeze_Duration=2156]="Video_Render_Freeze_Duration",e[e.Audio_Render_Level=2043]="Audio_Render_Level",e[e.Audio_Render_Freeze_Time_80ms=2226]="Audio_Render_Freeze_Time_80ms",e[e.Audio_Render_Freeze_Time_200ms=2227]="Audio_Render_Freeze_Time_200ms",e[e.Audio_Render_Freeze_Samples_80ms=2228]="Audio_Render_Freeze_Samples_80ms",e[e.Audio_Render_Freeze_Samples_200ms=2229]="Audio_Render_Freeze_Samples_200ms",e[e.Audio_Recv_PCM_Level=2105]="Audio_Recv_PCM_Level",e[e.Audio_Recv_Disabled=2102]="Audio_Recv_Disabled",e[e.Audio_Recv_Jitter_Buffer=2054]="Audio_Recv_Jitter_Buffer",e[e.Audio_Recv_Current_Delay=2047]="Audio_Recv_Current_Delay",e[e.Audio_Recv_Player_Status=2130]="Audio_Recv_Player_Status",e[e.Audio_Recv_Bitrate=2044]="Audio_Recv_Bitrate",e[e.Audio_Recv_Concealed_Samples=2148]="Audio_Recv_Concealed_Samples",e[e.Audio_Recv_Total_Samples_Received=2224]="Audio_Recv_Total_Samples_Received",e}(pn||{}),as=function(e){return e[e.Video_Render_Frame_Rate_Decode=2021]="Video_Render_Frame_Rate_Decode",e[e.Video_Recv_Frame_Rate=2020]="Video_Recv_Frame_Rate",e[e.Video_Recv_Frame_Dropped=2181]="Video_Recv_Frame_Dropped",e[e.Video_Recv_Bytes_Retransmit=2175]="Video_Recv_Bytes_Retransmit",e[e.Video_Recv_Packages_Retransmit=2176]="Video_Recv_Packages_Retransmit",e[e.Video_Recv_Packages_Discarded=2198]="Video_Recv_Packages_Discarded",e[e.Video_Recv_Avg_Decode=2200]="Video_Recv_Avg_Decode",e[e.Video_Recv_Avg_Processing_Delay=2202]="Video_Recv_Avg_Processing_Delay",e[e.Video_Recv_Avg_Assembly_Time=2203]="Video_Recv_Avg_Assembly_Time",e[e.Video_Recv_Avg_Inter_Frame_Delay=2204]="Video_Recv_Avg_Inter_Frame_Delay",e[e.Video_Recv_Key_Frames_Decoded=2206]="Video_Recv_Key_Frames_Decoded",e[e.Video_Recv_Package_Lost=2014]="Video_Recv_Package_Lost",e[e.Video_Recv_Bitrate=2029]="Video_Recv_Bitrate",e[e.Video_Recv_Package_Rate=2078]="Video_Recv_Package_Rate",e[e.Audio_Recv_Jitter=2055]="Audio_Recv_Jitter",e[e.Audio_Recv_Bytes_Retransmit=2178]="Audio_Recv_Bytes_Retransmit",e[e.Audio_Recv_Packages_Retransmit=2177]="Audio_Recv_Packages_Retransmit",e[e.Audio_Recv_Packages_Discarded=2199]="Audio_Recv_Packages_Discarded",e[e.Audio_Recv_Avg_Processing_Delay=2201]="Audio_Recv_Avg_Processing_Delay",e[e.Audio_Recv_Package_Rate=2046]="Audio_Recv_Package_Rate",e[e.Audio_Recv_Package_Lost=2045]="Audio_Recv_Package_Lost",e}(as||{}),Yo=function(e){return e[e.RTT=2006]="RTT",e[e.CONN_TYPE=801]="CONN_TYPE",e[e.STATS_UPDATE_INTERVAL=2205]="STATS_UPDATE_INTERVAL",e}(Yo||{}),ED=function(e){return e[e.RTC_PEER_CONNECTION_STATE=2219]="RTC_PEER_CONNECTION_STATE",e}(ED||{});const Xp=1e3,Jg=6,df=3,KU=Math.max(Jg,df);function Qt(e,t,r){r!=null&&Number.isFinite(r)&&(e[t]=Math.round(Math.max(0,r)))}function qU(e){const t={[Yo.CONN_TYPE]:0,[Yo.RTT]:e.rtt,[Yo.STATS_UPDATE_INTERVAL]:e.updateInterval?Math.round(Math.max(0,e.updateInterval)):void 0};switch(e.selectedCandidatePair.localCandidate.candidateType){case"relay":{const r=e.selectedCandidatePair.localCandidate.relayProtocol;r==="udp"&&(t[Yo.CONN_TYPE]=1),r==="tcp"&&(t[Yo.CONN_TYPE]=3),r==="tls"&&(t[Yo.CONN_TYPE]=4);break}case"srflx":t[Yo.CONN_TYPE]=2;break;case"unknown":t[Yo.CONN_TYPE]=5;break;default:t[Yo.CONN_TYPE]=0}return t}function Cn(e){let t=0;switch(e){case"none":t=0;break;case"cpu":t=1;break;case"bandwidth":t=2;break;case"other":t=3}return t}class JU extends Xt{constructor(t){super(),ne(this,"store",void 0),ne(this,"uploadWRTCStatsTimer",void 0),ne(this,"uploadOutboundDenoiserStatsTimer",void 0),ne(this,"uploadExtStatsTimer",void 0),ne(this,"uploadExtUsageStatsTimer",void 0),ne(this,"uploadInboundExtStatsTimer",void 0),ne(this,"requestStats",void 0),ne(this,"requestTransportStats",void 0),ne(this,"requestLocalMedia",void 0),ne(this,"requestRemoteMedia",void 0),ne(this,"requestAllTracks",void 0),ne(this,"requestVideoIsReady",void 0),ne(this,"requestUploadStats",void 0),ne(this,"requestUpload",void 0),ne(this,"uploadOutboundStarted",!1),ne(this,"uploadInboundStarted",!1),ne(this,"uploadTransportStarted",!1),ne(this,"uploadBaseStatsStarted",!1),ne(this,"uploadExtensionUsageStarted",!1),ne(this,"lastRecvStats",void 0),ne(this,"lastSendStats",void 0),ne(this,"lastRefRecvStats",void 0),ne(this,"lastRefSendStats",void 0),ne(this,"lastNormalRecvStats",void 0),ne(this,"lastNormalSendStats",void 0),ne(this,"needUploadRenderFreezeTime",!0),ne(this,"lastUploadCompensateTime",-1),ne(this,"uploadCompensateDeltaTime",0),this.store=t}uploadWRTCStats(t){if(!this.requestStats||!this.requestUploadStats)return;const r=t%df==0,s=t%Jg==0;let l,f;if(this.uploadTransportStarted&&(l=this.requestStats(),this.store.useP2P&&(f=this.requestStats(!0))),!l&&this.uploadOutboundStarted&&(l=this.requestStats()),!f&&this.uploadInboundStarted&&(f=this.requestStats(!0)),l||f){var m;const E={};if(this.uploadTransportStarted&&l){const b=this.getTransportStats(l,f,r);b&&(E.misc=[b])}if(this.uploadOutboundStarted&&l){const b=this.getOutboundStats(l,s?this.lastNormalSendStats:void 0,r?this.lastRefSendStats:void 0,this.lastSendStats);b&&(E.outbound=[b])}if(this.uploadInboundStarted&&f){this.uploadCompensateStats(t);const b=this.getInboundStats(f,s?this.lastNormalRecvStats:void 0,r?this.lastRefRecvStats:void 0,this.lastRecvStats);b&&(E.inbound=b)}const y=(m=this.requestTransportStats)===null||m===void 0?void 0:m.call(this).connectState;y&&(Array.isArray(E.misc)?E.misc[0]&&E.misc[0].addition&&(E.misc[0].addition[ED.RTC_PEER_CONNECTION_STATE]=rs[y]):E.misc=[{addition:{[ED.RTC_PEER_CONNECTION_STATE]:rs[y]}}]),this.requestUploadStats(E)}this.lastRecvStats=f,this.lastSendStats=l,s&&(this.lastNormalRecvStats=f,this.lastNormalSendStats=l),r&&(this.lastRefRecvStats=f,this.lastRefSendStats=l)}startUploadWRTCStats(){if(this.uploadWRTCStatsTimer)return;this.uploadBaseStatsStarted=!0;let t=1;this.uploadWRTCStatsTimer=window.setInterval(()=>{if(!this.uploadTransportStarted&&!this.uploadInboundStarted&&!this.uploadOutboundStarted){if(this.uploadBaseStatsStarted){var r,s;const l=(r=this.requestTransportStats)===null||r===void 0?void 0:r.call(this);return void(l&&((s=this.requestUploadStats)===null||s===void 0||s.call(this,{misc:[{addition:{[ED.RTC_PEER_CONNECTION_STATE]:rs[l.connectState]}}]})))}return this.stopUploadWRTCStats()}this.uploadWRTCStats(t),++t===KU+1&&(t=1)},Xp)}uploadCompensateStats(t){if(!this.requestStats||!this.requestUploadStats||!this.requestRemoteMedia)return;const r=t%df==0&&this.needUploadRenderFreezeTime;if(!this.uploadInboundStarted||!r)return;if(this.lastUploadCompensateTime===-1)return void(this.lastUploadCompensateTime=Date.now());const s=Math.max(-6e3,Date.now()-this.lastUploadCompensateTime-6e3);if(this.uploadCompensateDeltaTime+=s,this.lastUploadCompensateTime=Date.now(),this.uploadCompensateDeltaTime<6e3)return;const l=Math.min(Math.floor(this.uploadCompensateDeltaTime/6e3),10);this.uploadCompensateDeltaTime-=6e3*l;const f=this.requestStats(!0);new Array(l).fill(0).forEach(()=>{if(!this.requestStats||!this.requestUploadStats||!this.requestRemoteMedia)return;const m={};if(this.uploadInboundStarted&&f){const E=this.requestRemoteMedia()||[],y=[];E.forEach(b=>{let[A,O]=b;const D={peer:A.uid};if(A._videoSSRC&&this.requestVideoIsReady&&this.requestVideoIsReady(A._videoSSRC)&&O.has(ut.VIDEO)&&A.videoTrack){const P=function(F,B,Y){if(!B.videoRecv.find(ee=>ee.ssrc===F))return;const $={};if(Y&&Y._player){const ee=Y._player,{renderFreezeAccTime2:Ee,videoElementStatus:Re}=ee;if(ef.visibility==="visible"&&Re===Tn.PLAYING&&zn().supportRequestVideoFrameCallback){const Ie=Math.min(6e3,Ee);ee.renderFreezeAccTime2=Math.max(0,Ee-Ie),Qt($,Kt.Video_Render_Freeze_Time_Render2,Ie),me("USE_NEW_RENDER_FREEZE_TIME")&&Qt($,Kt.Video_Render_Freeze_Time_Render,Ie)}}return $}(A._videoSSRC,f,A.videoTrack);P&&(D.video=P)}D.video&&y.push(D)}),y.length>0&&(m.inbound=y,this.requestUploadStats(m))}})}stopUploadWRTCStats(){window.clearInterval(this.uploadWRTCStatsTimer),this.uploadWRTCStatsTimer=void 0,this.lastSendStats&&(this.lastSendStats.videoSend=[],this.lastSendStats.audioSend=[],this.lastSendStats=void 0),this.lastRecvStats&&(this.lastRecvStats.videoRecv=[],this.lastRecvStats.audioRecv=[],this.lastRecvStats=void 0),this.lastRefSendStats&&(this.lastRefSendStats.videoSend=[],this.lastRefSendStats.audioSend=[],this.lastRefSendStats=void 0),this.lastRefRecvStats&&(this.lastRefRecvStats.videoRecv=[],this.lastRefRecvStats.audioRecv=[],this.lastRefRecvStats=void 0),this.lastNormalSendStats&&(this.lastNormalSendStats.videoSend=[],this.lastNormalSendStats.audioSend=[],this.lastNormalSendStats=void 0),this.lastNormalRecvStats&&(this.lastNormalRecvStats.videoRecv=[],this.lastNormalRecvStats.audioRecv=[],this.lastNormalRecvStats=void 0),this.lastUploadCompensateTime=-1,this.uploadCompensateDeltaTime=0,this.needUploadRenderFreezeTime=!0}getTransportStats(t,r,s){if(!this.requestStats)return;if(!s)return t.rtt==null?void 0:{addition:{[Yo.RTT]:t.rtt,[Yo.CONN_TYPE]:void 0,[Yo.STATS_UPDATE_INTERVAL]:t.updateInterval||void 0}};const l=qU(t);if(this.store.useP2P){if(r){const f=qU(r);l[Yo.CONN_TYPE]+=f[Yo.CONN_TYPE]<<3}l[Yo.CONN_TYPE]+=110}else l[Yo.CONN_TYPE]+=100;return{addition:l}}getOutboundStats(t,r,s,l){if(!this.requestUploadStats||!this.requestLocalMedia)return;const f=this.requestLocalMedia();if(!f||f.length===0)return;let m,E,y;return f.forEach(b=>{let[A,{track:O,ssrcs:D}]=b;switch(A){case at.LocalVideoLowTrack:case at.LocalVideoTrack:if(A===at.LocalVideoTrack){const P=function(Y,$,ee,Ee,Re,Ie){const we=$.videoSend.find(Be=>Be.ssrc===Y);if(!we)return;const Ue={},{sentFrame:ve,inputFrame:Ne}=we;if(Ee&&(Qt(Ue,Kt.Video_Send_Qp_Sum,we.qpSumPerFrame),Ne&&ve)){var Ve;const Be=Ne.frameRate,W=ve.frameRate;Ue[Kt.Video_Send_Freeze]=function(ce,Se){let Xe=!0;return Xe=!(ce<=5)&&(ce<=10?Se<3:ce<=20?Se<4:Se<5),Xe}(Be,W)?1:0,Ue[Kt.Video_Send_Type]=ee.__className__==="CameraVideoTrack"?0:ht(Ve=ee._hints).call(Ve,xr.SCREEN_TRACK)?1:2}if(Re){switch(ve&&(Qt(Ue,pn.Video_Send_Height,ve.height),Qt(Ue,pn.Video_Send_Width,ve.width),Qt(Ue,pn.Video_Send_Frame_Rate,ve.frameRate)),Ue[pn.Video_Send_Disabled]=ee._originMediaStreamTrack&&!ee._originMediaStreamTrack.enabled||ee._mediaStreamTrack&&!ee._mediaStreamTrack.enabled?1:0,we.adaptionChangeReason){case"none":Ue[pn.Video_Send_Adaptation]=0;break;case"cpu":Ue[pn.Video_Send_Adaptation]=1;break;case"bandwidth":Ue[pn.Video_Send_Adaptation]=2;break;case"other":Ue[pn.Video_Send_Adaptation]=3}let Be=0;we.adaptionChangeReason&&(Be+=Cn(we.adaptionChangeReason)),$.qualityLimitationReason&&(Be+=Cn($.qualityLimitationReason)<<3),Ue[pn.Video_Send_Adaptation]=Be,Ue[pn.Video_Send_Player_Status]=kg[ee._player?ee._player.videoElementStatus:"uninit"],Qt(Ue,pn.Video_Send_Nacks,we.nacksCount),Qt(Ue,pn.Video_Send_Plis,we.plisCount),Qt(Ue,pn.Video_Send_Firs,we.firsCount),Qt(Ue,pn.Video_Send_Avg_Encode,we.avgEncodeMs),Qt(Ue,pn.Video_Send_Huge_Frame_Sent,we.hugeFramesSent),Qt(Ue,pn.Video_Send_Bytes_Retransmit,we.retransmittedBytesSent),Qt(Ue,pn.Video_Send_Packages_Retransmit,we.retransmittedPacketsSent),Qt(Ue,pn.Video_Send_Key_Frames_Encoded,we.keyFramesEncoded);const W=Re.videoSend.find(ce=>ce.ssrc===Y);if(W){let ce=Xp*df;W.timestamp&&we.timestamp&&(ce=we.timestamp-W.timestamp),W.packets!=null&&we.packets!=null&&Qt(Ue,pn.Video_Send_Package_Rate,1e3*(we.packets-W.packets)/ce),we.packetsLost!=null&&W.packetsLost!=null&&Qt(Ue,pn.Video_Send_Package_Lost,we.packetsLost-W.packetsLost),W.bytes!=null&&we.bytes!=null&&Qt(Ue,pn.Video_Send_Bitrate,8*(we.bytes-W.bytes)/ce)}}return Ue}(D[0].ssrcId,t,O,r,s),F=O&&function(Y,$,ee,Ee){const Re=$.videoSend.find(we=>we.ssrc===Y);if(!Re)return null;const Ie={};if(Ee){const we=Re.inputFrame,Ue=we&&we.height||ee.videoHeight||0,ve=we&&we.width||ee.videoWidth||0,Ne=we&&we.frameRate||0;Qt(Ie,pn.Video_Capture_Height,Ue),Qt(Ie,pn.Video_Capture_Width,ve),Qt(Ie,pn.Video_Capture_Frame_Rate,Ne)}return Ie}(D[0].ssrcId,t,O,!!s),B=function(Y,$){const ee={};return $&&(Qt(ee,pn.Video_Send_Retransmit,Y.bitrate.retransmit),Qt(ee,pn.Video_Send_Target_Encoded,Y.bitrate.targetEncoded),Qt(ee,pn.Video_Send_Actual_Encoded,Y.bitrate.actualEncoded),Qt(ee,pn.Video_Send_Transmit,Y.bitrate.transmit),Qt(ee,pn.Video_Send_Bandwidth,Y.sendBandwidth)),ee}(t,!!s);E=Object.assign({},P,F,B)}else y=function(P,F,B,Y,$){const ee=F.videoSend.find(Re=>Re.ssrc===P);if(!ee)return;const Ee={};if(Y){const Re=ee.sentFrame;Re&&(Qt(Ee,pn.Video_Send_Low_Height,Re.height),Qt(Ee,pn.Video_Send_Low_Width,Re.width),Qt(Ee,pn.Video_Send_Low_Frame_Rate,Re.frameRate));const Ie=Y.videoSend.find(we=>we.ssrc===P);if(Ie){let we=Xp*Jg;Ie.timestamp&&ee.timestamp&&(we=ee.timestamp-Ie.timestamp),Ie.packets!=null&&ee.packets!=null&&Qt(Ee,pn.Video_Send_Low_Package_Rate,1e3*(ee.packets-Ie.packets)/we),ee.packetsLost!=null&&Ie.packetsLost!=null&&Qt(Ee,pn.Video_Send_Low_Package_Lost,ee.packetsLost-Ie.packetsLost),Ie.bytes!=null&&ee.bytes!=null&&Qt(Ee,pn.Video_Send_Low_Bitrate,8*(ee.bytes-Ie.bytes)/we)}}return Ee}(D[0].ssrcId,t,0,s);break;case at.LocalAudioTrack:m=O&&function(P,F,B,Y,$,ee){const Ee=F.audioSend.find(Ie=>Ie.ssrc===P);if(!Ee)return;const Re={};if($){Re[pn.Audio_Send_Disabled]=B._originMediaStreamTrack&&!B._originMediaStreamTrack.enabled||B._mediaStreamTrack&&!B._mediaStreamTrack.enabled?1:0;const Ie=100*B._source.getAccurateVolumeLevel(),we=Ee.inputLevel;if(we!=null){const ve=Math.ceil(50*Math.log10(100*we+1));Qt(Re,pn.Audio_Send_Level,ve)}Qt(Re,pn.Audio_Capture_PCM_Level,Ie),Qt(Re,pn.Audio_Send_AEC_Return_Loss,Ee.aecReturnLoss),Qt(Re,pn.Audio_Send_AEC_Return_Loss_Enhancement,Ee.aecReturnLossEnhancement),Qt(Re,pn.Audio_Send_Bytes_Retransmit,Ee.retransmittedBytesSent),Qt(Re,pn.Audio_Send_Packages_Retransmit,Ee.retransmittedPacketsSent),Re[pn.Audio_Send_Freeze]=0;const Ue=$.audioSend.find(ve=>ve.ssrc===P);if(Ue){let ve=Xp*Jg;Ue.timestamp&&Ee.timestamp&&(ve=Ee.timestamp-Ue.timestamp),Ue.bytes!=null&&Ee.bytes!=null&&Qt(Re,pn.Audio_Send_Bitrate,8*(Ee.bytes-Ue.bytes)/ve),Ue.packets!=null&&Ee.packets!=null&&Qt(Re,pn.Audio_Send_Package_Rate,1e3*(Ee.packets-Ue.packets)/ve)}}return Re}(D[0].ssrcId,t,O,0,s)}}),{high:E,low:y,audio:m}}getInboundStats(t,r,s,l){if(!this.requestRemoteMedia)return;const f=this.requestRemoteMedia()||[],m=[];return f.forEach(E=>{let[y,b]=E;const A={peer:y.uid};if(b.has(ut.VIDEO)&&y.videoTrack){const O=y._videoSSRC&&this.requestVideoIsReady&&this.requestVideoIsReady(y._videoSSRC)||!1,D=y.videoTrack?function(P,F,B,Y,$,ee,Ee,Re){const Ie=F.videoRecv.find(ce=>ce.ssrc===P);if(!Ie)return;const we={},{receivedFrame:Ue,outputFrame:ve,decodeFrameRate:Ne}=Ie;Qt(we,as.Video_Render_Frame_Rate_Decode,Ne),Ie.framesRateFirefox&&Qt(we,as.Video_Recv_Frame_Rate,Ie.framesRateFirefox),Ue&&Qt(we,as.Video_Recv_Frame_Rate,Ue.frameRate),Qt(we,as.Video_Recv_Frame_Dropped,Ie.framesDroppedCount),Qt(we,as.Video_Recv_Bytes_Retransmit,Ie.retransmittedBytesReceived),Qt(we,as.Video_Recv_Packages_Retransmit,Ie.retransmittedPacketsReceived),Qt(we,as.Video_Recv_Packages_Discarded,Ie.packetsDiscarded),Qt(we,as.Video_Recv_Avg_Decode,Ie.avgDecodeMs),Qt(we,as.Video_Recv_Avg_Processing_Delay,Ie.avgProcessingDelayMs),Qt(we,as.Video_Recv_Avg_Assembly_Time,Ie.avgFramesAssembledFromMultiplePacketsMs),Qt(we,as.Video_Recv_Avg_Inter_Frame_Delay,Ie.avgInterFrameDelayMs),Qt(we,as.Video_Recv_Key_Frames_Decoded,Ie.keyFramesDecoded);const Ve=Re&&Re.videoRecv.find(ce=>ce.ssrc===P);if(Ve){const ce=F.timestamp-Re.timestamp||Xp;Ie.packetsLost!=null&&Ve.packetsLost!=null&&Qt(we,as.Video_Recv_Package_Lost,Ie.packetsLost-Ve.packetsLost),Ve.bytes!=null&&Ie.bytes!=null&&Qt(we,as.Video_Recv_Bitrate,8*(Ie.bytes-Ve.bytes)/ce),Ve.packets!=null&&Ie.packets!=null&&Qt(we,as.Video_Recv_Package_Rate,1e3*(Ie.packets-Ve.packets)/ce)}const Be=ee&&ee.videoRecv.find(ce=>ce.ssrc===P);if(Be&&(Qt(we,Kt.Video_Recv_Qp_Sum,Ie.qpSumPerFrame),we[Kt.Video_Recv_Freeze]=Y&&UI.isRemoteVideoFreeze(B,Ie,Be)?1:0),Ee){var W;const ce=Ee.videoRecv.find(Xe=>Xe.ssrc===P);Ue?(Qt(we,pn.Video_Recv_Height,Ue.height),Qt(we,pn.Video_Recv_Width,Ue.width)):B&&(Qt(we,pn.Video_Recv_Height,B._videoHeight||0),Qt(we,pn.Video_Recv_Width,B._videoWidth||0)),ve&&Qt(we,pn.Video_Recv_Frame_Rate_Output,ve.frameRate);const Se=(W=B._player)===null||W===void 0?void 0:W.rendFrameRate.toFixed(0);if(Se&&Qt(we,pn.Video_Render_Frame_Rate_Render,+Se),Qt(we,pn.Video_Recv_Jitter_Buffer,Ie.jitterBufferMs),Qt(we,pn.Video_Recv_Current_Delay,Ie.currentDelayMs),Qt(we,pn.Video_Recv_Firs,Ie.firsCount),Qt(we,pn.Video_Recv_Nacks,Ie.nacksCount),Qt(we,pn.Video_Recv_Plis,Ie.plisCount),B){we[pn.Video_Recv_Disabled]=B._originMediaStreamTrack.enabled&&B._mediaStreamTrack.enabled?0:1;const Xe=B._player;if(Xe){const{freezeTimeCounterList:en,renderFreezeAccTime:He,renderFreezeAccTime2:tt,videoElementStatus:St}=Xe;if(en&&en.length>0&&Qt(we,Kt.Video_Render_Freeze_Time,en.splice(0,1)[0]),$&&ef.visibility==="visible"&&St===Tn.PLAYING&&zn().supportRequestVideoFrameCallback){const Ze=Math.min(6e3,tt);Xe.renderFreezeAccTime2=Math.max(0,tt-Ze),Qt(we,Kt.Video_Render_Freeze_Time_Render2,Ze);const J=Math.min(6e3,He);Xe.renderFreezeAccTime=Math.max(0,He-J),Qt(we,Kt.Video_Render_Freeze_Time_Render,me("USE_NEW_RENDER_FREEZE_TIME")?Ze:J)}if(typeof Ie.totalFreezesDuration=="number"){const Ze=ce&&ce.totalFreezesDuration?Ie.totalFreezesDuration-ce.totalFreezesDuration:Ie.totalFreezesDuration;Qt(we,pn.Video_Render_Freeze_Duration,1e3*Ze)}}}if(we[pn.Video_Recv_Player_Status]=kg[B._player?B._player.videoElementStatus:"uninit"],ce&&Ie.totalInterFrameDelay!==void 0&&Ie.totalSquaredInterFrameDelay!==void 0&&ce.totalInterFrameDelay!==void 0&&ce.totalSquaredInterFrameDelay!==void 0){const Xe=Ie.totalInterFrameDelay-ce.totalInterFrameDelay,en=Ie.totalSquaredInterFrameDelay-ce.totalSquaredInterFrameDelay,He=Ie.framesDecodeCount-ce.framesDecodeCount,tt=Xe/He*1e3,St=Math.round(1e3*Math.sqrt((en-Math.pow(Xe,2)/He)/He));!isNaN(St)&&tt+St>Math.max(3*tt,tt+150)&&(we[pn.Video_Recv_I_Frame_Delay]=St)}}return we}(y._videoSSRC,t,y.videoTrack,O===!0,this.needUploadRenderFreezeTime,r,s,l):void 0;D&&(A.video=D)}if(b.has(ut.AUDIO)&&y.audioTrack){const O=y.audioTrack?function(D,P,F,B,Y,$){const ee=P.audioRecv.find(we=>we.ssrc===D);if(!ee)return;const Ee={};Qt(Ee,as.Audio_Recv_Jitter,ee.jitterMs),Qt(Ee,as.Audio_Recv_Bytes_Retransmit,ee.retransmittedBytesReceived),Qt(Ee,as.Audio_Recv_Packages_Retransmit,ee.retransmittedPacketsReceived),Qt(Ee,as.Audio_Recv_Packages_Discarded,ee.packetsDiscarded),Qt(Ee,as.Audio_Recv_Avg_Processing_Delay,ee.avgProcessingDelayMs);const Re=$&&$.audioRecv.find(we=>we.ssrc===D);if(Re){const we=Xp;ee.packets!=null&&Re.packets!=null&&Qt(Ee,as.Audio_Recv_Package_Rate,1e3*(ee.packets-Re.packets)/we),ee.packetsLost!=null&&Re.packetsLost!=null&&Qt(Ee,as.Audio_Recv_Package_Lost,ee.packetsLost-Re.packetsLost)}if(B){const{receivedFrames:we,droppedFrames:Ue}=ee;we!=null&&Ue!=null&&(Ee[Kt.Audio_Recv_Freeze]=(Ie=we)===0||100*Ue/Ie>20?1:0)}var Ie;if(Y){const we=100*F._source.getAccurateVolumeLevel(),Ue=ee.outputLevel;if(Ue!=null){const Ne=Math.ceil(50*Math.log10(100*Ue+1));Qt(Ee,pn.Audio_Render_Level,Ne)}Qt(Ee,pn.Audio_Recv_PCM_Level,we),F&&(Ee[pn.Audio_Recv_Disabled]=F._originMediaStreamTrack.enabled&&F._mediaStreamTrack.enabled?0:1),Qt(Ee,pn.Audio_Recv_Jitter_Buffer,ee.jitterBufferMs),Qt(Ee,pn.Audio_Recv_Current_Delay,ee.jitterBufferMs),Ee[pn.Audio_Recv_Player_Status]=kg[dc.getPlayerState(F.getTrackId())];const ve=Y.audioRecv.find(Ne=>Ne.ssrc===D);if(ve){ve.bytes!=null&&ee.bytes!=null&&Qt(Ee,pn.Audio_Recv_Bitrate,8*(ee.bytes-ve.bytes)/(Xp*df));const Ne=ee.concealedSamples-ve.concealedSamples;Ne>0&&Qt(Ee,pn.Audio_Recv_Concealed_Samples,Ne);const Ve=ee.totalSamplesReceived-ve.totalSamplesReceived;Ve>0&&Qt(Ee,pn.Audio_Recv_Total_Samples_Received,Ve);const Be=ee.freezeSamples80-ve.freezeSamples80;Be>0&&Qt(Ee,pn.Audio_Render_Freeze_Samples_80ms,Be);const W=ee.freezeSamples200-ve.freezeSamples200;W>0&&Qt(Ee,pn.Audio_Render_Freeze_Samples_200ms,W);const ce=ee.freezeMs80-ve.freezeMs80;Qt(Ee,pn.Audio_Render_Freeze_Time_80ms,ce<0?0:ce);const Se=ee.freezeMs200-ve.freezeMs200;Qt(Ee,pn.Audio_Render_Freeze_Time_200ms,Se<0?0:Se)}}return Ee}(y._audioSSRC,t,y.audioTrack,r,s,l):void 0;O&&(A.audio=O)}(A.video||A.audio)&&m.push(A)}),this.needUploadRenderFreezeTime=!this.needUploadRenderFreezeTime,m}startUploadTransportStats(){this.uploadTransportStarted=!0,this.uploadWRTCStatsTimer||this.startUploadWRTCStats()}stopUploadTransportStats(){this.uploadTransportStarted=!1}startUploadOutboundStats(){this.uploadOutboundStarted||(this.uploadOutboundStarted=!0,this.uploadWRTCStatsTimer||this.startUploadWRTCStats(),this.uploadOutboundDenoiserStatsTimer&&window.clearInterval(this.uploadOutboundDenoiserStatsTimer),this.uploadOutboundDenoiserStatsTimer=window.setInterval(()=>{if(!this.requestAllTracks||!this.requestUpload)return;const t=(this.requestAllTracks()||[]).find(r=>r instanceof t1);if(t&&t._external.getDenoiserStats){const r=t._external.getDenoiserStats();r&&this.requestUpload(bs.DENOISER_STATS,r)}},2e3),this.uploadExtStatsTimer&&window.clearInterval(this.uploadExtStatsTimer),this.uploadExtStatsTimer=window.setInterval(()=>{!this.requestAllTracks||!this.requestUpload||this.requestAllTracks().forEach(t=>{t.getProcessorStats().forEach(r=>{this.requestUpload&&this.requestUpload(r.type,r.stats)})})},2e3))}stopUploadOutboundStats(){this.uploadOutboundStarted&&(this.uploadOutboundStarted=!1,this.lastSendStats&&(this.lastSendStats.videoSend=[],this.lastSendStats.audioSend=[],this.lastSendStats=void 0),this.lastRefSendStats&&(this.lastRefSendStats.videoSend=[],this.lastRefSendStats.audioSend=[],this.lastRefSendStats=void 0),this.lastNormalSendStats&&(this.lastNormalSendStats.videoSend=[],this.lastNormalSendStats.audioSend=[],this.lastNormalSendStats=void 0),this.uploadOutboundDenoiserStatsTimer&&window.clearInterval(this.uploadOutboundDenoiserStatsTimer),this.uploadOutboundDenoiserStatsTimer=void 0,this.uploadExtStatsTimer&&window.clearInterval(this.uploadExtStatsTimer),this.uploadExtStatsTimer=void 0)}startUploadInboundStats(){this.uploadInboundStarted||(this.uploadInboundStarted=!0,this.uploadWRTCStatsTimer||this.startUploadWRTCStats(),this.uploadInboundExtStatsTimer&&window.clearInterval(this.uploadInboundExtStatsTimer),this.uploadInboundExtStatsTimer=window.setInterval(()=>{!this.requestUpload||!this.requestRemoteMedia||(this.requestRemoteMedia()||[]).forEach(t=>{let[r,s]=t;s.has(ut.VIDEO)&&r.videoTrack&&r.videoTrack.getProcessorStats().forEach(l=>{this.requestUpload&&this.requestUpload(l.type,l.stats)}),s.has(ut.AUDIO)&&r.audioTrack&&r.audioTrack.getProcessorStats().forEach(l=>{this.requestUpload&&this.requestUpload(l.type,l.stats)})})},2e3))}stopUploadInboundStats(){this.uploadInboundStarted&&(this.uploadInboundStarted=!1,this.lastRecvStats&&(this.lastRecvStats.videoRecv=[],this.lastRecvStats.audioRecv=[],this.lastRecvStats=void 0),this.lastRefRecvStats&&(this.lastRefRecvStats.videoRecv=[],this.lastRefRecvStats.audioRecv=[],this.lastRefRecvStats=void 0),this.lastNormalRecvStats&&(this.lastNormalRecvStats.videoRecv=[],this.lastNormalRecvStats.audioRecv=[],this.lastNormalRecvStats=void 0),this.lastUploadCompensateTime=-1,this.uploadCompensateDeltaTime=0,this.needUploadRenderFreezeTime=!0,this.uploadInboundExtStatsTimer&&window.clearInterval(this.uploadInboundExtStatsTimer),this.uploadInboundExtStatsTimer=void 0)}startUploadExtensionUsageStats(){if(this.uploadExtensionUsageStarted)return;this.uploadExtensionUsageStarted=!0,this.uploadExtUsageStatsTimer&&window.clearInterval(this.uploadExtUsageStatsTimer);const t=new Map;this.uploadExtUsageStatsTimer=window.setInterval(async()=>{const r=Date.now(),s={connectionInterval:me("EXTENSION_USAGE_UPLOAD_INTERVAL")/1e3,details:[],lts:r};let l=[];const f=this.requestAllTracks&&this.requestAllTracks()||[];for(const b of f)!b.muted&&b.enabled&&(l=l.concat(await b.getProcessorUsage()));const m=this.requestRemoteMedia&&this.requestRemoteMedia()||[];for(const[b,A]of m)A.has(ut.VIDEO)&&b.videoTrack&&(l=l.concat(await b.videoTrack.getProcessorUsage())),A.has(ut.AUDIO)&&b.audioTrack&&(l=l.concat(await b.audioTrack.getProcessorUsage()));if(l.length===0)return;s.details=function(b,A){const O={};for(const{id:B,value:Y,level:$,direction:ee}of b){var D;const Ee=(D=A.get(B))!==null&&D!==void 0?D:0,Re=Y===2?Ee+me("EXTENSION_USAGE_UPLOAD_INTERVAL")/1e3:Ee;var P,F;A.set(B,Re),O[B]?(Y===2&&(O[B].value=Y),$>O[B].level&&(O[B].level=$),ee==="remote"&&(O[B].remoteUidCount+=1),O[B].totalTs=(P=A.get(B))!==null&&P!==void 0?P:0):O[B]={value:Y,level:$,remoteUidCount:ee==="local"?0:1,totalTs:(F=A.get(B))!==null&&F!==void 0?F:0}}return Object.keys(O).map(B=>{const{level:Y,value:$,totalTs:ee}=O[B];return{id:B,level:Y,value:$,totalTs:ee}})}(l,t);const E=Date.now(),y=E>r?E:r+1;this.requestUpload&&this.requestUpload(bs.EXTENSION_USAGE_STATS,{usageStats:s,sendTs:y})},me("EXTENSION_USAGE_UPLOAD_INTERVAL"))}stopUploadExtensionUsageStats(){this.uploadExtensionUsageStarted&&(this.uploadExtensionUsageStarted=!1,this.uploadExtUsageStatsTimer&&window.clearInterval(this.uploadExtUsageStatsTimer),this.uploadExtUsageStatsTimer=void 0)}stopUploadBaseStats(){this.uploadBaseStatsStarted=!1}}const Qp=me("ICE_RESTART_INTERVAL");let GI=new Map,Xg=new Map,uf=[Ua.UDP_TCP_RELAY,Ua.TCP_RELAY,Ua.RELAY],Hs=me("JOIN_WITH_FALLBACK_MEDIA_PROXY_FORCE")&&zn().supportPCSetConfiguration;function XU(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];const r=GI.get(e.id);r&&(window.clearTimeout(r),GI.delete(e.id));const s=Xg.get(e.id);t&&s&&s.index===uf.length-1&&(G.debug("[".concat(e.id,"] reset ICE restart policy")),Xg.delete(e.id))}function QU(e,t,r){if(GI.size===0&&Xg.size===0&&(Array.isArray(me("RESTART_SEQUENCE"))&&me("RESTART_SEQUENCE").length>0&&!function(E,y){if(E.length!==y.length)return!1;for(let b=0;b<E.length;b+=1){const A=E[b];if(E.filter(O=>O===A).length!==y.filter(O=>O===A).length)return!1}return!0}(uf,me("RESTART_SEQUENCE"))&&(uf=me("RESTART_SEQUENCE").filter(E=>{var y;if(ht(y=Object.values(Ua)).call(y,E))return!0}),G.debug("use reconnection policy from config distribution, queues: ".concat(uf.join(" => ")))),Hs=me("JOIN_WITH_FALLBACK_MEDIA_PROXY_FORCE")&&zn().supportPCSetConfiguration),uf.length===0)return void r();let s,{index:l=0,type:f}=Xg.get(e.id)||{};if(Hs&&f===Ua.RELAY)return void r();let m=f&&l>=uf.length-1;if(Hs)f=Ua.RELAY;else{if(m)return void r();f?(l++,f=uf[l]):(f=uf[0],l=0)}G.debug("[".concat(e.id,"] choose ICE restart policy: ").concat(f,", index: ").concat(l)),t(f),Xg.set(e.id,{index:l,type:f}),s=window.setTimeout(()=>QU(e,t,r),Qp),GI.set(e.id,s)}var On;function tF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),r.push.apply(r,s)}return r}function ff(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?tF(Object(r),!0).forEach(function(s){ne(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tF(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function zI(e){var t,r,s,l=2;for(typeof Symbol<"u"&&(r=dx,s=Symbol.iterator);l--;){if(r&&(t=e[r])!=null)return t.call(e);if(s&&(t=e[s])!=null)return new HI(t.call(e));r="@@asyncIterator",s="@@iterator"}throw new TypeError("Object is not async iterable")}function HI(e){function t(r){if(Object(r)!==r)return gt.reject(new TypeError(r+" is not an object."));var s=r.done;return gt.resolve(r.value).then(function(l){return{value:l,done:s}})}return HI=function(r){this.s=r,this.n=r.next},HI.prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(r){var s=this.s.return;return s===void 0?gt.resolve({value:r,done:!0}):t(s.apply(this.s,arguments))},throw:function(r){var s=this.s.return;return s===void 0?gt.reject(r):t(s.apply(this.s,arguments))}},new HI(e)}let w1=(On=class extends Xt{get state(){return this._state}set state(e){const t=this._state;this._state=e,this.emit(Yt.StateChange,t,this._state)}constructor(e,t){super(),ne(this,"isPlanB",void 0),ne(this,"store",void 0),ne(this,"statsUploader",void 0),ne(this,"connection",void 0),ne(this,"localTrackMap",new Map),ne(this,"remoteUserMap",new Map),ne(this,"localDataChannels",[]),ne(this,"remoteDataChannelMap",new Map),ne(this,"pendingLocalTracks",[]),ne(this,"pendingRemoteTracks",[]),ne(this,"pendingLocalDataChannels",[]),ne(this,"pendingRemoteDataChannels",[]),ne(this,"statsCollector",void 0),ne(this,"shouldForwardP2PCreation",void 0),ne(this,"iceFailedCount",0),ne(this,"dtlsFailedCount",0),ne(this,"mutex",void 0),ne(this,"_state",Qn.Disconnected),ne(this,"_pcStatsUploadType",me("NEW_ICE_RESTART")?zc.FIRST_CONNECTION:zc.OLD_FIRST_CONNECTION),ne(this,"_isStartRestartIce",!1),ne(this,"_restartTimer",void 0),ne(this,"_isTryConnecting",!1),ne(this,"_iceError",null),ne(this,"_forceTurn",!1),ne(this,"_isWaitPcToRePub",!1),ne(this,"handleMuteLocalTrack",async(r,s,l)=>{const f=await this.mutex.lock("Locking from P2PChannel.handleMuteLocalTrack");try{if(!this.connection||this.state!==Qn.Connected)return void l(new Ke(se.INVALID_OPERATION,"Cannot call P2PChannel.handleMuteLocalTrack before connection established."));const m=this.filterTobeMutedTracks(r);if(m.length===0)return void s();const E=m.find(b=>b[0]==="videoLowTrack");E&&E[1].track._originMediaStreamTrack.stop(),await this.connection.muteLocal(m.map(b=>{let[,{id:A}]=b;return A}));const y=this.createMuteMessage(m);await fr(this,Yt.RequestMuteLocal,y),s()}catch(m){l(m)}finally{f()}}),ne(this,"handleUnmuteLocalTrack",async(r,s,l)=>{const f=await this.mutex.lock("Locking from P2PChannel.handleUnmuteLocalTrack");try{if(!this.connection||this.state!==Qn.Connected)return void l(new Ke(se.INVALID_OPERATION,"Cannot call P2PChannel.handleUnmuteLocalTrack before connection established."));const m=this.filterTobeUnmutedTracks(r);if(m.length===0)return void s();const E=m.find(b=>b[0]==="videoLowTrack");if(E){const b=E[1];if(b.track._originMediaStreamTrack.stop(),!me("DISABLE_DUAL_STREAM_USE_ENCODING")&&zn().supportDualStreamEncoding){const A=r._mediaStreamTrack.clone();b.track._mediaStreamTrack=A,b.track._originMediaStreamTrack=A}else{const A=YU(r,Fb(this,Yt.RequestLowStreamParameter));b.track._mediaStreamTrack=A,b.track._originMediaStreamTrack=A}await new gt((A,O)=>{this.handleReplaceTrack(b.track,A,O,!0)})}await this.connection.unmuteLocal(m.map(b=>{let[,{id:A}]=b;return A}));const y=this.createUnmuteMessage(m);await fr(this,Yt.RequestUnmuteLocal,y),s()}catch(m){l(m)}finally{f()}}),ne(this,"handleUpdateVideoEncoder",async(r,s,l,f)=>{let m;f||(m=await this.mutex.lock("Locking from P2PChannel.handleUpdateVideoEncoder"));try{const y=this.localTrackMap.get(at.LocalVideoTrack);if(!this.connection||!y||y.track!==r||this.state!==Qn.Connected)return void s();const{id:b,track:A}=y;await this.connection.updateSendParameters(b,A),await this.connection.updateEncoderConfig(b,A),this.emit(Yt.UpdateVideoEncoder,A),s()}catch(y){l(y)}finally{var E;(E=m)===null||E===void 0||E()}}),ne(this,"handleUpdateVideoSendParameters",async(r,s,l)=>{const f=await this.mutex.lock("Locking from P2PChannel.handleUpdateVideoSendParameters");try{const m=this.localTrackMap.get(at.LocalVideoTrack);if(!this.connection||!m||m.track!==r||this.state!==Qn.Connected)return void s();const{id:E,track:y}=m;await this.connection.updateSendParameters(E,y),s()}catch(m){l(m)}finally{f()}}),ne(this,"handleReplaceMixingTrack",async(r,s,l,f)=>{if(!this.connection||this.state!==Qn.Connected)return void s();const m=qg([r]);let E;G.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection will replace audioTrack [").concat(m.getTrackId(),"]")),typeof f=="boolean"&&f||(E=await this.mutex.lock("From P2PChannel.handleReplaceMixingTrack"));try{await this.replaceTrack(r,m),s()}catch(b){l(b)}finally{var y;(y=E)===null||y===void 0||y()}}),ne(this,"handleReplaceTrack",async(r,s,l,f)=>{let m;G.debug("[".concat(this.store.clientId,"] P2PChannel handleReplaceTrack for [track-id-").concat(r.getTrackId(),"]")),typeof f=="boolean"&&f||(m=await this.mutex.lock("From P2PChannel.handleReplaceTrack"));try{var E;const b=Array.from(this.localTrackMap.entries()).find(A=>{let[,{track:O}]=A;return r===O});if(!this.connection||!b||this.state!==Qn.Connected)return void s();if(await((E=this.connection)===null||E===void 0?void 0:E.replaceTrack(r,b[1].id)),this.isPlanB){const A=b[1];A.id=r._mediaStreamTrack.id,this.localTrackMap.set(b[0],A)}if(b[0]===at.LocalVideoTrack&&!me("DISABLE_DUAL_STREAM_USE_ENCODING")&&zn().supportDualStreamEncoding){const A=this.localTrackMap.get(at.LocalVideoLowTrack);if(A){const O=r._mediaStreamTrack.clone();A.track._originMediaStreamTrack.stop(),A.track._mediaStreamTrack=O,A.track._originMediaStreamTrack=O,await new gt((D,P)=>{this.handleReplaceTrack(A.track,D,P,!0)})}}s()}catch(b){l(b)}finally{var y;(y=m)===null||y===void 0||y()}}),ne(this,"handleGetRTCStats",r=>{r(this.statsCollector.getRTCStats())}),ne(this,"handleGetLocalVideoStats",r=>{r(this.statsCollector.getLocalVideoTrackStats())}),ne(this,"handleGetLocalAudioStats",r=>{r(this.statsCollector.getLocalAudioTrackStats())}),ne(this,"handleGetRemoteVideoStats",r=>this.statsCollector.getRemoteVideoTrackStats(r.uid)[r.uid]),ne(this,"handleGetRemoteAudioStats",r=>this.statsCollector.getRemoteAudioTrackStats(r.uid)[r.uid]),this.store=e,this.statsCollector=t,this.statsCollector.addP2PChannel(this),this.statsUploader=new JU(this.store),this.bindStatsUploaderEvents(),this.mutex=new Gi("P2PChannel-mutex",this.store.clientId),this.isPlanB=!zn().supportUnifiedPlan||me("CHROME_FORCE_PLAN_B")&&fh(),this.shouldForwardP2PCreation=me("FORWARD_P2P_CREATION")&&zn().supportPCSetConfiguration&&Cr(),this.shouldForwardP2PCreation&&(this.connection=cu(this.store),this.emit(Yt.PeerConnectionStateChange,this.connection.peerConnectionState),this.bindConnectionEvents(this.connection))}async startP2PConnection(e){var t;this.state=Qn.New,this._forceTurn=WU(e),G.debug("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] forceTurn: ").concat(this._forceTurn));const r=this.shouldForwardP2PCreation&&((t=this.connection)===null||t===void 0?void 0:t.peerConnectionState)==="closed";if(this.shouldForwardP2PCreation&&!r||(r&&this.connection&&(G.warning("[".concat(this.store.clientId,"] P2PChannel.startP2PConnection ForwardP2P closed.")),this.resetConnection(this.connection)),this.connection=cu(this.store,e),this.emit(Yt.PeerConnectionStateChange,this.connection.peerConnectionState),this.bindConnectionEvents(this.connection)),!this.connection)throw new Ke(se.UNEXPECTED_ERROR,"Cannot P2PChannel.startConnection before P2PConnection initialization .");return this._pcStatsUploadType=me("NEW_ICE_RESTART")?zc.FIRST_CONNECTION:zc.OLD_FIRST_CONNECTION,this._isTryConnecting=!0,this._isStartRestartIce=!1,this._iceError=null,this.connection.setConfiguration(e),this.connection.establishPromise}async connect(e){if(!this.connection)throw new Ke(se.UNEXPECTED_ERROR,"Cannot P2PChannel.connect before P2PChannel.startP2PConnection .");me("ENABLE_PREALLOC_PC")&&this.state===Qn.Connected?await this.connection.updateRemoteConnect(e):(this.store.peerConnectionStart(),await this.connection.connect(e),this.statsUploader.startUploadTransportStats(),this.statsUploader.startUploadExtensionUsageStats(),this.state=Qn.Connected)}updateRemoteRTPCapabilities(e){const t=Array.from(this.localTrackMap.entries()).filter(l=>{var f;let[m]=l;return ht(f=[at.LocalVideoLowTrack,at.LocalVideoTrack]).call(f,m)}),r=t.map(l=>{let[,{id:f}]=l;return f}),s=t.map(l=>{let[f]=l;return f});if(this.connection instanceof Kc){if(Vt.updateRemoteRTPCapabilities(this.store.sessionId,{trackTypes:JSON.stringify(s),localCodecs:JSON.stringify(this.connection.localCodecs),remoteCodecs:JSON.stringify(e)}),!ht(e).call(e,this.store.codec)){const l=["vp9","vp8","h264"].find(f=>ht(e).call(e,f));l&&(this.store.codec=l,G.debug("[".concat(this.store.clientId,"] [").concat(this.store.p2pId," updateRemoteRTPCapabilities] default codec is not available, hence the fallback to ").concat(l,".")))}this.connection.updateRemoteRTPCapabilities(r,e)}}async getEstablishParams(){var e;if(this.connection instanceof Kc&&this.connection.peerConnectionState!=="closed"&&ht(e=[Qn.New,Qn.Connected]).call(e,this.state))return this.connection.establishPromise}async publishDataChannel(e){if(!this.connection||this.state!==Qn.Connected){if(this.state===Qn.Disconnected)throw new Ke(se.UNEXPECTED_ERROR,"PeerConnection already disconnected.");return e.forEach(r=>{var s;ht(s=this.pendingLocalDataChannels).call(s,r)||this.pendingLocalDataChannels.push(r)}),[]}const t=this.filterTobePublishedDataChannels(e);return t.length===0?[]:(t.forEach(r=>{const s=Date.now();this.store.publish(r.id.toString(),"datachannel",s)}),await this.connection.createDataChannels(this.store.uid,t),t.forEach(r=>{this.localDataChannels.push(r);const s=Date.now();this.store.publish(r.id+"","datachannel",void 0,s)}),e.map(r=>({streamId:r.id,ordered:r.ordered,maxRetransmits:r.maxRetransmits,metadata:r.metadata,channelId:r._originDataChannelId})))}publish(e,t,r){var s=this;return $l(function*(){const l=yield xn(s.mutex.lock("From P2PChannel.publish"));try{var f;const m=s.connection&&ht(f=["disconnected","failed"]).call(f,s.connection.peerConnectionState);if(!s.connection||s.state!==Qn.Connected||m){if(s.state===Qn.Disconnected)throw new Ke(se.UNEXPECTED_ERROR,"PeerConnection already disconnected.");s.throwIfTrackTypeNotMatch(e);const y=e.filter(b=>s.pendingLocalTracks.indexOf(b)===-1);return s.pendingLocalTracks=s.pendingLocalTracks.concat(y),void(m&&(s._isWaitPcToRePub=!0))}s.store.pubId=s.store.pubId+1,ws.markPublishStart(s.store.clientId,s.store.pubId);const E=s.filterTobePublishedTracks(e,t,r);if(E.length===0)return void(yield xn(s.tryToUnmuteAudio(e)));yield*XR(zI(s.doPublish(s.connection,E)))}finally{l()}})()}doPublish(e,t){var r=this;return $l(function*(){t.forEach(D=>{let{track:P,type:F}=D;const B=Date.now();r.store.publish(P.getTrackId(),F===at.LocalAudioTrack?"audio":"video",B)}),r.bindLocalTrackEvents(t);const s=t.map(D=>{let{track:P}=D;return P}),l=yield xn(e.send(s,r.store.codec,r.store.audioCodec)),f=(yield xn(l.next())).value,m=r.createGatewayPublishMessage(t,f);let E;try{E=yield m}catch(D){throw l.throw(D),(D==null?void 0:D.code)===se.WS_ABORT&&t.forEach(P=>{let{track:F}=P;r.pendingLocalTracks.indexOf(F)===-1&&r.pendingLocalTracks.push(F)}),r.unbindLocalTrackEvents(t),D}const y=r.mapPubResToRemoteConfig(m,E,s),b=(yield xn(l.next(y))).value;if(r.state===Qn.Disconnected)throw new Ke(se.UNEXPECTED_ERROR,"PeerConnection already disconnected.");me("ENABLE_VIDEO_SEI");const A=me("ENABLE_ENCODED_TRANSFORM"),O=me("ENABLE_AUDIO_METADATA");s.forEach(async D=>{const P=D.getRTCRtpTransceiver();if(!P||!A)return;const{interceptLocalVideoFrame:F,interceptLocalAudioFrame:B}=PI();D.trackMediaType===ut.VIDEO?await F(P.sender,D):D.trackMediaType===ut.AUDIO&&await B(P.sender,{metadata:O?()=>{const Y=D.metadata.shift();return Y&&Y.value}:void 0})}),t.forEach(D=>{let{type:P}=D;r.statsCollector.addLocalStats(P)}),r.assignLocalTracks(t,b),r.statsUploader.startUploadOutboundStats(),t.forEach(D=>{let{track:P,type:F}=D;const B=Date.now();r.store.publish(P.getTrackId(),F===at.LocalAudioTrack?"audio":"video",void 0,B)})})()}async updateVideoStreamParameter(e,t){const r=this.localTrackMap.get(t);if(!r||!this.connection)return;if(!(r.track instanceof Kr))return G.warn("[updateVideoStreamParameter]: track is not an instance of LocalVideoTrack");const{track:s}=r,l=function(f,m){const E={};return f.height&&f.width&&(E.scaleResolutionDownBy=Bg(f,m)),E.maxFramerate=f.framerate?Co(f.framerate):void 0,E.maxBitrate=f.bitrate?1e3*f.bitrate:void 0,E}(e,s);if(s._encoderConfig||(s._encoderConfig={}),t!==at.LocalVideoLowTrack||!me("DISABLE_DUAL_STREAM_USE_ENCODING")&&zn().supportDualStreamEncoding)l.scaleResolutionDownBy!=null&&(s._encoderConfig.scaleResolutionDownBy=l.scaleResolutionDownBy);else{const f=s._originMediaStreamTrack;if(!f.canvas)return G.warn("[".concat(s.getTrackId(),"] no canvas on track"));(function(m,E){const y=m.canvas;E.width&&(y.width=Co(E.width)),E.height&&(y.height=Co(E.height)),E.framerate&&(y.stopCapture&&y.stopCapture(),y.stopCapture=e1(()=>{!y.startCapture&&y.stopCapture&&y.stopCapture(),y.startCapture&&y.startCapture()},Co(E.framerate)))})(f,e)}l.maxBitrate!=null&&(s._encoderConfig.bitrateMax=l.maxBitrate/1e3),l.maxFramerate!=null&&(s._encoderConfig.frameRate&&typeof s._encoderConfig.frameRate=="object"?s._encoderConfig.frameRate.max=l.maxFramerate:s._encoderConfig.frameRate={max:l.maxFramerate}),G.debug("[".concat(s.getTrackId(),"] LowStreamEncoderConfig: , ").concat(JSON.stringify(s._encoderConfig))),await this.connection.updateRtpSenderEncodings(s)}publishLowStream(e){var t=this;return $l(function*(){if(!t.connection||t.state!==Qn.Connected)return;const r=yield xn(t.mutex.lock("Locking from P2PChannel.publishLowStream"));try{const l=t.localTrackMap.get(at.LocalVideoTrack);if(!l)throw new Ke(se.UNEXPECTED_ERROR,"Could not find high stream");if(t.localTrackMap.has(at.LocalVideoLowTrack))throw new Ke(se.UNEXPECTED_ERROR,"[".concat(t.store.clientId,"] Can't publish low stream when stream already publish"));const f=[{track:t.getLowVideoTrack(l.track,e),type:at.LocalVideoLowTrack}];if(yield*XR(zI(t.doPublish(t.connection,f))),l.track.muted||!l.track.enabled){var s;const m=(s=t.localTrackMap.get(at.LocalVideoLowTrack))===null||s===void 0?void 0:s.id;m!==void 0&&(yield xn(t.connection.muteLocal([m])))}}finally{r()}})()}async republish(){this.pendingLocalTracks.length>0&&(G.debug("[".concat(this.store.clientId,"] Emit P2PChannelEvents.RequestRePublish to republish tracks.")),await la(this,Yt.RequestRePublish,this.pendingLocalTracks),this.emit(Yt.MediaReconnectEnd,this.store.uid),this.pendingLocalTracks=[]),this.pendingLocalDataChannels.length>0&&(G.debug("Emit P2PChannelEvents.RequestRePublishDataChannel to republish datachannels."),await la(this,Yt.RequestRePublishDataChannel,this.pendingLocalDataChannels),this.pendingLocalDataChannels=[]),this._isWaitPcToRePub=!1}async reSubscribe(e){for(let t=this.pendingRemoteTracks.length-1;t>=0;t--){const{user:r,kind:s}=this.pendingRemoteTracks[t];(s!==ut.AUDIO||r._audio_added_&&r._audioSSRC)&&(s!==ut.VIDEO||r._video_added_&&r._videoSSRC)||this.pendingRemoteTracks.splice(t,1)}if(e)await la(this,Yt.RequestReSubscribe,this.pendingRemoteTracks);else for(const{user:t,kind:r}of this.pendingRemoteTracks)await this.subscribe(t,r,r===ut.VIDEO?t._videoSSRC:t._audioSSRC);this.pendingRemoteTracks.forEach(t=>{let{user:r}=t;this.emit(Yt.MediaReconnectEnd,r.uid)}),this.pendingRemoteTracks=[]}async unpublish(e){if(!this.connection||this.state!==Qn.Connected)return void e.forEach(s=>{const l=this.pendingLocalTracks.indexOf(s);l!==-1&&this.pendingLocalTracks.splice(l,1)});const t=this.filterTobeUnpublishedTracks(e);if(t.length===0)return;const r=t.find(s=>s[0]==="videoLowTrack");return r&&r[1].track.close(),this.doUnpublish(this.connection,t)}async unpublishDataChannel(e){if(!this.connection||this.state!==Qn.Connected)return void e.forEach(r=>{const s=this.pendingLocalDataChannels.indexOf(r);s!==-1&&this.pendingLocalDataChannels.splice(s,1)});const t=this.filterTobeUnpublishedDataChannels(e);return t.length!==0?(t.forEach(r=>{const s=this.localDataChannels.indexOf(r);s!==-1&&this.localDataChannels.splice(s,1)}),this.localDataChannels.length===0&&await this.connection.stopDataChannels(this.store.uid),t.map(r=>r.id)):void 0}async unpublishLowStream(){if(!this.connection||this.state!==Qn.Connected)return;const e=this.localTrackMap.get(at.LocalVideoLowTrack);if(!e)return;e.track.close();const t=[[at.LocalVideoLowTrack,e]];return this.doUnpublish(this.connection,t)}async doUnpublish(e,t){const r=this.createGatewayUnpublishMessage(t);return await e.stopSending(t.map(s=>{let[,{id:l}]=s;return l})),this.withdrawLocalTracks(t),this.unbindLocalTrackEvents(t.map(s=>{let[l,{track:f}]=s;return{type:l,track:f}})),t.forEach(s=>{let[l]=s;this.statsCollector.removeLocalStats(l)}),this.localTrackMap.size===0&&this.statsUploader.stopUploadOutboundStats(),r}async subscribeDataChannel(e,t){if(!this.connection||this.state!==Qn.Connected)throw new Ke(se.INVALID_OPERATION,"Cannot subscribe remote user when peerConnection disconnected.");const r=t.filter(s=>{var l;return!((l=this.remoteDataChannelMap.get(e))!==null&&l!==void 0&&l.get(s.id))});if(r.length!==0)return await this.connection.createDataChannels(e.uid,r),r.forEach(s=>{var l;this.remoteDataChannelMap.has(e)?(l=this.remoteDataChannelMap.get(e))===null||l===void 0||l.set(s.id,s):this.remoteDataChannelMap.set(e,new Map([[s.id,s]]));const f=this.pendingRemoteDataChannels.findIndex(m=>{let{user:E,id:y}=m;return E.uid===e.uid&&y===s.id});f!==-1&&this.pendingRemoteDataChannels.splice(f,1)}),r.map(s=>s.id)}async subscribe(e,t,r,s,l){var f;if(!this.connection||this.state!==Qn.Connected)throw new Ke(se.INVALID_OPERATION,"Cannot subscribe remote user when peerConnection disconnected.");if((f=this.remoteUserMap.get(e))!==null&&f!==void 0&&f.has(t))return;let m,E,y;const b=this.connection.getPreMedia(r);if(b)G.debug("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] preSSRCMap has ssrcId: ").concat(r,", no need to send sub to gateway.")),y=b.transceiver,m=b.track,E=b.id;else if(l){const D=l.find(F=>{let{stream_type:B}=F;return B===t});if(!D)throw new Ke(se.UNEXPECTED_ERROR,"Cannot subscribe to remote ".concat(t," for user: ").concat(e.uid," because subscribe answer from gateway does not contain stream_type: ").concat(t,"."));const P=await this.connection.receive(t,D.ssrcs,String(e._uintid),D.attributes);this.connection instanceof Kc&&(y=P.transceiver),m=P.track,E=P.id}else{const D=await this.connection.receive(t,[{ssrcId:r,rtx:s}],String(e._uintid),void 0);this.connection instanceof Kc&&(y=D.transceiver),m=D.track,E=D.id}if(t===ut.AUDIO?(e._audioTrack?e._audioTrack._updateOriginMediaStreamTrack(m):(e._audioTrack=new $u(m,e.uid,e._uintid,this.store),G.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote audio track: ").concat(e._audioTrack.getTrackId()))),y&&e._audioTrack._updateRtpTransceiver(y),this.bindRemoteTrackEvents(e,e._audioTrack)):(e._videoTrack?e._videoTrack._updateOriginMediaStreamTrack(m):(e._videoTrack=new xg(m,e.uid,e._uintid,this.store),G.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote video track: ").concat(e._videoTrack.getTrackId()))),y&&e._videoTrack._updateRtpTransceiver(y),this.bindRemoteTrackEvents(e,e._videoTrack)),y&&me("ENABLE_ENCODED_TRANSFORM")){const{interceptRemoteVideoFrame:D,interceptRemoteAudioFrame:P}=PI();t==ut.VIDEO?await D(y.receiver,{onSei:me("ENABLE_VIDEO_SEI")&&(F=>{var B;return(B=e._videoTrack)===null||B===void 0?void 0:B._onSei(F)})}):t==ut.AUDIO&&await P(y.receiver,{enableTopn:!!me("ENABLE_AUDIO_TOPN"),enableMetadata:!!me("ENABLE_AUDIO_METADATA"),onMetadata:F=>{this.safeEmit(Yt.AudioMetadata,F)}})}const A=this.remoteUserMap.get(e);A?A.set(t,E):this.remoteUserMap.set(e,new Map([[t,E]])),this.statsCollector.addRemoteStats(e.uid),this.statsUploader.startUploadInboundStats();const O=this.pendingRemoteTracks.findIndex(D=>{let{user:P,kind:F}=D;return P.uid===e.uid&&t===F});O!==-1&&(this.pendingRemoteTracks.splice(O,1),this.emit(Yt.MediaReconnectEnd,e.uid))}async massSubscribe(e){return this.massSubscribeNoLock(e)}async massSubscribeNoLock(e){if(!this.connection||this.state!==Qn.Connected)throw new Ke(se.INVALID_OPERATION,"Cannot subscribeAll remote users when peerConnection disconnected.");e=e.filter(l=>{var f;let{user:m,mediaType:E}=l;return!((f=this.remoteUserMap.get(m))!==null&&f!==void 0&&f.has(E))});const t=[],r=new Map;e.forEach(l=>{if(!this.connection)return;const f=this.connection.getPreMedia(l.ssrcId);f?r.set(l.ssrcId,f):t.push(l)});const s=await this.connection.batchReceive(t.map(l=>{let{user:f,mediaType:m,ssrcId:E,rtxSsrcId:y}=l;return{kind:m,ssrcMsg:[{ssrcId:E,rtx:y}],mslabel:String(f._uintid)}}));t.forEach((l,f)=>{r.set(l.ssrcId,s[f])});for(const{user:l,mediaType:f,ssrcId:m}of e){const E=r.get(m);if(!E)return void G.debug("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] cannot find ").concat(l.uid," subscribe data,").concat(f,", ").concat(m));const{track:y,id:b,transceiver:A}=E;if(A&&me("ENABLE_ENCODED_TRANSFORM")){const{interceptRemoteVideoFrame:P,interceptRemoteAudioFrame:F}=PI();f==ut.VIDEO?await P(A.receiver,{onSei:me("ENABLE_VIDEO_SEI")&&(B=>{var Y;return(Y=l._videoTrack)===null||Y===void 0?void 0:Y._onSei(B)})}):f==ut.AUDIO&&await F(A.receiver,{enableTopn:!!me("ENABLE_AUDIO_TOPN"),enableMetadata:!!me("ENABLE_AUDIO_METADATA"),onMetadata:B=>{this.safeEmit(Yt.AudioMetadata,B)}})}if(f===ut.AUDIO?(l._audioTrack?l._audioTrack._updateOriginMediaStreamTrack(y):(l._audioTrack=new $u(y,l.uid,l._uintid,this.store),G.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote audio track: ").concat(l._audioTrack.getTrackId()))),A&&l._audioTrack._updateRtpTransceiver(A),this.bindRemoteTrackEvents(l,l._audioTrack)):(l._videoTrack?l._videoTrack._updateOriginMediaStreamTrack(y):(l._videoTrack=new xg(y,l.uid,l._uintid,this.store),G.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote video track: ").concat(l._videoTrack.getTrackId()))),A&&l._videoTrack._updateRtpTransceiver(A),this.bindRemoteTrackEvents(l,l._videoTrack)),me("ENABLE_VIDEO_SEI")&&A){const{interceptRemoteVideoFrame:P,interceptRemoteAudioFrame:F}=PI();f==ut.VIDEO?await P(A.receiver,{onSei:B=>{var Y;(Y=l._videoTrack)===null||Y===void 0||Y._onSei(B)}}):f==ut.AUDIO&&await F(A.receiver)}const O=this.remoteUserMap.get(l);O?O.set(f,b):this.remoteUserMap.set(l,new Map([[f,b]])),this.statsCollector.addRemoteStats(l.uid),this.statsUploader.startUploadInboundStats();const D=this.pendingRemoteTracks.findIndex(P=>{let{user:F,kind:B}=P;return F.uid===l.uid&&f===B});D!==-1&&(this.pendingRemoteTracks.splice(D,1),this.emit(Yt.MediaReconnectEnd,l.uid))}}async unsubscribe(e,t,r){const s=this.pendingRemoteTracks.filter(m=>{let{user:E,kind:y}=m;return t!==void 0?E.uid===e.uid&&t===y:E.uid===e.uid});if(s.forEach(m=>{const E=this.pendingRemoteTracks.indexOf(m);this.pendingRemoteTracks.splice(E,1)}),this.connection&&this.state===Qn.Connected||r||s.forEach(m=>{let{kind:E}=m;var y;if(E===ut.AUDIO)(y=e._audioTrack)===null||y===void 0||y._destroy(),e._audioTrack=void 0;else if(E===ut.VIDEO){var b;(b=e._videoTrack)===null||b===void 0||b._destroy(),e._videoTrack=void 0}}),!this.connection||this.state!==Qn.Connected)return;const l=this.filterTobeUnSubscribedTracks(e,t);if(l.length===0)return;await this.connection.stopReceiving(l.map(m=>{let[,{id:E}]=m;return E}));const f=this.createUnsubscribeMessage(l);return this.withdrawRemoteTracks(l),this.remoteUserMap.size===0&&this.statsUploader.stopUploadInboundStats(),l.forEach(m=>{let[E,{kind:y}]=m;var b,A;if(y===ut.VIDEO&&E._videoSSRC&&((b=this.connection)===null||b===void 0||b.setStatsRemoteVideoIsReady(E._videoSSRC,!1)),y===ut.VIDEO)this.unbindRemoteTrackEvents(E._videoTrack),r||((A=E._videoTrack)===null||A===void 0||A._destroy(),E._videoTrack=void 0);else if(y===ut.AUDIO){var O;this.unbindRemoteTrackEvents(E._audioTrack),!r&&((O=E._audioTrack)===null||O===void 0||O._destroy(),E._audioTrack=void 0)}}),f}async unsubscribeDataChannel(e,t){if(t.forEach(l=>{const f=this.pendingRemoteDataChannels.findIndex(m=>m.id===l.id);f!==-1&&this.pendingRemoteDataChannels.splice(f,1)}),!this.connection)return;const r=this.filterTobeUnSubscribedDataChannels(e,t);if(r.length===0)return;t.forEach(l=>{l._close()});const s=this.remoteDataChannelMap.get(e);return r.forEach(l=>{s&&s.delete(l.id)}),s&&s.size===0&&(this.remoteDataChannelMap.delete(e),await this.connection.stopDataChannels(e.uid)),r.map(l=>l.id)}async massUnsubscribe(e){return this.massUnsubscribeNoLock(e)}async massUnsubscribeNoLock(e){let t=[];for(const{user:l,mediaType:f}of e){const m=this.pendingRemoteTracks.filter(E=>{let{user:y,kind:b}=E;return f!==void 0?y.uid===l.uid&&f===b:y.uid===l.uid});m.forEach(E=>{const y=this.pendingRemoteTracks.indexOf(E);this.pendingRemoteTracks.splice(y,1)}),t=t.concat(m)}if(!this.connection||this.state!==Qn.Connected)return void t.forEach(l=>{let{user:f,kind:m}=l;var E;if(m===ut.AUDIO)(E=f._audioTrack)===null||E===void 0||E._destroy(),f._audioTrack=void 0;else if(m===ut.VIDEO){var y;(y=f._videoTrack)===null||y===void 0||y._destroy(),f._videoTrack=void 0}});const r=wc(e).call(e,(l,f)=>{let{user:m,mediaType:E}=f;const y=this.filterTobeUnSubscribedTracks(m,E);return l.concat(y)},[]);if(r.length===0)return;await this.connection.stopReceiving(r.map(l=>{let[,{id:f}]=l;return f}));const s=this.createUnsubscribeAllMessage(r);return this.withdrawRemoteTracks(r),this.remoteUserMap.size===0&&this.statsUploader.stopUploadInboundStats(),r.forEach(l=>{let[f,{kind:m}]=l;var E,y;if(m===ut.VIDEO&&f._videoSSRC&&((E=this.connection)===null||E===void 0||E.setStatsRemoteVideoIsReady(f._videoSSRC,!1)),m===ut.VIDEO)this.unbindRemoteTrackEvents(f._videoTrack),(y=f._videoTrack)===null||y===void 0||y._destroy(),f._videoTrack=void 0;else if(m===ut.AUDIO){var b;this.unbindRemoteTrackEvents(f._audioTrack),(b=f._audioTrack)===null||b===void 0||b._destroy(),f._audioTrack=void 0}}),s}isPreSubScribe(e){return!this.connection||this.state!==Qn.Connected?!1:!!this.connection.getPreMedia(e)}async muteRemote(e,t){if(!this.connection)return;const r=this.remoteUserMap.get(e);if(!r)return void G.warning("[".concat(this.store.clientId,"] P2PChannel.muteRemote has no remote user ").concat(e.uid,"."));if(!r.get(t))return void G.warning("[".concat(this.store.clientId,"] P2PChannel.muteRemote has no remote user ").concat(e.uid," media type ").concat(t,"."));const s=t===ut.VIDEO?e._videoSSRC:e._audioSSRC;s!==void 0&&this.connection.setStatsRemoteVideoIsReady(s,!1)}async unmuteRemote(e,t){return this.unmuteRemoteNoLock(e,t)}async unmuteRemoteNoLock(e,t){if(!this.connection)return;const r=this.remoteUserMap.get(e);if(!r)return void G.warning("[".concat(this.store.clientId,"] P2PChannel.unmuteRemote has no remote user ").concat(e.uid,"."));r.get(t)||G.warning("[".concat(this.store.clientId,"] P2PChannel.unmuteRemote has no remote user ").concat(e.uid," media type ").concat(t,"."))}addAudioMetadata(e){const t=this.localTrackMap.get(at.LocalAudioTrack),r=t&&t.track;r&&r.metadata.push(e)}getAllTracks(e){const t=this.localTrackMap.get(at.LocalAudioTrack);if((t==null?void 0:t.track)instanceof Sa){const r=t.track;return Array.from(this.localTrackMap.entries()).filter(s=>{let[l]=s;return l!==at.LocalAudioTrack}).filter(s=>{let[l]=s;return!(e&&l===at.LocalVideoLowTrack)}).map(s=>{let[,{track:l}]=s;return l}).concat(r.trackList)}return Array.from(this.localTrackMap.entries()).filter(r=>{let[s]=r;return!(e&&s===at.LocalVideoLowTrack)}).map(r=>{let[,{track:s}]=r;return s})}getAllDataChannels(){return this.localDataChannels}reportPublishEvent(e,t,r,s,l){if(e){const m=this.localTrackMap.get(at.LocalAudioTrack),E=s?this.localTrackMap.get(at.LocalVideoLowTrack):this.localTrackMap.get(at.LocalVideoTrack);Vt.publish(this.store.sessionId,{eventElapse:ws.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:e,ec:t,audioName:m==null?void 0:m.track.getTrackLabel(),videoName:E==null?void 0:E.track.getTrackLabel(),screenshare:(E==null?void 0:E.track._hints.indexOf(xr.SCREEN_TRACK))!==-1,audio:!!m,video:!!E,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:l})}else{var f;r||(r=[]);const m=r.find(y=>y instanceof ji),E=s?(f=this.localTrackMap.get(at.LocalVideoTrack))===null||f===void 0?void 0:f.track:r.find(y=>y instanceof Kr);Vt.publish(this.store.sessionId,{eventElapse:ws.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:e,ec:t,audioName:m==null?void 0:m.getTrackLabel(),videoName:E==null?void 0:E.getTrackLabel(),screenshare:(E==null?void 0:E._hints.indexOf(xr.SCREEN_TRACK))!==-1,audio:!!m,video:!!E,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:l})}}reportSubscribeEvent(e,t,r,s){const l=s===ut.VIDEO?r._videoSSRC:r._audioSSRC;l&&Vt.subscribe(this.store.sessionId,{succ:e,ec:t,video:s===ut.VIDEO,audio:s===ut.AUDIO,peerid:r.uid,subscribeRequestid:l,p2pid:this.store.p2pId,eventElapse:ws.measureFromSubscribeStart(this.store.clientId,l),preSsrc:this.isPreSubScribe(l)})}reset(){G.debug("[".concat(this.store.clientId,"] P2PChannel.reset")),this.mutex=new Gi("P2PChannel-mutex",this.store.clientId),this.connection&&(this.resetConnection(this.connection),this.connection=void 0),this.shouldForwardP2PCreation&&(this.connection=cu(this.store),this.emit(Yt.PeerConnectionStateChange,this.connection.peerConnectionState),this.bindConnectionEvents(this.connection)),this.statsUploader.stopUploadOutboundStats(),this.statsUploader.stopUploadInboundStats(),this.statsUploader.stopUploadTransportStats(),this.statsUploader.stopUploadExtensionUsageStats(),this.statsUploader.stopUploadBaseStats(),this.unbindLocalTrackEvents(),this.unbindAllRemoteTrackEvents(),this.unbindRtpTransceiver();const e=this.localTrackMap.get(at.LocalAudioTrack);if((e==null?void 0:e.track)instanceof Sa){if(e.track.trackList.length>0){const t=e.track;e.track.trackList.forEach(r=>{t.removeAudioTrack(r)})}e.track.close()}this.localTrackMap.clear(),this.remoteUserMap.clear(),this.statsCollector.removeRemoteStats(),this.statsCollector.removeLocalStats(),this.iceFailedCount=0,this.dtlsFailedCount=0,this.pendingLocalTracks=[],this.pendingRemoteTracks=[],this.localDataChannels=[],this.remoteDataChannelMap.clear(),this.pendingLocalDataChannels=[],this.pendingRemoteDataChannels=[],this.state=Qn.Disconnected}getStats(){var e;return(e=this.connection)===null||e===void 0?void 0:e.getStats()}getRemoteVideoIsReady(e){var t;return((t=this.connection)===null||t===void 0?void 0:t.getRemoteVideoIsReady(e))||!1}getLocalAudioVolume(){const e=this.localTrackMap.get(at.LocalAudioTrack);if(e)return e.track.getVolumeLevel()}getLocalVideoSize(){const e=this.localTrackMap.get(at.LocalVideoTrack);if(e)return{width:e.track.videoWidth||0,height:e.track.videoHeight||0}}getEncoderConfig(e){const t=this.localTrackMap.get(e);return t&&t.track instanceof Kr||t&&t.track instanceof ji?t.track._encoderConfig:void 0}getLocalMedia(e){return this.localTrackMap.get(e)}hasLocalMedia(){return this.localTrackMap.size>0}hasRemoteMedia(e,t){if(!e)return this.remoteUserMap.size>0;const r=this.remoteUserMap.get(e);return!!r&&(!t||r.has(t))}async hasRemoteMediaWithLock(e,t){if(!e)return this.remoteUserMap.size>0;const r=this.remoteUserMap.get(e);return!!r&&(!t||r.has(t))}getRemoteMedia(e){var t;const r=Array.from(Sl(t=this.remoteUserMap).call(t)).find(s=>s.uid===e);return r?{audioTrack:r.audioTrack,audioSSRC:r._audioSSRC,videoTrack:r.videoTrack,videoSSRC:r._videoSSRC}:{}}getAudioLevels(){let e=Array.from(this.remoteUserMap.entries()).map(r=>{let[s]=r;return{uid:s.uid,level:s.audioTrack?100*s.audioTrack._source.getAccurateVolumeLevel():0}});const t=this.localTrackMap.get(at.LocalAudioTrack);return t&&e.push({level:100*t.track._source.getAccurateVolumeLevel(),uid:this.store.uid}),e=sn(e).call(e,(r,s)=>r.level-s.level),e}async disconnectForReconnect(){this.connection&&(G.debug("[".concat(this.store.clientId,"] P2PChannel.disconnectForReconnect closing P2PConnection")),this.state=Qn.Reconnecting,me("KEEP_LAST_FRAME")&&this.remoteUserMap.size!==0&&Array.from(this.remoteUserMap.entries()).forEach(e=>{let[t]=e;var r;t._videoTrack&&t._videoTrack._player&&((r=t._videoTrack._player.getVideoElement())===null||r===void 0||r.pause(),t._videoTrack._player.isKeepLastFrame=!0,t._videoTrack._originMediaStreamTrack.stop())}),this.resetConnection(this.connection),this.connection=void 0,this.shouldForwardP2PCreation&&(this.connection=cu(this.store),this.emit(Yt.PeerConnectionStateChange,this.connection.peerConnectionState),this.bindConnectionEvents(this.connection)),this.localTrackMap.size!==0&&(Array.from(this.localTrackMap.entries()).forEach(e=>{var t;let[r,{track:s}]=e;switch(r){case at.LocalVideoTrack:ht(t=s._hints).call(t,xr.LOW_STREAM)?s.close():this.pendingLocalTracks.push(s);break;case at.LocalAudioTrack:s instanceof Sa?this.pendingLocalTracks=this.pendingLocalTracks.concat(s.trackList):this.pendingLocalTracks.push(s);case at.LocalVideoLowTrack:}}),this.emit(Yt.MediaReconnectStart,this.store.uid)),this.unbindLocalTrackEvents(),this.localTrackMap.clear(),this.remoteUserMap.size!==0&&Array.from(this.remoteUserMap.entries()).forEach(e=>{let[t,r]=e;Array.from(Sl(r).call(r)).forEach(s=>{this.setPendingRemoteMedia(t,s)}),this.emit(Yt.MediaReconnectStart,t.uid)}),this.unbindAllRemoteTrackEvents(),this.remoteUserMap.clear(),this.localDataChannels.length!==0&&(this.localDataChannels.forEach(e=>{this.pendingLocalDataChannels.push(e)}),this.localDataChannels.length=0),this.remoteDataChannelMap.size!==0&&(Array.from(this.remoteDataChannelMap.entries()).forEach(e=>{let[t,r]=e;Array.from(Sl(r).call(r)).forEach(s=>{this.setPendingRemoteDataChannel(t,s)})}),this.remoteDataChannelMap.clear()),this.statsUploader.stopUploadOutboundStats(),this.statsUploader.stopUploadInboundStats(),this.statsUploader.stopUploadTransportStats(),G.debug("[".concat(this.store.clientId,"] P2PChannel disconnected, waiting to reconnect.")))}hasPendingRemoteDataChannel(e,t){for(const r of this.pendingRemoteDataChannels){const{user:s,id:l}=r;if((e instanceof K_?e.uid:e)===s.uid&&l===t)return!0}return!1}setPendingRemoteDataChannel(e,t){this.hasPendingRemoteDataChannel(e,t)||this.pendingRemoteDataChannels.push({user:e,id:t})}hasPendingRemoteMedia(e,t){for(const r of this.pendingRemoteTracks){const{user:s,kind:l}=r;if((e instanceof K_?e.uid:e)===s.uid&&t===l)return!0}return!1}setPendingRemoteMedia(e,t){this.hasPendingRemoteMedia(e,t)||this.pendingRemoteTracks.push({user:e,kind:t})}restartICE(e){var t=this;return $l(function*(){if(!t.connection||t.state!==Qn.Connected)return;const r=yield xn(t.mutex.lock("From P2PChannel.restartICE"));let s;try{s=yield xn(t.connection.restartICE(e));const f=yield xn(s.next());if(f.done)return;const m=f.value,E=yield m;switch(Ro(t.connection)&&t.reportPCStats(Date.now(),!1,t._pcStatsUploadType),e){case Ua.UDP_TCP_RELAY:t._pcStatsUploadType=zc.UDP_TCP_RESTART;break;case Ua.TCP_RELAY:t._pcStatsUploadType=zc.TCP_RESTART;break;case Ua.RELAY:t._pcStatsUploadType=zc.RELAY_RESTART;break;default:t._pcStatsUploadType=zc.OLD_RESTART}t._isTryConnecting=!0,s.next(E)}catch(f){var l;(l=s)===null||l===void 0||l.throw(f)}finally{r()}})()}getUplinkNetworkQuality(){if(!this.connection)return 0;const e=this.connection.getStats(),t=this.localTrackMap.get(at.LocalVideoTrack),r=this.localTrackMap.get(at.LocalAudioTrack),s=e.videoSend.find(P=>P.ssrc===(t==null?void 0:t.ssrcs[0].ssrcId)),l=e.audioSend.find(P=>P.ssrc===(r==null?void 0:r.ssrcs[0].ssrcId));if(!s||!l)return 1;const f=Gs(this,Yt.NeedSignalRTT),m=s?s.rttMs:void 0,E=l?l.rttMs:void 0,y=m&&E?(m+E)/2:m||E,b=(y&&f?(y+f)/2:y||f)||0,A=100*e.sendPacketLossRate*.7/50+.3*b/1500,O=A<.17?1:A<.36?2:A<.59?3:A<.1?4:5,D=t==null?void 0:t.track;if(D&&D._encoderConfig&&D._hints.indexOf(xr.SCREEN_TRACK)===-1){const P=D._encoderConfig.bitrateMax,F=e.bitrate.actualEncoded;if(P&&F){const B=(1e3*P-F)/(1e3*P);return M8[B<.15?0:B<.3?1:B<.45?2:B<.6?3:4][O]}}return O}getDownlinkNetworkQuality(){if(!this.connection)return 0;const e=this.connection.getStats();let t=0;return Array.from(this.remoteUserMap.entries()).forEach(r=>{let[s]=r;const l=s._audioSSRC,f=s._videoSSRC,m=e.audioRecv.find(F=>F.ssrc===l),E=e.videoRecv.find(F=>F.ssrc===f);if(!m&&!E)return void(t+=1);const y=Gs(this,Yt.NeedSignalRTT),b=e.rtt,A=(b&&y?(b+y)/2:b||y)||0,O=m?m.jitterMs:void 0,D=e.recvPacketLossRate;let P=.7*D*100/50+.3*A/1500;O&&(P=.6*D*100/50+.2*A/1500+.2*O/400),t+=P<.1?1:P<.17?2:P<.36?3:P<.59?4:5}),this.remoteUserMap.size>0?Math.round(t/this.remoteUserMap.size):t}async muteLocalTrack(e){return new gt((t,r)=>{this.handleMuteLocalTrack(e,t,r)})}async replaceTrack(e,t){var r;if(G.debug("[".concat(this.store.clientId,"] P2PChannel replaceTrack from [").concat(e.getTrackId(),"] to [").concat(t.getTrackId(),"]")),!this.connection||this.state!==Qn.Connected)return;const s=Array.from(this.localTrackMap.entries()).find(f=>{let[,{track:m}]=f;return e===m});if(!s)return;const l=s[0];if(e!==t&&(this.unbindLocalTrackEvents([{track:e,type:l}]),this.bindLocalTrackEvents([{track:t,type:l}]),s[1].track=t),await((r=this.connection)===null||r===void 0?void 0:r.replaceTrack(t,s[1].id)),this.isPlanB){const f=s[1];f.id=t._mediaStreamTrack.id,this.localTrackMap.set(l,f)}if(l===at.LocalVideoTrack&&!me("DISABLE_DUAL_STREAM_USE_ENCODING")&&zn().supportDualStreamEncoding){const f=this.localTrackMap.get(at.LocalVideoLowTrack);if(f){const m=e._mediaStreamTrack.clone();f.track._originMediaStreamTrack.stop(),f.track._mediaStreamTrack=m,f.track._originMediaStreamTrack=m,await new gt((E,y)=>{this.handleReplaceTrack(f.track,E,y,!0)})}}}filterTobePublishedTracks(e,t,r){const s=[],l=this.getAllTracks();e=yS(e=e.filter(y=>l.indexOf(y)===-1));let f,m=!1;const E=this.localTrackMap.get(at.LocalAudioTrack);for(const y of e){if(y instanceof Kr&&(this.localTrackMap.has(at.LocalVideoTrack)||m?new Ke(se.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS).throw():(s.push({track:y,type:at.LocalVideoTrack}),m=!0),t)){const b=this.getLowVideoTrack(y,r);s.push({track:b,type:at.LocalVideoLowTrack})}if(y instanceof ji)if(E){const b=E.track;if(b instanceof Sa)Qi([y]),b.addAudioTrack(y),this.bindLocalAudioTrackEvents(y,!0);else{const A=qg([b,y]);G.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection will replace audioTrack [").concat(A.getTrackId(),"]")),this.replaceTrack(b,A)}}else f instanceof Sa?(Qi([y]),f.addAudioTrack(y)):f||!y._useAudioElement&&zn().webAudioMediaStreamDest&&!y._bypassWebAudio?f=qg(f?[y,f]:[y]):f=y}return f&&(G.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection will send audioTrack [").concat(f.getTrackId(),"]")),s.push({track:f,type:at.LocalAudioTrack})),s}filterTobeUnpublishedTracks(e){const t=[],r=this.getAllTracks();e=yS(e=e.filter(s=>r.indexOf(s)!==-1));for(const s of e){if(s instanceof ji){const l=this.localTrackMap.get(at.LocalAudioTrack);if(!l)continue;l.track instanceof Sa?(l.track.removeAudioTrack(s),this.unbindLocalAudioTrackEvents(s),l.track.trackList.length===0&&(t.push([at.LocalAudioTrack,l]),l.track.close())):t.push([at.LocalAudioTrack,l])}if(s instanceof Kr){const l=this.localTrackMap.get(at.LocalVideoTrack);if(!l)continue;t.push([at.LocalVideoTrack,l]);const f=this.localTrackMap.get(at.LocalVideoLowTrack);f&&t.push([at.LocalVideoLowTrack,f])}}return t}filterTobePublishedDataChannels(e){return e=(e=yS(e)).filter(t=>this.localDataChannels.findIndex(r=>r.id===t.id)===-1)}filterTobeUnpublishedDataChannels(e){return e=(e=(e=yS(e)).filter(t=>this.localDataChannels.indexOf(t)!==-1)).filter(t=>t._originDataChannel)}bindLocalTrackEvents(e){e.forEach(t=>{let{track:r,type:s}=t;switch(s){case at.LocalVideoTrack:r.addListener(Dt.GET_STATS,this.handleGetLocalVideoStats),r.addListener(Dt.GET_RTC_STATS,this.handleGetRTCStats),r.addListener(Dt.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),r.addListener(Dt.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),r.addListener(Dt.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),r.addListener(Dt.NEED_UPDATE_VIDEO_SEND_PARAMETERS,this.handleUpdateVideoSendParameters),r.addListener(Dt.NEED_REPLACE_TRACK,this.handleReplaceTrack),r.addListener(Dt.NEED_MUTE_TRACK,this.handleMuteLocalTrack),r.addListener(Dt.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case at.LocalAudioTrack:this.bindLocalAudioTrackEvents(r);case at.LocalVideoLowTrack:}})}bindLocalAudioTrackEvents(e,t){e instanceof Sa?e.trackList.forEach(r=>{r.addListener(Dt.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),r.addListener(Dt.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),r.addListener(Dt.GET_STATS,this.handleGetLocalAudioStats),r.addListener(Dt.NEED_MUTE_TRACK,this.handleMuteLocalTrack),r.addListener(Dt.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):(e.addListener(Dt.GET_STATS,this.handleGetLocalAudioStats),e.addListener(Dt.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),e.addListener(Dt.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),e.addListener(Dt.NEED_MUTE_TRACK,this.handleMuteLocalTrack),e.addListener(Dt.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack),t||(e.addListener(Dt.NEED_REPLACE_TRACK,this.handleReplaceTrack),e.addListener(Dt.NEED_REPLACE_MIXING_TRACK,this.handleReplaceMixingTrack)))}unbindLocalTrackEvents(e){e||(e=Array.from(this.localTrackMap.entries()).map(t=>{let[r,{track:s}]=t;return{track:s,type:r}})),e.forEach(t=>{let{track:r,type:s}=t;switch(s){case at.LocalVideoTrack:r.off(Dt.GET_STATS,this.handleGetLocalVideoStats),r.off(Dt.GET_RTC_STATS,this.handleGetRTCStats),r.off(Dt.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),r.off(Dt.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),r.off(Dt.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),r.off(Dt.NEED_UPDATE_VIDEO_SEND_PARAMETERS,this.handleUpdateVideoSendParameters),r.off(Dt.NEED_REPLACE_TRACK,this.handleReplaceTrack),r.off(Dt.NEED_MUTE_TRACK,this.handleMuteLocalTrack),r.off(Dt.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case at.LocalAudioTrack:this.unbindLocalAudioTrackEvents(r);case at.LocalVideoLowTrack:}})}unbindLocalAudioTrackEvents(e){e instanceof Sa?e.trackList.forEach(t=>{t.off(Dt.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),t.off(Dt.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),t.off(Dt.GET_STATS,this.handleGetLocalAudioStats),t.off(Dt.NEED_MUTE_TRACK,this.handleMuteLocalTrack),t.off(Dt.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):(e.off(Dt.GET_STATS,this.handleGetLocalAudioStats),e.off(Dt.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),e.off(Dt.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),e.off(Dt.NEED_REPLACE_TRACK,this.handleReplaceTrack),e.off(Dt.NEED_REPLACE_MIXING_TRACK,this.handleReplaceMixingTrack),e.off(Dt.NEED_MUTE_TRACK,this.handleMuteLocalTrack),e.off(Dt.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack))}bindRemoteTrackEvents(e,t){t instanceof xg&&t.addListener(Dt.GET_STATS,r=>{r(this.handleGetRemoteVideoStats(e))}),t instanceof $u&&t.addListener(Dt.GET_STATS,r=>{r(this.handleGetRemoteAudioStats(e))})}unbindRemoteTrackEvents(e){e&&e.removeAllListeners(Dt.GET_STATS)}unbindAllRemoteTrackEvents(){Array.from(this.remoteUserMap.entries()).forEach(e=>{let[t,r]=e;r.has(ut.AUDIO)&&this.unbindRemoteTrackEvents(t._audioTrack),r.has(ut.VIDEO)&&this.unbindRemoteTrackEvents(t._videoTrack)})}createGatewayPublishMessage(e,t){return e.map((r,s)=>{var l;let f,m,{track:E,type:y}=r;switch(y){case at.LocalAudioTrack:f=Er.Audio,m={dtx:E instanceof t1&&E._config.DTX,hq:!1,lq:!1,stereo:!1,speech:!1};break;case at.LocalVideoTrack:f=ht(l=E._hints).call(l,xr.SCREEN_TRACK)?Er.Screen:Er.High,m=ff(ff({},Vg(E)),{},{codec:this.store.codec,svc_mode:u1()});break;case at.LocalVideoLowTrack:f=Er.Low,m=ff(ff({},Vg(E)),{},{codec:this.store.codec,svc_mode:u1()})}return{stream_type:f,attributes:m,ssrcs:t[s]}})}createGatewayUnpublishMessage(e){return e.map(t=>{var r;let s,[l,{track:f,ssrcs:m,id:E}]=t;switch(l){case at.LocalVideoTrack:s=ht(r=f._hints).call(r,xr.SCREEN_TRACK)?Er.Screen:Er.High;break;case at.LocalAudioTrack:s=Er.Audio;break;case at.LocalVideoLowTrack:s=Er.Low}return{stream_type:s,ssrcs:m,mid:E}})}assignLocalTracks(e,t){e.forEach((r,s)=>{let{track:l,type:f}=r;this.localTrackMap.set(f,{track:l,id:t[s].id,ssrcs:t[s].localSSRC})})}withdrawLocalTracks(e){e.forEach(t=>{let[r]=t;this.localTrackMap.delete(r)})}bindConnectionEvents(e){e.onConnectionStateChange=async t=>{if(G.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onConnectionStateChange(").concat(t,")")),this.emit(Yt.PeerConnectionStateChange,t),t==="connecting"&&e instanceof Kc&&!ei()&&me("FIRST_TCP_CANDIDATE")&&window.setTimeout(()=>{t==="connecting"&&e.extendCandidate()},me("FIRST_TCP_CANDIDATE_INTERVAL")),t!=="connected"||this.store.keyMetrics.peerConnectionEnd||this.store.peerConnectionEnd(),t==="connected"&&(this._restartTimer&&(window.clearTimeout(this._restartTimer),this._restartTimer=void 0),e instanceof Kc&&XU(e,!0),this._isTryConnecting&&this.reportPCStats(Date.now(),!0,this._pcStatsUploadType),this._isTryConnecting=!1,this._isStartRestartIce=!1,this._pcStatsUploadType=zc.DISCONNECTED_OR_FAILED,Gs(this,Yt.QueryClientConnectionState)==="CONNECTED"&&this._isWaitPcToRePub)){const r=this.pendingLocalTracks.map(l=>l.getTrackId()),s=this.pendingLocalDataChannels.map(l=>"dc_".concat(l.id));Vt.reportApiInvoke(this.store.sessionId,{name:Di.REPUB_AFTER_PC_CONNECTED,options:r.concat(s),tag:Bn.TRACER}).onSuccess(),this.republish()}if(me("NEW_ICE_RESTART")&&e instanceof Kc&&!ei()&&!this._forceTurn){if(ht(F8).call(F8,t)){if(this._isStartRestartIce)return;this._isStartRestartIce=!0;const r=l=>{Ro(e)&&(G.debug("[".concat(this.store.clientId,"] [P2PChannel] try to restartICE, type is ").concat(l)),Gs(this,Yt.QueryClientConnectionState)==="CONNECTED"&&this.emit(Yt.RequestRestartICE,l))},s=()=>{Ro(e)&&(this.reportPCStats(Date.now(),!1,this._pcStatsUploadType),G.debug("[".concat(this.store.clientId,"] P2PConnection disconnected timeout, force reconnect")),setTimeout(()=>this.emit(Yt.P2PLost),0),this.iceFailedCount+=1,this.requestReconnect())};return void(this._restartTimer=window.setTimeout(()=>{QU(e,r,s)},800))}}else{if(t==="disconnected"&&e.iceConnectionState==="disconnected")return setTimeout(()=>{e.iceConnectionState==="disconnected"&&me("ICE_RESTART")&&Gs(this,Yt.QueryClientConnectionState)==="CONNECTED"&&this.emit(Yt.RequestRestartICE)},800),void setTimeout(()=>{e.peerConnectionState==="disconnected"&&(G.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection disconnected timeout 4000ms, force reconnect")),this.reportPCStats(Date.now(),!1,this._pcStatsUploadType),this._isTryConnecting=!1,setTimeout(()=>this.emit(Yt.P2PLost),0),this.iceFailedCount+=1,this.requestReconnect())},4e3);t==="failed"&&(G.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection state failed, force reconnect")),this.reportPCStats(Date.now(),!1,this._pcStatsUploadType),setTimeout(()=>this.emit(Yt.P2PLost),0),this.iceFailedCount+=1,await this.requestReconnect())}},e.onICEConnectionStateChange=t=>{t!=="connected"||this.store.keyMetrics.iceConnectionEnd||this.store.iceConnectionEnd(),G.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICEConnectionStateChange(").concat(t,")")),Vt.reportApiInvoke(this.store.sessionId,{name:"ICEConnectionStateChange",options:t,tag:Bn.TRACER}).onSuccess(),this.emit(Yt.IceConnectionStateChange,t)},e.onICETransportStateChange=t=>{G.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICETransportStateChange(").concat(t,")"))},e.onDTLSTransportStateChange=t=>{G.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportStateChange(").concat(t,")"))},e.onDTLSTransportError=t=>{G.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportError(").concat(t,")"))},e.onFirstAudioDecoded=t=>{var r;const s=Array.from(Sl(r=this.remoteUserMap).call(r)).find(f=>f._audioSSRC===t);var l;s&&(this.store.subscribe(s.uid,"audio",void 0,void 0,void 0,Date.now()),(l=s.audioTrack)===null||l===void 0||l.emit(is.FIRST_FRAME_DECODED),Vt.firstRemoteFrame(this.store.sessionId,fn.FIRST_AUDIO_DECODE,_r.FIRST_AUDIO_DECODE,{peer:s._uintid,subscribeElapse:ws.measureFromSubscribeStart(this.store.clientId,t),subscribeRequestid:t,p2pid:this.store.p2pId}))},e.onFirstAudioReceived=t=>{var r;const s=Array.from(Sl(r=this.remoteUserMap).call(r)).find(l=>l._audioSSRC===t);s&&Vt.firstRemoteFrame(this.store.sessionId,fn.FIRST_AUDIO_RECEIVED,_r.FIRST_AUDIO_RECEIVED,{peer:s._uintid,subscribeElapse:ws.measureFromSubscribeStart(this.store.clientId,t),subscribeRequestid:t,p2pid:this.store.p2pId})},e.onFirstVideoDecoded=(t,r,s)=>{this.reportVideoFirstFrameDecoded(t,r,s)},e.onFirstVideoReceived=t=>{var r;const s=Array.from(Sl(r=this.remoteUserMap).call(r)).find(l=>l._videoSSRC===t);s&&Vt.firstRemoteFrame(this.store.sessionId,fn.FIRST_VIDEO_RECEIVED,_r.FIRST_VIDEO_RECEIVED,{peer:s._uintid,subscribeElapse:ws.measureFromSubscribeStart(this.store.clientId,t),subscribeRequestid:t,p2pid:this.store.p2pId})},e.onSelectedLocalCandidateChanged=(t,r)=>{const s=t.candidateType==="relay",l=r.candidateType==="relay";r.candidateType!=="unknown"&&s===l||this.emit(Yt.ConnectionTypeChange,s),G.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedLocalCandidateChanged(").concat(JSON.stringify(au(r))," -> ").concat(JSON.stringify(au(t)),")"))},e.onSelectedRemoteCandidateChanged=(t,r)=>{G.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedRemoteCandidateChanged(").concat(JSON.stringify(au(r))," -> ").concat(JSON.stringify(au(t)),")"))},e.onFirstVideoDecodedTimeout=t=>{this.reportVideoFirstFrameDecoded(t,void 0,void 0,!0)},e.getLocalVideoStats=()=>{const t=this.statsCollector.getLocalVideoTrackStats(),r=this.statsCollector.getRTCStats();return ff(ff({},t),r)},e.onICECandidateError=t=>{this._iceError=t}}resetConnection(e){e instanceof Kc&&function(t){Xg.delete(t.id),XU(t)}(e),e.close(),this.emit(Yt.PeerConnectionStateChange,"closed"),function(t){t.onConnectionStateChange=void 0,t.onICEConnectionStateChange=void 0,t.onICETransportStateChange=void 0,t.onDTLSTransportStateChange=void 0,t.onDTLSTransportError=void 0,t.onFirstAudioDecoded=void 0,t.onFirstAudioReceived=void 0,t.onFirstVideoDecoded=void 0,t.onFirstVideoReceived=void 0,t.onSelectedLocalCandidateChanged=void 0,t.onSelectedRemoteCandidateChanged=void 0,t.onFirstVideoDecodedTimeout=void 0,t.getLocalVideoStats=void 0}(e),this._isWaitPcToRePub=!1}filterTobeMutedTracks(e){const t=[];if(this.getAllTracks().indexOf(e)===-1)return t;const r=this.localTrackMap.get(at.LocalAudioTrack);if(e instanceof ji&&(r==null?void 0:r.track)instanceof Sa)return r.track.isActive||t.push([at.LocalAudioTrack,r]),t;const s=Array.from(this.localTrackMap.entries()).find(l=>{let[,{track:f}]=l;return e===f});if(s&&(t.push(s),s[0]===at.LocalVideoTrack)){const l=this.localTrackMap.get(at.LocalVideoLowTrack);l&&t.push([at.LocalVideoLowTrack,l])}return t}filterTobeUnmutedTracks(e){const t=[],r=this.localTrackMap.get(at.LocalAudioTrack);if(e instanceof ji&&(r==null?void 0:r.track)instanceof Sa)return r.track.isActive&&t.push([at.LocalAudioTrack,r]),t;const s=Array.from(this.localTrackMap.entries()).find(l=>{let[,{track:f}]=l;return e===f});if(s)if(s[0]===at.LocalVideoTrack){t.push(s);const l=this.localTrackMap.get(at.LocalVideoLowTrack);l&&t.push([at.LocalVideoLowTrack,l])}else t.push(s);return t}createMuteMessage(e){return e.map(t=>{var r;let s,[l,{track:f,ssrcs:m,id:E}]=t;switch(l){case at.LocalAudioTrack:s=Er.Audio;break;case at.LocalVideoTrack:s=ht(r=f._hints).call(r,xr.SCREEN_TRACK)?Er.Screen:Er.High;break;case at.LocalVideoLowTrack:s=Er.Low}return{stream_type:s,ssrcs:m,mid:E}})}createUnmuteMessage(e){return e.map(t=>{var r;let s,[l,{track:f,ssrcs:m,id:E}]=t;switch(l){case at.LocalAudioTrack:s=Er.Audio;break;case at.LocalVideoTrack:s=ht(r=f._hints).call(r,xr.SCREEN_TRACK)?Er.Screen:Er.High;break;case at.LocalVideoLowTrack:s=Er.Low}return{stream_type:s,ssrcs:m,mid:E}})}filterTobeUnSubscribedTracks(e,t){const r=[],s=this.remoteUserMap.get(e);if(!s)return r;if(t){const l=s.get(t);if(!l)return r;r.push([e,{kind:t,id:l}])}else Array.from(s.entries()).forEach(l=>{let[f,m]=l;r.push([e,{kind:f,id:m}])});return r}filterTobeUnSubscribedDataChannels(e,t){const r=[];return t.forEach(s=>{var l;(l=this.remoteDataChannelMap.get(e))!==null&&l!==void 0&&l.has(s.id)&&r.push(s)}),r}createUnsubscribeMessage(e){const t=[];return e.forEach(r=>{let[s,{kind:l,id:f}]=r;switch(l){case ut.VIDEO:return void(s._videoSSRC&&t.push({stream_type:ut.VIDEO,ssrcId:s._videoSSRC}));case ut.AUDIO:return void(s._audioSSRC&&t.push({stream_type:ut.AUDIO,ssrcId:s._audioSSRC}))}}),t}createUnsubscribeAllMessage(e){const t=new Map;return e.forEach(r=>{let[s,{kind:l}]=r;if(t.has(s)){let f=t.get(s);l===ut.VIDEO?f|=Mt.Video:f|=Mt.Audio,t.set(s,f)}else l===ut.VIDEO?t.set(s,Mt.Video):t.set(s,Mt.Audio)}),{users:Array.from(t.entries()).map(r=>{let[s,l]=r;return{stream_id:s.uid,stream_type:l}})}}withdrawRemoteTracks(e){e.forEach(t=>{let[r,{kind:s}]=t;const l=this.remoteUserMap.get(r);l&&(l.delete(s),Array.from(l.entries()).length===0&&this.remoteUserMap.delete(r))})}async updateBitrateLimit(e){const t=this.localTrackMap.get(at.LocalVideoTrack),r=this.localTrackMap.get(at.LocalVideoLowTrack);t&&(await t.track.setBitrateLimit(e.uplink),await new gt((s,l)=>{this.handleUpdateVideoEncoder(t.track,s,l,!0)})),r&&e.low_stream_uplink&&(await r.track.setBitrateLimit({max_bitrate:e.low_stream_uplink.bitrate,min_bitrate:e.low_stream_uplink.bitrate||0}),await new gt((s,l)=>{this.handleUpdateVideoEncoder(r.track,s,l,!0)}))}isP2PDisconnected(){return this.connection?this.connection.peerConnectionState!=="connected":!0}mapPubResToRemoteConfig(e,t,r){return e.map((s,l)=>{var f;let{stream_type:m}=s;const E=(f=t.find(y=>{let{stream_type:b}=y;return m===b}))===null||f===void 0?void 0:f.attributes;if(E&&me("DISABLE_SCREEN_SHARE_REMB")){const y=r[l]._hints;(ht(y).call(y,xr.SCREEN_TRACK)||ht(y).call(y,xr.SCREEN_LOW_TRACK))&&(E.remb=!1,G.debug("disable remb for screen share, hints:",y))}return E})}async tryToUnmuteAudio(e){for(let r=0;r<e.length;r++)if(e[r]instanceof ji){var t;const s=this.filterTobeUnmutedTracks(e[r]);if(s.length===0)continue;await((t=this.connection)===null||t===void 0?void 0:t.unmuteLocal(s.map(f=>{let[,{id:m}]=f;return m})));const l=this.createUnmuteMessage(s);return void await fr(this,Yt.RequestUnmuteLocal,l)}}bindStatsUploaderEvents(){this.statsUploader.requestStats=()=>this.getStats(),this.statsUploader.requestLocalMedia=()=>Array.from(this.localTrackMap.entries()),this.statsUploader.requestRemoteMedia=()=>Array.from(this.remoteUserMap.entries()),this.statsUploader.requestVideoIsReady=e=>{var t;return!((t=this.connection)===null||t===void 0||!t.getRemoteVideoIsReady(e))},this.statsUploader.requestUpload=(e,t)=>this.emit(Yt.RequestUpload,e,t),this.statsUploader.requestUploadStats=e=>this.emit(Yt.RequestUploadStats,e),this.statsUploader.requestAllTracks=()=>this.getAllTracks(),this.statsUploader.requestTransportStats=()=>{var e;return{connectState:((e=this.connection)===null||e===void 0?void 0:e.peerConnectionState)||"closed"}}}unbindStatsUploaderEvents(){this.statsUploader.requestStats=void 0,this.statsUploader.requestLocalMedia=void 0,this.statsUploader.requestRemoteMedia=void 0,this.statsUploader.requestVideoIsReady=void 0}async requestReconnect(){this.dtlsFailedCount+=1,await fs(Qu(this.dtlsFailedCount,ra)),this.emit(Yt.RequestReconnect)}async reconnectP2P(){const e=Array.from(this.localTrackMap.entries()),t=this.createGatewayUnpublishMessage(e);Array.from(this.remoteUserMap.entries()),t.length>0&&await la(this,Yt.RequestUnpublishForReconnectPC,t),this.disconnectForReconnect(),this.emit(Yt.RequestReconnectPC)}canPublishLowStream(){return this.localTrackMap.has(at.LocalVideoTrack)||this.pendingLocalTracks.some(e=>e instanceof Kr)}throwIfTrackTypeNotMatch(e){if(e.filter(t=>t instanceof Kr).length>1)throw new Ke(se.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(e.filter(t=>t instanceof ji).length>1&&(e.some(t=>t instanceof ji&&t._bypassWebAudio)||!zn().webAudioMediaStreamDest))throw new Ke(se.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode");for(const t of e){if(t instanceof Kr&&this.pendingLocalTracks.some(r=>r instanceof Kr))throw new Ke(se.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(t instanceof ji&&this.pendingLocalTracks.some(r=>r instanceof ji)&&(!zn().webAudioMediaStreamDest||t._bypassWebAudio||this.pendingLocalTracks.some(r=>r instanceof ji&&r._bypassWebAudio)))throw new Ke(se.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode")}}getLowVideoTrack(e,t){var r;const s=!me("DISABLE_DUAL_STREAM_USE_ENCODING")&&zn().supportDualStreamEncoding,l=ff(ff({},{width:160,height:120,framerate:15,bitrate:50}),t);let f;f=s?e._mediaStreamTrack.clone():YU(e,l);const m=Br(8,"track-low-"),E=new Kr(f,ff(ff({},s&&{scaleResolutionDownBy:Bg(l,e)}),{},{frameRate:l.framerate,bitrateMax:l.bitrate,bitrateMin:l.bitrate}),void 0,void 0,m);return E.on(Eh.TRANSCEIVER_UPDATED,y=>{e._updateRtpTransceiver(y,wS.LOW_STREAM)}),E._hints.push(xr.LOW_STREAM),ht(r=e._hints).call(r,xr.SCREEN_TRACK)&&E._hints.push(xr.SCREEN_LOW_TRACK),e.on("sei-to-send",y=>{E.emit("sei-to-send",y)}),e.addListener(Dt.NEED_CLOSE,()=>{E.close()}),E}async globalLock(){return this.mutex.lock("From P2PChannel.globalLock")}async reportPCStats(e,t,r){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;if(this.connection&&this.connection instanceof Kc){var l,f,m,E;const y=this.store.keyMetrics.descriptionStart||0,{iceConnectionState:b,dtlsTransportState:A,peerConnectionState:O}=this.connection,{local:D,remote:P}=await this.connection.getSelectedCandidatePair();Vt.pcStats(this.store.sessionId,{startTime:y,eventElapse:e-y||0,iceconnectionsate:b,dtlsstate:A,connectionstate:O,intSucc:t?1:2,error:this._iceError||s||"",selectedLocalCandidateProtocol:(l=D==null?void 0:D.protocol)!==null&&l!==void 0?l:"",selectedLocalCandidateType:(f=D.candidateType)!==null&&f!==void 0?f:"",selectedLocalCandidateAddress:"".concat(D.address,":").concat(D.port),selectedRemoteCandidateProtocol:(m=P.protocol)!==null&&m!==void 0?m:"",selectedRemoteCandidateType:(E=P.candidateType)!==null&&E!==void 0?E:"",selectedRemoteCandidateAddress:"".concat(P.address,":").concat(P.port),restartCnt:r,preallocation:this.connection.isPreallocation}),this._iceError=null}}reportVideoFirstFrameDecoded(e,t,r,s){var l;const f=Array.from(Sl(l=this.remoteUserMap).call(l)).find(m=>m._videoSSRC===e);if(f){s||this.store.subscribe(f.uid,"video",void 0,void 0,void 0,void 0,Date.now());const m=this.store.keyMetrics,E=m.subscribe.find(y=>y.userId===f.uid&&y.type==="video");Vt.firstRemoteVideoDecode(this.store.sessionId,fn.FIRST_VIDEO_DECODE,_r.FIRST_VIDEO_DECODE,{peer:f._uintid,videowidth:t,videoheight:r,subscribeElapse:ws.measureFromSubscribeStart(this.store.clientId,e),subscribeRequestid:e,p2pid:this.store.p2pId,apEnd:m.requestAPEnd||0,apStart:m.requestAPStart||0,joinGwEnd:m.joinGatewayEnd||0,joinGwStart:m.joinGatewayStart||0,pcEnd:m.peerConnectionEnd||0,pcStart:m.peerConnectionStart||0,subscriberEnd:(E==null?void 0:E.subscribeEnd)||0,subscriberStart:(E==null?void 0:E.subscribeStart)||0,videoAddNotify:(E==null?void 0:E.streamAdded)||0,state:s?1:0,firstFrame:(E==null?void 0:E.firstFrame)||0})}}async remoteMediaSsrcChanged(e,t,r){if(!this.connection)return!1;const s=this.remoteUserMap.get(e);if(!s)return!1;const l=s.get(t);if(!l)return!1;const f=await this.connection.getRemoteSSRC(l);return f!==void 0&&f!==r}unbindRtpTransceiver(){this.localTrackMap.size!==0&&Array.from(this.localTrackMap.entries()).forEach(e=>{let[t,{track:r}]=e;t===at.LocalVideoLowTrack?r._updateRtpTransceiver(void 0,wS.LOW_STREAM):r._updateRtpTransceiver(void 0)})}},Ot(On.prototype,"startP2PConnection",[Io],Object.getOwnPropertyDescriptor(On.prototype,"startP2PConnection"),On.prototype),Ot(On.prototype,"connect",[Io],Object.getOwnPropertyDescriptor(On.prototype,"connect"),On.prototype),Ot(On.prototype,"updateRemoteRTPCapabilities",[Io],Object.getOwnPropertyDescriptor(On.prototype,"updateRemoteRTPCapabilities"),On.prototype),Ot(On.prototype,"publishDataChannel",[Io],Object.getOwnPropertyDescriptor(On.prototype,"publishDataChannel"),On.prototype),Ot(On.prototype,"unpublish",[Io],Object.getOwnPropertyDescriptor(On.prototype,"unpublish"),On.prototype),Ot(On.prototype,"unpublishDataChannel",[Io],Object.getOwnPropertyDescriptor(On.prototype,"unpublishDataChannel"),On.prototype),Ot(On.prototype,"unpublishLowStream",[Io],Object.getOwnPropertyDescriptor(On.prototype,"unpublishLowStream"),On.prototype),Ot(On.prototype,"subscribeDataChannel",[Io],Object.getOwnPropertyDescriptor(On.prototype,"subscribeDataChannel"),On.prototype),Ot(On.prototype,"subscribe",[Io],Object.getOwnPropertyDescriptor(On.prototype,"subscribe"),On.prototype),Ot(On.prototype,"massSubscribe",[Io],Object.getOwnPropertyDescriptor(On.prototype,"massSubscribe"),On.prototype),Ot(On.prototype,"unsubscribe",[Io],Object.getOwnPropertyDescriptor(On.prototype,"unsubscribe"),On.prototype),Ot(On.prototype,"unsubscribeDataChannel",[Io],Object.getOwnPropertyDescriptor(On.prototype,"unsubscribeDataChannel"),On.prototype),Ot(On.prototype,"massUnsubscribe",[Io],Object.getOwnPropertyDescriptor(On.prototype,"massUnsubscribe"),On.prototype),Ot(On.prototype,"muteRemote",[Io],Object.getOwnPropertyDescriptor(On.prototype,"muteRemote"),On.prototype),Ot(On.prototype,"unmuteRemote",[Io],Object.getOwnPropertyDescriptor(On.prototype,"unmuteRemote"),On.prototype),Ot(On.prototype,"hasRemoteMediaWithLock",[Io],Object.getOwnPropertyDescriptor(On.prototype,"hasRemoteMediaWithLock"),On.prototype),Ot(On.prototype,"disconnectForReconnect",[Io],Object.getOwnPropertyDescriptor(On.prototype,"disconnectForReconnect"),On.prototype),Ot(On.prototype,"updateBitrateLimit",[Io],Object.getOwnPropertyDescriptor(On.prototype,"updateBitrateLimit"),On.prototype),Ot(On.prototype,"remoteMediaSsrcChanged",[Io],Object.getOwnPropertyDescriptor(On.prototype,"remoteMediaSsrcChanged"),On.prototype),On);function Io(e,t,r){const s=e[t];if(typeof s!="function")throw new Error("Cannot use mutex on object property.");return r.value=async function(){const l=this.mutex,f=await l.lock("From P2PChannel.".concat(t));try{for(var m=arguments.length,E=new Array(m),y=0;y<m;y++)E[y]=arguments[y];return await s.apply(this,E)}finally{f()}},r}function nF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),r.push.apply(r,s)}return r}function ZU(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?nF(Object(r),!0).forEach(function(s){ne(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nF(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}const rF=Date.now(),R1=20,$U=new Map,vD=new Map;async function q_(e){const t=$U.get(e),r=Array.isArray(t)&&t[t.length-1],s=vD.get(e);if(!r)return void(s.isSyncing=!1);const l={uid:r.uid,payload:r.payload};s.firstRecvTs===0&&(s.firstRecvTs=r.recvTs,s.firstSendTs=r.sendTs);const f=r.sendTs-s.firstSendTs,m=f-(Date.now()-s.firstRecvTs);m>0&&(s.firstRecvTs=Date.now()-f);let E=r.mediaDelay+m;E<=0?(t.pop(),J_(r.context,l),E=0):E=Math.min(E,R1),setTimeout(()=>t.length&&q_(e),E)}function J_(e,t){e.safeEmit(In.STREAM_MESSAGE,t.uid,t.payload),e.onStreamMessage&&e.onStreamMessage(t)}function e6(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0;if(!e.syncWithAudio)return J_(r,{uid:e.uid,payload:e.payload});const s="".concat(r.id,"-").concat(e.uid),l=$U.get(s)||[],f=l.findIndex(b=>e.sendTs>=b.sendTs),m=ZU(ZU({},e),{},{context:r,mediaDelay:t,recvTs:Date.now()});f===-1?l.push(m):l.splice(f,0,m),$U.set(s,l);let E=!1;var y;vD.has(s)?E=!((y=vD.get(s))===null||y===void 0||!y.isSyncing):vD.set(s,{isSyncing:E,firstRecvTs:0,firstSendTs:0}),E||q_(s)}const t6=qn().name;function SD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),r.push.apply(r,s)}return r}function WI(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?SD(Object(r),!0).forEach(function(s){ne(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):SD(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}const I1="websdk_ng_cache_parameter",n6=me("MAX_PRELOAD_ASYNC_LENGTH"),iF=1e4,X_=new Map,Q_=[];let YI=null,yD=0,TD=0;const KI=new Map,bD=function(e,t){const r=[];let s=0;const l=async()=>{const f=r.shift();f&&await f(),r.length>0&&s<t?l():s--};return async function(){for(var f=arguments.length,m=new Array(f),E=0;E<f;E++)m[E]=arguments[E];return new gt(async(y,b)=>{r.push(async()=>{try{const A=await e(...m);y(A)}catch(A){b(A)}}),s<t&&(s++,l())})}}(aF,n6),CD=En.CancelToken.source();async function aF(e,t,r,s,l,f){try{if(!me("ENABLE_PRELOAD"))return;if(!zn().supportWebCrypto)return void ph(()=>{G.warn("Your browser does not support preloading, this feature  be run in a secure environment")},"preload_webcrypto_not_supported");if(!r&&r!==null)throw new Ke(se.INVALID_PARAMS,"Invalid token: ".concat(r,". If you don not use token, set it to null"));r&&Oa(r,"token",1,2047),Oa(e,"appid",1,2047),lr(t),s&&La(s);const m=Na();G.debug("preload channel ".concat(t,", uid is ").concat(s));const E={appId:e,cname:t,token:r||e,uid:typeof s!="string"?s:null,sid:m,proxyServer:l};let y,b;typeof s=="string"?(E.stringUid=s,[b,y]=await gt.all([Q8(s,{sid:m,appId:e},CD.token),Hg(WI(WI({},E),{},{token:r||e,uid:0}),CD.token)]),E.uid=b.uid,y.gatewayInfo.uid=E.uid,y.gatewayInfo.res.uid=E.uid):(f&&(E.stringUid=f),y=await Hg(E,CD.token));const A={sid:m,appId:e,cname:t,token:r||e,uid:E.stringUid||s,intUid:E.uid||y.gatewayInfo.uid,stringUid:E.stringUid,ts:Date.now(),sua:b,ap:y};await async function(O){let D;try{O.uid&&oF({appId:O.appId,cname:O.cname,token:O.token,uid:O.uid,stringUid:O.stringUid});const P=r6(O),F=await async function(Y,$){try{const ee=await window.crypto.subtle.importKey("raw",bx($),"AES-GCM",!1,["encrypt"]),Ee=await window.crypto.subtle.encrypt({name:"AES-GCM",iv:new Uint8Array(1)},ee,P_(window.btoa(JSON.stringify(Y))));return Lg(new Uint8Array(Ee))}catch{return}}(O,O.token||O.appId);if(!F)return;D=lF(I1);const B=D?JSON.parse(D):[];B.push({[P]:F}),B.length>me("AP_CACHE_NUM")&&B.shift(),GS(I1,JSON.stringify(B))}catch(P){G.warn("Error caching server parameters:",P.message),GS(I1,"")}}(A),yD++}catch(m){throw TD++,function(E){YI||(YI=window.setTimeout(()=>{let b="";KI.forEach((A,O)=>{b+="".concat(O,": ").concat(A," ;")}),Vt.reportApiInvoke(null,{name:Di.PRELOAD,options:{success:yD,failed:TD,err:b}}).onError(E),yD=0,TD=0,KI.clear(),YI=null},iF));const y=KI.get(E.code)||0;KI.set(E.code,y+1)}(m),m}}async function sF(e){try{if(me("AP_REQUEST_DETAIL")||me("ENABLE_ROLE_SELECT_EDGE"))return;const t=oF(e);if(!t||e.cloudProxyServer!=="disabled")return;const r=await async function(s,l){try{const f=await window.crypto.subtle.importKey("raw",bx(l),"AES-GCM",!1,["decrypt"]),m=await window.crypto.subtle.decrypt({name:"AES-GCM",iv:new Uint8Array(1)},f,P_(s));return JSON.parse(window.atob(Lg(new Uint8Array(m))))}catch{return}}(t,e.token||e.appId);if(!r||!function(s,l){return s.cname===l.cname&&s.appId===l.appId&&s.token===l.token?l.stringUid?s.stringUid===l.stringUid:typeof l.uid=="number"?s.uid===l.uid:s.uid==l.uid:!1}(r,e))return;if(r&&Date.now()-r.ts<me("AP_CACHE_LIFETIME"))return r}catch(t){G.warn("Error get preloadInfo",t.message)}}function oF(e){let t;try{if(t=lF(I1),!t)return;const r=JSON.parse(t),s=r6(e),l=function(m,E){for(let y=m.length-1;y>=0;y--)if(E(m[y]))return y;return-1}(r,m=>s in m);if(l===-1)return;const f=r.splice(l,1)[0];return GS(I1,JSON.stringify(r)),f[s]}catch(r){G.warn("Error delete preload info: ".concat(t),r.message),GS(I1,"")}}function Z_(e){if(e){let t=X_.get(e);t&&(window.clearTimeout(t),t=null,X_.delete(e)),ht(Q_).call(Q_,e)||e.cloudProxyServer!=="disabled"||Q_.push(e)}if(X_.size<me("AP_CACHE_NUM")&&Q_.length>0){const t=Q_.shift();X_.set(t,window.setTimeout(async()=>{const{appId:r,cname:s,token:l,stringUid:f,uid:m,proxyServer:E}=t;try{await bD(r,s,l,m,E,f),X_.has(t)&&Z_(t)}catch(y){G.warn("update preload failed",y.message),cF(t)}},me("AP_UPDATE_INTERVAL")))}}function cF(e){const t=Q_.indexOf(e);t!==-1&&Q_.splice(t,1);let r=X_.get(e);r&&(window.clearTimeout(r),r=null,X_.delete(e),Z_())}function wD(e,t){const r=e.sua,s=e.ap;t&&r&&Vt.reqUserAccount(e.sid,{lts:r.requestTime,elapse:r.elapse,success:!0,serverAddr:r.url,stringUid:t,uid:e.intUid,errorCode:null,extend:r.req}),Vt.reportResourceTiming(e.ap.url,e.sid),Vt.joinWebProxyAP(e.sid,{lts:s.requestTime,elapse:s.elapse,sucess:1,apServerAddr:s.url,turnServerAddrList:s.proxyInfo.addresses.map(l=>l.ip).join(","),eventType:"disabled",unilbsServerIds:[Pi.CHOOSE_SERVER,Pi.CLOUD_PROXY_FALLBACK].toString()}),Vt.joinChooseServer(e.sid,{lts:s.requestTime,elapse:s.elapse,succ:!0,csAddr:s.url,opid:s.opid,serverList:s.gatewayInfo.gatewayAddrs.map(l=>l.address),ec:null,cid:s.gatewayInfo.cid.toString(),uid:s.gatewayInfo.uid.toString(),csIp:s.gatewayInfo.csIp,unilbsServerIds:[Pi.CHOOSE_SERVER].toString(),isHttp3:s.isHttp3})}function lF(e){return window.atob(window.localStorage.getItem(e)||"")}function GS(e,t){window.localStorage.setItem(e,window.btoa(t))}function r6(e){let t="".concat(e.appId,"_").concat(e.cname);return typeof e.uid=="string"&&(t+="_s_".concat(e.uid)),typeof e.uid=="number"&&(t+="_".concat(e.uid)),e.token&&(t+="_".concat(e.token)),SL(t)}function dF(e){let t=function(){const r=fF.pop();return r?(r.offset=r.limit=0,r):{bytes:new Uint8Array(64),offset:0,limit:0}}();return function(r,s){let l=r.appId;l!==void 0&&(fa(s,10),Oh(s,l));let f=r.cid;f!==void 0&&(fa(s,16),fa(s,f));let m=r.cname;m!==void 0&&(fa(s,26),Oh(s,m));let E=r.deviceId;E!==void 0&&(fa(s,34),Oh(s,E));let y=r.elapse;y!==void 0&&(fa(s,40),Zg(s,y));let b=r.fileSize;b!==void 0&&(fa(s,48),Zg(s,hc(b)));let A=r.height;A!==void 0&&(fa(s,56),Zg(s,hc(A)));let O=r.jpg;O!==void 0&&(fa(s,66),fa(s,O.length),i6(s,O));let D=r.networkType;D!==void 0&&(fa(s,72),Zg(s,hc(D)));let P=r.osType;P!==void 0&&(fa(s,80),Zg(s,hc(P)));let F=r.requestId;F!==void 0&&(fa(s,90),Oh(s,F));let B=r.sdkVersion;B!==void 0&&(fa(s,98),Oh(s,B));let Y=r.sequence;Y!==void 0&&(fa(s,104),Zg(s,hc(Y)));let $=r.sid;$!==void 0&&(fa(s,114),Oh(s,$));let ee=r.timestamp;ee!==void 0&&(fa(s,120),Zg(s,ee));let Ee=r.uid;Ee!==void 0&&(fa(s,128),fa(s,Ee));let Re=r.vid;Re!==void 0&&(fa(s,136),fa(s,Re));let Ie=r.width;Ie!==void 0&&(fa(s,144),Zg(s,hc(Ie)));let we=r.service;we!==void 0&&(fa(s,152),fa(s,we));let Ue=r.callbackData;Ue!==void 0&&(fa(s,162),fa(s,Ue.length),i6(s,Ue));let ve=r.ticket;ve!==void 0&&(fa(s,170),Oh(s,ve));let Ne=r.vendorConfigs;Ne!==void 0&&(fa(s,178),Oh(s,Ne))}(e,t),function(r){let s=r.bytes,l=r.limit;return s.length===l?s:s.subarray(0,l)}(t)}function uF(e){return function(r){let s={};e:for(;!ua(r);){let l=A1(r);switch(l>>>3){case 0:break e;case 1:s.code=A1(r);break;case 2:s.msg=a6(r,A1(r));break;case 3:s.requestId=a6(r,A1(r));break;case 4:s.timestamp=DY(r,!1);break;default:$_(r,7&l)}}return s}({bytes:t=e,offset:0,limit:t.length});var t}function $_(e,t){switch(t){case 0:for(;128&hf(e););break;case 2:zS(e,A1(e));break;case 5:zS(e,4);break;case 1:zS(e,8);break;default:throw new Error("Unimplemented type: "+t)}}function hc(e){return{low:e|=0,high:e>>31,unsigned:e>=0}}let fF=[];function zS(e,t){if(e.offset+t>e.limit)throw new Error("Skip past limit");e.offset+=t}function ua(e){return e.offset>=e.limit}function RD(e,t){let r=e.bytes,s=e.offset,l=e.limit,f=s+t;if(f>r.length){let m=new Uint8Array(2*f);m.set(r),e.bytes=m}return e.offset=f,f>l&&(e.limit=f),s}function Qg(e,t){let r=e.offset;if(r+t>e.limit)throw new Error("Read past limit");return e.offset+=t,r}function i6(e,t){let r=RD(e,t.length);e.bytes.set(t,r)}function a6(e,t){let r=Qg(e,t),s=String.fromCharCode,l=e.bytes,f="",m="";for(let E=0;E<t;E++){let y,b,A,O,D=l[E+r];(128&D)==0?m+=s(D):(224&D)==192?E+1>=t?m+=f:(y=l[E+r+1],(192&y)!=128?m+=f:(O=(31&D)<<6|63&y,O<128?m+=f:(m+=s(O),E++))):(240&D)==224?E+2>=t?m+=f:(y=l[E+r+1],b=l[E+r+2],(49344&(y|b<<8))!=32896?m+=f:(O=(15&D)<<12|(63&y)<<6|63&b,O<2048||O>=55296&&O<=57343?m+=f:(m+=s(O),E+=2))):(248&D)==240?E+3>=t?m+=f:(y=l[E+r+1],b=l[E+r+2],A=l[E+r+3],(12632256&(y|b<<8|A<<16))!=8421504?m+=f:(O=(7&D)<<18|(63&y)<<12|(63&b)<<6|63&A,O<65536||O>1114111?m+=f:(O-=65536,m+=s(55296+(O>>10),56320+(1023&O)),E+=3))):m+=f}return m}function Oh(e,t){let r=t.length,s=0;for(let m=0;m<r;m++){let E=t.charCodeAt(m);E>=55296&&E<=56319&&m+1<r&&(E=(E<<10)+t.charCodeAt(++m)-56613888),s+=E<128?1:E<2048?2:E<65536?3:4}fa(e,s);let l=RD(e,s),f=e.bytes;for(let m=0;m<r;m++){let E=t.charCodeAt(m);E>=55296&&E<=56319&&m+1<r&&(E=(E<<10)+t.charCodeAt(++m)-56613888),E<128?f[l++]=E:(E<2048?f[l++]=E>>6&31|192:(E<65536?f[l++]=E>>12&15|224:(f[l++]=E>>18&7|240,f[l++]=E>>12&63|128),f[l++]=E>>6&63|128),f[l++]=63&E|128)}}function hf(e){return e.bytes[Qg(e,1)]}function hF(e,t){let r=RD(e,1);e.bytes[r]=t}function A1(e){let t,r=0,s=0;do t=hf(e),r<32&&(s|=(127&t)<<r),r+=7;while(128&t);return s}function fa(e,t){for(t>>>=0;t>=128;)hF(e,127&t|128),t>>>=7;hF(e,t)}function DY(e,t){let r,s=0,l=0,f=0;return r=hf(e),s=127&r,128&r&&(r=hf(e),s|=(127&r)<<7,128&r&&(r=hf(e),s|=(127&r)<<14,128&r&&(r=hf(e),s|=(127&r)<<21,128&r&&(r=hf(e),l=127&r,128&r&&(r=hf(e),l|=(127&r)<<7,128&r&&(r=hf(e),l|=(127&r)<<14,128&r&&(r=hf(e),l|=(127&r)<<21,128&r&&(r=hf(e),f=127&r,128&r&&(r=hf(e),f|=(127&r)<<7))))))))),{low:s|l<<28,high:l>>>4|f<<24,unsigned:t}}function Zg(e,t){let r=t.low>>>0,s=(t.low>>>28|t.high<<4)>>>0,l=t.high>>>24,f=l===0?s===0?r<16384?r<128?1:2:r<1<<21?3:4:s<16384?s<128?5:6:s<1<<21?7:8:l<128?9:10,m=RD(e,f),E=e.bytes;switch(f){case 10:E[m+9]=l>>>7&1;case 9:E[m+8]=f!==9?128|l:127&l;case 8:E[m+7]=f!==8?s>>>21|128:s>>>21&127;case 7:E[m+6]=f!==7?s>>>14|128:s>>>14&127;case 6:E[m+5]=f!==6?s>>>7|128:s>>>7&127;case 5:E[m+4]=f!==5?128|s:127&s;case 4:E[m+3]=f!==4?r>>>21|128:r>>>21&127;case 3:E[m+2]=f!==3?r>>>14|128:r>>>14&127;case 2:E[m+1]=f!==2?r>>>7|128:r>>>7&127;case 1:E[m]=f!==1?128|r:127&r}}const O1={},s6={},qI=4294967296,o6=qI*qI,c6=o6/2;l6(0,!0);const pF=l6(0),mF=N1(0,-2147483648,!1),gF=N1(-1,2147483647,!1);function l6(e,t){let r,s,l;return t?(l=0<=(e>>>=0)&&e<256)&&(s=s6[e],s)?s:(r=N1(e,0,!0),l&&(s6[e]=r),r):(l=-128<=(e|=0)&&e<128)&&(s=O1[e],s)?s:(r=N1(e,e<0?-1:0,!1),l&&(O1[e]=r),r)}function N1(e,t,r){return{low:0|e,high:0|t,unsigned:!!r}}function d6(e,t){if(isNaN(e))return pF;{if(e<=-c6)return mF;if(e+1>=c6)return gF}return e<0?pF:N1(e%qI|0,e/qI|0,t)}function u6(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),r.push.apply(r,s)}return r}class ID extends Xt{get connectionState(){return this._connectionState}set connectionState(t){if(this._connectionState===t)return;const r=this._connectionState;this._connectionState=t,this.emit(Th.CONNECTION_STATE_CHANGE,t,r)}get quality(){return this._quality}set quality(t){this._quality=t>1?1:t<.1?.1:t,this._qualityTimer&&(window.clearTimeout(this._qualityTimer),this._qualityTimer=null),this._quality>=1||(this._qualityTimer=window.setTimeout(()=>{this.quality=this._quality/this._qualityRatio},6e4))}constructor(t){var r;super(),ne(this,"name","AgoraRTCImageModeration"),ne(this,"_connectionState",iu.CONNECTING),ne(this,"_sequence",0),ne(this,"_moderationStartTime",void 0),ne(this,"_workerConnection",void 0),ne(this,"_workerMessageLengthLimit",void 0),ne(this,"_qualityRatio",void 0),ne(this,"_connectInfo",void 0),ne(this,"_cancelTokenSource",En.CancelToken.source()),ne(this,"_retryConfig",void 0),ne(this,"_moderationInterval",void 0),ne(this,"_moderationTimer",null),ne(this,"_moderationMode",1),ne(this,"_quality",1),ne(this,"_qualityTimer",null),ne(this,"_ticket",void 0),ne(this,"_moderationIntervalMinimum",void 0),ne(this,"_uploadFailedNum",0),ne(this,"_uploadNum",0),ne(this,"_uploadTimer",null),ne(this,"_extraInfo",void 0),ne(this,"_vendor",""),ne(this,"_encoder",new TextEncoder),ne(this,"_moderationId",void 0),ne(this,"inspectImage",()=>{if(this.connectionState!==iu.CONNECTED)throw new xe(se.OPERATION_ABORTED,"image moderation service connection status is ".concat(this.connectionState));this._moderationTimer&&(window.clearInterval(this._moderationTimer),this._moderationTimer=null),this._moderationTimer=window.setInterval(()=>{this.connectionState===iu.CONNECTED?this.requestToInspectImage():G.debug("[".concat(this._moderationId,"] Moderation State is not connected , "),this.connectionState)},this._moderationInterval<this._moderationIntervalMinimum?this._moderationIntervalMinimum:this._moderationInterval),this.requestToInspectImage()}),this._moderationId=Br(5,"image-moderation-"),this._workerMessageLengthLimit=me("IMAGE_MODERATION_WORKER_MESSAGE_LENGTH_LIMIT"),this._moderationIntervalMinimum=me("IMAGE_MODERATION_INTERVAL_MINIMUM"),this._moderationInterval=(r=t.interval)!==null&&r!==void 0?r:1e3,t.extraInfo&&(this._extraInfo=this._encoder.encode(t.extraInfo)),t.vendor&&(this._vendor=t.vendor),this._qualityRatio=me("IMAGE_MODERATION_QUALITY_RATIO"),this._moderationStartTime=Number(Date.now()),this._workerConnection=new G_("worker-"+this._moderationId,ra),this.on(Th.STATE_CHANGE,(s,l)=>{G.debug("[".concat(this._moderationId,"] Moderation operation :").concat(o1[s]," ").concat(l||""))}),this.handleWorkerEvents()}async init(t,r){this.emit(Th.STATE_CHANGE,o1.CONNECT_AP),this._connectInfo=t;const s=this._cancelTokenSource.token;return this._retryConfig=r,new gt((l,f)=>{this.on(Th.CONNECTION_STATE_CHANGE,(m,E)=>{m===iu.CONNECTED&&l()}),this.requestAP(t,s,r).then(m=>{this.connectWorker(m)}).catch(m=>{f(m)})})}updateConfig(t){var r;this._moderationInterval=(r=t.interval)!==null&&r!==void 0?r:1e3,t.extraInfo&&(this._extraInfo=this._encoder.encode(t.extraInfo)),t.vendor&&(this._vendor=t.vendor),G.debug("[".concat(this._moderationId,"] updateConfig: ").concat(JSON.stringify(t))),this.connectionState===iu.CONNECTED&&this.inspectImage()}async requestAP(t,r,s){const l=me("WEBCS_DOMAIN").map(y=>"https://".concat(y,"/api/v1")),f=await function(y,b,A,O){let{appId:D,areaCode:P,cname:F,sid:B,token:Y,uid:$}=b;v1++;const ee="moderation_plugin",Ee={service_name:ee,json_body:JSON.stringify({appId:D,areaCode:P,cname:F,command:"allocateEdge",requestId:v1,seq:v1,sid:B,appToken:Y,ts:Date.now(),uid:$+""})};let Re,Ie,we=y[0];return _l(async()=>{Re=Date.now();const Ue=await cf(we,{data:Ee,cancelToken:A,headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"61"},params:{action:"wrtc_gateway"}});if(Ie=Date.now()-Re,Ue.code!==0){const Ve=new xe(se.UNEXPECTED_RESPONSE,"moderation plugin ap error, code"+Ue.code,{retry:!0,responseTime:Ie});throw G.error(Ve.toString()),Ve}const ve=JSON.parse(Ue.json_body);if(ve.code!==200){const Ve=new xe(se.UNEXPECTED_RESPONSE,"moderation plugin ap error, code: ".concat(ve.code,", reason: ").concat(ve.reason),{code:ve.code,responseTime:Ie});throw G.error(Ve.toString()),Ve}if(!ve.servers||!Array.isArray(ve.servers)||ve.servers.length===0){const Ve=new xe(se.UNEXPECTED_RESPONSE,"moderation plugin ap empty server",{code:ve.code,responseTime:Ie});throw G.error(Ve.toString()),Ve}if(!ve.servers.some(Ve=>!!Ve.wss)){const Ve=new xe(se.UNEXPECTED_RESPONSE,"moderation plugin ap empty port",{code:ve.code,responseTime:Ie});throw G.error(Ve.toString()),Ve}const Ne=me("IMAGE_MODERATION_WORKER_HOST");return{addressList:ve.servers.map(Ve=>{let{address:Be,wss:W}=Ve;if(Be&&W)return"wss://".concat(Be.replace(/\./g,"-"),".").concat(Ne,":").concat(W,"/moderation")}).filter(Ve=>!!Ve),workerToken:ve.workerToken,vid:ve.vid,ticket:ve.appTicket,responseTime:Ie}},(Ue,ve)=>(Vt.apworkerEvent(B,{success:!0,sc:200,serviceName:ee,responseDetail:JSON.stringify(Ue.addressList),firstSuccess:ve===0,responseTime:Ie,serverIp:y[ve%y.length]}),!1),(Ue,ve)=>(Vt.apworkerEvent(B,{success:!1,sc:Ue.data&&Ue.data.code||200,serviceName:ee,responseTime:Ie,serverIp:y[ve%y.length]}),!!(Ue.code!==se.OPERATION_ABORTED&&Ue.code!==se.UNEXPECTED_RESPONSE||Ue.data&&Ue.data.retry)&&(we=y[(ve+1)%y.length],!0)),O)}(l,t,r,s);this.emit(Th.STATE_CHANGE,o1.AP_CONNECTED);const{addressList:m,ticket:E}=f;return this._ticket=E,m}async connectWorker(t){this.emit(Th.STATE_CHANGE,o1.CONNECT_WORKER),await this._workerConnection.init(t,1e4)}handleWorkerEvents(){this._workerConnection.on(hn.CONNECTED,async()=>{this.emit(Th.STATE_CHANGE,o1.WORKER_CONNECTED,this._workerConnection.url),this.connectionState=iu.CONNECTED}),this._workerConnection.on(hn.CLOSED,()=>{this.connectionState=iu.CLOSED}),this._workerConnection.on(hn.FAILED,()=>{this.connectionState=iu.CLOSED}),this._workerConnection.on(hn.RECONNECTING,()=>{this.connectionState=this.connectionState===iu.CONNECTED?iu.RECONNECTING:iu.CONNECTING}),this._workerConnection.on(hn.ON_MESSAGE,async t=>{if(t.data instanceof ArrayBuffer){const r=uF(new Uint8Array(t.data));me("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")&&G.debug("[".concat(this._moderationId,"] Response message for worker of image moderation "),JSON.stringify(r)),this._uploadNum++,r.code===void 0||r.code===0||(this._uploadFailedNum++,G.error("[".concat(this._moderationId,"] Error response from worke, code is ").concat(r.code,", msg is ").concat(r.msg)),this._uploadTimer||(this._uploadTimer=window.setTimeout(()=>{Vt.reportApiInvoke(this._connectInfo.sid||null,{name:Di.IMAGE_MODERATION_UPLOAD,options:[this._uploadFailedNum,this._uploadNum,r.code],tag:Bn.TRACER}).onError(new xe(se.IMAGE_MODERATION_UPLOAD_FAILED,r.msg)),this._uploadTimer=null},me("IMAGE_MODERATION_UPLOAD_REPORT_INTERVAL"))))}else G.error("[".concat(this._moderationId,"] Unexpected message type from worker"))}),this._workerConnection.on(hn.WILL_RECONNECT,(t,r,s)=>{t==="recover"&&s(t),s("tryNext")}),this._workerConnection.on(hn.REQUEST_NEW_URLS,(t,r)=>{this.requestAP(this._connectInfo,this._cancelTokenSource.token,this._retryConfig).then(t).catch(r)})}static intToLong(t){return{low:t|=0,high:t>>31,unsigned:t>=0}}async requestToInspectImage(){const t=Gs(this,Th.CLIENT_LOCAL_VIDEO_TRACK),r={appId:this._connectInfo.appId,cname:this._connectInfo.cname,cid:this._connectInfo.cid,sid:this._connectInfo.sid,uid:this._connectInfo.uid,vid:this._connectInfo.vid};if(t){if(!t.isPlaying)return void(me("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")&&G.debug("Only the track being played can be inspected"));this._sequence++;const s=await this.generateRequestData(t,r);this._workerConnection.sendMessage(s,!0,!0)}else me("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")&&G.debug("Only the track being published can be inspected")}async generateRequestData(t,r){let{appId:s,cname:l,cid:f,vid:m,sid:E,uid:y}=r;const b=Date.now(),A=await t.getCurrentFrameImage("image/jpeg",this.quality),O=await Jx(A,s,l),D=this._sequence+"-"+f+"-"+y+"-"+b+"-"+Br(12,""),P={appId:s,cid:f,cname:l,deviceId:"",elapse:ID.intToLong(Number(b-this._moderationStartTime)),fileSize:A.buffer.byteLength,height:A.height,width:A.width,jpg:O,networkType:6,osType:7,requestId:D,sdkVersion:"4.23.4",sequence:this._sequence,sid:E,timestamp:d6(b),uid:y,vid:m,service:this._moderationMode,ticket:this._ticket,callbackData:this._extraInfo,vendorConfigs:this._vendor};this._extraInfo===void 0&&delete P.callbackData;const F=dF(P);if(F.byteLength<this._workerMessageLengthLimit){if(me("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")){const B=function(Y){for(var $=1;$<arguments.length;$++){var ee=arguments[$]!=null?arguments[$]:{};$%2?u6(Object(ee),!0).forEach(function(Ee){ne(Y,Ee,ee[Ee])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Y,Object.getOwnPropertyDescriptors(ee)):u6(Object(ee)).forEach(function(Ee){Object.defineProperty(Y,Ee,Object.getOwnPropertyDescriptor(ee,Ee))})}return Y}({},P);delete B.jpg,G.debug("[".concat(this._moderationId,"] Request message for worker of image moderation service: "),JSON.stringify(B))}return F}{const B=this.quality*this._qualityRatio;return this.quality=B,await this.generateRequestData(t,{appId:s,cname:l,cid:f,vid:m,sid:E,uid:y})}}close(){this._cancelTokenSource.cancel(),this._cancelTokenSource=En.CancelToken.source(),this._workerConnection&&this._workerConnection.close(),this._moderationTimer&&window.clearInterval(this._moderationTimer),this._moderationTimer=null,this._uploadTimer&&window.clearTimeout(this._uploadTimer),this._uploadTimer=null,this.connectionState=iu.CLOSED,this.emit(Th.STATE_CHANGE,o1.CLOSED)}}function f6(e){if(wr(e.interval,"interval",1e3,1/0),e&&e.extraInfo&&e.extraInfo.length>1024)throw new xe(se.INVALID_PARAMS,"config.extraInfo length cannot exceed 1024 bytes");if(e&&e.vendor&&e.vendor.length>1024)throw new xe(se.INVALID_PARAMS,"config.vendor length cannot exceed 1024 bytes")}const _F={name:"ImageModeration",create:function(e){let{config:t}=e;return f6(t),new ID(t)}};var h6,p6,m6,g6,_6,E6,v6,S6,y6,T6,b6,C6,w6,R6,I6,A6,O6,N6,L6,D6,P6,M6,k6,x6,U6,j6,V6,B6,F6,G6,z6,H6,wt,W6,lu,EF,L1,Y6,JI,vF,SF,Rt;function K6(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),r.push.apply(r,s)}return r}function cd(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?K6(Object(r),!0).forEach(function(s){ne(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):K6(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}Gi.setLogger(G);let yF=(h6=nn(),p6=nn({argsMap:(e,t)=>{if(!Array.isArray(t)){if(!(t instanceof $b))return[t];t=[t]}return t.map(r=>r?Object(r).toString():"null")}}),m6=nn({argsMap:(e,t)=>(t||(t=[]),Array.isArray(t)||t.trackMediaType!==yl.DATA?(Array.isArray(t)||(t=[t]),t.map(r=>r.getTrackId())):[t.getChannelId()])}),g6=nn({argsMap:(e,t,r,s)=>[typeof t=="object"?t.uid:t,r,s]}),_6=nn({argsMap:(e,t,r)=>[t,r]}),E6=nn({argsMap:(e,t)=>t.map(r=>{let{user:s,mediaType:l}=r;return[s==null?void 0:s.uid,l]})}),v6=nn({argsMap:(e,t,r,s)=>[typeof t=="object"?t.uid:t,r,s]}),S6=nn({argsMap:(e,t)=>t.map(r=>{let{user:s,mediaType:l}=r;return{uid:s==null?void 0:s.uid,mediaType:l}})}),y6=nn(),T6=nn(),b6=nn(),C6=nn(),w6=nn(),R6=nn(),I6=nn(),A6=nn(),O6=nn(),N6=nn(),L6=nn(),D6=nn(),P6=nn(),M6=nn(),k6=nn(),x6=nn({argsMap:(e,t)=>[t]}),U6=nn(),j6=nn(),V6=nn(),B6=nn(),F6=nn(),G6=nn(),z6=nn(),H6=nn(),wt=nn({argsMap:(e,t)=>(Array.isArray(t)||(t=[t]),[JSON.stringify(t)])}),W6=nn(),lu=nn(),EF=nn(),L1=nn(),Y6=nn(),JI=nn(),vF=nn({reportResult:!0}),SF=nn(),Rt=class extends Xt{get connectionState(){return this._gateway.state}get remoteUsers(){return this._users}get localTracks(){return this._p2pChannel.getAllTracks(!0)}get uid(){return this._uid}get channelName(){return this._channelName}get localDataChannels(){return this._p2pChannel.getAllDataChannels()}get mode(){return this._config.mode}get role(){var e;return((e=this._config)===null||e===void 0?void 0:e.role)||"audience"}get codec(){return this._config.codec}get audioCodec(){return this._config.audioCodec||"opus"}get isStringUID(){return!!this._joinInfo&&!!this._joinInfo.stringUid}get __className__(){return"Client"}constructor(e,t){let r;if(super(),ne(this,"store",void 0),ne(this,"_uid",void 0),ne(this,"_channelName",void 0),ne(this,"_uintUid",void 0),ne(this,"_users",[]),ne(this,"_config",void 0),ne(this,"_clientId",void 0),ne(this,"_appId",void 0),ne(this,"_sessionId",null),ne(this,"_key",void 0),ne(this,"_rtmConfig",{}),ne(this,"_joinInfo",void 0),ne(this,"_gateway",void 0),ne(this,"_statsCollector",void 0),ne(this,"_configDistribute",void 0),ne(this,"_leaveMutex",void 0),ne(this,"_publishMutex",void 0),ne(this,"_renewTokenMutex",void 0),ne(this,"_subscribeMutex",void 0),ne(this,"_encryptionMode","none"),ne(this,"_encryptionSecret",null),ne(this,"_encryptionSalt",null),ne(this,"_encryptDataStream",!1),ne(this,"_encryptDataStreamKey",null),ne(this,"_encryptDataStreamIv",null),ne(this,"_proxyServer",void 0),ne(this,"_turnServer",{servers:[],mode:"auto"}),ne(this,"_cloudProxyServerMode","disabled"),ne(this,"_isDualStreamEnabled",!1),ne(this,"_defaultStreamFallbackType",void 0),ne(this,"_lowStreamParameter",void 0),ne(this,"_streamFallbackTypeCacheMap",new Map),ne(this,"_remoteStreamTypeCacheMap",new Map),ne(this,"_axiosCancelSource",En.CancelToken.source()),ne(this,"_audioVolumeIndicationInterval",void 0),ne(this,"_networkQualityInterval",void 0),ne(this,"_userOfflineTimeout",void 0),ne(this,"_streamRemovedTimeout",void 0),ne(this,"_liveTranscodeStreamingClient",void 0),ne(this,"_liveRawStreamingClient",void 0),ne(this,"_channelMediaRelayClient",void 0),ne(this,"_networkQualitySensitivity","normal"),ne(this,"_p2pChannel",void 0),ne(this,"_useLocalAccessPoint",!1),ne(this,"_setLocalAPVersion",void 0),ne(this,"_joinAndNotLeaveYet",!1),ne(this,"_numberOfJoinCount",0),ne(this,"_remoteDefaultVideoStreamType",void 0),ne(this,"_inspect",void 0),ne(this,"_moderation",void 0),ne(this,"_license",void 0),ne(this,"_pendingPublishedUsers",[]),ne(this,"ntpAlignErrorCount",0),ne(this,"remoteInboundOffset",0),ne(this,"_peerConnectionState",void 0),ne(this,"_handleLocalTrackEnable",(l,f,m)=>{this.publish(l,!1).then(f).catch(m)}),ne(this,"_handleLocalTrackDisable",(l,f,m)=>{this.unpublish(l).then(f).catch(m)}),ne(this,"_handleUserOnline",l=>{if(me("BLOCK_LOCAL_CLIENT")&&B_(l.uid,this.channelName))return void G.debug("[".concat(l.uid,"] will be ignored in local"));this.isStringUID&&typeof l.uid!="string"&&G.error("[".concat(this._clientId,"] StringUID is Mixed with UintUID"));const f=this._users.find(m=>m.uid===l.uid);if(f)f._trust_in_room_=!0,f._is_pre_created&&(f._is_pre_created=!1,this.safeEmit(In.USER_JOINED,f));else{const m=new K_(l.uid,l.uint_id||l.uid);this._users.push(m),G.debug("[".concat(this._clientId,"] user online"),l.uid),this.safeEmit(In.USER_JOINED,m)}}),ne(this,"_handleUserOffline",l=>{if(me("BLOCK_LOCAL_CLIENT")&&B_(l.uid,this.channelName))return;const f=this._users.find(m=>m.uid===l.uid);f&&(this._handleRemoveStream(l),this._handleRemoveDataChannels(l),f._audio_pre_subscribed||f._video_pre_subscribed?f._is_pre_created=!0:Qd(this._users,f),this._remoteStreamTypeCacheMap.delete(f.uid),this._streamFallbackTypeCacheMap.delete(f.uid),G.debug("[".concat(this._clientId,"] user offline"),l.uid,"reason:",l.reason),this.safeEmit(In.USER_LEAVED,f,l.reason))}),ne(this,"_handleAddAudioOrVideoStream",(l,f,m,E,y,b,A)=>{if(me("BLOCK_LOCAL_CLIENT")&&B_(f,this.channelName))return;const O=this._users.find(P=>P.uid===f);if(!O)return void G.error("[".concat(this._clientId,"] can not find target user!(on_add_stream)"));G.debug("[".concat(this._clientId,"] stream added with uid ").concat(f,", type ").concat(l)),this.store.subscribe(O.uid,l,void 0,void 0,void 0,Date.now());const D=l==="audio"?O.hasAudio:O.hasVideo;O._uintid||(O._uintid=y||f),l==="audio"?O._trust_audio_stream_added_state_=!0:O._trust_video_stream_added_state_=!0,l==="audio"?(O._audio_added_=!0,m!==void 0&&(O._audioSSRC=m),E!==void 0&&(O._cname=E),b&&(O._audioOrtc=b)):(O._video_added_=!0,m!==void 0&&(O._videoSSRC=m),E!==void 0&&(O._cname=E),A!==void 0&&(O._rtxSsrcId=A),b&&(O._videoOrtc=b)),(l==="audio"?O.hasAudio:O.hasVideo)&&!D&&(G.info("[".concat(this._clientId,"] remote user ").concat(O.uid," published ").concat(l)),this.safeEmit(In.USER_PUBLISHED,O,l)),l==="video"?Vt.onGatewayStream(this._sessionId,fn.ON_ADD_VIDEO_STREAM,_r.ON_ADD_VIDEO_STREAM,{peer:y||f,ssrc:O._videoSSRC}):Vt.onGatewayStream(this._sessionId,fn.ON_ADD_AUDIO_STREAM,_r.ON_ADD_AUDIO_STREAM,{peer:y||f,ssrc:O._audioSSRC}),this._p2pChannel.remoteMediaSsrcChanged(O,l,m).then(P=>{if(P&&(G.debug("[".concat(this._clientId,"] resubscribe ").concat(l," for user ").concat(O.uid," after rejoin because SSRC id changed.")),this._p2pChannel instanceof w1))return this._p2pChannel.unsubscribe(O,l,!0).then(()=>this._subscribe(O,l,!0).catch(F=>{G.error("[".concat(this._clientId,"] resubscribe error"),F.toString())}))}),this._p2pChannel.hasPendingRemoteMedia(O,l)&&(G.debug("[".concat(this._clientId,"] resubscribe ").concat(l," for user ").concat(O.uid," after reconnect.")),this._subscribe(O,l,!0).catch(P=>{G.error("[".concat(this._clientId,"] resubscribe error"),P.toString())}))}),ne(this,"_handleRemoveStream",l=>{if(me("BLOCK_LOCAL_CLIENT")&&B_(l.uid,this.channelName))return;const f=this._users.find(E=>E.uid===l.uid);if(!f)return void G.warning("[".concat(this._clientId,"] can not find target user!(on_remove_stream)"));G.debug("[".concat(this._clientId,"] stream removed with uid ").concat(l.uid));let m=()=>{};f.hasAudio&&f.hasVideo?m=()=>{G.info("[".concat(this._clientId,"] remote user ").concat(f.uid," unpublished audio track")),this.safeEmit(In.USER_UNPUBLISHED,f,"audio"),G.info("[".concat(this._clientId,"] remote user ").concat(f.uid," unpublished video track")),this.safeEmit(In.USER_UNPUBLISHED,f,"video")}:f.hasVideo?m=()=>{G.info("[".concat(this._clientId,"] remote user ").concat(f.uid," unpublished video track")),this.safeEmit(In.USER_UNPUBLISHED,f,"video")}:f.hasAudio&&(m=()=>{G.info("[".concat(this._clientId,"] remote user ").concat(f.uid," unpublished audio track")),this.safeEmit(In.USER_UNPUBLISHED,f,"audio")}),f._video_pre_subscribed||f._audio_pre_subscribed||(f._trust_audio_stream_added_state_=!0,f._trust_video_stream_added_state_=!0,f._audio_added_=!1,f._video_added_=!1,this._p2pChannel instanceof w1&&this._p2pChannel.unsubscribe(f).then(E=>{if(E)return this._gateway.unsubscribe(E,f.uid)}),f._audioSSRC=void 0,f._videoSSRC=void 0,f._audioOrtc=void 0,f._videoOrtc=void 0,f._rtxSsrcId=void 0),Vt.onGatewayStream(this._sessionId,fn.ON_REMOVE_STREAM,_r.ON_REMOVE_STREAM,{peer:l.uint_id||l.uid}),m()}),ne(this,"_handleSetStreamLocalEnable",(l,f,m)=>{if(me("BLOCK_LOCAL_CLIENT")&&B_(f,this.channelName))return;const E=this._users.find(A=>A.uid===f);if(!E)return void G.error("[".concat(this._clientId,"] can not find target user!(disable_local)"));G.debug("[".concat(this._clientId,"] local ").concat(l," ").concat(m?"enabled":"disabled"," with uid ").concat(f));const y=l==="audio"?E.hasAudio:E.hasVideo;if(l==="audio"){E._trust_audio_enabled_state_=!0;const A=E._audio_enabled_;if(E._audio_enabled_=m,E._audio_enabled_===A)return;{const O=E._audio_enabled_?"enable-local-audio":"disable-local-audio";G.debug("[".concat(this._clientId,"] user-info-updated, uid: ").concat(f,", msg: ").concat(O)),this.safeEmit(In.USER_INFO_UPDATED,f,O)}}else{E._trust_video_enabled_state_=!0;const A=E._video_enabled_;if(E._video_enabled_=m,E._video_enabled_===A)return;{const O=E._video_enabled_?"enable-local-video":"disable-local-video";G.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(f,", msg: ").concat(O)),this.safeEmit(In.USER_INFO_UPDATED,f,O)}}const b=l==="audio"?E.hasAudio:E.hasVideo;return y!==b?!y&&b?(G.info("[".concat(this._clientId,"] remote user ").concat(f," published ").concat(l)),void this.safeEmit(In.USER_PUBLISHED,E,l)):(l==="video"&&E._videoTrack&&E._videoTrack._destroy(),l==="audio"&&E._audioTrack,this._p2pChannel.muteRemote(E,l),G.info("[".concat(this._clientId,"] remote user ").concat(f," unpublished ").concat(l)),void this.safeEmit(In.USER_UNPUBLISHED,E,l)):void 0}),ne(this,"_handleMuteStream",(l,f,m)=>{if(me("BLOCK_LOCAL_CLIENT")&&B_(l,this.channelName))return;G.debug("[".concat(this._clientId,"] receive mute message"),l,f,m);const E=this._users.find(A=>A.uid===l);if(!E)return void G.warning("[".concat(this._clientId,"] can not find remote user, ignore mute event, uid: ").concat(l));const y=f==="audio"?E.hasAudio:E.hasVideo;if(f==="audio"){E._trust_audio_mute_state_=!0;const A=E._audio_muted_;if(E._audio_muted_=m,E._audio_muted_===A)return;{const O=E._audio_muted_?"mute-audio":"unmute-audio";G.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(l,", msg: ").concat(O)),this.safeEmit(In.USER_INFO_UPDATED,l,O)}}else{E._trust_video_mute_state_=!0;const A=E._video_muted_;if(E._video_muted_=m,E._video_muted_===A)return;{const O=E._video_muted_?"mute-video":"unmute-video";G.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(l,", msg: ").concat(O)),this.safeEmit(In.USER_INFO_UPDATED,l,O)}}const b=f==="audio"?E.hasAudio:E.hasVideo;if(y!==b){if(!y&&b)return(f==="audio"?E._audioSSRC:E._videoSSRC)?(G.info("[".concat(this._clientId,"] remote user ").concat(l," published ").concat(f)),void this.safeEmit(In.USER_PUBLISHED,E,f)):void G.warning("[".concat(this._clientId,"] remote user ").concat(l," receive ").concat(f," unmute message  before add stream message, ").concat(f," SSRC doesn't exist yet."));f==="video"&&E._videoTrack&&!E._video_pre_subscribed&&E._videoTrack._destroy(),f==="audio"&&E._audioTrack,this._p2pChannel.muteRemote(E,f),G.info("[".concat(this._clientId,"] remote user ").concat(l," unpublished ").concat(f)),this.safeEmit(In.USER_UNPUBLISHED,E,f)}}),ne(this,"_handleP2PLost",async l=>{G.debug("[".concat(this._clientId,"] receive p2p lost"),l),parseInt(l.p2pid,10)===this.store.p2pId?await this._p2pChannel.requestReconnect():G.warning("[".concat(this._clientId,"] P2PLost stream not found"),l)}),ne(this,"_handleTokenWillExpire",()=>{G.debug("[".concat(this._clientId,"] received message onTokenPrivilegeWillExpire")),this.safeEmit(In.ON_TOKEN_PRIVILEGE_WILL_EXPIRE)}),ne(this,"_handleBeforeUnload",l=>{l.type==="beforeunload"&&l.returnValue!==void 0&&l.returnValue!==""||(this.leave(),G.info("[".concat(this._clientId,"] auto leave onbeforeunload or pagehide")))}),ne(this,"_handleUpdateNetworkQuality",()=>{if(this._networkQualitySensitivity==="normal")return;if(navigator&&navigator.onLine!==void 0&&!navigator.onLine)return void this.safeEmit(In.NETWORK_QUALITY,{downlinkNetworkQuality:6,uplinkNetworkQuality:6});const l={downlinkNetworkQuality:0,uplinkNetworkQuality:0};l.uplinkNetworkQuality=this._p2pChannel.getUplinkNetworkQuality(),l.downlinkNetworkQuality=this._p2pChannel.getDownlinkNetworkQuality(),this.safeEmit(In.NETWORK_QUALITY,l)}),ne(this,"_handleP2PAddAudioOrVideoStream",(l,f,m,E)=>{const y=this._users.find(A=>A.uid===f);if(!y)return void G.error("[".concat(this._clientId,"] can not find target user!(on_add_stream)"));G.debug("[".concat(this._clientId,"] stream added with uid ").concat(f,", type ").concat(l)),this.store.subscribe(y.uid,l,void 0,void 0,void 0,Date.now());const b=l==="audio"?y.hasAudio:y.hasVideo;l==="audio"?y._trust_audio_stream_added_state_=!0:y._trust_video_stream_added_state_=!0,l==="audio"?(y._audio_added_=!0,m!==void 0&&(y._audioSSRC=m),E!==void 0&&(y._audioMid=E)):(y._video_added_=!0,m!==void 0&&(y._videoSSRC=m),E!==void 0&&(y._videoMid=E)),(l==="audio"?y.hasAudio:y.hasVideo)&&!b&&(G.info("[".concat(this._clientId,"] remote user ").concat(y.uid," published ").concat(l)),this.safeEmit(In.USER_PUBLISHED,y,l)),this._p2pChannel.hasPendingRemoteMedia(y,l)&&(G.debug("[".concat(this._clientId,"] resubscribe ").concat(l," for user ").concat(y.uid," after reconnect.")),this._subscribe(y,l,!0).catch(A=>{G.error("[".concat(this._clientId,"] resubscribe error"),A.toString())}))}),this._config=e,this._clientId=t||Br(5,"client-"),this.store=new class{constructor(l,f,m,E){Bt(this,"state",void 0),this.state={codec:l,audioCodec:f,mode:m,clientId:E,sessionId:null,p2pId:0,dcId:0,pubId:0,subId:0,keyMetrics:{publish:[],subscribe:[]},joinChannelServiceRecords:[],cloudProxyServerMode:"disabled",useP2P:!1,p2pTransport:Gp.Default,hasStartJoinChannel:!1,isABTestSuccess:!1}}dispatch(l){this.state=function(f,m){switch(m.type){case Gn.SET_SESSION_ID:return It(It({},f),{},{sessionId:m.sessionId});case Gn.SET_P2P_ID:return It(It({},f),{},{p2pId:m.p2pId});case Gn.SET_UID:return It(It({},f),{},{uid:m.uid});case Gn.SET_INT_UID:return It(It({},f),{},{intUid:m.intUid});case Gn.SET_PUB_ID:return It(It({},f),{},{pubId:m.pubId});case Gn.KEY_METRIC_CLIENT_CREATED:return It(It({},f),{},{keyMetrics:It(It({},f.keyMetrics),{},{clientCreated:m.metric})});case Gn.KEY_METRIC_JOIN_START:return It(It({},f),{},{keyMetrics:It(It({},f.keyMetrics),{},{joinStart:m.metric})});case Gn.KEY_METRIC_JOIN_END:return It(It({},f),{},{keyMetrics:It(It({},f.keyMetrics),{},{joinEnd:m.metric})});case Gn.KEY_METRIC_REQUEST_AP_START:return It(It({},f),{},{keyMetrics:It(It({},f.keyMetrics),{},{requestAPStart:m.metric})});case Gn.KEY_METRIC_REQUEST_AP_END:return It(It({},f),{},{keyMetrics:It(It({},f.keyMetrics),{},{requestAPEnd:m.metric})});case Gn.KEY_METRIC_JOIN_GATEWAY_START:return It(It({},f),{},{keyMetrics:It(It({},f.keyMetrics),{},{joinGatewayStart:m.metric})});case Gn.KEY_METRIC_JOIN_GATEWAY_END:return It(It({},f),{},{keyMetrics:It(It({},f.keyMetrics),{},{joinGatewayEnd:m.metric})});case Gn.KEY_METRIC_PEER_CONNECTION_START:return It(It({},f),{},{keyMetrics:It(It({},f.keyMetrics),{},{peerConnectionStart:m.metric})});case Gn.KEY_METRIC_PEER_CONNECTION_END:return It(It({},f),{},{keyMetrics:It(It({},f.keyMetrics),{},{peerConnectionEnd:m.metric})});case Gn.KEY_METRIC_DESCRIPTION_START:return It(It({},f),{},{keyMetrics:It(It({},f.keyMetrics),{},{descriptionStart:m.metric})});case Gn.KEY_METRIC_SIGNAL_CHANNEL_OPEN:return It(It({},f),{},{keyMetrics:It(It({},f.keyMetrics),{},{signalChannelOpen:m.metric})});case Gn.KEY_METRIC_ICE_CONNECTION_END:return It(It({},f),{},{keyMetrics:It(It({},f.keyMetrics),{},{iceConnectionEnd:m.metric})});case Gn.KEY_METRIC_PUBLISH:{const E=f.keyMetrics.publish,y=E.findIndex(b=>b.trackId===m.metric.trackId);return y!==-1?(E[y]=It(It({},E[y]),m.metric),It(It({},f),{},{keyMetrics:It(It({},f.keyMetrics),{},{publish:[...E]})})):It(It({},f),{},{keyMetrics:It(It({},f.keyMetrics),{},{publish:[...f.keyMetrics.publish,m.metric]})})}case Gn.KEY_METRIC_SUBSCRIBE:{const E=f.keyMetrics.subscribe,y=E.findIndex(b=>b.userId===m.metric.userId&&b.type===m.metric.type);return y!==-1?(E[y]=It(It({},E[y]),m.metric),It(It({},f),{},{keyMetrics:It(It({},f.keyMetrics),{},{subscribe:[...E]})})):It(It({},f),{},{keyMetrics:It(It({},f.keyMetrics),{},{subscribe:[...f.keyMetrics.subscribe,m.metric]})})}case Gn.SET_CLOUD_PROXY_SERVER_MODE:return f.cloudProxyServerMode=m.mode,f;case Gn.RECORD_JOIN_CHANNEL_SERVICE:return typeof m.index!="number"?f.joinChannelServiceRecords=[...f.joinChannelServiceRecords,m.record]:(f.joinChannelServiceRecords[m.index]=It(It({},f.joinChannelServiceRecords[m.index]),m.record),f.joinChannelServiceRecords=[...f.joinChannelServiceRecords]),f;case Gn.RESET_JOIN_CHANNEL_SERVICE_RECORDS:return f.joinChannelServiceRecords=[],f;case Gn.RESET_KEY_METRICS:return f.keyMetrics={publish:[],subscribe:[]},f;case Gn.SET_USE_P2P:return It(It({},f),{},{useP2P:m.val});case Gn.SET_TRANSPORT_TYPE:return It(It({},f),{},{p2pTransport:m.val});default:return f}}(this.state,l)}set sessionId(l){this.dispatch({type:Gn.SET_SESSION_ID,sessionId:l})}get sessionId(){return this.state.sessionId}set cid(l){this.state.cid=l}get cid(){return this.state.cid}set codec(l){this.state.codec=l}get codec(){return this.state.codec}get mode(){return this.state.mode}get audioCodec(){return this.state.audioCodec}get clientId(){return this.state.clientId}set p2pId(l){this.dispatch({type:Gn.SET_P2P_ID,p2pId:l})}get p2pId(){return this.state.p2pId}set dcId(l){this.dispatch({type:Gn.SET_DC_ID,dcId:l})}get dcId(){return this.state.dcId}set uid(l){this.dispatch({type:Gn.SET_UID,uid:l})}get uid(){return this.state.uid}set intUid(l){this.dispatch({type:Gn.SET_INT_UID,intUid:l})}get intUid(){return this.state.intUid}set pubId(l){this.dispatch({type:Gn.SET_PUB_ID,pubId:l})}get pubId(){return this.state.pubId}set cloudProxyServerMode(l){this.dispatch({type:Gn.SET_CLOUD_PROXY_SERVER_MODE,mode:l})}get cloudProxyServerMode(){return this.state.cloudProxyServerMode}set useP2P(l){this.dispatch({type:Gn.SET_USE_P2P,val:l})}get useP2P(){return this.state.useP2P}set p2pTransport(l){this.dispatch({type:Gn.SET_TRANSPORT_TYPE,val:l})}get p2pTransport(){return this.state.p2pTransport}set hasStartJoinChannel(l){this.state.hasStartJoinChannel=l}get hasStartJoinChannel(){return this.state.hasStartJoinChannel}set isABTestSuccess(l){this.state.isABTestSuccess=l}get isABTestSuccess(){return this.state.isABTestSuccess}clientCreated(){this.dispatch({type:Gn.KEY_METRIC_CLIENT_CREATED,metric:Date.now()})}joinStart(){this.dispatch({type:Gn.KEY_METRIC_JOIN_START,metric:Date.now()})}joinEnd(){this.dispatch({type:Gn.KEY_METRIC_JOIN_END,metric:Date.now()})}requestAPStart(){this.dispatch({type:Gn.KEY_METRIC_REQUEST_AP_START,metric:Date.now()})}requestAPEnd(){this.dispatch({type:Gn.KEY_METRIC_REQUEST_AP_END,metric:Date.now()})}joinGatewayStart(){this.dispatch({type:Gn.KEY_METRIC_JOIN_GATEWAY_START,metric:Date.now()})}joinGatewayEnd(){this.dispatch({type:Gn.KEY_METRIC_JOIN_GATEWAY_END,metric:Date.now()})}peerConnectionStart(){this.dispatch({type:Gn.KEY_METRIC_PEER_CONNECTION_START,metric:Date.now()})}peerConnectionEnd(){this.dispatch({type:Gn.KEY_METRIC_PEER_CONNECTION_END,metric:Date.now()})}descriptionStart(){this.dispatch({type:Gn.KEY_METRIC_DESCRIPTION_START,metric:Date.now()})}signalChannelOpen(){this.dispatch({type:Gn.KEY_METRIC_SIGNAL_CHANNEL_OPEN,metric:Date.now()})}iceConnectionEnd(){this.dispatch({type:Gn.KEY_METRIC_ICE_CONNECTION_END,metric:Date.now()})}publish(l,f,m,E){this.dispatch({type:Gn.KEY_METRIC_PUBLISH,metric:It(It({trackId:l,type:f},m&&{publishStart:m}),E&&{publishEnd:E})})}subscribe(l,f,m,E,y,b,A){this.dispatch({type:Gn.KEY_METRIC_SUBSCRIBE,metric:It(It(It(It(It({userId:l,type:f},m&&{subscribeStart:m}),E&&{subscribeEnd:E}),y&&{firstFrame:y}),b&&{streamAdded:b}),A&&{firstDecoded:A})})}massSubscribe(l,f,m,E){l.forEach(y=>{this.dispatch({type:Gn.KEY_METRIC_SUBSCRIBE,metric:It(It(It({userId:y.userId,type:y.type},f&&{subscribeStart:f}),m&&{subscribeEnd:m}),E&&{firstFrame:E})})})}get keyMetrics(){return this.state.keyMetrics}recordJoinChannelService(l,f){l.service==="gateway"&&Array.isArray(l.urls)&&(l.urls=l.urls.map(m=>m.replace(/(\d+)-\d+-\d+-(\d+)/,"$1-*-*-$2")));try{return typeof f!="number"?(this.dispatch({type:Gn.RECORD_JOIN_CHANNEL_SERVICE,record:It(It({},l),{},{sessionId:this.sessionId,cloudProxyMode:this.cloudProxyServerMode,uid:this.uid})}),this.state.joinChannelServiceRecords.length-1):(f<0||f>=this.state.joinChannelServiceRecords.length||this.dispatch({type:Gn.RECORD_JOIN_CHANNEL_SERVICE,record:l,index:f}),f)}catch{return 0}}resetJoinChannelServiceRecords(){this.dispatch({type:Gn.RESET_JOIN_CHANNEL_SERVICE_RECORDS})}resetKeyMetrics(){this.dispatch({type:Gn.RESET_KEY_METRICS})}get joinChannelServiceRecords(){try{return this.state.joinChannelServiceRecords}catch{return[]}}}(e.codec,e.audioCodec,e.mode,this._clientId),this._leaveMutex=new Gi("client-leave",this._clientId),this._publishMutex=new Gi("client-publish",this._clientId),this._renewTokenMutex=new Gi("client-renewtoken",this._clientId),this._subscribeMutex=new Gi("client-subscribe",this._clientId),this.store.clientCreated(),e.proxyServer&&this.setProxyServer(e.proxyServer,!0),e.turnServer&&this.setTurnServer(e.turnServer,!0),G.info("[".concat(this._clientId,"] Initializing AgoraRTC client v").concat(hs," build: ").concat(k_,", mode: ").concat(this.mode,", codec: ").concat(this.codec)),e.clientRoleOptions)try{L_(e.clientRoleOptions),r=Object.assign({},e.clientRoleOptions)}catch(l){G.warning("[".concat(this._clientId,"] ").concat(l.toString()))}var s;this._statsCollector=new UI(this.store),this._statsCollector.onStatsException=(l,f,m)=>{G.warn("[".concat(this._clientId,"] receive exception msg, code: ").concat(l,", msg: ").concat(f,", uid: ").concat(m)),this.safeEmit(In.EXCEPTION,{code:l,msg:f,uid:m})},this._statsCollector.onUploadPublishDuration=(l,f,m,E)=>{const y=this._users.find(b=>b.uid===l);y&&Vt.peerPublishStatus(this._sessionId,{subscribeElapse:E,audioPublishDuration:f,videoPublishDuration:m,peer:y._uintid})},this._statsCollector.onVideoCodecChanged=l=>{if(me("VIDEO_STANDARD_BITRATE_VERSION")&&(l==="av1"||l==="h265"||l==="h264")){const f=this.localTracks.find(m=>m instanceof Kr);f&&f._saveEncodeBitrateRatio!==1&&f.setSaveEncodeBitrateRatio(l==="h264"?me("BASELINE_MORE_H264_BITRATE_RATIO"):void 0)}},this.store.useP2P=e.mode==="p2p",this._gateway=new AU(this.store,{clientId:this._clientId,mode:this.mode,codec:this.codec,websocketRetryConfig:e.websocketRetryConfig||ra,httpRetryConfig:e.httpRetryConfig||ra,forceWaitGatewayResponse:e.forceWaitGatewayResponse===void 0||e.forceWaitGatewayResponse,statsCollector:this._statsCollector,role:e.role,clientRoleOptions:r}),this._configDistribute=new Wg(this._clientId,this.store),this.store.useP2P?(this._p2pChannel=(s={store:this.store,statsCollector:this._statsCollector},wh("P2PChannel").create(s)),this._handleP2PEvents()):this._p2pChannel=new w1(this.store,this._statsCollector),this._handleP2PChannelEvents(),this._handleGatewayEvents(),this._handleGatewaySignalEvents()}async joinMeta(e,t,r,s,l){let f=!(arguments.length>5&&arguments[5]!==void 0)||arguments[5],m=arguments.length>6&&arguments[6]!==void 0&&arguments[6];Dn("JOIN_GATEWAY_USE_443PORT_ONLY",f),Dn("JOIN_GATEWAY_USE_DUAL_DOMAIN",m);const E=this._gateway.signal.websocket;return E instanceof Jp&&(E.use443PortOnly=f,E.tryDoubleDomain=m),async function(y,b,A){eI.get(y)||eI.set(y,[]),gS.get(y)||gS.set(y,b),Vo.get(y)||Vo.set(y,0);const O=eI.get(y),D=gS.get(y);if(!O||!D)throw new Error("concurrent: deferQueue or maxConcurrency is null");if(Vo.get(y)===D){const $=N_();O.push($),await $.promise}Vo.set(y,Vo.get(y)+1);for(var P=arguments.length,F=new Array(P>3?P-3:0),B=3;B<P;B++)F[B-3]=arguments[B];const Y=await A(...F);return Vo.set(y,Vo.get(y)-1),Vo.get(y)===D-1&&O.length>0&&(O[0].resolve(),O.shift()),Vo.get(y)===0&&(eI.set(y,[]),gS.set(y,0),Vo.set(y,0)),Y}("client.join",me("JOIN_MAX_CONCURRENCY"),this.join.bind(this),e,t,r,s,l)}async join(e,t,r,s,l){const f=++this._numberOfJoinCount;this.store.joinStart(),s&&(this.store.uid=s);const m=(sI||sI||(sI=(window.location.protocol.split(":")[0]||"").toUpperCase(),sI))==="HTTPS",E=Hb()?window.isSecureContext:"Browser Not Support";(!Hb()&&!m||!window.isSecureContext)&&G.warning("The website must be running in a secure context (About secure context: https://developer.mozilla.org/en-US/docs/Web/Security/Secure_Contexts ), otherwise the media collection will be restricted by the browser"),Vt.setAppId(e);try{if(!r&&r!==null)throw new xe(se.INVALID_PARAMS,"Invalid token: ".concat(r,". If you don not use token, set it to null"));r&&Oa(r,"token",1,2047),Oa(e,"appid",1,2047),lr(t),s&&La(s),l&&Oa(l,"optionalInfo",1,2047)}catch(B){throw Vt.reportApiInvoke(Na(),{name:Di.JOIN,options:[e,t,r,s],states:{isHttps:m,isSecureContext:E},tag:Bn.TRACER}).onError(B),B}if(this._leaveMutex.isLocked&&(G.debug("[".concat(this._clientId,"] join: waiting leave operation")),(await this._leaveMutex.lock())(),G.debug("[".concat(this._clientId,"] join: continue"))),this._joinAndNotLeaveYet=!0,this.connectionState!=="DISCONNECTED"){const B=new xe(se.INVALID_OPERATION,"[".concat(this._clientId,"] Client already in connecting/connected state"));throw Vt.reportApiInvoke(Na(),{name:Di.JOIN,options:[e,t,r,s],states:{isHttps:m,isSecureContext:E},tag:Bn.TRACER}).onError(B),B}this._gateway.state="CONNECTING";const y=await sF({appId:e,cname:t,uid:s,stringUid:typeof s=="string"?s:void 0,token:r||e,cloudProxyServer:this._cloudProxyServerMode});if(!this._joinAndNotLeaveYet)throw new xe(se.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"));const b=(y==null?void 0:y.sid)||Na();G.info("[".concat(this._clientId,"] start join channel ").concat(t,", join number: ").concat(f)),this._sessionId||(this._sessionId=b,this.store.sessionId=this._sessionId);const A=Vt.reportApiInvoke(b,{id:this._clientId,name:Di.JOIN,options:[e,t,r,s],states:{isHttps:m,isSecureContext:E},tag:Bn.TRACER}),O=cd(cd(cd({},this._rtmConfig),{},{role:this.role,clientId:this._clientId,appId:e,sid:this._sessionId,cname:t,uid:typeof s!="string"?s:null,turnServer:this._turnServer,proxyServer:this._proxyServer,token:r||e,cloudProxyServer:this._cloudProxyServerMode,optionalInfo:l,license:this._license,useLocalAccessPoint:this._useLocalAccessPoint,preload:!!y},this._remoteDefaultVideoStreamType!==void 0&&{defaultVideoStream:this._remoteDefaultVideoStreamType}),{},{apRequestDetail:me("AP_REQUEST_DETAIL")||void 0});if(this._useLocalAccessPoint&&(O.setLocalAPVersion=this._setLocalAPVersion),typeof s=="string"&&(O.stringUid=s,this._uintUid?(O.uid=this._uintUid,this._uintUid=void 0):O.uid=0),this._encryptionMode!=="none"&&this._encryptionSecret){if(O.aesmode=this._encryptionMode,O.aespassword=await(async B=>{const Y=function(Re){const Ie=window.atob(`MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDCMnXAHkKIGAM+x4N22gCI+Wyu
STM9ztkT3uYslTT2PuKmZfPzhH6kVdO7PTjGCOZnAsyb3oTtWat0KcxQ4jxvqQV+
HvYl3iI1Yd4vl2c3qRMJPLtRDfNxa2Mcxgq7e9aEUibzdd0st+OJAy3tOj/Y0aVy
xQiYDz3vqa6bP29adwIDAQAB`),we=new Uint8Array(new ArrayBuffer(Ie.length));for(let Ue=0;Ue<Ie.length;Ue+=1)we[Ue]=Ie.charCodeAt(Ue);return we}(),$=await window.crypto.subtle.importKey("spki",Y,{name:"RSA-OAEP",hash:"SHA-256"},!0,["encrypt"]),ee=vS(B),Ee=await window.crypto.subtle.encrypt({name:"RSA-OAEP"},$,ee);return function(Re){let Ie="";for(let we=0;we<Re.length;we+=1)Ie+=String.fromCharCode(Re[we]);return window.btoa(Ie)}(new Uint8Array(Ee))})(this._encryptionSecret),!this._joinAndNotLeaveYet)throw new xe(se.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"));this._encryptionSalt&&(O.aessalt=this._encryptionSalt)}if(this._encryptDataStream&&(this._encryptionMode==="aes-128-gcm2"||this._encryptionMode==="aes-256-gcm2"))if(this._encryptionSalt&&this._encryptionSecret)if(window.crypto.subtle){const B=new TextEncoder,Y=me("USE_PURE_ENCRYPTION_MASTER_KEY")?B.encode(O.appId+this._encryptionSecret+this._encryptionSecret):B.encode(O.appId+O.cname+this._encryptionSecret);this._encryptDataStreamIv=await async function($,ee,Ee){const Re=await window.crypto.subtle.importKey("raw",ee,"PBKDF2",!1,["deriveBits","deriveKey"]),Ie=$==="aes-128-gcm2"?128:256,we=await window.crypto.subtle.deriveBits({name:"PBKDF2",iterations:p8,hash:"SHA-256",salt:Ee},Re,Ie+Nx);return new Uint8Array(we).subarray(Ie/8)}(this._encryptionMode,Y,P_(this._encryptionSalt)),this._encryptDataStreamKey=await async function($,ee,Ee){const Re=await window.crypto.subtle.importKey("raw",ee,"PBKDF2",!1,["deriveBits","deriveKey"]),Ie=$==="aes-128-gcm2"?128:256;return await window.crypto.subtle.deriveKey({name:"PBKDF2",iterations:p8,hash:"SHA-256",salt:Ee},Re,{name:"AES-GCM",length:Ie},!0,["encrypt","decrypt"])}(this._encryptionMode,Y,P_(this._encryptionSalt))}else E?G.warning("[".concat(this._clientId,"] encrypt datastream must be running in a secure context, fallback to plain data stream")):G.warning("[".concat(this._clientId,"] current browser do not support WebCrypto ,fallback to plain data stream")),this._encryptDataStream=!1;else this._encryptDataStream=!1,G.debug("[".concat(this._clientId,"] no salt / secret, cannot support encrypt data stream, fallback to plain data stream"));this._startSession(this._sessionId,{channel:t,appId:e,stringUid:O.stringUid});const D=this._sessionId;setTimeout(()=>{this.connectionState==="CONNECTING"&&D===this._sessionId&&Vt.joinChannelTimeout(this._sessionId,5)},5e3);try{var P;let B;const Y=O.cloudProxyServer;if(ht(P=["proxy3","proxy4","proxy5"]).call(P,Y)){const Ie=me("PROXY_SERVER_TYPE3");Array.isArray(Ie)?O.proxyServer=Ie[0]:O.proxyServer=Ie}if(Vt.setProxyServer(O.proxyServer),G.setProxyServer(O.proxyServer),this.store.requestAPStart(),y){if(G.debug("[".concat(this._clientId,"] get serverInfo Success from Preload Cache ").concat(O.stringUid?", ".concat(O.stringUid," => ").concat(y.intUid):""," ")),O.stringUid&&!O.uid&&(O.uid=y.intUid),B={gatewayInfo:y.ap.gatewayInfo},me("JOIN_WITH_FALLBACK_MEDIA_PROXY")&&O.turnServer.mode==="auto")if(y.ap.proxyInfo.addresses.length===0)G.warning("no edge services in ap response of proxy fallback, will not set proxy in iceServers");else{const Ie=(await bU(y.ap.proxyInfo,y.ap.gatewayInfo.uid)).map(we=>({turnServerURL:we.address,tcpport:we.tcpport||ps.tcpport,udpport:we.udpport||ps.udpport,username:we.username||ps.username,password:we.password||ps.password,forceturn:!1,security:!0}));O.turnServer={mode:"manual",servers:Ie}}wD(y,O.stringUid)}else{if(O.stringUid&&!O.uid){let Ie;[Ie,B]=await gt.all([T1(O.stringUid,O,this._axiosCancelSource.token,this._config.httpRetryConfig||ra,this.store),W_(O,this._axiosCancelSource.token,this._config.httpRetryConfig||ra,!0,this.store)]),G.debug("[".concat(this._clientId,"] getUserAccount Success ").concat(O.stringUid," => ").concat(Ie)),O.uid=Ie,B.gatewayInfo.uid=Ie,B.gatewayInfo.res.uid=Ie}else B=await W_(O,this._axiosCancelSource.token,this._config.httpRetryConfig||ra,!0,this.store);if(!this._joinAndNotLeaveYet)throw new xe(se.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"))}this.store.requestAPEnd(),setTimeout(()=>{this._configDistribute.startGetConfigDistribute(O,this._axiosCancelSource.token),this._configDistribute.on(sd.UPDATE_BITRATE_LIMIT,Ie=>{this._p2pChannel.updateBitrateLimit(Ie)}),this._configDistribute.on(sd.UPDATE_CLIENT_ROLE_OPTIONS,Ie=>{this._setClientRoleOptions(Ie)})},0),this._key=r||e;const $=B.gatewayInfo,ee=O.uid?O.uid:$.uid;this._joinInfo=cd(cd({},O),{},{cid:$.cid,uid:ee,vid:$.vid,apResponse:$.res,apGatewayAddress:$.apGatewayAddress,uni_lbs_ip:$.uni_lbs_ip,gatewayAddrs:$.gatewayAddrs}),this.store.intUid=ee,this.store.cid=$.cid;const Ee=await this._joinGateway();if(!this._joinAndNotLeaveYet)throw new xe(se.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"));A.onSuccess(Ee),this._appId=e,this._channelName=O.cname,this._uid=Ee,this.store.uid=Ee,setTimeout(()=>{this._networkQualityInterval&&window.clearInterval(this._networkQualityInterval),this._networkQualityInterval=window.setInterval(this._handleUpdateNetworkQuality,2e3),window.addEventListener(ns()?"beforeunload":"pagehide",this._handleBeforeUnload),this._statsCollector.startUpdateStats()},0);const Re=O.stringUid?"string uid: ".concat(O.stringUid,",uid: ").concat(O.uid):"uid: ".concat(this._uid);return G.info("[".concat(this._clientId,"] Joining channel success: channel: ").concat(t,",").concat(Re)),setTimeout(()=>{G.startUpload()},5e3),this.store.joinEnd(),F=this,ht(LS).call(LS,F)||LS.push(F),this._cloudProxyServerMode==="disabled"&&zn().supportWebCrypto&&me("ENABLE_PRELOAD")&&Z_(this._joinInfo),Ee}catch(B){const Y=Array.isArray(B)?B[0]:B;throw Y&&Y.code===se.OPERATION_ABORTED?G.warning("[".concat(this._clientId,"] join number: ").concat(f,", Joining channel failed, rollback"),Y):G.error("[".concat(this._clientId,"] join number: ").concat(f,", Joining channel failed, rollback"),Y),Y.code!==se.OPERATION_ABORTED&&this._numberOfJoinCount===f&&(this._gateway.state="DISCONNECTED",this._reset()),A.onError(Y),Y}var F}_joinGateway(){if(!this._joinInfo||!this._key)throw new xe(se.INVALID_OPERATION);return this._gateway.join(this._joinInfo,this._key,!(this._joinInfo.cloudProxyServer!=="disabled"||this._joinInfo.proxyServer||!me("JOIN_WITH_FALLBACK_SIGNAL_PROXY")))}async leave(){G.info("[".concat(this._clientId,"] Leaving channel")),window.removeEventListener(ns()?"beforeunload":"pagehide",this._handleBeforeUnload),this._reset(),function(t){const r=LS.indexOf(t);r!==-1&&LS.splice(r,1)}(this),this._statsCollector.stopUpdateStats();const e=await this._leaveMutex.lock();if(this.connectionState==="DISCONNECTED")return G.info("[".concat(this._clientId,"] Leaving channel repeated, success")),void e();await this._gateway.leave(this.connectionState!=="CONNECTED",nr.LEAVE),G.info("[".concat(this._clientId,"] Leaving channel success")),this._joinAndNotLeaveYet=!1,this.store.resetJoinChannelServiceRecords(),e()}async publish(e){let t=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(!Array.isArray(e)){if(!(e instanceof $b))return this._publishDataChannel(e);e=[e]}if(e.length===0)throw new xe(se.INVALID_PARAMS,"param list is empty");const r=e;if(this._gateway.role==="audience")throw new xe(se.INVALID_OPERATION,"audience can not publish stream");for(const l of r){if(!(l instanceof $b))throw new xe(se.INVALID_PARAMS,"parameter is not local track");if(!l._enabled&&t)throw new xe(se.TRACK_IS_DISABLED,"can not publish a disabled track: ".concat(l.getTrackId()))}G.info("[".concat(this._clientId,"] Publishing tracks, id ").concat(r.map(l=>"".concat(l.getTrackId()," "))));const s=await this._publishMutex.lock();await this._configDistribute.awaitConfigDistributeComplete(),t&&r.forEach(l=>{const f=this._configDistribute.getBitrateLimit();l instanceof Kr&&f&&l.setBitrateLimit(f.uplink)});try{await this._publishHighStream(r),G.info("[".concat(this._clientId,"] Publish success, id ").concat(r.map(l=>"".concat(l.getTrackId()," "))))}catch(l){throw G.error("[".concat(this._clientId,"] publish error"),l.toString()),l}finally{s()}}async _publishDataChannel(e){wr(e.id,"id",0,65535,!0),hh(e.ordered,"ordered"),Oa(e.metadata,"metadata",0,512),G.info("[".concat(this._clientId,"] Publishing datachannels, id ").concat(e.id));const t=await this._publishMutex.lock();try{if(this._p2pChannel.getAllDataChannels().findIndex(l=>l.id===e.id)!==-1)throw new xe(se.INVALID_PARAMS,"Invalid id: ".concat(e.id,". If you want to republish the datachannel, unpublish first"));if(!this._joinInfo||this._uid===void 0)throw new xe(se.INVALID_OPERATION,"Can't publish datachannel, haven't joined yet!");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new xe(se.INVALID_OPERATION,"can not publish datachannel in ".concat(this.connectionState," state"));if(this._turnServer.mode==="auto"&&me("FORCE_TURN")&&!me("TURN_ENABLE_TCP")&&!me("TURN_ENABLE_UDP"))throw new xe(se.UNEXPECTED_ERROR,"force TURN With No TURN Configuration");const r=function(l){return q8(l,!1)}(e),s=await this._p2pChannel.publishDataChannel([r]);if(s.length>0){if(typeof r._originDataChannelId!="number")throw G.error("[".concat(this._clientId,"] can not publish with mediaType datachannel, cannot get RTCDatachannel id")),new xe(se.CREATE_DATACHANNEL_ERROR);try{await gt.all(s.map(l=>this._uid&&this._gateway.publishDataChannel(this._uid,l,!0))),await r._waitTillOpen()}catch(l){if(l.code!==se.DISCONNECT_P2P)throw l}}return G.info("[".concat(this._clientId,"] Publish dataChannels success, id ").concat(r.id)),r}catch(r){throw G.error("[".concat(this._clientId,"] publish datachannels error"),r.toString()),r}finally{t()}}async unpublish(e){if(!this._joinInfo||this._uid===void 0)throw new xe(se.INVALID_OPERATION,"Can't unpublish stream, haven't joined yet!");let t=[];if(e)if(Array.isArray(e))t=e;else{if(!(e instanceof $b))return this._unpublishDataChannel([e]);t=[e]}else this.store.useP2P||await this._unpublishDataChannel(),t=this._p2pChannel.getAllTracks(!0);G.info("[".concat(this._clientId,"] Unpublish tracks, tracks ").concat(t.map(s=>"".concat(s.getTrackId()," "))," "));const r=await this._publishMutex.lock();try{if(this.store.useP2P){const s=await this._p2pChannel.unpublish(t);s&&await this._gateway.sendExtensionMessage(ia.UNPUBLISH,{unpubMsg:s},!0)}else{const s=await this._p2pChannel.unpublish(t);s&&await this._gateway.unpublish(s,this._uid),G.info("[".concat(this._clientId,"] Unpublish success,tracks ").concat(t.map(l=>"".concat(l.getTrackId()))))}}catch(s){throw G.error("[".concat(this._clientId,"] unpublish error"),s.toString()),s}finally{r&&r()}}async _unpublishDataChannel(e){e!==void 0&&e.length!==0||(e=this._p2pChannel.getAllDataChannels()),G.info("[".concat(this._clientId,"] Unpublish datachannels, datachannels ").concat(e.map(r=>"".concat(r.id," "))," "));const t=await this._publishMutex.lock();try{const r=await this._p2pChannel.unpublishDataChannel(e);r&&await this._gateway.unpublishDataChannel(r),G.info("[".concat(this._clientId,"] Unpublish dataChannel success,dataChannel ").concat(e.map(s=>"".concat(s.id))))}catch(r){throw G.error("[".concat(this._clientId,"] unpublish dataChannel error"),r.toString()),r}finally{t&&t()}}async subscribe(e,t,r){if(!(e instanceof K_)){const s=this.remoteUsers.find(l=>l.uid===e);if(!s)throw new xe(se.INVALID_REMOTE_USER,"user is not in the channel");e=s}return t==="datachannel"?this._subscribeDataChannel(e,r):this._subscribe(e,t)}async presubscribe(e,t){if(Aa(t,"mediaType",["audio","video"]),this.store.useP2P)throw new xe(se.INVALID_OPERATION,"can't presub at p2p mode");if(!this._joinInfo)throw new xe(se.INVALID_OPERATION,"can't presub when not join");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new xe(se.INVALID_OPERATION,"can't presub in ".concat(this.connectionState," state"));const r=t===ut.AUDIO,s=t===ut.VIDEO,l=await this._subscribeMutex.lock();try{const{ssrcId:f,ortc:m,rtxSsrcId:E,cname:y,uint_id:b}=await this._gateway.presubscribe(e,t,!0);if(f==null)throw new xe(se.UNEXPECTED_RESPONSE,"no ssrc id");let A=this._users.find(D=>D.uid===e);A||(A=new K_(e,b||e),A._is_pre_created=!0,this._users.push(A)),y&&(A._cname=y),A._uintid||(A._uintid=b||e),r&&(A._audioSSRC=f,A._audio_pre_subscribed=!0,m&&(A._audioOrtc=m)),s&&(A._videoSSRC=f,A._video_pre_subscribed=!0,m&&(A._videoOrtc=m),E!=null&&(A._rtxSsrcId=E)),G.info("[".concat(this._clientId,"] presub succeed ssrc: ").concat(f)),await this._p2pChannel.subscribe(A,t,f,E,m);const O=r?A._audioTrack:A._videoTrack;if(!O)throw new xe(se.UNEXPECTED_ERROR,"can not find remote track in user");return r&&(A._trust_audio_stream_added_state_=!0,A._audio_added_=!0),s&&(A._trust_video_stream_added_state_=!0,A._video_added_=!0),O}catch(f){throw G.error("[".concat(this._clientId,"] presub user ").concat(e," error"),f),f}finally{l()}}async _subscribeDataChannel(e,t){var r;if(wr(t,"channelId",0,65535,!0),!this._joinInfo)throw new xe(se.INVALID_OPERATION,"Can't subscribe datachannel, not joined");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new xe(se.INVALID_OPERATION,"Can't subscribe datachannel in ".concat(this.connectionState," state"));if(!this._users.find(E=>E===e))throw G.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid,", this user is not in the channel")),new xe(se.INVALID_REMOTE_USER,"user is not in the channel");if(!e.hasAudio&&!e.hasVideo&&e._dataChannels.length===0)throw G.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid,", user is not published")),new xe(se.INVALID_REMOTE_USER,"user is not published");const l=(r=e._dataChannels)===null||r===void 0?void 0:r.find(E=>E.id===t);if(!l)throw G.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid," with mediaType datachannel, remote datachannel is not published")),new xe(se.REMOTE_USER_IS_NOT_PUBLISHED);const f=await this._subscribeMutex.lock();G.info("[".concat(this._clientId,"] subscribe user ").concat(e.uid,", mediaType: datachannel"));try{const E=await this._p2pChannel.subscribeDataChannel(e,[l]);if(E&&ht(E).call(E,l.id))try{var m;if(typeof l._originDataChannelId!="number")throw G.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid," with mediaType datachannel, cannot get RTCDatachannel")),new xe(se.CREATE_DATACHANNEL_ERROR);const y={id:l.id,datachannelId:l._originDataChannelId,ordered:l.ordered,maxRetransmits:l.maxRetransmits,metadata:(m=l.metadata)!==null&&m!==void 0?m:""};await this._gateway.subscribeDataChannel(e.uid,y,!0),await l._waitTillOpen()}catch(y){if((y==null?void 0:y.code)!==se.WS_ABORT)throw await this._p2pChannel.unsubscribeDataChannel(e,[l]),y;await this._p2pChannel.unsubscribeDataChannel(e,[l]),this._p2pChannel.setPendingRemoteDataChannel(e,l.id)}return G.info("[".concat(this._clientId,"] subscribe success user ").concat(e.uid,", mediaType: datachannel")),l}finally{f()}}async _p2pSubscribe(e,t,r){if(Aa(t,"mediaType",["audio","video"]),!this._joinInfo)throw new xe(se.INVALID_OPERATION,"Can't subscribe stream, not joined");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new xe(se.INVALID_OPERATION,"Can't subscribe stream in ".concat(this.connectionState," state"));if(!this._users.find(f=>f===e)){const f=new xe(se.INVALID_REMOTE_USER,"user is not in the channel");throw G.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid,", this user is not in the channel")),f}if(!e.hasAudio&&!e.hasVideo){const f=new xe(se.INVALID_REMOTE_USER,"user is not published");throw G.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid,", user is not published")),f}if(!r&&(t==="audio"&&!e.hasAudio||t==="video"&&!e.hasVideo)){const f=new xe(se.REMOTE_USER_IS_NOT_PUBLISHED);throw G.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid," with mediaType ").concat(t,", remote track is not published")),f}const l=await this._subscribeMutex.lock();G.info("[".concat(this._clientId,"] subscribe user ").concat(e.uid,", mediaType: ").concat(t));try{if(await this._p2pChannel.hasRemoteMediaWithLock(e,t))await this._p2pChannel.unmuteRemote(e,t);else try{const m=t==="audio"?e._audioSSRC:e._videoSSRC,E=t==="audio"?e._audioMid:e._videoMid;this.store.subscribe(e.uid,t,Date.now()),this.store.useP2P&&await this._p2pChannel.subscribe(e,t,m,E)}catch(m){throw m}G.info("[".concat(this._clientId,"] subscribe success user ").concat(e.uid,", mediaType: ").concat(t)),this._defaultStreamFallbackType&&this.setStreamFallbackOption(e.uid,this._defaultStreamFallbackType).catch(m=>{G.warning("[".concat(this._clientId,"] auto set fallback failed"),m)});const f=t==="audio"?e._audioTrack:e._videoTrack;if(!f)throw new xe(se.UNEXPECTED_ERROR,"can not find remote track in user object");return f}catch(f){throw G.error("[".concat(this._clientId,"] subscribe user ").concat(e.uid," error"),f),f}finally{l()}}async _subscribe(e,t,r){if(this.store.useP2P)return this._p2pSubscribe(e,t);if(Aa(t,"mediaType",["audio","video"]),!this._joinInfo)throw new xe(se.INVALID_OPERATION,"Can't subscribe stream, not joined");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new xe(se.INVALID_OPERATION,"Can't subscribe stream in ".concat(this.connectionState," state"));if(!this._users.find(b=>b===e)){const b=new xe(se.INVALID_REMOTE_USER,"user is not in the channel");throw G.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid,", this user is not in the channel")),b}if(!e.hasAudio&&!e.hasVideo){const b=new xe(se.INVALID_REMOTE_USER,"user is not published");throw G.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid,", user is not published")),b}if(!(r||(t!=="audio"||e.hasAudio&&e._audioSSRC!==void 0)&&(t!=="video"||e.hasVideo&&e._videoSSRC!==void 0))){const b=new xe(se.REMOTE_USER_IS_NOT_PUBLISHED);throw G.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid," with mediaType ").concat(t,", remote track is not published")),b}let l=t==="audio"?e._audioSSRC:e._videoSSRC,f=t==="audio"?e._audioOrtc:e._videoOrtc,m=t==="video"?e._rtxSsrcId:void 0,E={stream_type:t==="audio"?ut.AUDIO:ut.VIDEO,ssrcId:l};const y=await this._subscribeMutex.lock();G.info("[".concat(this._clientId,"] subscribe user ").concat(e.uid,", mediaType: ").concat(t));try{if(await this._p2pChannel.hasRemoteMediaWithLock(e,t))await this._p2pChannel.unmuteRemote(e,t);else try{const A=t==="audio"?e._audioSSRC:e._videoSSRC;A!==void 0&&A!==l&&(l=A,f=t==="audio"?e._audioOrtc:e._videoOrtc,m=t==="video"?e._rtxSsrcId:void 0,E={stream_type:t==="audio"?ut.AUDIO:ut.VIDEO,ssrcId:l}),ws.markSubscribeStart(this.store.clientId,l),this.store.subscribe(e.uid,t,Date.now()),await this._p2pChannel.subscribe(e,t,l,m,f);try{this._p2pChannel.isPreSubScribe(l)||await this._gateway.subscribe(e.uid,E,!0)}catch(O){if((O==null?void 0:O.code)!==se.WS_ABORT)throw await this._p2pChannel.unsubscribe(e,t),O;await this._p2pChannel.unsubscribe(e,t,!0),this._p2pChannel.setPendingRemoteMedia(e,t)}this.store.subscribe(e.uid,t,void 0,Date.now()),this._p2pChannel.reportSubscribeEvent(!0,null,e,t)}catch(A){throw this._p2pChannel.reportSubscribeEvent(!1,A==null?void 0:A.code,e,t),A}G.info("[".concat(this._clientId,"] subscribe success user ").concat(e.uid,", mediaType: ").concat(t)),this._defaultStreamFallbackType&&this.setStreamFallbackOption(e.uid,this._defaultStreamFallbackType).catch(A=>{G.warning("[".concat(this._clientId,"] auto set fallback failed"),A)});const b=t==="audio"?e._audioTrack:e._videoTrack;if(!b)throw new xe(se.UNEXPECTED_ERROR,"can not find remote track in user object");return b}catch(b){throw G.error("[".concat(this._clientId,"] subscribe user ").concat(e.uid," error"),b),b}finally{y()}}async massSubscribe(e){if(Bp(e,"subscribeList"),!this._joinInfo)throw new xe(se.INVALID_OPERATION,"Can't subscribe stream, not joined");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new xe(se.INVALID_OPERATION,"Can't subscribe stream in ".concat(this.connectionState," state"));const t=Date.now(),r=new Map,s=await this._subscribeMutex.lock();G.info("[".concat(this._clientId,"]start massSubscribe user ").concat(e.map(E=>{let{user:y,mediaType:b}=E;return"user: ".concat(y==null?void 0:y.uid,", mediaType: ").concat(b)}).join("; ")));const l=(e=[...e]).map(E=>{let{user:y,mediaType:b}=E;return{user:y,mediaType:b}}),f=await this._p2pChannel.globalLock();try{var m;for(let y=e.length-1;y>=0;y--){const b=e[y],{user:A,mediaType:O}=b;if(Aa(O,"mediaType",["audio","video"]),!A){const B=new xe(se.INVALID_PARAMS,"user property does not exist in subscribeList item");throw G.error("[".concat(this._clientId,"] user property does not exist in subscribeList item")),B}if(!this._users.find(B=>B===A)){const B=new xe(se.INVALID_REMOTE_USER,"user is not in the channel");G.error("[".concat(this._clientId,"] can not massSubscribe ").concat(A.uid,", this user is not in the channel")),l[y].error=B,e.splice(y,1);continue}if(O==="audio"&&(!A.hasAudio||A._audioSSRC===void 0)||O==="video"&&(!A.hasVideo||A._videoSSRC===void 0)){const B=new xe(se.REMOTE_USER_IS_NOT_PUBLISHED);G.error("[".concat(this._clientId,"] can not subscribe ").concat(A.uid," with mediaType ").concat(O,", remote user is not published")),l[y].error=B,e.splice(y,1);continue}const P=Mt.Video|Mt.LwoVideo,F=r.get(A);if(F){if(O==="video"?F&P:F&Mt.Audio){e.splice(y,1),G.warning("[".concat(this._clientId,"] repeat massSubscribe user:").concat(A.uid,", mediaType:").concat(O," twice"));continue}r.set(A,F|(O==="video"?P:Mt.Audio))}else r.set(A,O==="video"?P:Mt.Audio)}for(let y=e.length-1;y>=0;y--){const b=e[y],{user:A,mediaType:O}=b,D=Mt.Video|Mt.LwoVideo;if(this._p2pChannel.hasRemoteMedia(A,O)){await this._p2pChannel.unmuteRemoteNoLock(A,O);const P=r.get(A);r.set(A,O==="video"?P^D:P^Mt.Audio),e.splice(y,1)}}this.store.massSubscribe(e.map(y=>({userId:y.user.uid,type:y.mediaType})),t);let E=wc(m=Array.from(r.entries())).call(m,(y,b)=>{let[A,O]=b;if(O===0)return y;const D={stream_id:A.uid,stream_type:O};return O&Mt.Audio&&(D.audio_ssrc=A._audioSSRC),O&Mt.Video&&(D.video_ssrc=A._videoSSRC),y.push(D),y},[]);try{e.length>0&&await this._p2pChannel.massSubscribeNoLock(e.map(b=>{let{user:A,mediaType:O}=b;return{user:A,mediaType:O,ssrcId:O===ut.VIDEO?A._videoSSRC:A._audioSSRC,rtxSsrcId:O===ut.VIDEO?A._rtxSsrcId:void 0}}));const y=new Map;if(E=E.filter(b=>b.video_ssrc&&!this._p2pChannel.isPreSubScribe(b.video_ssrc)||b.audio_ssrc&&!this._p2pChannel.isPreSubScribe(b.audio_ssrc)||!b.video_ssrc&&!b.audio_ssrc),E.length>0){const b=await this._gateway.subscribeAll(E,!0);((b==null?void 0:b.users)||[]).forEach(A=>{let{stream_id:O,video_error_code:D,audio_error_code:P,error_code:F}=A;(D||P||F)&&y.set(O,{video_error_code:D,audio_error_code:P,error_code:F})})}if(Array.from(y.entries()).length>0){const b=[];Array.from(y.entries()).forEach(A=>{let[O,D]=A;const P=this.remoteUsers.find(F=>F.uid===O);if(P){let F;D.error_code||D.video_error_code&&D.audio_error_code?F=void 0:D.video_error_code?F=ut.VIDEO:D.audio_error_code&&(F=ut.AUDIO),b.push({user:P,mediaType:F})}}),b.length>0&&await this._p2pChannel.massUnsubscribeNoLock(b)}for(const b of l){const A=y.get(b.user.uid);if(A){const O=A.error_code||b.mediaType==="audio"&&A.audio_error_code||b.mediaType==="video"&&A.video_error_code;if(O){const D=RI(O);G.error("user:".concat(b.user.uid," mediaType:").concat(b.mediaType," has massSubscribe error ").concat(D.desc)),b.error=new xe(se.SUBSCRIBE_FAILED,"code ".concat(O,": ").concat(D.desc))}}b.error||(b.mediaType==="video"?b.track=b.user.videoTrack:b.track=b.user.audioTrack)}return this.store.massSubscribe(l.filter(b=>!b.error).map(b=>({userId:b.user.uid,type:b.mediaType})),void 0,Date.now()),l.forEach(b=>{var A;Vt.subscribe(this.store.sessionId,{succ:!!b.error,ec:((A=b.error)===null||A===void 0?void 0:A.code)||null,video:b.mediaType===ut.VIDEO,audio:b.mediaType===ut.AUDIO,peerid:b.user.uid,subscribeRequestid:b.mediaType===ut.VIDEO?b.user._videoSSRC:b.user._audioSSRC,p2pid:this.store.p2pId,eventElapse:Math.floor(performance.now()-t),preSsrc:this._p2pChannel.isPreSubScribe(b.user._videoSSRC)},!0)}),G.info("[".concat(this._clientId,"] massSubscribe success ").concat(e.map(b=>{let{user:A,mediaType:O}=b;return"user: ".concat(A==null?void 0:A.uid,", mediaType: ").concat(O)}).join("; "))),l}catch(y){throw await this._p2pChannel.massUnsubscribeNoLock(e),y}}finally{f(),s()}}async unsubscribe(e,t,r){if(!(e instanceof K_)){const f=this.remoteUsers.find(m=>m.uid===e);if(!f)throw new xe(se.INVALID_REMOTE_USER,"user is not in the channel");e=f}if(t||this.store.useP2P){if(t==="datachannel")return this._unsubscribeDataChannel(e,r)}else await this._unsubscribeDataChannel(e,r);if(t&&Aa(t,"mediaType",["audio","video"]),!this._joinInfo)throw new xe(se.INVALID_OPERATION,"Can't unsubscribe stream, haven't joined yet!");if(!this._users.find(f=>f===e)){const f=new xe(se.INVALID_REMOTE_USER,"user is not in the channel");throw G.error("[".concat(this._clientId,"] can not unsubscribe ").concat(e.uid,", user is not in the channel")),f}G.info("[".concat(this._clientId,"] unsubscribe uid: ").concat(e.uid,", mediaType: ").concat(t));const l=await this._subscribeMutex.lock();try{if(this.store.useP2P)await this._p2pChannel.unsubscribe(e,t);else{const f=await this._p2pChannel.unsubscribe(e,t);f&&await this._gateway.unsubscribe(f,e.uid),t&&t!=="audio"||(e._audio_pre_subscribed=!1),t&&t!=="video"||(e._video_pre_subscribed=!1),e._is_pre_created&&Qd(this._users,e),G.info("[".concat(this._clientId,"] unsubscribe success uid: ").concat(e.uid,", mediaType: ").concat(t))}}catch(f){if(f.code===se.DISCONNECT_P2P)return void G.warning("disconnecting p2p, abort unsubscribe request.");throw G.error("[".concat(this._clientId,"] unsubscribe user ").concat(e.uid," error"),f.toString()),f}finally{l()}}async _unsubscribeDataChannel(e,t){if(t&&wr(t,"id",0,65535,!0),!this._joinInfo)throw new xe(se.INVALID_OPERATION,"Can't unsubscribe datachannel, haven't joined yet!");if(!this._users.find(l=>l===e)){const l=new xe(se.INVALID_REMOTE_USER,"user is not in the channel");throw G.error("[".concat(this._clientId,"] can not unsubscribe ").concat(e.uid,", user is not in the channel")),l}let s;if(typeof t=="number"){const l=e._dataChannels.find(f=>f.id===t);l&&(s=[l])}else s=e._dataChannels;if(s===void 0){const l=new xe(se.REMOTE_USER_IS_NOT_PUBLISHED);throw G.error("[".concat(this._clientId,"] can not unsubscribe ").concat(e.uid," with channelId ").concat(t,", remote datachannel is not published")),l}G.info("[".concat(this._clientId,"] unsubscribe uid: ").concat(e.uid,", mediaType: datachannel, ids: ").concat(s.map(l=>l.id)));try{const l=await this._p2pChannel.unsubscribeDataChannel(e,s);l&&await this._gateway.unsubscribeDataChannel(l,e.uid),G.info("[".concat(this._clientId,"] unsubscribe datachannel success uid: ").concat(e.uid,", mediaType: datachannel, ids: ").concat(l))}catch(l){if(l.code===se.DISCONNECT_P2P)return void G.warning("disconnecting p2p, abort unsubscribe request.");throw G.error("[".concat(this._clientId,"] unsubscribe user ").concat(e.uid," error"),l.toString()),l}}async massUnsubscribe(e){if(Bp(e,"unsubscribeList"),!this._joinInfo)throw new xe(se.INVALID_OPERATION,"Can't unsubscribeAll stream, haven't joined yet!");G.info("[".concat(this._clientId,"] start massUnsubscribe ").concat(e.map(r=>{let{user:s,mediaType:l}=r;return"user: ".concat(s==null?void 0:s.uid,", mediaType: ").concat(l,";")}).join())),e=[...e];const t=new Map;for(let r=e.length-1;r>=0;r--){const{user:s,mediaType:l}=e[r];if(!s){const E=new xe(se.INVALID_PARAMS,"user property does not exist in unsubscribeList item");throw G.error("[".concat(this._clientId,"] user property does not exist in unsubscribeList item")),E}if(Aa(l,"mediaType",["video","audio",void 0]),!this._users.find(E=>E===s)){G.warning("[".concat(this._clientId,"] can not unsubscribe ").concat(s.uid,", user is not in the channel")),e.splice(r,1);continue}const m=Mt.Video|Mt.LwoVideo;if(t.has(s)){const E=t.get(s);let y;switch(l){case"video":y=E&m;break;case"audio":y=E&Mt.Audio;break;default:y=E&(Mt.Audio|m)}if(y){G.warning("[".concat(this._clientId,"] repeat massUnsubscribe user:").concat(s.uid,",mediaType:").concat(l," twice.")),e.splice(r,1);continue}l?l==="audio"?t.set(s,E|Mt.Audio):l==="video"&&t.set(s,E|m):t.set(s,E|Mt.Audio|m)}else l?l==="audio"?t.set(s,Mt.Audio):l==="video"&&t.set(s,m):t.set(s,Mt.Audio|m)}try{const r=await this._p2pChannel.massUnsubscribe(e);r&&await this._gateway.massUnsubscribe(r),G.info("[".concat(this._clientId,"] massUnsubscribe success ").concat(e.map(s=>{let{user:l,mediaType:f}=s;return"user: ".concat(l==null?void 0:l.uid,", mediaType: ").concat(f,";")}).join()))}catch(r){if(r.code===se.DISCONNECT_P2P)return void G.warning("[".concat(this._clientId,"] disconnecting p2p, abort unsubscribe request."));throw G.error("[".concat(this._clientId,"] massUnsubscribe error"),r.toString()),r}}async setLowStreamParameter(e){(function(r){if(!r)throw new Ke(se.INVALID_PARAMS);bn(r.width)||li(r.width,"streamParameter.width"),bn(r.height)||li(r.height,"streamParameter.height"),bn(r.framerate)||li(r.framerate,"streamParameter.framerate"),bn(r.bitrate)||wr(r.bitrate,"streamParameter.bitrate")})(e),(!e.width&&e.height||e.width&&!e.height)&&G.warning("[".concat(this._clientId,"] The width and height parameters take effect only when both are set")),G.info("[".concat(this._clientId,"] set low stream parameter to"),JSON.stringify(e));const t=this._configDistribute.getLowStreamConfigDistribute();if(t&&t.bitrate&&e.bitrate&&t.bitrate<e.bitrate&&(e.bitrate=t.bitrate),this._lowStreamParameter=e,this._isDualStreamEnabled)return this._p2pChannel.updateVideoStreamParameter(e,at.LocalVideoLowTrack)}async enableDualStream(){if(!zn().supportDualStream)throw Vt.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!0,succ:!1}),new xe(se.NOT_SUPPORTED,"Your browser is not support dual stream");if(this._isDualStreamEnabled)throw new xe(se.INVALID_OPERATION,"Dual stream is already enabled");if(this._p2pChannel.canPublishLowStream())try{await this._publishLowStream()}catch(e){throw Vt.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!0,succ:!1}),e}this._isDualStreamEnabled=!0,Vt.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!0,succ:!0}),G.info("[".concat(this._clientId,"] enable dual stream"))}async disableDualStream(){if(this._isDualStreamEnabled){if(!this._joinInfo)throw new xe(se.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");if(this._p2pChannel.getLocalMedia(at.LocalVideoLowTrack))try{const e=await this._p2pChannel.unpublishLowStream();e&&await this._gateway.unpublish(e,this._joinInfo.stringUid||this._joinInfo.uid)}catch(e){throw Vt.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!1,succ:!1}),e}this._isDualStreamEnabled=!1,Vt.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!1,succ:!0}),G.info("[".concat(this._clientId,"] disable dual stream"))}}async setClientRole(e,t){if(function(s){Aa(s,"role",["audience","host"])}(e),t&&L_(t),this.mode==="rtc"||this.mode==="p2p")throw G.warning("[".concat(this._clientId,"]").concat(this.mode," mode can not use setClientRole")),new xe(se.INVALID_OPERATION,"".concat(this.mode," mode can not use setClientRole"));if(t&&t.level&&e==="host")throw new xe(se.INVALID_OPERATION,"host mode can not set audience latency level");if(e==="audience"&&this._p2pChannel.hasLocalMedia())throw new xe(se.INVALID_OPERATION,"can not set client role to audience when publishing stream");const r=this._config.role;this._joinInfo&&(this._joinInfo.role=e),e!==r&&me("ENABLE_ROLE_SELECT_EDGE")?(this._gateway.updateClientRole(e,t),this._config.role=e,this._gateway.reconnect("recover",Fn.REGIONAL_DISTRIBUTION)):(await this._gateway.setClientRole(e,t),this._config.role=e),G.info("[".concat(this._clientId,"] set client role to ").concat(e,", level: ").concat(t&&t.level))}async _setClientRoleOptions(e){if(this.mode==="rtc"||this.mode==="p2p"||this._config.role!=="audience"||this._p2pChannel.hasLocalMedia())return;let t=!1;try{e&&L_(e),await this._gateway.setClientRole(this._config.role,e),t=!0}catch{}finally{G.info("[".concat(this._clientId,"] set client role options ").concat(t?"succeed":"failed",", options is ").concat(e))}}getRemoteInboundOffset(){var e;const t=(e=this._p2pChannel.getStats())===null||e===void 0?void 0:e.audioSend[0];if(!t||!t.timestamp)return 0;const r=t.timestamp-Date.now();return Math.abs(r)>1e3+t.rttMs+100?this.ntpAlignErrorCount+=1:this.ntpAlignErrorCount=0,this.ntpAlignErrorCount>=3?r:0}getNtpWallTimeInMs(){return document.visibilityState==="visible"&&(this.remoteInboundOffset=this.getRemoteInboundOffset()),this.remoteInboundOffset+Date.now()+this._gateway.ntpOffset}setProxyServer(e,t){if(Oa(e,"proxyServer"),!t){if(this.connectionState!=="DISCONNECTED")throw new xe(se.INVALID_OPERATION,"Set proxy server before join channel");if(this._cloudProxyServerMode!=="disabled"||this._useLocalAccessPoint)throw new xe(se.INVALID_OPERATION,"You have already set the proxy")}this._proxyServer=e,Vt.setProxyServer(this._proxyServer),G.setProxyServer(this._proxyServer),G.info("[".concat(this._clientId,"] Set proxy server ").concat(t?"by initialize call":""," success."))}setTurnServer(e,t){if(Array.isArray(e)||(e=[e]),!t){if(this.connectionState!=="DISCONNECTED")throw new xe(se.INVALID_OPERATION,"Set turn server before join channel");if(this._cloudProxyServerMode!=="disabled"||this._useLocalAccessPoint)throw new xe(se.INVALID_OPERATION,"You have already set the proxy")}if(ki(e))return this._turnServer={servers:e,mode:"original-manual"},void G.info("[".concat(this._clientId,"] Set original turnserver ").concat(t?"by initialize call":""," success: ").concat(e.map(r=>r.urls).join(","),"."));e.forEach(r=>iI(r)),this._turnServer={servers:e,mode:"manual"},G.info("[".concat(this._clientId,"] Set turnserver ").concat(t?"by initialize call":""," success."))}setLicense(e){if(this.connectionState!=="DISCONNECTED")throw new xe(se.INVALID_OPERATION,"you should set license before join channel");if(Oa(e,"license",32,32),!/^[A-Za-z\d]+$/.test(e))throw new xe(se.INVALID_PARAMS,"license should only contains characters from A-Z a-z 0-9");this._license=e,G.info("[".concat(this._clientId,"] set license success"),e)}startProxyServer(e){if(this.connectionState!=="DISCONNECTED")throw new xe(se.INVALID_OPERATION,"Start proxy server before join channel");if(this._proxyServer||this._turnServer.mode==="manual"||this._useLocalAccessPoint)throw new xe(se.INVALID_OPERATION,"You have already set the proxy");const t=[3,4,5];let r;switch(e===void 0&&(e=3),e){case 1:case 2:throw new xe(se.NOT_SUPPORTED,"proxy mode 1/2 has been deprecated and not supported.");case 3:r="proxy3";break;case 4:r="proxy4";break;case 5:r="proxy5";break;default:throw new xe(se.INVALID_PARAMS,"proxy server mode must be ".concat(t.join("|")))}this._cloudProxyServerMode=r,this.store.cloudProxyServerMode=r,G.info("[".concat(this._clientId,"] set cloud proxy server mode to"),this._cloudProxyServerMode)}stopProxyServer(){if(this.connectionState!=="DISCONNECTED")throw new xe(se.INVALID_OPERATION,"Stop proxy server after leave channel");Vt.setProxyServer(),G.setProxyServer(),this._cloudProxyServerMode="disabled",this.store.cloudProxyServerMode="disabled",G.info("[".concat(this._clientId,"] set cloud proxy server mode to"),this._cloudProxyServerMode),this._proxyServer=void 0,this._turnServer={mode:"auto",servers:[]}}setLocalAccessPointsV2(e){if(!e.accessPoints)throw new xe(se.INVALID_PARAMS,"accessPoints is required.");Bp(e.accessPoints.serverList,"accessPoints.serverList"),Oa(e.accessPoints.domain,"accessPoints.domain");const t=(D,P)=>{wr(D,P,0,65535,!0)};let r=443;if(e.accessPoints.port&&(t(e.accessPoints.port,"accessPoints.port"),r=e.accessPoints.port),this._proxyServer||this._cloudProxyServerMode!=="disabled")throw new xe(se.INVALID_OPERATION,"set local access point failed, You have already set the cloud proxy");me("CLOSE_AFB_FOR_LOCAL_AP")&&(Dn("JOIN_WITH_FALLBACK_SIGNAL_PROXY",!1),Dn("JOIN_WITH_FALLBACK_MEDIA_PROXY",!1));const s=/^((\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.){3}(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/,l=e.accessPoints.domain,f=e.accessPoints.serverList.map(D=>s.test(D)?"".concat(D.replace(/\./g,"-"),".").concat(l):D),m=f.map(D=>"".concat(D,":").concat(r));this._useLocalAccessPoint=!0,this._setLocalAPVersion=2,Dn("WEBCS_DOMAIN",m),Dn("WEBCS_DOMAIN_BACKUP_LIST",m),Dn("GATEWAY_DOMAINS",[l]),e.report&&e.report.hostname&&Array.isArray(e.report.hostname)&&e.report.hostname.length?(Bp(e.report.hostname,"report.hostname"),Dn("EVENT_REPORT_DOMAIN",e.report.hostname[0]),Dn("EVENT_REPORT_BACKUP_DOMAIN",e.report.hostname[1]||e.report.hostname[0])):(Dn("EVENT_REPORT_DOMAIN",f[0]),Dn("EVENT_REPORT_BACKUP_DOMAIN",f[1]||f[0]));let E=6443;e.report&&e.report.port&&(t(e.report.port,"report.port"),E=e.report.port),Dn("STATS_COLLECTOR_PORT",E),e.report?Dn("ENABLE_EVENT_REPORT",!0):Dn("ENABLE_EVENT_REPORT",!1);let y="";e.log&&e.log.hostname&&Array.isArray(e.log.hostname)&&e.log.hostname.length?(Bp(e.log.hostname,"log.hostname"),y=e.log.hostname[0]):y=f[0];let b=6444;e.log&&e.log.port&&(t(e.log.port,"log.port"),b=e.log.port),Dn("LOG_UPLOAD_SERVER","".concat(y,":").concat(b));let A=[];e.cds&&e.cds.hostname&&Array.isArray(e.cds.hostname)&&e.cds.hostname.length?(Bp(e.cds.hostname,"cds.hostname"),A=e.cds.hostname):A=f;let O=443;e.cds&&e.cds.port&&(t(e.cds.port,"cds.port"),O=e.cds.port),Dn("CDS_AP",A.map(D=>"".concat(D,":").concat(O))),e.cds?Dn("ENABLE_CONFIG_DISTRIBUTE",!0):Dn("ENABLE_CONFIG_DISTRIBUTE",!1),G.info("set local access point v2 success")}setLocalAccessPoints(e,t){if(Bp(e,"serverList"),Oa(t,"domain"),this._proxyServer||this._cloudProxyServerMode!=="disabled")throw new xe(se.INVALID_OPERATION,"set local access point failed, You have already set the cloud proxy");const r=/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/;e=e.map(s=>r.test(s)?"".concat(s.replace(/\./g,"-"),".").concat(t):s),this._useLocalAccessPoint=!0,this._setLocalAPVersion=1,Dn("WEBCS_DOMAIN",e),Dn("WEBCS_DOMAIN_BACKUP_LIST",e),Dn("GATEWAY_DOMAINS",[t]),Dn("EVENT_REPORT_DOMAIN",e[0]),Dn("EVENT_REPORT_BACKUP_DOMAIN",e[1]||e[0]),Dn("LOG_UPLOAD_SERVER","".concat(e[0],":6444")),G.info("[".concat(this._clientId,"] set local access point success"))}async setRemoteDefaultVideoStreamType(e){if(Aa(e,"streamType",[0,1,4,5,6,7,8,9]),this._remoteDefaultVideoStreamType=e,this._joinInfo)try{await this._gateway.setDefaultRemoteVideoStreamType(e),this._joinInfo.defaultVideoStream=this._remoteDefaultVideoStreamType}catch(t){throw G.error("[".concat(this._clientId,"] set default remote video stream type error"),t.toString()),t}else G.debug("[".concat(this._clientId,"] haven't joined yet, cache remoteDefaultVideoStreamType ").concat(e))}async setRemoteVideoStreamType(e,t){Aa(t,"streamType",[0,1,4,5,6,7,8,9]);try{await this._gateway.setRemoteVideoStreamType(e,t),setTimeout(()=>{const r=this._users.find(s=>s.uid===e);r&&r.videoTrack&&r.videoTrack.updateMediaStreamTrackResolution()},2e3)}catch(r){throw G.error("[".concat(this._clientId,"] set remote video stream type error"),r.toString()),r}G.info("[".concat(this._clientId,"] set remote ").concat(e," video stream type to ").concat(t)),this._remoteStreamTypeCacheMap.set(e,t)}async setStreamFallbackOption(e,t){Aa(t,"fallbackType",[0,1,2,3,4,5,6,7,8]);try{await this._gateway.setStreamFallbackOption(e,t)}catch(r){throw G.error("[".concat(this._clientId,"] set stream fallback option"),r.toString()),r}G.info("[".concat(this._clientId,"] set remote ").concat(e," stream fallback type to ").concat(t)),this._streamFallbackTypeCacheMap.set(e,t)}setEncryptionConfig(e,t,r,s){(function(f){Aa(f,"encryptionMode",["aes-128-xts","aes-256-xts","aes-128-ecb","sm4-128-ecb","aes-128-gcm","aes-256-gcm","aes-128-gcm2","aes-256-gcm2","none"])})(e),Oa(t,"secret");const l=["aes-128-gcm2","aes-256-gcm2"];if(ht(l).call(l,e)){if(!r||!(r instanceof Uint8Array&&r.length===32))throw new xe(se.INVALID_PARAMS,"salt must be an Uint8Array and exactly equal to 32 bytes")}else if(r)throw new xe(se.INVALID_PARAMS,"current encrypt mode does not need salt");if(s){if(hh(s,"encryptDataStream"),!ht(l).call(l,e))throw new xe(se.INVALID_PARAMS,"current encrypt mode does not support data stream");this._encryptDataStream=!0}new RegExp(`^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#$%^&*,.<>?/:;'"|{}\\[\\]])(?=.{8,})`).test(t)||G.warning(`The secret is not strong:
      The secret must contain at least 1 lowercase alphabetical character,
      The secret must contain at least 1 uppercase alphabetical character,
      The secret must contain at least 1 numeric character,
      The secret must contain at least one special character,
      The secret must be eight characters or longer.
      `),this._encryptionMode=e,this._encryptionSecret=t,r&&(this._encryptionSalt=Lg(r))}async renewToken(e){if(Oa(e,"token",1,2047),!this._key||!this._joinInfo)throw new xe(se.INVALID_OPERATION,"renewToken should not be called before user join");const t=this._key;this._key=e,this._joinInfo&&(this._joinInfo.token=e);const r=await this._renewTokenMutex.lock();try{if(me("USE_NEW_TOKEN")){G.debug("[".concat(this._clientId,"] start renew token with ticket from unilbs"));const s=await kI(this._joinInfo,this._axiosCancelSource.token,this._config.httpRetryConfig||ra);G.debug("[".concat(this._clientId,"] get ticket from unilbs success")),await this._gateway.renewToken({token:e,ticket:s})}else G.debug("[".concat(this._clientId,"] start renew token without ticket")),await this._gateway.renewToken({token:e});G.debug("[".concat(this._clientId,"] renewToken success"))}catch(s){throw this._key=t,this._joinInfo.token=t,G.error("[".concat(this._clientId,"] renewToken failed"),s.toString()),s}finally{r()}}enableAudioVolumeIndicator(){this._audioVolumeIndicationInterval?G.warning("you have already enabled audio volume indicator!"):this._audioVolumeIndicationInterval=window.setInterval(()=>{const e=this._p2pChannel.getAudioLevels();this.safeEmit(In.VOLUME_INDICATOR,e)},me("AUDIO_VOLUME_INDICATION_INTERVAL")||2e3)}getRTCStats(){const e=this._statsCollector.getRTCStats(),t=this._gateway.getInChannelInfo();return e.Duration=Math.round(t.duration/1e3),e}async startLiveStreaming(e,t){if(!t){if(this.codec!=="h264")throw new xe(se.LIVE_STREAMING_INVALID_RAW_STREAM,"raw streaming is only support h264");if(!this._p2pChannel.hasLocalMedia())throw new xe(se.LIVE_STREAMING_INVALID_RAW_STREAM,"can not find stream to raw streaming")}if(this._liveRawStreamingClient&&this._liveRawStreamingClient.hasUrl(e)||this._liveTranscodeStreamingClient&&this._liveTranscodeStreamingClient.hasUrl(e))throw new xe(se.LIVE_STREAMING_TASK_CONFLICT);const r=t?rf.TRANSCODE:rf.RAW;return this._createLiveStreamingClient(r).startLiveStreamingTask(e,r)}setLiveTranscoding(e){return this._createLiveStreamingClient(rf.TRANSCODE).setTranscodingConfig(e)}async stopLiveStreaming(e){const t=[this._liveRawStreamingClient,this._liveTranscodeStreamingClient].filter(r=>r&&r.hasUrl(e));if(!t.length)throw new xe(se.INVALID_PARAMS,"can not find live streaming url to stop");await gt.all(t.map(r=>r&&r.stopLiveStreamingTask(e)))}async startChannelMediaRelay(e){mD(e),await this._createChannelMediaRelayClient().startChannelMediaRelay(e)}async updateChannelMediaRelay(e){mD(e),await this._createChannelMediaRelayClient().updateChannelMediaRelay(e)}async stopChannelMediaRelay(){await this._createChannelMediaRelayClient().stopChannelMediaRelay(),this._statsCollector.onStatsChanged&&(this._statsCollector.onStatsChanged=void 0)}sendAudioMetadata(e){this._p2pChannel instanceof w1&&this._p2pChannel.addAudioMetadata(e)}async sendStreamMessage(e){var t;let r=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(!this._joinInfo)throw new xe(se.INVALID_OPERATION,"can not send data stream, not joined");if((typeof e=="string"||e instanceof Uint8Array)&&(e={payload:e}),typeof e.payload=="string"){const l=new TextEncoder;e.payload=l.encode(e.payload)}let s=!1;if(this._encryptDataStream&&this._encryptDataStreamIv&&this._encryptDataStreamKey&&window.crypto.subtle&&ht(t=["aes-128-gcm2","aes-256-gcm2"]).call(t,this._encryptionMode)&&(s=!0,e.payload=await async function(l,f,m){var E;const y=wc(E=Array.from(m)).call(E,(B,Y)=>B+Y,0),b={serverTs:0,seq:td++,length:m.length,checkSum:y},A=new Uint8Array(Cx(y,2)),O=new ArrayBuffer(Wb),D=new DataView(O);D.setUint32(0,b.serverTs),D.setUint16(4,b.seq),D.setUint16(6,b.length),D.setUint16(8,b.checkSum);const P=16-m.length%16;m=_L(m,new Uint8Array(P));const F=await window.crypto.subtle.encrypt({name:"AES-GCM",iv:l,tagLength:h8,additionalData:A},f,m);return _L(new Uint8Array(O),new Uint8Array(F))}(this._encryptDataStreamIv,this._encryptDataStreamKey,e.payload)),new Blob([e.payload]).size>1024)throw new xe(se.INVALID_PARAMS,s?"encrypted stream message out of range.":"stream message out of range.");return this._gateway.signal.request(cn.DATA_STREAM,{payload:Lg(e.payload),syncWithAudio:e.syncWithAudio,sendTs:Date.now()-rF},!r)}sendMetadata(e){if(!this._joinInfo)throw new xe(se.INVALID_OPERATION,"can not send metadata, not joined");if(new Blob([e]).size>1024)throw new xe(se.METADATA_OUT_OF_RANGE);return this._gateway.signal.request(cn.SEND_METADATA,{session_id:this._joinInfo.sid,metadata:Lg(e)})}async sendCustomReportMessage(e){if(Array.isArray(e)||(e=[e]),e.forEach(ms),!this._joinInfo)throw new xe(se.INVALID_OPERATION,"can not send custom report, not joined");await Vt.sendCustomReportMessage(this._joinInfo.sid,e)}getLocalAudioStats(){return this._statsCollector.getLocalAudioTrackStats()}getRemoteAudioStats(){return this._statsCollector.getRemoteAudioTrackStats()}getLocalVideoStats(){return this._statsCollector.getLocalVideoTrackStats()}getRemoteVideoStats(){return this._statsCollector.getRemoteVideoTrackStats()}getRemoteNetworkQuality(){return this._statsCollector.getRemoteNetworkQualityStats()}async pickSVCLayer(e,t){Aa(t.spatialLayer,"spatialLayer",[0,1,2,3]),Aa(t.temporalLayer,"temporalLayer",[0,1,2,3]);try{await this._gateway.pickSVCLayer(e,t)}catch(r){throw G.error("[".concat(this._clientId,"] pick SVC layer failed"),r.toString()),r}}async setRTMConfig(e){const{apRTM:t=!1,rtmFlag:r}=e;if(hh(t,"apRTM"),wr(r,"rtmFlag",0),this._rtmConfig.apRTM=t,this._rtmConfig.rtmFlag=r,G.debug("[".concat(this._clientId,"] setRTMconfig ").concat(JSON.stringify(e)," in ").concat(this.connectionState," state")),(this.connectionState==="CONNECTED"||this.connectionState==="RECONNECTING")&&this._joinInfo)return this._joinInfo.apRTM=t,this._joinInfo.rtmFlag=r,this._gateway.setRTM2Flag(r)}_reset(){if(G.debug("[".concat(this._clientId,"] reset client")),function(e){const t=DS.indexOf(e);t!==-1&&DS.splice(t,1)}(this._clientId),this.store.hasStartJoinChannel=!1,this.store.isABTestSuccess=!1,this._axiosCancelSource.cancel(),this._axiosCancelSource=En.CancelToken.source(),this._streamFallbackTypeCacheMap=new Map,this._remoteStreamTypeCacheMap=new Map,this._configDistribute.stopGetConfigDistribute(),this._joinInfo&&cF(this._joinInfo),this._joinInfo=void 0,this._proxyServer=void 0,this._defaultStreamFallbackType=void 0,this._sessionId&&Vt.removeSid(this._sessionId),this._sessionId=null,this.store.sessionId=null,this._statsCollector.reset(),this._key=void 0,this._appId=void 0,this._uid=void 0,this.store.uid=void 0,this._channelName=void 0,this._encryptionMode="none",this._encryptionSecret=null,this._encryptionSalt=null,this._encryptDataStreamKey=null,this._encryptDataStreamIv=null,this._pendingPublishedUsers=[],this._users.forEach(e=>{e._audioTrack&&e._audioTrack._destroy(),e._videoTrack&&e._videoTrack._destroy(),e._dataChannels&&(e._dataChannels.forEach(t=>t._close()),e._dataChannels.length=0)}),this._users=[],this._audioVolumeIndicationInterval&&(window.clearInterval(this._audioVolumeIndicationInterval),this._audioVolumeIndicationInterval=void 0),this._cloudProxyServerMode==="fallback"&&(this._cloudProxyServerMode="disabled",this.store.cloudProxyServerMode="disabled"),this._p2pChannel.reset(),this._publishMutex=new Gi("client-publish",this._clientId),this._subscribeMutex=new Gi("client-subscribe",this._clientId),this._networkQualityInterval&&(window.clearInterval(this._networkQualityInterval),this._networkQualityInterval=void 0),this._liveRawStreamingClient&&(this._liveRawStreamingClient.terminate(),this._liveRawStreamingClient.removeAllListeners(),this._liveRawStreamingClient=void 0),this._liveTranscodeStreamingClient&&(this._liveTranscodeStreamingClient.terminate(),this._liveTranscodeStreamingClient.removeAllListeners(),this._liveTranscodeStreamingClient=void 0),this._channelMediaRelayClient&&(this._channelMediaRelayClient.dispose(),this._channelMediaRelayClient=void 0),this._inspect)try{this._inspect.close(),this._inspect=void 0}catch{}if(this._moderation)try{this.setImageModeration(!1)}catch{}}_startSession(e,t){var r;const s=e||Na();e?G.debug("[".concat(this._clientId,"] new Session ").concat(s)):G.debug("[".concat(this._clientId,"] renewSession ").concat(this._sessionId," => ").concat(s));const l=e?"":this._sessionId||"";this._sessionId=s,this.store.sessionId=s,Vt.addSid(s);const f={lts:new Date().getTime(),mode:this.mode,buildFormat:1,stringUid:(t==null?void 0:t.stringUid)||((r=this._joinInfo)===null||r===void 0?void 0:r.stringUid),channelProfile:this.mode==="live"?1:0,channelMode:0,isABTestSuccess:Number(this._configDistribute.isSuccess),lsid:l,clientRole:this.role==="audience"?2:1};Vt.sessionInit(this._sessionId,cd({cname:t.channel,appid:t.appId},f)),this._joinInfo&&(this._joinInfo.sid=s),this._gateway.joinInfo&&(this._gateway.joinInfo.sid=s)}async _publishHighStream(e){if(!this._joinInfo||this._uid===void 0)throw new xe(se.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new xe(se.INVALID_OPERATION,"can not publish stream in ".concat(this.connectionState," state"));if(this._turnServer.mode==="auto"&&me("FORCE_TURN")&&!me("TURN_ENABLE_TCP")&&!me("TURN_ENABLE_UDP"))throw new xe(se.UNEXPECTED_ERROR,"force TURN With No TURN Configuration");G.debug("[".concat(this._clientId,"] publish high stream"));try{const r=await this._p2pChannel.publish(e,this._isDualStreamEnabled,this._lowStreamParameter);if(this.store.useP2P){const s=(await r.next()).value;if(s){try{await this._gateway.sendExtensionMessage(ia.PUBLISH,s,!0)}catch(l){throw r.throw(l),l}await r.next()}this._p2pChannel.reportPublishEvent(!0,null)}else{const s=(await r.next()).value;if(s){var t;let l;try{l=await this._gateway.publish(this._uid,s,!0)}catch(f){if(f.code!==se.DISCONNECT_P2P)throw r.throw(f),f}await r.next(((t=l)===null||t===void 0?void 0:t.ortc)||[])}this._p2pChannel.reportPublishEvent(!0,null);for(const l of e)l instanceof Kr&&l._encoderConfig&&this._gateway.setVideoProfile(l._encoderConfig).catch(f=>{G.debug("[".concat(this._clientId,"] stop setVideoProfile, because websocket is closed"))}),!l.muted&&l.enabled||await this._p2pChannel.muteLocalTrack(l)}}catch(r){if(this._p2pChannel.reportPublishEvent(!1,r==null?void 0:r.code,e),(r==null?void 0:r.code)===se.WS_ABORT)return;throw r}}async _publishLowStream(){if(!this._joinInfo||this._uid===void 0)throw new xe(se.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new xe(se.INVALID_OPERATION,"can not publish stream in ".concat(this.connectionState," state"));G.debug("[".concat(this._clientId,"] publish low stream"));const e=this._configDistribute.getLowStreamConfigDistribute();e&&e.bitrate&&(this._lowStreamParameter||(this._lowStreamParameter={width:160,height:120,framerate:15,bitrate:50}),this._lowStreamParameter&&this._lowStreamParameter.bitrate&&e.bitrate<this._lowStreamParameter.bitrate&&(this._lowStreamParameter.bitrate=e.bitrate));try{const r=await this._p2pChannel.publishLowStream(this._lowStreamParameter),s=(await r.next()).value;if(s){var t;let l;try{l=await this._gateway.publish(this._uid,s,!0)}catch(f){if(f.code!==se.DISCONNECT_P2P)throw r.throw(f),f}r.next(((t=l)===null||t===void 0?void 0:t.ortc)||[]),this._p2pChannel.reportPublishEvent(!0,null,void 0,!0)}}catch(r){if(this._p2pChannel.reportPublishEvent(!1,r==null?void 0:r.code,void 0,!0),(r==null?void 0:r.code)===se.WS_ABORT)return;throw r}}_createLiveStreamingClient(e){const t=()=>{if(!this._joinInfo||!this._appId)return new xe(se.INVALID_OPERATION,"can not create live streaming client, please join channel first").throw();const r=(s={joinInfo:this._joinInfo,appId:this._appId,websocketRetryConfig:this._config.websocketRetryConfig,httpRetryConfig:this._config.httpRetryConfig},wh("LiveStreaming").create(s));var s;return r.onLiveStreamError=(l,f)=>{Vt.reportApiInvoke(this._sessionId,{name:Di.ON_LIVE_STREAM_ERROR,options:[l,f],tag:Bn.TRACER}).onSuccess(),this.safeEmit(In.LIVE_STREAMING_ERROR,l,f)},r.onLiveStreamWarning=(l,f)=>{Vt.reportApiInvoke(this._sessionId,{name:Di.ON_LIVE_STREAM_WARNING,options:[l,f],tag:Bn.TRACER}).onSuccess(),this.safeEmit(In.LIVE_STREAMING_WARNING,l,f)},r.on(PS.REQUEST_WORKER_MANAGER_LIST,(l,f,m)=>{if(!this._joinInfo)return m(new xe(se.INVALID_OPERATION,"can not find join info to get worker manager"));(async function(E,y,b,A){const O=me("UAP_AP").slice(0,me("AJAX_REQUEST_CONCURRENT")).map(D=>y.proxyServer?"https://".concat(y.proxyServer,"/ap/?url=").concat(D+"/api/v1?action=uap"):"https://".concat(D,"/api/v1?action=uap"));return await J8(O,E,y,b,A)})(l,this._joinInfo,this._axiosCancelSource.token,ra).then(f).catch(m)}),r};return e===rf.RAW?(this._liveRawStreamingClient=this._liveRawStreamingClient||t(),this._liveRawStreamingClient):(this._liveTranscodeStreamingClient=this._liveTranscodeStreamingClient||t(),this._liveTranscodeStreamingClient)}_createChannelMediaRelayClient(){if(!this._joinInfo)return new xe(se.INVALID_OPERATION,"can not create channel media relay client, please join channel first").throw();if(!this._channelMediaRelayClient){const{sendResolutionWidth:t,sendResolutionHeight:r}=this.getLocalVideoStats(),s=(e={joinInfo:this._joinInfo,clientId:this._clientId,websocketRetryConfig:this._config.websocketRetryConfig,httpRetryConfig:this._config.httpRetryConfig,resolution:{width:t,height:r}},wh("ChannelMediaRelay").create(e));s.on("state",l=>{l===hi.RELAY_STATE_FAILURE&&s&&s.dispose(),this.safeEmit(In.CHANNEL_MEDIA_RELAY_STATE,l)}),s.on("event",l=>{this.safeEmit(In.CHANNEL_MEDIA_RELAY_EVENT,l)}),this._channelMediaRelayClient=s,this._statsCollector.onStatsChanged=(l,f)=>{var m;l==="resolution"&&((m=this._channelMediaRelayClient)===null||m===void 0||m.setVideoProfile(f))}}var e;return this._channelMediaRelayClient}_handleUpdateDataChannel(e,t){const{added:r,deleted:s}=e,l=[];if(t){const f=[];this._users.forEach(m=>{m._dataChannels.forEach(E=>{r.every(y=>y.uid!==m._uintid||y.stream_id!==E.id)&&f.push({uid:m._uintid,stream_id:E.id,ordered:E.ordered,max_retrans_times:E.maxRetransmits,metadata:E.metadata})})}),f.length>0&&this._handleUpdateDataChannel({added:[],deleted:f})}Array.isArray(r)&&r.length>0&&r.forEach(f=>{const{uid:m,stream_id:E,ordered:y,max_retrans_times:b,metadata:A}=f,O=this._users.find(D=>D._uintid===m);if(!O)return void G.error("[".concat(this._clientId,"] can not find target user!(on_add_data_channel)"));if(G.debug("[".concat(this._clientId,"] data_channel added with uid ").concat(m)),ht(l).call(l,O)||l.push(O),O._uintid||(O._uintid=m),O._dataChannels.findIndex(D=>D.id===f.stream_id)===-1){const D={id:E,ordered:!!y,maxRetransmits:b,metadata:A},P=function(F){return q8(F,!0)}(D);O._dataChannels.push(P),G.info("[".concat(this._clientId,"] remote user ").concat(O.uid," published datachannel")),t||this.safeEmit(In.USER_PUBLISHED,O,"datachannel",D)}this._p2pChannel.hasPendingRemoteDataChannel(O,f.stream_id)&&(G.debug("[".concat(this._clientId,"] resubscribe datachannel for user ").concat(O.uid," after reconnect.")),this._subscribeDataChannel(O,f.stream_id).catch(D=>{G.error("[".concat(this._clientId,"] resubscribe datachannel error"),D.toString())}))}),t&&(this.safeEmit(In.PUBLISHED_USER_LIST,this._pendingPublishedUsers),this._pendingPublishedUsers=[]),Array.isArray(s)&&s.length>0&&s.forEach(f=>{const{uid:m,stream_id:E}=f,y=this._users.find(A=>A._uintid===m);if(!y)return void G.error("[".concat(this._clientId,"] can not find target user!(on_delete_data_channel)"));const b=y._dataChannels.find(A=>A.id===f.stream_id);b&&(G.debug("[".concat(this._clientId,"] data_stream delete with uid ").concat(m)),this._p2pChannel.unsubscribeDataChannel(y,[b]).then(A=>{if(y._dataChannels=y._dataChannels.filter(O=>O!==b),A)return this._gateway.unsubscribeDataChannel(A,y.uid)}),G.info("[".concat(this._clientId,"] remote user ").concat(m," unpublished datachannel ,id:").concat(b.id)),this.safeEmit(In.USER_UNPUBLISHED,y,"datachannel",b._config))})}_handleRemoveDataChannels(e){const t=this._users.find(r=>r.uid===e.uid);if(t){if(t._dataChannels!==void 0&&t._dataChannels.length>0){G.debug("[".concat(this._clientId,"] datachannel removed with uid ").concat(e.uid));const r=()=>{G.info("[".concat(this._clientId,"] remote user ").concat(t.uid," unpublished datachannel")),t._dataChannels.forEach(s=>{this.safeEmit(In.USER_UNPUBLISHED,t,"datachannel",s._config)})};this._p2pChannel.unsubscribeDataChannel(t,t._dataChannels).then(s=>{if(s)return this._gateway.unsubscribeDataChannel(s,t.uid)}),r()}}else G.warning("[".concat(this._clientId,"] can not find target user!(on_remove_datachannel)"))}_handleGatewayEvents(){this._gateway.on(Qe.UPDATE_GATEWAY_CONFIG,()=>{(function(){let e;try{e=window.localStorage.getItem("websdk_ng_global_parameter")}catch(t){return void G.error("Error loading sdk config",t.message)}if(e)try{const t=JSON.parse(window.atob(e)),r=Date.now();Object.keys(t).forEach(s=>{const{value:l,type:f,expires:m}=t[s];m&&m<=r||f||uU()||!Object.prototype.hasOwnProperty.call(RL,s)||(gh[s]=l,ti[s]=l,G.debug("Update gateway parameters from config distribute",s,l))})}catch(t){G.error("Error update config from local cache",t.message)}})()}),this._gateway.on(Qe.DISCONNECT_P2P,async()=>{await this._p2pChannel.disconnectForReconnect()}),this._gateway.on(Qe.CONNECTION_STATE_CHANGE,(e,t,r)=>{var s;if(r===nr.FALLBACK)return;const l=()=>{this.safeEmit(In.CONNECTION_STATE_CHANGE,e,t,r)};if(Vt.reportApiInvoke(this._sessionId||((s=this._gateway.joinInfo)===null||s===void 0?void 0:s.sid)||null,{name:Di.CONNECTION_STATE_CHANGE,options:[e,t,r],tag:Bn.TRACER}).onSuccess(JSON.stringify({cur:e,prev:t,reason:r})),G.info("[".concat(this._clientId,"] signal connection state change: ").concat(t," -> ").concat(e)),e==="DISCONNECTED")return this._reset(),void l();if(e==="RECONNECTING")this._users.forEach(m=>{m._trust_in_room_=!1,m._trust_audio_enabled_state_=!1,m._trust_video_enabled_state_=!1,m._trust_audio_mute_state_=!1,m._trust_video_mute_state_=!1,m._trust_audio_stream_added_state_=!1,m._trust_video_stream_added_state_=!1,m._is_pre_created||(m._audio_pre_subscribed||(m._audioSSRC=void 0,m._audioOrtc=void 0),m._video_pre_subscribed||(m._videoSSRC=void 0,m._videoOrtc=void 0,m._rtxSsrcId=void 0),m._cname=void 0)}),this._userOfflineTimeout&&window.clearTimeout(this._userOfflineTimeout),this._streamRemovedTimeout&&window.clearTimeout(this._streamRemovedTimeout),this._userOfflineTimeout=void 0,this._streamRemovedTimeout=void 0;else if(e==="CONNECTED"){var f;this._streamFallbackTypeCacheMap.forEach((m,E)=>{this._gateway.setStreamFallbackOption(E,m).catch(y=>{G.warning("[".concat(this._clientId,"] auto set stream fallback option failed"),y)})}),this._remoteStreamTypeCacheMap.forEach((m,E)=>{this._gateway.setRemoteVideoStreamType(E,m).catch(y=>{G.warning("[".concat(this._clientId,"] auto set remote stream type failed"),y)})}),this._remoteDefaultVideoStreamType!==void 0&&((f=this._joinInfo)===null||f===void 0?void 0:f.defaultVideoStream)===void 0&&this.setRemoteDefaultVideoStreamType(this._remoteDefaultVideoStreamType).then(()=>{G.debug("[".concat(this._clientId,"] setRemoteDefaultVideoStreamType after gateway connected"))}).catch(m=>{G.error("[".concat(this._clientId,"] setRemoteDefaultVideoStreamType after gateway failed, ").concat(m))}),this.store.useP2P||(this._p2pChannel.republish(),this._userOfflineTimeout=window.setTimeout(()=>{this.connectionState==="CONNECTED"&&(this._userOfflineTimeout=void 0,this._users.filter(m=>!m._trust_in_room_).forEach(m=>{G.debug("[".concat(this._clientId,"] user offline timeout, emit user offline ").concat(m.uid)),this._handleUserOffline({uid:m.uid})}))},3e3),this._streamRemovedTimeout=window.setTimeout(()=>{this.connectionState==="CONNECTED"&&(this._streamRemovedTimeout=void 0,this._users.forEach(m=>{m._trust_audio_mute_state_||(G.debug("[".concat(this._clientId,"] auto dispatch audio unmute event ").concat(m.uid)),this._handleMuteStream(m.uid,ut.AUDIO,!1)),m._trust_video_mute_state_||(G.debug("[".concat(this._clientId,"] auto dispatch video unmute event ").concat(m.uid)),this._handleMuteStream(m.uid,ut.VIDEO,!1)),m._trust_audio_enabled_state_||(G.debug("[".concat(this._clientId,"] auto dispatch enable local audio ").concat(m.uid)),this._handleSetStreamLocalEnable("audio",m.uid,!0)),m._trust_video_enabled_state_||(G.debug("[".concat(this._clientId,"] auto dispatch enable local video ").concat(m.uid)),this._handleSetStreamLocalEnable("video",m.uid,!0)),m._trust_video_stream_added_state_||(G.debug("[".concat(this._clientId,"] auto dispatch reset video stream added ").concat(m.uid)),this._handleResetAddStream(m,"video")),m._trust_audio_stream_added_state_||(G.debug("[".concat(this._clientId,"] auto dispatch reset audio stream added ").concat(m.uid)),this._handleResetAddStream(m,"audio")),m._video_added_||m._audio_added_||(G.debug("[".concat(this._clientId,"] auto dispatch stream remove ").concat(m.uid)),this._handleRemoveStream({uid:m.uid,uint_id:m._uintid}))}))},1e3))}l()}),this._gateway.on(Qe.REQUEST_NEW_GATEWAY_LIST,async(e,t)=>{if(!this._joinInfo)return t(new xe(se.UNEXPECTED_ERROR,"can not recover, no join info"));try{let r;const s=await sF(cd(cd({},this._joinInfo),{},{uid:this._joinInfo.uid,stringUid:void 0}));s?(r=s.ap,wD(s),this._joinInfo.preload=!0):(r=await hD(this._joinInfo,this._axiosCancelSource.token,this._config.httpRetryConfig||ra,this.store),this._joinInfo.preload=!1),this._joinInfo&&(this._joinInfo.apResponse=r.gatewayInfo.res,this._joinInfo.gatewayAddrs=r.gatewayInfo.gatewayAddrs,this._joinInfo.uni_lbs_ip=r.gatewayInfo.uni_lbs_ip);const l=[];r.gatewayInfo.gatewayAddrs.forEach(f=>{let{address:m}=f;const[E,y]=m.split(":");this._joinInfo&&this._joinInfo.proxyServer?l.push({proxy:this._joinInfo.proxyServer,host:E,port:y}):l.push({host:E,port:y})}),e(l)}catch(r){t(r)}}),this._gateway.on(Qe.NETWORK_QUALITY,e=>{this._networkQualitySensitivity==="normal"&&this.safeEmit(In.NETWORK_QUALITY,e)}),this._gateway.on(Qe.STREAM_TYPE_CHANGE,(e,t)=>{this.safeEmit(In.STREAM_TYPE_CHANGED,e,t),Vt.reportApiInvoke(this._sessionId,{name:Di.STREAM_TYPE_CHANGE,options:[e,t],tag:Bn.TRACER}).onSuccess(JSON.stringify({uid:e,streamType:t}))}),this._gateway.on(Qe.IS_P2P_DISCONNECTED,e=>{this._p2pChannel.isP2PDisconnected()?e(!0):this._p2pChannel.hasLocalMedia()||this._p2pChannel.hasRemoteMedia()?e(!1):e(!0)}),this._gateway.on(Qe.REQUEST_P2P_CONNECTION_PARAMS,async(e,t,r)=>{try{let s=await this._p2pChannel.getEstablishParams();me("ENABLE_PREALLOC_PC")&&s||(s=await this._p2pChannel.startP2PConnection(e)),t(s)}catch(s){r(s)}}),this._gateway.on(Qe.JOIN_RESPONSE,(e,t)=>{if(this.store.useP2P)return;let r;e.attributes?r=e.attributes.userAttributes.preSubSsrcs:G.debug("no attributes in joinResponse");const s=iD(e.ortc,t,r);this._p2pChannel.connect(s)}),this._gateway.on(Qe.PRE_CONNECT_PC,async e=>{const{candidates:t,fingerprint:r}=e;if(this._joinInfo&&t.length>0&&!this._p2pChannel.isPlanB){var s;await this._p2pChannel.startP2PConnection({turnServer:this._joinInfo.turnServer});const{cert:l,cid:f}=this._joinInfo.apResponse;await this._p2pChannel.connect({iceParameters:{iceUfrag:"".concat(f,"_").concat(l),icePwd:"".concat(f,"_").concat(l)},dtlsParameters:{fingerprints:[{hashFunction:"sha-256",fingerprint:(s=me("FINGERPRINT"))!==null&&s!==void 0?s:r}]},candidates:t,rtpCapabilities:{send:{audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]},recv:{audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]}},setup:"active",cname:"o/i14u9pJrxRKAsu",preallocation:!0})}})}_handleGatewaySignalEvents(){this._gateway.signal.on(yn.ON_USER_ONLINE,this._handleUserOnline),this._gateway.signal.on(yn.ON_USER_OFFLINE,this._handleUserOffline),this._gateway.signal.on(yn.ON_ADD_AUDIO_STREAM,e=>this._handleAddAudioOrVideoStream("audio",e.uid,e.ssrcId,e.cname,e.uint_id,e.ortc)),this._gateway.signal.on(yn.ON_ADD_VIDEO_STREAM,e=>this._handleAddAudioOrVideoStream("video",e.uid,e.ssrcId,e.cname,e.uint_id,e.ortc,e.rtxSsrcId)),this._gateway.signal.on(yn.ON_REMOTE_DATASTREAM_UPDATE,e=>{this._handleUpdateDataChannel(e)}),this._gateway.signal.on(yn.ON_REMOTE_FULL_DATASTREAM_INFO,e=>{this._handleUpdateDataChannel({added:e.datastreams||[],deleted:[]},!0)}),this._gateway.signal.on(yn.ON_REMOVE_STREAM,this._handleRemoveStream),this._gateway.signal.on(yn.ON_P2P_LOST,this._handleP2PLost),this._gateway.signal.on(yn.MUTE_AUDIO,e=>this._handleMuteStream(e.uid,ut.AUDIO,!0)),this._gateway.signal.on(yn.UNMUTE_AUDIO,e=>this._handleMuteStream(e.uid,ut.AUDIO,!1)),this._gateway.signal.on(yn.MUTE_VIDEO,e=>this._handleMuteStream(e.uid,ut.VIDEO,!0)),this._gateway.signal.on(yn.UNMUTE_VIDEO,e=>this._handleMuteStream(e.uid,ut.VIDEO,!1)),this._gateway.signal.on(yn.RECEIVE_METADATA,e=>{const t=P_(e.metadata);this.safeEmit(In.RECEIVE_METADATA,e.uid,t)}),this._gateway.signal.on(yn.ON_DATA_STREAM,async e=>{var t;if(!e)return;let r=P_(e.payload);if(this._encryptDataStream&&this._encryptDataStreamIv&&this._encryptDataStreamKey&&window.crypto.subtle&&ht(t=["aes-128-gcm2","aes-256-gcm2"]).call(t,this._encryptionMode)){if(e.payload.length<Wb)throw new xe(se.UNEXPECTED_RESPONSE,"payload length ".concat(e.payload.length," is less than header length ").concat(Wb));r=await async function(f,m,E){const y=E.subarray(0,Wb),b=y.slice(8,Wb),A=(b[0]<<8)+b[1],O=(y[6]<<8)+y[7],D=await window.crypto.subtle.decrypt({name:"AES-GCM",iv:f,tagLength:h8,additionalData:new Uint8Array(Cx(A,2))},m,E.subarray(Wb));return new Uint8Array(D).subarray(0,O)}(this._encryptDataStreamIv,this._encryptDataStreamKey,r)}let s=0;if(e.ordered||e.syncWithAudio){const l=this._p2pChannel.getStats(),f=this.remoteUsers.find(E=>E.uid===e.uid),m=l==null?void 0:l.audioRecv.find(E=>E.ssrc===(f==null?void 0:f._audioSSRC));s=m==null?void 0:m.jitterBufferMs}(s==null||Number.isNaN(s))&&(s=0),e6(cd(cd({},e),{},{payload:r}),s,{id:this._clientId,onStreamMessage:typeof this.onStreamMessage=="function"?this.onStreamMessage.bind(this):void 0,safeEmit:this.safeEmit.bind(this)})}),this._gateway.signal.on(yn.ON_CRYPT_ERROR,()=>{ph(()=>{G.warning("[".concat(this._clientId,"] on crypt error")),this.safeEmit(In.CRYPT_ERROR)},this._sessionId)}),this._gateway.signal.on(yn.ON_TOKEN_PRIVILEGE_WILL_EXPIRE,this._handleTokenWillExpire),this._gateway.signal.on(yn.ON_TOKEN_PRIVILEGE_DID_EXPIRE,()=>{G.warning("[".concat(this._clientId,"] received message onTokenPrivilegeDidExpire, please get new token and join again")),this._gateway.leave(!0,nr.TOKEN_EXPIRE),this.safeEmit(In.ON_TOKEN_PRIVILEGE_DID_EXPIRE),this._reset()}),this._gateway.signal.on(yn.ON_STREAM_FALLBACK_UPDATE,e=>{G.debug("[".concat(this._clientId,"] stream fallback peerId: ").concat(e.stream_id,", attr: ").concat(e.stream_type)),this.safeEmit(In.STREAM_FALLBACK,e.stream_id,e.stream_type===1?"fallback":"recover")}),this._gateway.signal.on(yn.ON_PUBLISH_STREAM,e=>{this.uid===this._uid&&(this._p2pChannel.reportPublishEvent(!0,null,void 0,!1,JSON.stringify({proxy:e.proxy})),G.info("[".concat(this._clientId,"] on publish stream, ").concat(JSON.stringify(e))))}),this._gateway.signal.on(yn.ENABLE_LOCAL_VIDEO,e=>{this._handleSetStreamLocalEnable("video",e.uid,!0)}),this._gateway.signal.on(yn.DISABLE_LOCAL_VIDEO,e=>{this._handleSetStreamLocalEnable("video",e.uid,!1)}),this._gateway.signal.on(Ft.REQUEST_TIMEOUT,(e,t)=>{if(this._joinInfo)switch(e){case cn.PUBLISH:{if(!t)return;const l=t.ortc;if(l){var r,s;const f=l.some(y=>{let{stream_type:b}=y;return b===Er.Audio}),m=l.some(y=>{let{stream_type:b}=y;return b!==Er.Audio}),E=l.some(y=>{let{stream_type:b}=y;return b===Er.Screen||b===Er.ScreenLow});t.state==="offer"&&Vt.publish(this._joinInfo.sid,{eventElapse:ws.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:!1,ec:se.TIMEOUT,audio:f,video:m,p2pid:t.p2p_id,publishRequestid:this.store.pubId,screenshare:E,audioName:f?(r=l.find(y=>{let{stream_type:b}=y;return b===Er.Audio}))===null||r===void 0||(r=r.ssrcs[0])===null||r===void 0?void 0:r.ssrcId.toString():void 0,videoName:m?(s=l.find(y=>{let{stream_type:b}=y;return b!==Er.Audio}))===null||s===void 0||(s=s.ssrcs[0])===null||s===void 0?void 0:s.ssrcId.toString():void 0})}break}case cn.SUBSCRIBE:t&&Vt.subscribe(this._joinInfo.sid,{succ:!1,ec:se.TIMEOUT,audio:t.stream_type===ut.AUDIO,video:t.stream_type===ut.VIDEO,peerid:t.stream_id,subscribeRequestid:t.ssrcId,p2pid:this.store.p2pId,eventElapse:ws.measureFromSubscribeStart(this.store.clientId,t.ssrcId),preSsrc:this._p2pChannel.isPreSubScribe(t.ssrcId)})}}),this._gateway.signal.on(yn.ON_P2P_OK,e=>{this.uid,this._uid}),this._gateway.signal.on(yn.ON_PUBLISHED_USER_LIST,e=>{if(e==null||!e.users)return;me("BLOCK_LOCAL_CLIENT")&&(e.users=e.users.filter(s=>!B_(s.string_id||s.stream_id,this.channelName)));const t=[],r=[];for(const s of e.users){let l=this._users.find(A=>A._uintid===s.stream_id);l?l._trust_in_room_=!0:(l=new K_(s.string_id||s.stream_id,s.stream_id),this._users.push(l),this.getListeners(In.PUBLISHED_USER_LIST).length===0&&(G.debug("[".concat(this._clientId,"] user online"),s.stream_id),this.safeEmit(In.USER_JOINED,l)));const f=Mt.Audio&s.stream_type,m=(Mt.Video|Mt.LwoVideo)&s.stream_type,E=(65280&s.stream_type)!=0,y=f&&l.hasAudio,b=m&&l.hasVideo;m&&(l._trust_video_stream_added_state_=!0,l._video_added_=!0,l._videoSSRC=s.video_ssrc,l._rtxSsrcId=s.video_rtx),f&&(l._trust_audio_stream_added_state_=!0,l._audio_added_=!0,l._audioSSRC=s.audio_ssrc),f&&!y&&this.getListeners(In.PUBLISHED_USER_LIST).length===0&&(G.info("[".concat(this._clientId,"] remote user ").concat(l.uid," published audio")),this.safeEmit(In.USER_PUBLISHED,l,"audio")),m&&!b&&this.getListeners(In.PUBLISHED_USER_LIST).length===0&&(G.info("[".concat(this._clientId,"] remote user ").concat(l.uid," published video")),this.safeEmit(In.USER_PUBLISHED,l,"video")),(f&&!y||m&&!b||E)&&t.push(l),m&&this._p2pChannel.hasPendingRemoteMedia(l,"video")&&r.push({user:l,mediaType:"video"}),f&&this._p2pChannel.hasPendingRemoteMedia(l,"audio")&&r.push({user:l,mediaType:"audio"})}r.length>0&&(G.debug("[".concat(this._clientId,"] RE massSubscribe after reconnect ").concat(r.map(s=>"user: ".concat(s.user.uid,", mediaType: ").concat(s.mediaType)).join("; ")," ")),this.massSubscribe(r).catch(s=>{G.error("[".concat(this._clientId,"] mass resubscribe error"),s.toString())})),this.getListeners(In.PUBLISHED_USER_LIST).length>0?me("ENABLE_DATASTREAM_2")?this._pendingPublishedUsers=t:(G.info("[".concat(this._clientId,"] client emit user-list event, users: ").concat(t.map(s=>s.uid).join(", "))),this.safeEmit(In.PUBLISHED_USER_LIST,t)):G.info("[".concat(this._clientId,"] client not emit user-list event case there is no user-list listener, users: ").concat(t.map(s=>s.uid).join(", ")))}),this._gateway.signal.on(yn.ON_RTP_CAPABILITY_CHANGE,e=>{const{video_codec:t}=e;this._p2pChannel instanceof w1&&this._p2pChannel.updateRemoteRTPCapabilities(t.map(r=>r.toLowerCase()).filter(r=>{var s;return ht(s=Object.keys(AL)).call(s,r)}))})}_handleP2PEvents(){this._gateway.signal.on(yn.ON_USER_OFFLINE,()=>{this._p2pChannel.disconnectForReconnect()}),this._gateway.signal.on(ia.PUBLISH,(e,t,r)=>{const{uid:s}=e;e.forEach(l=>{const{kind:f,ssrcs:m,mid:E,isMuted:y}=l;this._handleP2PAddAudioOrVideoStream(f,s,m[0].ssrcId,E);const b=this._users.find(A=>A.uid===s);return b&&this.store.useP2P?this._p2pChannel.mockSubscribe(b,f,m[0].ssrcId,E).then(()=>{t()}).catch(r):t(),this._handleMuteStream(s,f,!!y)})}),this._gateway.signal.on(ia.CALL,async(e,t,r)=>{if(this.store.useP2P)try{var s;t(await this._p2pChannel.startP2P({turnServer:(s=this._joinInfo)===null||s===void 0?void 0:s.turnServer},e))}catch(l){r(l)}}),this._gateway.signal.on(Ft.P2P_CONNECTION,async e=>{this.store.useP2P&&(await this._p2pChannel).p2pConnect(e)}),this._gateway.signal.on(ia.UNPUBLISH,async(e,t,r)=>{if(this.store.useP2P){const{unpubMsg:s,uid:l}=e,f=this._users.find(m=>m.uid===l);if(!f)return G.warning("[".concat(this._clientId,"] can not find remote user, ignore mute event, uid: ").concat(l)),void t();try{s.forEach(async m=>{let{stream_type:E}=m;const y=E===Er.Audio?ut.AUDIO:ut.VIDEO;await this._p2pChannel.unsubscribe(f,y),this._handleMuteStream(l,y,!0)}),t()}catch(m){r(m)}}}),this._gateway.signal.on(ia.CONTROL,async(e,t)=>{const{action:r}=e;switch(r){case Ug.MUTE_LOCAL_VIDEO:this._handleMuteStream(t,ut.VIDEO,!0);break;case Ug.MUTE_LOCAL_AUDIO:this._handleMuteStream(t,ut.AUDIO,!0);break;case Ug.UNMUTE_LOCAL_VIDEO:this._handleP2PAddAudioOrVideoStream("video",t),this._handleMuteStream(t,ut.VIDEO,!1);break;case Ug.UNMUTE_LOCAL_AUDIO:this._handleP2PAddAudioOrVideoStream("audio",t),this._handleMuteStream(t,ut.AUDIO,!1)}}),this._gateway.signal.on(ia.RESTART_ICE,async(e,t,r)=>{if(this.store.useP2P)try{const{direction:s,iceParameter:l}=e;s!==Vi.SEND_ONLY||l?t(await this._p2pChannel.restartICE(s,l)):(this._p2pChannel.handleDisconnect(s),t())}catch(s){r(s)}}),this._gateway.signal.on(ia.CANDIDATE,e=>{if(this.store.useP2P){const{candidate:t,direction:r}=e;this._p2pChannel.addRemoteCandidate(t,r)}}),this._p2pChannel.on(Yt.RequestP2PRestartICE,async(e,t,r)=>{try{const{direction:s}=e;t(await this._gateway.sendExtensionMessage(ia.RESTART_ICE,e,s===Vi.SEND_ONLY))}catch(s){r(s)}}),this._p2pChannel.on(Yt.LocalCandidate,e=>{this._gateway.sendExtensionMessage(ia.CANDIDATE,JSON.stringify(e),!0)}),this._p2pChannel.on(Yt.RequestP2PMuteLocal,async(e,t,r)=>{try{await this._gateway.sendExtensionMessage(ia.CONTROL,e,!0),t()}catch(s){r(s)}}),this._p2pChannel.on(Yt.RequestP2PUnmuteRemote,async(e,t,r)=>{if(this._joinInfo)try{await this._gateway.unmuteRemote(e,this._joinInfo.stringUid||this._joinInfo.uid),t()}catch(s){s.code===se.DISCONNECT_P2P?t():r(s)}else t()}),this._p2pChannel.on(Yt.RequestP2PMuteRemote,async(e,t,r)=>{if(this._joinInfo)try{await this._gateway.muteRemote(e,this._joinInfo.stringUid||this._joinInfo.uid),t()}catch(s){s.code===se.DISCONNECT_P2P?t():r(s)}else t()}),this._p2pChannel.on(Yt.StateChange,(e,t)=>{t===Qn.Connected&&this._p2pChannel.republish()})}_handleP2PChannelEvents(){this._p2pChannel.on(Yt.PeerConnectionStateChange,e=>{const t=this._peerConnectionState;e!==t&&(this.safeEmit(In.PEERCONNECTION_STATE_CHANGE,e,t),this._peerConnectionState=e)}),this._p2pChannel.on(Yt.RequestMuteLocal,async(e,t,r)=>{if(this._joinInfo)try{await this._gateway.muteLocal(e,this._joinInfo.stringUid||this._joinInfo.uid),t()}catch(s){s.code===se.DISCONNECT_P2P?t():r(s)}else t()}),this._p2pChannel.on(Yt.RequestUnmuteLocal,async(e,t,r)=>{if(this._joinInfo)try{await this._gateway.unmuteLocal(e,this._joinInfo.stringUid||this._joinInfo.uid),t()}catch(s){s.code===se.DISCONNECT_P2P?t():r(s)}else t()}),this._p2pChannel.on(Yt.RequestRePublish,(e,t,r)=>{this.publish(e,!1).then(t).catch(r)}),this._p2pChannel.on(Yt.RequestRePublishDataChannel,(e,t,r)=>{gt.all(e.map(async s=>{const l=await this._p2pChannel.publishDataChannel([s]);try{l.forEach(f=>{this._uid&&this._gateway.publishDataChannel(this._uid,f,!0)})}catch(f){if(f.code!==se.DISCONNECT_P2P)throw f}})).then(t).catch(r)}),this._p2pChannel.on(Yt.RequestReSubscribe,async(e,t,r)=>{try{for(const{user:s,kind:l}of e)l===ut.VIDEO?await this.subscribe(s,"video"):await this.subscribe(s,"audio");t()}catch(s){r(s)}}),this._p2pChannel.on(Yt.RequestUpload,(e,t)=>{this._gateway.upload(e,t)}),this._p2pChannel.on(Yt.RequestUploadStats,e=>{this._gateway.uploadWRTCStats(e)}),this._p2pChannel.on(Yt.MediaReconnectStart,e=>{this.safeEmit(In.MEDIA_RECONNECT_START,e)}),this._p2pChannel.on(Yt.MediaReconnectEnd,e=>{this.safeEmit(In.MEDIA_RECONNECT_END,e)}),this._p2pChannel.on(Yt.NeedSignalRTT,e=>{e(this._gateway.getSignalRTT())}),this._p2pChannel.on(Yt.RequestRestartICE,async e=>{if(this.store.useP2P)return;const t=await this._p2pChannel.restartICE(e),r=await t.next();if(r.done)return;const s=r.value;let l;try{l=await this._gateway.restartICE({iceParameters:s})}catch(m){return void t.throw(m)}const{iceParameters:f}=function(m){const E=m.iceParameters;return{iceParameters:{iceUfrag:E.iceUfrag,icePwd:E.icePwd}}}(l);await t.next({remoteIceParameters:f})}),this._p2pChannel.on(Yt.RequestReconnect,async()=>{this._gateway.reconnect()}),this._p2pChannel.on(Yt.RequestReconnectPC,async()=>{var e;const{iceParameters:t,dtlsParameters:r,rtpCapabilities:s}=await this._p2pChannel.startP2PConnection({turnServer:(e=this._joinInfo)===null||e===void 0?void 0:e.turnServer}),{gatewayEstablishParams:l,gatewayAddress:f}=await this._gateway.reconnectPC({iceParameters:t,dtlsParameters:r,rtpCapabilities:s}),m=iD(l,f);await this._p2pChannel.connect(m),await this._p2pChannel.republish(),await this._p2pChannel.reSubscribe()}),this._p2pChannel.on(Yt.RequestUnpublishForReconnectPC,async(e,t,r)=>{this._joinInfo&&this._uid!==void 0?(await this._gateway.unpublish(e,this._uid),t()):r()}),this._p2pChannel.on(Yt.P2PLost,()=>{this.safeEmit(In.P2P_LOST,this.store.uid)}),this._p2pChannel.on(Yt.UpdateVideoEncoder,e=>{e._encoderConfig&&this._gateway.setVideoProfile(e._encoderConfig)}),this._p2pChannel.on(Yt.ConnectionTypeChange,e=>{this.safeEmit(In.IS_USING_CLOUD_PROXY,e)}),this._p2pChannel.on(Yt.RequestLowStreamParameter,e=>{e(this._lowStreamParameter||{width:160,height:120,framerate:15,bitrate:50})}),this._p2pChannel.on(Yt.QueryClientConnectionState,e=>{e(this.connectionState)}),this._p2pChannel.on(Yt.AudioMetadata,e=>{this.safeEmit(In.AUDIO_METADATA,e)})}getKeyMetrics(){return this.store.keyMetrics}async enableContentInspect(e){if(!this._joinInfo||this.connectionState!=="CONNECTED")throw new xe(se.INVALID_OPERATION,"[".concat(this._clientId,"] can not create content inspect, please join channel first"));if(this._inspect)throw new xe(se.INVALID_OPERATION,"[".concat(this._clientId,"] Inspect content service already in connecting/connected state"));try{const r=(t={config:e},wh("ContentInspect").create(t));this._inspect=r,this.handleVideoInspectEvents(r);const{appId:s,cname:l,sid:f,token:m,uid:E,cid:y,vid:b}=this._joinInfo;await r.init({appId:s,areaCode:"",cname:l,sid:f,token:m,uid:E,cid:y,vid:b?Number(b):0},ra)}catch(r){throw Array.isArray(r)?r[0]:r}var t}handleVideoInspectEvents(e){e.on(ja.CONNECTION_STATE_CHANGE,(t,r)=>{if(this.safeEmit(In.CONTENT_INSPECT_CONNECTION_STATE_CHANGE,t,r),r===Hc.CONNECTED){if(this.connectionState!=="CONNECTED")return void this.safeEmit(In.CONTENT_INSPECT_ERROR,new xe(se.OPERATION_ABORTED,"Content inspect was cancelled because it left the channel"));e.inspectImage()}}),e.on(ja.INSPECT_RESULT,(t,r)=>{var s;if((r==null?void 0:r.code)===se.INVALID_OPERATION&&this.connectionState==="DISCONNECTED")return G.debug("Stop inspect content because that has left channel"),this==null||(s=this._inspect)===null||s===void 0||s.close(),void(this._inspect=void 0);this.safeEmit(In.CONTENT_INSPECT_RESULT,t,r)}),e.on(ja.CLIENT_LOCAL_VIDEO_TRACK,t=>{t(this.localTracks.filter(r=>r.trackMediaType==="video")[0])})}async disableContentInspect(){if(!this._inspect)throw new xe(se.INVALID_OPERATION,"[".concat(this._clientId,"] inspectVideoContent not started"));try{this._inspect.close(),this._inspect=void 0}catch(e){throw Array.isArray(e)?e[0]:e}}async setImageModeration(e,t){if(hh(e,"enabled"),e){if(!t)throw new xe(se.INVALID_PARAMS,"config is required");if(f6(t),!this._joinInfo)throw new xe(se.INVALID_OPERATION,"can not create image moderation, please join channel first");try{if(this._moderation)this._moderation.updateConfig(t);else{const s=(r={config:t},wh("ImageModeration").create(r));this._moderation=s,this.handleImageModerationEvents(s);const{appId:l,cname:f,sid:m,token:E,uid:y,cid:b,vid:A}=this._joinInfo;await s.init({appId:l,areaCode:"",cname:f,sid:m,token:E,uid:y,cid:b,vid:A?Number(A):0},ra)}}catch(s){throw Array.isArray(s)?s[0]:s}}else{var r;if(!this._moderation)throw new xe(se.INVALID_OPERATION,"[".concat(this._clientId,"] image moderation not started"));try{this._moderation.close(),this._moderation.removeAllListeners(),this._moderation=void 0}catch(s){throw Array.isArray(s)?s[0]:s}}}handleImageModerationEvents(e){e.on(Th.CONNECTION_STATE_CHANGE,(t,r)=>{if(this.safeEmit(In.IMAGE_MODERATION_CONNECTION_STATE_CHANGE,t,r),t===iu.CONNECTED){if(this.connectionState!=="CONNECTED")throw this.setImageModeration(!1),new xe(se.OPERATION_ABORTED,"Image moderation was cancelled because it left the channel");e.inspectImage()}}),e.on(Th.CLIENT_LOCAL_VIDEO_TRACK,t=>{t(this.localTracks.filter(r=>r.trackMediaType==="video")[0])})}setP2PTransport(e){if(function(t){Aa(t,"transport",["default","auto","relay","sd-rtn"])}(e),this.mode!=="p2p")throw new xe(se.INVALID_OPERATION,"only p2p mode can set p2pTransport");this.store.p2pTransport=e,G.info("[".concat(this._clientId,"] set client p2pTransport to ").concat(e))}getJoinChannelServiceRecords(){return G.debug("getJoinChannelServiceRecords"),this.store.joinChannelServiceRecords}async setPublishAudioFilterEnabled(e){hh(e,"enabled"),Dn("ENABLE_PUBLISH_AUDIO_FILTER",e),this._joinInfo&&await this._gateway.setPublishAudioFilterEnabled(e)}_handleResetAddStream(e,t){switch(t){case"audio":e._audio_added_=!1,e._trust_audio_stream_added_state_=!0;break;case"video":e._video_added_=!1,e._trust_video_stream_added_state_=!0}}},Ot(Rt.prototype,"leave",[h6],Object.getOwnPropertyDescriptor(Rt.prototype,"leave"),Rt.prototype),Ot(Rt.prototype,"publish",[p6],Object.getOwnPropertyDescriptor(Rt.prototype,"publish"),Rt.prototype),Ot(Rt.prototype,"unpublish",[m6],Object.getOwnPropertyDescriptor(Rt.prototype,"unpublish"),Rt.prototype),Ot(Rt.prototype,"subscribe",[g6],Object.getOwnPropertyDescriptor(Rt.prototype,"subscribe"),Rt.prototype),Ot(Rt.prototype,"presubscribe",[_6],Object.getOwnPropertyDescriptor(Rt.prototype,"presubscribe"),Rt.prototype),Ot(Rt.prototype,"massSubscribe",[E6],Object.getOwnPropertyDescriptor(Rt.prototype,"massSubscribe"),Rt.prototype),Ot(Rt.prototype,"unsubscribe",[v6],Object.getOwnPropertyDescriptor(Rt.prototype,"unsubscribe"),Rt.prototype),Ot(Rt.prototype,"massUnsubscribe",[S6],Object.getOwnPropertyDescriptor(Rt.prototype,"massUnsubscribe"),Rt.prototype),Ot(Rt.prototype,"setLowStreamParameter",[y6],Object.getOwnPropertyDescriptor(Rt.prototype,"setLowStreamParameter"),Rt.prototype),Ot(Rt.prototype,"enableDualStream",[T6],Object.getOwnPropertyDescriptor(Rt.prototype,"enableDualStream"),Rt.prototype),Ot(Rt.prototype,"disableDualStream",[b6],Object.getOwnPropertyDescriptor(Rt.prototype,"disableDualStream"),Rt.prototype),Ot(Rt.prototype,"setClientRole",[C6],Object.getOwnPropertyDescriptor(Rt.prototype,"setClientRole"),Rt.prototype),Ot(Rt.prototype,"_setClientRoleOptions",[w6],Object.getOwnPropertyDescriptor(Rt.prototype,"_setClientRoleOptions"),Rt.prototype),Ot(Rt.prototype,"setProxyServer",[R6],Object.getOwnPropertyDescriptor(Rt.prototype,"setProxyServer"),Rt.prototype),Ot(Rt.prototype,"setTurnServer",[I6],Object.getOwnPropertyDescriptor(Rt.prototype,"setTurnServer"),Rt.prototype),Ot(Rt.prototype,"setLicense",[A6],Object.getOwnPropertyDescriptor(Rt.prototype,"setLicense"),Rt.prototype),Ot(Rt.prototype,"startProxyServer",[O6],Object.getOwnPropertyDescriptor(Rt.prototype,"startProxyServer"),Rt.prototype),Ot(Rt.prototype,"stopProxyServer",[N6],Object.getOwnPropertyDescriptor(Rt.prototype,"stopProxyServer"),Rt.prototype),Ot(Rt.prototype,"setLocalAccessPointsV2",[L6],Object.getOwnPropertyDescriptor(Rt.prototype,"setLocalAccessPointsV2"),Rt.prototype),Ot(Rt.prototype,"setLocalAccessPoints",[D6],Object.getOwnPropertyDescriptor(Rt.prototype,"setLocalAccessPoints"),Rt.prototype),Ot(Rt.prototype,"setRemoteDefaultVideoStreamType",[P6],Object.getOwnPropertyDescriptor(Rt.prototype,"setRemoteDefaultVideoStreamType"),Rt.prototype),Ot(Rt.prototype,"setRemoteVideoStreamType",[M6],Object.getOwnPropertyDescriptor(Rt.prototype,"setRemoteVideoStreamType"),Rt.prototype),Ot(Rt.prototype,"setStreamFallbackOption",[k6],Object.getOwnPropertyDescriptor(Rt.prototype,"setStreamFallbackOption"),Rt.prototype),Ot(Rt.prototype,"setEncryptionConfig",[x6],Object.getOwnPropertyDescriptor(Rt.prototype,"setEncryptionConfig"),Rt.prototype),Ot(Rt.prototype,"renewToken",[U6],Object.getOwnPropertyDescriptor(Rt.prototype,"renewToken"),Rt.prototype),Ot(Rt.prototype,"enableAudioVolumeIndicator",[j6],Object.getOwnPropertyDescriptor(Rt.prototype,"enableAudioVolumeIndicator"),Rt.prototype),Ot(Rt.prototype,"startLiveStreaming",[V6],Object.getOwnPropertyDescriptor(Rt.prototype,"startLiveStreaming"),Rt.prototype),Ot(Rt.prototype,"setLiveTranscoding",[B6],Object.getOwnPropertyDescriptor(Rt.prototype,"setLiveTranscoding"),Rt.prototype),Ot(Rt.prototype,"stopLiveStreaming",[F6],Object.getOwnPropertyDescriptor(Rt.prototype,"stopLiveStreaming"),Rt.prototype),Ot(Rt.prototype,"startChannelMediaRelay",[G6],Object.getOwnPropertyDescriptor(Rt.prototype,"startChannelMediaRelay"),Rt.prototype),Ot(Rt.prototype,"updateChannelMediaRelay",[z6],Object.getOwnPropertyDescriptor(Rt.prototype,"updateChannelMediaRelay"),Rt.prototype),Ot(Rt.prototype,"stopChannelMediaRelay",[H6],Object.getOwnPropertyDescriptor(Rt.prototype,"stopChannelMediaRelay"),Rt.prototype),Ot(Rt.prototype,"sendCustomReportMessage",[wt],Object.getOwnPropertyDescriptor(Rt.prototype,"sendCustomReportMessage"),Rt.prototype),Ot(Rt.prototype,"pickSVCLayer",[W6],Object.getOwnPropertyDescriptor(Rt.prototype,"pickSVCLayer"),Rt.prototype),Ot(Rt.prototype,"setRTMConfig",[lu],Object.getOwnPropertyDescriptor(Rt.prototype,"setRTMConfig"),Rt.prototype),Ot(Rt.prototype,"enableContentInspect",[EF],Object.getOwnPropertyDescriptor(Rt.prototype,"enableContentInspect"),Rt.prototype),Ot(Rt.prototype,"disableContentInspect",[L1],Object.getOwnPropertyDescriptor(Rt.prototype,"disableContentInspect"),Rt.prototype),Ot(Rt.prototype,"setImageModeration",[Y6],Object.getOwnPropertyDescriptor(Rt.prototype,"setImageModeration"),Rt.prototype),Ot(Rt.prototype,"setP2PTransport",[JI],Object.getOwnPropertyDescriptor(Rt.prototype,"setP2PTransport"),Rt.prototype),Ot(Rt.prototype,"getJoinChannelServiceRecords",[vF],Object.getOwnPropertyDescriptor(Rt.prototype,"getJoinChannelServiceRecords"),Rt.prototype),Ot(Rt.prototype,"setPublishAudioFilterEnabled",[SF],Object.getOwnPropertyDescriptor(Rt.prototype,"setPublishAudioFilterEnabled"),Rt.prototype),Rt);class XI{constructor(t,r){ne(this,"id",0),ne(this,"element",void 0),ne(this,"peerPair",void 0),ne(this,"context",void 0),ne(this,"audioPlayerElement",void 0),ne(this,"audioTrack",void 0),XI.count+=1,this.id=XI.count,this.element=t,this.context=r}initPeers(){this.peerPair=[new RTCPeerConnection,new RTCPeerConnection],this.peerPair[1].ontrack=t=>{const r=document.createElement("audio");r.srcObject=new MediaStream([t.track]),r.play(),this.audioPlayerElement=r}}async switchSdp(){if(!this.peerPair)return;const t=async(s,l)=>{const f=l==="offer"?await s.createOffer():await s.createAnswer();return await s.setLocalDescription(f),s.iceGatheringState==="complete"?s.localDescription:new gt(m=>{s.onicegatheringstatechange=()=>{s.iceGatheringState==="complete"&&m(s.localDescription)}})},r=async(s,l)=>await s.setRemoteDescription(l);try{const s=await t(this.peerPair[0],"offer");await r(this.peerPair[1],s);const l=await t(this.peerPair[1],"answer");await r(this.peerPair[0],l)}catch(s){throw new xe(se.LOCAL_AEC_ERROR,s.toString()).print()}}async getTracksFromMediaElement(t){if(this.audioTrack)return this.audioTrack;let r;try{t instanceof HTMLVideoElement&&(t.captureStream?t.captureStream():t.mozCaptureStream()),r=this.context.createMediaStreamDestination(),this.context.createMediaElementSource(t).connect(r)}catch(l){throw new xe(se.LOCAL_AEC_ERROR,l.toString()).print()}if(!r)throw new xe(se.LOCAL_AEC_ERROR,"no dest node when local aec").print();const s=r.stream.getAudioTracks()[0];return this.audioTrack=s,s}getElement(){return this.element}async startEchoCancellation(){this.context.resume(),this.peerPair&&this.close(),this.initPeers();const t=this.element,r=await this.getTracksFromMediaElement(t);this.peerPair&&this.peerPair[0].addTrack(r),await this.switchSdp()}close(){G.debug("close echo cancellation unit, id is",this.id),this.audioPlayerElement&&this.audioPlayerElement.pause(),this.peerPair&&this.peerPair.forEach(t=>{t.close()}),this.peerPair=void 0,this.audioPlayerElement=void 0}}var TF,QI;ne(XI,"count",0);const PY=window.AudioContext||window.webkitAudioContext,Ao=new(TF=nn({report:Vt}),Ot((QI=class{constructor(){ne(this,"units",[]),ne(this,"context",void 0)}processExternalMediaAEC(e){if(!this._doesEnvironmentNeedAEC())return G.debug("the system does not need to process local aec"),-1;this.context||(this.context=new PY);let t=this.units.find(r=>r&&r.getElement()===e);return t||(t=new XI(e,this.context),this.units.push(t)),t.startEchoCancellation(),G.debug("start processing local audio echo cancellation, id is",t.id),t.id}_doesEnvironmentNeedAEC(){return qn().name!==sr.SAFARI}}).prototype,"processExternalMediaAEC",[TF],Object.getOwnPropertyDescriptor(QI.prototype,"processExternalMediaAEC"),QI.prototype),QI);function HS(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),r.push.apply(r,s)}return r}function AD(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?HS(Object(r),!0).forEach(function(s){ne(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):HS(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}const OD=window||document;function D1(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];if(!OD)return;const r=R._cspEventHandlerPointer;if(r&&t)return void console.error(r,t);const s=l=>{if(!(l&&l.blockedURI&&(R.onSecurityPolicyViolation||R.getListeners(Kp.SECURITY_POLICY_VIOLATION).length>0)))return;const f=l.blockedURI;me("CSP_DETECTED_HOSTNAME_LIST").some(m=>ht(f).call(f,m))&&(R.onSecurityPolicyViolation&&typeof R.onSecurityPolicyViolation=="function"&&R.onSecurityPolicyViolation(l),R.getListeners(Kp.SECURITY_POLICY_VIOLATION).length>0&&R.safeEmit(Kp.SECURITY_POLICY_VIOLATION,l))};r&&OD.removeEventListener("securitypolicyviolation",r),(t||e&&typeof e=="function"||R.getListeners(Kp.SECURITY_POLICY_VIOLATION).length>0)&&OD.addEventListener("securitypolicyviolation",s),R._cspEventHandlerPointer=s}var ZI=Q,q6=Nb,$I=RegExp.prototype,MY=function(e){return e===$I||ZI($I,e)?q6(e):e.flags},oo=T(MY);function ld(e){let t=e.length;for(;--t>=0;)e[t]=0}const WS=256,P1=286,$g=30,YS=15,M1=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),k1=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),bF=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),J6=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Zp=new Array(576);ld(Zp);const KS=new Array(60);ld(KS);const x1=new Array(512);ld(x1);const e0=new Array(256);ld(e0);const qc=new Array(29);ld(qc);const du=new Array($g);function ND(e,t,r,s,l){this.static_tree=e,this.extra_bits=t,this.extra_base=r,this.elems=s,this.max_length=l,this.has_stree=e&&e.length}let X6,Q6,Z6;function LD(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}ld(du);const DD=e=>e<256?x1[e]:x1[256+(e>>>7)],U1=(e,t)=>{e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255},Jc=(e,t,r)=>{e.bi_valid>16-r?(e.bi_buf|=t<<e.bi_valid&65535,U1(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=r-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=r)},Nh=(e,t,r)=>{Jc(e,r[2*t],r[2*t+1])},$6=(e,t)=>{let r=0;do r|=1&e,e>>>=1,r<<=1;while(--t>0);return r>>>1},ej=(e,t,r)=>{const s=new Array(16);let l,f,m=0;for(l=1;l<=YS;l++)m=m+r[l-1]<<1,s[l]=m;for(f=0;f<=t;f++){let E=e[2*f+1];E!==0&&(e[2*f]=$6(s[E]++,E))}},tj=e=>{let t;for(t=0;t<P1;t++)e.dyn_ltree[2*t]=0;for(t=0;t<$g;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},CF=e=>{e.bi_valid>8?U1(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},wF=(e,t,r,s)=>{const l=2*t,f=2*r;return e[l]<e[f]||e[l]===e[f]&&s[t]<=s[r]},nj=(e,t,r)=>{const s=e.heap[r];let l=r<<1;for(;l<=e.heap_len&&(l<e.heap_len&&wF(t,e.heap[l+1],e.heap[l],e.depth)&&l++,!wF(t,s,e.heap[l],e.depth));)e.heap[r]=e.heap[l],r=l,l<<=1;e.heap[r]=s},RF=(e,t,r)=>{let s,l,f,m,E=0;if(e.sym_next!==0)do s=255&e.pending_buf[e.sym_buf+E++],s+=(255&e.pending_buf[e.sym_buf+E++])<<8,l=e.pending_buf[e.sym_buf+E++],s===0?Nh(e,l,t):(f=e0[l],Nh(e,f+WS+1,t),m=M1[f],m!==0&&(l-=qc[f],Jc(e,l,m)),s--,f=DD(s),Nh(e,f,r),m=k1[f],m!==0&&(s-=du[f],Jc(e,s,m)));while(E<e.sym_next);Nh(e,256,t)},rj=(e,t)=>{const r=t.dyn_tree,s=t.stat_desc.static_tree,l=t.stat_desc.has_stree,f=t.stat_desc.elems;let m,E,y,b=-1;for(e.heap_len=0,e.heap_max=573,m=0;m<f;m++)r[2*m]!==0?(e.heap[++e.heap_len]=b=m,e.depth[m]=0):r[2*m+1]=0;for(;e.heap_len<2;)y=e.heap[++e.heap_len]=b<2?++b:0,r[2*y]=1,e.depth[y]=0,e.opt_len--,l&&(e.static_len-=s[2*y+1]);for(t.max_code=b,m=e.heap_len>>1;m>=1;m--)nj(e,r,m);y=f;do m=e.heap[1],e.heap[1]=e.heap[e.heap_len--],nj(e,r,1),E=e.heap[1],e.heap[--e.heap_max]=m,e.heap[--e.heap_max]=E,r[2*y]=r[2*m]+r[2*E],e.depth[y]=(e.depth[m]>=e.depth[E]?e.depth[m]:e.depth[E])+1,r[2*m+1]=r[2*E+1]=y,e.heap[1]=y++,nj(e,r,1);while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],((A,O)=>{const D=O.dyn_tree,P=O.max_code,F=O.stat_desc.static_tree,B=O.stat_desc.has_stree,Y=O.stat_desc.extra_bits,$=O.stat_desc.extra_base,ee=O.stat_desc.max_length;let Ee,Re,Ie,we,Ue,ve,Ne=0;for(we=0;we<=YS;we++)A.bl_count[we]=0;for(D[2*A.heap[A.heap_max]+1]=0,Ee=A.heap_max+1;Ee<573;Ee++)Re=A.heap[Ee],we=D[2*D[2*Re+1]+1]+1,we>ee&&(we=ee,Ne++),D[2*Re+1]=we,Re>P||(A.bl_count[we]++,Ue=0,Re>=$&&(Ue=Y[Re-$]),ve=D[2*Re],A.opt_len+=ve*(we+Ue),B&&(A.static_len+=ve*(F[2*Re+1]+Ue)));if(Ne!==0){do{for(we=ee-1;A.bl_count[we]===0;)we--;A.bl_count[we]--,A.bl_count[we+1]+=2,A.bl_count[ee]--,Ne-=2}while(Ne>0);for(we=ee;we!==0;we--)for(Re=A.bl_count[we];Re!==0;)Ie=A.heap[--Ee],Ie>P||(D[2*Ie+1]!==we&&(A.opt_len+=(we-D[2*Ie+1])*D[2*Ie],D[2*Ie+1]=we),Re--)}})(e,t),ej(r,b,e.bl_count)},j1=(e,t,r)=>{let s,l,f=-1,m=t[1],E=0,y=7,b=4;for(m===0&&(y=138,b=3),t[2*(r+1)+1]=65535,s=0;s<=r;s++)l=m,m=t[2*(s+1)+1],++E<y&&l===m||(E<b?e.bl_tree[2*l]+=E:l!==0?(l!==f&&e.bl_tree[2*l]++,e.bl_tree[32]++):E<=10?e.bl_tree[34]++:e.bl_tree[36]++,E=0,f=l,m===0?(y=138,b=3):l===m?(y=6,b=3):(y=7,b=4))},IF=(e,t,r)=>{let s,l,f=-1,m=t[1],E=0,y=7,b=4;for(m===0&&(y=138,b=3),s=0;s<=r;s++)if(l=m,m=t[2*(s+1)+1],!(++E<y&&l===m)){if(E<b)do Nh(e,l,e.bl_tree);while(--E!=0);else l!==0?(l!==f&&(Nh(e,l,e.bl_tree),E--),Nh(e,16,e.bl_tree),Jc(e,E-3,2)):E<=10?(Nh(e,17,e.bl_tree),Jc(e,E-3,3)):(Nh(e,18,e.bl_tree),Jc(e,E-11,7));E=0,f=l,m===0?(y=138,b=3):l===m?(y=6,b=3):(y=7,b=4)}};let Oo=!1;const eE=(e,t,r,s)=>{Jc(e,0+(s?1:0),3),CF(e),U1(e,r),U1(e,~r),r&&e.pending_buf.set(e.window.subarray(t,t+r),e.pending),e.pending+=r};var PD=e=>{Oo||((()=>{let t,r,s,l,f;const m=new Array(16);for(s=0,l=0;l<28;l++)for(qc[l]=s,t=0;t<1<<M1[l];t++)e0[s++]=l;for(e0[s-1]=l,f=0,l=0;l<16;l++)for(du[l]=f,t=0;t<1<<k1[l];t++)x1[f++]=l;for(f>>=7;l<$g;l++)for(du[l]=f<<7,t=0;t<1<<k1[l]-7;t++)x1[256+f++]=l;for(r=0;r<=YS;r++)m[r]=0;for(t=0;t<=143;)Zp[2*t+1]=8,t++,m[8]++;for(;t<=255;)Zp[2*t+1]=9,t++,m[9]++;for(;t<=279;)Zp[2*t+1]=7,t++,m[7]++;for(;t<=287;)Zp[2*t+1]=8,t++,m[8]++;for(ej(Zp,287,m),t=0;t<$g;t++)KS[2*t+1]=5,KS[2*t]=$6(t,5);X6=new ND(Zp,M1,257,P1,YS),Q6=new ND(KS,k1,0,$g,YS),Z6=new ND(new Array(0),bF,0,19,7)})(),Oo=!0),e.l_desc=new LD(e.dyn_ltree,X6),e.d_desc=new LD(e.dyn_dtree,Q6),e.bl_desc=new LD(e.bl_tree,Z6),e.bi_buf=0,e.bi_valid=0,tj(e)},kY=(e,t,r,s)=>{let l,f,m=0;e.level>0?(e.strm.data_type===2&&(e.strm.data_type=(E=>{let y,b=4093624447;for(y=0;y<=31;y++,b>>>=1)if(1&b&&E.dyn_ltree[2*y]!==0)return 0;if(E.dyn_ltree[18]!==0||E.dyn_ltree[20]!==0||E.dyn_ltree[26]!==0)return 1;for(y=32;y<WS;y++)if(E.dyn_ltree[2*y]!==0)return 1;return 0})(e)),rj(e,e.l_desc),rj(e,e.d_desc),m=(E=>{let y;for(j1(E,E.dyn_ltree,E.l_desc.max_code),j1(E,E.dyn_dtree,E.d_desc.max_code),rj(E,E.bl_desc),y=18;y>=3&&E.bl_tree[2*J6[y]+1]===0;y--);return E.opt_len+=3*(y+1)+5+5+4,y})(e),l=e.opt_len+3+7>>>3,f=e.static_len+3+7>>>3,f<=l&&(l=f)):l=f=r+5,r+4<=l&&t!==-1?eE(e,t,r,s):e.strategy===4||f===l?(Jc(e,2+(s?1:0),3),RF(e,Zp,KS)):(Jc(e,4+(s?1:0),3),((E,y,b,A)=>{let O;for(Jc(E,y-257,5),Jc(E,b-1,5),Jc(E,A-4,4),O=0;O<A;O++)Jc(E,E.bl_tree[2*J6[O]+1],3);IF(E,E.dyn_ltree,y-1),IF(E,E.dyn_dtree,b-1)})(e,e.l_desc.max_code+1,e.d_desc.max_code+1,m+1),RF(e,e.dyn_ltree,e.dyn_dtree)),tj(e),s&&CF(e)},ij=(e,t,r)=>(e.pending_buf[e.sym_buf+e.sym_next++]=t,e.pending_buf[e.sym_buf+e.sym_next++]=t>>8,e.pending_buf[e.sym_buf+e.sym_next++]=r,t===0?e.dyn_ltree[2*r]++:(e.matches++,t--,e.dyn_ltree[2*(e0[r]+WS+1)]++,e.dyn_dtree[2*DD(t)]++),e.sym_next===e.sym_end),xY=e=>{Jc(e,2,3),Nh(e,256,Zp),(t=>{t.bi_valid===16?(U1(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)})(e)},tE={_tr_init:PD,_tr_stored_block:eE,_tr_flush_block:kY,_tr_tally:ij,_tr_align:xY},eA=(e,t,r,s)=>{let l=65535&e|0,f=e>>>16&65535|0,m=0;for(;r!==0;){m=r>2e3?2e3:r,r-=m;do l=l+t[s++]|0,f=f+l|0;while(--m);l%=65521,f%=65521}return l|f<<16|0};const nE=new Uint32Array((()=>{let e,t=[];for(var r=0;r<256;r++){e=r;for(var s=0;s<8;s++)e=1&e?3988292384^e>>>1:e>>>1;t[r]=e}return t})());var Ko=(e,t,r,s)=>{const l=nE,f=s+r;e^=-1;for(let m=s;m<f;m++)e=e>>>8^l[255&(e^t[m])];return-1^e},qS={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Ol={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:AF,_tr_stored_block:No,_tr_flush_block:OF,_tr_tally:pc,_tr_align:UY}=tE,{Z_NO_FLUSH:$p,Z_PARTIAL_FLUSH:jY,Z_FULL_FLUSH:VY,Z_FINISH:Nl,Z_BLOCK:NF,Z_OK:mc,Z_STREAM_END:LF,Z_STREAM_ERROR:em,Z_DATA_ERROR:MD,Z_BUF_ERROR:tA,Z_DEFAULT_COMPRESSION:BY,Z_FILTERED:FY,Z_HUFFMAN_ONLY:kD,Z_RLE:GY,Z_FIXED:JS,Z_DEFAULT_STRATEGY:tm,Z_UNKNOWN:V1,Z_DEFLATED:nm}=Ol,XS=286,QS=30,DF=19,rE=2*XS+1,zY=15,dd=258,Rs=262,qo=42,si=113,t0=666,n0=(e,t)=>(e.msg=qS[t],t),aj=e=>2*e-(e>4?9:0),uu=e=>{let t=e.length;for(;--t>=0;)e[t]=0},PF=e=>{let t,r,s,l=e.w_size;t=e.hash_size,s=t;do r=e.head[--s],e.head[s]=r>=l?r-l:0;while(--t);t=l,s=t;do r=e.prev[--s],e.prev[s]=r>=l?r-l:0;while(--t)};let rm=(e,t,r)=>(t<<e.hash_shift^r)&e.hash_mask;const Jo=e=>{const t=e.state;let r=t.pending;r>e.avail_out&&(r=e.avail_out),r!==0&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+r),e.next_out),e.next_out+=r,t.pending_out+=r,e.total_out+=r,e.avail_out-=r,t.pending-=r,t.pending===0&&(t.pending_out=0))},Is=(e,t)=>{OF(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,Jo(e.strm)},bi=(e,t)=>{e.pending_buf[e.pending++]=t},nA=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t},ZS=(e,t,r,s)=>{let l=e.avail_in;return l>s&&(l=s),l===0?0:(e.avail_in-=l,t.set(e.input.subarray(e.next_in,e.next_in+l),r),e.state.wrap===1?e.adler=eA(e.adler,t,l,r):e.state.wrap===2&&(e.adler=Ko(e.adler,t,l,r)),e.next_in+=l,e.total_in+=l,l)},sj=(e,t)=>{let r,s,l=e.max_chain_length,f=e.strstart,m=e.prev_length,E=e.nice_match;const y=e.strstart>e.w_size-Rs?e.strstart-(e.w_size-Rs):0,b=e.window,A=e.w_mask,O=e.prev,D=e.strstart+dd;let P=b[f+m-1],F=b[f+m];e.prev_length>=e.good_match&&(l>>=2),E>e.lookahead&&(E=e.lookahead);do if(r=t,b[r+m]===F&&b[r+m-1]===P&&b[r]===b[f]&&b[++r]===b[f+1]){f+=2,r++;do;while(b[++f]===b[++r]&&b[++f]===b[++r]&&b[++f]===b[++r]&&b[++f]===b[++r]&&b[++f]===b[++r]&&b[++f]===b[++r]&&b[++f]===b[++r]&&b[++f]===b[++r]&&f<D);if(s=dd-(D-f),f=D-dd,s>m){if(e.match_start=t,m=s,s>=E)break;P=b[f+m-1],F=b[f+m]}}while((t=O[t&A])>y&&--l!=0);return m<=e.lookahead?m:e.lookahead},$S=e=>{const t=e.w_size;let r,s,l;do{if(s=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-Rs)&&(e.window.set(e.window.subarray(t,t+t-s),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,e.insert>e.strstart&&(e.insert=e.strstart),PF(e),s+=t),e.strm.avail_in===0)break;if(r=ZS(e.strm,e.window,e.strstart+e.lookahead,s),e.lookahead+=r,e.lookahead+e.insert>=3)for(l=e.strstart-e.insert,e.ins_h=e.window[l],e.ins_h=rm(e,e.ins_h,e.window[l+1]);e.insert&&(e.ins_h=rm(e,e.ins_h,e.window[l+3-1]),e.prev[l&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=l,l++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<Rs&&e.strm.avail_in!==0)},oj=(e,t)=>{let r,s,l,f=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,m=0,E=e.strm.avail_in;do{if(r=65535,l=e.bi_valid+42>>3,e.strm.avail_out<l||(l=e.strm.avail_out-l,s=e.strstart-e.block_start,r>s+e.strm.avail_in&&(r=s+e.strm.avail_in),r>l&&(r=l),r<f&&(r===0&&t!==Nl||t===$p||r!==s+e.strm.avail_in)))break;m=t===Nl&&r===s+e.strm.avail_in?1:0,No(e,0,0,m),e.pending_buf[e.pending-4]=r,e.pending_buf[e.pending-3]=r>>8,e.pending_buf[e.pending-2]=~r,e.pending_buf[e.pending-1]=~r>>8,Jo(e.strm),s&&(s>r&&(s=r),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+s),e.strm.next_out),e.strm.next_out+=s,e.strm.avail_out-=s,e.strm.total_out+=s,e.block_start+=s,r-=s),r&&(ZS(e.strm,e.strm.output,e.strm.next_out,r),e.strm.next_out+=r,e.strm.avail_out-=r,e.strm.total_out+=r)}while(m===0);return E-=e.strm.avail_in,E&&(E>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=E&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-E,e.strm.next_in),e.strstart),e.strstart+=E,e.insert+=E>e.w_size-e.insert?e.w_size-e.insert:E),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),m?4:t!==$p&&t!==Nl&&e.strm.avail_in===0&&e.strstart===e.block_start?2:(l=e.window_size-e.strstart,e.strm.avail_in>l&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,l+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),l>e.strm.avail_in&&(l=e.strm.avail_in),l&&(ZS(e.strm,e.window,e.strstart,l),e.strstart+=l,e.insert+=l>e.w_size-e.insert?e.w_size-e.insert:l),e.high_water<e.strstart&&(e.high_water=e.strstart),l=e.bi_valid+42>>3,l=e.pending_buf_size-l>65535?65535:e.pending_buf_size-l,f=l>e.w_size?e.w_size:l,s=e.strstart-e.block_start,(s>=f||(s||t===Nl)&&t!==$p&&e.strm.avail_in===0&&s<=l)&&(r=s>l?l:s,m=t===Nl&&e.strm.avail_in===0&&r===s?1:0,No(e,e.block_start,r,m),e.block_start+=r,Jo(e.strm)),m?3:1)},cj=(e,t)=>{let r,s;for(;;){if(e.lookahead<Rs){if($S(e),e.lookahead<Rs&&t===$p)return 1;if(e.lookahead===0)break}if(r=0,e.lookahead>=3&&(e.ins_h=rm(e,e.ins_h,e.window[e.strstart+3-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),r!==0&&e.strstart-r<=e.w_size-Rs&&(e.match_length=sj(e,r)),e.match_length>=3)if(s=pc(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do e.strstart++,e.ins_h=rm(e,e.ins_h,e.window[e.strstart+3-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;while(--e.match_length!=0);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=rm(e,e.ins_h,e.window[e.strstart+1]);else s=pc(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(s&&(Is(e,!1),e.strm.avail_out===0))return 1}return e.insert=e.strstart<2?e.strstart:2,t===Nl?(Is(e,!0),e.strm.avail_out===0?3:4):e.sym_next&&(Is(e,!1),e.strm.avail_out===0)?1:2},B1=(e,t)=>{let r,s,l;for(;;){if(e.lookahead<Rs){if($S(e),e.lookahead<Rs&&t===$p)return 1;if(e.lookahead===0)break}if(r=0,e.lookahead>=3&&(e.ins_h=rm(e,e.ins_h,e.window[e.strstart+3-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,r!==0&&e.prev_length<e.max_lazy_match&&e.strstart-r<=e.w_size-Rs&&(e.match_length=sj(e,r),e.match_length<=5&&(e.strategy===FY||e.match_length===3&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){l=e.strstart+e.lookahead-3,s=pc(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=l&&(e.ins_h=rm(e,e.ins_h,e.window[e.strstart+3-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(--e.prev_length!=0);if(e.match_available=0,e.match_length=2,e.strstart++,s&&(Is(e,!1),e.strm.avail_out===0))return 1}else if(e.match_available){if(s=pc(e,0,e.window[e.strstart-1]),s&&Is(e,!1),e.strstart++,e.lookahead--,e.strm.avail_out===0)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(s=pc(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,t===Nl?(Is(e,!0),e.strm.avail_out===0?3:4):e.sym_next&&(Is(e,!1),e.strm.avail_out===0)?1:2};function ud(e,t,r,s,l){this.good_length=e,this.max_lazy=t,this.nice_length=r,this.max_chain=s,this.func=l}const rA=[new ud(0,0,0,0,oj),new ud(4,4,8,4,cj),new ud(4,5,16,8,cj),new ud(4,6,32,32,cj),new ud(4,4,16,16,B1),new ud(8,16,32,32,B1),new ud(8,16,128,128,B1),new ud(8,32,128,256,B1),new ud(32,128,258,1024,B1),new ud(32,258,258,4096,B1)];function xD(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=nm,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(2*rE),this.dyn_dtree=new Uint16Array(2*(2*QS+1)),this.bl_tree=new Uint16Array(2*(2*DF+1)),uu(this.dyn_ltree),uu(this.dyn_dtree),uu(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(zY+1),this.heap=new Uint16Array(2*XS+1),uu(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*XS+1),uu(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const F1=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.status!==qo&&t.status!==57&&t.status!==69&&t.status!==73&&t.status!==91&&t.status!==103&&t.status!==si&&t.status!==t0?1:0},G1=e=>{if(F1(e))return n0(e,em);e.total_in=e.total_out=0,e.data_type=V1;const t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap===2?57:t.wrap?qo:si,e.adler=t.wrap===2?0:1,t.last_flush=-2,AF(t),mc},z1=e=>{const t=G1(e);return t===mc&&(r=>{r.window_size=2*r.w_size,uu(r.head),r.max_lazy_match=rA[r.level].max_lazy,r.good_match=rA[r.level].good_length,r.nice_match=rA[r.level].nice_length,r.max_chain_length=rA[r.level].max_chain,r.strstart=0,r.block_start=0,r.lookahead=0,r.insert=0,r.match_length=r.prev_length=2,r.match_available=0,r.ins_h=0})(e.state),t},lj=(e,t,r,s,l,f)=>{if(!e)return em;let m=1;if(t===BY&&(t=6),s<0?(m=0,s=-s):s>15&&(m=2,s-=16),l<1||l>9||r!==nm||s<8||s>15||t<0||t>9||f<0||f>JS||s===8&&m!==1)return n0(e,em);s===8&&(s=9);const E=new xD;return e.state=E,E.strm=e,E.status=qo,E.wrap=m,E.gzhead=null,E.w_bits=s,E.w_size=1<<E.w_bits,E.w_mask=E.w_size-1,E.hash_bits=l+7,E.hash_size=1<<E.hash_bits,E.hash_mask=E.hash_size-1,E.hash_shift=~~((E.hash_bits+3-1)/3),E.window=new Uint8Array(2*E.w_size),E.head=new Uint16Array(E.hash_size),E.prev=new Uint16Array(E.w_size),E.lit_bufsize=1<<l+6,E.pending_buf_size=4*E.lit_bufsize,E.pending_buf=new Uint8Array(E.pending_buf_size),E.sym_buf=E.lit_bufsize,E.sym_end=3*(E.lit_bufsize-1),E.level=t,E.strategy=f,E.method=r,z1(e)};var MF=(e,t)=>{if(F1(e)||t>NF||t<0)return e?n0(e,em):em;const r=e.state;if(!e.output||e.avail_in!==0&&!e.input||r.status===t0&&t!==Nl)return n0(e,e.avail_out===0?tA:em);const s=r.last_flush;if(r.last_flush=t,r.pending!==0){if(Jo(e),e.avail_out===0)return r.last_flush=-1,mc}else if(e.avail_in===0&&aj(t)<=aj(s)&&t!==Nl)return n0(e,tA);if(r.status===t0&&e.avail_in!==0)return n0(e,tA);if(r.status===qo&&r.wrap===0&&(r.status=si),r.status===qo){let l=nm+(r.w_bits-8<<4)<<8,f=-1;if(f=r.strategy>=kD||r.level<2?0:r.level<6?1:r.level===6?2:3,l|=f<<6,r.strstart!==0&&(l|=32),l+=31-l%31,nA(r,l),r.strstart!==0&&(nA(r,e.adler>>>16),nA(r,65535&e.adler)),e.adler=1,r.status=si,Jo(e),r.pending!==0)return r.last_flush=-1,mc}if(r.status===57){if(e.adler=0,bi(r,31),bi(r,139),bi(r,8),r.gzhead)bi(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),bi(r,255&r.gzhead.time),bi(r,r.gzhead.time>>8&255),bi(r,r.gzhead.time>>16&255),bi(r,r.gzhead.time>>24&255),bi(r,r.level===9?2:r.strategy>=kD||r.level<2?4:0),bi(r,255&r.gzhead.os),r.gzhead.extra&&r.gzhead.extra.length&&(bi(r,255&r.gzhead.extra.length),bi(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(e.adler=Ko(e.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=69;else if(bi(r,0),bi(r,0),bi(r,0),bi(r,0),bi(r,0),bi(r,r.level===9?2:r.strategy>=kD||r.level<2?4:0),bi(r,3),r.status=si,Jo(e),r.pending!==0)return r.last_flush=-1,mc}if(r.status===69){if(r.gzhead.extra){let l=r.pending,f=(65535&r.gzhead.extra.length)-r.gzindex;for(;r.pending+f>r.pending_buf_size;){let E=r.pending_buf_size-r.pending;if(r.pending_buf.set(r.gzhead.extra.subarray(r.gzindex,r.gzindex+E),r.pending),r.pending=r.pending_buf_size,r.gzhead.hcrc&&r.pending>l&&(e.adler=Ko(e.adler,r.pending_buf,r.pending-l,l)),r.gzindex+=E,Jo(e),r.pending!==0)return r.last_flush=-1,mc;l=0,f-=E}let m=new Uint8Array(r.gzhead.extra);r.pending_buf.set(m.subarray(r.gzindex,r.gzindex+f),r.pending),r.pending+=f,r.gzhead.hcrc&&r.pending>l&&(e.adler=Ko(e.adler,r.pending_buf,r.pending-l,l)),r.gzindex=0}r.status=73}if(r.status===73){if(r.gzhead.name){let l,f=r.pending;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>f&&(e.adler=Ko(e.adler,r.pending_buf,r.pending-f,f)),Jo(e),r.pending!==0)return r.last_flush=-1,mc;f=0}l=r.gzindex<r.gzhead.name.length?255&r.gzhead.name.charCodeAt(r.gzindex++):0,bi(r,l)}while(l!==0);r.gzhead.hcrc&&r.pending>f&&(e.adler=Ko(e.adler,r.pending_buf,r.pending-f,f)),r.gzindex=0}r.status=91}if(r.status===91){if(r.gzhead.comment){let l,f=r.pending;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>f&&(e.adler=Ko(e.adler,r.pending_buf,r.pending-f,f)),Jo(e),r.pending!==0)return r.last_flush=-1,mc;f=0}l=r.gzindex<r.gzhead.comment.length?255&r.gzhead.comment.charCodeAt(r.gzindex++):0,bi(r,l)}while(l!==0);r.gzhead.hcrc&&r.pending>f&&(e.adler=Ko(e.adler,r.pending_buf,r.pending-f,f))}r.status=103}if(r.status===103){if(r.gzhead.hcrc){if(r.pending+2>r.pending_buf_size&&(Jo(e),r.pending!==0))return r.last_flush=-1,mc;bi(r,255&e.adler),bi(r,e.adler>>8&255),e.adler=0}if(r.status=si,Jo(e),r.pending!==0)return r.last_flush=-1,mc}if(e.avail_in!==0||r.lookahead!==0||t!==$p&&r.status!==t0){let l=r.level===0?oj(r,t):r.strategy===kD?((f,m)=>{let E;for(;;){if(f.lookahead===0&&($S(f),f.lookahead===0)){if(m===$p)return 1;break}if(f.match_length=0,E=pc(f,0,f.window[f.strstart]),f.lookahead--,f.strstart++,E&&(Is(f,!1),f.strm.avail_out===0))return 1}return f.insert=0,m===Nl?(Is(f,!0),f.strm.avail_out===0?3:4):f.sym_next&&(Is(f,!1),f.strm.avail_out===0)?1:2})(r,t):r.strategy===GY?((f,m)=>{let E,y,b,A;const O=f.window;for(;;){if(f.lookahead<=dd){if($S(f),f.lookahead<=dd&&m===$p)return 1;if(f.lookahead===0)break}if(f.match_length=0,f.lookahead>=3&&f.strstart>0&&(b=f.strstart-1,y=O[b],y===O[++b]&&y===O[++b]&&y===O[++b])){A=f.strstart+dd;do;while(y===O[++b]&&y===O[++b]&&y===O[++b]&&y===O[++b]&&y===O[++b]&&y===O[++b]&&y===O[++b]&&y===O[++b]&&b<A);f.match_length=dd-(A-b),f.match_length>f.lookahead&&(f.match_length=f.lookahead)}if(f.match_length>=3?(E=pc(f,1,f.match_length-3),f.lookahead-=f.match_length,f.strstart+=f.match_length,f.match_length=0):(E=pc(f,0,f.window[f.strstart]),f.lookahead--,f.strstart++),E&&(Is(f,!1),f.strm.avail_out===0))return 1}return f.insert=0,m===Nl?(Is(f,!0),f.strm.avail_out===0?3:4):f.sym_next&&(Is(f,!1),f.strm.avail_out===0)?1:2})(r,t):rA[r.level].func(r,t);if(l!==3&&l!==4||(r.status=t0),l===1||l===3)return e.avail_out===0&&(r.last_flush=-1),mc;if(l===2&&(t===jY?UY(r):t!==NF&&(No(r,0,0,!1),t===VY&&(uu(r.head),r.lookahead===0&&(r.strstart=0,r.block_start=0,r.insert=0))),Jo(e),e.avail_out===0))return r.last_flush=-1,mc}return t!==Nl?mc:r.wrap<=0?LF:(r.wrap===2?(bi(r,255&e.adler),bi(r,e.adler>>8&255),bi(r,e.adler>>16&255),bi(r,e.adler>>24&255),bi(r,255&e.total_in),bi(r,e.total_in>>8&255),bi(r,e.total_in>>16&255),bi(r,e.total_in>>24&255)):(nA(r,e.adler>>>16),nA(r,65535&e.adler)),Jo(e),r.wrap>0&&(r.wrap=-r.wrap),r.pending!==0?mc:LF)},HY=(e,t)=>{let r=t.length;if(F1(e))return em;const s=e.state,l=s.wrap;if(l===2||l===1&&s.status!==qo||s.lookahead)return em;if(l===1&&(e.adler=eA(e.adler,t,r,0)),s.wrap=0,r>=s.w_size){l===0&&(uu(s.head),s.strstart=0,s.block_start=0,s.insert=0);let y=new Uint8Array(s.w_size);y.set(t.subarray(r-s.w_size,r),0),t=y,r=s.w_size}const f=e.avail_in,m=e.next_in,E=e.input;for(e.avail_in=r,e.next_in=0,e.input=t,$S(s);s.lookahead>=3;){let y=s.strstart,b=s.lookahead-2;do s.ins_h=rm(s,s.ins_h,s.window[y+3-1]),s.prev[y&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=y,y++;while(--b);s.strstart=y,s.lookahead=2,$S(s)}return s.strstart+=s.lookahead,s.block_start=s.strstart,s.insert=s.lookahead,s.lookahead=0,s.match_length=s.prev_length=2,s.match_available=0,e.next_in=m,e.input=E,e.avail_in=f,s.wrap=l,mc},iA={deflateInit:(e,t)=>lj(e,t,nm,15,8,tm),deflateInit2:lj,deflateReset:z1,deflateResetKeep:G1,deflateSetHeader:(e,t)=>F1(e)||e.state.wrap!==2?em:(e.state.gzhead=t,mc),deflate:MF,deflateEnd:e=>{if(F1(e))return em;const t=e.state.status;return e.state=null,t===si?n0(e,MD):mc},deflateSetDictionary:HY,deflateInfo:"pako deflate (from Nodeca project)"};const WY=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var UD={assign:function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const r=t.shift();if(r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(const s in r)WY(r,s)&&(e[s]=r[s])}}return e},flattenChunks:e=>{let t=0;for(let s=0,l=e.length;s<l;s++)t+=e[s].length;const r=new Uint8Array(t);for(let s=0,l=0,f=e.length;s<f;s++){let m=e[s];r.set(m,l),l+=m.length}return r}};let aA=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{aA=!1}const sA=new Uint8Array(256);for(let e=0;e<256;e++)sA[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;sA[254]=sA[254]=1;var oA={string2buf:e=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(e);let t,r,s,l,f,m=e.length,E=0;for(l=0;l<m;l++)r=e.charCodeAt(l),(64512&r)==55296&&l+1<m&&(s=e.charCodeAt(l+1),(64512&s)==56320&&(r=65536+(r-55296<<10)+(s-56320),l++)),E+=r<128?1:r<2048?2:r<65536?3:4;for(t=new Uint8Array(E),f=0,l=0;f<E;l++)r=e.charCodeAt(l),(64512&r)==55296&&l+1<m&&(s=e.charCodeAt(l+1),(64512&s)==56320&&(r=65536+(r-55296<<10)+(s-56320),l++)),r<128?t[f++]=r:r<2048?(t[f++]=192|r>>>6,t[f++]=128|63&r):r<65536?(t[f++]=224|r>>>12,t[f++]=128|r>>>6&63,t[f++]=128|63&r):(t[f++]=240|r>>>18,t[f++]=128|r>>>12&63,t[f++]=128|r>>>6&63,t[f++]=128|63&r);return t},buf2string:(e,t)=>{const r=t||e.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(e.subarray(0,t));let s,l;const f=new Array(2*r);for(l=0,s=0;s<r;){let m=e[s++];if(m<128){f[l++]=m;continue}let E=sA[m];if(E>4)f[l++]=65533,s+=E-1;else{for(m&=E===2?31:E===3?15:7;E>1&&s<r;)m=m<<6|63&e[s++],E--;E>1?f[l++]=65533:m<65536?f[l++]=m:(m-=65536,f[l++]=55296|m>>10&1023,f[l++]=56320|1023&m)}}return((m,E)=>{if(E<65534&&m.subarray&&aA)return String.fromCharCode.apply(null,m.length===E?m:m.subarray(0,E));let y="";for(let b=0;b<E;b++)y+=String.fromCharCode(m[b]);return y})(f,l)},utf8border:(e,t)=>{(t=t||e.length)>e.length&&(t=e.length);let r=t-1;for(;r>=0&&(192&e[r])==128;)r--;return r<0||r===0?t:r+sA[e[r]]>t?r:t}},kF=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const xF=Object.prototype.toString,{Z_NO_FLUSH:jD,Z_SYNC_FLUSH:YY,Z_FULL_FLUSH:KY,Z_FINISH:VD,Z_OK:BD,Z_STREAM_END:FD,Z_DEFAULT_COMPRESSION:qY,Z_DEFAULT_STRATEGY:JY,Z_DEFLATED:XY}=Ol;function GD(e){this.options=UD.assign({level:qY,method:XY,chunkSize:16384,windowBits:15,memLevel:8,strategy:JY},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new kF,this.strm.avail_out=0;let r=iA.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(r!==BD)throw new Error(qS[r]);if(t.header&&iA.deflateSetHeader(this.strm,t.header),t.dictionary){let s;if(s=typeof t.dictionary=="string"?oA.string2buf(t.dictionary):xF.call(t.dictionary)==="[object ArrayBuffer]"?new Uint8Array(t.dictionary):t.dictionary,r=iA.deflateSetDictionary(this.strm,s),r!==BD)throw new Error(qS[r]);this._dict_set=!0}}function cA(e,t){const r=new GD(t);if(r.push(e,!0),r.err)throw r.msg||qS[r.err];return r.result}GD.prototype.push=function(e,t){const r=this.strm,s=this.options.chunkSize;let l,f;if(this.ended)return!1;for(f=t===~~t?t:t===!0?VD:jD,typeof e=="string"?r.input=oA.string2buf(e):xF.call(e)==="[object ArrayBuffer]"?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;)if(r.avail_out===0&&(r.output=new Uint8Array(s),r.next_out=0,r.avail_out=s),(f===YY||f===KY)&&r.avail_out<=6)this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;else{if(l=iA.deflate(r,f),l===FD)return r.next_out>0&&this.onData(r.output.subarray(0,r.next_out)),l=iA.deflateEnd(this.strm),this.onEnd(l),this.ended=!0,l===BD;if(r.avail_out!==0){if(f>0&&r.next_out>0)this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;else if(r.avail_in===0)break}else this.onData(r.output)}return!0},GD.prototype.onData=function(e){this.chunks.push(e)},GD.prototype.onEnd=function(e){e===BD&&(this.result=UD.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var UF={deflate:cA};const zD=16209;var HD=function(e,t){let r,s,l,f,m,E,y,b,A,O,D,P,F,B,Y,$,ee,Ee,Re,Ie,we,Ue,ve,Ne;const Ve=e.state;r=e.next_in,ve=e.input,s=r+(e.avail_in-5),l=e.next_out,Ne=e.output,f=l-(t-e.avail_out),m=l+(e.avail_out-257),E=Ve.dmax,y=Ve.wsize,b=Ve.whave,A=Ve.wnext,O=Ve.window,D=Ve.hold,P=Ve.bits,F=Ve.lencode,B=Ve.distcode,Y=(1<<Ve.lenbits)-1,$=(1<<Ve.distbits)-1;e:do{P<15&&(D+=ve[r++]<<P,P+=8,D+=ve[r++]<<P,P+=8),ee=F[D&Y];t:for(;;){if(Ee=ee>>>24,D>>>=Ee,P-=Ee,Ee=ee>>>16&255,Ee===0)Ne[l++]=65535&ee;else{if(!(16&Ee)){if((64&Ee)==0){ee=F[(65535&ee)+(D&(1<<Ee)-1)];continue t}if(32&Ee){Ve.mode=16191;break e}e.msg="invalid literal/length code",Ve.mode=zD;break e}Re=65535&ee,Ee&=15,Ee&&(P<Ee&&(D+=ve[r++]<<P,P+=8),Re+=D&(1<<Ee)-1,D>>>=Ee,P-=Ee),P<15&&(D+=ve[r++]<<P,P+=8,D+=ve[r++]<<P,P+=8),ee=B[D&$];n:for(;;){if(Ee=ee>>>24,D>>>=Ee,P-=Ee,Ee=ee>>>16&255,!(16&Ee)){if((64&Ee)==0){ee=B[(65535&ee)+(D&(1<<Ee)-1)];continue n}e.msg="invalid distance code",Ve.mode=zD;break e}if(Ie=65535&ee,Ee&=15,P<Ee&&(D+=ve[r++]<<P,P+=8,P<Ee&&(D+=ve[r++]<<P,P+=8)),Ie+=D&(1<<Ee)-1,Ie>E){e.msg="invalid distance too far back",Ve.mode=zD;break e}if(D>>>=Ee,P-=Ee,Ee=l-f,Ie>Ee){if(Ee=Ie-Ee,Ee>b&&Ve.sane){e.msg="invalid distance too far back",Ve.mode=zD;break e}if(we=0,Ue=O,A===0){if(we+=y-Ee,Ee<Re){Re-=Ee;do Ne[l++]=O[we++];while(--Ee);we=l-Ie,Ue=Ne}}else if(A<Ee){if(we+=y+A-Ee,Ee-=A,Ee<Re){Re-=Ee;do Ne[l++]=O[we++];while(--Ee);if(we=0,A<Re){Ee=A,Re-=Ee;do Ne[l++]=O[we++];while(--Ee);we=l-Ie,Ue=Ne}}}else if(we+=A-Ee,Ee<Re){Re-=Ee;do Ne[l++]=O[we++];while(--Ee);we=l-Ie,Ue=Ne}for(;Re>2;)Ne[l++]=Ue[we++],Ne[l++]=Ue[we++],Ne[l++]=Ue[we++],Re-=3;Re&&(Ne[l++]=Ue[we++],Re>1&&(Ne[l++]=Ue[we++]))}else{we=l-Ie;do Ne[l++]=Ne[we++],Ne[l++]=Ne[we++],Ne[l++]=Ne[we++],Re-=3;while(Re>2);Re&&(Ne[l++]=Ne[we++],Re>1&&(Ne[l++]=Ne[we++]))}break}}break}}while(r<s&&l<m);Re=P>>3,r-=Re,P-=Re<<3,D&=(1<<P)-1,e.next_in=r,e.next_out=l,e.avail_in=r<s?s-r+5:5-(r-s),e.avail_out=l<m?m-l+257:257-(l-m),Ve.hold=D,Ve.bits=P};const im=15,QY=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),ZY=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),pf=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),jF=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var H1=(e,t,r,s,l,f,m,E)=>{const y=E.bits;let b,A,O,D,P,F,B=0,Y=0,$=0,ee=0,Ee=0,Re=0,Ie=0,we=0,Ue=0,ve=0,Ne=null;const Ve=new Uint16Array(16),Be=new Uint16Array(16);let W,ce,Se,Xe=null;for(B=0;B<=im;B++)Ve[B]=0;for(Y=0;Y<s;Y++)Ve[t[r+Y]]++;for(Ee=y,ee=im;ee>=1&&Ve[ee]===0;ee--);if(Ee>ee&&(Ee=ee),ee===0)return l[f++]=20971520,l[f++]=20971520,E.bits=1,0;for($=1;$<ee&&Ve[$]===0;$++);for(Ee<$&&(Ee=$),we=1,B=1;B<=im;B++)if(we<<=1,we-=Ve[B],we<0)return-1;if(we>0&&(e===0||ee!==1))return-1;for(Be[1]=0,B=1;B<im;B++)Be[B+1]=Be[B]+Ve[B];for(Y=0;Y<s;Y++)t[r+Y]!==0&&(m[Be[t[r+Y]]++]=Y);if(e===0?(Ne=Xe=m,F=20):e===1?(Ne=QY,Xe=ZY,F=257):(Ne=pf,Xe=jF,F=0),ve=0,Y=0,B=$,P=f,Re=Ee,Ie=0,O=-1,Ue=1<<Ee,D=Ue-1,e===1&&Ue>852||e===2&&Ue>592)return 1;for(;;){W=B-Ie,m[Y]+1<F?(ce=0,Se=m[Y]):m[Y]>=F?(ce=Xe[m[Y]-F],Se=Ne[m[Y]-F]):(ce=96,Se=0),b=1<<B-Ie,A=1<<Re,$=A;do A-=b,l[P+(ve>>Ie)+A]=W<<24|ce<<16|Se|0;while(A!==0);for(b=1<<B-1;ve&b;)b>>=1;if(b!==0?(ve&=b-1,ve+=b):ve=0,Y++,--Ve[B]==0){if(B===ee)break;B=t[r+m[Y]]}if(B>Ee&&(ve&D)!==O){for(Ie===0&&(Ie=Ee),P+=$,Re=B-Ie,we=1<<Re;Re+Ie<ee&&(we-=Ve[Re+Ie],!(we<=0));)Re++,we<<=1;if(Ue+=1<<Re,e===1&&Ue>852||e===2&&Ue>592)return 1;O=ve&D,l[O]=Ee<<24|Re<<16|P-f|0}}return ve!==0&&(l[P+ve]=B-Ie<<24|64<<16|0),E.bits=Ee,0};const{Z_FINISH:VF,Z_BLOCK:BF,Z_TREES:ey,Z_OK:am,Z_STREAM_END:r0,Z_NEED_DICT:dj,Z_STREAM_ERROR:fd,Z_DATA_ERROR:lA,Z_MEM_ERROR:dA,Z_BUF_ERROR:uj,Z_DEFLATED:Ya}=Ol,uA=16180,WD=16190,Ll=16191,YD=16192,KD=16194,fA=16199,hA=16200,pA=16206,Va=16209,fj=e=>(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24);function $Y(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const iE=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<uA||t.mode>16211?1:0},FF=e=>{if(iE(e))return fd;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=uA,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(852),t.distcode=t.distdyn=new Int32Array(592),t.sane=1,t.back=-1,am},sm=e=>{if(iE(e))return fd;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,FF(e)},GF=(e,t)=>{let r;if(iE(e))return fd;const s=e.state;return t<0?(r=0,t=-t):(r=5+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?fd:(s.window!==null&&s.wbits!==t&&(s.window=null),s.wrap=r,s.wbits=t,sm(e))},hj=(e,t)=>{if(!e)return fd;const r=new $Y;e.state=r,r.strm=e,r.window=null,r.mode=uA;const s=GF(e,t);return s!==am&&(e.state=null),s};let pj,mj,W1=!0;const gj=e=>{if(W1){pj=new Int32Array(512),mj=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(H1(1,e.lens,0,288,pj,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;H1(2,e.lens,0,32,mj,0,e.work,{bits:5}),W1=!1}e.lencode=pj,e.lenbits=9,e.distcode=mj,e.distbits=5},qD=(e,t,r,s)=>{let l;const f=e.state;return f.window===null&&(f.wsize=1<<f.wbits,f.wnext=0,f.whave=0,f.window=new Uint8Array(f.wsize)),s>=f.wsize?(f.window.set(t.subarray(r-f.wsize,r),0),f.wnext=0,f.whave=f.wsize):(l=f.wsize-f.wnext,l>s&&(l=s),f.window.set(t.subarray(r-s,r-s+l),f.wnext),(s-=l)?(f.window.set(t.subarray(r-s,r),0),f.wnext=s,f.whave=f.wsize):(f.wnext+=l,f.wnext===f.wsize&&(f.wnext=0),f.whave<f.wsize&&(f.whave+=l))),0};var eK=(e,t)=>{let r,s,l,f,m,E,y,b,A,O,D,P,F,B,Y,$,ee,Ee,Re,Ie,we,Ue,ve=0;const Ne=new Uint8Array(4);let Ve,Be;const W=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(iE(e)||!e.output||!e.input&&e.avail_in!==0)return fd;r=e.state,r.mode===Ll&&(r.mode=YD),m=e.next_out,l=e.output,y=e.avail_out,f=e.next_in,s=e.input,E=e.avail_in,b=r.hold,A=r.bits,O=E,D=y,Ue=am;e:for(;;)switch(r.mode){case uA:if(r.wrap===0){r.mode=YD;break}for(;A<16;){if(E===0)break e;E--,b+=s[f++]<<A,A+=8}if(2&r.wrap&&b===35615){r.wbits===0&&(r.wbits=15),r.check=0,Ne[0]=255&b,Ne[1]=b>>>8&255,r.check=Ko(r.check,Ne,2,0),b=0,A=0,r.mode=16181;break}if(r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&b)<<8)+(b>>8))%31){e.msg="incorrect header check",r.mode=Va;break}if((15&b)!==Ya){e.msg="unknown compression method",r.mode=Va;break}if(b>>>=4,A-=4,we=8+(15&b),r.wbits===0&&(r.wbits=we),we>15||we>r.wbits){e.msg="invalid window size",r.mode=Va;break}r.dmax=1<<r.wbits,r.flags=0,e.adler=r.check=1,r.mode=512&b?16189:Ll,b=0,A=0;break;case 16181:for(;A<16;){if(E===0)break e;E--,b+=s[f++]<<A,A+=8}if(r.flags=b,(255&oo(r))!==Ya){e.msg="unknown compression method",r.mode=Va;break}if(57344&oo(r)){e.msg="unknown header flags set",r.mode=Va;break}r.head&&(r.head.text=b>>8&1),512&oo(r)&&4&r.wrap&&(Ne[0]=255&b,Ne[1]=b>>>8&255,r.check=Ko(r.check,Ne,2,0)),b=0,A=0,r.mode=16182;case 16182:for(;A<32;){if(E===0)break e;E--,b+=s[f++]<<A,A+=8}r.head&&(r.head.time=b),512&oo(r)&&4&r.wrap&&(Ne[0]=255&b,Ne[1]=b>>>8&255,Ne[2]=b>>>16&255,Ne[3]=b>>>24&255,r.check=Ko(r.check,Ne,4,0)),b=0,A=0,r.mode=16183;case 16183:for(;A<16;){if(E===0)break e;E--,b+=s[f++]<<A,A+=8}r.head&&(r.head.xflags=255&b,r.head.os=b>>8),512&oo(r)&&4&r.wrap&&(Ne[0]=255&b,Ne[1]=b>>>8&255,r.check=Ko(r.check,Ne,2,0)),b=0,A=0,r.mode=16184;case 16184:if(1024&oo(r)){for(;A<16;){if(E===0)break e;E--,b+=s[f++]<<A,A+=8}r.length=b,r.head&&(r.head.extra_len=b),512&oo(r)&&4&r.wrap&&(Ne[0]=255&b,Ne[1]=b>>>8&255,r.check=Ko(r.check,Ne,2,0)),b=0,A=0}else r.head&&(r.head.extra=null);r.mode=16185;case 16185:if(1024&oo(r)&&(P=r.length,P>E&&(P=E),P&&(r.head&&(we=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(s.subarray(f,f+P),we)),512&oo(r)&&4&r.wrap&&(r.check=Ko(r.check,s,P,f)),E-=P,f+=P,r.length-=P),r.length))break e;r.length=0,r.mode=16186;case 16186:if(2048&oo(r)){if(E===0)break e;P=0;do we=s[f+P++],r.head&&we&&r.length<65536&&(r.head.name+=String.fromCharCode(we));while(we&&P<E);if(512&oo(r)&&4&r.wrap&&(r.check=Ko(r.check,s,P,f)),E-=P,f+=P,we)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=16187;case 16187:if(4096&oo(r)){if(E===0)break e;P=0;do we=s[f+P++],r.head&&we&&r.length<65536&&(r.head.comment+=String.fromCharCode(we));while(we&&P<E);if(512&oo(r)&&4&r.wrap&&(r.check=Ko(r.check,s,P,f)),E-=P,f+=P,we)break e}else r.head&&(r.head.comment=null);r.mode=16188;case 16188:if(512&oo(r)){for(;A<16;){if(E===0)break e;E--,b+=s[f++]<<A,A+=8}if(4&r.wrap&&b!==(65535&r.check)){e.msg="header crc mismatch",r.mode=Va;break}b=0,A=0}r.head&&(r.head.hcrc=oo(r)>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=Ll;break;case 16189:for(;A<32;){if(E===0)break e;E--,b+=s[f++]<<A,A+=8}e.adler=r.check=fj(b),b=0,A=0,r.mode=WD;case WD:if(r.havedict===0)return e.next_out=m,e.avail_out=y,e.next_in=f,e.avail_in=E,r.hold=b,r.bits=A,dj;e.adler=r.check=1,r.mode=Ll;case Ll:if(t===BF||t===ey)break e;case YD:if(r.last){b>>>=7&A,A-=7&A,r.mode=pA;break}for(;A<3;){if(E===0)break e;E--,b+=s[f++]<<A,A+=8}switch(r.last=1&b,b>>>=1,A-=1,3&b){case 0:r.mode=16193;break;case 1:if(gj(r),r.mode=fA,t===ey){b>>>=2,A-=2;break e}break;case 2:r.mode=16196;break;case 3:e.msg="invalid block type",r.mode=Va}b>>>=2,A-=2;break;case 16193:for(b>>>=7&A,A-=7&A;A<32;){if(E===0)break e;E--,b+=s[f++]<<A,A+=8}if((65535&b)!=(b>>>16^65535)){e.msg="invalid stored block lengths",r.mode=Va;break}if(r.length=65535&b,b=0,A=0,r.mode=KD,t===ey)break e;case KD:r.mode=16195;case 16195:if(P=r.length,P){if(P>E&&(P=E),P>y&&(P=y),P===0)break e;l.set(s.subarray(f,f+P),m),E-=P,f+=P,y-=P,m+=P,r.length-=P;break}r.mode=Ll;break;case 16196:for(;A<14;){if(E===0)break e;E--,b+=s[f++]<<A,A+=8}if(r.nlen=257+(31&b),b>>>=5,A-=5,r.ndist=1+(31&b),b>>>=5,A-=5,r.ncode=4+(15&b),b>>>=4,A-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=Va;break}r.have=0,r.mode=16197;case 16197:for(;r.have<r.ncode;){for(;A<3;){if(E===0)break e;E--,b+=s[f++]<<A,A+=8}r.lens[W[r.have++]]=7&b,b>>>=3,A-=3}for(;r.have<19;)r.lens[W[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,Ve={bits:r.lenbits},Ue=H1(0,r.lens,0,19,r.lencode,0,r.work,Ve),r.lenbits=Ve.bits,Ue){e.msg="invalid code lengths set",r.mode=Va;break}r.have=0,r.mode=16198;case 16198:for(;r.have<r.nlen+r.ndist;){for(;ve=r.lencode[b&(1<<r.lenbits)-1],Y=ve>>>24,$=ve>>>16&255,ee=65535&ve,!(Y<=A);){if(E===0)break e;E--,b+=s[f++]<<A,A+=8}if(ee<16)b>>>=Y,A-=Y,r.lens[r.have++]=ee;else{if(ee===16){for(Be=Y+2;A<Be;){if(E===0)break e;E--,b+=s[f++]<<A,A+=8}if(b>>>=Y,A-=Y,r.have===0){e.msg="invalid bit length repeat",r.mode=Va;break}we=r.lens[r.have-1],P=3+(3&b),b>>>=2,A-=2}else if(ee===17){for(Be=Y+3;A<Be;){if(E===0)break e;E--,b+=s[f++]<<A,A+=8}b>>>=Y,A-=Y,we=0,P=3+(7&b),b>>>=3,A-=3}else{for(Be=Y+7;A<Be;){if(E===0)break e;E--,b+=s[f++]<<A,A+=8}b>>>=Y,A-=Y,we=0,P=11+(127&b),b>>>=7,A-=7}if(r.have+P>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=Va;break}for(;P--;)r.lens[r.have++]=we}}if(r.mode===Va)break;if(r.lens[256]===0){e.msg="invalid code -- missing end-of-block",r.mode=Va;break}if(r.lenbits=9,Ve={bits:r.lenbits},Ue=H1(1,r.lens,0,r.nlen,r.lencode,0,r.work,Ve),r.lenbits=Ve.bits,Ue){e.msg="invalid literal/lengths set",r.mode=Va;break}if(r.distbits=6,r.distcode=r.distdyn,Ve={bits:r.distbits},Ue=H1(2,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,Ve),r.distbits=Ve.bits,Ue){e.msg="invalid distances set",r.mode=Va;break}if(r.mode=fA,t===ey)break e;case fA:r.mode=hA;case hA:if(E>=6&&y>=258){e.next_out=m,e.avail_out=y,e.next_in=f,e.avail_in=E,r.hold=b,r.bits=A,HD(e,D),m=e.next_out,l=e.output,y=e.avail_out,f=e.next_in,s=e.input,E=e.avail_in,b=r.hold,A=r.bits,r.mode===Ll&&(r.back=-1);break}for(r.back=0;ve=r.lencode[b&(1<<r.lenbits)-1],Y=ve>>>24,$=ve>>>16&255,ee=65535&ve,!(Y<=A);){if(E===0)break e;E--,b+=s[f++]<<A,A+=8}if($&&(240&$)==0){for(Ee=Y,Re=$,Ie=ee;ve=r.lencode[Ie+((b&(1<<Ee+Re)-1)>>Ee)],Y=ve>>>24,$=ve>>>16&255,ee=65535&ve,!(Ee+Y<=A);){if(E===0)break e;E--,b+=s[f++]<<A,A+=8}b>>>=Ee,A-=Ee,r.back+=Ee}if(b>>>=Y,A-=Y,r.back+=Y,r.length=ee,$===0){r.mode=16205;break}if(32&$){r.back=-1,r.mode=Ll;break}if(64&$){e.msg="invalid literal/length code",r.mode=Va;break}r.extra=15&$,r.mode=16201;case 16201:if(r.extra){for(Be=r.extra;A<Be;){if(E===0)break e;E--,b+=s[f++]<<A,A+=8}r.length+=b&(1<<r.extra)-1,b>>>=r.extra,A-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=16202;case 16202:for(;ve=r.distcode[b&(1<<r.distbits)-1],Y=ve>>>24,$=ve>>>16&255,ee=65535&ve,!(Y<=A);){if(E===0)break e;E--,b+=s[f++]<<A,A+=8}if((240&$)==0){for(Ee=Y,Re=$,Ie=ee;ve=r.distcode[Ie+((b&(1<<Ee+Re)-1)>>Ee)],Y=ve>>>24,$=ve>>>16&255,ee=65535&ve,!(Ee+Y<=A);){if(E===0)break e;E--,b+=s[f++]<<A,A+=8}b>>>=Ee,A-=Ee,r.back+=Ee}if(b>>>=Y,A-=Y,r.back+=Y,64&$){e.msg="invalid distance code",r.mode=Va;break}r.offset=ee,r.extra=15&$,r.mode=16203;case 16203:if(r.extra){for(Be=r.extra;A<Be;){if(E===0)break e;E--,b+=s[f++]<<A,A+=8}r.offset+=b&(1<<r.extra)-1,b>>>=r.extra,A-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=Va;break}r.mode=16204;case 16204:if(y===0)break e;if(P=D-y,r.offset>P){if(P=r.offset-P,P>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=Va;break}P>r.wnext?(P-=r.wnext,F=r.wsize-P):F=r.wnext-P,P>r.length&&(P=r.length),B=r.window}else B=l,F=m-r.offset,P=r.length;P>y&&(P=y),y-=P,r.length-=P;do l[m++]=B[F++];while(--P);r.length===0&&(r.mode=hA);break;case 16205:if(y===0)break e;l[m++]=r.length,y--,r.mode=hA;break;case pA:if(r.wrap){for(;A<32;){if(E===0)break e;E--,b|=s[f++]<<A,A+=8}if(D-=y,e.total_out+=D,r.total+=D,4&r.wrap&&D&&(e.adler=r.check=oo(r)?Ko(r.check,l,D,m-D):eA(r.check,l,D,m-D)),D=y,4&r.wrap&&(oo(r)?b:fj(b))!==r.check){e.msg="incorrect data check",r.mode=Va;break}b=0,A=0}r.mode=16207;case 16207:if(r.wrap&&oo(r)){for(;A<32;){if(E===0)break e;E--,b+=s[f++]<<A,A+=8}if(4&r.wrap&&b!==(4294967295&r.total)){e.msg="incorrect length check",r.mode=Va;break}b=0,A=0}r.mode=16208;case 16208:Ue=r0;break e;case Va:Ue=lA;break e;case 16210:return dA;default:return fd}return e.next_out=m,e.avail_out=y,e.next_in=f,e.avail_in=E,r.hold=b,r.bits=A,(r.wsize||D!==e.avail_out&&r.mode<Va&&(r.mode<pA||t!==VF))&&qD(e,e.output,e.next_out,D-e.avail_out),O-=e.avail_in,D-=e.avail_out,e.total_in+=O,e.total_out+=D,r.total+=D,4&r.wrap&&D&&(e.adler=r.check=oo(r)?Ko(r.check,l,D,e.next_out-D):eA(r.check,l,D,e.next_out-D)),e.data_type=r.bits+(r.last?64:0)+(r.mode===Ll?128:0)+(r.mode===fA||r.mode===KD?256:0),(O===0&&D===0||t===VF)&&Ue===am&&(Ue=uj),Ue},om={inflateReset:sm,inflateReset2:GF,inflateResetKeep:FF,inflateInit:e=>hj(e,15),inflateInit2:hj,inflate:eK,inflateEnd:e=>{if(iE(e))return fd;let t=e.state;return t.window&&(t.window=null),e.state=null,am},inflateGetHeader:(e,t)=>{if(iE(e))return fd;const r=e.state;return(2&r.wrap)==0?fd:(r.head=t,t.done=!1,am)},inflateSetDictionary:(e,t)=>{const r=t.length;let s,l,f;return iE(e)?fd:(s=e.state,s.wrap!==0&&s.mode!==WD?fd:s.mode===WD&&(l=1,l=eA(l,t,r,0),l!==s.check)?lA:(f=qD(e,t,r,r),f?(s.mode=16210,dA):(s.havedict=1,am)))},inflateInfo:"pako inflate (from Nodeca project)"},tK=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const mA=Object.prototype.toString,{Z_NO_FLUSH:nK,Z_FINISH:rK,Z_OK:gA,Z_STREAM_END:_j,Z_NEED_DICT:Ej,Z_STREAM_ERROR:iK,Z_DATA_ERROR:vj,Z_MEM_ERROR:aK}=Ol;function JD(e){this.options=UD.assign({chunkSize:65536,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(15&t.windowBits)==0&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new kF,this.strm.avail_out=0;let r=om.inflateInit2(this.strm,t.windowBits);if(r!==gA)throw new Error(qS[r]);if(this.header=new tK,om.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=oA.string2buf(t.dictionary):mA.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(r=om.inflateSetDictionary(this.strm,t.dictionary),r!==gA)))throw new Error(qS[r])}function sK(e,t){const r=new JD(t);if(r.push(e),r.err)throw r.msg||qS[r.err];return r.result}JD.prototype.push=function(e,t){const r=this.strm,s=this.options.chunkSize,l=this.options.dictionary;let f,m,E;if(this.ended)return!1;for(m=t===~~t?t:t===!0?rK:nK,mA.call(e)==="[object ArrayBuffer]"?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;){for(r.avail_out===0&&(r.output=new Uint8Array(s),r.next_out=0,r.avail_out=s),f=om.inflate(r,m),f===Ej&&l&&(f=om.inflateSetDictionary(r,l),f===gA?f=om.inflate(r,m):f===vj&&(f=Ej));r.avail_in>0&&f===_j&&r.state.wrap>0&&e[r.next_in]!==0;)om.inflateReset(r),f=om.inflate(r,m);switch(f){case iK:case vj:case Ej:case aK:return this.onEnd(f),this.ended=!0,!1}if(E=r.avail_out,r.next_out&&(r.avail_out===0||f===_j))if(this.options.to==="string"){let y=oA.utf8border(r.output,r.next_out),b=r.next_out-y,A=oA.buf2string(r.output,y);r.next_out=b,r.avail_out=s-b,b&&r.output.set(r.output.subarray(y,y+b),0),this.onData(A)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(f!==gA||E!==0){if(f===_j)return f=om.inflateEnd(this.strm),this.onEnd(f),this.ended=!0,!0;if(r.avail_in===0)break}}return!0},JD.prototype.onData=function(e){this.chunks.push(e)},JD.prototype.onEnd=function(e){e===gA&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=UD.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var oK={inflate:sK};const{deflate:cK}=UF,{inflate:zF}=oK;var _A=cK,lK=zF,Sj=function(e){return e[e.ONE_BYTE=0]="ONE_BYTE",e[e.TWO_BYTE=1]="TWO_BYTE",e}(Sj||{});class Xc{constructor(){ne(this,"_sequence",0),ne(this,"_startTime",Date.now()),ne(this,"isUseOneByte",!0)}get startTime(){const t=Date.now()-this._startTime;return t<Math.pow(2,16)?t:(this._startTime+=Math.pow(2,16),this.startTime)}get sequence(){return this._sequence<Math.pow(2,32)?this._sequence++:(this._sequence-=Math.pow(2,32),this.sequence)}serialize(t){const r={commonPacketHeader:{length:0,reserved:0,extension:0,sequence:this.sequence},commonStreamHeader:this.startTime,extension:void 0,payload:t};if(t.byteLength>128){const E=new Uint8Array(4);E.set([1,0,0,0]);const y={id:0,length:4,data:E.buffer},b={profile:this.isUseOneByte?0:1,length:this.isUseOneByte?5:6,datas:[y]};r.commonPacketHeader.extension=1,r.extension=b,r.payload=this.compress(t),r.commonPacketHeader.length=8+(r.extension.length+2)+r.payload.byteLength}else r.commonPacketHeader.length=8+r.payload.byteLength;me("SHOW_DATASTREAM2_LOG")&&G.debug("send data header: ".concat(JSON.stringify(r.commonPacketHeader)));const s=new ArrayBuffer(r.commonPacketHeader.length),l=new Uint8Array(s),f=new DataView(s);let m=0;if(f.setUint16(m,r.commonPacketHeader.extension<<15|r.commonPacketHeader.reserved<<14|r.commonPacketHeader.length,!0),m+=2,f.setUint32(m,r.commonPacketHeader.sequence,!0),m+=4,f.setUint16(m,r.commonStreamHeader,!0),m+=2,r.extension){const E=this.serializeExtension(r.extension);l.set(new Uint8Array(E),m),m+=E.byteLength}if(l.set(new Uint8Array(r.payload),m),m+=r.payload.byteLength,m!==r.commonPacketHeader.length)throw Error("serialize error!");return s}deserialize(t){if(t.byteLength<4)return new ArrayBuffer(0);const r=new DataView(t);let s=0;const l=r.getUint16(s,!0);s+=2;const f={length:16383&l,reserved:(16384&l)>>14,extension:(32768&l)>>15,sequence:r.getUint16(s+2,!0)<<16|r.getUint16(s,!0)};let m,E;if(s+=4,me("SHOW_DATASTREAM2_LOG")&&G.debug("receive data header: ".concat(JSON.stringify(f))),r.getUint16(s,!0),s+=2,f.extension){E=this.deserializeExtension(t.slice(s)),s+=2+E.length,m=t.slice(s);let y=!1;if(E.datas.length>0){const b=E.datas.find(A=>A.id===0);b&&(y=(1&new DataView(b.data).getUint32(0,!0))==1)}m=y?this.decompress(m):m}else m=t.slice(8);return m}serializeExtension(t){const{profile:r,length:s,datas:l}=t,f=new ArrayBuffer(s+2),m=new Uint8Array(f),E=new DataView(f);let y=0;if(E.setUint8(y++,r),E.setUint8(y++,s),l.forEach(b=>{r?(E.setUint8(y++,b.id),E.setUint8(y++,b.length),m.set(new Uint8Array(b.data),y),y+=b.data.byteLength):(E.setUint8(y++,b.id|b.length<<4),m.set(new Uint8Array(b.data),y),y+=b.data.byteLength)}),y!==s+2)throw Error("serialize extension error, is ".concat(y,"!==").concat(s+2));return f}deserializeExtension(t){const r=new DataView(t);let s=0;const l=r.getUint8(s);s++;const f=r.getUint8(s);s++;const m=l===Sj.TWO_BYTE,E=[],y=new DataView(t,2);let b=0;for(;b<f;){let A=0,O=0,D=new ArrayBuffer(0);m?(A=y.getUint8(b),b++,O=y.getUint8(b),b++):(A=15&y.getUint8(b),O=y.getUint8(b)>>4,b++),O>0&&(D=y.buffer.slice(b+2,b+2+O),b+=D.byteLength),E.push({id:A,length:O,data:D})}if(b!==f)throw Error("parse error");return{profile:l,length:f,datas:E}}decompress(t){return lK(new Uint8Array(t))}compress(t){return _A(new Uint8Array(t))}}const dK={name:"DataStream",create:(e,t)=>{const r=t?new sU(e):new N8(e);return r.useDataStream(new Xc),r}};class uK extends Xt{constructor(t,r,s){super(),ne(this,"ws",void 0),ne(this,"requestId",1),ne(this,"heartBeatTimer",void 0),ne(this,"joinInfo",void 0),ne(this,"clientId",void 0),ne(this,"onOpen",()=>{this.emit("open"),this.startHeartBeatCheck()}),ne(this,"onClose",l=>{this.emit("close"),this.dispose()}),ne(this,"onMessage",l=>{const f=JSON.parse(l.data);if(!f||f.command!=="serverResponse"||!f.requestId)return f&&f.command==="serverStatus"&&f.serverStatus&&f.serverStatus.command?(this.emit("status",f.serverStatus),void this.emit(f.serverStatus.command,f.serverStatus)):void 0;this.emit("req_".concat(f.requestId),f)}),this.joinInfo=t,this.clientId=r,this.ws=new G_("cross-channel-".concat(this.clientId),s),this.ws.on(hn.RECONNECTING,()=>{this.ws.reconnectMode="retry",this.emit("reconnecting")}),this.ws.on(hn.CONNECTED,this.onOpen),this.ws.on(hn.ON_MESSAGE,this.onMessage),this.ws.on(hn.CLOSED,this.onClose)}isConnect(){return this.ws.state==="connected"}sendMessage(t){const r=this.requestId++;return t.requestId=r,t.seq=r,this.ws.sendMessage(t),r}waitStatus(t){return new gt((r,s)=>{const l=window.setTimeout(()=>{s(new xe(se.TIMEOUT,"wait status timeout, status: ".concat(t)))},5e3);this.once(t,f=>{window.clearTimeout(l),f.state&&f.state!==0?s(new xe(se.CROSS_CHANNEL_WAIT_STATUS_ERROR,"wait status error, status: ".concat(t))):r(void 0)}),this.once("dispose",()=>{window.clearTimeout(l),s(new xe(se.WS_ABORT))})})}async request(t){if(this.ws.state==="closed")throw new xe(se.WS_DISCONNECT);const r=()=>new gt((m,E)=>{this.ws.once(hn.CLOSED,()=>E(new xe(se.WS_ABORT))),this.ws.once(hn.CONNECTED,m)});this.ws.state!=="connected"&&await r();const s=this.sendMessage(t),l=new gt((m,E)=>{const y=()=>{E(new xe(se.WS_ABORT))};this.ws.once(hn.RECONNECTING,y),this.ws.once(hn.CLOSED,y),this.once("req_".concat(s),m),fs(3e3).then(()=>{this.removeAllListeners("req_".concat(s)),this.ws.off(hn.RECONNECTING,y),this.ws.off(hn.CLOSED,y),E(new xe(se.TIMEOUT,"cross channel ws request timeout"))})}),f=await l;if(!f||f.code!==200)throw new xe(se.CROSS_CHANNEL_SERVER_ERROR_RESPONSE,"response: ".concat(JSON.stringify(f)));return f}async connect(t){this.ws.removeAllListeners(hn.REQUEST_NEW_URLS),this.ws.on(hn.REQUEST_NEW_URLS,r=>{r(t)}),await this.ws.init(t)}dispose(){this.clearHeartBeatCheck(),this.emit("dispose"),this.removeAllListeners(),this.ws.close()}sendPing(t){const r=this.requestId++;return t.requestId=r,this.ws.sendMessage(t),r}startHeartBeatCheck(){this.heartBeatTimer&&window.clearInterval(this.heartBeatTimer),this.heartBeatTimer=window.setInterval(()=>{this.sendPing({command:"ping",appId:this.joinInfo.appId,cname:this.joinInfo.cname,uid:this.joinInfo.uid.toString(),sid:this.joinInfo.sid,ts:+new Date,requestId:0})},3e3)}clearHeartBeatCheck(){window.clearInterval(this.heartBeatTimer),this.heartBeatTimer=void 0}}class fK extends Xt{set state(t){t!==this._state&&(t!==hi.RELAY_STATE_FAILURE&&(this.errorCode=ad.RELAY_OK),this.emit("state",t,this.errorCode),this._state=t)}get state(){return this._state}constructor(t,r,s,l,f){super(),ne(this,"joinInfo",void 0),ne(this,"sid",void 0),ne(this,"clientId",void 0),ne(this,"cancelToken",En.CancelToken.source()),ne(this,"workerToken",void 0),ne(this,"requestId",0),ne(this,"signal",void 0),ne(this,"prevChannelMediaConfig",void 0),ne(this,"httpRetryConfig",void 0),ne(this,"_resolution",void 0),ne(this,"_state",hi.RELAY_STATE_IDLE),ne(this,"errorCode",ad.RELAY_OK),ne(this,"onStatus",m=>{G.debug("[".concat(this.clientId,"] ChannelMediaStatus: ").concat(JSON.stringify(m))),m&&m.command&&(m.command==="onAudioPacketReceived"&&this.emit("event",Tt.PACKET_RECEIVED_AUDIO_FROM_SRC),m.command==="onVideoPacketReceived"&&this.emit("event",Tt.PACKET_RECEIVED_VIDEO_FROM_SRC),m.command==="onSrcTokenPrivilegeDidExpire"&&(this.errorCode=ad.SRC_TOKEN_EXPIRED,this.state=hi.RELAY_STATE_FAILURE),m.command==="onDestTokenPrivilegeDidExpire"&&(this.errorCode=ad.DEST_TOKEN_EXPIRED,this.state=hi.RELAY_STATE_FAILURE))}),ne(this,"onReconnect",async()=>{G.debug("[".concat(this.clientId,"] ChannelMediaSocket disconnect, reconnecting")),this.emit("event",Tt.NETWORK_DISCONNECTED),this.state=hi.RELAY_STATE_IDLE,this.prevChannelMediaConfig&&this.sendStartRelayMessage(this.prevChannelMediaConfig).catch(m=>{this.state!==hi.RELAY_STATE_IDLE&&(G.error("auto restart channel media relay failed",m.toString()),this.errorCode=ad.SERVER_CONNECTION_LOST,this.state=hi.RELAY_STATE_FAILURE)})}),this.joinInfo=t,this.clientId=r,this.sid=Na(),this.signal=new uK(this.joinInfo,this.clientId,s),this.httpRetryConfig=l,this._resolution=f}async startChannelMediaRelay(t){if(this.state!==hi.RELAY_STATE_IDLE)throw new xe(se.INVALID_OPERATION);this.state=hi.RELAY_STATE_CONNECTING,await this.connect(),G.debug("[".concat(this.clientId,"] startChannelMediaRelay: connect success"));try{await this.sendStartRelayMessage(t)}catch(r){throw r.data&&r.data.serverResponse&&r.data.serverResponse.command==="SetSourceChannel"?new xe(se.CROSS_CHANNEL_FAILED_JOIN_SRC):r.data&&r.data.serverResponse&&r.serverResponse.command==="SetDestChannelStatus"?new xe(se.CROSS_CHANNEL_FAILED_JOIN_DEST):r.data&&r.data.serverResponse&&r.serverResponse.command==="StartPacketTransfer"?new xe(se.CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST):r}this.prevChannelMediaConfig=t}async updateChannelMediaRelay(t){if(this.state!==hi.RELAY_STATE_RUNNING)throw new xe(se.INVALID_OPERATION);await this.sendUpdateMessage(t),this.prevChannelMediaConfig=t}async setVideoProfile(t){if(this._resolution=t,this.state!==hi.RELAY_STATE_RUNNING)throw new xe(se.INVALID_OPERATION);const r=this.genMessage(bo.SetVideoProfile);await this.signal.request(r),G.debug("[".concat(this.clientId,"] startChannelMediaRelay: setVideoProfile success"))}async stopChannelMediaRelay(){await this.sendStopRelayMessage(),G.debug("[".concat(this.clientId,"] stopChannelMediaRelay: send stop message success")),this.state=hi.RELAY_STATE_IDLE,this.dispose()}dispose(){G.debug("[".concat(this.clientId,"] disposeChannelMediaRelay")),this.cancelToken.cancel(),this.cancelToken=En.CancelToken.source(),this.state=hi.RELAY_STATE_IDLE,this.emit("dispose"),this.signal.dispose(),this.prevChannelMediaConfig=void 0}async connect(){const t=await $8(this.joinInfo,this.cancelToken.token,this.httpRetryConfig);this.workerToken=t.workerToken,await this.signal.connect(t.addressList),this.emit("event",Tt.NETWORK_CONNECTED),this.signal.on("status",this.onStatus),this.signal.on("reconnecting",this.onReconnect)}async sendStartRelayMessage(t){const r=this.genMessage(bo.StopPacketTransfer);await this.signal.request(r),await this.signal.waitStatus("Normal Quit"),G.debug("[".concat(this.clientId,"] startChannelMediaRelay: StopPacketTransfer success"));const s=this.genMessage(bo.SetSdkProfile,t);await this.signal.request(s),G.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSdkProfile success"));const l=this.genMessage(bo.SetSourceChannel,t);await this.signal.request(l),await this.signal.waitStatus("SetSourceChannelStatus"),this.emit("event",Tt.PACKET_JOINED_SRC_CHANNEL),G.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSourceChannel success"));const f=this.genMessage(bo.SetSourceUserId,t);await this.signal.request(f),G.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSourceUserId success"));const m=this.genMessage(bo.SetDestChannel,t);await this.signal.request(m),await this.signal.waitStatus("SetDestChannelStatus"),this.emit("event",Tt.PACKET_JOINED_DEST_CHANNEL),G.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetDestChannel success"));const E=this.genMessage(bo.StartPacketTransfer,t);await this.signal.request(E),this.emit("event",Tt.PACKET_SENT_TO_DEST_CHANNEL),this.state=hi.RELAY_STATE_RUNNING,G.debug("[".concat(this.clientId,"] startChannelMediaRelay: StartPacketTransfer success")),this.setVideoProfile(this._resolution)}async sendUpdateMessage(t){const r=this.genMessage(bo.UpdateDestChannel,t);await this.signal.request(r),this.emit("event",Tt.PACKET_UPDATE_DEST_CHANNEL),G.debug("[".concat(this.clientId,"] sendUpdateMessage: UpdateDestChannel success"))}async sendStopRelayMessage(){const t=this.genMessage(bo.StopPacketTransfer);await this.signal.request(t),G.debug("[".concat(this.clientId,"] sendStopRelayMessage: StopPacketTransfer success"))}genMessage(t,r){const s=[],l=[],f=[];this.requestId+=1;const m={appId:this.joinInfo.appId,cname:this.joinInfo.cname,uid:this.joinInfo.uid.toString(),sdkVersion:hs,sid:this.sid,ts:Date.now(),requestId:this.requestId,seq:this.requestId,allocate:!0,clientRequest:{}};m.sdkVersion==="4.23.4"&&(m.sdkVersion="0.0.1");let E=null,y=null;switch(t){case bo.SetSdkProfile:return m.clientRequest={command:"SetSdkProfile",type:"multi_channel"},m;case bo.SetSourceChannel:if(y=r&&r.getSrcChannelMediaInfo(),!y)throw new xe(se.UNEXPECTED_ERROR,"can not find source config");return m.clientRequest={command:"SetSourceChannel",uid:"0",channelName:y.channelName,token:y.token||this.joinInfo.appId},m;case bo.SetSourceUserId:if(y=r&&r.getSrcChannelMediaInfo(),!y)throw new xe(se.UNEXPECTED_ERROR,"can not find source config");return m.clientRequest={command:"SetSourceUserId",uid:y.uid+""},m;case bo.SetDestChannel:if(E=r&&r.getDestChannelMediaInfo(),!E)throw new xe(se.UNEXPECTED_ERROR,"can not find dest config");return E.forEach(b=>{s.push(b.channelName),l.push(b.uid+""),f.push(b.token||this.joinInfo.appId)}),m.clientRequest={command:"SetDestChannel",channelName:s,uid:l,token:f},m;case bo.StartPacketTransfer:return m.clientRequest={command:"StartPacketTransfer"},m;case bo.Reconnect:return m.clientRequest={command:"Reconnect"},m;case bo.StopPacketTransfer:return m.clientRequest={command:"StopPacketTransfer"},m;case bo.UpdateDestChannel:if(E=r&&r.getDestChannelMediaInfo(),!E)throw new xe(se.UNEXPECTED_ERROR,"can not find dest config");return E.forEach(b=>{s.push(b.channelName),l.push(b.uid+""),f.push(b.token||this.joinInfo.appId)}),m.clientRequest={command:"UpdateDestChannel",channelName:s,uid:l,token:f},m;case bo.SetVideoProfile:m.clientRequest={command:"SetVideoProfile",width:this._resolution.width,height:this._resolution.height}}return m}}const hK={name:"ChannelMediaRelay",create:function(e){return new fK(e.joinInfo,e.clientId,e.websocketRetryConfig||ra,e.httpRetryConfig||ra,e.resolution)}};function HF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),r.push.apply(r,s)}return r}function EA(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?HF(Object(r),!0).forEach(function(s){ne(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):HF(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}class pK extends Xt{constructor(t,r,s,l){super(),ne(this,"spec",void 0),ne(this,"token",void 0),ne(this,"websocket",void 0),ne(this,"pingpongTimer",void 0),ne(this,"reconnectMode","retry"),ne(this,"serviceMode",void 0),ne(this,"reqId",0),ne(this,"commandReqId",0),ne(this,"handleWebSocketOpen",()=>{this.reconnectMode="retry",this.startPingPong()}),ne(this,"handleWebSocketMessage",f=>{if(!f.data)return;const m=JSON.parse(f.data);m.requestId?this.emit("@".concat(m.requestId,"-").concat(m.sid),m):(Vt.workerEvent(this.spec.sid,{actionType:"status",serverCode:m.code,workerType:this.serviceMode===rf.TRANSCODE?1:2}),this.emit(yh.PUBLISH_STREAM_STATUS,m))}),this.spec=r,this.token=t,this.serviceMode=l,this.websocket=new G_("live-streaming",s),this.websocket.on(hn.CONNECTED,this.handleWebSocketOpen),this.websocket.on(hn.ON_MESSAGE,this.handleWebSocketMessage),this.websocket.on(hn.REQUEST_NEW_URLS,(f,m)=>{la(this,yh.REQUEST_NEW_ADDRESS).then(f).catch(m)}),this.websocket.on(hn.RECONNECTING,()=>{this.websocket.reconnectMode=this.reconnectMode})}init(t){return this.websocket.init(t)}async request(t,r,s,l){this.reqId+=1,t==="request"&&(this.commandReqId+=1);const f=this.commandReqId,m=this.reqId;if(!m||!this.websocket)throw new xe(se.UNEXPECTED_ERROR);const E=EA({command:t,sdkVersion:hs==="4.23.4"?"0.0.1":hs,seq:m,requestId:m,allocate:s,cname:this.spec.cname,appId:this.spec.appId,sid:this.spec.sid,uid:this.spec.uid.toString(),ts:Math.floor(Date.now()/1e3)},r);if(this.websocket.state==="closed")throw new xe(se.WS_DISCONNECT);const y=()=>new gt((D,P)=>{this.websocket.once(hn.CLOSED,()=>P(new xe(se.WS_ABORT))),this.websocket.once(hn.CONNECTED,D)});this.websocket.state!=="connected"&&await y(),E.clientRequest&&(E.clientRequest.workerToken=this.token);const b=new gt((D,P)=>{const F=()=>{P(new xe(se.WS_ABORT))};this.websocket.once(hn.RECONNECTING,F),this.websocket.once(hn.CLOSED,F),this.once("@".concat(m,"-").concat(this.spec.sid),B=>{D(B)})});l&&Vt.workerEvent(this.spec.sid,EA(EA({},l),{},{requestId:f,actionType:"request",payload:JSON.stringify(r.clientRequest),serverCode:0,code:0}));const A=Date.now();this.websocket.sendMessage(E);let O=null;try{O=await b}catch(D){if(this.websocket.state==="closed")throw D;return await y(),await this.request(t,r,s)}return l&&Vt.workerEvent(this.spec.sid,EA(EA({},l),{},{requestId:f,actionType:"response",payload:JSON.stringify(O.serverResponse),serverCode:O.code,success:O.code===200,responseTime:Date.now()-A})),O.code!==200&&this.handleResponseError(O),O}tryNextAddress(){this.reconnectMode="tryNext",this.websocket.reconnect("tryNext")}close(){const t=hs==="4.23.4"?"0.0.1":hs;this.reqId+=1,this.websocket.state==="connected"?(this.websocket.sendMessage({command:"request",appId:this.spec.appId,cname:this.spec.cname,uid:this.spec.uid.toString(),sdkVersion:t,sid:this.spec.sid,seq:this.reqId,ts:Math.floor(Date.now()/1e3),requestId:this.reqId,clientRequest:{command:"DestroyWorker"}}),this.websocket.close(!1,!0)):this.websocket.close(!1),this.pingpongTimer&&(window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0)}handleResponseError(t){switch(t.code){case ya.LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM:return void G.warning("live stream response already exists stream");case ya.LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR:case ya.LIVE_STREAM_RESPONSE_BAD_STREAM:case ya.LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR:return new xe(se.LIVE_STREAMING_INVALID_ARGUMENT,"",{code:t.code}).throw();case ya.LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST:if(t.serverResponse.command==="UnpublishStream")return;throw new xe(se.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream response wm worker not exist",{retry:!0});case ya.LIVE_STREAM_RESPONSE_NOT_AUTHORIZED:return new xe(se.LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED,"",{code:t.code}).throw();case ya.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE:{const r=new xe(se.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE);return this.emit(yh.WARNING,r,t.serverResponse.url)}case ya.LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN:{const r=new xe(se.LIVE_STREAMING_WARN_FREQUENT_REQUEST);return this.emit(yh.WARNING,r,t.serverResponse.url)}case ya.LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH:throw new xe(se.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream response wm worker not exist",{retry:!0});case ya.LIVE_STREAM_RESPONSE_NOT_SUPPORTED:return new xe(se.LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED,"",{code:t.code}).throw();case ya.LIVE_STREAM_RESPONSE_MAX_STREAM_NUM:{const r=new xe(se.LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT);return this.emit(yh.WARNING,r,t.serverResponse.url)}case ya.LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR:return new xe(se.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"",{code:t.code}).throw();case ya.LIVE_STREAM_RESPONSE_RESOURCE_LIMIT:throw new xe(se.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream resource limit",{retry:!0,changeAddress:!0});case ya.LIVE_STREAM_RESPONSE_WORKER_LOST:case ya.LIVE_STREAM_RESPONSE_WORKER_QUIT:if(t.serverResponse.command==="UnpublishStream")return;throw new xe(se.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{retry:!0,changeAddress:!0});case ya.ERROR_FAIL_SEND_MESSAGE:if(t.serverResponse.command==="UnpublishStream")return;if(t.serverResponse.command==="UpdateTranscoding"||t.serverResponse.command==="ControlStream")return new xe(se.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{code:t.code}).throw();throw new xe(se.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{retry:!0,changeAddress:!0});case ya.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN:case ya.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT:case ya.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE:case ya.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH:return new xe(se.LIVE_STREAMING_CDN_ERROR,"",{code:t.code}).throw()}}startPingPong(){this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(()=>{this.websocket.state==="connected"&&this.request("ping",{}).catch(Dg)},6e3)}}function yj(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),r.push.apply(r,s)}return r}function Qc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?yj(Object(r),!0).forEach(function(s){ne(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):yj(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}class Tj extends Xt{constructor(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ra,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ra;super(),ne(this,"onLiveStreamWarning",void 0),ne(this,"onLiveStreamError",void 0),ne(this,"spec",void 0),ne(this,"retryTimeout",1e4),ne(this,"connection",void 0),ne(this,"httpRetryConfig",void 0),ne(this,"wsRetryConfig",void 0),ne(this,"streamingTasks",new Map),ne(this,"isStartingStreamingTask",!1),ne(this,"taskMutex",new Gi("live-streaming")),ne(this,"cancelToken",En.CancelToken.source()),ne(this,"transcodingConfig",void 0),ne(this,"uapResponse",void 0),ne(this,"lastTaskId",1),ne(this,"statusError",new Map),this.spec=t,this.httpRetryConfig=s,this.wsRetryConfig=r}async setTranscodingConfig(t){const r=Qc(Qc({},zs),t);r.videoCodecProfile!==66&&r.videoCodecProfile!==77&&r.videoCodecProfile!==100&&(G.debug("[".concat(this.spec.clientId,"] set transcoding config, fix video codec profile: ").concat(r.videoCodecProfile," -> 100")),r.videoCodecProfile=100),r.transcodingUsers||(r.transcodingUsers=r.userConfigs),r.transcodingUsers&&(r.transcodingUsers=r.transcodingUsers.map(m=>Qc(Qc(Qc({},Wa),m),{},{zOrder:m.zOrder?m.zOrder+1:1}))),function(m){bn(m.width)||wr(m.width,"config.width",0,1e4),bn(m.height)||wr(m.height,"config.height",0,1e4),bn(m.videoBitrate)||wr(m.videoBitrate,"config.videoBitrate",1,1e6),bn(m.videoFrameRate)||wr(m.videoFrameRate,"config.videoFrameRate"),bn(m.lowLatency)||hh(m.lowLatency,"config.lowLatency"),bn(m.audioSampleRate)||Aa(m.audioSampleRate,"config.audioSampleRate",[32e3,44100,48e3]),bn(m.audioBitrate)||wr(m.audioBitrate,"config.audioBitrate",1,128),bn(m.audioChannels)||Aa(m.audioChannels,"config.audioChannels",[1,2,3,4,5]),bn(m.videoGop)||wr(m.videoGop,"config.videoGop"),bn(m.videoCodecProfile)||Aa(m.videoCodecProfile,"config.videoCodecProfile",[66,77,100]),bn(m.userCount)||wr(m.userCount,"config.userCount",0,17),bn(m.backgroundColor)||wr(m.backgroundColor,"config.backgroundColor",0,16777215),bn(m.userConfigExtraInfo)||Oa(m.userConfigExtraInfo,"config.userConfigExtraInfo",0,4096,!1),m.transcodingUsers&&!bn(m.transcodingUsers)&&(Bp(m.transcodingUsers,"config.transcodingUsers"),m.transcodingUsers.forEach((E,y)=>{La(E.uid),bn(E.x)||wr(E.x,"transcodingUser[".concat(y,"].x"),0,1e4),bn(E.y)||wr(E.y,"transcodingUser[".concat(y,"].y"),0,1e4),bn(E.width)||wr(E.width,"transcodingUser[".concat(y,"].width"),0,1e4),bn(E.height)||wr(E.height,"transcodingUser[".concat(y,"].height"),0,1e4),bn(E.zOrder)||wr(E.zOrder-1,"transcodingUser[".concat(y,"].zOrder"),0,100),bn(E.alpha)||wr(E.alpha,"transcodingUser[".concat(y,"].alpha"),0,1,!1)})),bn(m.watermark)||ZL(m.watermark,"watermark"),bn(m.backgroundImage)||ZL(m.backgroundImage,"backgroundImage"),m.images&&!bn(m.images)&&(Bp(m.images,"config.images"),m.images.forEach((E,y)=>{ZL(E,"images[".concat(y,"]"))}))}(r);const s=[];r.images&&s.push(...r.images.map(m=>Qc(Qc(Qc({},rr),m),{},{zOrder:255}))),r.backgroundImage&&(s.push(Qc(Qc(Qc({},rr),r.backgroundImage),{},{zOrder:0})),delete r.backgroundImage),r.watermark&&(s.push(Qc(Qc(Qc({},rr),r.watermark),{},{zOrder:255})),delete r.watermark),r.images=s,r.transcodingUsers&&(r.userConfigs=r.transcodingUsers.map(m=>Qc({},m)),r.userCount=r.transcodingUsers.length,delete r.transcodingUsers);const l=(r.userConfigs||[]).map(m=>typeof m.uid=="number"?gt.resolve(m.uid):T1(m.uid,this.spec,this.cancelToken.token,this.httpRetryConfig));if((await gt.all(l)).forEach((m,E)=>{r.userConfigs&&r.userConfigs[E]&&(r.userConfigs[E].uid=m)}),this.transcodingConfig=r,this.connection)try{var f;const m=await this.connection.request("request",{clientRequest:{command:"UpdateTranscoding",transcodingConfig:this.transcodingConfig}},!1,{command:"UpdateTranscoding",workerType:1,requestByUser:!0,tid:Array.from(oc(f=this.streamingTasks).call(f)).map(E=>E.taskId).join("#")});G.debug("[".concat(this.spec.clientId,"] update live transcoding config success, code: ").concat(m.code,", config:"),JSON.stringify(this.transcodingConfig))}catch(m){if(!m.data||!m.data.retry)throw m;m.data.changeAddress&&this.connection.tryNextAddress(),this.streamingTasks.forEach(E=>{G.warning("[".concat(this.spec.clientId,"] live streaming receive error"),m.toString(),"try to republish",E.url),this.startLiveStreamingTask(E.url,E.mode,m).then(()=>{G.debug("[".concat(this.spec.clientId,"] live streaming republish ").concat(E.url," success"))}).catch(y=>{G.error("[".concat(this.spec.clientId,"] live streaming republish failed"),E.url,y.toString()),this.onLiveStreamError&&this.onLiveStreamError(E.url,y)})})}}async startLiveStreamingTask(t,r,s){if(!this.transcodingConfig&&r===rf.TRANSCODE)throw new xe(se.INVALID_OPERATION,"[LiveStreaming] no transcoding config found, can not start transcoding streaming task");const l={command:"PublishStream",ts:Date.now(),url:t,uid:this.spec.uid.toString(),autoDestroyTime:100,acceptImageTimeout:!0};G.debug("[".concat(this.spec.clientId,"] start live streaming ").concat(t,", mode: ").concat(r));const f=await this.taskMutex.lock();if(!this.connection&&s)return void f();if(this.streamingTasks.get(t)&&!s)return f(),new xe(se.LIVE_STREAMING_TASK_CONFLICT).throw();try{this.connection||(this.connection=await this.connect(r))}catch(E){throw f(),E}switch(r){case rf.TRANSCODE:l.transcodingConfig=Qc({},this.transcodingConfig)}this.uapResponse&&this.uapResponse.vid&&(l.vid=this.uapResponse.vid),this.isStartingStreamingTask=!0;const m=this.lastTaskId++;try{const E=new gt((b,A)=>{fs(this.retryTimeout).then(()=>{if(s)return A(s);const O=this.statusError.get(t);return O?(this.statusError.delete(t),A(O)):void 0})}),y=await gt.race([this.connection.request("request",{clientRequest:l},!0,{url:t,command:"PublishStream",workerType:r===rf.TRANSCODE?1:2,requestByUser:!s,tid:m.toString()}),E]);this.isStartingStreamingTask=!1,G.debug("[".concat(this.spec.clientId,"] live streaming started, code: ").concat(y.code)),this.streamingTasks.set(t,{clientRequest:l,mode:r,url:t,taskId:m}),f()}catch(E){if(f(),this.isStartingStreamingTask=!1,!E.data||!E.data.retry||s)throw E;return E.data.changeAddress?(this.connection.tryNextAddress(),await this.startLiveStreamingTask(t,r,E)):await this.startLiveStreamingTask(t,r,E)}}stopLiveStreamingTask(t){return new gt((r,s)=>{const l=this.streamingTasks.get(t);if(!l||!this.connection)return new xe(se.UNEXPECTED_ERROR,"can not find streaming task to stop").throw();const f=l.mode;l.abortTask=()=>{G.debug("[".concat(this.spec.clientId,"] stop live streaming success(worker exception)")),this.streamingTasks.delete(t),r()},this.connection.request("request",{clientRequest:{command:"UnpublishStream",url:l.url}},!1,{url:t,command:"UnPublishStream",workerType:f===rf.TRANSCODE?1:2,requestByUser:!0,tid:(this.lastTaskId++).toString()}).then(m=>{G.debug("[".concat(this.spec.clientId,"] stop live streaming success, code: ").concat(m.code)),this.streamingTasks.delete(t),this.streamingTasks.size===0&&(this.connection&&this.connection.close(),this.connection=void 0),r()}).catch(s)})}resetAllTask(){var t;const r=Array.from(oc(t=this.streamingTasks).call(t));this.terminate();for(const s of r)this.startLiveStreamingTask(s.url,s.mode).catch(l=>{this.onLiveStreamError&&this.onLiveStreamError(s.url,l)})}terminate(){this.cancelToken&&this.cancelToken.cancel(),this.streamingTasks=new Map,this.isStartingStreamingTask=!1,this.statusError=new Map,this.cancelToken=En.CancelToken.source(),this.uapResponse=void 0,this.connection&&this.connection.close(),this.connection=void 0}async connect(t){if(this.connection)throw new xe(se.UNEXPECTED_ERROR,"live streaming connection has already connected");const r=await la(this,PS.REQUEST_WORKER_MANAGER_LIST,t);return this.uapResponse=r,this.connection=new pK(r.workerToken,this.spec,this.wsRetryConfig,t),this.connection.on(yh.WARNING,(s,l)=>this.onLiveStreamWarning&&this.onLiveStreamWarning(l,s)),this.connection.on(yh.PUBLISH_STREAM_STATUS,s=>this.handlePublishStreamServer(s)),this.connection.on(yh.REQUEST_NEW_ADDRESS,(s,l)=>{if(!this.connection)return l(new xe(se.UNEXPECTED_ERROR,"can not get new live streaming address list"));la(this,PS.REQUEST_WORKER_MANAGER_LIST,t).then(f=>{this.uapResponse=f,s(f.addressList)}).catch(l)}),await this.connection.init(r.addressList),this.connection}handlePublishStreamServer(t){const r=t.serverStatus&&t.serverStatus.url||"empty_url",s=this.streamingTasks.get(r),l=t.reason;switch(t.code){case ya.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN:case ya.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT:case ya.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE:case ya.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH:{const m=new xe(se.LIVE_STREAMING_CDN_ERROR,"",{code:t.code});if(s)return G.error(m.toString()),this.onLiveStreamError&&this.onLiveStreamError(r,m);if(!this.isStartingStreamingTask)return;this.statusError.set(r,m)}case ya.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE:{const m=new xe(se.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE,l);return this.onLiveStreamWarning&&this.onLiveStreamWarning(r,m)}case ya.LIVE_STREAM_RESPONSE_WORKER_LOST:case ya.LIVE_STREAM_RESPONSE_WORKER_QUIT:{var f;if(!this.connection)return;this.connection.tryNextAddress();const m=Array.from(oc(f=this.streamingTasks).call(f));for(const E of m)E.abortTask?E.abortTask():(G.warning("[".concat(this.spec.clientId,"] publish stream status code"),t.code,"try to republish",E.url),this.startLiveStreamingTask(E.url,E.mode,new xe(se.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"",{code:t.code})).then(()=>{G.debug("[".concat(this.spec.clientId,"] republish live stream success"),E.url)}).catch(y=>{G.error(y.toString()),this.onLiveStreamError&&this.onLiveStreamError(E.url,y)}));return}}}hasUrl(t){return this.streamingTasks.has(t)}}const Zc={name:"LiveStreaming",create:function(e){return new Tj(e.joinInfo,e.websocketRetryConfig||ra,e.httpRetryConfig||ra)}};function Y1(e){let t=wj();return function(r,s){let l=r.appId;l!==void 0&&(Ar(s,10),Lh(s,l));let f=r.cid;f!==void 0&&(Ar(s,16),Ar(s,f));let m=r.cname;m!==void 0&&(Ar(s,26),Lh(s,m));let E=r.deviceId;E!==void 0&&(Ar(s,34),Lh(s,E));let y=r.elapse;y!==void 0&&(Ar(s,40),lm(s,y));let b=r.fileSize;b!==void 0&&(Ar(s,48),lm(s,Dl(b)));let A=r.height;A!==void 0&&(Ar(s,56),lm(s,Dl(A)));let O=r.jpg;O!==void 0&&(Ar(s,66),Ar(s,O.length),function(en,He){let tt=Pl(en,He.length);en.bytes.set(He,tt)}(s,O));let D=r.networkType;D!==void 0&&(Ar(s,72),lm(s,Dl(D)));let P=r.osType;P!==void 0&&(Ar(s,80),lm(s,Dl(P)));let F=r.requestId;F!==void 0&&(Ar(s,90),Lh(s,F));let B=r.sdkVersion;B!==void 0&&(Ar(s,98),Lh(s,B));let Y=r.sequence;Y!==void 0&&(Ar(s,104),lm(s,Dl(Y)));let $=r.sid;$!==void 0&&(Ar(s,114),Lh(s,$));let ee=r.timestamp;ee!==void 0&&(Ar(s,120),lm(s,ee));let Ee=r.uid;Ee!==void 0&&(Ar(s,128),Ar(s,Ee));let Re=r.vid;Re!==void 0&&(Ar(s,136),Ar(s,Re));let Ie=r.width;Ie!==void 0&&(Ar(s,144),lm(s,Dl(Ie)));let we=r.service;we!==void 0&&(Ar(s,152),Ar(s,we));let Ue=r.callbackData;Ue!==void 0&&(Ar(s,162),Lh(s,Ue));let ve=r.jpgEncryption;ve!==void 0&&(Ar(s,168),Ar(s,ve));let Ne=r.requestType;Ne!==void 0&&(Ar(s,176),Ar(s,Ne));let Ve=r.scorePorn;Ve!==void 0&&(Ar(s,185),Rj(s,Ve));let Be=r.scoreSexy;Be!==void 0&&(Ar(s,193),Rj(s,Be));let W=r.scoreNeutral;W!==void 0&&(Ar(s,201),Rj(s,W));let ce=r.scene;ce!==void 0&&(Ar(s,208),Ar(s,ce));let Se=r.ossFilePrefix;Se!==void 0&&(Ar(s,218),Lh(s,Se));let Xe=r.serviceVendor;if(Xe!==void 0)for(let en of Xe){Ar(s,226);let He=wj();mK(en,He),Ar(s,He.limit),gK(s,He),qF(He)}}(e,t),function(r){let s=r.bytes,l=r.limit;return s.length===l?s:s.subarray(0,l)}(t)}function WF(e){return function(r){let s={};e:for(;!XD(r);){let l=cm(r);switch(l>>>3){case 0:break e;case 1:s.code=cm(r);break;case 2:s.msg=i0(r,cm(r));break;case 3:{let f=bj(r);s.data=YF(r),r.limit=f;break}default:Cj(r,7&l)}}return s}({bytes:t=e,offset:0,limit:t.length});var t}function YF(e){let t={};e:for(;!XD(e);){let r=cm(e);switch(r>>>3){case 0:break e;case 1:t.requestId=i0(e,cm(e));break;case 2:t.requestType=cm(e)>>>0;break;case 3:t.scorePorn=QD(e);break;case 4:t.scoreSexy=QD(e);break;case 5:t.scoreNeutral=QD(e);break;case 6:t.requestScene=cm(e)>>>0;break;case 7:t.scene=cm(e)>>>0;break;default:Cj(e,7&r)}}return t}function mK(e,t){let r=e.service;r!==void 0&&(Ar(t,8),Ar(t,r));let s=e.vendor;s!==void 0&&(Ar(t,16),Ar(t,s));let l=e.token;l!==void 0&&(Ar(t,26),Lh(t,l));let f=e.callbackUrl;f!==void 0&&(Ar(t,34),Lh(t,f))}function bj(e){let t=cm(e),r=e.limit;return e.limit=e.offset+t,r}function Cj(e,t){switch(t){case 0:for(;128&JF(e););break;case 2:SA(e,cm(e));break;case 5:SA(e,4);break;case 1:SA(e,8);break;default:throw new Error("Unimplemented type: "+t)}}let K1=new Float32Array(1);new Uint8Array(K1.buffer);let vA=new Float64Array(1),gc=new Uint8Array(vA.buffer);function Dl(e){return{low:e|=0,high:e>>31,unsigned:e>=0}}let KF=[];function wj(){const e=KF.pop();return e?(e.offset=e.limit=0,e):{bytes:new Uint8Array(64),offset:0,limit:0}}function qF(e){KF.push(e)}function SA(e,t){if(e.offset+t>e.limit)throw new Error("Skip past limit");e.offset+=t}function XD(e){return e.offset>=e.limit}function Pl(e,t){let r=e.bytes,s=e.offset,l=e.limit,f=s+t;if(f>r.length){let m=new Uint8Array(2*f);m.set(r),e.bytes=m}return e.offset=f,f>l&&(e.limit=f),s}function vr(e,t){let r=e.offset;if(r+t>e.limit)throw new Error("Read past limit");return e.offset+=t,r}function i0(e,t){let r=vr(e,t),s=String.fromCharCode,l=e.bytes,f="",m="";for(let E=0;E<t;E++){let y,b,A,O,D=l[E+r];(128&D)==0?m+=s(D):(224&D)==192?E+1>=t?m+=f:(y=l[E+r+1],(192&y)!=128?m+=f:(O=(31&D)<<6|63&y,O<128?m+=f:(m+=s(O),E++))):(240&D)==224?E+2>=t?m+=f:(y=l[E+r+1],b=l[E+r+2],(49344&(y|b<<8))!=32896?m+=f:(O=(15&D)<<12|(63&y)<<6|63&b,O<2048||O>=55296&&O<=57343?m+=f:(m+=s(O),E+=2))):(248&D)==240?E+3>=t?m+=f:(y=l[E+r+1],b=l[E+r+2],A=l[E+r+3],(12632256&(y|b<<8|A<<16))!=8421504?m+=f:(O=(7&D)<<18|(63&y)<<12|(63&b)<<6|63&A,O<65536||O>1114111?m+=f:(O-=65536,m+=s(55296+(O>>10),56320+(1023&O)),E+=3))):m+=f}return m}function Lh(e,t){let r=t.length,s=0;for(let m=0;m<r;m++){let E=t.charCodeAt(m);E>=55296&&E<=56319&&m+1<r&&(E=(E<<10)+t.charCodeAt(++m)-56613888),s+=E<128?1:E<2048?2:E<65536?3:4}Ar(e,s);let l=Pl(e,s),f=e.bytes;for(let m=0;m<r;m++){let E=t.charCodeAt(m);E>=55296&&E<=56319&&m+1<r&&(E=(E<<10)+t.charCodeAt(++m)-56613888),E<128?f[l++]=E:(E<2048?f[l++]=E>>6&31|192:(E<65536?f[l++]=E>>12&15|224:(f[l++]=E>>18&7|240,f[l++]=E>>12&63|128),f[l++]=E>>6&63|128),f[l++]=63&E|128)}}function gK(e,t){let r=Pl(e,t.limit),s=e.bytes,l=t.bytes;for(let f=0,m=t.limit;f<m;f++)s[f+r]=l[f]}function JF(e){return e.bytes[vr(e,1)]}function XF(e,t){let r=Pl(e,1);e.bytes[r]=t}function QD(e){let t=vr(e,8),r=e.bytes;return gc[0]=r[t++],gc[1]=r[t++],gc[2]=r[t++],gc[3]=r[t++],gc[4]=r[t++],gc[5]=r[t++],gc[6]=r[t++],gc[7]=r[t++],vA[0]}function Rj(e,t){let r=Pl(e,8),s=e.bytes;vA[0]=t,s[r++]=gc[0],s[r++]=gc[1],s[r++]=gc[2],s[r++]=gc[3],s[r++]=gc[4],s[r++]=gc[5],s[r++]=gc[6],s[r++]=gc[7]}function cm(e){let t,r=0,s=0;do t=JF(e),r<32&&(s|=(127&t)<<r),r+=7;while(128&t);return s}function Ar(e,t){for(t>>>=0;t>=128;)XF(e,127&t|128),t>>>=7;XF(e,t)}function lm(e,t){let r=t.low>>>0,s=(t.low>>>28|t.high<<4)>>>0,l=t.high>>>24,f=l===0?s===0?r<16384?r<128?1:2:r<1<<21?3:4:s<16384?s<128?5:6:s<1<<21?7:8:l<128?9:10,m=Pl(e,f),E=e.bytes;switch(f){case 10:E[m+9]=l>>>7&1;case 9:E[m+8]=f!==9?128|l:127&l;case 8:E[m+7]=f!==8?s>>>21|128:s>>>21&127;case 7:E[m+6]=f!==7?s>>>14|128:s>>>14&127;case 6:E[m+5]=f!==6?s>>>7|128:s>>>7&127;case 5:E[m+4]=f!==5?128|s:127&s;case 4:E[m+3]=f!==4?r>>>21|128:r>>>21&127;case 3:E[m+2]=f!==3?r>>>14|128:r>>>14&127;case 2:E[m+1]=f!==2?r>>>7|128:r>>>7&127;case 1:E[m]=f!==1?128|r:127&r}}function Ij(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),r.push.apply(r,s)}return r}const _K=new Map([["moderation",1],["supervise",2]]);class EK extends Xt{get connectionState(){return this._connectionState}set connectionState(t){if(this._connectionState===t)return;const r=this._connectionState;this._connectionState=t,this.emit(ja.CONNECTION_STATE_CHANGE,r,t)}get inspectType(){return this._inspectType}set inspectType(t){var r;this._inspectMode=wc(r=t.map(s=>_K.get(s)||0)).call(r,(s,l)=>s+l),this._inspectType=t}get quality(){return this._quality}set quality(t){this._quality=t>1?1:t<.1?.1:t,this.qualityTimer&&(window.clearTimeout(this.qualityTimer),this.qualityTimer=null),this._quality>=1||(this.qualityTimer=window.setTimeout(()=>{this.quality=this._quality/this.qualityRatio},6e4))}constructor(t){super(),ne(this,"name","AgoraRTCVideoContentInspect"),ne(this,"_connectionState",Hc.CONNECTING),ne(this,"_innerConnectionState",void 0),ne(this,"sequence",0),ne(this,"inspectStartTime",void 0),ne(this,"workerManagerConnection",void 0),ne(this,"workerConnection",void 0),ne(this,"workerMessageLengthLimit",void 0),ne(this,"inspectIntervalMinimum",void 0),ne(this,"qualityRatio",void 0),ne(this,"_connectInfo",void 0),ne(this,"_cancelTokenSource",En.CancelToken.source()),ne(this,"_retryConfig",void 0),ne(this,"wmSequence",0),ne(this,"inspectInterval",void 0),ne(this,"inspectTimer",null),ne(this,"ossFilePrefix",void 0),ne(this,"extraInfo",void 0),ne(this,"_inspectType",void 0),ne(this,"_inspectMode",void 0),ne(this,"_quality",1),ne(this,"qualityTimer",null),ne(this,"_inspectId",void 0),ne(this,"_needWorkUrlOnly",!1),ne(this,"inspectImage",()=>{if(this.connectionState!==Hc.CONNECTED)throw new xe(se.OPERATION_ABORTED,"content inspect service connection status is ".concat(this.connectionState));this.inspectTimer&&(window.clearInterval(this.inspectTimer),this.inspectTimer=null),this.inspectTimer=window.setInterval(()=>{this.connectionState===Hc.CONNECTED?this.requestToInspectImage():G.debug("[".concat(this._inspectId,"] Inspect State is not connected , "),this.connectionState)},this.inspectInterval<this.inspectIntervalMinimum?this.inspectIntervalMinimum:this.inspectInterval),this.requestToInspectImage()}),this._inspectId=Br(5,"inspect-"),this.workerMessageLengthLimit=me("VIDEO_INSPECT_WORKER_MESSAGE_LENGTH_LIMIT"),this.inspectIntervalMinimum=me("VIDEO_INSPECT_INTERVAL_MINIMUM"),this.qualityRatio=me("VIDEO_INSPECT_QUALITY_RATIO"),this.inspectInterval=t.interval,this.ossFilePrefix=t.ossFilePrefix,this.extraInfo=t.extraInfo,this.inspectType=t.inspectType,this.inspectStartTime=Number(Date.now()),this.workerManagerConnection=new G_("worker-manager-"+this._inspectId,ra),this.on(ja.STATE_CHANGE,(r,s)=>{this._innerConnectionState=r,G.debug("[".concat(this._inspectId,"] Inspect operation :").concat(ru[r]," ").concat(s||""))}),this.handleWorkerManagerEvents(),this.workerConnection=new G_("worker-"+this._inspectId,ra),this.handleWorkerEvents()}async init(t,r){this.emit(ja.STATE_CHANGE,ru.CONNECT_AP),this._connectInfo=t;const s=this._cancelTokenSource.token;return this._retryConfig=r,new gt((l,f)=>{this.on(ja.CONNECTION_STATE_CHANGE,(m,E)=>{E===Hc.CONNECTED&&l()}),this.requestAP(t,s,r).then(m=>{this.connectWorkerManager(m)}).catch(m=>{f(m)})})}async requestAP(t,r,s){const l=me("WEBCS_DOMAIN").map(E=>"https://".concat(E,"/api/v1")),f=await function(E,y,b,A){let{appId:O,areaCode:D,cname:P,sid:F,token:B,uid:Y}=y;v1++;const $="image_moderation_api",ee={service_name:$,json_body:JSON.stringify({appId:O,areaCode:D,cname:P,command:"allocateEdge",requestId:v1,seq:v1,sid:F,token:B,ts:Date.now(),uid:Y+""})};let Ee,Re,Ie=E[0];return _l(async()=>{Ee=Date.now();const we=await cf(Ie,{data:ee,cancelToken:b,headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"61"},params:{action:"wrtc_gateway"}});if(Re=Date.now()-Ee,we.code!==0){const Ve=new xe(se.UNEXPECTED_RESPONSE,"image inspect ap error, code"+we.code,{retry:!0,responseTime:Re});throw G.error(Ve.toString()),Ve}const Ue=JSON.parse(we.json_body);if(Ue.code!==200){const Ve=new xe(se.UNEXPECTED_RESPONSE,"image inspect ap error, code: ".concat(Ue.code,", reason: ").concat(Ue.reason),{code:Ue.code,responseTime:Re});throw G.error(Ve.toString()),Ve}if(!Ue.servers||!Array.isArray(Ue.servers)||Ue.servers.length===0){const Ve=new xe(se.UNEXPECTED_RESPONSE,"image inspect ap empty server",{code:Ue.code,responseTime:Re});throw G.error(Ve.toString()),Ve}const ve=me("VIDEO_INSPECT_WORKER_MANAGER_HOST"),Ne=me("VIDEO_INSPECT_WORKER_MANAGER_PORT");return{addressList:Ue.servers.map(Ve=>{let{address:Be,wss:W}=Ve;if(Be&&W)return"wss://".concat(Be.replace(/\./g,"-"),".").concat(ve,":").concat(Ne||W)}).filter(Ve=>!!Ve),workerToken:Ue.workerToken,vid:Ue.vid,responseTime:Re}},(we,Ue)=>(Vt.apworkerEvent(F,{success:!0,sc:200,serviceName:$,responseDetail:JSON.stringify(we.addressList),firstSuccess:Ue===0,responseTime:Re,serverIp:E[Ue%E.length]}),!1),(we,Ue)=>(Vt.apworkerEvent(F,{success:!1,sc:we.data&&we.data.code||200,serviceName:$,responseTime:Re,serverIp:E[Ue%E.length]}),!!(we.code!==se.OPERATION_ABORTED&&we.code!==se.UNEXPECTED_RESPONSE||we.data&&we.data.retry)&&(Ie=E[(Ue+1)%E.length],!0)),A)}(l,t,r,s);this.emit(ja.STATE_CHANGE,ru.AP_CONNECTED);const{addressList:m}=f;return this.wmSequence++,m}async connectWorkerManager(t){let r=arguments.length>1&&arguments[1]!==void 0&&arguments[1];this._needWorkUrlOnly=r,this.emit(ja.STATE_CHANGE,ru.CONNECT_WORKER_MANAGER),await this.workerManagerConnection.init(t,1e4)}async connectWorker(t){await this.workerConnection.init([t])}handleWorkerManagerEvents(){this.workerManagerConnection.on(hn.CONNECTED,async()=>{this.emit(ja.STATE_CHANGE,ru.WORKER_MANAGER_CONNECTED,this.workerManagerConnection.url),this.workerManagerConnection.sendMessage({appId:this._connectInfo.appId,cname:this._connectInfo.cname,uid:this._connectInfo.uid+"",sdkVersion:"4.23.4",sid:this._connectInfo.sid,seq:this.wmSequence,ts:Number(Date.now()),requestId:Math.floor(1e12*Math.random()),allocate:!0,clientRequest:{command:"join"}},!0)}),this.workerManagerConnection.on(hn.CLOSED,()=>{this._innerConnectionState<ru.GET_WORKER_MANAGER_RESPONSE&&G.debug("[".concat(this._inspectId,"] Inspect worker manager is closed before connecting worker"))}),this.workerManagerConnection.on(hn.FAILED,()=>{this._innerConnectionState<ru.GET_WORKER_MANAGER_RESPONSE&&G.debug("[".concat(this._inspectId,"] Connecting inspect worker manager is failed before connecting worker"))}),this.workerManagerConnection.on(hn.RECONNECTING,()=>{this._innerConnectionState<ru.GET_WORKER_MANAGER_RESPONSE&&G.debug("[".concat(this._inspectId,"] Inspect worker manager is reconnecting before connecting worker"))}),this.workerManagerConnection.on(hn.ON_MESSAGE,async t=>{this.emit(ja.STATE_CHANGE,ru.GET_WORKER_MANAGER_RESPONSE);const r=this.workerManagerConnection.url;this.workerManagerConnection.close();const s=JSON.parse(t.data);if(s.code!==200)throw G.error("[".concat(this._inspectId,"] Unexpected code ").concat(s.code," from worker manager")),new xe(se.UNEXPECTED_RESPONSE,"response code of worker is unexpected",s);if(!(s.serverResponse&&s.serverResponse.portWss&&r))throw G.error("[".concat(this._inspectId,"] Unexpected content from worker manager : ").concat(JSON.stringify(s))),new xe(se.UNEXPECTED_RESPONSE,"response content of worker is unexpected",s);{const l=me("VIDEO_INSPECT_WORKER_PORT")||s.serverResponse.portWss,f=r.replace(/:\d+\/?$/,":".concat(l));this.emit(ja.STATE_CHANGE,ru.CONNECT_WORKER,f),this._needWorkUrlOnly?this.emit(ja.REQUEST_NEW_WORKER_URL,f):await this.connectWorker(f)}}),this.workerManagerConnection.on(hn.WILL_RECONNECT,(t,r,s)=>{s(t)}),this.workerManagerConnection.on(hn.REQUEST_NEW_URLS,(t,r)=>{this.requestAP(this._connectInfo,this._cancelTokenSource.token,this._retryConfig).then(t).catch(r)})}handleWorkerEvents(){this.workerConnection.on(hn.CONNECTED,async()=>{this.emit(ja.STATE_CHANGE,ru.WORKER_CONNECTED,this.workerConnection.url),this.connectionState=Hc.CONNECTED}),this.workerConnection.on(hn.ON_MESSAGE,async t=>{if(t.data instanceof ArrayBuffer){const s=WF(new Uint8Array(t.data));if(me("SHOW_VIDEO_INSPECT_WORKER_MESSAGE")&&G.debug("[".concat(this._inspectId,"] Response message for worker of inspect content "),JSON.stringify(s)),s.code===200){if(Array.isArray(this.inspectType)&&this.inspectType.length===1&&this.inspectType[0]==="supervise")return void this.emit(ja.INSPECT_RESULT,void 0,void 0);if(s.data&&s.data.scorePorn&&s.data.scoreSexy&&s.data.scoreNeutral){var r;const l={porn:s.data.scorePorn,sexy:s.data.scoreSexy,neutral:s.data.scoreNeutral},f=wc(r=Object.keys(l)).call(r,(E,y)=>l[E]>l[y]?E:y,"porn"),m=Object.keys(l).find(E=>E===f);this.emit(ja.INSPECT_RESULT,m)}else this.emit(ja.INSPECT_RESULT,void 0,new xe(se.UNEXPECTED_RESPONSE,s.code+"","There is an unexpected data on message"))}else this.emit(ja.INSPECT_RESULT,void 0,new xe(se.UNEXPECTED_RESPONSE,s.code+"",s.msg))}else G.error("[".concat(this._inspectId,"] Unexpected message type from worker")),this.emit(ja.INSPECT_RESULT,void 0,new xe(se.UNEXPECTED_RESPONSE,"invalid worker message type"))}),this.workerConnection.on(hn.CLOSED,()=>{this.connectionState=Hc.CLOSED}),this.workerConnection.on(hn.FAILED,()=>{this.connectionState=Hc.CLOSED}),this.workerConnection.on(hn.RECONNECTING,()=>{this.connectionState=this.connectionState===Hc.CONNECTED?Hc.RECONNECTING:Hc.CONNECTING}),this.workerConnection.on(hn.WILL_RECONNECT,(t,r,s)=>{t==="recover"&&s(t),s("tryNext")}),this.workerConnection.on(hn.REQUEST_NEW_URLS,(t,r)=>{this.workerManagerConnection.close(),this.once(ja.REQUEST_NEW_WORKER_URL,s=>{t([s])}),this.requestAP(this._connectInfo,this._cancelTokenSource.token,this._retryConfig).then(s=>{this.connectWorkerManager(s,!0)}).catch(s=>{r(s)})})}async requestToInspectImage(){this.sequence++;const t=Gs(this,ja.CLIENT_LOCAL_VIDEO_TRACK),r={appId:this._connectInfo.appId,cname:this._connectInfo.cname,cid:this._connectInfo.cid,sid:this._connectInfo.sid,uid:this._connectInfo.uid,vid:this._connectInfo.vid};if(t){if(!t.isPlaying)return void this.emit(ja.INSPECT_RESULT,void 0,new xe(se.INVALID_OPERATION,"Only the track being played can be inspected"));const s=await this.generateRequestData(t,r);this.workerConnection.sendMessage(s,!0,!0)}else this.emit(ja.INSPECT_RESULT,void 0,new xe(se.INVALID_OPERATION,"Only the track being published can be inspected"))}async generateRequestData(t,r){let{appId:s,cname:l,cid:f,vid:m,sid:E,uid:y}=r;const b=Date.now(),A=await t.getCurrentFrameImage("image/jpeg",this.quality),O=await Jx(A,s,l),D=this.sequence+"-"+f+"-"+y+"-"+b+"-"+Br(12,""),P={appId:s,cid:f,cname:l,deviceId:"",elapse:(F=Number(b-this.inspectStartTime),{low:F|=0,high:F>>31,unsigned:F>=0}),fileSize:O.byteLength,jpgEncryption:2,height:A.height,width:A.width,jpg:O,networkType:6,osType:7,requestId:D,sdkVersion:"4.23.4",sequence:this.sequence,sid:E,timestamp:d6(b),uid:y,vid:m,service:this._inspectMode,callbackData:this.extraInfo,ossFilePrefix:this.ossFilePrefix};var F;this.extraInfo===void 0&&delete P.callbackData,this.ossFilePrefix===void 0&&delete P.ossFilePrefix;const B=Y1(P);if(B.byteLength<this.workerMessageLengthLimit){if(me("SHOW_VIDEO_INSPECT_WORKER_MESSAGE")){const Y=function($){for(var ee=1;ee<arguments.length;ee++){var Ee=arguments[ee]!=null?arguments[ee]:{};ee%2?Ij(Object(Ee),!0).forEach(function(Re){ne($,Re,Ee[Re])}):Object.getOwnPropertyDescriptors?Object.defineProperties($,Object.getOwnPropertyDescriptors(Ee)):Ij(Object(Ee)).forEach(function(Re){Object.defineProperty($,Re,Object.getOwnPropertyDescriptor(Ee,Re))})}return $}({},P);delete Y.jpg,G.debug("[".concat(this._inspectId,"] Request message for worker of inspect content "),JSON.stringify(Y))}return B}{const Y=this.quality*this.qualityRatio;return this.quality=Y,await this.generateRequestData(t,{appId:s,cname:l,cid:f,vid:m,sid:E,uid:y})}}close(){this._cancelTokenSource.cancel(),this._cancelTokenSource=En.CancelToken.source(),this.workerManagerConnection&&this.workerManagerConnection.close(),this.workerConnection&&this.workerConnection.close(),this.inspectTimer&&window.clearInterval(this.inspectTimer),this.inspectTimer=null,this.connectionState=Hc.CLOSED,this.emit(ja.STATE_CHANGE,ru.CLOSED)}}const vK={name:"ContentInspect",create:function(e){let{config:t}=e;return function(r){if(!r)throw new xe(se.INVALID_PARAMS,"inspectConfig is necessary.");if(!r.inspectType||!Array.isArray(r.inspectType))throw new xe(se.INVALID_PARAMS,"inspectConfig.inspectType is necessary and is an instance of Array.");{const s=[...new Set(r.inspectType)];s.forEach(l=>{var f;if(!ht(f=["supervise","moderation"]).call(f,l))throw new xe(se.INVALID_PARAMS,"".concat(l," is not a valid inspect type."))}),r.inspectType=s}if(r&&r.extraInfo&&r.extraInfo.length>1024)throw new xe(se.INVALID_PARAMS,"inspectConfig.extraInfo length cannot exceed 1024 bytes")}(t),new EK(t)}};var ZD=T(Ii.Object.getOwnPropertySymbols),SK=pr,QF=Dm.indexOf,yK=Pm,$D=he([].indexOf),ZF=!!$D&&1/$D([1],1,-0)<0;SK({target:"Array",proto:!0,forced:ZF||!yK("indexOf")},{indexOf:function(e){var t=arguments.length>1?arguments[1]:void 0;return ZF?$D(this,e,t)||0:QF(this,e,t)}});var ri=il("Array","indexOf"),$F=Q,aE=ri,eP=Array.prototype,mf=function(e){var t=e.indexOf;return e===eP||$F(eP,e)&&t===eP.indexOf?aE:t},gf=T(mf);function e7(e,t){if(e==null)return{};var r,s,l=function(m,E){if(m==null)return{};var y={};for(var b in m)if({}.hasOwnProperty.call(m,b)){if(gf(E).call(E,b)!==-1)continue;y[b]=m[b]}return y}(e,t);if(ZD){var f=ZD(e);for(s=0;s<f.length;s++)r=f[s],gf(t).call(t,r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(l[r]=e[r])}return l}let Aj=class{get localCapabilities(){return Mn(this._localCapabilities)}get rtpCapabilities(){return Mn(this._rtpCapabilities)}get candidates(){return Mn(this._candidates)}get iceParameters(){return Mn(this._iceParameters)}get dtlsParameters(){return Mn(this._dtlsParameters)}constructor(e){ne(this,"sessionDesc",void 0),ne(this,"_localCapabilities",void 0),ne(this,"_rtpCapabilities",void 0),ne(this,"_candidates",void 0),ne(this,"_iceParameters",void 0),ne(this,"_dtlsParameters",void 0),ne(this,"setup",void 0),ne(this,"currentMidIndex",void 0),ne(this,"cname","o/i14u9pJrxRKAsu"),ne(this,"firefoxSsrcMidMap",new Map),e=Mn(e);const{remoteIceParameters:t,remoteDtlsParameters:r,candidates:s,remoteRTPCapabilities:l,localCapabilities:f,direction:m,setup:E,videoCodec:y,audioCodec:b}=e;let A;this.setup=E,A=m===Vi.RECEIVE_ONLY?on(`v=0
o=- 0 0 IN IP4 127.0.0.1
s=AgoraGateway
t=0 0
a=group:BUNDLE 0 1
a=msid-semantic: WMS
a=extmap-allow-mixed
m=video 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendonly
a=rtcp-mux
a=rtcp-rsize
a=mid:0
m=audio 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendonly
a=rtcp-mux
a=rtcp-rsize
a=mid:1
`):on(`v=0
o=- 0 0 IN IP4 127.0.0.1
s=AgoraGateway
t=0 0
a=group:BUNDLE 0 1
a=msid-semantic: WMS
a=extmap-allow-mixed
m=video 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=recvonly
a=rtcp-mux
a=rtcp-rsize
a=mid:0
m=audio 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=recvonly
a=rtcp-mux
a=rtcp-rsize
a=mid:1
`),this._rtpCapabilities=l,this._candidates=s,this._iceParameters=t,this._dtlsParameters=r,this._localCapabilities=f;const O=m===Vi.RECEIVE_ONLY?this.rtpCapabilities.send:this.rtpCapabilities.recv,D=m===Vi.RECEIVE_ONLY?this._localCapabilities.recv:this._localCapabilities.send,P=m===Vi.RECEIVE_ONLY?l.send.videoCodecs:p1(ut.VIDEO,O,D,y),F=m===Vi.RECEIVE_ONLY?l.send.audioCodecs:p1(ut.AUDIO,O,D,b);for(const B of A.mediaDescriptions)B.attributes.iceUfrag=t.iceUfrag,B.attributes.icePwd=t.icePwd,B.attributes.fingerprints=r.fingerprints,B.attributes.candidates=s,B.attributes.setup=this.setup,B.media.mediaType==="application"&&(B.attributes.sctpPort="5000"),B.media.mediaType==="video"&&(B.media.fmts=P.map(Y=>Y.payloadType.toString(10)),B.attributes.payloads=P,B.attributes.extmaps=O.videoExtensions),B.media.mediaType==="audio"&&(B.media.fmts=F.map(Y=>Y.payloadType.toString(10)),B.attributes.payloads=F,B.attributes.extmaps=O.audioExtensions,zg(B));this.sessionDesc=A,this.currentMidIndex=A.mediaDescriptions.length-1}toString(){return zr(this.sessionDesc)}hasMid(e){return Array.isArray(e)?e.every(t=>this.hasMid(t)):this.sessionDesc.mediaDescriptions.some(t=>t.attributes.mid===e)}send(e,t,r,s,l){r=r.replace(/ /g,"-");const{ssrcs:f,ssrcGroups:m}=H_(t,this.cname,me("SYNC_GROUP")?r:void 0),E=this.findPreloadMediaDesc(f);if(E){if(ei()&&this.firefoxSsrcMidMap.set(f[0].ssrcId,E.attributes.mid),l&&(l.twcc||l.remb)){const y=this.sessionDesc.mediaDescriptions.indexOf(E);return this.sessionDesc.mediaDescriptions[y]=this.mungSendMediaDesc(E,l),{mid:E.attributes.mid,needExchangeSDP:!0}}return{mid:E.attributes.mid,needExchangeSDP:!1}}{const y=this.findAvailableMediaIndex(e,f,s);let b;return y===-1?(b=this.createOrRecycleSendMedia(e,f,m,"sendonly",s,l),this.updateBundleMids()):(b=Mn(this.sessionDesc.mediaDescriptions[y]),b.attributes.direction="sendonly",b.attributes.ssrcs=f,b.attributes.ssrcGroups=m,this.sessionDesc.mediaDescriptions[y]=this.mungSendMediaDesc(b,l)),ei()&&this.firefoxSsrcMidMap.set(f[0].ssrcId,b.attributes.mid),{needExchangeSDP:!0,mid:b.attributes.mid}}}stopSending(e){const t=this.sessionDesc.mediaDescriptions.filter(r=>r.attributes.mid&&e.indexOf(r.attributes.mid)!==-1);if(t.length!==e.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.stopSending.");t.forEach(r=>{r.attributes.ssrcs=[]}),this.updateBundleMids()}receive(e,t,r){const s=[];return e.forEach(l=>{const f=l._mediaStreamTrack.kind,m=this.findAvailableRecvMediaIndex(f);let E,y=!1;m===-1?(y=!0,E=this.createOrRecycleRecvMedia(l,[],"recvonly",t,r),this.updateBundleMids()):(E=Mn(this.sessionDesc.mediaDescriptions[m]),E.attributes.direction="recvonly"),s.push({mid:E.attributes.mid,needCreateTransceiver:y})}),s}stopReceiving(e){const t=this.sessionDesc.mediaDescriptions.filter(r=>e.indexOf(r.attributes.mid)!==-1);if(t.length!==e.length)throw new Error("MediaDescriptions' length doesn't match mids's length when calling RemoteSDP.receive.");t.forEach(r=>{r.media.port="0",r.attributes.direction="inactive"}),this.updateBundleMids()}addRemoteCandidate(e){const{foundation:t,protocol:r,address:s,port:l,type:f,relatedAddress:m,relatedPort:E,priority:y}=new RTCIceCandidate(e),b={foundation:t??"",componentId:"1",transport:r??"",priority:y?y+"":"",connectionAddress:s??"",port:l?l+"":"",type:f?f+"":"",relAddr:m??"",relPort:E?E+"":"",extension:{}};this.candidates.some(A=>A.priority===b.priority&&A.connectionAddress===b.connectionAddress&&A.port===b.port)||(this._candidates.push(b),this.sessionDesc.mediaDescriptions.forEach(A=>{A.attributes.candidates=this.candidates}))}clearRemoteCandidate(){this._candidates=[],this.sessionDesc.mediaDescriptions[0].attributes.candidates=this._candidates}createOrRecycleRecvMedia(e,t,r,s,l){const f=e._mediaStreamTrack.kind,m=this.rtpCapabilities.recv,E=p1(f,m,this.localCapabilities.send,f===ut.AUDIO?l:s),y=f===ut.VIDEO?m.videoExtensions:m.audioExtensions,b="".concat(++this.currentMidIndex);let A={media:{mediaType:f,port:"9",protos:["UDP","TLS","RTP","SAVPF"],fmts:E.map(D=>D.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:[],extmaps:y,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:t,ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:E,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:r,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(b)}};A=this.mungRecvMediaDsec(A,e);const O=this.findFirstClosedMedia(f);if(O){const D=this.sessionDesc.mediaDescriptions.indexOf(O);this.sessionDesc.mediaDescriptions[D]=A}else this.sessionDesc.mediaDescriptions.push(A);return A}muteRemote(e){const t=this.sessionDesc.mediaDescriptions.filter(r=>ht(e).call(e,r.attributes.mid||""));if(t.length!==e.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");t.forEach(r=>{r.attributes.direction="inactive"})}unmuteRemote(e){const t=this.sessionDesc.mediaDescriptions.filter(r=>ht(e).call(e,r.attributes.mid||""));if(t.length!==e.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");t.forEach(r=>{r.attributes.direction="recvonly"})}findAvailableMediaIndex(e,t,r){return this.sessionDesc.mediaDescriptions.findIndex(s=>{const l=s.media.mediaType===e&&s.media.port!=="0"&&(s.attributes.direction==="sendonly"||s.attributes.direction==="sendrecv")&&s.attributes.ssrcs.length===0;if(ei()){if(l){const f=this.firefoxSsrcMidMap.get(t[0].ssrcId);return!(f||s.attributes.mid!=="0"&&s.attributes.mid!=="1")||!(!f||f!==s.attributes.mid)}return!1}return l&&s.attributes.mid===r})}findAvailableRecvMediaIndex(e){return this.sessionDesc.mediaDescriptions.findIndex(t=>{const r=t.media.mediaType===e&&t.media.port!=="0"&&(t.attributes.direction==="recvonly"||t.attributes.direction==="sendrecv");return t.attributes.mid!=="0"&&t.attributes.mid!=="1"&&r})}predictReceivingMids(e){const t=[];for(let r=0;r<e;r++)t.push((this.currentMidIndex+r+1).toString(10));return t}restartICE(e){e=Mn(e),this._iceParameters=e,this.sessionDesc.mediaDescriptions.forEach(t=>{t.attributes.iceUfrag=e.iceUfrag,t.attributes.icePwd=e.icePwd})}createOrRecycleSendMedia(e,t,r,s,l,f){const m=this.rtpCapabilities.send,E=e===ut.VIDEO?m.videoCodecs:m.audioCodecs,y=e===ut.VIDEO?m.videoExtensions:m.audioExtensions;ei()&&(l="".concat(++this.currentMidIndex));let b={media:{mediaType:e,port:"9",protos:["UDP","TLS","RTP","SAVPF"],fmts:E.map(O=>O.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:[],extmaps:y,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:t,ssrcGroups:r,rtcpFeedbackWildcards:[],payloads:E,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:s,rtcpMux:!0,rtcpRsize:!0,mid:l}};b=this.mungSendMediaDesc(b,f);const A=this.findFirstClosedMedia(e);if(A){const O=this.sessionDesc.mediaDescriptions.indexOf(A);this.sessionDesc.mediaDescriptions[O]=b}else this.sessionDesc.mediaDescriptions.push(b);return b}mungRecvMediaDsec(e,t,r){const s=Mn(e);return aD(s),xS(s,t),sD(s,t),RU(s),Wc(s,r,this.localCapabilities.send),s}mungSendMediaDesc(e,t){const r=Mn(e);return Wc(r,t,this.localCapabilities.recv),zg(r),r}updateRecvMedia(e,t){const r=this.sessionDesc.mediaDescriptions.findIndex(s=>s.attributes.mid===e);if(r!==-1){const s=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[r],t);this.sessionDesc.mediaDescriptions[r]=s}}updateBundleMids(){this.sessionDesc.attributes.groups[0].identificationTag=this.sessionDesc.mediaDescriptions.filter(e=>e.media.port!=="0").map(e=>e.attributes.mid)}findPreloadMediaDesc(e){return this.sessionDesc.mediaDescriptions.find(t=>{var r;return((r=t.attributes)===null||r===void 0||(r=r.ssrcs[0])===null||r===void 0?void 0:r.ssrcId)===e[0].ssrcId})}findFirstClosedMedia(e){return this.sessionDesc.mediaDescriptions.find(t=>ei()?t.media.port==="0"&&t.media.mediaType===e:t.media.port==="0")}};const t7=["sdp"];var Jr;function Oj(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),r.push.apply(r,s)}return r}function a0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Oj(Object(r),!0).forEach(function(s){ne(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Oj(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}let Nj=(Jr=class dP extends af{get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get dtlsTransportState(){var t,r;return(t=(r=this.peerConnection.getReceivers()[0])===null||r===void 0||(r=r.transport)===null||r===void 0?void 0:r.state)!==null&&t!==void 0?t:null}get localCodecs(){return[]}set isInRestartIce(t){this._isInRestartIce=t}get isInRestartIce(){return this._isInRestartIce}constructor(t,r,s){super(t,r),ne(this,"direction",void 0),ne(this,"name",void 0),ne(this,"store",void 0),ne(this,"spec",void 0),ne(this,"peerConnection",void 0),ne(this,"initialOffer",void 0),ne(this,"transport",void 0),ne(this,"statsFilter",void 0),ne(this,"localCandidateCount",0),ne(this,"_isInRestartIce",!1),ne(this,"mutex",void 0),ne(this,"onLocalCandidate",void 0),ne(this,"remoteSDP",void 0),ne(this,"pendingCandidates",[]),ne(this,"localCapabilities",void 0),ne(this,"isReady",!1),ne(this,"restartCnt",0),ne(this,"curTurnServerIndex",0),this.store=r,this.spec=t,this.mutex=new Gi("P2PConnection-mutex",r.clientId),this.peerConnection=new RTCPeerConnection(dP.resolvePCConfiguration(t,r.p2pTransport),{optional:[{googDscp:!0}]}),this.direction=s??Vi.SEND_ONLY,this.name=this.direction===Vi.SEND_ONLY?"sendP2PConnection":"recvP2PConnection",this.statsFilter=Sr(this.peerConnection,me("STATS_UPDATE_INTERVAL"),void 0,ei()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1}async establish(t){try{const r=await IU();if(this.localCapabilities=NI(r),t){const{sdp:s}=t,l=e7(t,t7),f=function(){const A={audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]},O=z_(arguments.length>2?arguments[2]:void 0,arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},"sendonly"),D={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},P={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},F={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]};if(ao(O,A,"videoExtensions",D,P,F),ao(O,A,"videoCodecs",D,P,F),ao(O,A,"audioExtensions",D,P,F),ao(O,A,"audioCodecs",D,P,F),me("RAISE_H264_BASELINE_PRIORITY")){const B=F.videoCodecs.findIndex(Y=>Y.rtpMap&&Y.rtpMap.encodingName.toLocaleLowerCase()==="h264"&&Y.fmtp&&Y.fmtp.parameters["profile-level-id"]==="42001f");if(B!==-1){const Y=F.videoCodecs.findIndex($=>$.rtpMap&&$.rtpMap.encodingName.toLocaleLowerCase()==="h264");if(Y<B){G.debug("raising H264 baseline profile priority");const $=F.videoCodecs[B];F.videoCodecs.splice(B,1),F.videoCodecs.splice(Y,0,$)}Y!==-1&&me("FILTER_SEND_H264_BASELINE")&&(D.videoCodecs=D.videoCodecs.filter($=>!($.rtpMap&&$.rtpMap.encodingName.toLocaleLowerCase()==="h264"&&$.fmtp&&$.fmtp.parameters["profile-level-id"]!=="42001f")))}}return{send:D,recv:P,sendrecv:F}}({},{},s);this.remoteSDP=new Aj({remoteIceParameters:l.iceParameters,remoteDtlsParameters:l.dtlsParameters,candidates:[],remoteRTPCapabilities:f,localCapabilities:this.localCapabilities,direction:this.direction,setup:"actpass",videoCodec:this.store.codec,audioCodec:this.store.audioCodec}),await this.setRemoteDescription({type:"offer",sdp:this.remoteSDP.toString()}),this.isReady=!0;const m=await this.peerConnection.createAnswer();if(!m.sdp)throw new Error("Cannot get answer sdp when trying to establish PeerConnection.");const E=ou(m.sdp);await this.peerConnection.setLocalDescription(m);const y=await Gg({},{},m.sdp);this.localCapabilities=NI(y);const b=this.peerConnection.getTransceivers()[0];return b!=null&&b.receiver&&b.receiver.transport&&this.tryBindTransportEvents(b.receiver.transport),a0(a0({},E),{},{sdp:m.sdp})}{this.peerConnection.addTransceiver("video",{direction:"sendonly"}),this.peerConnection.addTransceiver("audio",{direction:"sendonly"});const s=await this.peerConnection.createOffer();if(!s.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const l=ou(s.sdp);return this.initialOffer=s,a0(a0({},l),{},{sdp:s.sdp})}}catch(r){throw new Ke(se.GET_LOCAL_CONNECTION_PARAMS_FAILED,r.toString())}}async connect(t){try{if(!this.initialOffer)throw new Error("Cannot establish P2PConnection without initial offer.");await this.peerConnection.setLocalDescription(this.initialOffer);const{sdp:r,iceParameters:s,dtlsParameters:l}=t,f=await Gg({},{},r);this.remoteSDP=new Aj({remoteIceParameters:s,remoteDtlsParameters:l,candidates:[],remoteRTPCapabilities:f,localCapabilities:this.localCapabilities,direction:this.direction,setup:"active",videoCodec:this.store.codec,audioCodec:this.store.audioCodec}),await this.setRemoteDescription({type:"answer",sdp:this.remoteSDP.toString()});const m=this.peerConnection.getTransceivers()[0];m!=null&&m.sender&&m.sender.transport&&this.tryBindTransportEvents(m.sender.transport)}catch(r){throw new Ke(se.EXCHANGE_SDP_FAILED,"P2PConnection.connect failed; ".concat(r.toString()))}}async addRemoteCandidate(t){try{t&&this.pendingCandidates.push(t),this.peerConnection.remoteDescription&&this.isReady&&(this.pendingCandidates.forEach(r=>{this.peerConnection.addIceCandidate(r)}),this.pendingCandidates=[])}catch(r){throw new Ke(se.ADD_CANDIDATE_FAILED,"P2PConnection.addRemoteCandidate failed; ".concat(r.toString()))}}send(t,r,s){var l=this;return $l(function*(){const f=yield xn(l.mutex.lock("From P2PConnection.send"));try{if(!l.remoteSDP)throw new Error("Cannot call P2PConnection.send before remote SDP created");const m=[],E=l.remoteSDP.receive(t,r,s);t.forEach((Y,$)=>{if(E[$].needCreateTransceiver){const ee=l.peerConnection.addTransceiver(Y._mediaStreamTrack,{direction:"sendonly"});m.push(ee),Y._updateRtpTransceiver(ee)}else{const ee=l.peerConnection.getTransceivers().find(Ee=>Ee.mid===E[$].mid);if(!ee)throw new Error("cannot find transceiver when sendPeerconnection send, mid is ".concat(E[$].mid));m.push(ee),Y._updateRtpTransceiver(ee)}}),ei()&&me("SIMULCAST")===!0&&(yield xn(l.applySimulcastForFirefox(m,t)));const y=E.map(Y=>Y.mid),b=yield xn(l.peerConnection.createOffer()),A=l.mungSendOfferSDP(b.sdp,t,y),O=on(A),D=y.map(Y=>{const $=O.mediaDescriptions.find(ee=>ee.attributes.mid===Y);if(!$)throw new Error("Cannot extract ssrc from mediaDescription.");return f1($,me("USE_PUB_RTX"))}),P=m.map((Y,$)=>{const ee=y[$];return{localSSRC:D[$],id:ee}});yield xn(l.peerConnection.setLocalDescription({type:"offer",sdp:A}));try{yield P}catch(Y){const $=l.remoteSDP.toString();throw yield xn(l.peerConnection.setLocalDescription({type:"offer",sdp:A})),yield xn(l.peerConnection.setRemoteDescription({type:"answer",sdp:$})),yield xn(l.stopSending(y,!0)),Y}yield xn(l.applySimulcastEncodings(m,t)),yield xn(l.applySendEncodings(m,t));const F=l.remoteSDP.toString(),B=l.logSDPExchange(A,"offer","local","send");return B==null||B(F),yield xn(l.setRemoteDescription({type:"answer",sdp:F})),m.map((Y,$)=>{const ee=y[$];return{localSSRC:D[$],id:ee}})}catch(m){throw m instanceof Ke?m:new Ke(se.EXCHANGE_SDP_FAILED,"P2PConnection.send failed; ".concat(m.toString()))}finally{f()}})()}async stopSending(t,r){const s=r?void 0:await this.mutex.lock("From P2PConnection.stopSending");try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopSending before remote SDP created");const l=this.peerConnection.getTransceivers().filter(y=>t.indexOf(y.mid)!==-1);if(l.length!==t.length)throw new Error("Transceivers' length (".concat(l.length,") doesn't match mids' length (").concat(t.length,") when trying to call P2PConnection.stopSending."));l.map(y=>{var b;y.direction="inactive",(b=y.stop)===null||b===void 0||b.call(y)});const f=await this.peerConnection.createOffer(),m=this.logSDPExchange(f.sdp||"","offer","local","stopSending");await this.peerConnection.setLocalDescription(f),this.remoteSDP.stopReceiving(t);const E=this.remoteSDP.toString();m==null||m(E),await this.setRemoteDescription({type:"answer",sdp:E})}catch(l){throw new Ke(se.EXCHANGE_SDP_FAILED,"P2PConnection.stopSending failed; ".concat(l.toString()))}finally{s&&s()}}async receive(t,r,s,l){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(t," before remoteSDP created."));const{mid:f,needExchangeSDP:m}=this.remoteSDP.send(t,r,s,l);if(m){const y=this.remoteSDP.toString(),b=this.logSDPExchange(y,"offer","remote","receive");await this.setRemoteDescription({type:"offer",sdp:y});const A=await this.peerConnection.createAnswer(),O=this.mungReceiveAnswerSDP(A.sdp,f,t);b==null||b(O||""),await this.peerConnection.setLocalDescription({type:"answer",sdp:O}),G.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(t," by exchanging SDP."))}else G.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(t," no need to exchange SDP."));const E=this.peerConnection.getTransceivers().find(y=>y.mid===f);if(!E||E.mid===null)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:E.receiver.track,mid:E.mid,transceiver:E}}catch(f){throw new Ke(se.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(f.toString()))}}async mockReceive(t,r,s,l){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(t," before remoteSDP created."));const{mid:f,needExchangeSDP:m}=this.remoteSDP.send(t,r,s,l);if(m){const E=this.remoteSDP.toString(),y=this.logSDPExchange(E,"offer","remote","receive");await this.setRemoteDescription({type:"offer",sdp:E});const b=await this.peerConnection.createAnswer(),A=this.mungReceiveAnswerSDP(b.sdp,f,t);y==null||y(A||""),await this.peerConnection.setLocalDescription({type:"answer",sdp:A}),G.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(t," by exchanging SDP."))}else G.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(t," no need to exchange SDP."))}catch(f){throw new Ke(se.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(f.toString()))}}async stopReceiving(t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");this.remoteSDP.stopSending(t);const r=this.remoteSDP.toString(),s=this.logSDPExchange(r,"offer","remote","stopReceiving");await this.setRemoteDescription({type:"offer",sdp:r});const l=await this.peerConnection.createAnswer();s==null||s(l.sdp||""),await this.peerConnection.setLocalDescription(l)}catch(r){throw new Ke(se.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(r.toString()))}}async restartICE(t){try{if(this.store.p2pTransport===Gp.Auto&&(this.store.p2pTransport=Gp.SdRtn,zn().supportPCSetConfiguration&&this.peerConnection.setConfiguration(dP.resolvePCConfiguration(this.spec,this.store.p2pTransport))),this.restartCnt>3&&(this.restartCnt=0,zn().supportPCSetConfiguration&&this.peerConnection.setConfiguration(dP.resolvePCConfiguration(this.spec,this.store.p2pTransport,++this.curTurnServerIndex))),!t){this.restartCnt++,this.isReady=!1;const r=await this.peerConnection.createOffer({iceRestart:!0});if(!r.sdp)throw new Error("Cannot restartICE because restart offer SDP does not exist.");const{iceParameters:s}=ou(r.sdp);return this.store.descriptionStart(),this.direction===Vi.SEND_ONLY&&await this.peerConnection.setLocalDescription(r),s}if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");if(this.remoteSDP.restartICE(t),this.store.descriptionStart(),this.direction===Vi.RECEIVE_ONLY){this.restartCnt++,await this.setRemoteDescription({type:"offer",sdp:this.remoteSDP.toString()});const r=await this.peerConnection.createAnswer();if(!r.sdp)throw new Error("Cannot get answer sdp when trying to iceRestart.");const{iceParameters:s}=ou(r.sdp);return await this.peerConnection.setLocalDescription(r),s}await this.setRemoteDescription({type:"answer",sdp:this.remoteSDP.toString()}),this.isReady=!0}catch(r){throw new Ke(se.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(r.toString()))}}close(){var t;this.peerConnection.close(),this.peerConnection.onicecandidate=null,(t=this.onConnectionStateChange)===null||t===void 0||t.call(this,"closed"),this.tryUnbindTransportEvents(),this.unbindPCEvents(),this.unbindStatsEvents(),this.transport=void 0,this.statsFilter.destroy()}getStats(){return this.statsFilter.getStats()}getRemoteVideoIsReady(t){return this.statsFilter.getVideoIsReady(t)}async updateEncoderConfig(t,r){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateEncoderConfig before remote SDP created.");const s=await this.peerConnection.createOffer(),l=this.mungSendOfferSDP(s.sdp,[r],[t]);this.remoteSDP.updateRecvMedia(t,r);const f=this.remoteSDP.toString(),m=this.logSDPExchange(l,"offer","local","updateEncoderConfig");await this.peerConnection.setLocalDescription({type:"offer",sdp:l}),m==null||m(f),await this.peerConnection.setRemoteDescription({type:"answer",sdp:f})}catch(s){throw new Ke(se.EXCHANGE_SDP_FAILED,s.toString())}}async updateSendParameters(t,r){const s=this.peerConnection.getTransceivers().filter(l=>l.mid===t);s.length===1&&(this.isVP8Simulcast(r)?ei()||await this.applySimulcastEncodings(s,[r]):await this.applySendEncodings(s,[r]))}setStatsRemoteVideoIsReady(t,r){this.statsFilter.setVideoIsReady2(t,r)}async replaceTrack(t,r){const s=this.peerConnection.getTransceivers().find(l=>l.mid===r);s&&await s.sender.replaceTrack(t._mediaStreamTrack)}async getSelectedCandidatePair(){const t=this.peerConnection.getReceivers();if(t.length>0&&t[0].transport&&t[0].transport.iceTransport&&t[0].transport.iceTransport.getSelectedCandidatePair&&t[0].transport.iceTransport.getSelectedCandidatePair()){const r=t[0].transport.iceTransport,{local:s,remote:l}=r.getSelectedCandidatePair();return{local:a0(a0({},vl),{},{candidateType:s.type,protocol:s.protocol,address:s.address,port:s.port}),remote:a0(a0({},vl),{},{candidateType:l.type,protocol:l.protocol,address:l.address,port:l.port})}}return this.statsFilter.getSelectedCandidatePair()}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var t,r;ht(t=["connected","completed"]).call(t,this.peerConnection.iceConnectionState)&&(this.isReady=!1),(r=this.onICEConnectionStateChange)===null||r===void 0||r.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var t;this.peerConnection.connectionState==="connected"&&(this.restartCnt=0),(t=this.onConnectionStateChange)===null||t===void 0||t.call(this,this.peerConnection.connectionState)},this.startICECandidate()}startICECandidate(){this.peerConnection.onicecandidate||(this.localCandidateCount=0,this.peerConnection.onicecandidate=t=>{if(t.candidate){var r;t.candidate.candidate&&((r=this.onLocalCandidate)===null||r===void 0||r.call(this,t.candidate.toJSON())),this.localCandidateCount+=1}else G.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount)})}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(t,r){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const l={iceServers:[]};var f;return t.iceServers?l.iceServers=t.iceServers:t.turnServer&&t.turnServer.mode!=="off"&&(ki(t.turnServer.servers)?l.iceServers=t.turnServer.servers:(l.iceServers&&l.iceServers.push(...dP.turnServerConfigToIceServers(t.turnServer.servers,r,s)),me("USE_TURN_SERVER_OF_GATEWAY")&&l.iceServers&&t.turnServer.serversFromGateway&&l.iceServers.push(...dP.turnServerConfigToIceServers(t.turnServer.serversFromGateway,r,s)),ht(f=[Gp.Relay,Gp.SdRtn]).call(f,r)&&(l.iceTransportPolicy="relay"),me("FORCE_TURN_TCP")?l.iceTransportPolicy="relay":t.turnServer.servers.concat(t.turnServer.serversFromGateway||[]).forEach(m=>{m.forceturn&&(l.iceTransportPolicy="relay")}))),me("ENABLE_ENCODED_TRANSFORM")&&zn().supportWebRTCEncodedTransform&&(l.encodedInsertableStreams=!0),G.debug("P2PConnection p2pTransport is ".concat(r)),l}static turnServerConfigToIceServers(t,r){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const l=[],f=t.filter(E=>E.tcpport);G.debug("P2PConnection turnServers is ".concat(f,", current index is ").concat(s));const m=f.length>s?f[s]:f[0];switch(r){case Gp.SdRtn:const E=t.filter(b=>{var A;return ht(A=b.username).call(A,"glb:")&&b.turnServerURL==b.turnServerURL}),y=E.length>s?E[s]:E[0];y&&(l.push({username:y.username,credential:y.password,credentialType:"password",urls:"turn:".concat(jg(y.turnServerURL),":").concat(y.tcpport,"?transport=udp")}),l.push({username:y.username,credential:y.password,credentialType:"password",urls:"turns:".concat(jg(y.turnServerURL),":").concat(y.tcpport,"?transport=tcp")}));break;case Gp.Relay:m&&(l.push({username:m.username,credential:m.password,credentialType:"password",urls:"turn:".concat(m.turnServerURL,":").concat(m.tcpport,"?transport=udp")}),l.push({username:m.username,credential:m.password,credentialType:"password",urls:"turns:".concat(jg(m.turnServerURL),":").concat(m.tcpport,"?transport=tcp")}));break;default:m&&(l.push({username:m.username,credential:m.password,credentialType:"password",urls:"turn:".concat(m.turnServerURL,":").concat(m.tcpport,"?transport=udp")}),l.push({username:m.username,credential:m.password,credentialType:"password",urls:"turns:".concat(jg(m.turnServerURL),":").concat(m.tcpport,"?transport=tcp")}),l.push({username:m.username,credential:m.password,credentialType:"password",urls:"stun:".concat(m.turnServerURL,":").concat(m.tcpport)}))}return l}tryBindTransportEvents(t){if(t){this.transport=t,t.onstatechange=()=>{var s;t!=null&&t.state&&((s=this.onDTLSTransportStateChange)===null||s===void 0||s.call(this,t.state))},t.onerror=s=>{var l;(l=this.onDTLSTransportError)===null||l===void 0||l.call(this,"error"in s?s.error:s)};const r=t.iceTransport;r&&(r.onstatechange=()=>{const s=t==null?void 0:t.iceTransport.state;var l;s&&((l=this.onICETransportStateChange)===null||l===void 0||l.call(this,s))},r.getSelectedCandidatePair&&(r.onselectedcandidatepairchange=()=>{if(r.getSelectedCandidatePair()){const{local:s,remote:l}=r.getSelectedCandidatePair();G.info("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] selectedcandidatepairchange: local ").concat(JSON.stringify({candidateType:s.type,protocol:s.protocol}),", remote ").concat(JSON.stringify({candidateType:l.type,protocol:l.protocol,address:l.address,port:l.port})," )"))}}))}}tryUnbindTransportEvents(){this.transport&&(this.transport.onstatechange=null,this.transport.onerror=null,this.transport.iceTransport&&(this.transport.iceTransport.onstatechange=null))}async updateRtpSenderEncodings(t,r){var s;if(r||(r=this.peerConnection.getSenders().find(A=>A.track===t._mediaStreamTrack)),!r)return G.warn("[".concat(t.getTrackId(),"] no rtpSender found}"));if(this.isVP8Simulcast(t))return G.warn("[updateRtpSenderEncodings] Track is VP8 simulcast, please apply simulcast encodings");if(!zn().supportSetRtpSenderParameters)return G.warn("[updateRtpSenderEncodings] Browser not support set rtp-sender parameters");const l={},f={};switch(t._optimizationMode){case"motion":l.degradationPreference="maintain-framerate";break;case"detail":l.degradationPreference="maintain-resolution";break;default:l.degradationPreference="balanced"}if(t._encoderConfig){var m;const{bitrateMax:A,frameRate:O,scaleResolutionDownBy:D}=t._encoderConfig;A&&(f.maxBitrate=1e3*A),ht(m=t._hints).call(m,xr.LOW_STREAM)&&(O&&(f.maxFramerate=Co(O)),D&&D>=1&&(f.scaleResolutionDownBy=D))}if(me("DSCP_TYPE")&&fh()){var E;const A=me("DSCP_TYPE");ht(E=["very-low","low","medium","high"]).call(E,A)&&(f.networkPriority=A)}const y=r.getParameters(),b=(s=y.encodings)===null||s===void 0?void 0:s[0];ei()&&!b&&(l.encodings=[f]),b&&Object.assign(b,f),Object.assign(y,l),G.debug("[".concat(t.getTrackId(),"] updateRtpSenderEncodings: ").concat(JSON.stringify(y.encodings))),await r.setParameters(y)}async applySendEncodings(t,r){try{if(!zn().supportSetRtpSenderParameters||t.length!==r.length)return;for(let s=0;s<t.length;s++){const l=t[s],f=r[s];f instanceof Kr&&!this.isVP8Simulcast(f)&&await this.updateRtpSenderEncodings(f,l.sender)}}catch{G.debug("[".concat(this.store.clientId,"] Apply RTPSendEncodings failed."))}}mungSendOfferSDP(t,r,s){const l=on(t);return r.forEach((f,m)=>{const E=s[m],y=l.mediaDescriptions.find(b=>b.attributes.mid===E);y&&(xS(y,f),Y8(y,f,this.store.codec))}),zr(l)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=t=>{var r;(r=this.onFirstAudioReceived)===null||r===void 0||r.call(this,t)},this.statsFilter.onFirstVideoReceived=t=>{var r;(r=this.onFirstVideoReceived)===null||r===void 0||r.call(this,t)},this.statsFilter.onFirstAudioDecoded=t=>{var r;(r=this.onFirstAudioDecoded)===null||r===void 0||r.call(this,t)},this.statsFilter.onFirstVideoDecoded=(t,r,s)=>{var l;(l=this.onFirstVideoDecoded)===null||l===void 0||l.call(this,t,r,s)},this.statsFilter.onSelectedLocalCandidateChanged=(t,r)=>{var s;(s=this.onSelectedLocalCandidateChanged)===null||s===void 0||s.call(this,t,r)},this.statsFilter.onSelectedRemoteCandidateChanged=(t,r)=>{var s;(s=this.onSelectedRemoteCandidateChanged)===null||s===void 0||s.call(this,t,r)},this.statsFilter.onFirstVideoDecodedTimeout=t=>{var r;(r=this.onFirstVideoDecodedTimeout)===null||r===void 0||r.call(this,t)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0,this.statsFilter.onFirstVideoDecodedTimeout=void 0}async applySimulcastForFirefox(t,r){if(t.length===r.length)for(let y=0;y<t.length;y++){var s,l,f,m,E;const b=t[y],A=r[y];if(A instanceof Kr&&!ht(s=A._hints).call(s,xr.LOW_STREAM)&&(l=A._encoderConfig)!==null&&l!==void 0&&l.bitrateMax&&((f=A._encoderConfig)===null||f===void 0?void 0:f.bitrateMax)>200&&(m=A._scalabilityMode)!==null&&m!==void 0&&m.numSpatialLayers&&((E=A._scalabilityMode)===null||E===void 0?void 0:E.numSpatialLayers)>1&&this.store.codec==="vp8"){const O={},D={high:1e3*(A._encoderConfig.bitrateMax-50),medium:5e4};O.encodings=[{rid:"m",active:!0,maxBitrate:D.medium,scaleResolutionDownBy:4},{rid:"h",active:!0,maxBitrate:D.high}];const P=b.sender.getParameters();await b.sender.setParameters(Object.assign(P,O))}}}async applySimulcastEncodings(t,r){if(!ei()&&t.length===r.length)for(let s=0;s<t.length;s++){const l=r[s];if(l instanceof Kr&&this.isVP8Simulcast(l)){const f=t[s],m={},E={high:1e3*(l._encoderConfig.bitrateMax-50),medium:5e4};m.encodings=[{active:!0,adaptivePtime:!1,networkPriority:"high",priority:"high",maxBitrate:E.high},{active:!0,adaptivePtime:!1,networkPriority:"low",priority:"low",maxBitrate:E.medium,scaleResolutionDownBy:4}];const y=f.sender.getParameters();await f.sender.setParameters(Object.assign(y,m))}}}isVP8Simulcast(t){var r,s,l,f,m;return!!(t instanceof Kr&&me("SIMULCAST")&&this.store.codec==="vp8"&&!ht(r=t._hints).call(r,xr.LOW_STREAM)&&(s=t._encoderConfig)!==null&&s!==void 0&&s.bitrateMax&&((l=t._encoderConfig)===null||l===void 0?void 0:l.bitrateMax)>200&&(f=t._scalabilityMode)!==null&&f!==void 0&&f.numSpatialLayers&&((m=t._scalabilityMode)===null||m===void 0?void 0:m.numSpatialLayers)>1)}logSDPExchange(t,r,s,l){if(me("SDP_LOGGING"))return G.upload("[".concat(this.store.clientId,"] exchanging ").concat(s," ").concat(r," SDP during P2PConnection.").concat(l,`
`),t),r==="offer"?f=>{this.logSDPExchange(f,"answer",s==="local"?"remote":"local",l)}:void 0}async muteLocal(t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteLocal before remote SDP created.");const r=this.peerConnection.getTransceivers().filter(m=>m.mid&&t.indexOf(m.mid)!==-1);if(r.length!==t.length)throw new Error("Transceivers' length doesn't match mids' length.");r.map(m=>{m.direction="inactive"});const s=await this.peerConnection.createOffer(),l=this.logSDPExchange(s.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(s),this.remoteSDP.muteRemote(t);const f=this.remoteSDP.toString();l==null||l(f),await this.setRemoteDescription({type:"answer",sdp:f})}catch(r){throw new Ke(se.EXCHANGE_SDP_FAILED,"P2PConnection.muteLocal failed; ".concat(r.toString()))}}async unmuteLocal(t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteLocal before remote SDP created.");const r=this.peerConnection.getTransceivers().filter(m=>m.mid&&t.indexOf(m.mid)!==-1);if(r.length!==t.length)throw new Error("Transceivers' length doesn't match mids' length.");r.map(async m=>{m.direction="sendonly"});const s=await this.peerConnection.createOffer(),l=this.logSDPExchange(s.sdp||"","offer","local","unmuteLocal");await this.peerConnection.setLocalDescription(s),this.remoteSDP.unmuteRemote(t);const f=this.remoteSDP.toString();l==null||l(f),await this.setRemoteDescription({type:"answer",sdp:f})}catch(r){throw new Ke(se.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteLocal failed; ".concat(r.toString()))}}async getRemoteSSRC(t,r){var s;if(r=r??((s=this.currentRemoteDescription)===null||s===void 0?void 0:s.sdp)){var l;const f=(l=on(r).mediaDescriptions.find(m=>m.attributes.mid===t))===null||l===void 0?void 0:l.attributes.ssrcs;return f==null?void 0:f[0].ssrcId}}async setRemoteDescription(t){var r;await this.peerConnection.setRemoteDescription(t),ht(r=["connected","completed"]).call(r,this.peerConnection.iceConnectionState)||(this.isReady=!0,this.addRemoteCandidate())}mungReceiveAnswerSDP(t,r,s){const l=on(t),f=l.mediaDescriptions.find(m=>m.attributes.mid===r);return f&&s===ut.AUDIO&&f.media.mediaType==="audio"&&zg(f),zr(l)}},Ot(Jr.prototype,"establish",[fu],Object.getOwnPropertyDescriptor(Jr.prototype,"establish"),Jr.prototype),Ot(Jr.prototype,"connect",[fu],Object.getOwnPropertyDescriptor(Jr.prototype,"connect"),Jr.prototype),Ot(Jr.prototype,"receive",[fu],Object.getOwnPropertyDescriptor(Jr.prototype,"receive"),Jr.prototype),Ot(Jr.prototype,"mockReceive",[fu],Object.getOwnPropertyDescriptor(Jr.prototype,"mockReceive"),Jr.prototype),Ot(Jr.prototype,"stopReceiving",[fu],Object.getOwnPropertyDescriptor(Jr.prototype,"stopReceiving"),Jr.prototype),Ot(Jr.prototype,"restartICE",[fu],Object.getOwnPropertyDescriptor(Jr.prototype,"restartICE"),Jr.prototype),Ot(Jr.prototype,"close",[fu],Object.getOwnPropertyDescriptor(Jr.prototype,"close"),Jr.prototype),Ot(Jr.prototype,"updateEncoderConfig",[fu],Object.getOwnPropertyDescriptor(Jr.prototype,"updateEncoderConfig"),Jr.prototype),Ot(Jr.prototype,"updateSendParameters",[fu],Object.getOwnPropertyDescriptor(Jr.prototype,"updateSendParameters"),Jr.prototype),Ot(Jr.prototype,"replaceTrack",[fu],Object.getOwnPropertyDescriptor(Jr.prototype,"replaceTrack"),Jr.prototype),Ot(Jr.prototype,"muteLocal",[fu],Object.getOwnPropertyDescriptor(Jr.prototype,"muteLocal"),Jr.prototype),Ot(Jr.prototype,"unmuteLocal",[fu],Object.getOwnPropertyDescriptor(Jr.prototype,"unmuteLocal"),Jr.prototype),Jr);function fu(e,t,r){const s=e[t];if(typeof s!="function")throw new Error("Cannot use mutex on object property.");return r.value=async function(){const l=this.mutex,f=await l.lock("From P2PConnection.".concat(t));try{for(var m=arguments.length,E=new Array(m),y=0;y<m;y++)E[y]=arguments[y];return await s.apply(this,E)}finally{f()}},r}let _f=function(e){return e.SEND_ONLY="SEND_ONLY",e.RECEIVE_ONLY="RECEIVE_ONLY",e}({});var Lj,Dj,pi,Pj,yA,n7,Ef,sE,r7,i7,Mj,mi;function a7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),r.push.apply(r,s)}return r}function Or(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?a7(Object(r),!0).forEach(function(s){ne(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a7(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}let s7=(Lj=hd(_f.SEND_ONLY),Dj=hd(_f.SEND_ONLY),pi=hd(),Pj=hd(_f.RECEIVE_ONLY),yA=hd(_f.RECEIVE_ONLY),n7=hd(_f.RECEIVE_ONLY),Ef=hd(_f.RECEIVE_ONLY),sE=hd(_f.RECEIVE_ONLY),r7=hd(_f.RECEIVE_ONLY),i7=hd(),Mj=hd(_f.RECEIVE_ONLY),mi=class extends Xt{get state(){return this._state}set state(e){const t=this._state;this._state=e,this.emit(Yt.StateChange,t,this._state)}constructor(e,t){super(),ne(this,"isPlanB",!1),ne(this,"store",void 0),ne(this,"statsUploader",void 0),ne(this,"sendConnection",void 0),ne(this,"recvConnection",void 0),ne(this,"localTrackMap",new Map),ne(this,"remoteUserMap",new Map),ne(this,"localDataChannels",[]),ne(this,"pendingLocalTracks",[]),ne(this,"pendingRemoteTracks",[]),ne(this,"statsCollector",void 0),ne(this,"dtlsFailedCount",0),ne(this,"sendMutex",void 0),ne(this,"recvMutex",void 0),ne(this,"_state",Qn.Disconnected),ne(this,"_restartStates",["disconnected","failed"]),ne(this,"reconnectInterval",void 0),ne(this,"uploadUnplinkStarted",!1),ne(this,"uploadDownlinkStarted",!1),ne(this,"uplinkStateUploadInterval",void 0),ne(this,"downlinkStatsUploadInterval",void 0),ne(this,"handleMuteLocalTrack",async(r,s,l)=>{const f=await this.sendMutex.lock("Locking from P2PChannel2.handleMuteLocalTrack");try{if(!this.sendConnection||this.state!==Qn.Connected)return void l(new Ke(se.INVALID_OPERATION,"Cannot call P2PChannel2.handleMuteLocalTrack before sendConnection established."));const y=this.filterTobeMutedTracks(r);if(y.length===0)return void s();const b=y.find(P=>P[0]==="videoLowTrack");b&&b[1].track._originMediaStreamTrack.stop(),await this.sendConnection.muteLocal(y.map(P=>{let[,{id:F}]=P;return F}));let A=!1;var m,E;r.trackMediaType==="video"?A=!((m=this.localTrackMap.get(at.LocalAudioTrack))===null||m===void 0||!m.track._muted):A=((E=this.localTrackMap.get(at.LocalVideoTrack))===null||E===void 0?void 0:E.id)===void 0;const O=this.createMuteMessage(y);await fr(this,Yt.RequestMuteLocal,O);const D=r.trackMediaType==="video"?Ug.MUTE_LOCAL_VIDEO:Ug.MUTE_LOCAL_AUDIO;await fr(this,Yt.RequestP2PMuteLocal,{action:D,message:O,isMuteAll:A}),s()}catch(y){l(y)}finally{f()}}),ne(this,"handleUnmuteLocalTrack",async(r,s,l)=>{const f=await this.sendMutex.lock("Locking from P2PChannel2.handleUnmuteLocalTrack");try{if(!this.sendConnection||this.state!==Qn.Connected)return void l(new Ke(se.INVALID_OPERATION,"Cannot call P2PChannel2.handleUnmuteLocalTrack before sendConnection established."));const m=this.filterTobeUnmutedTracks(r);if(m.length===0)return void s();await this.sendConnection.unmuteLocal(m.map(b=>{let[,{id:A}]=b;return A}));const E=this.createUnmuteMessage(m),y=r.trackMediaType==="video"?Ug.UNMUTE_LOCAL_VIDEO:Ug.UNMUTE_LOCAL_AUDIO;await fr(this,Yt.RequestP2PMuteLocal,{action:y,message:E}),s()}catch(m){l(m)}finally{f()}}),ne(this,"handleUpdateVideoEncoder",async(r,s,l,f)=>{let m;typeof f=="boolean"&&f||(m=await this.sendMutex.lock("Locking from P2PChannel2.handleUpdateVideoEncoder"));try{const y=this.localTrackMap.get(at.LocalVideoTrack);if(!this.sendConnection||!y||y.track!==r||this.state!==Qn.Connected)return void s();const{id:b,track:A}=y;b&&(await this.sendConnection.updateSendParameters(b,A),await this.sendConnection.updateEncoderConfig(b,A),this.emit(Yt.UpdateVideoEncoder,A)),s()}catch(y){l(y)}finally{var E;(E=m)===null||E===void 0||E()}}),ne(this,"handleUpdateVideoSendParameters",async(r,s,l)=>{const f=await this.sendMutex.lock("Locking from P2PChannel2.handleUpdateVideoSendParameters");try{const m=this.localTrackMap.get(at.LocalVideoTrack);if(!this.sendConnection||!m||m.track!==r||this.state!==Qn.Connected)return void s();const{id:E,track:y}=m;E&&await this.sendConnection.updateSendParameters(E,y),s()}catch(m){l(m)}finally{f()}}),ne(this,"handleReplaceTrack",async(r,s,l,f)=>{let m;G.debug("[".concat(this.store.clientId,"] P2PChannel2 handleReplaceTrack for [track-id-").concat(r.getTrackId(),"]")),typeof f=="boolean"&&f||(m=await this.sendMutex.lock("From P2PChannel2.handleReplaceTrack"));try{var E;const b=Array.from(this.localTrackMap.entries()).find(A=>{let[,{track:O}]=A;return r===O});if(!this.sendConnection||!b||b[1].id===void 0||this.state!==Qn.Connected)return void s();if(await((E=this.sendConnection)===null||E===void 0?void 0:E.replaceTrack(r,b[1].id)),b[0]===at.LocalVideoTrack&&zn().supportDualStreamEncoding){const A=this.localTrackMap.get(at.LocalVideoLowTrack);if(A){const O=r._mediaStreamTrack.clone();A.track._originMediaStreamTrack.stop(),A.track._mediaStreamTrack=O,A.track._originMediaStreamTrack=O,await new gt((D,P)=>{this.handleReplaceTrack(A.track,D,P,!0)})}}s()}catch(b){l(b)}finally{var y;(y=m)===null||y===void 0||y()}}),ne(this,"handleGetLocalVideoStats",r=>{r(this.statsCollector.getLocalVideoTrackStats())}),ne(this,"handleGetLocalAudioStats",r=>{r(this.statsCollector.getLocalAudioTrackStats())}),ne(this,"handleGetRemoteVideoStats",r=>this.statsCollector.getRemoteVideoTrackStats(r.uid)[r.uid]),ne(this,"handleGetRemoteAudioStats",r=>this.statsCollector.getRemoteAudioTrackStats(r.uid)[r.uid]),this.store=e,this.statsCollector=t,this.statsCollector.addP2PChannel(this),this.statsUploader=new JU(e),this.bindStatsUploaderEvents(),this.sendMutex=new Gi("P2PChannel2-send-mutex",e.clientId),this.recvMutex=new Gi("P2PChannel2-recv-mutex",e.clientId),this.reconnectInterval=window.setInterval(()=>{[this.sendConnection,this.recvConnection].forEach(r=>{r&&(r.iceConnectionState!=="disconnected"&&r.iceConnectionState!=="failed"||this.handleDisconnect(r.direction))})},me("ICE_RESTART_INTERVAL"))}async startP2PConnection(e,t){throw new Ke(se.NOT_SUPPORTED,"p2p mode does not support startP2PConnection.")}async connect(e){throw new Ke(se.NOT_SUPPORTED,"p2p mode does not support connect.")}async startP2P(e,t){let r;try{if(t){this.recvConnection&&(G.warning("[".concat(this.store.clientId,"] P2PChannel.startP2P reset recvConnection.")),this.recvConnection.close(),this.unbindConnectionEvents(this.recvConnection)),r=await this.recvMutex.lock("From P2PChannel.startP2P"),this.recvConnection=new Nj(e,this.store,Vi.RECEIVE_ONLY),this.bindConnectionEvents(this.recvConnection);const s=await this.recvConnection.establish(t);return{iceParameters:s.iceParameters,dtlsParameters:s.dtlsParameters,sdp:s.sdp}}{this.state=Qn.New,this.sendConnection&&(G.warning("[".concat(this.store.clientId,"] P2PChannel.startP2P reset sendConnection.")),this.sendConnection.close(),this.unbindConnectionEvents(this.sendConnection)),r=await this.sendMutex.lock("From P2PChannel.startP2P"),this.sendConnection=new Nj(e,this.store),this.store.peerConnectionStart(),this.bindConnectionEvents(this.sendConnection);const s=await this.sendConnection.establish();return{iceParameters:s.iceParameters,dtlsParameters:s.dtlsParameters,sdp:s.sdp}}}finally{r&&r()}}async p2pConnect(e){if(!this.sendConnection)throw new Ke(se.UNEXPECTED_ERROR,"Cannot P2PChannel2.p2pConnect before P2PChannel2.startP2PConnection .");this.store.peerConnectionStart(),await this.sendConnection.connect(e),this.statsUploader.startUploadTransportStats(),this.statsUploader.startUploadExtensionUsageStats(),this.state=Qn.Connected}async addRemoteCandidate(e,t){if(t===Vi.RECEIVE_ONLY){if(!this.sendConnection)throw new Ke(se.UNEXPECTED_ERROR,"Cannot P2PChannel2.connect before P2PChannel2.addRemoteCandidate .");await this.sendConnection.addRemoteCandidate(e)}else{if(!this.recvConnection)throw new Ke(se.UNEXPECTED_ERROR,"Cannot P2PChannel2.connect before P2PChannel2.addRemoteCandidate .");await this.recvConnection.addRemoteCandidate(e)}}publish(e,t,r){var s=this;return $l(function*(){const l=yield xn(s.sendMutex.lock("From P2PChannel.publish"));try{if(!s.sendConnection||s.state!==Qn.Connected){s.throwIfTrackTypeNotMatch(e);const b=e.filter(A=>s.pendingLocalTracks.indexOf(A)===-1);return void(s.pendingLocalTracks=s.pendingLocalTracks.concat(b))}s.store.pubId=s.store.pubId+1,ws.markPublishStart(s.store.clientId,s.store.pubId);const f=s.filterTobePublishedTracks(e,t,r);if(f.length===0)return void(yield xn(s.tryToUnmuteAudio(e)));f.forEach(b=>{let{track:A,type:O}=b;const D=Date.now();s.store.publish(A.getTrackId(),O===at.LocalAudioTrack?"audio":"video",D)}),s.bindLocalTrackEvents(f);const m=yield xn(s.sendConnection.send(f.map(b=>{let{track:A}=b;return A}),s.store.codec,s.store.audioCodec)),E=(yield xn(m.next())).value,y=s.createGatewayPublishMessage(f,E);try{yield y}catch(b){throw m.throw(b),(b==null?void 0:b.code)===se.WS_ABORT&&f.forEach(A=>{let{track:O}=A;s.pendingLocalTracks.indexOf(O)===-1&&s.pendingLocalTracks.push(O)}),s.unbindLocalTrackEvents(f),b}yield xn(m.next()),f.forEach(b=>{let{type:A}=b;s.statsCollector.addLocalStats(A)}),s.statsUploader.startUploadOutboundStats(),s.assignLocalTracks(f,E),f.forEach(b=>{let{track:A,type:O}=b;const D=Date.now();s.store.publish(A.getTrackId(),O===at.LocalAudioTrack?"audio":"video",void 0,D)}),s.startUploadUplinkState()}finally{l()}})()}async unpublish(e){if(!this.sendConnection||this.state!==Qn.Connected)return void(e.length===0?this.pendingLocalTracks.length=0:this.pendingLocalTracks=this.pendingLocalTracks.filter(l=>!ht(e).call(e,l)));const t=this.filterTobeUnpublishedTracks(e);if(t.length===0)return;const r=t.find(l=>l[0]==="videoLowTrack");r&&r[1].track.close();const s=this.createGatewayUnpublishMessage(t);if(await this.sendConnection.stopSending(t.map(l=>{let[,{id:f}]=l;return f})),this.withdrawLocalTracks(t),this.unbindLocalTrackEvents(t.map(l=>{let[f,{track:m}]=l;return{type:f,track:m}})),t.forEach(l=>{let[f]=l;this.statsCollector.removeLocalStats(f)}),this.localTrackMap.size===0&&(this.statsUploader.stopUploadOutboundStats(),this.stopUploadUplinkState()),this.sendConnection&&this.state===Qn.Connected)return r&&r[1].track.close(),s;e.forEach(l=>{const f=this.pendingLocalTracks.indexOf(l);f!==-1&&this.pendingLocalTracks.splice(f,1)})}startUploadUplinkState(){if(this.uploadUnplinkStarted)return;this.uploadUnplinkStarted=!0,this.uplinkStateUploadInterval&&window.clearInterval(this.uplinkStateUploadInterval);const e=()=>{const t=[],r=[];Array.from(this.localTrackMap.entries()).forEach(s=>{let[l,{track:f,ssrcs:m}]=s;const E={stream_type:FS(f,l),ssrcs:m};f._muted||!f._enabled?t.push(E):r.push(E)}),t.length>0&&t.forEach(s=>{fr(this,Yt.RequestMuteLocal,[s])}),r.length>0&&r.forEach(s=>{fr(this,Yt.RequestUnmuteLocal,[s])})};e(),this.uplinkStateUploadInterval=window.setInterval(()=>{e()},3e3)}stopUploadUplinkState(){this.uploadUnplinkStarted&&(this.uploadUnplinkStarted=!1,this.uplinkStateUploadInterval&&window.clearInterval(this.uplinkStateUploadInterval))}publishLowStream(e){return $l(function*(){throw new Ke(se.NOT_SUPPORTED,"p2p mode does not support publishLowStream.")})()}async republish(){this.pendingLocalTracks.length>0&&(G.debug("[".concat(this.store.clientId,"] Emit P2PChannelEvents.RequestRePublish to republish tracks.")),await la(this,Yt.RequestRePublish,this.pendingLocalTracks),this.emit(Yt.MediaReconnectEnd,this.store.uid),this.pendingLocalTracks=[])}async unpublishLowStream(){throw new Ke(se.NOT_SUPPORTED,"p2p mode does not support unpublishLowStream.")}async subscribe(e,t,r,s){var l;if(!this.recvConnection)throw new Ke(se.INVALID_OPERATION,"Cannot subscribe remote user when recvConnection disconnected.");if((l=this.remoteUserMap.get(e))!==null&&l!==void 0&&l.has(t))return;const{track:f,mid:m,transceiver:E}=await this.recvConnection.receive(t,[{ssrcId:r}],String(e.uid),s);t===ut.AUDIO?(e._audioTrack?e._audioTrack._updateOriginMediaStreamTrack(f):(e._audioTrack=new $u(f,e.uid,e._uintid,this.store),G.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote audio track: ").concat(e._audioTrack.getTrackId()))),E&&e._audioTrack._updateRtpTransceiver(E),this.bindRemoteTrackEvents(e,e._audioTrack)):(e._videoSSRC=r,e._videoTrack?e._videoTrack._updateOriginMediaStreamTrack(f):(e._videoTrack=new xg(f,e.uid,e._uintid,this.store),G.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote video track: ").concat(e._videoTrack.getTrackId()))),E&&e._videoTrack._updateRtpTransceiver(E),this.bindRemoteTrackEvents(e,e._videoTrack));const y=this.remoteUserMap.get(e);y?y.set(t,m):this.remoteUserMap.set(e,new Map([[t,m]])),this.statsCollector.addRemoteStats(e.uid),this.statsUploader.startUploadInboundStats(),this.startUploadDownlinkState();const b=this.pendingRemoteTracks.findIndex(A=>{let{user:O,kind:D}=A;return O.uid===e.uid&&t===D});b!==-1&&(this.pendingRemoteTracks.splice(b,1),this.emit(Yt.MediaReconnectEnd,e.uid))}async mockSubscribe(e,t,r,s){if(!this.recvConnection)throw new Ke(se.INVALID_OPERATION,"Cannot subscribe remote user when recvConnection disconnected.");await this.recvConnection.mockReceive(t,[{ssrcId:r}],String(e.uid),s)}async unsubscribe(e,t,r){const s=this.pendingRemoteTracks.filter(f=>{let{user:m,kind:E}=f;return t!==void 0?m.uid===e.uid&&t===E:m.uid===e.uid});if(s.forEach(f=>{const m=this.pendingRemoteTracks.indexOf(f);this.pendingRemoteTracks.splice(m,1)}),this.recvConnection||r||s.forEach(f=>{let{kind:m}=f;var E;if(m===ut.AUDIO)(E=e._audioTrack)===null||E===void 0||E._destroy(),e._audioTrack=void 0;else if(m===ut.VIDEO){var y;(y=e._videoTrack)===null||y===void 0||y._destroy(),e._videoTrack=void 0}}),!this.recvConnection)return;const l=this.filterTobeUnSubscribedTracks(e,t);l.length!==0&&(await this.recvConnection.stopReceiving(l.map(f=>{let[,{id:m}]=f;return m})),this.withdrawRemoteTracks(l),this.remoteUserMap.size===0&&(this.statsUploader.stopUploadInboundStats(),this.stopUploadDownlinkState()),l.forEach(f=>{let[m,{kind:E}]=f;var y,b;if(E===ut.VIDEO&&m._videoSSRC&&((y=this.recvConnection)===null||y===void 0||y.setStatsRemoteVideoIsReady(m._videoSSRC,!1)),E===ut.VIDEO)this.unbindRemoteTrackEvents(m._videoTrack),r||((b=m._videoTrack)===null||b===void 0||b._destroy(),m._videoTrack=void 0);else if(E===ut.AUDIO){var A;this.unbindRemoteTrackEvents(m._audioTrack),!r&&((A=m._audioTrack)===null||A===void 0||A._destroy(),m._audioTrack=void 0)}}),l.forEach(f=>{let[,{kind:m}]=f;fr(this,Yt.RequestP2PMuteRemote,m)}))}startUploadDownlinkState(){if(this.uploadDownlinkStarted)return;this.uploadDownlinkStarted=!0,this.downlinkStatsUploadInterval&&window.clearInterval(this.downlinkStatsUploadInterval);const e=()=>Array.from(this.remoteUserMap.entries()).forEach(t=>{let[,r]=t;[ut.VIDEO,ut.AUDIO].forEach(s=>{r.has(s)?fr(this,Yt.RequestP2PUnmuteRemote,s):fr(this,Yt.RequestP2PMuteRemote,s)})});e(),this.downlinkStatsUploadInterval=window.setInterval(()=>{e()},3e3)}stopUploadDownlinkState(){this.uploadDownlinkStarted&&(this.uploadDownlinkStarted=!1,this.downlinkStatsUploadInterval&&window.clearInterval(this.downlinkStatsUploadInterval))}getAllDataChannels(){return this.localDataChannels}async massSubscribe(e){throw new Ke(se.NOT_SUPPORTED,"p2p mode does not support massSubscribe.")}async massSubscribeNoLock(e){throw new Ke(se.NOT_SUPPORTED,"p2p mode does not support massSubscribeNoLock.")}async massUnsubscribe(e){throw new Ke(se.NOT_SUPPORTED,"p2p mode does not support massUnsubscribe.")}async massUnsubscribeNoLock(e){throw new Ke(se.NOT_SUPPORTED,"p2p mode does not support massUnsubscribeNoLock.")}async muteRemote(e,t){if(!this.recvConnection)return;const r=this.remoteUserMap.get(e);if(!r)return void G.warning("[".concat(this.store.clientId,"] P2PChannel2.muteRemote has no remote user ").concat(e.uid,"."));if(!r.get(t))return void G.warning("[".concat(this.store.clientId,"] P2PChannel2.muteRemote has no remote user ").concat(e.uid," media type ").concat(t,"."));const s=t===ut.VIDEO?e._videoSSRC:e._audioSSRC;s!==void 0&&this.recvConnection.setStatsRemoteVideoIsReady(s,!1)}async unmuteRemote(e,t){return this.unmuteRemoteNoLock(e,t)}async unmuteRemoteNoLock(e,t){if(!this.recvConnection)return;const r=this.remoteUserMap.get(e);if(!r)return void G.warning("[".concat(this.store.clientId,"] P2PChannel2.unmuteRemote has no remote user ").concat(e.uid,"."));r.get(t)||G.warning("[".concat(this.store.clientId,"] P2PChannel2.unmuteRemote has no remote user ").concat(e.uid," media type ").concat(t,"."))}getAllTracks(e){const t=this.localTrackMap.get(at.LocalAudioTrack);if((t==null?void 0:t.track)instanceof Sa){const r=t.track;return Array.from(this.localTrackMap.entries()).filter(s=>{let[l]=s;return l!==at.LocalAudioTrack}).filter(s=>{let[l]=s;return!(e&&l===at.LocalVideoLowTrack)}).map(s=>{let[,{track:l}]=s;return l}).concat(r.trackList)}return Array.from(this.localTrackMap.entries()).filter(r=>{let[s]=r;return!(e&&s===at.LocalVideoLowTrack)}).map(r=>{let[,{track:s}]=r;return s})}reportPublishEvent(e,t,r,s,l){if(e){const m=this.localTrackMap.get(at.LocalAudioTrack),E=s?this.localTrackMap.get(at.LocalVideoLowTrack):this.localTrackMap.get(at.LocalVideoTrack);Vt.publish(this.store.sessionId,{eventElapse:ws.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:e,ec:t,audioName:m==null?void 0:m.track.getTrackLabel(),videoName:E==null?void 0:E.track.getTrackLabel(),screenshare:(E==null?void 0:E.track._hints.indexOf(xr.SCREEN_TRACK))!==-1,audio:!!m,video:!!E,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:l})}else{var f;r||(r=[]);const m=r.find(y=>y instanceof ji),E=s?(f=this.localTrackMap.get(at.LocalVideoTrack))===null||f===void 0?void 0:f.track:r.find(y=>y instanceof Kr);Vt.publish(this.store.sessionId,{eventElapse:ws.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:e,ec:t,audioName:m==null?void 0:m.getTrackLabel(),videoName:E==null?void 0:E.getTrackLabel(),screenshare:(E==null?void 0:E._hints.indexOf(xr.SCREEN_TRACK))!==-1,audio:!!m,video:!!E,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:l})}}reportSubscribeEvent(e,t,r,s){const l=s===ut.VIDEO?r._videoSSRC:r._audioSSRC;l&&Vt.subscribe(this.store.sessionId,{succ:e,ec:t,video:s===ut.VIDEO,audio:s===ut.AUDIO,peerid:r.uid,subscribeRequestid:s===ut.VIDEO?r._videoSSRC:r._audioSSRC,p2pid:this.store.p2pId,eventElapse:ws.measureFromSubscribeStart(this.store.clientId,l)})}reset(){G.debug("[".concat(this.store.clientId,"] P2PChannel2.reset")),this.sendMutex=new Gi("P2PChannel2-send-mutex",this.store.clientId),this.sendMutex=new Gi("P2PChannel2-recv-mutex",this.store.clientId),this.sendConnection&&(this.sendConnection.close(),this.unbindConnectionEvents(this.sendConnection),this.sendConnection=void 0),this.recvConnection&&(this.recvConnection.close(),this.unbindConnectionEvents(this.recvConnection),this.recvConnection=void 0),this.statsUploader.stopUploadOutboundStats(),this.statsUploader.stopUploadInboundStats(),this.statsUploader.stopUploadTransportStats(),this.statsUploader.stopUploadExtensionUsageStats(),this.stopUploadUplinkState(),this.stopUploadDownlinkState(),this.unbindLocalTrackEvents(),this.unbindAllRemoteTrackEvents(),this.unbindRtpTransceiver();const e=this.localTrackMap.get(at.LocalAudioTrack);if((e==null?void 0:e.track)instanceof Sa){if(e.track.trackList.length>0){const t=e.track;e.track.trackList.forEach(r=>{t.removeAudioTrack(r)})}e.track.close()}this.localTrackMap.clear(),this.remoteUserMap.clear(),this.statsCollector.removeRemoteStats(),this.statsCollector.removeLocalStats(),this.dtlsFailedCount=0,this.pendingLocalTracks=[],this.pendingRemoteTracks=[],this.reconnectInterval&&(window.clearInterval(this.reconnectInterval),this.reconnectInterval=void 0),this.state=Qn.Disconnected}getStats(e){var t,r;return e?(r=this.recvConnection)===null||r===void 0?void 0:r.getStats():(t=this.sendConnection)===null||t===void 0?void 0:t.getStats()}getRemoteVideoIsReady(e){var t;return((t=this.recvConnection)===null||t===void 0?void 0:t.getRemoteVideoIsReady(e))||!1}getLocalAudioVolume(){const e=this.localTrackMap.get(at.LocalAudioTrack);if(e)return e.track.getVolumeLevel()}getLocalVideoSize(){const e=this.localTrackMap.get(at.LocalVideoTrack);if(e)return{width:e.track.videoWidth||0,height:e.track.videoHeight||0}}getEncoderConfig(e){const t=this.localTrackMap.get(e);return t&&t.track instanceof Kr||t&&t.track instanceof ji?t.track._encoderConfig:void 0}getLocalMedia(e){return this.localTrackMap.get(e)}hasLocalMedia(){return this.localTrackMap.size>0}hasRemoteMedia(e,t){if(!e)return this.remoteUserMap.size>0;const r=this.remoteUserMap.get(e);return!!r&&(!t||r.has(t))}async hasRemoteMediaWithLock(e,t){if(!e)return this.remoteUserMap.size>0;const r=this.remoteUserMap.get(e);return!!r&&(!t||r.has(t))}getRemoteMedia(e){var t;const r=Array.from(Sl(t=this.remoteUserMap).call(t)).find(s=>s.uid===e);return r?{audioTrack:r.audioTrack,audioSSRC:r._audioSSRC,videoTrack:r.videoTrack,videoSSRC:r._videoSSRC}:{}}getAudioLevels(){let e=Array.from(this.remoteUserMap.entries()).map(r=>{let[s]=r;return{uid:s.uid,level:s.audioTrack?100*s.audioTrack._source.getAccurateVolumeLevel():0}});const t=this.localTrackMap.get(at.LocalAudioTrack);return t&&e.push({level:100*t.track._source.getAccurateVolumeLevel(),uid:this.store.uid}),e=sn(e).call(e,(r,s)=>r.level-s.level),e}async disconnectForReconnect(){this.sendConnection&&this.recvConnection&&(G.debug("[".concat(this.store.clientId,"] P2PChannel2.disconnectForReconnect closing P2PConnection")),this.state=Qn.Reconnecting,me("KEEP_LAST_FRAME")&&this.remoteUserMap.size!==0&&Array.from(this.remoteUserMap.entries()).forEach(e=>{let[t]=e;var r;t._videoTrack&&t._videoTrack._player&&((r=t._videoTrack._player.getVideoElement())===null||r===void 0||r.pause(),t._videoTrack._player.isKeepLastFrame=!0,t._videoTrack._originMediaStreamTrack.stop())}),this.sendConnection.close(),this.unbindConnectionEvents(this.sendConnection),this.sendConnection=void 0,this.recvConnection.close(),this.unbindConnectionEvents(this.recvConnection),this.recvConnection=void 0,this.localTrackMap.size!==0&&(Array.from(this.localTrackMap.entries()).forEach(e=>{var t;let[r,{track:s}]=e;switch(r){case at.LocalVideoTrack:ht(t=s._hints).call(t,xr.LOW_STREAM)?s.close():this.pendingLocalTracks.push(s);break;case at.LocalAudioTrack:s instanceof Sa?this.pendingLocalTracks=this.pendingLocalTracks.concat(s.trackList):this.pendingLocalTracks.push(s);case at.LocalVideoLowTrack:}}),this.emit(Yt.MediaReconnectStart,this.store.uid)),this.unbindLocalTrackEvents(),this.localTrackMap.clear(),this.remoteUserMap.size!==0&&Array.from(this.remoteUserMap.entries()).forEach(e=>{let[t,r]=e;Array.from(Sl(r).call(r)).forEach(s=>{this.setPendingRemoteMedia(t,s)}),this.emit(Yt.MediaReconnectStart,t.uid)}),this.unbindAllRemoteTrackEvents(),this.remoteUserMap.clear(),this.stopUploadUplinkState(),this.stopUploadDownlinkState(),this.statsUploader.stopUploadOutboundStats(),this.statsUploader.stopUploadInboundStats(),this.statsUploader.stopUploadTransportStats(),G.debug("[".concat(this.store.clientId,"] P2PChannel2 disconnected, waiting to reconnect.")))}hasPendingRemoteMedia(e,t){for(const r of this.pendingRemoteTracks){const{user:s,kind:l}=r;if((e instanceof K_?e.uid:e)===s.uid&&t===l)return!0}return!1}setPendingRemoteMedia(e,t){this.hasPendingRemoteMedia(e,t)||this.pendingRemoteTracks.push({user:e,kind:t})}async restartICE(e,t){let r,s;if(e===Vi.SEND_ONLY){if(!this.sendConnection)throw new Ke(se.INVALID_OPERATION,"Cannot call P2PChannel2.handleMuteLocalTrack before sendConnection established.");r=await this.sendMutex.lock("From P2PChannel.restartICE"),s=this.sendConnection}else{if(!this.recvConnection)throw new Ke(se.INVALID_OPERATION,"Cannot call P2PChannel2.handleMuteLocalTrack before recvConnection established.");r=await this.recvMutex.lock("From P2PChannel.restartICE"),s=this.recvConnection}try{if(t){const l=await s.restartICE(t);return s.isInRestartIce=!1,l}{const l=await s.restartICE();if(l){const f=await la(this,Yt.RequestP2PRestartICE,{direction:Vi.RECEIVE_ONLY,iceParameter:l});await s.restartICE(f),s.isInRestartIce=!1}}}finally{r()}}getUplinkNetworkQuality(){if(!this.sendConnection)return 0;const e=this.sendConnection.getStats(),t=this.localTrackMap.get(at.LocalVideoTrack),r=this.localTrackMap.get(at.LocalAudioTrack),s=e.videoSend.find(P=>{var F;return P.ssrc===(t==null||(F=t.ssrcs)===null||F===void 0?void 0:F[0].ssrcId)}),l=e.audioSend.find(P=>{var F;return P.ssrc===(r==null||(F=r.ssrcs)===null||F===void 0?void 0:F[0].ssrcId)});if(!s||!l)return 1;const f=Gs(this,Yt.NeedSignalRTT),m=s?s.rttMs:void 0,E=l?l.rttMs:void 0,y=m&&E?(m+E)/2:m||E,b=(y&&f?(y+f)/2:y||f)||0,A=100*e.sendPacketLossRate*.7/50+.3*b/1500,O=A<.17?1:A<.36?2:A<.59?3:A<.1?4:5,D=t==null?void 0:t.track;if(D&&D._encoderConfig&&D._hints.indexOf(xr.SCREEN_TRACK)===-1){const P=D._encoderConfig.bitrateMax,F=e.bitrate.actualEncoded;if(P&&F){const B=(1e3*P-F)/(1e3*P);return M8[B<.15?0:B<.3?1:B<.45?2:B<.6?3:4][O]}}return O}getDownlinkNetworkQuality(){if(!this.recvConnection)return 0;const e=this.recvConnection.getStats();let t=0;return Array.from(this.remoteUserMap.entries()).forEach(r=>{let[s]=r;const l=s._audioSSRC,f=s._videoSSRC,m=e.audioRecv.find(F=>F.ssrc===l),E=e.videoRecv.find(F=>F.ssrc===f);if(!m&&!E)return void(t+=1);const y=Gs(this,Yt.NeedSignalRTT),b=e.rtt,A=(b&&y?(b+y)/2:b||y)||0,O=m?m.jitterMs:void 0,D=e.recvPacketLossRate;let P=.7*D*100/50+.3*A/1500;O&&(P=.6*D*100/50+.2*A/1500+.2*O/400),t+=P<.1?1:P<.17?2:P<.36?3:P<.59?4:5}),this.remoteUserMap.size>0?Math.round(t/this.remoteUserMap.size):t}async muteLocalTrack(e){return new gt((t,r)=>{this.handleMuteLocalTrack(e,t,r)})}filterTobePublishedTracks(e,t,r){const s=[],l=zn(),f=this.getAllTracks();e=yS(e=e.filter(y=>f.indexOf(y)===-1));let m=!1,E=!1;for(const y of e){if(y instanceof Kr&&(this.localTrackMap.has(at.LocalVideoTrack)||m?new Ke(se.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS).throw():(s.push({track:y,type:at.LocalVideoTrack}),m=!0),t)){const b=this.getLowVideoTrack(y,r);s.push({track:b,type:at.LocalVideoLowTrack})}if(y instanceof ji){const b=this.localTrackMap.get(at.LocalAudioTrack);if(b){if(!(b.track instanceof Sa))throw new Ke(se.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser does not support audio mixing");if(y._bypassWebAudio)throw new Ke(se.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");b.track.addAudioTrack(y),this.bindLocalAudioTrackEvents(y,!0)}else if(E){const A=s.find(O=>{let{type:D}=O;return D===at.LocalAudioTrack});if(!(A.track instanceof Sa))throw new Ke(se.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser does not support audio mixing");if(y._bypassWebAudio)throw new Ke(se.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");A.track.addAudioTrack(y)}else{if(!l.webAudioMediaStreamDest||y instanceof Sa||y._bypassWebAudio)s.push({track:y,type:at.LocalAudioTrack});else{const A=new Sa;A.addAudioTrack(y),s.push({track:A,type:at.LocalAudioTrack})}E=!0}}}return s}filterTobeUnpublishedTracks(e){const t=[],r=this.getAllTracks();e=yS(e=e.filter(s=>r.indexOf(s)!==-1));for(const s of e){if(s instanceof ji){const l=this.localTrackMap.get(at.LocalAudioTrack);if(!l)continue;l.track instanceof Sa?(l.track.removeAudioTrack(s),this.unbindLocalAudioTrackEvents(s),l.track.trackList.length===0&&(t.push([at.LocalAudioTrack,l]),l.track.close())):t.push([at.LocalAudioTrack,l])}if(s instanceof Kr){const l=this.localTrackMap.get(at.LocalVideoTrack);if(!l)continue;t.push([at.LocalVideoTrack,l]);const f=this.localTrackMap.get(at.LocalVideoLowTrack);f&&t.push([at.LocalVideoLowTrack,f])}}return t}bindLocalTrackEvents(e){e.forEach(t=>{let{track:r,type:s}=t;switch(s){case at.LocalVideoTrack:r.addListener(Dt.GET_STATS,this.handleGetLocalVideoStats),r.addListener(Dt.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),r.addListener(Dt.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),r.addListener(Dt.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),r.addListener(Dt.NEED_UPDATE_VIDEO_SEND_PARAMETERS,this.handleUpdateVideoSendParameters),r.addListener(Dt.NEED_REPLACE_TRACK,this.handleReplaceTrack),r.addListener(Dt.NEED_MUTE_TRACK,this.handleMuteLocalTrack),r.addListener(Dt.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case at.LocalAudioTrack:this.bindLocalAudioTrackEvents(r);case at.LocalVideoLowTrack:}})}bindLocalAudioTrackEvents(e,t){e instanceof Sa?e.trackList.forEach(r=>{r.addListener(Dt.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),r.addListener(Dt.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),r.addListener(Dt.GET_STATS,this.handleGetLocalAudioStats),r.addListener(Dt.NEED_MUTE_TRACK,this.handleMuteLocalTrack),r.addListener(Dt.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):(e.addListener(Dt.GET_STATS,this.handleGetLocalAudioStats),e.addListener(Dt.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),e.addListener(Dt.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),e.addListener(Dt.NEED_MUTE_TRACK,this.handleMuteLocalTrack),e.addListener(Dt.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack),t||e.addListener(Dt.NEED_REPLACE_TRACK,this.handleReplaceTrack))}unbindLocalTrackEvents(e){e||(e=Array.from(this.localTrackMap.entries()).map(t=>{let[r,{track:s}]=t;return{track:s,type:r}})),e.forEach(t=>{let{track:r,type:s}=t;switch(s){case at.LocalVideoTrack:r.off(Dt.GET_STATS,this.handleGetLocalVideoStats),r.off(Dt.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),r.off(Dt.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),r.off(Dt.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),r.off(Dt.NEED_UPDATE_VIDEO_SEND_PARAMETERS,this.handleUpdateVideoSendParameters),r.off(Dt.NEED_REPLACE_TRACK,this.handleReplaceTrack),r.off(Dt.NEED_MUTE_TRACK,this.handleMuteLocalTrack),r.off(Dt.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case at.LocalAudioTrack:this.unbindLocalAudioTrackEvents(r);case at.LocalVideoLowTrack:}})}unbindLocalAudioTrackEvents(e){e instanceof Sa?e.trackList.forEach(t=>{t.off(Dt.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),t.off(Dt.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),t.off(Dt.GET_STATS,this.handleGetLocalAudioStats),t.off(Dt.NEED_MUTE_TRACK,this.handleMuteLocalTrack),t.off(Dt.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):(e.off(Dt.GET_STATS,this.handleGetLocalAudioStats),e.off(Dt.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),e.off(Dt.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),e.off(Dt.NEED_REPLACE_TRACK,this.handleReplaceTrack),e.off(Dt.NEED_MUTE_TRACK,this.handleMuteLocalTrack),e.off(Dt.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack))}bindRemoteTrackEvents(e,t){t instanceof xg&&t.addListener(Dt.GET_STATS,r=>{r(this.handleGetRemoteVideoStats(e))}),t instanceof $u&&t.addListener(Dt.GET_STATS,r=>{r(this.handleGetRemoteAudioStats(e))})}unbindRemoteTrackEvents(e){e&&e.removeAllListeners(Dt.GET_STATS)}unbindAllRemoteTrackEvents(){Array.from(this.remoteUserMap.entries()).forEach(e=>{let[t,r]=e;r.has(ut.AUDIO)&&this.unbindRemoteTrackEvents(t._audioTrack),r.has(ut.VIDEO)&&this.unbindRemoteTrackEvents(t._videoTrack)})}createGatewayPublishMessage(e,t){return e.map((r,s)=>{var l;let f,{track:m,type:E}=r;switch(E){case at.LocalAudioTrack:f=Er.Audio;break;case at.LocalVideoTrack:f=ht(l=m._hints).call(l,xr.SCREEN_TRACK)?Er.Screen:Er.High;break;case at.LocalVideoLowTrack:f=Er.Low}return{kind:E===at.LocalAudioTrack?ut.AUDIO:ut.VIDEO,stream_type:f,mid:t[s].id,ssrcs:t[s].localSSRC,isMuted:m.muted||!m.enabled}})}createGatewayUnpublishMessage(e){return e.map(t=>{var r;let s,[l,{track:f,ssrcs:m,id:E}]=t;switch(l){case at.LocalVideoTrack:s=ht(r=f._hints).call(r,xr.SCREEN_TRACK)?Er.Screen:Er.High;break;case at.LocalAudioTrack:s=Er.Audio;break;case at.LocalVideoLowTrack:s=Er.Low}return{stream_type:s,ssrcs:m,mid:E}})}assignLocalTracks(e,t){e.forEach((r,s)=>{let{track:l,type:f}=r;this.localTrackMap.set(f,{track:l,id:t[s].id,ssrcs:t[s].localSSRC})})}withdrawLocalTracks(e){e.forEach(t=>{let[r]=t;this.localTrackMap.delete(r)})}bindConnectionEvents(e){e.onConnectionStateChange=async t=>{var r;G.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: ").concat(e.name,".onConnectionStateChange(").concat(t,")")),this.emit(Yt.PeerConnectionStateChange,t),t!=="connected"||this.store.keyMetrics.peerConnectionEnd||this.store.peerConnectionEnd(),t==="connected"&&(e.isInRestartIce=!1),ht(r=this._restartStates).call(r,t)&&!e.isInRestartIce&&(t==="disconnected"&&await fs(800),e.iceConnectionState!=="disconnected"&&e.iceConnectionState!=="failed"||this.handleDisconnect(e.direction))},e.onICEConnectionStateChange=t=>{t!=="connected"||this.store.keyMetrics.iceConnectionEnd||this.store.iceConnectionEnd(),G.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICEConnectionStateChange(").concat(t,")")),Vt.reportApiInvoke(this.store.sessionId,{name:"ICEConnectionStateChange",options:t,tag:Bn.TRACER}).onSuccess(),this.emit(Yt.IceConnectionStateChange,t)},e.onICETransportStateChange=t=>{G.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICETransportStateChange(").concat(t,")"))},e.onDTLSTransportStateChange=t=>{G.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportStateChange(").concat(t,")"))},e.onDTLSTransportError=t=>{G.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportError(").concat(t,")"))},e.onFirstAudioDecoded=t=>{var r;const s=Array.from(Sl(r=this.remoteUserMap).call(r)).find(f=>f._audioSSRC===t);var l;s&&(this.store.subscribe(s.uid,"audio",void 0,void 0,void 0,Date.now()),(l=s.audioTrack)===null||l===void 0||l.emit(is.FIRST_FRAME_DECODED),Vt.firstRemoteFrame(this.store.sessionId,fn.FIRST_AUDIO_DECODE,_r.FIRST_AUDIO_DECODE,{peer:s._uintid,subscribeElapse:ws.measureFromSubscribeStart(this.store.clientId,t),subscribeRequestid:t,p2pid:this.store.p2pId}))},e.onFirstAudioReceived=t=>{var r;const s=Array.from(Sl(r=this.remoteUserMap).call(r)).find(l=>l._audioSSRC===t);s&&Vt.firstRemoteFrame(this.store.sessionId,fn.FIRST_AUDIO_RECEIVED,_r.FIRST_AUDIO_RECEIVED,{peer:s._uintid,subscribeElapse:ws.measureFromSubscribeStart(this.store.clientId,t),subscribeRequestid:t,p2pid:this.store.p2pId})},e.onFirstVideoDecoded=(t,r,s)=>{this.reportVideoFirstFrameDecoded(t,r,s)},e.onFirstVideoReceived=t=>{var r;const s=Array.from(Sl(r=this.remoteUserMap).call(r)).find(l=>l._videoSSRC===t);s&&Vt.firstRemoteFrame(this.store.sessionId,fn.FIRST_VIDEO_RECEIVED,_r.FIRST_VIDEO_RECEIVED,{peer:s._uintid,subscribeElapse:ws.measureFromSubscribeStart(this.store.clientId,t),subscribeRequestid:t,p2pid:this.store.p2pId})},e.onSelectedLocalCandidateChanged=(t,r)=>{const s=t.candidateType==="relay",l=r.candidateType==="relay";r.candidateType!=="unknown"&&s===l||this.emit(Yt.ConnectionTypeChange,s),G.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedLocalCandidateChanged(").concat(JSON.stringify(au(r))," -> ").concat(JSON.stringify(au(t)),")"))},e.onSelectedRemoteCandidateChanged=(t,r)=>{G.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedRemoteCandidateChanged(").concat(JSON.stringify(au(r))," -> ").concat(JSON.stringify(au(t)),")"))},e.onFirstVideoDecodedTimeout=t=>{this.reportVideoFirstFrameDecoded(t,void 0,void 0,!0)},e.onLocalCandidate=t=>{this.emit(Yt.LocalCandidate,{candidate:t,direction:e.direction})}}unbindConnectionEvents(e){e.onConnectionStateChange=void 0,e.onICEConnectionStateChange=void 0,e.onICETransportStateChange=void 0,e.onDTLSTransportStateChange=void 0,e.onDTLSTransportError=void 0,e.onFirstAudioDecoded=void 0,e.onFirstAudioReceived=void 0,e.onFirstVideoDecoded=void 0,e.onFirstVideoReceived=void 0,e.onSelectedLocalCandidateChanged=void 0,e.onSelectedRemoteCandidateChanged=void 0,e.onFirstVideoDecodedTimeout=void 0,e.onLocalCandidate=void 0}async handleDisconnect(e){const t=e===Vi.SEND_ONLY?this.sendConnection:this.recvConnection;t&&!t.isInRestartIce&&(t.isInRestartIce=!0,G.debug("[".concat(this.store.clientId,"] [P2PChannel-").concat(t.name,"] start use restartICE")),e===Vi.SEND_ONLY?this.restartICE(e):la(this,Yt.RequestP2PRestartICE,{direction:Vi.SEND_ONLY}))}filterTobeMutedTracks(e){const t=[];if(this.getAllTracks().indexOf(e)===-1)return t;const r=this.localTrackMap.get(at.LocalAudioTrack);if(e instanceof ji&&(r==null?void 0:r.track)instanceof Sa)return r.track.isActive||t.push([at.LocalAudioTrack,r]),t;const s=Array.from(this.localTrackMap.entries()).find(l=>{let[,{track:f}]=l;return e===f});if(s&&(t.push(s),s[0]===at.LocalVideoTrack)){const l=this.localTrackMap.get(at.LocalVideoLowTrack);l&&t.push([at.LocalVideoLowTrack,l])}return t}filterTobeUnmutedTracks(e){const t=[],r=this.localTrackMap.get(at.LocalAudioTrack);if(e instanceof ji&&(r==null?void 0:r.track)instanceof Sa)return r.track.isActive&&t.push([at.LocalAudioTrack,r]),t;const s=Array.from(this.localTrackMap.entries()).find(l=>{let[,{track:f}]=l;return e===f});if(s)if(s[0]===at.LocalVideoTrack){t.push(s);const l=this.localTrackMap.get(at.LocalVideoLowTrack);l&&t.push([at.LocalVideoLowTrack,l])}else t.push(s);return t}createMuteMessage(e){return e.map(t=>{var r;let s,[l,{track:f,ssrcs:m,id:E}]=t;switch(l){case at.LocalAudioTrack:s=Er.Audio;break;case at.LocalVideoTrack:s=ht(r=f._hints).call(r,xr.SCREEN_TRACK)?Er.Screen:Er.High;break;case at.LocalVideoLowTrack:s=Er.Low}return{stream_type:s,ssrcs:m,mid:E}})}createUnmuteMessage(e){return e.map(t=>{var r;let s,[l,{track:f,ssrcs:m,id:E}]=t;switch(l){case at.LocalAudioTrack:s=Er.Audio;break;case at.LocalVideoTrack:s=ht(r=f._hints).call(r,xr.SCREEN_TRACK)?Er.Screen:Er.High;break;case at.LocalVideoLowTrack:s=Er.Low}return{stream_type:s,ssrcs:m,mid:E}})}filterTobeUnSubscribedTracks(e,t){const r=[],s=this.remoteUserMap.get(e);if(!s)return r;if(t){const l=s.get(t);if(!l)return r;r.push([e,{kind:t,id:l}])}else Array.from(s.entries()).forEach(l=>{let[f,m]=l;r.push([e,{kind:f,id:m}])});return r}createUnsubscribeMessage(e){const t=[];return e.forEach(r=>{let[s,{kind:l,id:f}]=r;switch(l){case ut.VIDEO:return void(s._videoSSRC&&t.push({stream_type:ut.VIDEO,ssrcId:s._videoSSRC}));case ut.AUDIO:return void(s._audioSSRC&&t.push({stream_type:ut.AUDIO,ssrcId:s._audioSSRC}))}}),t}withdrawRemoteTracks(e){e.forEach(t=>{let[r,{kind:s}]=t;const l=this.remoteUserMap.get(r);l&&(l.delete(s),Array.from(l.entries()).length===0&&this.remoteUserMap.delete(r))})}async updateBitrateLimit(e){const t=this.localTrackMap.get(at.LocalVideoTrack),r=this.localTrackMap.get(at.LocalVideoLowTrack);t&&(await t.track.setBitrateLimit(e.uplink),await new gt((s,l)=>{this.handleUpdateVideoEncoder(t.track,s,l,!0)})),r&&e.low_stream_uplink&&(await r.track.setBitrateLimit({max_bitrate:e.low_stream_uplink.bitrate,min_bitrate:e.low_stream_uplink.bitrate||0}),await new gt((s,l)=>{this.handleUpdateVideoEncoder(r.track,s,l,!0)}))}isP2PDisconnected(){if(this.sendConnection&&this.recvConnection){const e=this.sendConnection.peerConnectionState,t=this.recvConnection.peerConnectionState;return e!=="connected"&&t!=="connected"}return!0}async tryToUnmuteAudio(e){for(let t=0;t<e.length;t++)if(e[t]instanceof ji){const r=this.filterTobeUnmutedTracks(e[t]);if(r.length===0)continue;const s=this.createUnmuteMessage(r);return void await fr(this,Yt.RequestUnmuteLocal,s)}}bindStatsUploaderEvents(){this.statsUploader.requestStats=e=>this.getStats(e),this.statsUploader.requestLocalMedia=()=>Array.from(this.localTrackMap.entries()).filter(e=>{let[,{ssrcs:t}]=e;return!!t}),this.statsUploader.requestRemoteMedia=()=>Array.from(this.remoteUserMap.entries()),this.statsUploader.requestVideoIsReady=e=>{var t;return!((t=this.recvConnection)===null||t===void 0||!t.getRemoteVideoIsReady(e))},this.statsUploader.requestUpload=(e,t)=>this.emit(Yt.RequestUpload,e,t),this.statsUploader.requestUploadStats=e=>this.emit(Yt.RequestUploadStats,e),this.statsUploader.requestAllTracks=()=>this.getAllTracks()}unbindStatsUploaderEvents(){this.statsUploader.requestStats=void 0,this.statsUploader.requestLocalMedia=void 0,this.statsUploader.requestRemoteMedia=void 0,this.statsUploader.requestVideoIsReady=void 0}async requestReconnect(){this.dtlsFailedCount+=1,await fs(Qu(this.dtlsFailedCount,ra)),this.emit(Yt.RequestReconnect)}async reconnectP2P(){}canPublishLowStream(){return this.localTrackMap.has(at.LocalVideoTrack)||this.pendingLocalTracks.some(e=>e instanceof Kr)}throwIfTrackTypeNotMatch(e){if(e.filter(t=>t instanceof Kr).length>1)throw new Ke(se.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(e.filter(t=>t instanceof ji).length>1&&(e.some(t=>t instanceof ji&&t._bypassWebAudio)||!zn().webAudioMediaStreamDest))throw new Ke(se.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode");for(const t of e){if(t instanceof Kr&&this.pendingLocalTracks.some(r=>r instanceof Kr))throw new Ke(se.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(t instanceof ji&&this.pendingLocalTracks.some(r=>r instanceof ji)&&(!zn().webAudioMediaStreamDest||t._bypassWebAudio||this.pendingLocalTracks.some(r=>r instanceof ji&&r._bypassWebAudio)))throw new Ke(se.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode")}}getLowVideoTrack(e,t){const r=!me("DISABLE_DUAL_STREAM_USE_ENCODING")&&zn().supportDualStreamEncoding,s=Or(Or({},{width:160,height:120,framerate:15,bitrate:50}),t);let l;l=r?e._mediaStreamTrack.clone():YU(e,s);const f=Br(8,"track-low-"),m=new Kr(l,Or(Or({},r&&{scaleResolutionDownBy:Bg(s,e)}),{},{frameRate:s.framerate,bitrateMax:s.bitrate,bitrateMin:s.bitrate}),void 0,void 0,f);return m.on(Eh.TRANSCEIVER_UPDATED,E=>{e._updateRtpTransceiver(E,wS.LOW_STREAM)}),m._hints.push(xr.LOW_STREAM),e.addListener(Dt.NEED_CLOSE,()=>{m.close()}),m}async globalLock(){return this.recvMutex.lock("From P2PChannel2.globalLock")}reportVideoFirstFrameDecoded(e,t,r,s){var l;const f=Array.from(Sl(l=this.remoteUserMap).call(l)).find(m=>m._videoSSRC===e);if(f){s||this.store.subscribe(f.uid,"video",void 0,void 0,void 0,void 0,Date.now());const m=this.store.keyMetrics,E=m.subscribe.find(y=>y.userId===f.uid&&y.type==="video");Vt.firstRemoteVideoDecode(this.store.sessionId,fn.FIRST_VIDEO_DECODE,_r.FIRST_VIDEO_DECODE,{peer:f._uintid,videowidth:t,videoheight:r,subscribeElapse:ws.measureFromSubscribeStart(this.store.clientId,e),subscribeRequestid:e,p2pid:this.store.p2pId,apEnd:m.requestAPEnd||0,apStart:m.requestAPStart||0,joinGwEnd:m.joinGatewayEnd||0,joinGwStart:m.joinGatewayStart||0,pcEnd:m.peerConnectionEnd||0,pcStart:m.peerConnectionStart||0,subscriberEnd:(E==null?void 0:E.subscribeEnd)||0,subscriberStart:(E==null?void 0:E.subscribeStart)||0,videoAddNotify:(E==null?void 0:E.streamAdded)||0,state:s?1:0})}}async remoteMediaSsrcChanged(e,t,r){if(!this.recvConnection)return!1;const s=this.remoteUserMap.get(e);if(!s)return!1;const l=s.get(t);if(!l)return!1;const f=await this.recvConnection.getRemoteSSRC(l);return f!==void 0&&f!==r}isPreSubScribe(e){return!1}async publishDataChannel(e){throw new Ke(se.NOT_SUPPORTED)}async unpublishDataChannel(e){throw new Ke(se.NOT_SUPPORTED)}async subscribeDataChannel(e,t){throw new Ke(se.NOT_SUPPORTED)}async unsubscribeDataChannel(e,t){throw new Ke(se.NOT_SUPPORTED)}hasPendingRemoteDataChannel(e,t){throw new Ke(se.NOT_SUPPORTED)}setPendingRemoteDataChannel(e,t){throw new Ke(se.NOT_SUPPORTED)}async preConnect(e){throw new Ke(se.NOT_SUPPORTED)}getEstablishParams(){throw new Ke(se.NOT_SUPPORTED)}async reSubscribe(e){throw new Ke(se.NOT_SUPPORTED)}async updateVideoStreamParameter(e,t){throw new Ke(se.NOT_SUPPORTED)}unbindRtpTransceiver(){this.localTrackMap.size!==0&&Array.from(this.localTrackMap.entries()).forEach(e=>{let[t,{track:r}]=e;t===at.LocalVideoLowTrack?r._updateRtpTransceiver(void 0,wS.LOW_STREAM):r._updateRtpTransceiver(void 0)})}},Ot(mi.prototype,"p2pConnect",[Lj],Object.getOwnPropertyDescriptor(mi.prototype,"p2pConnect"),mi.prototype),Ot(mi.prototype,"unpublish",[Dj],Object.getOwnPropertyDescriptor(mi.prototype,"unpublish"),mi.prototype),Ot(mi.prototype,"unpublishLowStream",[pi],Object.getOwnPropertyDescriptor(mi.prototype,"unpublishLowStream"),mi.prototype),Ot(mi.prototype,"subscribe",[Pj],Object.getOwnPropertyDescriptor(mi.prototype,"subscribe"),mi.prototype),Ot(mi.prototype,"mockSubscribe",[yA],Object.getOwnPropertyDescriptor(mi.prototype,"mockSubscribe"),mi.prototype),Ot(mi.prototype,"unsubscribe",[n7],Object.getOwnPropertyDescriptor(mi.prototype,"unsubscribe"),mi.prototype),Ot(mi.prototype,"muteRemote",[Ef],Object.getOwnPropertyDescriptor(mi.prototype,"muteRemote"),mi.prototype),Ot(mi.prototype,"unmuteRemote",[sE],Object.getOwnPropertyDescriptor(mi.prototype,"unmuteRemote"),mi.prototype),Ot(mi.prototype,"hasRemoteMediaWithLock",[r7],Object.getOwnPropertyDescriptor(mi.prototype,"hasRemoteMediaWithLock"),mi.prototype),Ot(mi.prototype,"disconnectForReconnect",[i7],Object.getOwnPropertyDescriptor(mi.prototype,"disconnectForReconnect"),mi.prototype),Ot(mi.prototype,"remoteMediaSsrcChanged",[Mj],Object.getOwnPropertyDescriptor(mi.prototype,"remoteMediaSsrcChanged"),mi.prototype),mi);function hd(e){return function(t,r,s){const l=t[r];if(typeof l!="function")throw new Error("Cannot use mutex on object property.");return s.value=async function(){for(var f=arguments.length,m=new Array(f),E=0;E<f;E++)m[E]=arguments[E];switch(e){case _f.SEND_ONLY:{const y=await this.sendMutex.lock("From P2PChannel2.".concat(r));try{return await l.apply(this,m)}finally{y()}}case _f.RECEIVE_ONLY:{const y=await this.recvMutex.lock("From P2PChannel2.".concat(r));try{return await l.apply(this,m)}finally{y()}}default:{const y=await this.sendMutex.lock("From P2PChannel2.".concat(r)),b=await this.recvMutex.lock("From P2PChannel2.".concat(r));try{return await l.apply(this,m)}finally{y(),b()}}}},s}}class ty extends Xt{constructor(t,r){super(),ne(this,"signal",void 0),ne(this,"token",void 0),ne(this,"tokenTimeout",void 0),ne(this,"tokenInterval",void 0),ne(this,"_sequence",0),ne(this,"userMap",new Map),ne(this,"encoder",new TextEncoder),this.signal=t,this.token=r;const s=()=>{this.signal.connectionState===Fr.CONNECTED&&this.check(),this.userMap.size===0?this.tokenInterval=window.setTimeout(s,1e3):this.tokenInterval=window.setTimeout(s,3*me("P2P_TOKEN_INTERVAL"))};s()}async send(t,r,s,l,f){var m;if(this.userMap.size===0)return;const E=Array.from(oc(m=this.userMap).call(m))[0].token;typeof r!="string"&&(r=JSON.stringify(r)),l=l??Br(6,""),f=f??this._sequence++;const y={_id:l,_type:t,_seq:f,_message:r,token:"".concat(this.token,"_").concat(E)};me("SHOW_P2P_LOG")&&G.debug("send message",y,"noNeedResponse : ".concat(s)),this.splitMessage(JSON.stringify(y)).forEach(A=>{this.signal.request(cn.DATA_STREAM,{payload:Lg(this.encoder.encode(A))})});const b=new gt((A,O)=>{const D=window.setTimeout(()=>{this.off("res-@".concat(l,"_ack"),P),this.off("res-@".concat(l),B),this.off(c1.ABORT,F),G.debug("[external-signal] request timeout, type: ".concat(t,", requestId: ").concat(l)),this.userMap.size===0?O(new Ke(se.INVALID_REMOTE_USER)):O(new Ke(se.TIMEOUT))},me("EXTERNAL_SIGNAL_REQUEST_TIMEOUT")),P=()=>{D&&window.clearTimeout(D),this.off(c1.ABORT,F),s&&A()},F=()=>{D&&window.clearTimeout(D),this.off("res-@".concat(l,"_ack"),P),this.off("res-@".concat(l),B),O(new Ke(se.EXTERNAL_SIGNAL_ABORT,"type: ".concat(t,", requestId: ").concat(l)))};this.once(c1.ABORT,F),this.once("res-@".concat(l,"_ack"),P);const B=($,ee)=>{Y=!0,D&&window.clearTimeout(D),this.off("res-@".concat(l,"_ack"),P),this.off(c1.ABORT,F),$==="success"?A(ee):O(new Ke(se.P2P_MESSAGE_FAILED,"request ".concat(t," failed, requestId: ").concat(l)))};let Y=!1;s||(this.once("res-@".concat(l),B),fs(me("SIGNAL_REQUEST_TIMEOUT")).then(()=>{Y||G.warning("external_signal request timeout, type: ".concat(t,", requestId: ").concat(l,", ").concat(y))}))});try{return await b}catch(A){if(A.code===se.TIMEOUT)return await this.send(t,r,s,l,f);throw A}}onMessage(t){var r;const{_uid:s}=t;let l,f=this.userMap.get(s);if(f)l=f.splitMessageMap;else{if(this.userMap.size>0||!("_type"in t)||t._type!==ia.CHECK)return;const{token:b}=t;l=new Map,f={uid:s,isStart:!0,token:b,splitMessageMap:l,nextExpectedSequenceNumber:0,receivedMessagesMap:new Map},this.userMap.set(s,f),this.signal.emit(yn.ON_USER_ONLINE,{uid:s}),this.handleUserOnline()}if("id"in t&&"total"in t){var m;const{id:b,total:A}=t,O=(m=l.get(b))!==null&&m!==void 0?m:[];if(O.push(t),l.has(b)||l.set(b,O),O.length!==A)return;{const D=sn(O).call(O,(P,F)=>P.index-F.index).map(P=>P.payload).join("");l.delete(b),(t=JSON.parse(D))._uid=s}}const{_type:E,token:y}=t;if(ht(r=[ia.ACK,ia.CHECK]).call(r,E))return E===ia.CHECK&&this.handleCheckToken(f,y),void this.receiveMessage(t);y==="".concat(f.token,"_").concat(this.token)?this.handleReceivedMessage(t):G.debug('Receive unexpected message", '.concat(y,", cur_token: ").concat(f.token,"_").concat(this.token),t)}check(){const t={_id:Br(6,""),token:this.token,_type:ia.CHECK};me("SHOW_P2P_LOG")&&G.debug("send message",t),this.signal.request(cn.DATA_STREAM,{payload:Lg(this.encoder.encode(JSON.stringify(t)))})}ack(t){const r={_id:t,_type:ia.ACK,token:this.token};me("SHOW_P2P_LOG")&&G.debug("send message",r),this.signal.request(cn.DATA_STREAM,{payload:Lg(this.encoder.encode(JSON.stringify(r)))})}response(t,r,s){this.send(ia.RESPONSE,JSON.stringify({success:!s,message:r}),!0,t)}handleReceivedMessage(t){const r=()=>{this.userMap.forEach(b=>{const{receivedMessagesMap:A,nextExpectedSequenceNumber:O}=b;for(;A.has(O);){const D=A.get(O);A.delete(O),this.receiveMessage(D),b.nextExpectedSequenceNumber++}})};if(!t)return void r();const{_uid:s,_seq:l}=t,f=this.userMap.get(s),{receivedMessagesMap:m,isStart:E,nextExpectedSequenceNumber:y}=f;if(l<y)return this.ack(t._id),void G.debug("[external-signal] receive old message, seq: ".concat(l,", ").concat(t._message));m.set(l,t),E&&l===y&&(this.receiveMessage(t),m.delete(y),f.nextExpectedSequenceNumber++,r())}receiveMessage(t){const{_id:r,_type:s,_message:l,_uid:f}=t;if(me("SHOW_P2P_LOG")&&G.debug("receive message",t),r){let m;switch(t._type!==ia.ACK&&(l&&(m=JSON.parse(l)),this.ack(t._id)),t._type){case ia.CANDIDATE:case ia.CONTROL:this.signal.emit(s,m,f);break;case ia.PUBLISH:case ia.UNPUBLISH:case ia.RESTART_ICE:case ia.CALL:m.uid=f,la(this.signal,s,m).then(E=>{this.response(t._id,E)}).catch(()=>{this.response(t._id,void 0,!0)});break;case ia.ACK:this.getListeners("res-@".concat(r,"_ack")).length>0&&this.emit("res-@".concat(r,"_ack"));break;case ia.RESPONSE:{const{success:E,message:y}=m;this.emit("res-@".concat(r),E?"success":"failed",y);break}}}}splitMessage(t){if(t.length<ty.MAX_MESSAGE_SIZE)return[t];const r=[],{remoteToken:s}=JSON.parse(t),l=Br(6,"");let f=0,m=800;const E=Math.ceil(t.length/m);for(;t.length>0;){f++;const y={id:l,index:f,total:E,payload:t.slice(0,m),token:"".concat(this.token,"_").concat(s)};JSON.stringify(y).length>ty.MAX_MESSAGE_SIZE?m-=50:(r.push(y),t=t.slice(m))}return r.map(y=>JSON.stringify(y))}handleCheckToken(t,r){return t.token!==r?(G.debug("token changed, from ".concat(t.token," to ").concat(r)),this.reset(t.uid,r),!1):(this.tokenTimeout&&(window.clearTimeout(this.tokenTimeout),this.tokenTimeout=void 0),this.tokenTimeout=window.setTimeout(()=>{G.debug("token timeout, ".concat(r)),this.reset(t.uid)},me("MAX_P2P_TIMEOUT")),!0)}async handleUserOnline(){const t=await la(this.signal,ia.CALL,void 0),r=await this.send(ia.CALL,t);this.signal.emit(Ft.P2P_CONNECTION,r,!0)}async reset(t,r){const s=this.userMap.get(t);s&&(this.emit(c1.ABORT),this.signal.emit(yn.ON_USER_OFFLINE,{uid:s.uid,reason:G8.P2P_TOKEN_CHANGED}),this._sequence=0,this.userMap.clear(),r||(G.debug("change local token from ".concat(r," to ").concat(r)),this.token=Br(6,"")))}clear(){this._sequence=0,this.userMap.clear(),this.tokenInterval&&window.clearTimeout(this.tokenInterval),this.tokenInterval=void 0,this.tokenTimeout&&window.clearTimeout(this.tokenTimeout),this.tokenTimeout=void 0,this.emit(c1.ABORT)}}ne(ty,"MAX_SIZE",1),ne(ty,"MAX_MESSAGE_SIZE",1024);class hu extends Xt{get connectionState(){return this._connectionState}set connectionState(t){t!==this._connectionState&&(this._connectionState=t,t===Fr.CONNECTED?this.emit(Ft.WS_CONNECTED):t===Fr.RECONNECTING?this.emit(Ft.WS_RECONNECTING,this._websocketReconnectReason):t===Fr.CLOSED&&this.emit(Ft.WS_CLOSED,this._disconnectedReason))}get currentURLIndex(){return this.websocket.currentURLIndex}get url(){return this.websocket&&this.websocket.url||null}get rtt(){return this.rttRolling.mean()}constructor(t,r){super(),ne(this,"_disconnectedReason",void 0),ne(this,"_websocketReconnectReason",void 0),ne(this,"_connectionState",Fr.CLOSED),ne(this,"reconnectToken",void 0),ne(this,"p2pToken",void 0),ne(this,"websocket",void 0),ne(this,"openConnectionTime",void 0),ne(this,"clientId",void 0),ne(this,"lastMsgTime",Date.now()),ne(this,"uploadCache",[]),ne(this,"uploadCacheInterval",void 0),ne(this,"rttRolling",new Rx(5)),ne(this,"pingpongTimer",void 0),ne(this,"pingpongTimeoutCount",0),ne(this,"joinResponse",void 0),ne(this,"multiIpOption",void 0),ne(this,"initError",void 0),ne(this,"spec",void 0),ne(this,"store",void 0),ne(this,"_external_signal",void 0),ne(this,"onWebsocketMessage",s=>{if(s.data instanceof ArrayBuffer)return void this.emit(Ft.ON_BINARY_DATA,s.data);const l=JSON.parse(s.data);if(this.lastMsgTime=Date.now(),Object.prototype.hasOwnProperty.call(l,"_id")){const f="res-@".concat(l._id);this.emit(f,l._result,l._message)}else if(Object.prototype.hasOwnProperty.call(l,"_type")){switch(l._type){case yn.ON_DATA_STREAM:return void this.handleDataStream(l._message);case yn.MUTE_AUDIO:case yn.MUTE_VIDEO:case yn.ON_P2P_LOST:case yn.ON_USER_ONLINE:return;case yn.ON_USER_OFFLINE:const{uid:f}=l._message;return G.debug("[".concat(this.clientId,"] user-offline uid: ").concat(f)),void this._external_signal.reset(f)}if(this.emit(l._type,l._message),l._type===yn.ON_NOTIFICATION&&this.handleNotification(l._message),l._type===yn.ON_USER_BANNED)switch(l._message.error_code){case 14:this.close(nr.UID_BANNED);break;case 15:this.close(nr.IP_BANNED);break;case 16:this.close(nr.CHANNEL_BANNED)}if(l._type===yn.ON_USER_LICENSE_BANNED)switch(l._message.error_code){case Wt.ERR_LICENSE_MISSING:this.close(nr.LICENSE_MISSING);break;case Wt.ERR_LICENSE_EXPIRED:this.close(nr.LICENSE_EXPIRED);break;case Wt.ERR_LICENSE_MINUTES_EXCEEDED:this.close(nr.LICENSE_MINUTES_EXCEEDED);break;case Wt.ERR_LICENSE_PERIOD_INVALID:this.close(nr.LICENSE_PERIOD_INVALID);break;case Wt.ERR_LICENSE_MULTIPLE_SDK_SERVICE:this.close(nr.LICENSE_MULTIPLE_SDK_SERVICE);break;case Wt.ERR_LICENSE_ILLEGAL:this.close(nr.LICENSE_ILLEGAL);break;default:this.close()}}}),this.clientId=t.clientId,this.spec=t,this.store=r,this.websocket=new Jp("gateway-".concat(this.clientId),this.spec.retryConfig,!0,me("JOIN_GATEWAY_USE_DUAL_DOMAIN"),me("JOIN_GATEWAY_USE_443PORT_ONLY"),r),this.handleWebsocketEvents(),window.addEventListener("offline",()=>{this.connectionState===Fr.CONNECTED&&this.reconnect("retry",Fn.OFFLINE)}),this.p2pToken=Br(6,""),this._external_signal=new ty(this,this.p2pToken)}async request(t,r,s,l){const f=Br(6,""),m={_id:f,_type:t,_message:r},E=this.websocket.connectionID,y=()=>new gt((F,B)=>{if(this.connectionState===Fr.CONNECTED)return F();const Y=()=>{this.off(Ft.WS_CLOSED,$),F()},$=()=>{this.off(Ft.WS_CONNECTED,Y),B(new Ke(se.WS_ABORT))};this.once(Ft.WS_CONNECTED,Y),this.once(Ft.WS_CLOSED,$)});if(this.connectionState!==Fr.CONNECTING&&this.connectionState!==Fr.RECONNECTING||t===cn.JOIN||t===cn.REJOIN||await y(),this.websocket.sendMessage(m,!0),l)return;const b=new gt((F,B)=>{let Y=!1;const $=(Ee,Re)=>{Y=!0,F({isSuccess:Ee==="success",message:Re||{}}),this.off(Ft.WS_CLOSED,ee),this.off(Ft.WS_RECONNECTING,ee),this.emit(Ft.REQUEST_SUCCESS,t,r)};this.once("res-@".concat(f),$);const ee=()=>{B(new Ke(se.WS_ABORT,"type: ".concat(t))),this.off(Ft.WS_CLOSED,ee),this.off(Ft.WS_RECONNECTING,ee),this.off("res-@".concat(f),$)};this.once(Ft.WS_CLOSED,ee),this.once(Ft.WS_RECONNECTING,ee),fs(me("SIGNAL_REQUEST_TIMEOUT")).then(()=>{this.websocket.connectionID!==E||Y||(G.warning("[".concat(this.clientId,"] ws request timeout, type: ").concat(t)),this.emit(Ft.REQUEST_TIMEOUT,t,r))})});let A=null;try{A=await b}catch(F){if(this.connectionState===Fr.CLOSED||t===cn.LEAVE)throw new Ke(se.WS_ABORT);return!this.spec.forceWaitGatewayResponse||s?F.throw():t===cn.JOIN||t===cn.REJOIN?null:(await y(),await this.request(t,r))}if(A.isSuccess)return A.message;const O=Number(A.message.error_code||A.message.code),D=RI(O),P=new Ke(se.UNEXPECTED_RESPONSE,"".concat(D.desc,": ").concat(A.message.error_str),{code:O,data:A.message,desc:D.desc});return D.action==="success"?A.message:(G.warning("[".concat(this.clientId,"] [").concat(this.websocket.connectionID,"] unexpected response from type ").concat(t,", error_code: ").concat(O,", message: ").concat(D.desc,", action: ").concat(D.action)),O===Wt.ERR_TOO_MANY_BROADCASTERS?((t===cn.JOIN||t===cn.REJOIN)&&(this.initError=P,this.close()),P.throw()):D.action==="failed"?P.throw():D.action==="quit"?(this.initError=P,this.close(),P.throw()):(O===Wt.ERR_JOIN_BY_MULTI_IP?(this.multiIpOption=A.message.option,G.warning("[".concat(this.clientId,"] detect multi ip, recover")),this.reconnect("recover",Fn.MULTI_IP)):this.reconnect(D.action,Fn.SERVER_ERROR),t===cn.JOIN||t===cn.REJOIN?null:await this.request(t,r)))}waitMessage(t,r){return new gt(s=>{const l=f=>{(!r||r(f))&&(this.off(t,l),s(f))};this.on(t,l)})}uploadWRTCStats(t){if(!this.store.sessionId)return void G.warn("[".concat(this.clientId,"] no session id when upload wrtc stats"));const r={lts:Date.now(),sid:this.store.sessionId,uid:this.store.intUid,stats:t};this.upload(bs.WRTC_STATS,r)}upload(t,r){const s={_type:t,_message:r};try{this.websocket.sendMessage(s)}catch{const f=me("MAX_UPLOAD_CACHE")||50;this.uploadCache.push(s),this.uploadCache.length>f&&this.uploadCache.splice(0,1),this.uploadCache.length>0&&!this.uploadCacheInterval&&(this.uploadCacheInterval=window.setInterval(()=>{if(this.connectionState!==Fr.CONNECTED)return;const m=this.uploadCache.splice(0,1)[0];this.uploadCache.length===0&&(window.clearInterval(this.uploadCacheInterval),this.uploadCacheInterval=void 0),this.upload(m._type,m._message)},me("UPLOAD_CACHE_INTERVAL")||2e3))}}send(t,r){const s={_type:t,_message:r};this.websocket.sendMessage(s)}async sendExtensionMessage(t,r,s){return await this._external_signal.send(t,r,s)}init(t){return this.initError=void 0,this.multiIpOption=void 0,this.joinResponse=void 0,this.reconnectToken=void 0,this.openConnectionTime=void 0,new gt((r,s)=>{this.once(Ft.WS_CONNECTED,()=>r(this.joinResponse)),this.once(Ft.WS_CLOSED,()=>s(this.initError||new Ke(se.WS_ABORT))),this.connectionState=Fr.CONNECTING,this.websocket.init(t).catch(s)})}close(t){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.reconnectToken=void 0,this.joinResponse=void 0,this._external_signal.clear(),this._disconnectedReason=t||nr.LEAVE,this.connectionState=Fr.CLOSED,G.debug("[".concat(this.clientId,"] ")+"will close websocket in signal"),this.websocket.close(),this.p2pToken=Br(6,""),this._external_signal.clear(),this._external_signal=new ty(this,this.p2pToken)}async join(){if(!this.joinResponse){this.emit(Ft.ABORT_P2P_EXECUTION);const t=await la(this,Ft.REQUEST_JOIN_INFO),r=await this.request(cn.JOIN,t);if(!r)return this.emit(Ft.REPORT_JOIN_GATEWAY,se.TIMEOUT,this.url||""),!1;this.joinResponse=r,this.emit(Ft.JOIN_RESPONSE,this.joinResponse),this.reconnectToken=this.joinResponse.rejoin_token}return this.connectionState=Fr.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),!0}reconnect(t,r){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.websocket.reconnect(t,r)}handleDataStream(t){try{var r;const s=P_(t.payload),l=new TextDecoder().decode(s),f=JSON.parse(l);"total"in f&&"id"in f||ht(r=Object.values(ia)).call(r,f._type)?(f._uid=t.uid,this._external_signal.onMessage(f)):this.emit(yn.ON_DATA_STREAM,t)}catch{this.emit(yn.ON_DATA_STREAM,t)}}handleNotification(t){G.debug("[".concat(this.clientId,"] receive notification: "),t);const r=RI(t.code);if(r.action!=="success"){if(r.action!=="failed")return r.action==="quit"?(r.desc==="ERR_REPEAT_JOIN_CHANNEL"&&this.close(nr.UID_BANNED),void this.close()):void this.reconnect(r.action,Fn.SERVER_ERROR);G.error("[".concat(this.clientId,"] ignore error: "),r.desc)}}handlePingPong(){if(!this.websocket||this.websocket.state!=="connected")return;this.pingpongTimeoutCount>0&&this.rttRolling.add(3e3),this.pingpongTimeoutCount+=1;const t=me("PING_PONG_TIME_OUT"),r=Date.now();this.pingpongTimeoutCount>=t&&(G.warning("[".concat(this.clientId,"] PINGPONG Timeout. Last Socket Message: ").concat(r-this.lastMsgTime,"ms")),r-this.lastMsgTime>me("WEBSOCKET_TIMEOUT_MIN"))?this.reconnect("retry",Fn.TIMEOUT):this.request(cn.PING,void 0,!0).then(()=>{this.pingpongTimeoutCount=0;const s=Date.now()-r;this.rttRolling.add(s),me("REPORT_STATS")&&this.send(cn.PING_BACK,{pingpongElapse:s})}).catch(s=>{})}handleWebsocketEvents(){this.websocket.on(hn.RECONNECT_CREATE_CONNECTION,t=>{this.emit(Ft.WS_RECONNECT_CREATE_CONNECTION,t)}),this.websocket.on(hn.ON_MESSAGE,this.onWebsocketMessage),this.websocket.on(hn.CLOSED,()=>{this.connectionState=Fr.CLOSED}),this.websocket.on(hn.FAILED,()=>{this._disconnectedReason=nr.NETWORK_ERROR,this.connectionState=Fr.CLOSED}),this.websocket.on(hn.RECONNECTING,t=>{this._websocketReconnectReason=t,this.joinResponse=void 0,this.connectionState===Fr.CONNECTED?this.connectionState=Fr.RECONNECTING:this.connectionState=Fr.CONNECTING}),this.websocket.on(hn.WILL_RECONNECT,(t,r,s)=>{t!=="retry"?(G.debug("".concat(this.clientId," websocket will_connect event, renewSession reconnectMode is ").concat(t)),this.reconnectToken=void 0):G.debug("".concat(this.clientId," reconnect mode is retry, no need to renew session")),s(t)}),this.websocket.on(hn.CONNECTED,()=>{this.openConnectionTime=Date.now(),this.join().catch(t=>{if(this.emit(Ft.REPORT_JOIN_GATEWAY,t,this.url||""),t instanceof Ke&&t.code===se.UNEXPECTED_RESPONSE&&t.data.code===Wt.ERR_NO_AUTHORIZED)return G.warning("[".concat(this.clientId,"] reconnect no authorized, recover")),void this.reconnect("recover",Fn.SERVER_ERROR);G.error("[".concat(this.clientId,"] join gateway request failed"),t.toString()),this.spec.forceWaitGatewayResponse?this.reconnect("tryNext",Fn.SERVER_ERROR):(this.initError=t,this.close())})}),this.websocket.on(hn.REQUEST_NEW_URLS,(t,r)=>{la(this,Ft.REQUEST_RECOVER,this.multiIpOption).then(t).catch(r)}),this.websocket.on(hn.ON_TOKEN_PRIVILEGE_DID_EXPIRE,()=>{this.emit(yn.ON_TOKEN_PRIVILEGE_DID_EXPIRE)})}}const TK={name:"P2PChannel",create:function(e){let{store:t,statsCollector:r}=e;return new s7(t,r)},createSubmodule:function(e){let{store:t,spec:r}=e;return new hu(r,t)}};function o7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),r.push.apply(r,s)}return r}function c7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?o7(Object(r),!0).forEach(function(s){ne(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o7(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}class l7{constructor(t){ne(this,"sessionDesc",void 0),ne(this,"localCapabilities",void 0),ne(this,"rtpCapabilities",void 0),ne(this,"candidates",void 0),ne(this,"_originCandidates",void 0),ne(this,"iceParameters",void 0),ne(this,"dtlsParameters",void 0),ne(this,"setup",void 0),ne(this,"currentMidIndex",void 0),ne(this,"cname",void 0),t=Mn(t);const{iceParameters:r,dtlsParameters:s,candidates:l,rtpCapabilities:f,setup:m,localCapabilities:E,sdkCodec:y,cname:b}=t,A=on(`v=0
o=- 0 0 IN IP4 127.0.0.1
s=AgoraGateway
t=0 0
a=group:BUNDLE audio video
a=msid-semantic: WMS
a=ice-lite
m=audio 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendrecv
a=rtcp-mux
a=rtcp-rsize
a=mid:audio
m=video 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendrecv
a=rtcp-mux
a=rtcp-rsize
a=mid:video
`);this.rtpCapabilities=f,this.candidates=l,this._originCandidates=Mn(l),this.iceParameters=r,this.dtlsParameters=s,this.setup=m,this.localCapabilities=E,this.cname=b;for(let O=0;O<A.mediaDescriptions.length;O++){const D=A.mediaDescriptions[O];if(D.attributes.iceUfrag=r.iceUfrag,D.attributes.icePwd=r.icePwd,D.attributes.fingerprints=s.fingerprints,D.attributes.candidates=l,D.attributes.setup=m,D.media.mediaType==="video"){D.media.fmts=f.videoCodecs.map(F=>F.payloadType.toString(10));let P=f.videoCodecs.filter(F=>{var B,Y;return(B=F.rtpMap)===null||B===void 0?void 0:ht(Y=B.encodingName.toLowerCase()).call(Y,y)});P.length===0&&(P=f.videoCodecs),D.attributes.payloads=P,D.attributes.extmaps=f.videoExtensions}D.media.mediaType==="audio"&&(D.media.fmts=f.audioCodecs.map(P=>P.payloadType.toString(10)),D.attributes.payloads=f.audioCodecs,D.attributes.extmaps=f.audioExtensions),A.mediaDescriptions[O]=this.mungMediaDesc(D)}this.sessionDesc=A,this.currentMidIndex=A.mediaDescriptions.length-1}toString(){return zr(this.sessionDesc)}send(t,r,s){const{ssrcs:l,ssrcGroups:f}=H_(r,this.cname),m=this.sessionDesc.mediaDescriptions.find(b=>t===ut.VIDEO?b.media.mediaType==="video":b.media.mediaType==="audio"),E=l[0].attributes.label,y=l[0].attributes.mslabel;return m.attributes.ssrcs=m.attributes.ssrcs.concat(l),m.attributes.ssrcGroups=m.attributes.ssrcGroups.concat(f),{id:E,mslabel:y}}batchSend(t){return t.map(r=>{let{kind:s,ssrcMsg:l}=r;return this.send(s,l,void 0)})}stopSending(t){this.sessionDesc.mediaDescriptions.forEach(r=>{const s=[],l=[],f=[];r.attributes.ssrcs.forEach(m=>{ht(t).call(t,m.attributes.label||"")?f.push(m):s.push(m)}),r.attributes.ssrcGroups.forEach(m=>{var E;ht(E=f.map(y=>y.ssrcId)).call(E,m.ssrcIds[0])||l.push(m)}),r.attributes.ssrcs=s,r.attributes.ssrcGroups=l})}mute(t){const r=this.sessionDesc.mediaDescriptions.find(s=>s.attributes.mid===t);if(!r)throw new Error("mediaDescription not found with ".concat(t," in remote SDP when calling RemoteSDP.mute."));r.attributes.direction="inactive"}unmute(t){const r=this.sessionDesc.mediaDescriptions.find(s=>s.attributes.mid===t);if(!r)throw new Error("mediaDescription not found with ".concat(t," in remote SDP when calling RemoteSDP.unmute."));r.attributes.direction="sendonly"}receive(t,r,s){t.forEach((l,f)=>{const m=l._mediaStreamTrack,E=this.sessionDesc.mediaDescriptions.findIndex(b=>b.attributes.mid===m.kind),y=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[E],l);this.sessionDesc.mediaDescriptions[E]=y})}stopReceiving(t){}updateCandidates(t){const r=this._originCandidates.filter(l=>l.transport==="udp"),s=[];if(r.forEach(l=>{s.push(c7(c7({},l),{},{foundation:"tcpcandidate",priority:Number(l.priority)-1+"",transport:"tcp",port:Number(l.port)+90+""}))}),r.length!==0){switch(t){case Ua.TCP_RELAY:this.candidates=s;break;case Ua.UDP_TCP_RELAY:case Ua.RELAY:this.candidates=[...r,...s];break;default:this.candidates=r}for(const l of this.sessionDesc.mediaDescriptions)l.attributes.candidates=this.candidates}}restartICE(t){t=Mn(t),this.iceParameters=t,this.sessionDesc.mediaDescriptions.forEach(r=>{r.attributes.iceUfrag=t.iceUfrag,r.attributes.icePwd=t.icePwd})}predictReceivingMids(t){const r=[];for(let s=0;s<t;s++)r.push((this.currentMidIndex+s+1).toString(10));return r}mungRecvMediaDsec(t,r){const s=Mn(t);return xS(s,r),sD(s,r),s}updateRecvMedia(t,r){const s=this.sessionDesc.mediaDescriptions.findIndex(l=>l.attributes.mid===t);if(s!==-1){const l=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[s],r);this.sessionDesc.mediaDescriptions[s]=l}}bumpMid(t){this.currentMidIndex+=t}updateTrackLabel(t,r,s){const l=this.sessionDesc.mediaDescriptions.find(m=>t===ut.VIDEO?m.attributes.mid==="video":m.attributes.mid==="audio");if(l){const m=l.attributes.ssrcs.find(E=>E.attributes.label===r);var f;m&&(m.attributes.label=s,(f=m.attributes.msid)===null||f===void 0||f.replace(r,s))}}mungMediaDesc(t){const r=Mn(t);return aD(r),function(s){const l=s.attributes.extmaps.find(f=>OI(f.extensionName));l&&s.attributes.extmaps.splice(s.attributes.extmaps.indexOf(l),1),s.attributes.payloads.forEach(f=>{const m=f.rtcpFeedbacks.findIndex(E=>E.type==="transport-cc");m!==-1&&f.rtcpFeedbacks.splice(m,1)})}(r),r}getSSRC(t){for(const r of this.sessionDesc.mediaDescriptions)for(const s of r.attributes.ssrcs)if(s.attributes.label===t)return[s]}}var vn;function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),r.push.apply(r,s)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?n(Object(r),!0).forEach(function(s){ne(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}let a=(vn=class Zj extends MS{get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get localCodecs(){return[...new Set(this.localCapabilities&&this.localCapabilities.videoCodecs.map(t=>t.rtpMap&&t.rtpMap.encodingName.toLowerCase()||"").filter(t=>{var r;return ht(r=Object.keys(AL)).call(r,t)}))]}constructor(t,r){super(t,r),ne(this,"store",void 0),ne(this,"peerConnection",void 0),ne(this,"remoteSDP",void 0),ne(this,"initialOffer",void 0),ne(this,"statsFilter",void 0),ne(this,"useRTX",!1),ne(this,"localCapabilities",void 0),ne(this,"localCandidateCount",0),ne(this,"allCandidatesReceived",!1),ne(this,"establishPromise",void 0),ne(this,"mutex",void 0),this.store=r,this.mutex=new Gi("P2PConnection-mutex",r.clientId),this.peerConnection=new RTCPeerConnection(Zj.resolvePCConfiguration(t),{optional:[{googDscp:!0}]}),this.statsFilter=Sr(this.peerConnection,me("STATS_UPDATE_INTERVAL"),void 0,ei()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1,this.establishPromise=this.establish()}async establish(){try{const t=await this.peerConnection.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});if(!t.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const r=ou(t.sdp),s=z_(t.sdp,{filterRTX:!this.useRTX,filterVideoFec:me("FILTER_VIDEO_FEC"),filterAudioFec:me("FILTER_AUDIO_FEC"),filterAudioCodec:["opus"]});return this.localCapabilities=s,this.initialOffer=t,i(i({},r),{},{rtpCapabilities:{send:{audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},recv:{audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},sendrecv:s},offerSDP:t.sdp})}catch(t){throw new Ke(se.GET_LOCAL_CONNECTION_PARAMS_FAILED,t.toString())}}async updateRemoteConnect(){}async connect(t){try{if(!this.initialOffer)throw new Error("Cannot establish P2PConnection without initial offer.");this.remoteSDP=new l7(i(i({},t),{},{rtpCapabilities:t.rtpCapabilities.send,localCapabilities:this.localCapabilities,sdkCodec:this.store.codec}));const r=this.remoteSDP.toString();await this.peerConnection.setLocalDescription(this.initialOffer),await this.peerConnection.setRemoteDescription({type:"answer",sdp:r})}catch(r){throw new Ke(se.EXCHANGE_SDP_FAILED,"P2PConnection.connect failed; ".concat(r.toString()))}}async updateRemoteRTPCapabilities(t,r){throw new Ke(se.NOT_SUPPORTED,"Planb mode does not support createDataChannels.")}getPreMedia(t){}send(t,r){var s=this;return $l(function*(){const l=yield xn(s.mutex.lock());try{if(!s.remoteSDP)throw new Error("Cannot call P2PConnection.send before remote SDP created");const f=t.map(D=>s.peerConnection.addTrack(D._mediaStreamTrack)),m=yield xn(s.peerConnection.createOffer()),E=on(m.sdp),y=t.map(D=>{const P=D._mediaStreamTrack,F=E.mediaDescriptions.find(B=>B.attributes.mid===P.kind);if(!F)throw new Error("Cannot extract ssrc from mediaDescription.");return function(B,Y,$){const ee=B.attributes.ssrcs.filter(Re=>Re.attributes.label===Y),Ee=B.attributes.ssrcGroups;if(ee.length===0)throw new Error("Cannot extract ssrc from plan-b SDP.");if(Ee&&ee.length>1){const Re=Ee.find(Ie=>Ie.ssrcIds.indexOf(ee[0].ssrcId)!==-1);return Re?[{ssrcId:Re.ssrcIds[0],rtx:$?Re.ssrcIds[1]:void 0}]:[{ssrcId:ee[0].ssrcId}]}return[{ssrcId:ee[0].ssrcId}]}(F,P.id,s.useRTX)});let b;try{b=yield y}catch(D){throw f.forEach(P=>{ns()&&P.replaceTrack(null),s.peerConnection.removeTrack(P)}),D}const A=s.mungSendOfferSDP(m.sdp,t);s.remoteSDP.receive(t,r,b);const O=s.remoteSDP.toString();return yield xn(s.peerConnection.setLocalDescription({type:"offer",sdp:A})),yield xn(s.applySendEncodings(f,t)),yield xn(s.peerConnection.setRemoteDescription({type:"answer",sdp:O})),t.map((D,P)=>{const F=D._mediaStreamTrack.id;return{localSSRC:y[P],id:F}})}catch(f){throw new Ke(se.EXCHANGE_SDP_FAILED,"P2PConnection.send failed; ".concat(f.toString()))}finally{l()}})()}async stopSending(t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopSending before remote SDP created");const r=this.peerConnection.getSenders().filter(f=>{var m;return t.indexOf(((m=f.track)===null||m===void 0?void 0:m.id)||"")!==-1});if(r.length!==t.length)throw new Error("Transceivers' length doesn't match mids' length when trying to call P2PConnection.stopSending.");r.map(f=>{ns()&&f.replaceTrack(null),this.peerConnection.removeTrack(f)});const s=await this.peerConnection.createOffer();await this.peerConnection.setLocalDescription(s),this.remoteSDP.stopReceiving(t);const l=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"answer",sdp:l})}catch(r){throw new Ke(se.EXCHANGE_SDP_FAILED,"P2PConnection.stopSending failed; ".concat(r.toString()))}}async receive(t,r,s,l){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(t," before remoteSDP created."));const{id:f,mslabel:m}=this.remoteSDP.send(t,r,l),E=new gt((A,O)=>{const D=setTimeout(()=>{O(new Error("Cannot receive track, id: ".concat(f)))},1e4),P=F=>{const B=qn();if((B.name==="Safari"&&Number(B.version)===11||to())&&F.track.id!==f&&F.streams[0].id===m){var Y;const $=F.streams[0].getTracks()[0];return(Y=this.remoteSDP)===null||Y===void 0||Y.updateTrackLabel(t,f,F.track.id),this.peerConnection.removeEventListener("track",P),clearTimeout(D),void A($)}if(F.track.id===f)return this.peerConnection.removeEventListener("track",P),clearTimeout(D),void A(F.track)};this.peerConnection.addEventListener("track",P)}),y=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:y});const b=await this.peerConnection.createAnswer();return await this.peerConnection.setLocalDescription(b),{track:await E,id:f}}catch(f){throw new Ke(se.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(f.toString()))}}async stopReceiving(t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");this.remoteSDP.stopSending(t);const r=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:r});const s=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(s)}catch(r){throw new Ke(se.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(r.toString()))}}async muteRemote(t){}async unmuteRemote(t){}async muteLocal(t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteLocal before remote SDP created.");const r=this.peerConnection.getSenders().filter(s=>{var l;return t.indexOf(((l=s.track)===null||l===void 0?void 0:l.id)||"")!==-1});if(r.length!==t.length)throw new Error("sender' length doesn't match mids' length.");r.map(s=>{if(ns()&&s.track)s.track.enabled=!1;else{const l=s.getParameters();l.encodings.forEach(f=>f.active=!1),s.setParameters(l)}})}catch(r){throw new Ke(se.EXCHANGE_SDP_FAILED,"P2PConnection.muteLocal failed; ".concat(r.toString()))}}async unmuteLocal(t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteLocal before remote SDP created.");const r=this.peerConnection.getSenders().filter(f=>{var m;return t.indexOf(((m=f.track)===null||m===void 0?void 0:m.id)||"")!==-1});if(r.length!==t.length)throw new Error("Senders' length doesn't match mids' length.");r.map(async f=>{if(ns()&&f.track)f.track.enabled=!0;else{const m=f.getParameters();m.encodings.forEach(E=>E.active=!0),await f.setParameters(m)}});const s=await this.peerConnection.createOffer();await this.peerConnection.setLocalDescription(s);const l=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"answer",sdp:l})}catch(r){throw new Ke(se.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteLocal failed; ".concat(r.toString()))}}restartICE(t){var r=this;return $l(function*(){const s=yield xn(r.mutex.lock("From P2PConnection.restartICE"));try{if(!r.remoteSDP)throw new Error("Cannot restartICE before remoteSDP created.");const l=zn().supportPCSetConfiguration;if(t===Ua.RELAY&&!l)return;if(l){const b=r.peerConnection.getConfiguration(),A=t===Ua.RELAY?"relay":"all";b.iceTransportPolicy!==A&&(G.debug("[".concat(r.store.clientId,"] restartICE change iceTransportPolicy from [").concat(b.iceTransportPolicy,"] to [").concat(A,"]")),b.iceTransportPolicy=A,r.peerConnection.setConfiguration(b))}t!==Ua.RELAY&&r.remoteSDP.updateCandidates(t);const f=yield xn(r.peerConnection.createOffer({iceRestart:!0}));if(!f.sdp)throw new Error("Cannot restartICE because restart offer SDP does not exist.");const m=ou(f.sdp),{remoteIceParameters:E}=yield m.iceParameters;r.remoteSDP.restartICE(E);const y=r.remoteSDP.toString();yield xn(r.peerConnection.setLocalDescription(f)),yield xn(r.peerConnection.setRemoteDescription({type:"answer",sdp:y}))}catch(l){G.warning("[".concat(r.store.clientId,"] restart ICE failed, abort operation"),l)}finally{s()}})()}close(){var t;this.peerConnection.close(),(t=this.onConnectionStateChange)===null||t===void 0||t.call(this,"closed"),this.unbindPCEvents(),this.unbindStatsEvents(),this.removeAllListeners(),this.statsFilter.destroy()}getStats(){return this.statsFilter.getStats()}getRemoteVideoIsReady(t){return this.statsFilter.getVideoIsReady(t)}async updateEncoderConfig(t,r){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateEncoderConfig before remote SDP created.");const s=await this.peerConnection.createOffer(),l=this.mungSendOfferSDP(s.sdp,[r]);this.remoteSDP.updateRecvMedia(r._mediaStreamTrack.kind,r);const f=this.remoteSDP.toString();await this.peerConnection.setLocalDescription({type:"offer",sdp:l}),await this.peerConnection.setRemoteDescription({type:"answer",sdp:f})}catch(s){throw new Ke(se.EXCHANGE_SDP_FAILED,s.toString())}}async updateSendParameters(t,r){const s=this.peerConnection.getSenders().filter(l=>{var f;return((f=l.track)===null||f===void 0?void 0:f.id)===t});s.length===1&&await this.applySendEncodings(s,[r])}setStatsRemoteVideoIsReady(t,r){this.statsFilter.setVideoIsReady2(t,r)}async replaceTrack(t,r){const s=this.peerConnection.getSenders().find(l=>{var f;return((f=l.track)===null||f===void 0?void 0:f.id)===r});s&&await s.replaceTrack(t._mediaStreamTrack)}createDataChannels(t,r){throw new Ke(se.NOT_SUPPORTED,"Planb mode does not support createDataChannels.")}stopDataChannels(t){throw new Ke(se.NOT_SUPPORTED,"Planb mode does not support stopDataChannels.")}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var t;(t=this.onICEConnectionStateChange)===null||t===void 0||t.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var t;(t=this.onConnectionStateChange)===null||t===void 0||t.call(this,this.peerConnection.connectionState)},this.peerConnection.onicecandidate=t=>{t.candidate?this.localCandidateCount+=1:(this.peerConnection.onicecandidate=null,this.allCandidatesReceived=!0,G.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount))},setTimeout(()=>{this.allCandidatesReceived||(this.allCandidatesReceived=!0,G.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] onicecandidate timeout, local candidate count"),this.localCandidateCount))},me("CANDIDATE_TIMEOUT"))}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(t){const r={iceServers:[],sdpSemantics:"plan-b"};return t.iceServers?r.iceServers=t.iceServers:t.turnServer&&t.turnServer.mode!=="off"&&(ki(t.turnServer.servers)?r.iceServers=t.turnServer.servers:(r.iceServers&&r.iceServers.push(...Zj.turnServerConfigToIceServers(t.turnServer.servers)),me("USE_TURN_SERVER_OF_GATEWAY")&&r.iceServers&&t.turnServer.serversFromGateway&&r.iceServers.push(...Zj.turnServerConfigToIceServers(t.turnServer.serversFromGateway)),t.turnServer.servers.concat(t.turnServer.serversFromGateway||[]).forEach(s=>{s.forceturn&&(r.iceTransportPolicy="relay")}))),r}static turnServerConfigToIceServers(t){const r=[];return t.forEach(s=>{s.security?s.tcpport&&r.push({username:s.username,credential:s.password,credentialType:"password",urls:"turns:".concat(s.turnServerURL,":").concat(s.tcpport,"?transport=tcp")}):(s.udpport&&r.push({username:s.username,credential:s.password,credentialType:"password",urls:"turn:".concat(s.turnServerURL,":").concat(s.udpport,"?transport=udp")}),s.tcpport&&r.push({username:s.username,credential:s.password,credentialType:"password",urls:"turn:".concat(s.turnServerURL,":").concat(s.tcpport,"?transport=tcp")}))}),r}async updateRtpSenderEncodings(t,r){var s;if(r||(r=this.peerConnection.getSenders().find(b=>{var A;return((A=b.track)===null||A===void 0?void 0:A.id)===t._mediaStreamTrack.id})),!r)return G.warn("[".concat(t.getTrackId(),"] no rtpSender found}"));if(!zn().supportSetRtpSenderParameters)return G.warn("Browser not support set rtp-sender parameters");const l={},f={};if(t instanceof Kr)switch(t._optimizationMode){case"motion":l.degradationPreference="maintain-framerate";break;case"detail":l.degradationPreference="maintain-resolution";break;default:l.degradationPreference="balanced"}if(me("DSCP_TYPE")&&fh()){var m;const b=me("DSCP_TYPE");ht(m=["very-low","low","medium","high"]).call(m,b)&&(f.networkPriority=b)}const E=r.getParameters(),y=(s=E.encodings)===null||s===void 0?void 0:s[0];y&&Object.assign(y,f),Object.assign(E,l),G.debug("[".concat(t.getTrackId(),"] updateRtpSenderEncodings: ").concat(JSON.stringify(E.encodings))),await r.setParameters(E)}async applySendEncodings(t,r){try{if(!zn().supportSetRtpSenderParameters||t.length!==r.length)return;for(let s=0;s<t.length;s++){const l=t[s],f=r[s];l&&f&&await this.updateRtpSenderEncodings(f,l)}}catch{G.debug("[".concat(this.store.clientId,"] Apply RTPSendEncodings failed."))}}mungSendOfferSDP(t,r){const s=on(t);return r.forEach((l,f)=>{const m=l._mediaStreamTrack,E=s.mediaDescriptions.find(y=>y.attributes.mid===m.kind);E&&xS(E,l)}),zr(s)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=t=>{var r;(r=this.onFirstAudioReceived)===null||r===void 0||r.call(this,t)},this.statsFilter.onFirstVideoReceived=t=>{var r;(r=this.onFirstVideoReceived)===null||r===void 0||r.call(this,t)},this.statsFilter.onFirstAudioDecoded=t=>{var r;(r=this.onFirstAudioDecoded)===null||r===void 0||r.call(this,t)},this.statsFilter.onFirstVideoDecoded=(t,r,s)=>{var l;(l=this.onFirstVideoDecoded)===null||l===void 0||l.call(this,t,r,s)},this.statsFilter.onSelectedLocalCandidateChanged=(t,r)=>{var s;(s=this.onSelectedLocalCandidateChanged)===null||s===void 0||s.call(this,t,r)},this.statsFilter.onSelectedRemoteCandidateChanged=(t,r)=>{var s;(s=this.onSelectedRemoteCandidateChanged)===null||s===void 0||s.call(this,t,r)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0}async batchReceive(t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.batchReceive before remoteSDP created.");const r=this.remoteSDP.batchSend(t).map((f,m)=>{let{id:E,mslabel:y}=f;const{kind:b}=t[m];return new gt((A,O)=>{const D=setTimeout(()=>{O(new Error("Cannot receive track, id: ".concat(E)))},1e4),P=F=>{const B=qn();if(B.name==="Safari"&&Number(B.version)===11&&F.track.id!==E&&F.streams[0].id===y){var Y;const $=F.streams[0].getTracks()[0];return(Y=this.remoteSDP)===null||Y===void 0||Y.updateTrackLabel(b,E,F.track.id),this.peerConnection.removeEventListener("track",P),clearTimeout(D),void A({track:$,id:E})}if(F.track.id===E)return this.peerConnection.removeEventListener("track",P),clearTimeout(D),void A({track:F.track,id:E})};this.peerConnection.addEventListener("track",P)})}),s=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:s});const l=await this.peerConnection.createAnswer();return await this.peerConnection.setLocalDescription(l),await gt.all(r)}catch(r){throw new Ke(se.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(r.toString()))}}async getRemoteSSRC(t){if(!this.remoteSDP)return;const r=this.remoteSDP.getSSRC(t);return r==null?void 0:r[0].ssrcId}setConfiguration(t){if(zn().supportPCSetConfiguration){const r=Zj.resolvePCConfiguration(t);this.peerConnection.setConfiguration(r)}}},Ot(vn.prototype,"connect",[c],Object.getOwnPropertyDescriptor(vn.prototype,"connect"),vn.prototype),Ot(vn.prototype,"stopSending",[c],Object.getOwnPropertyDescriptor(vn.prototype,"stopSending"),vn.prototype),Ot(vn.prototype,"receive",[c],Object.getOwnPropertyDescriptor(vn.prototype,"receive"),vn.prototype),Ot(vn.prototype,"stopReceiving",[c],Object.getOwnPropertyDescriptor(vn.prototype,"stopReceiving"),vn.prototype),Ot(vn.prototype,"muteRemote",[c],Object.getOwnPropertyDescriptor(vn.prototype,"muteRemote"),vn.prototype),Ot(vn.prototype,"unmuteRemote",[c],Object.getOwnPropertyDescriptor(vn.prototype,"unmuteRemote"),vn.prototype),Ot(vn.prototype,"muteLocal",[c],Object.getOwnPropertyDescriptor(vn.prototype,"muteLocal"),vn.prototype),Ot(vn.prototype,"unmuteLocal",[c],Object.getOwnPropertyDescriptor(vn.prototype,"unmuteLocal"),vn.prototype),Ot(vn.prototype,"close",[c],Object.getOwnPropertyDescriptor(vn.prototype,"close"),vn.prototype),Ot(vn.prototype,"updateEncoderConfig",[c],Object.getOwnPropertyDescriptor(vn.prototype,"updateEncoderConfig"),vn.prototype),Ot(vn.prototype,"updateSendParameters",[c],Object.getOwnPropertyDescriptor(vn.prototype,"updateSendParameters"),vn.prototype),Ot(vn.prototype,"replaceTrack",[c],Object.getOwnPropertyDescriptor(vn.prototype,"replaceTrack"),vn.prototype),Ot(vn.prototype,"getRemoteSSRC",[c],Object.getOwnPropertyDescriptor(vn.prototype,"getRemoteSSRC"),vn.prototype),vn);function c(e,t,r){const s=e[t];if(typeof s!="function")throw new Error("Cannot use mutex on object property.");return r.value=async function(){const l=this.mutex,f=await l.lock("Locking from P2PConnection.".concat(t));try{for(var m=arguments.length,E=new Array(m),y=0;y<m;y++)E[y]=arguments[y];return await s.apply(this,E)}finally{f()}},r}const u={name:"PlanBConnection",create:function(e){let{store:t,spec:r}=e;return new a(r,t)}},_={interceptLocalAudioFrame:async function(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!zn().supportWebRTCEncodedTransform)return void G.warning("browser not support audio encoded transform");if(SI.has(e)||!e.track)return;const r={track:e.track};if(Up()){if(!e.createEncodedStreams)return void G.warning("browser not support createEncodedStreams() API");let l=null;try{l=e.createEncodedStreams()}catch(m){return void G.error("create audio-encoded-streams error",m&&m.message)}const f=new TransformStream({transform(m,E){r.controller||(r.controller=E),e.track&&e.track.id!==r.track.id&&(G.debug("audio track changed: ".concat(r.track.id," => ").concat(e.track.id)),r.track.removeEventListener("ended",s),r.track=e.track,r.track.addEventListener("ended",s));const y=t.metadata&&t.metadata();y?function(b,A){const{chunk:O,controller:D}=A,P=me("ENABLE_AUDIO_PTS_METADATA")?To.AUDIO_64_BIT_PTS:To.METADATA;O.data=function(F,B,Y){const $=Y.byteLength,ee=$+lU+OS,Ee=cU+EI+ee,Re=new ArrayBuffer(F.byteLength+Ee),Ie=new DataView(Re);Ie.setUint8(0,oU),Ie.setUint16(1,ee),Ie.setUint8(3,B),Ie.setUint16(4,$);for(let Ue=0;Ue<$;Ue++)Ie.setUint8(6+Ue,Y[Ue]);const we=new Uint8Array(Ie.buffer);return we.set(new Uint8Array(F),Ee),we.buffer}(O.data,P,b),D.enqueue(O)}(y,{chunk:m,controller:E}):E.enqueue(m)}});l.readable.pipeThrough(f).pipeTo(l.writable)}else if(ns()){if(typeof RTCRtpScriptTransform>"u")return void G.warning("browser not support RTCRtpScriptTransform");const l=GL(),f=new MessageChannel;await new gt(E=>l.onmessage=y=>{y.data==="registered"&&E(void 0)});const m=new RTCRtpScriptTransform(l,{name:"audio-metadata-tx",port:f.port2},[f.port2]);e.transform=m,await new gt(E=>l.onmessage=y=>{y.data==="started"&&E(void 0)}),f.port1.onmessage=E=>{var y;if(E.data.transformed&&e.track&&((y=e.track)===null||y===void 0?void 0:y.id)!==r.track.id)G.debug("audio track changed: ".concat(r.track.id," => ").concat(e.track.id)),r.track.removeEventListener("ended",s),r.track=e.track,r.track.addEventListener("ended",s);else if(E.data.getMetadata){const b=t.metadata&&t.metadata();b&&f.port1.postMessage({metadata:b})}},r.worker=l}function s(){if(e.track){if(this.id!==e.track.id)return;e.track.removeEventListener("ended",s)}const l=SI.get(e);if(l){SI.delete(e);try{var f,m;(f=l.controller)===null||f===void 0||f.terminate(),(m=l.worker)===null||m===void 0||m.terminate()}catch(E){G.warning(E&&E.message)}}}SI.set(e,r),e.track.addEventListener("ended",s)},interceptRemoteAudioFrame:async function(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!zn().supportWebRTCEncodedTransform)return void G.warning("browser not support audio encoded transform");if(KL.has(e))return;const r={track:e.track,onMetadata:t.onMetadata};if(Up()){if(!e.createEncodedStreams)return void G.warning("browser not support createEncodedStreams() API");hL(sr.CHROME,87,116)||(t.enableTopn=!1);let l=null;try{l=e.createEncodedStreams()}catch(m){return void G.error("create audio-encoded-streams error",m&&m.message)}const f=new TransformStream({transform(m,E){r.controller||(r.controller=E),e.track&&e.track.id!==r.track.id&&(G.debug("audio track changed: ".concat(r.track.id," => ").concat(e.track.id)),r.track.removeEventListener("ended",s),r.track=e.track,r.track.addEventListener("ended",s)),t.enableTopn?function(y,b,A){var O;const D=vI(new DataView(b.data));if(!D)return A.enqueue(b);const P=y.track.id;pY.set(P,y.track);const F=(O=D.tlv.find(Re=>Re.tag===To.AUDIO_LEVEL))===null||O===void 0?void 0:O.value;let B=0;typeof F=="number"&&(B=127-F);const Y=Math.round(Math.pow(10,B/60)-1),{selected:$,speaker:ee}=function(Re,Ie){let we=a1.get(Re);if(we||(we=function(Ue){const ve=new L8;return a1.set(Ue,ve),tf||(tf=new yI(me("TOPN_SILENCE_THRESHOLD")||500),tf.on("ActiveSpeakerChanged",Ne=>{Ne!=null&&(Yp=Ne)})),tf.addSpeakers([ve]),ve}(Re)),a1.size<=NS)return{selected:!0,speaker:we};if(!tf)throw new Error("no active speaker detector");return tf.levelChanged(we.id,Ie),eu=tf.loudest.map(Ue=>Ue.id),Yp&&!ht(eu).call(eu,Yp)&&eu.length>=NS&&eu.pop(),{selected:ht(eu).call(eu,we.id)||we.id===Yp,speaker:we}}(y,Y),Ee=function(Re,Ie,we){const Ue=tu.get(Re)||new D8(Re,Ie);return Ue.score=we,tu.set(Re,Ue),function(ve){if(WL.set(ve,!0),!YL)return void(YL=Date.now());const Ne=Date.now();Ne-YL>1e3&&(WL.get(ve)?WL.set(ve,!1):(P8(ve),WL.delete(ve)),YL=Ne)}(Re),Ue}(P,y.track,ee.energyScore);Ee.addSample($),Ee.active&&(b.data=D.frame.buffer,A.enqueue(b))}(e,m,E):t.enableMetadata?function(y,b,A){const O=vI(new DataView(y.data));if(!O)return b.enqueue(y);const D=O.tlv.find(P=>P.tag===To.METADATA||P.tag===To.AUDIO_64_BIT_PTS);D&&A&&D.value instanceof Uint8Array&&A(D.value),y.data=O.frame.buffer,b.enqueue(y)}(m,E,t.onMetadata):E.enqueue(m)}});l.readable.pipeThrough(f).pipeTo(l.writable)}else if(ns()){if(typeof RTCRtpScriptTransform>"u")return void G.warning("browser not support RTCRtpScriptTransform");const l=GL(),f=new MessageChannel;await new gt(E=>l.onmessage=y=>{y.data==="registered"&&E(void 0)});const m=new RTCRtpScriptTransform(l,{name:"audio-metadata-rx",port:f.port2},[f.port2]);e.transform=m,await new gt(E=>l.onmessage=y=>{y.data==="started"&&E(void 0)}),f.port1.onmessage=E=>{var y;E.data.transformed&&e.track&&((y=e.track)===null||y===void 0?void 0:y.id)!==r.track.id?(G.debug("audio track changed: ".concat(r.track.id," => ").concat(e.track.id)),r.track.removeEventListener("ended",s),r.track=e.track,r.track.addEventListener("ended",s)):E.data.metadata&&r.onMetadata&&r.onMetadata(E.data.metadata)},r.worker=l}function s(){e.track.removeEventListener("ended",s),function(l){const f=KL.get(l);if(f){(function(y){const b=a1.get(y);b&&(a1.delete(y),tf&&(tf.removeSpeakers([b]),a1.size===0&&(tf.destroy(),tf=null)))})(l),P8(l.track.id),KL.delete(l);try{var m,E;(m=f.controller)===null||m===void 0||m.terminate(),(E=f.worker)===null||E===void 0||E.terminate()}catch(y){G.warning(y&&y.message)}}}(e)}KL.set(e,r),e.track.addEventListener("ended",s)},interceptLocalVideoFrame:async function(e,t){if(!zn().supportWebRTCEncodedTransform)return void G.warning("browser not support video encoded transform");if(s1.has(e)||!e.track)return;const r={track:e.track};if(Up()){if(!e.createEncodedStreams)return void G.warning("browser not support createEncodedStreams() API");let l=null;try{l=e.createEncodedStreams()}catch(E){return void G.error("create video-encoded-streams error",E&&E.message)}const f=[];t.on("sei-to-send",E=>{f.push(E)});const m=new TransformStream({transform(E,y){r.controller||(r.controller=y),e.track&&e.track.id!==r.track.id&&(G.debug("video track changed: ".concat(r.track.id," => ").concat(e.track.id)),r.track.removeEventListener("ended",s),r.track=e.track,r.track.addEventListener("ended",s));const b=f.shift();b&&(E.data=function(A,O){const D=function(ee){const Ee=ee.length;let Re=[],Ie=0;for(;Ie<Ee;)Ie+2<Ee&&ee[Ie]===0&&ee[Ie+1]===0&&(ee[Ie+2]===0||ee[Ie+2]===1||ee[Ie+2]===2||ee[Ie+2]===3)?(Re.push(ee[Ie],ee[Ie+1],3,ee[Ie+2]),Ie+=3):(Re.push(ee[Ie]),Ie++);return new Uint8Array(Re)}(O),P=D.length,F=Math.floor(P/255),B=P%255,Y=new Uint8Array(6+F+1+P+A.byteLength);Y[0]=0,Y[1]=0,Y[2]=0,Y[3]=1,Y[4]=6,Y[5]=101;let $=0;for(;$<F;)Y[6+$]=255,$++;return Y[6+$]=B,$++,Y.set(D,6+$),Y.set(new Uint8Array(A),6+$+P),Y.buffer}(E.data,b)),y.enqueue(E)}});l.readable.pipeThrough(m).pipeTo(l.writable)}else{if(!ns())return;{if(typeof RTCRtpScriptTransform>"u")return void G.warning("browser not support RTCRtpScriptTransform");const l=GL(),f=new MessageChannel;await new gt(E=>l.onmessage=y=>{y.data==="registered"&&E(void 0)});const m=new RTCRtpScriptTransform(l,{name:"sei-tx",port:f.port2},[f.port2]);e.transform=m,await new gt(E=>l.onmessage=y=>{y.data==="started"&&E(void 0)}),t.on("sei-to-send",E=>{f.port1.postMessage({sei:E})}),f.port1.onmessage=E=>{var y;E.data.transformed&&e.track&&((y=e.track)===null||y===void 0?void 0:y.id)!==r.track.id&&(G.debug("video track changed: ".concat(r.track.id," => ").concat(e.track.id)),r.track.removeEventListener("ended",s),r.track=e.track,r.track.addEventListener("ended",s))},r.worker=l}}function s(){if(e.track){if(this.id!==e.track.id)return;e.track.removeEventListener("ended",s)}const l=s1.get(e);if(l){s1.delete(e);try{var f,m;(f=l.controller)===null||f===void 0||f.terminate(),(m=l.worker)===null||m===void 0||m.terminate()}catch(E){G.warning(E&&E.message)}}}s1.set(e,r),e.track.addEventListener("ended",s)},interceptRemoteVideoFrame:async function(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!zn().supportWebRTCEncodedTransform)return void G.warning("browser not support video encoded transform");if(!e.track)return;if(TI.has(e)){const l=TI.get(e);return void(l&&(l.onSei=t.onSei))}const r={track:e.track,onSei:t.onSei};if(Up()){if(!e.createEncodedStreams)return void G.warning("browser not support createEncodedStreams() API");let l=null;try{l=e.createEncodedStreams()}catch(m){return void G.error("create video-encoded-streams error",m&&m.message)}const f=new TransformStream({transform(m,E){r.controller||(r.controller=E),e.track&&e.track.id!==r.track.id&&(G.debug("video track changed: ".concat(r.track.id," => ").concat(e.track.id)),r.track.removeEventListener("ended",s),r.track=e.track,r.track.addEventListener("ended",s));const y=function(b){const A=new DataView(b.data);let O=0;for(;O+4<b.data.byteLength;){if(A.getUint8(O+0)===0&&A.getUint8(O+1)===0&&A.getUint8(O+2)===0&&A.getUint8(O+3)===1&&A.getUint8(O+4)===6){let D=O+6,P=0,F=0;for(;(F=A.getUint8(D++))===255;)P+=255;P+=F;const B=mY(b.data,D,P);return new Uint8Array(B)}O++}return null}(m);y&&r.onSei&&r.onSei(y),E.enqueue(m)}});l.readable.pipeThrough(f).pipeTo(l.writable)}else if(ns()){if(typeof RTCRtpScriptTransform>"u")return void G.warning("browser not support RTCRtpScriptTransform");const l=GL(),f=new MessageChannel;await new gt(E=>l.onmessage=y=>{y.data==="registered"&&E(void 0)});const m=new RTCRtpScriptTransform(l,{name:"sei-rx",port:f.port2},[f.port2]);e.transform=m,await new gt(E=>l.onmessage=y=>{y.data==="started"&&E(void 0)}),f.port1.onmessage=E=>{var y;E.data.transformed&&e.track&&((y=e.track)===null||y===void 0?void 0:y.id)!==r.track.id?(G.debug("video track changed: ".concat(r.track.id," => ").concat(e.track.id)),r.track.removeEventListener("ended",s),r.track=e.track,r.track.addEventListener("ended",s)):E.data.sei&&r.onSei&&r.onSei(E.data.sei)},r.worker=l}function s(){if(e.track){if(this.id!==e.track.id)return;e.track.removeEventListener("ended",s)}(function(l){const f=TI.get(l);if(f){TI.delete(l);try{var m,E;(m=f.controller)===null||m===void 0||m.terminate(),(E=f.worker)===null||E===void 0||E.terminate()}catch(y){G.warning(y&&y.message)}}})(e)}TI.set(e,r),e.track.addEventListener("ended",s)}},S={name:"InterceptFrame",create:()=>_};wL(),Dn("PROCESS_ID","process-".concat(Br(8,""),"-").concat(Br(4,""),"-").concat(Br(4,""),"-").concat(Br(4,""),"-").concat(Br(12,""))),function(){let e;try{e=window.localStorage.getItem("websdk_ng_global_parameter")}catch(t){return void G.error("Error loading sdk config",t.message)}if(e)try{const t=JSON.parse(window.atob(e)),r=Date.now();G.debug("Loading global parameters from cache",t),Object.keys(t).forEach(s=>{if(Object.prototype.hasOwnProperty.call(ti,s)){const{value:l,expires:f}=t[s];if(f&&f<=r)return;gh[s]=l,ti[s]=l}})}catch(t){G.error("Error loading mutableParamsCache: ".concat(e),t.message)}}(),Array.isArray(gh.AREAS)&&gh.AREAS.length>0&&VS(gh.AREAS,!0);const C=(e,t,r)=>{G.debug("setParameter key:".concat(e,", value:").concat(JSON.stringify(t))),Dn(e,t,r)};Ch(hK,!1),Ch(Zc,!1),Ch(_F,!1),Ch(vK,!1),Ch(dK,!1),Ch(TK,!1),Ch(u,!1),Ch(S,!1);const R=function(e){const t=new Xt,r=e,s={getListeners:t.getListeners.bind(t),on:(l,f)=>(function(m,E){m===Kp.SECURITY_POLICY_VIOLATION&&D1(E,!0)}(l,f),t.on.bind(t)(l,f)),addListener:t.addListener.bind(t),once:t.once.bind(t),off:t.off.bind(t),removeAllListeners:t.removeAllListeners.bind(t),emit:t.emit.bind(t),safeEmit:t.safeEmit.bind(t)};return AD(AD({},r),s)}({__TRACK_LIST__:U_,VERSION:hs,BUILD:k_,ESM_BUNDLER:!1,ESM:!1,UMD:!0,DEV:!1,setParameter:C,getParameter:me,getSupportedCodec:async function(){let e={audio:[],video:[]};try{let t=new RTCPeerConnection;const r=await async function(s){let l;return zn().supportUnifiedPlan?(s.addTransceiver("video",{direction:"recvonly"}),s.addTransceiver("audio",{direction:"recvonly"}),l=(await s.createOffer()).sdp):l=(await s.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0})).sdp,l}(t);if(!r)return e;t.close(),t=null,e=function(s){const l={video:[],audio:[]};return s.match(/ VP8/i)&&l.video.push("VP8"),s.match(/ VP9/i)&&l.video.push("VP9"),s.match(/ AV1/i)&&l.video.push("AV1"),s.match(/ H264/i)&&l.video.push("H264"),s.match(/ H265/i)&&l.video.push("H265"),s.match(/ opus/i)&&l.audio.push("OPUS"),s.match(/ PCMU/i)&&l.audio.push("PCMU"),s.match(/ PCMA/i)&&l.audio.push("PCMA"),s.match(/ G722/i)&&l.audio.push("G722"),l}(r)}catch(t){throw new xe(se.CREATE_OFFER_FAILED,t.toString&&t.toString()).print()}return e},checkSystemRequirements:function(){const e=Vt.reportApiInvoke(null,{name:Di.CHECK_SYSTEM_REQUIREMENTS,options:[],tag:Bn.TRACER});let t=!1;try{const f=window.RTCPeerConnection,m=navigator.mediaDevices&&navigator.mediaDevices.getUserMedia,E=window.WebSocket;t=!!(f&&m&&E),t&&Cr()&&Jd(75)&&new f().close()}catch(f){return G.error("check system requirement failed: ",f),!1}let r=!1;const s=qn();s.name===sr.CHROME&&Number(s.version)>=58&&(Ea.engine.name!=="WebKit"||function(){const f=qn();if(tI()){if(f.os===mr.MAC_OS)return!0;if(f.os===mr.IOS){const m=Ea.os.version&&Ea.os.version.split(".");if(m&&Number(m[0])===14&&m[1]&&Number(m[1])>=3||m&&Number(m[0])>14)return!0}}return!1}())&&(r=!0),(s.name===sr.FIREFOX&&Number(s.version)>=56||s.name===sr.OPERA&&Number(s.version)>=45||s.name===sr.SAFARI&&Number(s.version)>=11||s.name==="WebKit"&&(to()||Ye())&&s.osVersion&&Number(s.osVersion.split(".")[0])>=11||Vp()||qn().name===sr.QQ)&&(r=!0),G.debug("checkSystemRequirements, api:",t,"browser",r);const l=t&&r;return e.onSuccess(l),l},getDevices:function(e){return Fc.enumerateDevices(!0,!0,e)},getMicrophones:function(e){return Fc.getRecordingDevices(e)},getCameras:function(e){return Fc.getCamerasDevices(e)},getElectronScreenSources:Vx,getPlaybackDevices:function(e){return Fc.getSpeakers(e)},createClient:function(){var e;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{codec:"vp8",audioCodec:"opus",mode:"rtc"};const r=Br(5,"client-"),s=Vt.reportApiInvoke(null,{id:r,name:Di.CREATE_CLIENT,options:[t],tag:Bn.TRACER});try{(function(l){Aa(l.codec,"config.codec",["vp8","vp9","av1","h264","h265"]),Aa(l.mode,"config.mode",["rtc","live","p2p"]),l.audioCodec!==void 0&&Aa(l.audioCodec,"config.audioCodec",["opus","pcmu","pcma","g722"]),l.proxyServer!==void 0&&Oa(l.proxyServer,"config.proxyServer",1,1e4),l.turnServer!==void 0&&iI(l.turnServer),l.httpRetryConfig!==void 0&&Vr(l.httpRetryConfig),l.websocketRetryConfig!==void 0&&Vr(l.websocketRetryConfig)})(t)}catch(l){throw s.onError(l),l}return(jp(16,0)||nI(16,0,!0))&&(t.codec==="vp9"&&(t.codec="vp8",G.debug("browser not support vp9, force use vp8")),Dn("UNSUPPORTED_VIDEO_CODEC",["vp9"])),t.audioCodec===void 0&&(t.audioCodec="opus"),s.onSuccess(),new yF(cd(cd({forceWaitGatewayResponse:!0},t),{},{role:ht(e=["rtc","p2p"]).call(e,t.mode)?"host":t.role||"audience"}),r)},createCameraVideoTrack:async function(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t=me("CAMERA_CAPTURE_CONFIG"),r=Br(8,"track-cam-"),s=Vt.reportApiInvoke(null,{id:r,tag:Bn.TRACER,name:Di.CREATE_CAM_VIDEO_TRACK,options:[fi({},e),t]});t&&(e.encoderConfig=t);const l=pI(e);let f=null;G.info("start create camera video track with config",JSON.stringify(e),"trackId",r);try{f=(await wl({video:l},r)).getVideoTracks()[0]||null}catch(E){throw s.onError(E),E}if(!f){const E=new Ke(se.UNEXPECTED_ERROR,"can not find track in media stream");return s.onError(E),E.throw(G)}if(e.optimizationMode&&V_(r,f,e,Bo(e.encoderConfig)),me("USE_STANDARD_BITRATE_DEFAULT")){const E=Bo(e.encoderConfig);e.encoderConfig=E,delete E.bitrateMax,delete E.bitrateMin}const m=new j_(f,e,l,e.scalabiltyMode?Mg(e.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},e.optimizationMode,r);return s.onSuccess(m.getTrackId()),G.info("create camera video success, trackId:",r),m},createCustomVideoTrack:function(e){const t=Br(8,"track-cus-"),r=Vt.reportApiInvoke(null,{id:t,tag:Bn.TRACER,name:Di.CREATE_CUSTOM_VIDEO_TRACK,options:[e]});me("USE_STANDARD_BITRATE_DEFAULT")&&(delete e.bitrateMax,delete e.bitrateMin);const s=new Kr(e.mediaStreamTrack,{width:e.width,height:e.height,frameRate:e.frameRate,bitrateMax:e.bitrateMax,bitrateMin:e.bitrateMin},e.scalabiltyMode?Mg(e.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},e.optimizationMode,t,[xr.CUSTOM_TRACK]);return r.onSuccess(s.getTrackId()),G.info("create custom video track success with config",e,"trackId",s.getTrackId()),s},createScreenVideoTrack:async function(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"disable";const r=typeof t=="object"?function(D){return Kx(D)}(t):void 0;r&&(t="auto");const s=Br(8,"track-scr-v-"),l=Vt.reportApiInvoke(null,{id:s,tag:Bn.TRACER,name:Di.CREATE_SCREEN_VIDEO_TRACK,options:[fi({},e),t]});e.encoderConfig?typeof e.encoderConfig=="string"||e.encoderConfig.width&&e.encoderConfig.height||(e.encoderConfig.width={max:1920},e.encoderConfig.height={max:1080}):e.encoderConfig="1080p_2";const f=function(D){const P={};D.screenSourceType&&(P.mediaSource=D.screenSourceType),D.extensionId&&Up()&&(P.extensionId=D.extensionId);const{displaySurface:F,selfBrowserSurface:B,surfaceSwitching:Y,systemAudio:$,preferCurrentTab:ee}=D;(Vb(107)||pL(107)||ES(93))&&(F&&(Aa(F,"displaySurface",["browser","window","monitor"]),P.displaySurface=F),B?(Aa(B,"selfBrowserSurface",["exclude","include"]),P.selfBrowserSurface=B):P.selfBrowserSurface="include",Y&&(Aa(Y,"surfaceSwitching",["exclude","include"]),P.surfaceSwitching=Y)),(Vb(105)||pL(105)||ES(91))&&$&&(Aa($,"systemAudio",["exclude","include"]),P.systemAudio=$),(Vb(94)||pL(94)||ES(80))&&ee&&(P.preferCurrentTab=!0),D.electronScreenSourceId&&(P.sourceId=D.electronScreenSourceId);const Ee=D.encoderConfig?x_(D.encoderConfig):null;return P.mandatory={chromeMediaSource:"desktop",maxWidth:Ee?Ee.width:void 0,maxHeight:Ee?Ee.height:void 0},Ee&&(Ee.frameRate&&(typeof Ee.frameRate=="number"?(P.mandatory.maxFrameRate=Ee.frameRate,P.mandatory.minFrameRate=Ee.frameRate):(P.mandatory.maxFrameRate=Ee.frameRate.max||Ee.frameRate.ideal||Ee.frameRate.exact||void 0,P.mandatory.minFrameRate=Ee.frameRate.min||Ee.frameRate.ideal||Ee.frameRate.exact||void 0),P.frameRate=Ee.frameRate),Ee.width&&(P.width=Ee.width),Ee.height&&(P.height=Ee.height)),P}(e);let m=null,E=null;const y=zn();if(!y.supportShareAudio&&t==="enable"){const D=new Ke(se.NOT_SUPPORTED,"your browser or platform is not support share-screen with audio");return l.onError(D),D.throw(G)}G.info("start create screen video track with config",e,"withAudio",t,"trackId",s);const b=y.supportShareAudio&&t!=="disable";try{const D=await wl({screen:f,screenAudio:b?r||!0:void 0},s);m=D.getVideoTracks()[0]||null,E=D.getAudioTracks()[0]||null}catch(D){throw l.onError(D),D}if(!m){const D=new Ke(se.UNEXPECTED_ERROR,"can not find track in media stream");return l.onError(D),D.throw(G)}if(!E&&t==="enable"){m&&m.stop();const D=new Ke(se.SHARE_AUDIO_NOT_ALLOWED);return l.onError(D),D.throw(G)}e.optimizationMode||(e.optimizationMode="detail"),e.optimizationMode&&(V_(s,m,e,e.encoderConfig&&x_(e.encoderConfig)||void 0),e.encoderConfig&&typeof e.encoderConfig!="string"&&(e.encoderConfig.bitrateMin=e.encoderConfig.bitrateMax));const A=new Kr(m,e.encoderConfig?x_(e.encoderConfig):{},e.scalabiltyMode?Mg(e.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},e.optimizationMode,s,[xr.SCREEN_TRACK]);if(!E)return l.onSuccess(A.getTrackId()),G.info("create screen video track success","video:",A.getTrackId()),A;const O=new ji(E,void 0,Br(8,"track-scr-a-"),!1);return l.onSuccess([A.getTrackId(),O.getTrackId()]),G.info("create screen video track success","video:",A.getTrackId(),"audio:",O.getTrackId()),[A,O]},createMicrophoneAndCameraTracks:async function(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=me("CAMERA_CAPTURE_CONFIG"),s=Br(8,"track-mic-"),l=Br(8,"track-cam-"),f=Vt.reportApiInvoke(null,{id:"".concat(s,"-").concat(l),tag:Bn.TRACER,name:Di.CREATE_MIC_AND_CAM_TRACKS,options:[e,t,r]});r&&(t.encoderConfig=r);const m=pI(t),E=qx(e);let y=null,b=null;G.info("start create camera video track(".concat(l,") and microphone audio track(").concat(s,") with config, audio: ").concat(JSON.stringify(e),", video: ").concat(JSON.stringify(t)));try{const D=await wl({audio:E,video:m},"".concat(s,"-").concat(l));y=D.getAudioTracks()[0],b=D.getVideoTracks()[0]}catch(D){throw f.onError(D),D}if(!y||!b){const D=new Ke(se.UNEXPECTED_ERROR,"can not find tracks in media stream");return f.onError(D),D.throw(G)}if(t.optimizationMode&&V_(l,b,t,Bo(t.encoderConfig)),me("USE_STANDARD_BITRATE_DEFAULT")){const D=Bo(t.encoderConfig);t.encoderConfig=D,delete D.bitrateMax,delete D.bitrateMin}const A=new t1(y,e,E,s),O=new j_(b,t,m,t.scalabiltyMode?Mg(t.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},t.optimizationMode,l);return f.onSuccess([A.getTrackId(),O.getTrackId()]),G.info("create camera video track(".concat(l,") and microphone audio track(").concat(s,") success")),[A,O]},createMicrophoneAudioTrack:async function(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t=Br(8,"track-mic-"),r=Vt.reportApiInvoke(null,{id:t,tag:Bn.TRACER,name:Di.CREATE_MIC_AUDIO_TRACK,options:[e]}),s=qx(e);let l=null;G.info("start create microphone audio track with config",JSON.stringify(e),"trackId",t);try{l=(await wl({audio:s},t)).getAudioTracks()[0]||null}catch(m){throw r.onError(m),m}if(!l){const m=new Ke(se.UNEXPECTED_ERROR,"can not find track in media stream");return r.onError(m),m.throw(G)}const f=new t1(l,e,s,t);return r.onSuccess(f.getTrackId()),G.info("create microphone audio track success, trackId:",t),f},createCustomAudioTrack:function(e){const t=Br(8,"track-cus-"),r=Vt.reportApiInvoke(null,{id:t,tag:Bn.TRACER,name:Di.CREATE_CUSTOM_AUDIO_TRACK,options:[e]}),s=new ji(e.mediaStreamTrack,e.encoderConfig?lc(e.encoderConfig):{},t,!1);return G.info("create custom audio track success with config",e,"trackId",s.getTrackId()),r.onSuccess(s.getTrackId()),s},createBufferSourceAudioTrack:async function(e){var t;const{cacheOnlineFile:r,encoderConfig:s}=e;let{source:l}=e;const f={source:l instanceof AudioBuffer?"AudioBuffer":l instanceof File?(t=File.name)!==null&&t!==void 0?t:"File":l,cacheOnlineFile:r,encoderConfig:s},m=Br(8,"track-buf-"),E=Vt.reportApiInvoke(null,{id:m,tag:Bn.TRACER,name:Di.CREATE_BUFFER_AUDIO_TRACK,options:[f]});if(me("DISABLE_WEBAUDIO"))throw new Ke(se.NOT_SUPPORTED,"can not create BufferSourceAudioTrack when WebAudio disabled");G.info("start create buffer source audio track with config",JSON.stringify(f),"trackId",m);const y=l;if(!(l instanceof AudioBuffer))try{l=await async function(O,D){let P=null;if(typeof O=="string"){const B=w3.get(O);if(B)return G.debug("use cached audio resource: ",O),B;try{P=(await _l(()=>En.get(O,{responseType:"arraybuffer"}),void 0,void 0,{maxRetryCount:3})).data}catch(Y){throw new Ke(se.FETCH_AUDIO_FILE_FAILED,Y.toString())}}else P=await new gt((Y,$)=>{const ee=new FileReader;ee.onload=Ee=>{Ee.target?Y(Ee.target.result):$(new Ke(se.READ_LOCAL_AUDIO_FILE_ERROR))},ee.onerror=()=>{$(new Ke(se.READ_LOCAL_AUDIO_FILE_ERROR))},ee.readAsArrayBuffer(O)});const F=await function(B){const Y=RS();return new gt(($,ee)=>{Y.decodeAudioData(B,Ee=>{$(Ee)},Ee=>{ee(new Ke(se.DECODE_AUDIO_FILE_FAILED,Ee.toString()))})})}(P);return typeof O=="string"&&D&&w3.set(O,F),F}(l,r)}catch(O){return E.onError(O),O.throw(G)}const b=new I8(l),A=new R8(y,b,s?lc(s):{},m);return G.info("create buffer source audio track success, trackId:",m),E.onSuccess(A.getTrackId()),A},setAppType:function(e){if(G.debug("setAppType: ".concat(e)),!(Number.isInteger(e)&&e>=0))throw G.debug("Invalid appType"),new xe(se.INVALID_PARAMS,"invalid app type",e);Dn("APP_TYPE",Math.floor(e))},setLogLevel:function(e){G.setLogLevel(e)},enableLogUpload:function(){me("USE_NEW_LOG")?Dn("UPLOAD_LOG",!0):G.enableLogUpload()},disableLogUpload:function(){me("USE_NEW_LOG")?Dn("UPLOAD_LOG",!1):G.disableLogUpload()},createChannelMediaRelayConfiguration:function(){return new FU},checkAudioTrackIsActive:async function(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5e3;const r=Vt.reportApiInvoke(null,{tag:Bn.TRACER,name:Di.CHECK_AUDIO_TRACK_IS_ACTIVE,options:[t]});if(!(e instanceof ji||e instanceof $u)){const y=new xe(se.INVALID_TRACK,"the parameter is not a audio track");return r.onError(y),y.throw()}t&&t<1e3&&(t=1e3);const s=e instanceof ji?e.getTrackLabel():"remote_track",l=e.getVolumeLevel();let f=l,m=l;const E=Date.now();return new gt(y=>{const b=setInterval(()=>{const A=e.getVolumeLevel();f=A>f?A:f,m=A<m?A:m;const O=f-m>1e-4,D=Date.now()-E;if(O||D>t){clearInterval(b);const P=O,F={duration:D,deviceLabel:s,maxVolumeLevel:f,result:P};G.info("[track-".concat(e.getTrackId(),"] check audio track active completed. ").concat(JSON.stringify(F))),r.onSuccess(F),y(P)}},200)})},checkVideoTrackIsActive:async function(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5e3;const r=Vt.reportApiInvoke(null,{tag:Bn.TRACER,name:Di.CHECK_VIDEO_TRACK_IS_ACTIVE,options:[t]});if(!(e instanceof Kr||e instanceof xg)){const O=new xe(se.INVALID_TRACK,"the parameter is not a video track");return r.onError(O),O.throw()}t&&t<1e3&&(t=1e3);const s=e instanceof Kr?e.getTrackLabel():"remote_track",l=e.getMediaStreamTrack(!0),f=document.createElement("video");f.style.width="1px",f.style.height="1px",f.setAttribute("muted",""),f.muted=!0,f.setAttribute("playsinline",""),f.controls=!1,(ns()||tI())&&(f.style.opacity="0.01",f.style.position="fixed",f.style.left="0",f.style.top="0",document.body.appendChild(f)),f.srcObject=new MediaStream([l]),f.play();const m=document.createElement("canvas");m.width=160,m.height=120;let E=0,y=0;try{const O=Date.now();E=await function(D,P,F,B){let Y,$=0,ee=null;return new gt((Ee,Re)=>{function Ie(){$>B&&Y&&(Y(),Ee($));const we=F.getContext("2d");if(!we){const Ne=new xe(se.UNEXPECTED_ERROR,"can not get canvas 2d context.");return G.error(Ne.toString()),void Re(Ne)}we.drawImage(D,0,0,160,120);const Ue=we.getImageData(0,0,F.width,F.height),ve=Math.floor(Ue.data.length/3);if(ee){for(let Ne=0;Ne<ve;Ne+=3)if(Ue.data[Ne]!==ee[Ne])return $+=1,void(ee=Ue.data);ee=Ue.data}else ee=Ue.data}setTimeout(()=>{Y&&(Y(),Ee($))},P),Y=e1(()=>{Ie()},30)})}(f,t,m,4),y=Date.now()-O}catch(O){throw r.onError(O),O}t6===sr.SAFARI&&(f.pause(),f.remove()),f.srcObject=null;const b=E>4,A={duration:y,changedPicNum:E,deviceLabel:s,result:b};return G.info("[track-".concat(e.getTrackId(),"] check video track active completed. ").concat(JSON.stringify(A))),r.onSuccess(A),b},setArea:VS,audioElementPlayCenter:dc,resumeAudioContext:function(){dc.autoResumeAfterInterruption(!0)},processExternalMediaAEC:function(e){Ao.processExternalMediaAEC(e)},registerExtensions:function(e){const t=me("PLUGIN_INFO")||[];e.forEach(r=>{"name"in r&&!ht(t).call(t,r.name)&&t.push(r.name);const s=r;s.__registered__=!0,s.logger.hookLog=G.extLog,s.reporter.hookApiInvoke=Vt.extApiInvoke,s.parameters&&Object.keys(s.parameters).forEach(l=>{s.parameters[l]=me(l)})}),C("PLUGIN_INFO",t)},ChannelMediaRelayError:ad,ChannelMediaRelayEvent:Tt,ChannelMediaRelayState:hi,RemoteStreamFallbackType:nd,RemoteStreamType:Fo,ConnectionDisconnectedReason:nr,AudienceLatencyLevelType:ed,AREAS:An,preload:async function(e,t,r,s){return aF(e,t,r,s)}});return Object.defineProperties(R,{onAudioAutoplayFailed:{get:()=>Rl.onAudioAutoplayFailed,set:e=>{Rl.onAudioAutoplayFailed=e}},onAutoplayFailed:{get:()=>Rl.onAutoplayFailed,set:e=>{Rl.onAutoplayFailed=e}},_onSecurityPolicyViolation:{value:void 0,writable:!0},_cspEventHandlerPointer:{value:void 0,writable:!0},onSecurityPolicyViolation:{get:()=>R._onSecurityPolicyViolation,set(e){R._onSecurityPolicyViolation=e,D1(e)}},__CLIENT_LIST__:{get:()=>me("SHOW_GLOBAL_CLIENT_LIST")?LS:[]}}),Fc.on(no.CAMERA_DEVICE_CHANGED,e=>{G.info("camera device changed",JSON.stringify(e)),R.onCameraChanged&&R.onCameraChanged(e),R.safeEmit(Kp.CAMERA_CHANGED,e)}),Fc.on(no.RECORDING_DEVICE_CHANGED,e=>{G.info("microphone device changed",JSON.stringify(e)),R.onMicrophoneChanged&&R.onMicrophoneChanged(e),R.safeEmit(Kp.MICROPHONE_CHANGED,e)}),Fc.on(no.PLAYOUT_DEVICE_CHANGED,e=>{G.debug("playout device changed",JSON.stringify(e)),R.onPlaybackDeviceChanged&&R.onPlaybackDeviceChanged(e),R.safeEmit(Kp.PLAYBACK_DEVICE_CHANGED,e)}),dc.onAutoplayFailed=()=>{G.info("detect audio element autoplay failed"),Rl.onAudioAutoplayFailed&&Rl.onAudioAutoplayFailed()},Rr.on("autoplay-failed",()=>{G.info("detect webaudio autoplay failed"),Rl.onAudioAutoplayFailed&&Rl.onAudioAutoplayFailed(),R.safeEmit(Kp.AUTOPLAY_FAILED)}),Rr.on(xa.STATE_CHANGE,(e,t)=>{G.info("audio context state changed: ".concat(t," => ").concat(e)),R.onAudioContextStateChanged&&R.onAudioContextStateChanged(e,t),R.safeEmit(Kp.AUDIO_CONTEXT_STATE_CHANGED,e,t)}),na.on(SS.NETWORK_STATE_CHANGE,(e,t)=>{G.info("[network-indicator] network state changed, ".concat(t," => ").concat(e))}),window&&(window.__ARTC__=R),R})}(U7)),U7.exports}var bbe=Tbe();const j7=_G(bbe),C5={black:"#000",white:"#fff"},tP={300:"#e57373",400:"#ef5350",500:"#f44336",700:"#d32f2f",800:"#c62828"},nP={50:"#f3e5f5",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",700:"#7b1fa2"},rP={50:"#e3f2fd",200:"#90caf9",400:"#42a5f5",700:"#1976d2",800:"#1565c0"},iP={300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",700:"#0288d1",900:"#01579b"},aP={300:"#81c784",400:"#66bb6a",500:"#4caf50",700:"#388e3c",800:"#2e7d32",900:"#1b5e20"},Gj={300:"#ffb74d",400:"#ffa726",500:"#ff9800",700:"#f57c00",900:"#e65100"},Cbe={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"};function zA(o,...d){const h=new URL(`https://mui.com/production-error/?code=${o}`);return d.forEach(g=>h.searchParams.append("args[]",g)),`Minified MUI error #${o}; visit ${h} for the full message.`}const _ce="$$material";function sG(){return sG=Object.assign?Object.assign.bind():function(o){for(var d=1;d<arguments.length;d++){var h=arguments[d];for(var g in h)({}).hasOwnProperty.call(h,g)&&(o[g]=h[g])}return o},sG.apply(null,arguments)}function wbe(o){if(o.sheet)return o.sheet;for(var d=0;d<document.styleSheets.length;d++)if(document.styleSheets[d].ownerNode===o)return document.styleSheets[d]}function Rbe(o){var d=document.createElement("style");return d.setAttribute("data-emotion",o.key),o.nonce!==void 0&&d.setAttribute("nonce",o.nonce),d.appendChild(document.createTextNode("")),d.setAttribute("data-s",""),d}var Ibe=function(){function o(h){var g=this;this._insertTag=function(T){var I;g.tags.length===0?g.insertionPoint?I=g.insertionPoint.nextSibling:g.prepend?I=g.container.firstChild:I=g.before:I=g.tags[g.tags.length-1].nextSibling,g.container.insertBefore(T,I),g.tags.push(T)},this.isSpeedy=h.speedy===void 0?!0:h.speedy,this.tags=[],this.ctr=0,this.nonce=h.nonce,this.key=h.key,this.container=h.container,this.prepend=h.prepend,this.insertionPoint=h.insertionPoint,this.before=null}var d=o.prototype;return d.hydrate=function(g){g.forEach(this._insertTag)},d.insert=function(g){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(Rbe(this));var T=this.tags[this.tags.length-1];if(this.isSpeedy){var I=wbe(T);try{I.insertRule(g,I.cssRules.length)}catch{}}else T.appendChild(document.createTextNode(g));this.ctr++},d.flush=function(){this.tags.forEach(function(g){var T;return(T=g.parentNode)==null?void 0:T.removeChild(g)}),this.tags=[],this.ctr=0},o}(),_d="-ms-",oG="-moz-",pa="-webkit-",Ece="comm",gZ="rule",_Z="decl",Abe="@import",vce="@keyframes",Obe="@layer",Nbe=Math.abs,qG=String.fromCharCode,Lbe=Object.assign;function Dbe(o,d){return kl(o,0)^45?(((d<<2^kl(o,0))<<2^kl(o,1))<<2^kl(o,2))<<2^kl(o,3):0}function Sce(o){return o.trim()}function Pbe(o,d){return(o=d.exec(o))?o[0]:o}function ma(o,d,h){return o.replace(d,h)}function $X(o,d){return o.indexOf(d)}function kl(o,d){return o.charCodeAt(d)|0}function w5(o,d,h){return o.slice(d,h)}function dE(o){return o.length}function EZ(o){return o.length}function g7(o,d){return d.push(o),o}function Mbe(o,d){return o.map(d).join("")}var JG=1,IP=1,yce=0,bf=0,Xo=0,FP="";function XG(o,d,h,g,T,I,N){return{value:o,root:d,parent:h,type:g,props:T,children:I,line:JG,column:IP,length:N,return:""}}function zj(o,d){return Lbe(XG("",null,null,"",null,null,0),o,{length:-o.length},d)}function kbe(){return Xo}function xbe(){return Xo=bf>0?kl(FP,--bf):0,IP--,Xo===10&&(IP=1,JG--),Xo}function Mh(){return Xo=bf<yce?kl(FP,bf++):0,IP++,Xo===10&&(IP=1,JG++),Xo}function mE(){return kl(FP,bf)}function V7(){return bf}function K5(o,d){return w5(FP,o,d)}function R5(o){switch(o){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function Tce(o){return JG=IP=1,yce=dE(FP=o),bf=0,[]}function bce(o){return FP="",o}function B7(o){return Sce(K5(bf-1,eQ(o===91?o+2:o===40?o+1:o)))}function Ube(o){for(;(Xo=mE())&&Xo<33;)Mh();return R5(o)>2||R5(Xo)>3?"":" "}function jbe(o,d){for(;--d&&Mh()&&!(Xo<48||Xo>102||Xo>57&&Xo<65||Xo>70&&Xo<97););return K5(o,V7()+(d<6&&mE()==32&&Mh()==32))}function eQ(o){for(;Mh();)switch(Xo){case o:return bf;case 34:case 39:o!==34&&o!==39&&eQ(Xo);break;case 40:o===41&&eQ(o);break;case 92:Mh();break}return bf}function Vbe(o,d){for(;Mh()&&o+Xo!==57;)if(o+Xo===84&&mE()===47)break;return"/*"+K5(d,bf-1)+"*"+qG(o===47?o:Mh())}function Bbe(o){for(;!R5(mE());)Mh();return K5(o,bf)}function Fbe(o){return bce(F7("",null,null,null,[""],o=Tce(o),0,[0],o))}function F7(o,d,h,g,T,I,N,M,k){for(var x=0,V=0,K=N,Q=0,ie=0,X=0,Z=1,ae=1,le=1,fe=0,ue="",de=T,te=I,ye=g,Te=ue;ae;)switch(X=fe,fe=Mh()){case 40:if(X!=108&&kl(Te,K-1)==58){$X(Te+=ma(B7(fe),"&","&\f"),"&\f")!=-1&&(le=-1);break}case 34:case 39:case 91:Te+=B7(fe);break;case 9:case 10:case 13:case 32:Te+=Ube(X);break;case 92:Te+=jbe(V7()-1,7);continue;case 47:switch(mE()){case 42:case 47:g7(Gbe(Vbe(Mh(),V7()),d,h),k);break;default:Te+="/"}break;case 123*Z:M[x++]=dE(Te)*le;case 125*Z:case 59:case 0:switch(fe){case 0:case 125:ae=0;case 59+V:le==-1&&(Te=ma(Te,/\f/g,"")),ie>0&&dE(Te)-K&&g7(ie>32?Zee(Te+";",g,h,K-1):Zee(ma(Te," ","")+";",g,h,K-2),k);break;case 59:Te+=";";default:if(g7(ye=Qee(Te,d,h,x,V,T,M,ue,de=[],te=[],K),I),fe===123)if(V===0)F7(Te,d,ye,ye,de,I,K,M,te);else switch(Q===99&&kl(Te,3)===110?100:Q){case 100:case 108:case 109:case 115:F7(o,ye,ye,g&&g7(Qee(o,ye,ye,0,0,T,M,ue,T,de=[],K),te),T,te,K,M,g?de:te);break;default:F7(Te,ye,ye,ye,[""],te,0,M,te)}}x=V=ie=0,Z=le=1,ue=Te="",K=N;break;case 58:K=1+dE(Te),ie=X;default:if(Z<1){if(fe==123)--Z;else if(fe==125&&Z++==0&&xbe()==125)continue}switch(Te+=qG(fe),fe*Z){case 38:le=V>0?1:(Te+="\f",-1);break;case 44:M[x++]=(dE(Te)-1)*le,le=1;break;case 64:mE()===45&&(Te+=B7(Mh())),Q=mE(),V=K=dE(ue=Te+=Bbe(V7())),fe++;break;case 45:X===45&&dE(Te)==2&&(Z=0)}}return I}function Qee(o,d,h,g,T,I,N,M,k,x,V){for(var K=T-1,Q=T===0?I:[""],ie=EZ(Q),X=0,Z=0,ae=0;X<g;++X)for(var le=0,fe=w5(o,K+1,K=Nbe(Z=N[X])),ue=o;le<ie;++le)(ue=Sce(Z>0?Q[le]+" "+fe:ma(fe,/&\f/g,Q[le])))&&(k[ae++]=ue);return XG(o,d,h,T===0?gZ:M,k,x,V)}function Gbe(o,d,h){return XG(o,d,h,Ece,qG(kbe()),w5(o,2,-2),0)}function Zee(o,d,h,g){return XG(o,d,h,_Z,w5(o,0,g),w5(o,g+1,-1),g)}function vP(o,d){for(var h="",g=EZ(o),T=0;T<g;T++)h+=d(o[T],T,o,d)||"";return h}function zbe(o,d,h,g){switch(o.type){case Obe:if(o.children.length)break;case Abe:case _Z:return o.return=o.return||o.value;case Ece:return"";case vce:return o.return=o.value+"{"+vP(o.children,g)+"}";case gZ:o.value=o.props.join(",")}return dE(h=vP(o.children,g))?o.return=o.value+"{"+h+"}":""}function Hbe(o){var d=EZ(o);return function(h,g,T,I){for(var N="",M=0;M<d;M++)N+=o[M](h,g,T,I)||"";return N}}function Wbe(o){return function(d){d.root||(d=d.return)&&o(d)}}function Cce(o){var d=Object.create(null);return function(h){return d[h]===void 0&&(d[h]=o(h)),d[h]}}var Ybe=function(d,h,g){for(var T=0,I=0;T=I,I=mE(),T===38&&I===12&&(h[g]=1),!R5(I);)Mh();return K5(d,bf)},Kbe=function(d,h){var g=-1,T=44;do switch(R5(T)){case 0:T===38&&mE()===12&&(h[g]=1),d[g]+=Ybe(bf-1,h,g);break;case 2:d[g]+=B7(T);break;case 4:if(T===44){d[++g]=mE()===58?"&\f":"",h[g]=d[g].length;break}default:d[g]+=qG(T)}while(T=Mh());return d},qbe=function(d,h){return bce(Kbe(Tce(d),h))},$ee=new WeakMap,Jbe=function(d){if(!(d.type!=="rule"||!d.parent||d.length<1)){for(var h=d.value,g=d.parent,T=d.column===g.column&&d.line===g.line;g.type!=="rule";)if(g=g.parent,!g)return;if(!(d.props.length===1&&h.charCodeAt(0)!==58&&!$ee.get(g))&&!T){$ee.set(d,!0);for(var I=[],N=qbe(h,I),M=g.props,k=0,x=0;k<N.length;k++)for(var V=0;V<M.length;V++,x++)d.props[x]=I[k]?N[k].replace(/&\f/g,M[V]):M[V]+" "+N[k]}}},Xbe=function(d){if(d.type==="decl"){var h=d.value;h.charCodeAt(0)===108&&h.charCodeAt(2)===98&&(d.return="",d.value="")}};function wce(o,d){switch(Dbe(o,d)){case 5103:return pa+"print-"+o+o;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return pa+o+o;case 5349:case 4246:case 4810:case 6968:case 2756:return pa+o+oG+o+_d+o+o;case 6828:case 4268:return pa+o+_d+o+o;case 6165:return pa+o+_d+"flex-"+o+o;case 5187:return pa+o+ma(o,/(\w+).+(:[^]+)/,pa+"box-$1$2"+_d+"flex-$1$2")+o;case 5443:return pa+o+_d+"flex-item-"+ma(o,/flex-|-self/,"")+o;case 4675:return pa+o+_d+"flex-line-pack"+ma(o,/align-content|flex-|-self/,"")+o;case 5548:return pa+o+_d+ma(o,"shrink","negative")+o;case 5292:return pa+o+_d+ma(o,"basis","preferred-size")+o;case 6060:return pa+"box-"+ma(o,"-grow","")+pa+o+_d+ma(o,"grow","positive")+o;case 4554:return pa+ma(o,/([^-])(transform)/g,"$1"+pa+"$2")+o;case 6187:return ma(ma(ma(o,/(zoom-|grab)/,pa+"$1"),/(image-set)/,pa+"$1"),o,"")+o;case 5495:case 3959:return ma(o,/(image-set\([^]*)/,pa+"$1$`$1");case 4968:return ma(ma(o,/(.+:)(flex-)?(.*)/,pa+"box-pack:$3"+_d+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+pa+o+o;case 4095:case 3583:case 4068:case 2532:return ma(o,/(.+)-inline(.+)/,pa+"$1$2")+o;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(dE(o)-1-d>6)switch(kl(o,d+1)){case 109:if(kl(o,d+4)!==45)break;case 102:return ma(o,/(.+:)(.+)-([^]+)/,"$1"+pa+"$2-$3$1"+oG+(kl(o,d+3)==108?"$3":"$2-$3"))+o;case 115:return~$X(o,"stretch")?wce(ma(o,"stretch","fill-available"),d)+o:o}break;case 4949:if(kl(o,d+1)!==115)break;case 6444:switch(kl(o,dE(o)-3-(~$X(o,"!important")&&10))){case 107:return ma(o,":",":"+pa)+o;case 101:return ma(o,/(.+:)([^;!]+)(;|!.+)?/,"$1"+pa+(kl(o,14)===45?"inline-":"")+"box$3$1"+pa+"$2$3$1"+_d+"$2box$3")+o}break;case 5936:switch(kl(o,d+11)){case 114:return pa+o+_d+ma(o,/[svh]\w+-[tblr]{2}/,"tb")+o;case 108:return pa+o+_d+ma(o,/[svh]\w+-[tblr]{2}/,"tb-rl")+o;case 45:return pa+o+_d+ma(o,/[svh]\w+-[tblr]{2}/,"lr")+o}return pa+o+_d+o+o}return o}var Qbe=function(d,h,g,T){if(d.length>-1&&!d.return)switch(d.type){case _Z:d.return=wce(d.value,d.length);break;case vce:return vP([zj(d,{value:ma(d.value,"@","@"+pa)})],T);case gZ:if(d.length)return Mbe(d.props,function(I){switch(Pbe(I,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return vP([zj(d,{props:[ma(I,/:(read-\w+)/,":"+oG+"$1")]})],T);case"::placeholder":return vP([zj(d,{props:[ma(I,/:(plac\w+)/,":"+pa+"input-$1")]}),zj(d,{props:[ma(I,/:(plac\w+)/,":"+oG+"$1")]}),zj(d,{props:[ma(I,/:(plac\w+)/,_d+"input-$1")]})],T)}return""})}},Zbe=[Qbe],$be=function(d){var h=d.key;if(h==="css"){var g=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(g,function(Z){var ae=Z.getAttribute("data-emotion");ae.indexOf(" ")!==-1&&(document.head.appendChild(Z),Z.setAttribute("data-s",""))})}var T=d.stylisPlugins||Zbe,I={},N,M=[];N=d.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+h+' "]'),function(Z){for(var ae=Z.getAttribute("data-emotion").split(" "),le=1;le<ae.length;le++)I[ae[le]]=!0;M.push(Z)});var k,x=[Jbe,Xbe];{var V,K=[zbe,Wbe(function(Z){V.insert(Z)})],Q=Hbe(x.concat(T,K)),ie=function(ae){return vP(Fbe(ae),Q)};k=function(ae,le,fe,ue){V=fe,ie(ae?ae+"{"+le.styles+"}":le.styles),ue&&(X.inserted[le.name]=!0)}}var X={key:h,sheet:new Ibe({key:h,container:N,nonce:d.nonce,speedy:d.speedy,prepend:d.prepend,insertionPoint:d.insertionPoint}),nonce:d.nonce,inserted:I,registered:{},insert:k};return X.sheet.hydrate(M),X},ZK={exports:{}},Ca={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ete;function e1e(){if(ete)return Ca;ete=1;var o=typeof Symbol=="function"&&Symbol.for,d=o?Symbol.for("react.element"):60103,h=o?Symbol.for("react.portal"):60106,g=o?Symbol.for("react.fragment"):60107,T=o?Symbol.for("react.strict_mode"):60108,I=o?Symbol.for("react.profiler"):60114,N=o?Symbol.for("react.provider"):60109,M=o?Symbol.for("react.context"):60110,k=o?Symbol.for("react.async_mode"):60111,x=o?Symbol.for("react.concurrent_mode"):60111,V=o?Symbol.for("react.forward_ref"):60112,K=o?Symbol.for("react.suspense"):60113,Q=o?Symbol.for("react.suspense_list"):60120,ie=o?Symbol.for("react.memo"):60115,X=o?Symbol.for("react.lazy"):60116,Z=o?Symbol.for("react.block"):60121,ae=o?Symbol.for("react.fundamental"):60117,le=o?Symbol.for("react.responder"):60118,fe=o?Symbol.for("react.scope"):60119;function ue(te){if(typeof te=="object"&&te!==null){var ye=te.$$typeof;switch(ye){case d:switch(te=te.type,te){case k:case x:case g:case I:case T:case K:return te;default:switch(te=te&&te.$$typeof,te){case M:case V:case X:case ie:case N:return te;default:return ye}}case h:return ye}}}function de(te){return ue(te)===x}return Ca.AsyncMode=k,Ca.ConcurrentMode=x,Ca.ContextConsumer=M,Ca.ContextProvider=N,Ca.Element=d,Ca.ForwardRef=V,Ca.Fragment=g,Ca.Lazy=X,Ca.Memo=ie,Ca.Portal=h,Ca.Profiler=I,Ca.StrictMode=T,Ca.Suspense=K,Ca.isAsyncMode=function(te){return de(te)||ue(te)===k},Ca.isConcurrentMode=de,Ca.isContextConsumer=function(te){return ue(te)===M},Ca.isContextProvider=function(te){return ue(te)===N},Ca.isElement=function(te){return typeof te=="object"&&te!==null&&te.$$typeof===d},Ca.isForwardRef=function(te){return ue(te)===V},Ca.isFragment=function(te){return ue(te)===g},Ca.isLazy=function(te){return ue(te)===X},Ca.isMemo=function(te){return ue(te)===ie},Ca.isPortal=function(te){return ue(te)===h},Ca.isProfiler=function(te){return ue(te)===I},Ca.isStrictMode=function(te){return ue(te)===T},Ca.isSuspense=function(te){return ue(te)===K},Ca.isValidElementType=function(te){return typeof te=="string"||typeof te=="function"||te===g||te===x||te===I||te===T||te===K||te===Q||typeof te=="object"&&te!==null&&(te.$$typeof===X||te.$$typeof===ie||te.$$typeof===N||te.$$typeof===M||te.$$typeof===V||te.$$typeof===ae||te.$$typeof===le||te.$$typeof===fe||te.$$typeof===Z)},Ca.typeOf=ue,Ca}var tte;function t1e(){return tte||(tte=1,ZK.exports=e1e()),ZK.exports}var $K,nte;function n1e(){if(nte)return $K;nte=1;var o=t1e(),d={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},h={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},g={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},T={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},I={};I[o.ForwardRef]=g,I[o.Memo]=T;function N(X){return o.isMemo(X)?T:I[X.$$typeof]||d}var M=Object.defineProperty,k=Object.getOwnPropertyNames,x=Object.getOwnPropertySymbols,V=Object.getOwnPropertyDescriptor,K=Object.getPrototypeOf,Q=Object.prototype;function ie(X,Z,ae){if(typeof Z!="string"){if(Q){var le=K(Z);le&&le!==Q&&ie(X,le,ae)}var fe=k(Z);x&&(fe=fe.concat(x(Z)));for(var ue=N(X),de=N(Z),te=0;te<fe.length;++te){var ye=fe[te];if(!h[ye]&&!(ae&&ae[ye])&&!(de&&de[ye])&&!(ue&&ue[ye])){var Te=V(Z,ye);try{M(X,ye,Te)}catch{}}}}return X}return $K=ie,$K}n1e();var r1e=!0;function Rce(o,d,h){var g="";return h.split(" ").forEach(function(T){o[T]!==void 0?d.push(o[T]+";"):T&&(g+=T+" ")}),g}var vZ=function(d,h,g){var T=d.key+"-"+h.name;(g===!1||r1e===!1)&&d.registered[T]===void 0&&(d.registered[T]=h.styles)},Ice=function(d,h,g){vZ(d,h,g);var T=d.key+"-"+h.name;if(d.inserted[h.name]===void 0){var I=h;do d.insert(h===I?"."+T:"",I,d.sheet,!0),I=I.next;while(I!==void 0)}};function i1e(o){for(var d=0,h,g=0,T=o.length;T>=4;++g,T-=4)h=o.charCodeAt(g)&255|(o.charCodeAt(++g)&255)<<8|(o.charCodeAt(++g)&255)<<16|(o.charCodeAt(++g)&255)<<24,h=(h&65535)*1540483477+((h>>>16)*59797<<16),h^=h>>>24,d=(h&65535)*1540483477+((h>>>16)*59797<<16)^(d&65535)*1540483477+((d>>>16)*59797<<16);switch(T){case 3:d^=(o.charCodeAt(g+2)&255)<<16;case 2:d^=(o.charCodeAt(g+1)&255)<<8;case 1:d^=o.charCodeAt(g)&255,d=(d&65535)*1540483477+((d>>>16)*59797<<16)}return d^=d>>>13,d=(d&65535)*1540483477+((d>>>16)*59797<<16),((d^d>>>15)>>>0).toString(36)}var a1e={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},s1e=/[A-Z]|^ms/g,o1e=/_EMO_([^_]+?)_([^]*?)_EMO_/g,Ace=function(d){return d.charCodeAt(1)===45},rte=function(d){return d!=null&&typeof d!="boolean"},eq=Cce(function(o){return Ace(o)?o:o.replace(s1e,"-$&").toLowerCase()}),ite=function(d,h){switch(d){case"animation":case"animationName":if(typeof h=="string")return h.replace(o1e,function(g,T,I){return uE={name:T,styles:I,next:uE},T})}return a1e[d]!==1&&!Ace(d)&&typeof h=="number"&&h!==0?h+"px":h};function I5(o,d,h){if(h==null)return"";var g=h;if(g.__emotion_styles!==void 0)return g;switch(typeof h){case"boolean":return"";case"object":{var T=h;if(T.anim===1)return uE={name:T.name,styles:T.styles,next:uE},T.name;var I=h;if(I.styles!==void 0){var N=I.next;if(N!==void 0)for(;N!==void 0;)uE={name:N.name,styles:N.styles,next:uE},N=N.next;var M=I.styles+";";return M}return c1e(o,d,h)}case"function":{if(o!==void 0){var k=uE,x=h(o);return uE=k,I5(o,d,x)}break}}var V=h;if(d==null)return V;var K=d[V];return K!==void 0?K:V}function c1e(o,d,h){var g="";if(Array.isArray(h))for(var T=0;T<h.length;T++)g+=I5(o,d,h[T])+";";else for(var I in h){var N=h[I];if(typeof N!="object"){var M=N;d!=null&&d[M]!==void 0?g+=I+"{"+d[M]+"}":rte(M)&&(g+=eq(I)+":"+ite(I,M)+";")}else if(Array.isArray(N)&&typeof N[0]=="string"&&(d==null||d[N[0]]===void 0))for(var k=0;k<N.length;k++)rte(N[k])&&(g+=eq(I)+":"+ite(I,N[k])+";");else{var x=I5(o,d,N);switch(I){case"animation":case"animationName":{g+=eq(I)+":"+x+";";break}default:g+=I+"{"+x+"}"}}}return g}var ate=/label:\s*([^\s;{]+)\s*(;|$)/g,uE;function QG(o,d,h){if(o.length===1&&typeof o[0]=="object"&&o[0]!==null&&o[0].styles!==void 0)return o[0];var g=!0,T="";uE=void 0;var I=o[0];if(I==null||I.raw===void 0)g=!1,T+=I5(h,d,I);else{var N=I;T+=N[0]}for(var M=1;M<o.length;M++)if(T+=I5(h,d,o[M]),g){var k=I;T+=k[M]}ate.lastIndex=0;for(var x="",V;(V=ate.exec(T))!==null;)x+="-"+V[1];var K=i1e(T)+x;return{name:K,styles:T,next:uE}}var l1e=function(d){return d()},d1e=AX.useInsertionEffect?AX.useInsertionEffect:!1,Oce=d1e||l1e,Nce=q.createContext(typeof HTMLElement<"u"?$be({key:"css"}):null);Nce.Provider;var Lce=function(d){return q.forwardRef(function(h,g){var T=q.useContext(Nce);return d(h,T,g)})},SZ=q.createContext({}),yZ={}.hasOwnProperty,tQ="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",u1e=function(d,h){var g={};for(var T in h)yZ.call(h,T)&&(g[T]=h[T]);return g[tQ]=d,g},f1e=function(d){var h=d.cache,g=d.serialized,T=d.isStringTag;return vZ(h,g,T),Oce(function(){return Ice(h,g,T)}),null},h1e=Lce(function(o,d,h){var g=o.css;typeof g=="string"&&d.registered[g]!==void 0&&(g=d.registered[g]);var T=o[tQ],I=[g],N="";typeof o.className=="string"?N=Rce(d.registered,I,o.className):o.className!=null&&(N=o.className+" ");var M=QG(I,void 0,q.useContext(SZ));N+=d.key+"-"+M.name;var k={};for(var x in o)yZ.call(o,x)&&x!=="css"&&x!==tQ&&(k[x]=o[x]);return k.className=N,h&&(k.ref=h),q.createElement(q.Fragment,null,q.createElement(f1e,{cache:d,serialized:M,isStringTag:typeof T=="string"}),q.createElement(T,k))}),p1e=h1e,ste=function(d,h){var g=arguments;if(h==null||!yZ.call(h,"css"))return q.createElement.apply(void 0,g);var T=g.length,I=new Array(T);I[0]=p1e,I[1]=u1e(d,h);for(var N=2;N<T;N++)I[N]=g[N];return q.createElement.apply(null,I)};(function(o){var d;d||(d=o.JSX||(o.JSX={}))})(ste||(ste={}));function TZ(){for(var o=arguments.length,d=new Array(o),h=0;h<o;h++)d[h]=arguments[h];return QG(d)}function q5(){var o=TZ.apply(void 0,arguments),d="animation-"+o.name;return{name:d,styles:"@keyframes "+d+"{"+o.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}var m1e=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|fetchpriority|fetchPriority|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,g1e=Cce(function(o){return m1e.test(o)||o.charCodeAt(0)===111&&o.charCodeAt(1)===110&&o.charCodeAt(2)<91}),_1e=g1e,E1e=function(d){return d!=="theme"},ote=function(d){return typeof d=="string"&&d.charCodeAt(0)>96?_1e:E1e},cte=function(d,h,g){var T;if(h){var I=h.shouldForwardProp;T=d.__emotion_forwardProp&&I?function(N){return d.__emotion_forwardProp(N)&&I(N)}:I}return typeof T!="function"&&g&&(T=d.__emotion_forwardProp),T},v1e=function(d){var h=d.cache,g=d.serialized,T=d.isStringTag;return vZ(h,g,T),Oce(function(){return Ice(h,g,T)}),null},S1e=function o(d,h){var g=d.__emotion_real===d,T=g&&d.__emotion_base||d,I,N;h!==void 0&&(I=h.label,N=h.target);var M=cte(d,h,g),k=M||ote(T),x=!k("as");return function(){var V=arguments,K=g&&d.__emotion_styles!==void 0?d.__emotion_styles.slice(0):[];if(I!==void 0&&K.push("label:"+I+";"),V[0]==null||V[0].raw===void 0)K.push.apply(K,V);else{var Q=V[0];K.push(Q[0]);for(var ie=V.length,X=1;X<ie;X++)K.push(V[X],Q[X])}var Z=Lce(function(ae,le,fe){var ue=x&&ae.as||T,de="",te=[],ye=ae;if(ae.theme==null){ye={};for(var Te in ae)ye[Te]=ae[Te];ye.theme=q.useContext(SZ)}typeof ae.className=="string"?de=Rce(le.registered,te,ae.className):ae.className!=null&&(de=ae.className+" ");var Le=QG(K.concat(te),le.registered,ye);de+=le.key+"-"+Le.name,N!==void 0&&(de+=" "+N);var je=x&&M===void 0?ote(ue):k,he={};for(var ke in ae)x&&ke==="as"||je(ke)&&(he[ke]=ae[ke]);return he.className=de,fe&&(he.ref=fe),q.createElement(q.Fragment,null,q.createElement(v1e,{cache:le,serialized:Le,isStringTag:typeof ue=="string"}),q.createElement(ue,he))});return Z.displayName=I!==void 0?I:"Styled("+(typeof T=="string"?T:T.displayName||T.name||"Component")+")",Z.defaultProps=d.defaultProps,Z.__emotion_real=Z,Z.__emotion_base=T,Z.__emotion_styles=K,Z.__emotion_forwardProp=M,Object.defineProperty(Z,"toString",{value:function(){return"."+N}}),Z.withComponent=function(ae,le){var fe=o(ae,sG({},h,le,{shouldForwardProp:cte(Z,le,!0)}));return fe.apply(void 0,K)},Z}},y1e=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],nQ=S1e.bind(null);y1e.forEach(function(o){nQ[o]=nQ(o)});function T1e(o,d){return nQ(o,d)}function b1e(o,d){Array.isArray(o.__emotion_styles)&&(o.__emotion_styles=d(o.__emotion_styles))}const lte=[];function UA(o){return lte[0]=o,QG(lte)}var tq={exports:{}},Ba={};/**
 * @license React
 * react-is.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dte;function C1e(){if(dte)return Ba;dte=1;var o=Symbol.for("react.transitional.element"),d=Symbol.for("react.portal"),h=Symbol.for("react.fragment"),g=Symbol.for("react.strict_mode"),T=Symbol.for("react.profiler"),I=Symbol.for("react.consumer"),N=Symbol.for("react.context"),M=Symbol.for("react.forward_ref"),k=Symbol.for("react.suspense"),x=Symbol.for("react.suspense_list"),V=Symbol.for("react.memo"),K=Symbol.for("react.lazy"),Q=Symbol.for("react.view_transition"),ie=Symbol.for("react.client.reference");function X(Z){if(typeof Z=="object"&&Z!==null){var ae=Z.$$typeof;switch(ae){case o:switch(Z=Z.type,Z){case h:case T:case g:case k:case x:case Q:return Z;default:switch(Z=Z&&Z.$$typeof,Z){case N:case M:case K:case V:return Z;case I:return Z;default:return ae}}case d:return ae}}}return Ba.ContextConsumer=I,Ba.ContextProvider=N,Ba.Element=o,Ba.ForwardRef=M,Ba.Fragment=h,Ba.Lazy=K,Ba.Memo=V,Ba.Portal=d,Ba.Profiler=T,Ba.StrictMode=g,Ba.Suspense=k,Ba.SuspenseList=x,Ba.isContextConsumer=function(Z){return X(Z)===I},Ba.isContextProvider=function(Z){return X(Z)===N},Ba.isElement=function(Z){return typeof Z=="object"&&Z!==null&&Z.$$typeof===o},Ba.isForwardRef=function(Z){return X(Z)===M},Ba.isFragment=function(Z){return X(Z)===h},Ba.isLazy=function(Z){return X(Z)===K},Ba.isMemo=function(Z){return X(Z)===V},Ba.isPortal=function(Z){return X(Z)===d},Ba.isProfiler=function(Z){return X(Z)===T},Ba.isStrictMode=function(Z){return X(Z)===g},Ba.isSuspense=function(Z){return X(Z)===k},Ba.isSuspenseList=function(Z){return X(Z)===x},Ba.isValidElementType=function(Z){return typeof Z=="string"||typeof Z=="function"||Z===h||Z===T||Z===g||Z===k||Z===x||typeof Z=="object"&&Z!==null&&(Z.$$typeof===K||Z.$$typeof===V||Z.$$typeof===N||Z.$$typeof===I||Z.$$typeof===M||Z.$$typeof===ie||Z.getModuleId!==void 0)},Ba.typeOf=X,Ba}var ute;function w1e(){return ute||(ute=1,tq.exports=C1e()),tq.exports}var Dce=w1e();function ly(o){if(typeof o!="object"||o===null)return!1;const d=Object.getPrototypeOf(o);return(d===null||d===Object.prototype||Object.getPrototypeOf(d)===null)&&!(Symbol.toStringTag in o)&&!(Symbol.iterator in o)}function Pce(o){if(q.isValidElement(o)||Dce.isValidElementType(o)||!ly(o))return o;const d={};return Object.keys(o).forEach(h=>{d[h]=Pce(o[h])}),d}function kh(o,d,h={clone:!0}){const g=h.clone?{...o}:o;return ly(o)&&ly(d)&&Object.keys(d).forEach(T=>{q.isValidElement(d[T])||Dce.isValidElementType(d[T])?g[T]=d[T]:ly(d[T])&&Object.prototype.hasOwnProperty.call(o,T)&&ly(o[T])?g[T]=kh(o[T],d[T],h):h.clone?g[T]=ly(d[T])?Pce(d[T]):d[T]:g[T]=d[T]}),g}const R1e=o=>{const d=Object.keys(o).map(h=>({key:h,val:o[h]}))||[];return d.sort((h,g)=>h.val-g.val),d.reduce((h,g)=>({...h,[g.key]:g.val}),{})};function I1e(o){const{values:d={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:h="px",step:g=5,...T}=o,I=R1e(d),N=Object.keys(I);function M(Q){return`@media (min-width:${typeof d[Q]=="number"?d[Q]:Q}${h})`}function k(Q){return`@media (max-width:${(typeof d[Q]=="number"?d[Q]:Q)-g/100}${h})`}function x(Q,ie){const X=N.indexOf(ie);return`@media (min-width:${typeof d[Q]=="number"?d[Q]:Q}${h}) and (max-width:${(X!==-1&&typeof d[N[X]]=="number"?d[N[X]]:ie)-g/100}${h})`}function V(Q){return N.indexOf(Q)+1<N.length?x(Q,N[N.indexOf(Q)+1]):M(Q)}function K(Q){const ie=N.indexOf(Q);return ie===0?M(N[1]):ie===N.length-1?k(N[ie]):x(Q,N[N.indexOf(Q)+1]).replace("@media","@media not all and")}return{keys:N,values:I,up:M,down:k,between:x,only:V,not:K,unit:h,...T}}function fte(o,d){if(!o.containerQueries)return d;const h=Object.keys(d).filter(g=>g.startsWith("@container")).sort((g,T)=>{var N,M;const I=/min-width:\s*([0-9.]+)/;return+(((N=g.match(I))==null?void 0:N[1])||0)-+(((M=T.match(I))==null?void 0:M[1])||0)});return h.length?h.reduce((g,T)=>{const I=d[T];return delete g[T],g[T]=I,g},{...d}):d}function A1e(o,d){return d==="@"||d.startsWith("@")&&(o.some(h=>d.startsWith(`@${h}`))||!!d.match(/^@\d/))}function O1e(o,d){const h=d.match(/^@([^/]+)?\/?(.+)?$/);if(!h)return null;const[,g,T]=h,I=Number.isNaN(+g)?g||0:+g;return o.containerQueries(T).up(I)}function N1e(o){const d=(I,N)=>I.replace("@media",N?`@container ${N}`:"@container");function h(I,N){I.up=(...M)=>d(o.breakpoints.up(...M),N),I.down=(...M)=>d(o.breakpoints.down(...M),N),I.between=(...M)=>d(o.breakpoints.between(...M),N),I.only=(...M)=>d(o.breakpoints.only(...M),N),I.not=(...M)=>{const k=d(o.breakpoints.not(...M),N);return k.includes("not all and")?k.replace("not all and ","").replace("min-width:","width<").replace("max-width:","width>").replace("and","or"):k}}const g={},T=I=>(h(g,I),g);return h(T),{...o,containerQueries:T}}const L1e={borderRadius:4};function o5(o,d){return d?kh(o,d,{clone:!1}):o}const ZG={xs:0,sm:600,md:900,lg:1200,xl:1536},hte={keys:["xs","sm","md","lg","xl"],up:o=>`@media (min-width:${ZG[o]}px)`},D1e={containerQueries:o=>({up:d=>{let h=typeof d=="number"?d:ZG[d]||d;return typeof h=="number"&&(h=`${h}px`),o?`@container ${o} (min-width:${h})`:`@container (min-width:${h})`}})};function Ey(o,d,h){const g=o.theme||{};if(Array.isArray(d)){const I=g.breakpoints||hte;return d.reduce((N,M,k)=>(N[I.up(I.keys[k])]=h(d[k]),N),{})}if(typeof d=="object"){const I=g.breakpoints||hte;return Object.keys(d).reduce((N,M)=>{if(A1e(I.keys,M)){const k=O1e(g.containerQueries?g:D1e,M);k&&(N[k]=h(d[M],M))}else if(Object.keys(I.values||ZG).includes(M)){const k=I.up(M);N[k]=h(d[M],M)}else{const k=M;N[k]=d[k]}return N},{})}return h(d)}function P1e(o={}){var h;return((h=o.keys)==null?void 0:h.reduce((g,T)=>{const I=o.up(T);return g[I]={},g},{}))||{}}function pte(o,d){return o.reduce((h,g)=>{const T=h[g];return(!T||Object.keys(T).length===0)&&delete h[g],h},d)}function Nn(o){if(typeof o!="string")throw new Error(zA(7));return o.charAt(0).toUpperCase()+o.slice(1)}function $G(o,d,h=!0){if(!d||typeof d!="string")return null;if(o&&o.vars&&h){const g=`vars.${d}`.split(".").reduce((T,I)=>T&&T[I]?T[I]:null,o);if(g!=null)return g}return d.split(".").reduce((g,T)=>g&&g[T]!=null?g[T]:null,o)}function cG(o,d,h,g=h){let T;return typeof o=="function"?T=o(h):Array.isArray(o)?T=o[h]||g:T=$G(o,h)||g,d&&(T=d(T,g,o)),T}function Po(o){const{prop:d,cssProperty:h=o.prop,themeKey:g,transform:T}=o,I=N=>{if(N[d]==null)return null;const M=N[d],k=N.theme,x=$G(k,g)||{};return Ey(N,M,K=>{let Q=cG(x,T,K);return K===Q&&typeof K=="string"&&(Q=cG(x,T,`${d}${K==="default"?"":Nn(K)}`,K)),h===!1?Q:{[h]:Q}})};return I.propTypes={},I.filterProps=[d],I}function M1e(o){const d={};return h=>(d[h]===void 0&&(d[h]=o(h)),d[h])}const k1e={m:"margin",p:"padding"},x1e={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},mte={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},U1e=M1e(o=>{if(o.length>2)if(mte[o])o=mte[o];else return[o];const[d,h]=o.split(""),g=k1e[d],T=x1e[h]||"";return Array.isArray(T)?T.map(I=>g+I):[g+T]}),bZ=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],CZ=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"];[...bZ,...CZ];function J5(o,d,h,g){const T=$G(o,d,!0)??h;return typeof T=="number"||typeof T=="string"?I=>typeof I=="string"?I:typeof T=="string"?T.startsWith("var(")&&I===0?0:T.startsWith("var(")&&I===1?T:`calc(${I} * ${T})`:T*I:Array.isArray(T)?I=>{if(typeof I=="string")return I;const N=Math.abs(I),M=T[N];return I>=0?M:typeof M=="number"?-M:typeof M=="string"&&M.startsWith("var(")?`calc(-1 * ${M})`:`-${M}`}:typeof T=="function"?T:()=>{}}function wZ(o){return J5(o,"spacing",8)}function X5(o,d){return typeof d=="string"||d==null?d:o(d)}function j1e(o,d){return h=>o.reduce((g,T)=>(g[T]=X5(d,h),g),{})}function V1e(o,d,h,g){if(!d.includes(h))return null;const T=U1e(h),I=j1e(T,g),N=o[h];return Ey(o,N,I)}function Mce(o,d){const h=wZ(o.theme);return Object.keys(o).map(g=>V1e(o,d,g,h)).reduce(o5,{})}function co(o){return Mce(o,bZ)}co.propTypes={};co.filterProps=bZ;function lo(o){return Mce(o,CZ)}lo.propTypes={};lo.filterProps=CZ;function kce(o=8,d=wZ({spacing:o})){if(o.mui)return o;const h=(...g)=>(g.length===0?[1]:g).map(I=>{const N=d(I);return typeof N=="number"?`${N}px`:N}).join(" ");return h.mui=!0,h}function ez(...o){const d=o.reduce((g,T)=>(T.filterProps.forEach(I=>{g[I]=T}),g),{}),h=g=>Object.keys(g).reduce((T,I)=>d[I]?o5(T,d[I](g)):T,{});return h.propTypes={},h.filterProps=o.reduce((g,T)=>g.concat(T.filterProps),[]),h}function fm(o){return typeof o!="number"?o:`${o}px solid`}function Sm(o,d){return Po({prop:o,themeKey:"borders",transform:d})}const B1e=Sm("border",fm),F1e=Sm("borderTop",fm),G1e=Sm("borderRight",fm),z1e=Sm("borderBottom",fm),H1e=Sm("borderLeft",fm),W1e=Sm("borderColor"),Y1e=Sm("borderTopColor"),K1e=Sm("borderRightColor"),q1e=Sm("borderBottomColor"),J1e=Sm("borderLeftColor"),X1e=Sm("outline",fm),Q1e=Sm("outlineColor"),tz=o=>{if(o.borderRadius!==void 0&&o.borderRadius!==null){const d=J5(o.theme,"shape.borderRadius",4),h=g=>({borderRadius:X5(d,g)});return Ey(o,o.borderRadius,h)}return null};tz.propTypes={};tz.filterProps=["borderRadius"];ez(B1e,F1e,G1e,z1e,H1e,W1e,Y1e,K1e,q1e,J1e,tz,X1e,Q1e);const nz=o=>{if(o.gap!==void 0&&o.gap!==null){const d=J5(o.theme,"spacing",8),h=g=>({gap:X5(d,g)});return Ey(o,o.gap,h)}return null};nz.propTypes={};nz.filterProps=["gap"];const rz=o=>{if(o.columnGap!==void 0&&o.columnGap!==null){const d=J5(o.theme,"spacing",8),h=g=>({columnGap:X5(d,g)});return Ey(o,o.columnGap,h)}return null};rz.propTypes={};rz.filterProps=["columnGap"];const iz=o=>{if(o.rowGap!==void 0&&o.rowGap!==null){const d=J5(o.theme,"spacing",8),h=g=>({rowGap:X5(d,g)});return Ey(o,o.rowGap,h)}return null};iz.propTypes={};iz.filterProps=["rowGap"];const Z1e=Po({prop:"gridColumn"}),$1e=Po({prop:"gridRow"}),eCe=Po({prop:"gridAutoFlow"}),tCe=Po({prop:"gridAutoColumns"}),nCe=Po({prop:"gridAutoRows"}),rCe=Po({prop:"gridTemplateColumns"}),iCe=Po({prop:"gridTemplateRows"}),aCe=Po({prop:"gridTemplateAreas"}),sCe=Po({prop:"gridArea"});ez(nz,rz,iz,Z1e,$1e,eCe,tCe,nCe,rCe,iCe,aCe,sCe);function SP(o,d){return d==="grey"?d:o}const oCe=Po({prop:"color",themeKey:"palette",transform:SP}),cCe=Po({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:SP}),lCe=Po({prop:"backgroundColor",themeKey:"palette",transform:SP});ez(oCe,cCe,lCe);function Dh(o){return o<=1&&o!==0?`${o*100}%`:o}const dCe=Po({prop:"width",transform:Dh}),RZ=o=>{if(o.maxWidth!==void 0&&o.maxWidth!==null){const d=h=>{var T,I,N,M,k;const g=((N=(I=(T=o.theme)==null?void 0:T.breakpoints)==null?void 0:I.values)==null?void 0:N[h])||ZG[h];return g?((k=(M=o.theme)==null?void 0:M.breakpoints)==null?void 0:k.unit)!=="px"?{maxWidth:`${g}${o.theme.breakpoints.unit}`}:{maxWidth:g}:{maxWidth:Dh(h)}};return Ey(o,o.maxWidth,d)}return null};RZ.filterProps=["maxWidth"];const uCe=Po({prop:"minWidth",transform:Dh}),fCe=Po({prop:"height",transform:Dh}),hCe=Po({prop:"maxHeight",transform:Dh}),pCe=Po({prop:"minHeight",transform:Dh});Po({prop:"size",cssProperty:"width",transform:Dh});Po({prop:"size",cssProperty:"height",transform:Dh});const mCe=Po({prop:"boxSizing"});ez(dCe,RZ,uCe,fCe,hCe,pCe,mCe);const az={border:{themeKey:"borders",transform:fm},borderTop:{themeKey:"borders",transform:fm},borderRight:{themeKey:"borders",transform:fm},borderBottom:{themeKey:"borders",transform:fm},borderLeft:{themeKey:"borders",transform:fm},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:fm},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:tz},color:{themeKey:"palette",transform:SP},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:SP},backgroundColor:{themeKey:"palette",transform:SP},p:{style:lo},pt:{style:lo},pr:{style:lo},pb:{style:lo},pl:{style:lo},px:{style:lo},py:{style:lo},padding:{style:lo},paddingTop:{style:lo},paddingRight:{style:lo},paddingBottom:{style:lo},paddingLeft:{style:lo},paddingX:{style:lo},paddingY:{style:lo},paddingInline:{style:lo},paddingInlineStart:{style:lo},paddingInlineEnd:{style:lo},paddingBlock:{style:lo},paddingBlockStart:{style:lo},paddingBlockEnd:{style:lo},m:{style:co},mt:{style:co},mr:{style:co},mb:{style:co},ml:{style:co},mx:{style:co},my:{style:co},margin:{style:co},marginTop:{style:co},marginRight:{style:co},marginBottom:{style:co},marginLeft:{style:co},marginX:{style:co},marginY:{style:co},marginInline:{style:co},marginInlineStart:{style:co},marginInlineEnd:{style:co},marginBlock:{style:co},marginBlockStart:{style:co},marginBlockEnd:{style:co},displayPrint:{cssProperty:!1,transform:o=>({"@media print":{display:o}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:nz},rowGap:{style:iz},columnGap:{style:rz},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:Dh},maxWidth:{style:RZ},minWidth:{transform:Dh},height:{transform:Dh},maxHeight:{transform:Dh},minHeight:{transform:Dh},boxSizing:{},font:{themeKey:"font"},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}};function gCe(...o){const d=o.reduce((g,T)=>g.concat(Object.keys(T)),[]),h=new Set(d);return o.every(g=>h.size===Object.keys(g).length)}function _Ce(o,d){return typeof o=="function"?o(d):o}function ECe(){function o(h,g,T,I){const N={[h]:g,theme:T},M=I[h];if(!M)return{[h]:g};const{cssProperty:k=h,themeKey:x,transform:V,style:K}=M;if(g==null)return null;if(x==="typography"&&g==="inherit")return{[h]:g};const Q=$G(T,x)||{};return K?K(N):Ey(N,g,X=>{let Z=cG(Q,V,X);return X===Z&&typeof X=="string"&&(Z=cG(Q,V,`${h}${X==="default"?"":Nn(X)}`,X)),k===!1?Z:{[k]:Z}})}function d(h){const{sx:g,theme:T={},nested:I}=h||{};if(!g)return null;const N=T.unstable_sxConfig??az;function M(k){let x=k;if(typeof k=="function")x=k(T);else if(typeof k!="object")return k;if(!x)return null;const V=P1e(T.breakpoints),K=Object.keys(V);let Q=V;return Object.keys(x).forEach(ie=>{const X=_Ce(x[ie],T);if(X!=null)if(typeof X=="object")if(N[ie])Q=o5(Q,o(ie,X,T,N));else{const Z=Ey({theme:T},X,ae=>({[ie]:ae}));gCe(Z,X)?Q[ie]=d({sx:X,theme:T,nested:!0}):Q=o5(Q,Z)}else Q=o5(Q,o(ie,X,T,N))}),!I&&T.modularCssLayers?{"@layer sx":fte(T,pte(K,Q))}:fte(T,pte(K,Q))}return Array.isArray(g)?g.map(M):M(g)}return d}const AP=ECe();AP.filterProps=["sx"];function vCe(o,d){var g;const h=this;if(h.vars){if(!((g=h.colorSchemes)!=null&&g[o])||typeof h.getColorSchemeSelector!="function")return{};let T=h.getColorSchemeSelector(o);return T==="&"?d:((T.includes("data-")||T.includes("."))&&(T=`*:where(${T.replace(/\s*&$/,"")}) &`),{[T]:d})}return h.palette.mode===o?d:{}}function sz(o={},...d){const{breakpoints:h={},palette:g={},spacing:T,shape:I={},...N}=o,M=I1e(h),k=kce(T);let x=kh({breakpoints:M,direction:"ltr",components:{},palette:{mode:"light",...g},spacing:k,shape:{...L1e,...I}},N);return x=N1e(x),x.applyStyles=vCe,x=d.reduce((V,K)=>kh(V,K),x),x.unstable_sxConfig={...az,...N==null?void 0:N.unstable_sxConfig},x.unstable_sx=function(K){return AP({sx:K,theme:this})},x}function SCe(o){return Object.keys(o).length===0}function yCe(o=null){const d=q.useContext(SZ);return!d||SCe(d)?o:d}const TCe=sz();function xce(o=TCe){return yCe(o)}const gte=o=>o,bCe=()=>{let o=gte;return{configure(d){o=d},generate(d){return o(d)},reset(){o=gte}}},CCe=bCe();function Uce(o){var d,h,g="";if(typeof o=="string"||typeof o=="number")g+=o;else if(typeof o=="object")if(Array.isArray(o)){var T=o.length;for(d=0;d<T;d++)o[d]&&(h=Uce(o[d]))&&(g&&(g+=" "),g+=h)}else for(h in o)o[h]&&(g&&(g+=" "),g+=h);return g}function wCe(){for(var o,d,h=0,g="",T=arguments.length;h<T;h++)(o=arguments[h])&&(d=Uce(o))&&(g&&(g+=" "),g+=d);return g}const RCe={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function _c(o,d,h="Mui"){const g=RCe[d];return g?`${h}-${g}`:`${CCe.generate(o)}-${d}`}function Zo(o,d,h="Mui"){const g={};return d.forEach(T=>{g[T]=_c(o,T,h)}),g}function jce(o){const{variants:d,...h}=o,g={variants:d,style:UA(h),isProcessed:!0};return g.style===h||d&&d.forEach(T=>{typeof T.style!="function"&&(T.style=UA(T.style))}),g}const ICe=sz();function nq(o){return o!=="ownerState"&&o!=="theme"&&o!=="sx"&&o!=="as"}function PA(o,d){return d&&o&&typeof o=="object"&&o.styles&&!o.styles.startsWith("@layer")&&(o.styles=`@layer ${d}{${String(o.styles)}}`),o}function ACe(o){return o?(d,h)=>h[o]:null}function OCe(o,d,h){o.theme=LCe(o.theme)?h:o.theme[d]||o.theme}function G7(o,d,h){const g=typeof d=="function"?d(o):d;if(Array.isArray(g))return g.flatMap(T=>G7(o,T,h));if(Array.isArray(g==null?void 0:g.variants)){let T;if(g.isProcessed)T=h?PA(g.style,h):g.style;else{const{variants:I,...N}=g;T=h?PA(UA(N),h):N}return Vce(o,g.variants,[T],h)}return g!=null&&g.isProcessed?h?PA(UA(g.style),h):g.style:h?PA(UA(g),h):g}function Vce(o,d,h=[],g=void 0){var I;let T;e:for(let N=0;N<d.length;N+=1){const M=d[N];if(typeof M.props=="function"){if(T??(T={...o,...o.ownerState,ownerState:o.ownerState}),!M.props(T))continue}else for(const k in M.props)if(o[k]!==M.props[k]&&((I=o.ownerState)==null?void 0:I[k])!==M.props[k])continue e;typeof M.style=="function"?(T??(T={...o,...o.ownerState,ownerState:o.ownerState}),h.push(g?PA(UA(M.style(T)),g):M.style(T))):h.push(g?PA(UA(M.style),g):M.style)}return h}function Bce(o={}){const{themeId:d,defaultTheme:h=ICe,rootShouldForwardProp:g=nq,slotShouldForwardProp:T=nq}=o;function I(M){OCe(M,d,h)}return(M,k={})=>{b1e(M,ye=>ye.filter(Te=>Te!==AP));const{name:x,slot:V,skipVariantsResolver:K,skipSx:Q,overridesResolver:ie=ACe(PCe(V)),...X}=k,Z=x&&x.startsWith("Mui")||V?"components":"custom",ae=K!==void 0?K:V&&V!=="Root"&&V!=="root"||!1,le=Q||!1;let fe=nq;V==="Root"||V==="root"?fe=g:V?fe=T:DCe(M)&&(fe=void 0);const ue=T1e(M,{shouldForwardProp:fe,label:NCe(),...X}),de=ye=>{if(ye.__emotion_real===ye)return ye;if(typeof ye=="function")return function(Le){return G7(Le,ye,Le.theme.modularCssLayers?Z:void 0)};if(ly(ye)){const Te=jce(ye);return function(je){return Te.variants?G7(je,Te,je.theme.modularCssLayers?Z:void 0):je.theme.modularCssLayers?PA(Te.style,Z):Te.style}}return ye},te=(...ye)=>{const Te=[],Le=ye.map(de),je=[];if(Te.push(I),x&&ie&&je.push(function(ze){var qe,lt;const et=(lt=(qe=ze.theme.components)==null?void 0:qe[x])==null?void 0:lt.styleOverrides;if(!et)return null;const Oe={};for(const Ge in et)Oe[Ge]=G7(ze,et[Ge],ze.theme.modularCssLayers?"theme":void 0);return ie(ze,Oe)}),x&&!ae&&je.push(function(ze){var Oe,qe;const $e=ze.theme,et=(qe=(Oe=$e==null?void 0:$e.components)==null?void 0:Oe[x])==null?void 0:qe.variants;return et?Vce(ze,et,[],ze.theme.modularCssLayers?"theme":void 0):null}),le||je.push(AP),Array.isArray(Le[0])){const We=Le.shift(),ze=new Array(Te.length).fill(""),$e=new Array(je.length).fill("");let et;et=[...ze,...We,...$e],et.raw=[...ze,...We.raw,...$e],Te.unshift(et)}const he=[...Te,...Le,...je],ke=ue(...he);return M.muiName&&(ke.muiName=M.muiName),ke};return ue.withConfig&&(te.withConfig=ue.withConfig),te}}function NCe(o,d){return void 0}function LCe(o){for(const d in o)return!1;return!0}function DCe(o){return typeof o=="string"&&o.charCodeAt(0)>96}function PCe(o){return o&&o.charAt(0).toLowerCase()+o.slice(1)}const MCe=Bce();function Fce(o){var d,h,g="";if(typeof o=="string"||typeof o=="number")g+=o;else if(typeof o=="object")if(Array.isArray(o)){var T=o.length;for(d=0;d<T;d++)o[d]&&(h=Fce(o[d]))&&(g&&(g+=" "),g+=h)}else for(h in o)o[h]&&(g&&(g+=" "),g+=h);return g}function rQ(){for(var o,d,h=0,g="",T=arguments.length;h<T;h++)(o=arguments[h])&&(d=Fce(o))&&(g&&(g+=" "),g+=d);return g}function A5(o,d,h=!1){const g={...d};for(const T in o)if(Object.prototype.hasOwnProperty.call(o,T)){const I=T;if(I==="components"||I==="slots")g[I]={...o[I],...g[I]};else if(I==="componentsProps"||I==="slotProps"){const N=o[I],M=d[I];if(!M)g[I]=N||{};else if(!N)g[I]=M;else{g[I]={...M};for(const k in N)if(Object.prototype.hasOwnProperty.call(N,k)){const x=k;g[I][x]=A5(N[x],M[x],h)}}}else I==="className"&&h&&d.className?g.className=rQ(o==null?void 0:o.className,d==null?void 0:d.className):I==="style"&&h&&d.style?g.style={...o==null?void 0:o.style,...d==null?void 0:d.style}:g[I]===void 0&&(g[I]=o[I])}return g}function kCe(o){const{theme:d,name:h,props:g}=o;return!d||!d.components||!d.components[h]||!d.components[h].defaultProps?g:A5(d.components[h].defaultProps,g)}function xCe({props:o,name:d,defaultTheme:h,themeId:g}){let T=xce(h);return g&&(T=T[g]||T),kCe({theme:T,name:d,props:o})}const HA=typeof window<"u"?q.useLayoutEffect:q.useEffect;function UCe(o,d=Number.MIN_SAFE_INTEGER,h=Number.MAX_SAFE_INTEGER){return Math.max(d,Math.min(o,h))}function IZ(o,d=0,h=1){return UCe(o,d,h)}function jCe(o){o=o.slice(1);const d=new RegExp(`.{1,${o.length>=6?2:1}}`,"g");let h=o.match(d);return h&&h[0].length===1&&(h=h.map(g=>g+g)),h?`rgb${h.length===4?"a":""}(${h.map((g,T)=>T<3?parseInt(g,16):Math.round(parseInt(g,16)/255*1e3)/1e3).join(", ")})`:""}function rC(o){if(o.type)return o;if(o.charAt(0)==="#")return rC(jCe(o));const d=o.indexOf("("),h=o.substring(0,d);if(!["rgb","rgba","hsl","hsla","color"].includes(h))throw new Error(zA(9,o));let g=o.substring(d+1,o.length-1),T;if(h==="color"){if(g=g.split(" "),T=g.shift(),g.length===4&&g[3].charAt(0)==="/"&&(g[3]=g[3].slice(1)),!["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].includes(T))throw new Error(zA(10,T))}else g=g.split(",");return g=g.map(I=>parseFloat(I)),{type:h,values:g,colorSpace:T}}const VCe=o=>{const d=rC(o);return d.values.slice(0,3).map((h,g)=>d.type.includes("hsl")&&g!==0?`${h}%`:h).join(" ")},$j=(o,d)=>{try{return VCe(o)}catch{return o}};function oz(o){const{type:d,colorSpace:h}=o;let{values:g}=o;return d.includes("rgb")?g=g.map((T,I)=>I<3?parseInt(T,10):T):d.includes("hsl")&&(g[1]=`${g[1]}%`,g[2]=`${g[2]}%`),d.includes("color")?g=`${h} ${g.join(" ")}`:g=`${g.join(", ")}`,`${d}(${g})`}function Gce(o){o=rC(o);const{values:d}=o,h=d[0],g=d[1]/100,T=d[2]/100,I=g*Math.min(T,1-T),N=(x,V=(x+h/30)%12)=>T-I*Math.max(Math.min(V-3,9-V,1),-1);let M="rgb";const k=[Math.round(N(0)*255),Math.round(N(8)*255),Math.round(N(4)*255)];return o.type==="hsla"&&(M+="a",k.push(d[3])),oz({type:M,values:k})}function iQ(o){o=rC(o);let d=o.type==="hsl"||o.type==="hsla"?rC(Gce(o)).values:o.values;return d=d.map(h=>(o.type!=="color"&&(h/=255),h<=.03928?h/12.92:((h+.055)/1.055)**2.4)),Number((.2126*d[0]+.7152*d[1]+.0722*d[2]).toFixed(3))}function BCe(o,d){const h=iQ(o),g=iQ(d);return(Math.max(h,g)+.05)/(Math.min(h,g)+.05)}function Qa(o,d){return o=rC(o),d=IZ(d),(o.type==="rgb"||o.type==="hsl")&&(o.type+="a"),o.type==="color"?o.values[3]=`/${d}`:o.values[3]=d,oz(o)}function _7(o,d,h){try{return Qa(o,d)}catch{return o}}function AZ(o,d){if(o=rC(o),d=IZ(d),o.type.includes("hsl"))o.values[2]*=1-d;else if(o.type.includes("rgb")||o.type.includes("color"))for(let h=0;h<3;h+=1)o.values[h]*=1-d;return oz(o)}function qa(o,d,h){try{return AZ(o,d)}catch{return o}}function OZ(o,d){if(o=rC(o),d=IZ(d),o.type.includes("hsl"))o.values[2]+=(100-o.values[2])*d;else if(o.type.includes("rgb"))for(let h=0;h<3;h+=1)o.values[h]+=(255-o.values[h])*d;else if(o.type.includes("color"))for(let h=0;h<3;h+=1)o.values[h]+=(1-o.values[h])*d;return oz(o)}function Ja(o,d,h){try{return OZ(o,d)}catch{return o}}function FCe(o,d=.15){return iQ(o)>.5?AZ(o,d):OZ(o,d)}function E7(o,d,h){try{return FCe(o,d)}catch{return o}}const GCe=q.createContext(),NZ=()=>q.useContext(GCe)??!1,zCe=q.createContext(void 0);function HCe(o){const{theme:d,name:h,props:g}=o;if(!d||!d.components||!d.components[h])return g;const T=d.components[h];return T.defaultProps?A5(T.defaultProps,g,d.components.mergeClassNameAndStyle):!T.styleOverrides&&!T.variants?A5(T,g,d.components.mergeClassNameAndStyle):g}function WCe({props:o,name:d}){const h=q.useContext(zCe);return HCe({props:o,name:d,theme:{components:h}})}let _te=0;function YCe(o){const[d,h]=q.useState(o),g=o||d;return q.useEffect(()=>{d==null&&(_te+=1,h(`mui-${_te}`))},[d]),g}const KCe={...AX},Ete=KCe.useId;function LZ(o){if(Ete!==void 0){const d=Ete();return o??d}return YCe(o)}const vte={theme:void 0};function qCe(o){let d,h;return function(T){let I=d;return(I===void 0||T.theme!==h)&&(vte.theme=T.theme,I=jce(o(vte)),d=I,h=T.theme),I}}function JCe(o=""){function d(...g){if(!g.length)return"";const T=g[0];return typeof T=="string"&&!T.match(/(#|\(|\)|(-?(\d*\.)?\d+)(px|em|%|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc))|^(-?(\d*\.)?\d+)$|(\d+ \d+ \d+)/)?`, var(--${o?`${o}-`:""}${T}${d(...g.slice(1))})`:`, ${T}`}return(g,...T)=>`var(--${o?`${o}-`:""}${g}${d(...T)})`}const Ste=(o,d,h,g=[])=>{let T=o;d.forEach((I,N)=>{N===d.length-1?Array.isArray(T)?T[Number(I)]=h:T&&typeof T=="object"&&(T[I]=h):T&&typeof T=="object"&&(T[I]||(T[I]=g.includes(I)?[]:{}),T=T[I])})},XCe=(o,d,h)=>{function g(T,I=[],N=[]){Object.entries(T).forEach(([M,k])=>{(!h||h&&!h([...I,M]))&&k!=null&&(typeof k=="object"&&Object.keys(k).length>0?g(k,[...I,M],Array.isArray(k)?[...N,M]:N):d([...I,M],k,N))})}g(o)},QCe=(o,d)=>typeof d=="number"?["lineHeight","fontWeight","opacity","zIndex"].some(g=>o.includes(g))||o[o.length-1].toLowerCase().includes("opacity")?d:`${d}px`:d;function rq(o,d){const{prefix:h,shouldSkipGeneratingVar:g}=d||{},T={},I={},N={};return XCe(o,(M,k,x)=>{if((typeof k=="string"||typeof k=="number")&&(!g||!g(M,k))){const V=`--${h?`${h}-`:""}${M.join("-")}`,K=QCe(M,k);Object.assign(T,{[V]:K}),Ste(I,M,`var(${V})`,x),Ste(N,M,`var(${V}, ${K})`,x)}},M=>M[0]==="vars"),{css:T,vars:I,varsWithDefaults:N}}function ZCe(o,d={}){const{getSelector:h=ae,disableCssColorScheme:g,colorSchemeSelector:T}=d,{colorSchemes:I={},components:N,defaultColorScheme:M="light",...k}=o,{vars:x,css:V,varsWithDefaults:K}=rq(k,d);let Q=K;const ie={},{[M]:X,...Z}=I;if(Object.entries(Z||{}).forEach(([ue,de])=>{const{vars:te,css:ye,varsWithDefaults:Te}=rq(de,d);Q=kh(Q,Te),ie[ue]={css:ye,vars:te}}),X){const{css:ue,vars:de,varsWithDefaults:te}=rq(X,d);Q=kh(Q,te),ie[M]={css:ue,vars:de}}function ae(ue,de){var ye,Te;let te=T;if(T==="class"&&(te=".%s"),T==="data"&&(te="[data-%s]"),T!=null&&T.startsWith("data-")&&!T.includes("%s")&&(te=`[${T}="%s"]`),ue){if(te==="media")return o.defaultColorScheme===ue?":root":{[`@media (prefers-color-scheme: ${((Te=(ye=I[ue])==null?void 0:ye.palette)==null?void 0:Te.mode)||ue})`]:{":root":de}};if(te)return o.defaultColorScheme===ue?`:root, ${te.replace("%s",String(ue))}`:te.replace("%s",String(ue))}return":root"}return{vars:Q,generateThemeVars:()=>{let ue={...x};return Object.entries(ie).forEach(([,{vars:de}])=>{ue=kh(ue,de)}),ue},generateStyleSheets:()=>{var Le,je;const ue=[],de=o.defaultColorScheme||"light";function te(he,ke){Object.keys(ke).length&&ue.push(typeof he=="string"?{[he]:{...ke}}:he)}te(h(void 0,{...V}),V);const{[de]:ye,...Te}=ie;if(ye){const{css:he}=ye,ke=(je=(Le=I[de])==null?void 0:Le.palette)==null?void 0:je.mode,We=!g&&ke?{colorScheme:ke,...he}:{...he};te(h(de,{...We}),We)}return Object.entries(Te).forEach(([he,{css:ke}])=>{var $e,et;const We=(et=($e=I[he])==null?void 0:$e.palette)==null?void 0:et.mode,ze=!g&&We?{colorScheme:We,...ke}:{...ke};te(h(he,{...ze}),ze)}),ue}}}function $Ce(o){return function(h){return o==="media"?`@media (prefers-color-scheme: ${h})`:o?o.startsWith("data-")&&!o.includes("%s")?`[${o}="${h}"] &`:o==="class"?`.${h} &`:o==="data"?`[data-${h}] &`:`${o.replace("%s",h)} &`:"&"}}function tl(o,d,h=void 0){const g={};for(const T in o){const I=o[T];let N="",M=!0;for(let k=0;k<I.length;k+=1){const x=I[k];x&&(N+=(M===!0?"":" ")+d(x),M=!1,h&&h[x]&&(N+=" "+h[x]))}g[T]=N}return g}const ewe=sz(),twe=MCe("div",{name:"MuiContainer",slot:"Root",overridesResolver:(o,d)=>{const{ownerState:h}=o;return[d.root,d[`maxWidth${Nn(String(h.maxWidth))}`],h.fixed&&d.fixed,h.disableGutters&&d.disableGutters]}}),nwe=o=>xCe({props:o,name:"MuiContainer",defaultTheme:ewe}),rwe=(o,d)=>{const h=k=>_c(d,k),{classes:g,fixed:T,disableGutters:I,maxWidth:N}=o,M={root:["root",N&&`maxWidth${Nn(String(N))}`,T&&"fixed",I&&"disableGutters"]};return tl(M,h,g)};function iwe(o={}){const{createStyledComponent:d=twe,useThemeProps:h=nwe,componentName:g="MuiContainer"}=o,T=d(({theme:N,ownerState:M})=>({width:"100%",marginLeft:"auto",boxSizing:"border-box",marginRight:"auto",...!M.disableGutters&&{paddingLeft:N.spacing(2),paddingRight:N.spacing(2),[N.breakpoints.up("sm")]:{paddingLeft:N.spacing(3),paddingRight:N.spacing(3)}}}),({theme:N,ownerState:M})=>M.fixed&&Object.keys(N.breakpoints.values).reduce((k,x)=>{const V=x,K=N.breakpoints.values[V];return K!==0&&(k[N.breakpoints.up(V)]={maxWidth:`${K}${N.breakpoints.unit}`}),k},{}),({theme:N,ownerState:M})=>({...M.maxWidth==="xs"&&{[N.breakpoints.up("xs")]:{maxWidth:Math.max(N.breakpoints.values.xs,444)}},...M.maxWidth&&M.maxWidth!=="xs"&&{[N.breakpoints.up(M.maxWidth)]:{maxWidth:`${N.breakpoints.values[M.maxWidth]}${N.breakpoints.unit}`}}}));return q.forwardRef(function(M,k){const x=h(M),{className:V,component:K="div",disableGutters:Q=!1,fixed:ie=!1,maxWidth:X="lg",classes:Z,...ae}=x,le={...x,component:K,disableGutters:Q,fixed:ie,maxWidth:X},fe=rwe(le,g);return j.jsx(T,{as:K,ownerState:le,className:wCe(fe.root,V),ref:k,...ae})})}function zce(){return{text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:C5.white,default:C5.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}}}const awe=zce();function Hce(){return{text:{primary:C5.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:C5.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}}}const yte=Hce();function Tte(o,d,h,g){const T=g.light||g,I=g.dark||g*1.5;o[d]||(o.hasOwnProperty(h)?o[d]=o[h]:d==="light"?o.light=OZ(o.main,T):d==="dark"&&(o.dark=AZ(o.main,I)))}function swe(o="light"){return o==="dark"?{main:rP[200],light:rP[50],dark:rP[400]}:{main:rP[700],light:rP[400],dark:rP[800]}}function owe(o="light"){return o==="dark"?{main:nP[200],light:nP[50],dark:nP[400]}:{main:nP[500],light:nP[300],dark:nP[700]}}function cwe(o="light"){return o==="dark"?{main:tP[500],light:tP[300],dark:tP[700]}:{main:tP[700],light:tP[400],dark:tP[800]}}function lwe(o="light"){return o==="dark"?{main:iP[400],light:iP[300],dark:iP[700]}:{main:iP[700],light:iP[500],dark:iP[900]}}function dwe(o="light"){return o==="dark"?{main:aP[400],light:aP[300],dark:aP[700]}:{main:aP[800],light:aP[500],dark:aP[900]}}function uwe(o="light"){return o==="dark"?{main:Gj[400],light:Gj[300],dark:Gj[700]}:{main:"#ed6c02",light:Gj[500],dark:Gj[900]}}function DZ(o){const{mode:d="light",contrastThreshold:h=3,tonalOffset:g=.2,...T}=o,I=o.primary||swe(d),N=o.secondary||owe(d),M=o.error||cwe(d),k=o.info||lwe(d),x=o.success||dwe(d),V=o.warning||uwe(d);function K(Z){return BCe(Z,yte.text.primary)>=h?yte.text.primary:awe.text.primary}const Q=({color:Z,name:ae,mainShade:le=500,lightShade:fe=300,darkShade:ue=700})=>{if(Z={...Z},!Z.main&&Z[le]&&(Z.main=Z[le]),!Z.hasOwnProperty("main"))throw new Error(zA(11,ae?` (${ae})`:"",le));if(typeof Z.main!="string")throw new Error(zA(12,ae?` (${ae})`:"",JSON.stringify(Z.main)));return Tte(Z,"light",fe,g),Tte(Z,"dark",ue,g),Z.contrastText||(Z.contrastText=K(Z.main)),Z};let ie;return d==="light"?ie=zce():d==="dark"&&(ie=Hce()),kh({common:{...C5},mode:d,primary:Q({color:I,name:"primary"}),secondary:Q({color:N,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:Q({color:M,name:"error"}),warning:Q({color:V,name:"warning"}),info:Q({color:k,name:"info"}),success:Q({color:x,name:"success"}),grey:Cbe,contrastThreshold:h,getContrastText:K,augmentColor:Q,tonalOffset:g,...ie},T)}function fwe(o){const d={};return Object.entries(o).forEach(g=>{const[T,I]=g;typeof I=="object"&&(d[T]=`${I.fontStyle?`${I.fontStyle} `:""}${I.fontVariant?`${I.fontVariant} `:""}${I.fontWeight?`${I.fontWeight} `:""}${I.fontStretch?`${I.fontStretch} `:""}${I.fontSize||""}${I.lineHeight?`/${I.lineHeight} `:""}${I.fontFamily||""}`)}),d}function hwe(o,d){return{toolbar:{minHeight:56,[o.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[o.up("sm")]:{minHeight:64}},...d}}function pwe(o){return Math.round(o*1e5)/1e5}const bte={textTransform:"uppercase"},Cte='"Roboto", "Helvetica", "Arial", sans-serif';function mwe(o,d){const{fontFamily:h=Cte,fontSize:g=14,fontWeightLight:T=300,fontWeightRegular:I=400,fontWeightMedium:N=500,fontWeightBold:M=700,htmlFontSize:k=16,allVariants:x,pxToRem:V,...K}=typeof d=="function"?d(o):d,Q=g/14,ie=V||(ae=>`${ae/k*Q}rem`),X=(ae,le,fe,ue,de)=>({fontFamily:h,fontWeight:ae,fontSize:ie(le),lineHeight:fe,...h===Cte?{letterSpacing:`${pwe(ue/le)}em`}:{},...de,...x}),Z={h1:X(T,96,1.167,-1.5),h2:X(T,60,1.2,-.5),h3:X(I,48,1.167,0),h4:X(I,34,1.235,.25),h5:X(I,24,1.334,0),h6:X(N,20,1.6,.15),subtitle1:X(I,16,1.75,.15),subtitle2:X(N,14,1.57,.1),body1:X(I,16,1.5,.15),body2:X(I,14,1.43,.15),button:X(N,14,1.75,.4,bte),caption:X(I,12,1.66,.4),overline:X(I,12,2.66,1,bte),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return kh({htmlFontSize:k,pxToRem:ie,fontFamily:h,fontSize:g,fontWeightLight:T,fontWeightRegular:I,fontWeightMedium:N,fontWeightBold:M,...Z},K,{clone:!1})}const gwe=.2,_we=.14,Ewe=.12;function As(...o){return[`${o[0]}px ${o[1]}px ${o[2]}px ${o[3]}px rgba(0,0,0,${gwe})`,`${o[4]}px ${o[5]}px ${o[6]}px ${o[7]}px rgba(0,0,0,${_we})`,`${o[8]}px ${o[9]}px ${o[10]}px ${o[11]}px rgba(0,0,0,${Ewe})`].join(",")}const vwe=["none",As(0,2,1,-1,0,1,1,0,0,1,3,0),As(0,3,1,-2,0,2,2,0,0,1,5,0),As(0,3,3,-2,0,3,4,0,0,1,8,0),As(0,2,4,-1,0,4,5,0,0,1,10,0),As(0,3,5,-1,0,5,8,0,0,1,14,0),As(0,3,5,-1,0,6,10,0,0,1,18,0),As(0,4,5,-2,0,7,10,1,0,2,16,1),As(0,5,5,-3,0,8,10,1,0,3,14,2),As(0,5,6,-3,0,9,12,1,0,3,16,2),As(0,6,6,-3,0,10,14,1,0,4,18,3),As(0,6,7,-4,0,11,15,1,0,4,20,3),As(0,7,8,-4,0,12,17,2,0,5,22,4),As(0,7,8,-4,0,13,19,2,0,5,24,4),As(0,7,9,-4,0,14,21,2,0,5,26,4),As(0,8,9,-5,0,15,22,2,0,6,28,5),As(0,8,10,-5,0,16,24,2,0,6,30,5),As(0,8,11,-5,0,17,26,2,0,6,32,5),As(0,9,11,-5,0,18,28,2,0,7,34,6),As(0,9,12,-6,0,19,29,2,0,7,36,6),As(0,10,13,-6,0,20,31,3,0,8,38,7),As(0,10,13,-6,0,21,33,3,0,8,40,7),As(0,10,14,-6,0,22,35,3,0,8,42,7),As(0,11,14,-7,0,23,36,3,0,9,44,8),As(0,11,15,-7,0,24,38,3,0,9,46,8)],Swe={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},ywe={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function wte(o){return`${Math.round(o)}ms`}function Twe(o){if(!o)return 0;const d=o/36;return Math.min(Math.round((4+15*d**.25+d/5)*10),3e3)}function bwe(o){const d={...Swe,...o.easing},h={...ywe,...o.duration};return{getAutoHeightDuration:Twe,create:(T=["all"],I={})=>{const{duration:N=h.standard,easing:M=d.easeInOut,delay:k=0,...x}=I;return(Array.isArray(T)?T:[T]).map(V=>`${V} ${typeof N=="string"?N:wte(N)} ${M} ${typeof k=="string"?k:wte(k)}`).join(",")},...o,easing:d,duration:h}}const Cwe={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500};function wwe(o){return ly(o)||typeof o>"u"||typeof o=="string"||typeof o=="boolean"||typeof o=="number"||Array.isArray(o)}function Wce(o={}){const d={...o};function h(g){const T=Object.entries(g);for(let I=0;I<T.length;I++){const[N,M]=T[I];!wwe(M)||N.startsWith("unstable_")?delete g[N]:ly(M)&&(g[N]={...M},h(g[N]))}}return h(d),`import { unstable_createBreakpoints as createBreakpoints, createTransitions } from '@mui/material/styles';

const theme = ${JSON.stringify(d,null,2)};

theme.breakpoints = createBreakpoints(theme.breakpoints || {});
theme.transitions = createTransitions(theme.transitions || {});

export default theme;`}function aQ(o={},...d){const{breakpoints:h,mixins:g={},spacing:T,palette:I={},transitions:N={},typography:M={},shape:k,...x}=o;if(o.vars&&o.generateThemeVars===void 0)throw new Error(zA(20));const V=DZ(I),K=sz(o);let Q=kh(K,{mixins:hwe(K.breakpoints,g),palette:V,shadows:vwe.slice(),typography:mwe(V,M),transitions:bwe(N),zIndex:{...Cwe}});return Q=kh(Q,x),Q=d.reduce((ie,X)=>kh(ie,X),Q),Q.unstable_sxConfig={...az,...x==null?void 0:x.unstable_sxConfig},Q.unstable_sx=function(X){return AP({sx:X,theme:this})},Q.toRuntimeSource=Wce,Q}function sQ(o){let d;return o<1?d=5.11916*o**2:d=4.5*Math.log(o+1)+2,Math.round(d*10)/1e3}const Rwe=[...Array(25)].map((o,d)=>{if(d===0)return"none";const h=sQ(d);return`linear-gradient(rgba(255 255 255 / ${h}), rgba(255 255 255 / ${h}))`});function Yce(o){return{inputPlaceholder:o==="dark"?.5:.42,inputUnderline:o==="dark"?.7:.42,switchTrackDisabled:o==="dark"?.2:.12,switchTrack:o==="dark"?.3:.38}}function Kce(o){return o==="dark"?Rwe:[]}function Iwe(o){const{palette:d={mode:"light"},opacity:h,overlays:g,...T}=o,I=DZ(d);return{palette:I,opacity:{...Yce(I.mode),...h},overlays:g||Kce(I.mode),...T}}function Awe(o){var d;return!!o[0].match(/(cssVarPrefix|colorSchemeSelector|modularCssLayers|rootSelector|typography|mixins|breakpoints|direction|transitions)/)||!!o[0].match(/sxConfig$/)||o[0]==="palette"&&!!((d=o[1])!=null&&d.match(/(mode|contrastThreshold|tonalOffset)/))}const Owe=o=>[...[...Array(25)].map((d,h)=>`--${o?`${o}-`:""}overlays-${h}`),`--${o?`${o}-`:""}palette-AppBar-darkBg`,`--${o?`${o}-`:""}palette-AppBar-darkColor`],Nwe=o=>(d,h)=>{const g=o.rootSelector||":root",T=o.colorSchemeSelector;let I=T;if(T==="class"&&(I=".%s"),T==="data"&&(I="[data-%s]"),T!=null&&T.startsWith("data-")&&!T.includes("%s")&&(I=`[${T}="%s"]`),o.defaultColorScheme===d){if(d==="dark"){const N={};return Owe(o.cssVarPrefix).forEach(M=>{N[M]=h[M],delete h[M]}),I==="media"?{[g]:h,"@media (prefers-color-scheme: dark)":{[g]:N}}:I?{[I.replace("%s",d)]:N,[`${g}, ${I.replace("%s",d)}`]:h}:{[g]:{...h,...N}}}if(I&&I!=="media")return`${g}, ${I.replace("%s",String(d))}`}else if(d){if(I==="media")return{[`@media (prefers-color-scheme: ${String(d)})`]:{[g]:h}};if(I)return I.replace("%s",String(d))}return g};function Lwe(o,d){d.forEach(h=>{o[h]||(o[h]={})})}function At(o,d,h){!o[d]&&h&&(o[d]=h)}function e5(o){return typeof o!="string"||!o.startsWith("hsl")?o:Gce(o)}function iy(o,d){`${d}Channel`in o||(o[`${d}Channel`]=$j(e5(o[d])))}function Dwe(o){return typeof o=="number"?`${o}px`:typeof o=="string"||typeof o=="function"||Array.isArray(o)?o:"8px"}const lE=o=>{try{return o()}catch{}},Pwe=(o="mui")=>JCe(o);function iq(o,d,h,g){if(!d)return;d=d===!0?{}:d;const T=g==="dark"?"dark":"light";if(!h){o[g]=Iwe({...d,palette:{mode:T,...d==null?void 0:d.palette}});return}const{palette:I,...N}=aQ({...h,palette:{mode:T,...d==null?void 0:d.palette}});return o[g]={...d,palette:I,opacity:{...Yce(T),...d==null?void 0:d.opacity},overlays:(d==null?void 0:d.overlays)||Kce(T)},N}function Mwe(o={},...d){const{colorSchemes:h={light:!0},defaultColorScheme:g,disableCssColorScheme:T=!1,cssVarPrefix:I="mui",shouldSkipGeneratingVar:N=Awe,colorSchemeSelector:M=h.light&&h.dark?"media":void 0,rootSelector:k=":root",...x}=o,V=Object.keys(h)[0],K=g||(h.light&&V!=="light"?"light":V),Q=Pwe(I),{[K]:ie,light:X,dark:Z,...ae}=h,le={...ae};let fe=ie;if((K==="dark"&&!("dark"in h)||K==="light"&&!("light"in h))&&(fe=!0),!fe)throw new Error(zA(21,K));const ue=iq(le,fe,x,K);X&&!le.light&&iq(le,X,void 0,"light"),Z&&!le.dark&&iq(le,Z,void 0,"dark");let de={defaultColorScheme:K,...ue,cssVarPrefix:I,colorSchemeSelector:M,rootSelector:k,getCssVar:Q,colorSchemes:le,font:{...fwe(ue.typography),...ue.font},spacing:Dwe(x.spacing)};Object.keys(de.colorSchemes).forEach(je=>{const he=de.colorSchemes[je].palette,ke=We=>{const ze=We.split("-"),$e=ze[1],et=ze[2];return Q(We,he[$e][et])};if(he.mode==="light"&&(At(he.common,"background","#fff"),At(he.common,"onBackground","#000")),he.mode==="dark"&&(At(he.common,"background","#000"),At(he.common,"onBackground","#fff")),Lwe(he,["Alert","AppBar","Avatar","Button","Chip","FilledInput","LinearProgress","Skeleton","Slider","SnackbarContent","SpeedDialAction","StepConnector","StepContent","Switch","TableCell","Tooltip"]),he.mode==="light"){At(he.Alert,"errorColor",qa(he.error.light,.6)),At(he.Alert,"infoColor",qa(he.info.light,.6)),At(he.Alert,"successColor",qa(he.success.light,.6)),At(he.Alert,"warningColor",qa(he.warning.light,.6)),At(he.Alert,"errorFilledBg",ke("palette-error-main")),At(he.Alert,"infoFilledBg",ke("palette-info-main")),At(he.Alert,"successFilledBg",ke("palette-success-main")),At(he.Alert,"warningFilledBg",ke("palette-warning-main")),At(he.Alert,"errorFilledColor",lE(()=>he.getContrastText(he.error.main))),At(he.Alert,"infoFilledColor",lE(()=>he.getContrastText(he.info.main))),At(he.Alert,"successFilledColor",lE(()=>he.getContrastText(he.success.main))),At(he.Alert,"warningFilledColor",lE(()=>he.getContrastText(he.warning.main))),At(he.Alert,"errorStandardBg",Ja(he.error.light,.9)),At(he.Alert,"infoStandardBg",Ja(he.info.light,.9)),At(he.Alert,"successStandardBg",Ja(he.success.light,.9)),At(he.Alert,"warningStandardBg",Ja(he.warning.light,.9)),At(he.Alert,"errorIconColor",ke("palette-error-main")),At(he.Alert,"infoIconColor",ke("palette-info-main")),At(he.Alert,"successIconColor",ke("palette-success-main")),At(he.Alert,"warningIconColor",ke("palette-warning-main")),At(he.AppBar,"defaultBg",ke("palette-grey-100")),At(he.Avatar,"defaultBg",ke("palette-grey-400")),At(he.Button,"inheritContainedBg",ke("palette-grey-300")),At(he.Button,"inheritContainedHoverBg",ke("palette-grey-A100")),At(he.Chip,"defaultBorder",ke("palette-grey-400")),At(he.Chip,"defaultAvatarColor",ke("palette-grey-700")),At(he.Chip,"defaultIconColor",ke("palette-grey-700")),At(he.FilledInput,"bg","rgba(0, 0, 0, 0.06)"),At(he.FilledInput,"hoverBg","rgba(0, 0, 0, 0.09)"),At(he.FilledInput,"disabledBg","rgba(0, 0, 0, 0.12)"),At(he.LinearProgress,"primaryBg",Ja(he.primary.main,.62)),At(he.LinearProgress,"secondaryBg",Ja(he.secondary.main,.62)),At(he.LinearProgress,"errorBg",Ja(he.error.main,.62)),At(he.LinearProgress,"infoBg",Ja(he.info.main,.62)),At(he.LinearProgress,"successBg",Ja(he.success.main,.62)),At(he.LinearProgress,"warningBg",Ja(he.warning.main,.62)),At(he.Skeleton,"bg",`rgba(${ke("palette-text-primaryChannel")} / 0.11)`),At(he.Slider,"primaryTrack",Ja(he.primary.main,.62)),At(he.Slider,"secondaryTrack",Ja(he.secondary.main,.62)),At(he.Slider,"errorTrack",Ja(he.error.main,.62)),At(he.Slider,"infoTrack",Ja(he.info.main,.62)),At(he.Slider,"successTrack",Ja(he.success.main,.62)),At(he.Slider,"warningTrack",Ja(he.warning.main,.62));const We=E7(he.background.default,.8);At(he.SnackbarContent,"bg",We),At(he.SnackbarContent,"color",lE(()=>he.getContrastText(We))),At(he.SpeedDialAction,"fabHoverBg",E7(he.background.paper,.15)),At(he.StepConnector,"border",ke("palette-grey-400")),At(he.StepContent,"border",ke("palette-grey-400")),At(he.Switch,"defaultColor",ke("palette-common-white")),At(he.Switch,"defaultDisabledColor",ke("palette-grey-100")),At(he.Switch,"primaryDisabledColor",Ja(he.primary.main,.62)),At(he.Switch,"secondaryDisabledColor",Ja(he.secondary.main,.62)),At(he.Switch,"errorDisabledColor",Ja(he.error.main,.62)),At(he.Switch,"infoDisabledColor",Ja(he.info.main,.62)),At(he.Switch,"successDisabledColor",Ja(he.success.main,.62)),At(he.Switch,"warningDisabledColor",Ja(he.warning.main,.62)),At(he.TableCell,"border",Ja(_7(he.divider,1),.88)),At(he.Tooltip,"bg",_7(he.grey[700],.92))}if(he.mode==="dark"){At(he.Alert,"errorColor",Ja(he.error.light,.6)),At(he.Alert,"infoColor",Ja(he.info.light,.6)),At(he.Alert,"successColor",Ja(he.success.light,.6)),At(he.Alert,"warningColor",Ja(he.warning.light,.6)),At(he.Alert,"errorFilledBg",ke("palette-error-dark")),At(he.Alert,"infoFilledBg",ke("palette-info-dark")),At(he.Alert,"successFilledBg",ke("palette-success-dark")),At(he.Alert,"warningFilledBg",ke("palette-warning-dark")),At(he.Alert,"errorFilledColor",lE(()=>he.getContrastText(he.error.dark))),At(he.Alert,"infoFilledColor",lE(()=>he.getContrastText(he.info.dark))),At(he.Alert,"successFilledColor",lE(()=>he.getContrastText(he.success.dark))),At(he.Alert,"warningFilledColor",lE(()=>he.getContrastText(he.warning.dark))),At(he.Alert,"errorStandardBg",qa(he.error.light,.9)),At(he.Alert,"infoStandardBg",qa(he.info.light,.9)),At(he.Alert,"successStandardBg",qa(he.success.light,.9)),At(he.Alert,"warningStandardBg",qa(he.warning.light,.9)),At(he.Alert,"errorIconColor",ke("palette-error-main")),At(he.Alert,"infoIconColor",ke("palette-info-main")),At(he.Alert,"successIconColor",ke("palette-success-main")),At(he.Alert,"warningIconColor",ke("palette-warning-main")),At(he.AppBar,"defaultBg",ke("palette-grey-900")),At(he.AppBar,"darkBg",ke("palette-background-paper")),At(he.AppBar,"darkColor",ke("palette-text-primary")),At(he.Avatar,"defaultBg",ke("palette-grey-600")),At(he.Button,"inheritContainedBg",ke("palette-grey-800")),At(he.Button,"inheritContainedHoverBg",ke("palette-grey-700")),At(he.Chip,"defaultBorder",ke("palette-grey-700")),At(he.Chip,"defaultAvatarColor",ke("palette-grey-300")),At(he.Chip,"defaultIconColor",ke("palette-grey-300")),At(he.FilledInput,"bg","rgba(255, 255, 255, 0.09)"),At(he.FilledInput,"hoverBg","rgba(255, 255, 255, 0.13)"),At(he.FilledInput,"disabledBg","rgba(255, 255, 255, 0.12)"),At(he.LinearProgress,"primaryBg",qa(he.primary.main,.5)),At(he.LinearProgress,"secondaryBg",qa(he.secondary.main,.5)),At(he.LinearProgress,"errorBg",qa(he.error.main,.5)),At(he.LinearProgress,"infoBg",qa(he.info.main,.5)),At(he.LinearProgress,"successBg",qa(he.success.main,.5)),At(he.LinearProgress,"warningBg",qa(he.warning.main,.5)),At(he.Skeleton,"bg",`rgba(${ke("palette-text-primaryChannel")} / 0.13)`),At(he.Slider,"primaryTrack",qa(he.primary.main,.5)),At(he.Slider,"secondaryTrack",qa(he.secondary.main,.5)),At(he.Slider,"errorTrack",qa(he.error.main,.5)),At(he.Slider,"infoTrack",qa(he.info.main,.5)),At(he.Slider,"successTrack",qa(he.success.main,.5)),At(he.Slider,"warningTrack",qa(he.warning.main,.5));const We=E7(he.background.default,.98);At(he.SnackbarContent,"bg",We),At(he.SnackbarContent,"color",lE(()=>he.getContrastText(We))),At(he.SpeedDialAction,"fabHoverBg",E7(he.background.paper,.15)),At(he.StepConnector,"border",ke("palette-grey-600")),At(he.StepContent,"border",ke("palette-grey-600")),At(he.Switch,"defaultColor",ke("palette-grey-300")),At(he.Switch,"defaultDisabledColor",ke("palette-grey-600")),At(he.Switch,"primaryDisabledColor",qa(he.primary.main,.55)),At(he.Switch,"secondaryDisabledColor",qa(he.secondary.main,.55)),At(he.Switch,"errorDisabledColor",qa(he.error.main,.55)),At(he.Switch,"infoDisabledColor",qa(he.info.main,.55)),At(he.Switch,"successDisabledColor",qa(he.success.main,.55)),At(he.Switch,"warningDisabledColor",qa(he.warning.main,.55)),At(he.TableCell,"border",qa(_7(he.divider,1),.68)),At(he.Tooltip,"bg",_7(he.grey[700],.92))}iy(he.background,"default"),iy(he.background,"paper"),iy(he.common,"background"),iy(he.common,"onBackground"),iy(he,"divider"),Object.keys(he).forEach(We=>{const ze=he[We];We!=="tonalOffset"&&ze&&typeof ze=="object"&&(ze.main&&At(he[We],"mainChannel",$j(e5(ze.main))),ze.light&&At(he[We],"lightChannel",$j(e5(ze.light))),ze.dark&&At(he[We],"darkChannel",$j(e5(ze.dark))),ze.contrastText&&At(he[We],"contrastTextChannel",$j(e5(ze.contrastText))),We==="text"&&(iy(he[We],"primary"),iy(he[We],"secondary")),We==="action"&&(ze.active&&iy(he[We],"active"),ze.selected&&iy(he[We],"selected")))})}),de=d.reduce((je,he)=>kh(je,he),de);const te={prefix:I,disableCssColorScheme:T,shouldSkipGeneratingVar:N,getSelector:Nwe(de)},{vars:ye,generateThemeVars:Te,generateStyleSheets:Le}=ZCe(de,te);return de.vars=ye,Object.entries(de.colorSchemes[de.defaultColorScheme]).forEach(([je,he])=>{de[je]=he}),de.generateThemeVars=Te,de.generateStyleSheets=Le,de.generateSpacing=function(){return kce(x.spacing,wZ(this))},de.getColorSchemeSelector=$Ce(M),de.spacing=de.generateSpacing(),de.shouldSkipGeneratingVar=N,de.unstable_sxConfig={...az,...x==null?void 0:x.unstable_sxConfig},de.unstable_sx=function(he){return AP({sx:he,theme:this})},de.toRuntimeSource=Wce,de}function Rte(o,d,h){o.colorSchemes&&h&&(o.colorSchemes[d]={...h!==!0&&h,palette:DZ({...h===!0?{}:h.palette,mode:d})})}function kwe(o={},...d){const{palette:h,cssVariables:g=!1,colorSchemes:T=h?void 0:{light:!0},defaultColorScheme:I=h==null?void 0:h.mode,...N}=o,M=I||"light",k=T==null?void 0:T[M],x={...T,...h?{[M]:{...typeof k!="boolean"&&k,palette:h}}:void 0};if(g===!1){if(!("colorSchemes"in o))return aQ(o,...d);let V=h;"palette"in o||x[M]&&(x[M]!==!0?V=x[M].palette:M==="dark"&&(V={mode:"dark"}));const K=aQ({...o,palette:V},...d);return K.defaultColorScheme=M,K.colorSchemes=x,K.palette.mode==="light"&&(K.colorSchemes.light={...x.light!==!0&&x.light,palette:K.palette},Rte(K,"dark",x.dark)),K.palette.mode==="dark"&&(K.colorSchemes.dark={...x.dark!==!0&&x.dark,palette:K.palette},Rte(K,"light",x.light)),K}return!h&&!("light"in x)&&M==="light"&&(x.light=!0),Mwe({...N,colorSchemes:x,defaultColorScheme:M,...typeof g!="boolean"&&g},...d)}const qce=kwe();function cz(){const o=xce(qce);return o[_ce]||o}function xwe(o){return o!=="ownerState"&&o!=="theme"&&o!=="sx"&&o!=="as"}const lz=o=>xwe(o)&&o!=="classes",wi=Bce({themeId:_ce,defaultTheme:qce,rootShouldForwardProp:lz});function Ite(...o){return o.reduce((d,h)=>h==null?d:function(...T){d.apply(this,T),h.apply(this,T)},()=>{})}function Jce(o){var d,h,g="";if(typeof o=="string"||typeof o=="number")g+=o;else if(typeof o=="object")if(Array.isArray(o)){var T=o.length;for(d=0;d<T;d++)o[d]&&(h=Jce(o[d]))&&(g&&(g+=" "),g+=h)}else for(h in o)o[h]&&(g&&(g+=" "),g+=h);return g}function Ki(){for(var o,d,h=0,g="",T=arguments.length;h<T;h++)(o=arguments[h])&&(d=Jce(o))&&(g&&(g+=" "),g+=d);return g}const yd=qCe;function Ec(o){return WCe(o)}function Uwe(o){return _c("MuiSvgIcon",o)}Zo("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);const jwe=o=>{const{color:d,fontSize:h,classes:g}=o,T={root:["root",d!=="inherit"&&`color${Nn(d)}`,`fontSize${Nn(h)}`]};return tl(T,Uwe,g)},Vwe=wi("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:(o,d)=>{const{ownerState:h}=o;return[d.root,h.color!=="inherit"&&d[`color${Nn(h.color)}`],d[`fontSize${Nn(h.fontSize)}`]]}})(yd(({theme:o})=>{var d,h,g,T,I,N,M,k,x,V,K,Q,ie,X;return{userSelect:"none",width:"1em",height:"1em",display:"inline-block",flexShrink:0,transition:(T=(d=o.transitions)==null?void 0:d.create)==null?void 0:T.call(d,"fill",{duration:(g=(h=(o.vars??o).transitions)==null?void 0:h.duration)==null?void 0:g.shorter}),variants:[{props:Z=>!Z.hasSvgAsChild,style:{fill:"currentColor"}},{props:{fontSize:"inherit"},style:{fontSize:"inherit"}},{props:{fontSize:"small"},style:{fontSize:((N=(I=o.typography)==null?void 0:I.pxToRem)==null?void 0:N.call(I,20))||"1.25rem"}},{props:{fontSize:"medium"},style:{fontSize:((k=(M=o.typography)==null?void 0:M.pxToRem)==null?void 0:k.call(M,24))||"1.5rem"}},{props:{fontSize:"large"},style:{fontSize:((V=(x=o.typography)==null?void 0:x.pxToRem)==null?void 0:V.call(x,35))||"2.1875rem"}},...Object.entries((o.vars??o).palette).filter(([,Z])=>Z&&Z.main).map(([Z])=>{var ae,le;return{props:{color:Z},style:{color:(le=(ae=(o.vars??o).palette)==null?void 0:ae[Z])==null?void 0:le.main}}}),{props:{color:"action"},style:{color:(Q=(K=(o.vars??o).palette)==null?void 0:K.action)==null?void 0:Q.active}},{props:{color:"disabled"},style:{color:(X=(ie=(o.vars??o).palette)==null?void 0:ie.action)==null?void 0:X.disabled}},{props:{color:"inherit"},style:{color:void 0}}]}})),oQ=q.forwardRef(function(d,h){const g=Ec({props:d,name:"MuiSvgIcon"}),{children:T,className:I,color:N="inherit",component:M="svg",fontSize:k="medium",htmlColor:x,inheritViewBox:V=!1,titleAccess:K,viewBox:Q="0 0 24 24",...ie}=g,X=q.isValidElement(T)&&T.type==="svg",Z={...g,color:N,component:M,fontSize:k,instanceFontSize:d.fontSize,inheritViewBox:V,viewBox:Q,hasSvgAsChild:X},ae={};V||(ae.viewBox=Q);const le=jwe(Z);return j.jsxs(Vwe,{as:M,className:Ki(le.root,I),focusable:"false",color:x,"aria-hidden":K?void 0:!0,role:K?"img":void 0,ref:h,...ae,...ie,...X&&T.props,ownerState:Z,children:[X?T.props.children:T,K?j.jsx("title",{children:K}):null]})});oQ.muiName="SvgIcon";function ym(o,d){function h(g,T){return j.jsx(oQ,{"data-testid":void 0,ref:T,...g,children:o})}return h.muiName=oQ.muiName,q.memo(q.forwardRef(h))}function Bwe(o,d=166){let h;function g(...T){const I=()=>{o.apply(this,T)};clearTimeout(h),h=setTimeout(I,d)}return g.clear=()=>{clearTimeout(h)},g}function mm(o){return o&&o.ownerDocument||document}function WA(o){return mm(o).defaultView||window}function Ate(o,d){typeof o=="function"?o(d):o&&(o.current=d)}function Fwe(o){const{controlled:d,default:h}=o,{current:g}=q.useRef(d!==void 0),[T,I]=q.useState(h),N=g?d:T,M=q.useCallback(k=>{g||I(k)},[]);return[N,M]}function tC(o){const d=q.useRef(o);return HA(()=>{d.current=o}),q.useRef((...h)=>(0,d.current)(...h)).current}function Eu(...o){const d=q.useRef(void 0),h=q.useCallback(g=>{const T=o.map(I=>{if(I==null)return null;if(typeof I=="function"){const N=I,M=N(g);return typeof M=="function"?M:()=>{N(null)}}return I.current=g,()=>{I.current=null}});return()=>{T.forEach(I=>I==null?void 0:I())}},o);return q.useMemo(()=>o.every(g=>g==null)?null:g=>{d.current&&(d.current(),d.current=void 0),g!=null&&(d.current=h(g))},o)}function Gwe(o,d){const h=o.charCodeAt(2);return o[0]==="o"&&o[1]==="n"&&h>=65&&h<=90&&typeof d=="function"}function zwe(o,d){if(!o)return d;function h(N,M){const k={};return Object.keys(M).forEach(x=>{Gwe(x,M[x])&&typeof N[x]=="function"&&(k[x]=(...V)=>{N[x](...V),M[x](...V)})}),k}if(typeof o=="function"||typeof d=="function")return N=>{const M=typeof d=="function"?d(N):d,k=typeof o=="function"?o({...N,...M}):o,x=Ki(N==null?void 0:N.className,M==null?void 0:M.className,k==null?void 0:k.className),V=h(k,M);return{...M,...k,...V,...!!x&&{className:x},...(M==null?void 0:M.style)&&(k==null?void 0:k.style)&&{style:{...M.style,...k.style}},...(M==null?void 0:M.sx)&&(k==null?void 0:k.sx)&&{sx:[...Array.isArray(M.sx)?M.sx:[M.sx],...Array.isArray(k.sx)?k.sx:[k.sx]]}}};const g=d,T=h(o,g),I=Ki(g==null?void 0:g.className,o==null?void 0:o.className);return{...d,...o,...T,...!!I&&{className:I},...(g==null?void 0:g.style)&&(o==null?void 0:o.style)&&{style:{...g.style,...o.style}},...(g==null?void 0:g.sx)&&(o==null?void 0:o.sx)&&{sx:[...Array.isArray(g.sx)?g.sx:[g.sx],...Array.isArray(o.sx)?o.sx:[o.sx]]}}}function Xce(o,d){if(o==null)return{};var h={};for(var g in o)if({}.hasOwnProperty.call(o,g)){if(d.indexOf(g)!==-1)continue;h[g]=o[g]}return h}function cQ(o,d){return cQ=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(h,g){return h.__proto__=g,h},cQ(o,d)}function Qce(o,d){o.prototype=Object.create(d.prototype),o.prototype.constructor=o,cQ(o,d)}const Ote={disabled:!1},lG=fo.createContext(null);var Hwe=function(d){return d.scrollTop},t5="unmounted",RA="exited",IA="entering",uP="entered",lQ="exiting",TE=function(o){Qce(d,o);function d(g,T){var I;I=o.call(this,g,T)||this;var N=T,M=N&&!N.isMounting?g.enter:g.appear,k;return I.appearStatus=null,g.in?M?(k=RA,I.appearStatus=IA):k=uP:g.unmountOnExit||g.mountOnEnter?k=t5:k=RA,I.state={status:k},I.nextCallback=null,I}d.getDerivedStateFromProps=function(T,I){var N=T.in;return N&&I.status===t5?{status:RA}:null};var h=d.prototype;return h.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},h.componentDidUpdate=function(T){var I=null;if(T!==this.props){var N=this.state.status;this.props.in?N!==IA&&N!==uP&&(I=IA):(N===IA||N===uP)&&(I=lQ)}this.updateStatus(!1,I)},h.componentWillUnmount=function(){this.cancelNextCallback()},h.getTimeouts=function(){var T=this.props.timeout,I,N,M;return I=N=M=T,T!=null&&typeof T!="number"&&(I=T.exit,N=T.enter,M=T.appear!==void 0?T.appear:N),{exit:I,enter:N,appear:M}},h.updateStatus=function(T,I){if(T===void 0&&(T=!1),I!==null)if(this.cancelNextCallback(),I===IA){if(this.props.unmountOnExit||this.props.mountOnEnter){var N=this.props.nodeRef?this.props.nodeRef.current:u7.findDOMNode(this);N&&Hwe(N)}this.performEnter(T)}else this.performExit();else this.props.unmountOnExit&&this.state.status===RA&&this.setState({status:t5})},h.performEnter=function(T){var I=this,N=this.props.enter,M=this.context?this.context.isMounting:T,k=this.props.nodeRef?[M]:[u7.findDOMNode(this),M],x=k[0],V=k[1],K=this.getTimeouts(),Q=M?K.appear:K.enter;if(!T&&!N||Ote.disabled){this.safeSetState({status:uP},function(){I.props.onEntered(x)});return}this.props.onEnter(x,V),this.safeSetState({status:IA},function(){I.props.onEntering(x,V),I.onTransitionEnd(Q,function(){I.safeSetState({status:uP},function(){I.props.onEntered(x,V)})})})},h.performExit=function(){var T=this,I=this.props.exit,N=this.getTimeouts(),M=this.props.nodeRef?void 0:u7.findDOMNode(this);if(!I||Ote.disabled){this.safeSetState({status:RA},function(){T.props.onExited(M)});return}this.props.onExit(M),this.safeSetState({status:lQ},function(){T.props.onExiting(M),T.onTransitionEnd(N.exit,function(){T.safeSetState({status:RA},function(){T.props.onExited(M)})})})},h.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},h.safeSetState=function(T,I){I=this.setNextCallback(I),this.setState(T,I)},h.setNextCallback=function(T){var I=this,N=!0;return this.nextCallback=function(M){N&&(N=!1,I.nextCallback=null,T(M))},this.nextCallback.cancel=function(){N=!1},this.nextCallback},h.onTransitionEnd=function(T,I){this.setNextCallback(I);var N=this.props.nodeRef?this.props.nodeRef.current:u7.findDOMNode(this),M=T==null&&!this.props.addEndListener;if(!N||M){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var k=this.props.nodeRef?[this.nextCallback]:[N,this.nextCallback],x=k[0],V=k[1];this.props.addEndListener(x,V)}T!=null&&setTimeout(this.nextCallback,T)},h.render=function(){var T=this.state.status;if(T===t5)return null;var I=this.props,N=I.children;I.in,I.mountOnEnter,I.unmountOnExit,I.appear,I.enter,I.exit,I.timeout,I.addEndListener,I.onEnter,I.onEntering,I.onEntered,I.onExit,I.onExiting,I.onExited,I.nodeRef;var M=Xce(I,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return fo.createElement(lG.Provider,{value:null},typeof N=="function"?N(T,M):fo.cloneElement(fo.Children.only(N),M))},d}(fo.Component);TE.contextType=lG;TE.propTypes={};function sP(){}TE.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:sP,onEntering:sP,onEntered:sP,onExit:sP,onExiting:sP,onExited:sP};TE.UNMOUNTED=t5;TE.EXITED=RA;TE.ENTERING=IA;TE.ENTERED=uP;TE.EXITING=lQ;function Wwe(o){if(o===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return o}function PZ(o,d){var h=function(I){return d&&q.isValidElement(I)?d(I):I},g=Object.create(null);return o&&q.Children.map(o,function(T){return T}).forEach(function(T){g[T.key]=h(T)}),g}function Ywe(o,d){o=o||{},d=d||{};function h(V){return V in d?d[V]:o[V]}var g=Object.create(null),T=[];for(var I in o)I in d?T.length&&(g[I]=T,T=[]):T.push(I);var N,M={};for(var k in d){if(g[k])for(N=0;N<g[k].length;N++){var x=g[k][N];M[g[k][N]]=h(x)}M[k]=h(k)}for(N=0;N<T.length;N++)M[T[N]]=h(T[N]);return M}function MA(o,d,h){return h[d]!=null?h[d]:o.props[d]}function Kwe(o,d){return PZ(o.children,function(h){return q.cloneElement(h,{onExited:d.bind(null,h),in:!0,appear:MA(h,"appear",o),enter:MA(h,"enter",o),exit:MA(h,"exit",o)})})}function qwe(o,d,h){var g=PZ(o.children),T=Ywe(d,g);return Object.keys(T).forEach(function(I){var N=T[I];if(q.isValidElement(N)){var M=I in d,k=I in g,x=d[I],V=q.isValidElement(x)&&!x.props.in;k&&(!M||V)?T[I]=q.cloneElement(N,{onExited:h.bind(null,N),in:!0,exit:MA(N,"exit",o),enter:MA(N,"enter",o)}):!k&&M&&!V?T[I]=q.cloneElement(N,{in:!1}):k&&M&&q.isValidElement(x)&&(T[I]=q.cloneElement(N,{onExited:h.bind(null,N),in:x.props.in,exit:MA(N,"exit",o),enter:MA(N,"enter",o)}))}}),T}var Jwe=Object.values||function(o){return Object.keys(o).map(function(d){return o[d]})},Xwe={component:"div",childFactory:function(d){return d}},MZ=function(o){Qce(d,o);function d(g,T){var I;I=o.call(this,g,T)||this;var N=I.handleExited.bind(Wwe(I));return I.state={contextValue:{isMounting:!0},handleExited:N,firstRender:!0},I}var h=d.prototype;return h.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},h.componentWillUnmount=function(){this.mounted=!1},d.getDerivedStateFromProps=function(T,I){var N=I.children,M=I.handleExited,k=I.firstRender;return{children:k?Kwe(T,M):qwe(T,N,M),firstRender:!1}},h.handleExited=function(T,I){var N=PZ(this.props.children);T.key in N||(T.props.onExited&&T.props.onExited(I),this.mounted&&this.setState(function(M){var k=sG({},M.children);return delete k[T.key],{children:k}}))},h.render=function(){var T=this.props,I=T.component,N=T.childFactory,M=Xce(T,["component","childFactory"]),k=this.state.contextValue,x=Jwe(this.state.children).map(N);return delete M.appear,delete M.enter,delete M.exit,I===null?fo.createElement(lG.Provider,{value:k},x):fo.createElement(lG.Provider,{value:k},fo.createElement(I,M,x))},d}(fo.Component);MZ.propTypes={};MZ.defaultProps=Xwe;const Nte={};function Zce(o,d){const h=q.useRef(Nte);return h.current===Nte&&(h.current=o(d)),h}const Qwe=[];function Zwe(o){q.useEffect(o,Qwe)}class dz{constructor(){ry(this,"currentId",null);ry(this,"clear",()=>{this.currentId!==null&&(clearTimeout(this.currentId),this.currentId=null)});ry(this,"disposeEffect",()=>this.clear)}static create(){return new dz}start(d,h){this.clear(),this.currentId=setTimeout(()=>{this.currentId=null,h()},d)}}function hP(){const o=Zce(dz.create).current;return Zwe(o.disposeEffect),o}const $ce=o=>o.scrollTop;function dG(o,d){const{timeout:h,easing:g,style:T={}}=o;return{duration:T.transitionDuration??(typeof h=="number"?h:h[d.mode]||0),easing:T.transitionTimingFunction??(typeof g=="object"?g[d.mode]:g),delay:T.transitionDelay}}function $we(o){return _c("MuiPaper",o)}Zo("MuiPaper",["root","rounded","outlined","elevation","elevation0","elevation1","elevation2","elevation3","elevation4","elevation5","elevation6","elevation7","elevation8","elevation9","elevation10","elevation11","elevation12","elevation13","elevation14","elevation15","elevation16","elevation17","elevation18","elevation19","elevation20","elevation21","elevation22","elevation23","elevation24"]);const eRe=o=>{const{square:d,elevation:h,variant:g,classes:T}=o,I={root:["root",g,!d&&"rounded",g==="elevation"&&`elevation${h}`]};return tl(I,$we,T)},tRe=wi("div",{name:"MuiPaper",slot:"Root",overridesResolver:(o,d)=>{const{ownerState:h}=o;return[d.root,d[h.variant],!h.square&&d.rounded,h.variant==="elevation"&&d[`elevation${h.elevation}`]]}})(yd(({theme:o})=>({backgroundColor:(o.vars||o).palette.background.paper,color:(o.vars||o).palette.text.primary,transition:o.transitions.create("box-shadow"),variants:[{props:({ownerState:d})=>!d.square,style:{borderRadius:o.shape.borderRadius}},{props:{variant:"outlined"},style:{border:`1px solid ${(o.vars||o).palette.divider}`}},{props:{variant:"elevation"},style:{boxShadow:"var(--Paper-shadow)",backgroundImage:"var(--Paper-overlay)"}}]}))),nRe=q.forwardRef(function(d,h){var ie;const g=Ec({props:d,name:"MuiPaper"}),T=cz(),{className:I,component:N="div",elevation:M=1,square:k=!1,variant:x="elevation",...V}=g,K={...g,component:N,elevation:M,square:k,variant:x},Q=eRe(K);return j.jsx(tRe,{as:N,ownerState:K,className:Ki(Q.root,I),ref:h,...V,style:{...x==="elevation"&&{"--Paper-shadow":(T.vars||T).shadows[M],...T.vars&&{"--Paper-overlay":(ie=T.vars.overlays)==null?void 0:ie[M]},...!T.vars&&T.palette.mode==="dark"&&{"--Paper-overlay":`linear-gradient(${Qa("#fff",sQ(M))}, ${Qa("#fff",sQ(M))})`}},...V.style}})});function rRe(o){return typeof o=="string"}function ele(o,d,h){return o===void 0||rRe(o)?d:{...d,ownerState:{...d.ownerState,...h}}}function tle(o,d,h){return typeof o=="function"?o(d,h):o}function nle(o,d=[]){if(o===void 0)return{};const h={};return Object.keys(o).filter(g=>g.match(/^on[A-Z]/)&&typeof o[g]=="function"&&!d.includes(g)).forEach(g=>{h[g]=o[g]}),h}function Lte(o){if(o===void 0)return{};const d={};return Object.keys(o).filter(h=>!(h.match(/^on[A-Z]/)&&typeof o[h]=="function")).forEach(h=>{d[h]=o[h]}),d}function rle(o){const{getSlotProps:d,additionalProps:h,externalSlotProps:g,externalForwardedProps:T,className:I}=o;if(!d){const ie=rQ(h==null?void 0:h.className,I,T==null?void 0:T.className,g==null?void 0:g.className),X={...h==null?void 0:h.style,...T==null?void 0:T.style,...g==null?void 0:g.style},Z={...h,...T,...g};return ie.length>0&&(Z.className=ie),Object.keys(X).length>0&&(Z.style=X),{props:Z,internalRef:void 0}}const N=nle({...T,...g}),M=Lte(g),k=Lte(T),x=d(N),V=rQ(x==null?void 0:x.className,h==null?void 0:h.className,I,T==null?void 0:T.className,g==null?void 0:g.className),K={...x==null?void 0:x.style,...h==null?void 0:h.style,...T==null?void 0:T.style,...g==null?void 0:g.style},Q={...x,...h,...k,...M};return V.length>0&&(Q.className=V),Object.keys(K).length>0&&(Q.style=K),{props:Q,internalRef:x.ref}}function el(o,d){const{className:h,elementType:g,ownerState:T,externalForwardedProps:I,internalForwardedProps:N,shouldForwardComponentProp:M=!1,...k}=d,{component:x,slots:V={[o]:void 0},slotProps:K={[o]:void 0},...Q}=I,ie=V[o]||g,X=tle(K[o],T),{props:{component:Z,...ae},internalRef:le}=rle({className:h,...k,externalForwardedProps:o==="root"?Q:void 0,externalSlotProps:X}),fe=Eu(le,X==null?void 0:X.ref,d.ref),ue=o==="root"?Z||x:Z,de=ele(ie,{...o==="root"&&!x&&!V[o]&&N,...o!=="root"&&!V[o]&&N,...ae,...ue&&!M&&{as:ue},...ue&&M&&{component:ue},ref:fe},T);return[ie,de]}function uG(o){try{return o.matches(":focus-visible")}catch{}return!1}class fG{constructor(){ry(this,"mountEffect",()=>{this.shouldMount&&!this.didMount&&this.ref.current!==null&&(this.didMount=!0,this.mounted.resolve())});this.ref={current:null},this.mounted=null,this.didMount=!1,this.shouldMount=!1,this.setShouldMount=null}static create(){return new fG}static use(){const d=Zce(fG.create).current,[h,g]=q.useState(!1);return d.shouldMount=h,d.setShouldMount=g,q.useEffect(d.mountEffect,[h]),d}mount(){return this.mounted||(this.mounted=aRe(),this.shouldMount=!0,this.setShouldMount(this.shouldMount)),this.mounted}start(...d){this.mount().then(()=>{var h;return(h=this.ref.current)==null?void 0:h.start(...d)})}stop(...d){this.mount().then(()=>{var h;return(h=this.ref.current)==null?void 0:h.stop(...d)})}pulsate(...d){this.mount().then(()=>{var h;return(h=this.ref.current)==null?void 0:h.pulsate(...d)})}}function iRe(){return fG.use()}function aRe(){let o,d;const h=new Promise((g,T)=>{o=g,d=T});return h.resolve=o,h.reject=d,h}function sRe(o){const{className:d,classes:h,pulsate:g=!1,rippleX:T,rippleY:I,rippleSize:N,in:M,onExited:k,timeout:x}=o,[V,K]=q.useState(!1),Q=Ki(d,h.ripple,h.rippleVisible,g&&h.ripplePulsate),ie={width:N,height:N,top:-(N/2)+I,left:-(N/2)+T},X=Ki(h.child,V&&h.childLeaving,g&&h.childPulsate);return!M&&!V&&K(!0),q.useEffect(()=>{if(!M&&k!=null){const Z=setTimeout(k,x);return()=>{clearTimeout(Z)}}},[k,M,x]),j.jsx("span",{className:Q,style:ie,children:j.jsx("span",{className:X})})}const um=Zo("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]),dQ=550,oRe=80,cRe=q5`
  0% {
    transform: scale(0);
    opacity: 0.1;
  }

  100% {
    transform: scale(1);
    opacity: 0.3;
  }
`,lRe=q5`
  0% {
    opacity: 1;
  }

  100% {
    opacity: 0;
  }
`,dRe=q5`
  0% {
    transform: scale(1);
  }

  50% {
    transform: scale(0.92);
  }

  100% {
    transform: scale(1);
  }
`,uRe=wi("span",{name:"MuiTouchRipple",slot:"Root"})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),fRe=wi(sRe,{name:"MuiTouchRipple",slot:"Ripple"})`
  opacity: 0;
  position: absolute;

  &.${um.rippleVisible} {
    opacity: 0.3;
    transform: scale(1);
    animation-name: ${cRe};
    animation-duration: ${dQ}ms;
    animation-timing-function: ${({theme:o})=>o.transitions.easing.easeInOut};
  }

  &.${um.ripplePulsate} {
    animation-duration: ${({theme:o})=>o.transitions.duration.shorter}ms;
  }

  & .${um.child} {
    opacity: 1;
    display: block;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background-color: currentColor;
  }

  & .${um.childLeaving} {
    opacity: 0;
    animation-name: ${lRe};
    animation-duration: ${dQ}ms;
    animation-timing-function: ${({theme:o})=>o.transitions.easing.easeInOut};
  }

  & .${um.childPulsate} {
    position: absolute;
    /* @noflip */
    left: 0px;
    top: 0;
    animation-name: ${dRe};
    animation-duration: 2500ms;
    animation-timing-function: ${({theme:o})=>o.transitions.easing.easeInOut};
    animation-iteration-count: infinite;
    animation-delay: 200ms;
  }
`,hRe=q.forwardRef(function(d,h){const g=Ec({props:d,name:"MuiTouchRipple"}),{center:T=!1,classes:I={},className:N,...M}=g,[k,x]=q.useState([]),V=q.useRef(0),K=q.useRef(null);q.useEffect(()=>{K.current&&(K.current(),K.current=null)},[k]);const Q=q.useRef(!1),ie=hP(),X=q.useRef(null),Z=q.useRef(null),ae=q.useCallback(de=>{const{pulsate:te,rippleX:ye,rippleY:Te,rippleSize:Le,cb:je}=de;x(he=>[...he,j.jsx(fRe,{classes:{ripple:Ki(I.ripple,um.ripple),rippleVisible:Ki(I.rippleVisible,um.rippleVisible),ripplePulsate:Ki(I.ripplePulsate,um.ripplePulsate),child:Ki(I.child,um.child),childLeaving:Ki(I.childLeaving,um.childLeaving),childPulsate:Ki(I.childPulsate,um.childPulsate)},timeout:dQ,pulsate:te,rippleX:ye,rippleY:Te,rippleSize:Le},V.current)]),V.current+=1,K.current=je},[I]),le=q.useCallback((de={},te={},ye=()=>{})=>{const{pulsate:Te=!1,center:Le=T||te.pulsate,fakeElement:je=!1}=te;if((de==null?void 0:de.type)==="mousedown"&&Q.current){Q.current=!1;return}(de==null?void 0:de.type)==="touchstart"&&(Q.current=!0);const he=je?null:Z.current,ke=he?he.getBoundingClientRect():{width:0,height:0,left:0,top:0};let We,ze,$e;if(Le||de===void 0||de.clientX===0&&de.clientY===0||!de.clientX&&!de.touches)We=Math.round(ke.width/2),ze=Math.round(ke.height/2);else{const{clientX:et,clientY:Oe}=de.touches&&de.touches.length>0?de.touches[0]:de;We=Math.round(et-ke.left),ze=Math.round(Oe-ke.top)}if(Le)$e=Math.sqrt((2*ke.width**2+ke.height**2)/3),$e%2===0&&($e+=1);else{const et=Math.max(Math.abs((he?he.clientWidth:0)-We),We)*2+2,Oe=Math.max(Math.abs((he?he.clientHeight:0)-ze),ze)*2+2;$e=Math.sqrt(et**2+Oe**2)}de!=null&&de.touches?X.current===null&&(X.current=()=>{ae({pulsate:Te,rippleX:We,rippleY:ze,rippleSize:$e,cb:ye})},ie.start(oRe,()=>{X.current&&(X.current(),X.current=null)})):ae({pulsate:Te,rippleX:We,rippleY:ze,rippleSize:$e,cb:ye})},[T,ae,ie]),fe=q.useCallback(()=>{le({},{pulsate:!0})},[le]),ue=q.useCallback((de,te)=>{if(ie.clear(),(de==null?void 0:de.type)==="touchend"&&X.current){X.current(),X.current=null,ie.start(0,()=>{ue(de,te)});return}X.current=null,x(ye=>ye.length>0?ye.slice(1):ye),K.current=te},[ie]);return q.useImperativeHandle(h,()=>({pulsate:fe,start:le,stop:ue}),[fe,le,ue]),j.jsx(uRe,{className:Ki(um.root,I.root,N),ref:Z,...M,children:j.jsx(MZ,{component:null,exit:!0,children:k})})});function pRe(o){return _c("MuiButtonBase",o)}const mRe=Zo("MuiButtonBase",["root","disabled","focusVisible"]),gRe=o=>{const{disabled:d,focusVisible:h,focusVisibleClassName:g,classes:T}=o,N=tl({root:["root",d&&"disabled",h&&"focusVisible"]},pRe,T);return h&&g&&(N.root+=` ${g}`),N},_Re=wi("button",{name:"MuiButtonBase",slot:"Root"})({display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"},[`&.${mRe.disabled}`]:{pointerEvents:"none",cursor:"default"},"@media print":{colorAdjust:"exact"}}),O5=q.forwardRef(function(d,h){const g=Ec({props:d,name:"MuiButtonBase"}),{action:T,centerRipple:I=!1,children:N,className:M,component:k="button",disabled:x=!1,disableRipple:V=!1,disableTouchRipple:K=!1,focusRipple:Q=!1,focusVisibleClassName:ie,LinkComponent:X="a",onBlur:Z,onClick:ae,onContextMenu:le,onDragLeave:fe,onFocus:ue,onFocusVisible:de,onKeyDown:te,onKeyUp:ye,onMouseDown:Te,onMouseLeave:Le,onMouseUp:je,onTouchEnd:he,onTouchMove:ke,onTouchStart:We,tabIndex:ze=0,TouchRippleProps:$e,touchRippleRef:et,type:Oe,...qe}=g,lt=q.useRef(null),Ge=iRe(),Ae=Eu(Ge.ref,et),[rt,yt]=q.useState(!1);x&&rt&&yt(!1),q.useImperativeHandle(T,()=>({focusVisible:()=>{yt(!0),lt.current.focus()}}),[]);const Lt=Ge.shouldMount&&!V&&!x;q.useEffect(()=>{rt&&Q&&!V&&Ge.pulsate()},[V,Q,rt,Ge]);const Pt=ay(Ge,"start",Te,K),_n=ay(Ge,"stop",le,K),Gt=ay(Ge,"stop",fe,K),zt=ay(Ge,"stop",je,K),rn=ay(Ge,"stop",Sn=>{rt&&Sn.preventDefault(),Le&&Le(Sn)},K),ir=ay(Ge,"start",We,K),kt=ay(Ge,"stop",he,K),Ht=ay(Ge,"stop",ke,K),Jt=ay(Ge,"stop",Sn=>{uG(Sn.target)||yt(!1),Z&&Z(Sn)},!1),tn=tC(Sn=>{lt.current||(lt.current=Sn.currentTarget),uG(Sn.target)&&(yt(!0),de&&de(Sn)),ue&&ue(Sn)}),Yn=()=>{const Sn=lt.current;return k&&k!=="button"&&!(Sn.tagName==="A"&&Sn.href)},oi=tC(Sn=>{Q&&!Sn.repeat&&rt&&Sn.key===" "&&Ge.stop(Sn,()=>{Ge.start(Sn)}),Sn.target===Sn.currentTarget&&Yn()&&Sn.key===" "&&Sn.preventDefault(),te&&te(Sn),Sn.target===Sn.currentTarget&&Yn()&&Sn.key==="Enter"&&!x&&(Sn.preventDefault(),ae&&ae(Sn))}),Ri=tC(Sn=>{Q&&Sn.key===" "&&rt&&!Sn.defaultPrevented&&Ge.stop(Sn,()=>{Ge.pulsate(Sn)}),ye&&ye(Sn),ae&&Sn.target===Sn.currentTarget&&Yn()&&Sn.key===" "&&!Sn.defaultPrevented&&ae(Sn)});let jr=k;jr==="button"&&(qe.href||qe.to)&&(jr=X);const dr={};jr==="button"?(dr.type=Oe===void 0?"button":Oe,dr.disabled=x):(!qe.href&&!qe.to&&(dr.role="button"),x&&(dr["aria-disabled"]=x));const Ii=Eu(h,lt),sa={...g,centerRipple:I,component:k,disabled:x,disableRipple:V,disableTouchRipple:K,focusRipple:Q,tabIndex:ze,focusVisible:rt},ar=gRe(sa);return j.jsxs(_Re,{as:jr,className:Ki(ar.root,M),ownerState:sa,onBlur:Jt,onClick:ae,onContextMenu:_n,onFocus:tn,onKeyDown:oi,onKeyUp:Ri,onMouseDown:Pt,onMouseLeave:rn,onMouseUp:zt,onDragLeave:Gt,onTouchEnd:kt,onTouchMove:Ht,onTouchStart:ir,ref:Ii,tabIndex:x?-1:ze,type:Oe,...dr,...qe,children:[N,Lt?j.jsx(hRe,{ref:Ae,center:I,...$e}):null]})});function ay(o,d,h,g=!1){return tC(T=>(h&&h(T),g||o[d](T),!0))}function ERe(o){return typeof o.main=="string"}function vRe(o,d=[]){if(!ERe(o))return!1;for(const h of d)if(!o.hasOwnProperty(h)||typeof o[h]!="string")return!1;return!0}function $1(o=[]){return([,d])=>d&&vRe(d,o)}function SRe(o){return _c("MuiCircularProgress",o)}Zo("MuiCircularProgress",["root","determinate","indeterminate","colorPrimary","colorSecondary","svg","circle","circleDeterminate","circleIndeterminate","circleDisableShrink"]);const J1=44,uQ=q5`
  0% {
    transform: rotate(0deg);
  }

  100% {
    transform: rotate(360deg);
  }
`,fQ=q5`
  0% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: 0;
  }

  50% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -15px;
  }

  100% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: -126px;
  }
`,yRe=typeof uQ!="string"?TZ`
        animation: ${uQ} 1.4s linear infinite;
      `:null,TRe=typeof fQ!="string"?TZ`
        animation: ${fQ} 1.4s ease-in-out infinite;
      `:null,bRe=o=>{const{classes:d,variant:h,color:g,disableShrink:T}=o,I={root:["root",h,`color${Nn(g)}`],svg:["svg"],circle:["circle",`circle${Nn(h)}`,T&&"circleDisableShrink"]};return tl(I,SRe,d)},CRe=wi("span",{name:"MuiCircularProgress",slot:"Root",overridesResolver:(o,d)=>{const{ownerState:h}=o;return[d.root,d[h.variant],d[`color${Nn(h.color)}`]]}})(yd(({theme:o})=>({display:"inline-block",variants:[{props:{variant:"determinate"},style:{transition:o.transitions.create("transform")}},{props:{variant:"indeterminate"},style:yRe||{animation:`${uQ} 1.4s linear infinite`}},...Object.entries(o.palette).filter($1()).map(([d])=>({props:{color:d},style:{color:(o.vars||o).palette[d].main}}))]}))),wRe=wi("svg",{name:"MuiCircularProgress",slot:"Svg"})({display:"block"}),RRe=wi("circle",{name:"MuiCircularProgress",slot:"Circle",overridesResolver:(o,d)=>{const{ownerState:h}=o;return[d.circle,d[`circle${Nn(h.variant)}`],h.disableShrink&&d.circleDisableShrink]}})(yd(({theme:o})=>({stroke:"currentColor",variants:[{props:{variant:"determinate"},style:{transition:o.transitions.create("stroke-dashoffset")}},{props:{variant:"indeterminate"},style:{strokeDasharray:"80px, 200px",strokeDashoffset:0}},{props:({ownerState:d})=>d.variant==="indeterminate"&&!d.disableShrink,style:TRe||{animation:`${fQ} 1.4s ease-in-out infinite`}}]}))),ile=q.forwardRef(function(d,h){const g=Ec({props:d,name:"MuiCircularProgress"}),{className:T,color:I="primary",disableShrink:N=!1,size:M=40,style:k,thickness:x=3.6,value:V=0,variant:K="indeterminate",...Q}=g,ie={...g,color:I,disableShrink:N,size:M,thickness:x,value:V,variant:K},X=bRe(ie),Z={},ae={},le={};if(K==="determinate"){const fe=2*Math.PI*((J1-x)/2);Z.strokeDasharray=fe.toFixed(3),le["aria-valuenow"]=Math.round(V),Z.strokeDashoffset=`${((100-V)/100*fe).toFixed(3)}px`,ae.transform="rotate(-90deg)"}return j.jsx(CRe,{className:Ki(X.root,T),style:{width:M,height:M,...ae,...k},ownerState:ie,ref:h,role:"progressbar",...le,...Q,children:j.jsx(wRe,{className:X.svg,ownerState:ie,viewBox:`${J1/2} ${J1/2} ${J1} ${J1}`,children:j.jsx(RRe,{className:X.circle,style:Z,ownerState:ie,cx:J1,cy:J1,r:(J1-x)/2,fill:"none",strokeWidth:x})})})});function IRe(o){return _c("MuiIconButton",o)}const Dte=Zo("MuiIconButton",["root","disabled","colorInherit","colorPrimary","colorSecondary","colorError","colorInfo","colorSuccess","colorWarning","edgeStart","edgeEnd","sizeSmall","sizeMedium","sizeLarge","loading","loadingIndicator","loadingWrapper"]),ARe=o=>{const{classes:d,disabled:h,color:g,edge:T,size:I,loading:N}=o,M={root:["root",N&&"loading",h&&"disabled",g!=="default"&&`color${Nn(g)}`,T&&`edge${Nn(T)}`,`size${Nn(I)}`],loadingIndicator:["loadingIndicator"],loadingWrapper:["loadingWrapper"]};return tl(M,IRe,d)},ORe=wi(O5,{name:"MuiIconButton",slot:"Root",overridesResolver:(o,d)=>{const{ownerState:h}=o;return[d.root,h.loading&&d.loading,h.color!=="default"&&d[`color${Nn(h.color)}`],h.edge&&d[`edge${Nn(h.edge)}`],d[`size${Nn(h.size)}`]]}})(yd(({theme:o})=>({textAlign:"center",flex:"0 0 auto",fontSize:o.typography.pxToRem(24),padding:8,borderRadius:"50%",color:(o.vars||o).palette.action.active,transition:o.transitions.create("background-color",{duration:o.transitions.duration.shortest}),variants:[{props:d=>!d.disableRipple,style:{"--IconButton-hoverBg":o.vars?`rgba(${o.vars.palette.action.activeChannel} / ${o.vars.palette.action.hoverOpacity})`:Qa(o.palette.action.active,o.palette.action.hoverOpacity),"&:hover":{backgroundColor:"var(--IconButton-hoverBg)","@media (hover: none)":{backgroundColor:"transparent"}}}},{props:{edge:"start"},style:{marginLeft:-12}},{props:{edge:"start",size:"small"},style:{marginLeft:-3}},{props:{edge:"end"},style:{marginRight:-12}},{props:{edge:"end",size:"small"},style:{marginRight:-3}}]})),yd(({theme:o})=>({variants:[{props:{color:"inherit"},style:{color:"inherit"}},...Object.entries(o.palette).filter($1()).map(([d])=>({props:{color:d},style:{color:(o.vars||o).palette[d].main}})),...Object.entries(o.palette).filter($1()).map(([d])=>({props:{color:d},style:{"--IconButton-hoverBg":o.vars?`rgba(${(o.vars||o).palette[d].mainChannel} / ${o.vars.palette.action.hoverOpacity})`:Qa((o.vars||o).palette[d].main,o.palette.action.hoverOpacity)}})),{props:{size:"small"},style:{padding:5,fontSize:o.typography.pxToRem(18)}},{props:{size:"large"},style:{padding:12,fontSize:o.typography.pxToRem(28)}}],[`&.${Dte.disabled}`]:{backgroundColor:"transparent",color:(o.vars||o).palette.action.disabled},[`&.${Dte.loading}`]:{color:"transparent"}}))),NRe=wi("span",{name:"MuiIconButton",slot:"LoadingIndicator"})(({theme:o})=>({display:"none",position:"absolute",visibility:"visible",top:"50%",left:"50%",transform:"translate(-50%, -50%)",color:(o.vars||o).palette.action.disabled,variants:[{props:{loading:!0},style:{display:"flex"}}]})),l0=q.forwardRef(function(d,h){const g=Ec({props:d,name:"MuiIconButton"}),{edge:T=!1,children:I,className:N,color:M="default",disabled:k=!1,disableFocusRipple:x=!1,size:V="medium",id:K,loading:Q=null,loadingIndicator:ie,...X}=g,Z=LZ(K),ae=ie??j.jsx(ile,{"aria-labelledby":Z,color:"inherit",size:16}),le={...g,edge:T,color:M,disabled:k,disableFocusRipple:x,loading:Q,loadingIndicator:ae,size:V},fe=ARe(le);return j.jsxs(ORe,{id:Q?Z:K,className:Ki(fe.root,N),centerRipple:!0,focusRipple:!x,disabled:k||Q,ref:h,...X,ownerState:le,children:[typeof Q=="boolean"&&j.jsx("span",{className:fe.loadingWrapper,style:{display:"contents"},children:j.jsx(NRe,{className:fe.loadingIndicator,ownerState:le,children:Q&&ae})}),I]})});var yf="top",gm="bottom",_m="right",Tf="left",kZ="auto",Q5=[yf,gm,_m,Tf],OP="start",N5="end",LRe="clippingParents",ale="viewport",Hj="popper",DRe="reference",Pte=Q5.reduce(function(o,d){return o.concat([d+"-"+OP,d+"-"+N5])},[]),sle=[].concat(Q5,[kZ]).reduce(function(o,d){return o.concat([d,d+"-"+OP,d+"-"+N5])},[]),PRe="beforeRead",MRe="read",kRe="afterRead",xRe="beforeMain",URe="main",jRe="afterMain",VRe="beforeWrite",BRe="write",FRe="afterWrite",GRe=[PRe,MRe,kRe,xRe,URe,jRe,VRe,BRe,FRe];function vE(o){return o?(o.nodeName||"").toLowerCase():null}function xh(o){if(o==null)return window;if(o.toString()!=="[object Window]"){var d=o.ownerDocument;return d&&d.defaultView||window}return o}function YA(o){var d=xh(o).Element;return o instanceof d||o instanceof Element}function pm(o){var d=xh(o).HTMLElement;return o instanceof d||o instanceof HTMLElement}function xZ(o){if(typeof ShadowRoot>"u")return!1;var d=xh(o).ShadowRoot;return o instanceof d||o instanceof ShadowRoot}function zRe(o){var d=o.state;Object.keys(d.elements).forEach(function(h){var g=d.styles[h]||{},T=d.attributes[h]||{},I=d.elements[h];!pm(I)||!vE(I)||(Object.assign(I.style,g),Object.keys(T).forEach(function(N){var M=T[N];M===!1?I.removeAttribute(N):I.setAttribute(N,M===!0?"":M)}))})}function HRe(o){var d=o.state,h={popper:{position:d.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(d.elements.popper.style,h.popper),d.styles=h,d.elements.arrow&&Object.assign(d.elements.arrow.style,h.arrow),function(){Object.keys(d.elements).forEach(function(g){var T=d.elements[g],I=d.attributes[g]||{},N=Object.keys(d.styles.hasOwnProperty(g)?d.styles[g]:h[g]),M=N.reduce(function(k,x){return k[x]="",k},{});!pm(T)||!vE(T)||(Object.assign(T.style,M),Object.keys(I).forEach(function(k){T.removeAttribute(k)}))})}}const WRe={name:"applyStyles",enabled:!0,phase:"write",fn:zRe,effect:HRe,requires:["computeStyles"]};function gE(o){return o.split("-")[0]}var jA=Math.max,hG=Math.min,NP=Math.round;function hQ(){var o=navigator.userAgentData;return o!=null&&o.brands&&Array.isArray(o.brands)?o.brands.map(function(d){return d.brand+"/"+d.version}).join(" "):navigator.userAgent}function ole(){return!/^((?!chrome|android).)*safari/i.test(hQ())}function LP(o,d,h){d===void 0&&(d=!1),h===void 0&&(h=!1);var g=o.getBoundingClientRect(),T=1,I=1;d&&pm(o)&&(T=o.offsetWidth>0&&NP(g.width)/o.offsetWidth||1,I=o.offsetHeight>0&&NP(g.height)/o.offsetHeight||1);var N=YA(o)?xh(o):window,M=N.visualViewport,k=!ole()&&h,x=(g.left+(k&&M?M.offsetLeft:0))/T,V=(g.top+(k&&M?M.offsetTop:0))/I,K=g.width/T,Q=g.height/I;return{width:K,height:Q,top:V,right:x+K,bottom:V+Q,left:x,x,y:V}}function UZ(o){var d=LP(o),h=o.offsetWidth,g=o.offsetHeight;return Math.abs(d.width-h)<=1&&(h=d.width),Math.abs(d.height-g)<=1&&(g=d.height),{x:o.offsetLeft,y:o.offsetTop,width:h,height:g}}function cle(o,d){var h=d.getRootNode&&d.getRootNode();if(o.contains(d))return!0;if(h&&xZ(h)){var g=d;do{if(g&&o.isSameNode(g))return!0;g=g.parentNode||g.host}while(g)}return!1}function vy(o){return xh(o).getComputedStyle(o)}function YRe(o){return["table","td","th"].indexOf(vE(o))>=0}function cC(o){return((YA(o)?o.ownerDocument:o.document)||window.document).documentElement}function uz(o){return vE(o)==="html"?o:o.assignedSlot||o.parentNode||(xZ(o)?o.host:null)||cC(o)}function Mte(o){return!pm(o)||vy(o).position==="fixed"?null:o.offsetParent}function KRe(o){var d=/firefox/i.test(hQ()),h=/Trident/i.test(hQ());if(h&&pm(o)){var g=vy(o);if(g.position==="fixed")return null}var T=uz(o);for(xZ(T)&&(T=T.host);pm(T)&&["html","body"].indexOf(vE(T))<0;){var I=vy(T);if(I.transform!=="none"||I.perspective!=="none"||I.contain==="paint"||["transform","perspective"].indexOf(I.willChange)!==-1||d&&I.willChange==="filter"||d&&I.filter&&I.filter!=="none")return T;T=T.parentNode}return null}function Z5(o){for(var d=xh(o),h=Mte(o);h&&YRe(h)&&vy(h).position==="static";)h=Mte(h);return h&&(vE(h)==="html"||vE(h)==="body"&&vy(h).position==="static")?d:h||KRe(o)||d}function jZ(o){return["top","bottom"].indexOf(o)>=0?"x":"y"}function c5(o,d,h){return jA(o,hG(d,h))}function qRe(o,d,h){var g=c5(o,d,h);return g>h?h:g}function lle(){return{top:0,right:0,bottom:0,left:0}}function dle(o){return Object.assign({},lle(),o)}function ule(o,d){return d.reduce(function(h,g){return h[g]=o,h},{})}var JRe=function(d,h){return d=typeof d=="function"?d(Object.assign({},h.rects,{placement:h.placement})):d,dle(typeof d!="number"?d:ule(d,Q5))};function XRe(o){var d,h=o.state,g=o.name,T=o.options,I=h.elements.arrow,N=h.modifiersData.popperOffsets,M=gE(h.placement),k=jZ(M),x=[Tf,_m].indexOf(M)>=0,V=x?"height":"width";if(!(!I||!N)){var K=JRe(T.padding,h),Q=UZ(I),ie=k==="y"?yf:Tf,X=k==="y"?gm:_m,Z=h.rects.reference[V]+h.rects.reference[k]-N[k]-h.rects.popper[V],ae=N[k]-h.rects.reference[k],le=Z5(I),fe=le?k==="y"?le.clientHeight||0:le.clientWidth||0:0,ue=Z/2-ae/2,de=K[ie],te=fe-Q[V]-K[X],ye=fe/2-Q[V]/2+ue,Te=c5(de,ye,te),Le=k;h.modifiersData[g]=(d={},d[Le]=Te,d.centerOffset=Te-ye,d)}}function QRe(o){var d=o.state,h=o.options,g=h.element,T=g===void 0?"[data-popper-arrow]":g;T!=null&&(typeof T=="string"&&(T=d.elements.popper.querySelector(T),!T)||cle(d.elements.popper,T)&&(d.elements.arrow=T))}const ZRe={name:"arrow",enabled:!0,phase:"main",fn:XRe,effect:QRe,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function DP(o){return o.split("-")[1]}var $Re={top:"auto",right:"auto",bottom:"auto",left:"auto"};function eIe(o,d){var h=o.x,g=o.y,T=d.devicePixelRatio||1;return{x:NP(h*T)/T||0,y:NP(g*T)/T||0}}function kte(o){var d,h=o.popper,g=o.popperRect,T=o.placement,I=o.variation,N=o.offsets,M=o.position,k=o.gpuAcceleration,x=o.adaptive,V=o.roundOffsets,K=o.isFixed,Q=N.x,ie=Q===void 0?0:Q,X=N.y,Z=X===void 0?0:X,ae=typeof V=="function"?V({x:ie,y:Z}):{x:ie,y:Z};ie=ae.x,Z=ae.y;var le=N.hasOwnProperty("x"),fe=N.hasOwnProperty("y"),ue=Tf,de=yf,te=window;if(x){var ye=Z5(h),Te="clientHeight",Le="clientWidth";if(ye===xh(h)&&(ye=cC(h),vy(ye).position!=="static"&&M==="absolute"&&(Te="scrollHeight",Le="scrollWidth")),ye=ye,T===yf||(T===Tf||T===_m)&&I===N5){de=gm;var je=K&&ye===te&&te.visualViewport?te.visualViewport.height:ye[Te];Z-=je-g.height,Z*=k?1:-1}if(T===Tf||(T===yf||T===gm)&&I===N5){ue=_m;var he=K&&ye===te&&te.visualViewport?te.visualViewport.width:ye[Le];ie-=he-g.width,ie*=k?1:-1}}var ke=Object.assign({position:M},x&&$Re),We=V===!0?eIe({x:ie,y:Z},xh(h)):{x:ie,y:Z};if(ie=We.x,Z=We.y,k){var ze;return Object.assign({},ke,(ze={},ze[de]=fe?"0":"",ze[ue]=le?"0":"",ze.transform=(te.devicePixelRatio||1)<=1?"translate("+ie+"px, "+Z+"px)":"translate3d("+ie+"px, "+Z+"px, 0)",ze))}return Object.assign({},ke,(d={},d[de]=fe?Z+"px":"",d[ue]=le?ie+"px":"",d.transform="",d))}function tIe(o){var d=o.state,h=o.options,g=h.gpuAcceleration,T=g===void 0?!0:g,I=h.adaptive,N=I===void 0?!0:I,M=h.roundOffsets,k=M===void 0?!0:M,x={placement:gE(d.placement),variation:DP(d.placement),popper:d.elements.popper,popperRect:d.rects.popper,gpuAcceleration:T,isFixed:d.options.strategy==="fixed"};d.modifiersData.popperOffsets!=null&&(d.styles.popper=Object.assign({},d.styles.popper,kte(Object.assign({},x,{offsets:d.modifiersData.popperOffsets,position:d.options.strategy,adaptive:N,roundOffsets:k})))),d.modifiersData.arrow!=null&&(d.styles.arrow=Object.assign({},d.styles.arrow,kte(Object.assign({},x,{offsets:d.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:k})))),d.attributes.popper=Object.assign({},d.attributes.popper,{"data-popper-placement":d.placement})}const nIe={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:tIe,data:{}};var v7={passive:!0};function rIe(o){var d=o.state,h=o.instance,g=o.options,T=g.scroll,I=T===void 0?!0:T,N=g.resize,M=N===void 0?!0:N,k=xh(d.elements.popper),x=[].concat(d.scrollParents.reference,d.scrollParents.popper);return I&&x.forEach(function(V){V.addEventListener("scroll",h.update,v7)}),M&&k.addEventListener("resize",h.update,v7),function(){I&&x.forEach(function(V){V.removeEventListener("scroll",h.update,v7)}),M&&k.removeEventListener("resize",h.update,v7)}}const iIe={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:rIe,data:{}};var aIe={left:"right",right:"left",bottom:"top",top:"bottom"};function z7(o){return o.replace(/left|right|bottom|top/g,function(d){return aIe[d]})}var sIe={start:"end",end:"start"};function xte(o){return o.replace(/start|end/g,function(d){return sIe[d]})}function VZ(o){var d=xh(o),h=d.pageXOffset,g=d.pageYOffset;return{scrollLeft:h,scrollTop:g}}function BZ(o){return LP(cC(o)).left+VZ(o).scrollLeft}function oIe(o,d){var h=xh(o),g=cC(o),T=h.visualViewport,I=g.clientWidth,N=g.clientHeight,M=0,k=0;if(T){I=T.width,N=T.height;var x=ole();(x||!x&&d==="fixed")&&(M=T.offsetLeft,k=T.offsetTop)}return{width:I,height:N,x:M+BZ(o),y:k}}function cIe(o){var d,h=cC(o),g=VZ(o),T=(d=o.ownerDocument)==null?void 0:d.body,I=jA(h.scrollWidth,h.clientWidth,T?T.scrollWidth:0,T?T.clientWidth:0),N=jA(h.scrollHeight,h.clientHeight,T?T.scrollHeight:0,T?T.clientHeight:0),M=-g.scrollLeft+BZ(o),k=-g.scrollTop;return vy(T||h).direction==="rtl"&&(M+=jA(h.clientWidth,T?T.clientWidth:0)-I),{width:I,height:N,x:M,y:k}}function FZ(o){var d=vy(o),h=d.overflow,g=d.overflowX,T=d.overflowY;return/auto|scroll|overlay|hidden/.test(h+T+g)}function fle(o){return["html","body","#document"].indexOf(vE(o))>=0?o.ownerDocument.body:pm(o)&&FZ(o)?o:fle(uz(o))}function l5(o,d){var h;d===void 0&&(d=[]);var g=fle(o),T=g===((h=o.ownerDocument)==null?void 0:h.body),I=xh(g),N=T?[I].concat(I.visualViewport||[],FZ(g)?g:[]):g,M=d.concat(N);return T?M:M.concat(l5(uz(N)))}function pQ(o){return Object.assign({},o,{left:o.x,top:o.y,right:o.x+o.width,bottom:o.y+o.height})}function lIe(o,d){var h=LP(o,!1,d==="fixed");return h.top=h.top+o.clientTop,h.left=h.left+o.clientLeft,h.bottom=h.top+o.clientHeight,h.right=h.left+o.clientWidth,h.width=o.clientWidth,h.height=o.clientHeight,h.x=h.left,h.y=h.top,h}function Ute(o,d,h){return d===ale?pQ(oIe(o,h)):YA(d)?lIe(d,h):pQ(cIe(cC(o)))}function dIe(o){var d=l5(uz(o)),h=["absolute","fixed"].indexOf(vy(o).position)>=0,g=h&&pm(o)?Z5(o):o;return YA(g)?d.filter(function(T){return YA(T)&&cle(T,g)&&vE(T)!=="body"}):[]}function uIe(o,d,h,g){var T=d==="clippingParents"?dIe(o):[].concat(d),I=[].concat(T,[h]),N=I[0],M=I.reduce(function(k,x){var V=Ute(o,x,g);return k.top=jA(V.top,k.top),k.right=hG(V.right,k.right),k.bottom=hG(V.bottom,k.bottom),k.left=jA(V.left,k.left),k},Ute(o,N,g));return M.width=M.right-M.left,M.height=M.bottom-M.top,M.x=M.left,M.y=M.top,M}function hle(o){var d=o.reference,h=o.element,g=o.placement,T=g?gE(g):null,I=g?DP(g):null,N=d.x+d.width/2-h.width/2,M=d.y+d.height/2-h.height/2,k;switch(T){case yf:k={x:N,y:d.y-h.height};break;case gm:k={x:N,y:d.y+d.height};break;case _m:k={x:d.x+d.width,y:M};break;case Tf:k={x:d.x-h.width,y:M};break;default:k={x:d.x,y:d.y}}var x=T?jZ(T):null;if(x!=null){var V=x==="y"?"height":"width";switch(I){case OP:k[x]=k[x]-(d[V]/2-h[V]/2);break;case N5:k[x]=k[x]+(d[V]/2-h[V]/2);break}}return k}function L5(o,d){d===void 0&&(d={});var h=d,g=h.placement,T=g===void 0?o.placement:g,I=h.strategy,N=I===void 0?o.strategy:I,M=h.boundary,k=M===void 0?LRe:M,x=h.rootBoundary,V=x===void 0?ale:x,K=h.elementContext,Q=K===void 0?Hj:K,ie=h.altBoundary,X=ie===void 0?!1:ie,Z=h.padding,ae=Z===void 0?0:Z,le=dle(typeof ae!="number"?ae:ule(ae,Q5)),fe=Q===Hj?DRe:Hj,ue=o.rects.popper,de=o.elements[X?fe:Q],te=uIe(YA(de)?de:de.contextElement||cC(o.elements.popper),k,V,N),ye=LP(o.elements.reference),Te=hle({reference:ye,element:ue,placement:T}),Le=pQ(Object.assign({},ue,Te)),je=Q===Hj?Le:ye,he={top:te.top-je.top+le.top,bottom:je.bottom-te.bottom+le.bottom,left:te.left-je.left+le.left,right:je.right-te.right+le.right},ke=o.modifiersData.offset;if(Q===Hj&&ke){var We=ke[T];Object.keys(he).forEach(function(ze){var $e=[_m,gm].indexOf(ze)>=0?1:-1,et=[yf,gm].indexOf(ze)>=0?"y":"x";he[ze]+=We[et]*$e})}return he}function fIe(o,d){d===void 0&&(d={});var h=d,g=h.placement,T=h.boundary,I=h.rootBoundary,N=h.padding,M=h.flipVariations,k=h.allowedAutoPlacements,x=k===void 0?sle:k,V=DP(g),K=V?M?Pte:Pte.filter(function(X){return DP(X)===V}):Q5,Q=K.filter(function(X){return x.indexOf(X)>=0});Q.length===0&&(Q=K);var ie=Q.reduce(function(X,Z){return X[Z]=L5(o,{placement:Z,boundary:T,rootBoundary:I,padding:N})[gE(Z)],X},{});return Object.keys(ie).sort(function(X,Z){return ie[X]-ie[Z]})}function hIe(o){if(gE(o)===kZ)return[];var d=z7(o);return[xte(o),d,xte(d)]}function pIe(o){var d=o.state,h=o.options,g=o.name;if(!d.modifiersData[g]._skip){for(var T=h.mainAxis,I=T===void 0?!0:T,N=h.altAxis,M=N===void 0?!0:N,k=h.fallbackPlacements,x=h.padding,V=h.boundary,K=h.rootBoundary,Q=h.altBoundary,ie=h.flipVariations,X=ie===void 0?!0:ie,Z=h.allowedAutoPlacements,ae=d.options.placement,le=gE(ae),fe=le===ae,ue=k||(fe||!X?[z7(ae)]:hIe(ae)),de=[ae].concat(ue).reduce(function(Pt,_n){return Pt.concat(gE(_n)===kZ?fIe(d,{placement:_n,boundary:V,rootBoundary:K,padding:x,flipVariations:X,allowedAutoPlacements:Z}):_n)},[]),te=d.rects.reference,ye=d.rects.popper,Te=new Map,Le=!0,je=de[0],he=0;he<de.length;he++){var ke=de[he],We=gE(ke),ze=DP(ke)===OP,$e=[yf,gm].indexOf(We)>=0,et=$e?"width":"height",Oe=L5(d,{placement:ke,boundary:V,rootBoundary:K,altBoundary:Q,padding:x}),qe=$e?ze?_m:Tf:ze?gm:yf;te[et]>ye[et]&&(qe=z7(qe));var lt=z7(qe),Ge=[];if(I&&Ge.push(Oe[We]<=0),M&&Ge.push(Oe[qe]<=0,Oe[lt]<=0),Ge.every(function(Pt){return Pt})){je=ke,Le=!1;break}Te.set(ke,Ge)}if(Le)for(var Ae=X?3:1,rt=function(_n){var Gt=de.find(function(zt){var rn=Te.get(zt);if(rn)return rn.slice(0,_n).every(function(ir){return ir})});if(Gt)return je=Gt,"break"},yt=Ae;yt>0;yt--){var Lt=rt(yt);if(Lt==="break")break}d.placement!==je&&(d.modifiersData[g]._skip=!0,d.placement=je,d.reset=!0)}}const mIe={name:"flip",enabled:!0,phase:"main",fn:pIe,requiresIfExists:["offset"],data:{_skip:!1}};function jte(o,d,h){return h===void 0&&(h={x:0,y:0}),{top:o.top-d.height-h.y,right:o.right-d.width+h.x,bottom:o.bottom-d.height+h.y,left:o.left-d.width-h.x}}function Vte(o){return[yf,_m,gm,Tf].some(function(d){return o[d]>=0})}function gIe(o){var d=o.state,h=o.name,g=d.rects.reference,T=d.rects.popper,I=d.modifiersData.preventOverflow,N=L5(d,{elementContext:"reference"}),M=L5(d,{altBoundary:!0}),k=jte(N,g),x=jte(M,T,I),V=Vte(k),K=Vte(x);d.modifiersData[h]={referenceClippingOffsets:k,popperEscapeOffsets:x,isReferenceHidden:V,hasPopperEscaped:K},d.attributes.popper=Object.assign({},d.attributes.popper,{"data-popper-reference-hidden":V,"data-popper-escaped":K})}const _Ie={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:gIe};function EIe(o,d,h){var g=gE(o),T=[Tf,yf].indexOf(g)>=0?-1:1,I=typeof h=="function"?h(Object.assign({},d,{placement:o})):h,N=I[0],M=I[1];return N=N||0,M=(M||0)*T,[Tf,_m].indexOf(g)>=0?{x:M,y:N}:{x:N,y:M}}function vIe(o){var d=o.state,h=o.options,g=o.name,T=h.offset,I=T===void 0?[0,0]:T,N=sle.reduce(function(V,K){return V[K]=EIe(K,d.rects,I),V},{}),M=N[d.placement],k=M.x,x=M.y;d.modifiersData.popperOffsets!=null&&(d.modifiersData.popperOffsets.x+=k,d.modifiersData.popperOffsets.y+=x),d.modifiersData[g]=N}const SIe={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:vIe};function yIe(o){var d=o.state,h=o.name;d.modifiersData[h]=hle({reference:d.rects.reference,element:d.rects.popper,placement:d.placement})}const TIe={name:"popperOffsets",enabled:!0,phase:"read",fn:yIe,data:{}};function bIe(o){return o==="x"?"y":"x"}function CIe(o){var d=o.state,h=o.options,g=o.name,T=h.mainAxis,I=T===void 0?!0:T,N=h.altAxis,M=N===void 0?!1:N,k=h.boundary,x=h.rootBoundary,V=h.altBoundary,K=h.padding,Q=h.tether,ie=Q===void 0?!0:Q,X=h.tetherOffset,Z=X===void 0?0:X,ae=L5(d,{boundary:k,rootBoundary:x,padding:K,altBoundary:V}),le=gE(d.placement),fe=DP(d.placement),ue=!fe,de=jZ(le),te=bIe(de),ye=d.modifiersData.popperOffsets,Te=d.rects.reference,Le=d.rects.popper,je=typeof Z=="function"?Z(Object.assign({},d.rects,{placement:d.placement})):Z,he=typeof je=="number"?{mainAxis:je,altAxis:je}:Object.assign({mainAxis:0,altAxis:0},je),ke=d.modifiersData.offset?d.modifiersData.offset[d.placement]:null,We={x:0,y:0};if(ye){if(I){var ze,$e=de==="y"?yf:Tf,et=de==="y"?gm:_m,Oe=de==="y"?"height":"width",qe=ye[de],lt=qe+ae[$e],Ge=qe-ae[et],Ae=ie?-Le[Oe]/2:0,rt=fe===OP?Te[Oe]:Le[Oe],yt=fe===OP?-Le[Oe]:-Te[Oe],Lt=d.elements.arrow,Pt=ie&&Lt?UZ(Lt):{width:0,height:0},_n=d.modifiersData["arrow#persistent"]?d.modifiersData["arrow#persistent"].padding:lle(),Gt=_n[$e],zt=_n[et],rn=c5(0,Te[Oe],Pt[Oe]),ir=ue?Te[Oe]/2-Ae-rn-Gt-he.mainAxis:rt-rn-Gt-he.mainAxis,kt=ue?-Te[Oe]/2+Ae+rn+zt+he.mainAxis:yt+rn+zt+he.mainAxis,Ht=d.elements.arrow&&Z5(d.elements.arrow),Jt=Ht?de==="y"?Ht.clientTop||0:Ht.clientLeft||0:0,tn=(ze=ke==null?void 0:ke[de])!=null?ze:0,Yn=qe+ir-tn-Jt,oi=qe+kt-tn,Ri=c5(ie?hG(lt,Yn):lt,qe,ie?jA(Ge,oi):Ge);ye[de]=Ri,We[de]=Ri-qe}if(M){var jr,dr=de==="x"?yf:Tf,Ii=de==="x"?gm:_m,sa=ye[te],ar=te==="y"?"height":"width",Sn=sa+ae[dr],vc=sa-ae[Ii],Zi=[yf,Tf].indexOf(le)!==-1,bm=(jr=ke==null?void 0:ke[te])!=null?jr:0,jl=Zi?Sn:sa-Te[ar]-Le[ar]-bm+he.altAxis,Tr=Zi?sa+Te[ar]+Le[ar]-bm-he.altAxis:vc,ss=ie&&Zi?qRe(jl,sa,Tr):c5(ie?jl:Sn,sa,ie?Tr:vc);ye[te]=ss,We[te]=ss-sa}d.modifiersData[g]=We}}const wIe={name:"preventOverflow",enabled:!0,phase:"main",fn:CIe,requiresIfExists:["offset"]};function RIe(o){return{scrollLeft:o.scrollLeft,scrollTop:o.scrollTop}}function IIe(o){return o===xh(o)||!pm(o)?VZ(o):RIe(o)}function AIe(o){var d=o.getBoundingClientRect(),h=NP(d.width)/o.offsetWidth||1,g=NP(d.height)/o.offsetHeight||1;return h!==1||g!==1}function OIe(o,d,h){h===void 0&&(h=!1);var g=pm(d),T=pm(d)&&AIe(d),I=cC(d),N=LP(o,T,h),M={scrollLeft:0,scrollTop:0},k={x:0,y:0};return(g||!g&&!h)&&((vE(d)!=="body"||FZ(I))&&(M=IIe(d)),pm(d)?(k=LP(d,!0),k.x+=d.clientLeft,k.y+=d.clientTop):I&&(k.x=BZ(I))),{x:N.left+M.scrollLeft-k.x,y:N.top+M.scrollTop-k.y,width:N.width,height:N.height}}function NIe(o){var d=new Map,h=new Set,g=[];o.forEach(function(I){d.set(I.name,I)});function T(I){h.add(I.name);var N=[].concat(I.requires||[],I.requiresIfExists||[]);N.forEach(function(M){if(!h.has(M)){var k=d.get(M);k&&T(k)}}),g.push(I)}return o.forEach(function(I){h.has(I.name)||T(I)}),g}function LIe(o){var d=NIe(o);return GRe.reduce(function(h,g){return h.concat(d.filter(function(T){return T.phase===g}))},[])}function DIe(o){var d;return function(){return d||(d=new Promise(function(h){Promise.resolve().then(function(){d=void 0,h(o())})})),d}}function PIe(o){var d=o.reduce(function(h,g){var T=h[g.name];return h[g.name]=T?Object.assign({},T,g,{options:Object.assign({},T.options,g.options),data:Object.assign({},T.data,g.data)}):g,h},{});return Object.keys(d).map(function(h){return d[h]})}var Bte={placement:"bottom",modifiers:[],strategy:"absolute"};function Fte(){for(var o=arguments.length,d=new Array(o),h=0;h<o;h++)d[h]=arguments[h];return!d.some(function(g){return!(g&&typeof g.getBoundingClientRect=="function")})}function MIe(o){o===void 0&&(o={});var d=o,h=d.defaultModifiers,g=h===void 0?[]:h,T=d.defaultOptions,I=T===void 0?Bte:T;return function(M,k,x){x===void 0&&(x=I);var V={placement:"bottom",orderedModifiers:[],options:Object.assign({},Bte,I),modifiersData:{},elements:{reference:M,popper:k},attributes:{},styles:{}},K=[],Q=!1,ie={state:V,setOptions:function(le){var fe=typeof le=="function"?le(V.options):le;Z(),V.options=Object.assign({},I,V.options,fe),V.scrollParents={reference:YA(M)?l5(M):M.contextElement?l5(M.contextElement):[],popper:l5(k)};var ue=LIe(PIe([].concat(g,V.options.modifiers)));return V.orderedModifiers=ue.filter(function(de){return de.enabled}),X(),ie.update()},forceUpdate:function(){if(!Q){var le=V.elements,fe=le.reference,ue=le.popper;if(Fte(fe,ue)){V.rects={reference:OIe(fe,Z5(ue),V.options.strategy==="fixed"),popper:UZ(ue)},V.reset=!1,V.placement=V.options.placement,V.orderedModifiers.forEach(function(he){return V.modifiersData[he.name]=Object.assign({},he.data)});for(var de=0;de<V.orderedModifiers.length;de++){if(V.reset===!0){V.reset=!1,de=-1;continue}var te=V.orderedModifiers[de],ye=te.fn,Te=te.options,Le=Te===void 0?{}:Te,je=te.name;typeof ye=="function"&&(V=ye({state:V,options:Le,name:je,instance:ie})||V)}}}},update:DIe(function(){return new Promise(function(ae){ie.forceUpdate(),ae(V)})}),destroy:function(){Z(),Q=!0}};if(!Fte(M,k))return ie;ie.setOptions(x).then(function(ae){!Q&&x.onFirstUpdate&&x.onFirstUpdate(ae)});function X(){V.orderedModifiers.forEach(function(ae){var le=ae.name,fe=ae.options,ue=fe===void 0?{}:fe,de=ae.effect;if(typeof de=="function"){var te=de({state:V,name:le,instance:ie,options:ue}),ye=function(){};K.push(te||ye)}})}function Z(){K.forEach(function(ae){return ae()}),K=[]}return ie}}var kIe=[iIe,TIe,nIe,WRe,SIe,mIe,wIe,ZRe,_Ie],xIe=MIe({defaultModifiers:kIe});function ple(o){var K;const{elementType:d,externalSlotProps:h,ownerState:g,skipResolvingSlotProps:T=!1,...I}=o,N=T?{}:tle(h,g),{props:M,internalRef:k}=rle({...I,externalSlotProps:N}),x=Eu(k,N==null?void 0:N.ref,(K=o.additionalProps)==null?void 0:K.ref);return ele(d,{...M,ref:x},g)}function $5(o){var d;return parseInt(q.version,10)>=19?((d=o==null?void 0:o.props)==null?void 0:d.ref)||null:(o==null?void 0:o.ref)||null}function UIe(o){return typeof o=="function"?o():o}const mle=q.forwardRef(function(d,h){const{children:g,container:T,disablePortal:I=!1}=d,[N,M]=q.useState(null),k=Eu(q.isValidElement(g)?$5(g):null,h);if(HA(()=>{I||M(UIe(T)||document.body)},[T,I]),HA(()=>{if(N&&!I)return Ate(h,N),()=>{Ate(h,null)}},[h,N,I]),I){if(q.isValidElement(g)){const x={ref:k};return q.cloneElement(g,x)}return g}return N&&lae.createPortal(g,N)});function jIe(o){return _c("MuiPopper",o)}Zo("MuiPopper",["root"]);function VIe(o,d){if(d==="ltr")return o;switch(o){case"bottom-end":return"bottom-start";case"bottom-start":return"bottom-end";case"top-end":return"top-start";case"top-start":return"top-end";default:return o}}function mQ(o){return typeof o=="function"?o():o}function BIe(o){return o.nodeType!==void 0}const FIe=o=>{const{classes:d}=o;return tl({root:["root"]},jIe,d)},GIe={},zIe=q.forwardRef(function(d,h){const{anchorEl:g,children:T,direction:I,disablePortal:N,modifiers:M,open:k,placement:x,popperOptions:V,popperRef:K,slotProps:Q={},slots:ie={},TransitionProps:X,ownerState:Z,...ae}=d,le=q.useRef(null),fe=Eu(le,h),ue=q.useRef(null),de=Eu(ue,K),te=q.useRef(de);HA(()=>{te.current=de},[de]),q.useImperativeHandle(K,()=>ue.current,[]);const ye=VIe(x,I),[Te,Le]=q.useState(ye),[je,he]=q.useState(mQ(g));q.useEffect(()=>{ue.current&&ue.current.forceUpdate()}),q.useEffect(()=>{g&&he(mQ(g))},[g]),HA(()=>{if(!je||!k)return;const et=lt=>{Le(lt.placement)};let Oe=[{name:"preventOverflow",options:{altBoundary:N}},{name:"flip",options:{altBoundary:N}},{name:"onUpdate",enabled:!0,phase:"afterWrite",fn:({state:lt})=>{et(lt)}}];M!=null&&(Oe=Oe.concat(M)),V&&V.modifiers!=null&&(Oe=Oe.concat(V.modifiers));const qe=xIe(je,le.current,{placement:ye,...V,modifiers:Oe});return te.current(qe),()=>{qe.destroy(),te.current(null)}},[je,N,M,k,V,ye]);const ke={placement:Te};X!==null&&(ke.TransitionProps=X);const We=FIe(d),ze=ie.root??"div",$e=ple({elementType:ze,externalSlotProps:Q.root,externalForwardedProps:ae,additionalProps:{role:"tooltip",ref:fe},ownerState:d,className:We.root});return j.jsx(ze,{...$e,children:typeof T=="function"?T(ke):T})}),HIe=q.forwardRef(function(d,h){const{anchorEl:g,children:T,container:I,direction:N="ltr",disablePortal:M=!1,keepMounted:k=!1,modifiers:x,open:V,placement:K="bottom",popperOptions:Q=GIe,popperRef:ie,style:X,transition:Z=!1,slotProps:ae={},slots:le={},...fe}=d,[ue,de]=q.useState(!0),te=()=>{de(!1)},ye=()=>{de(!0)};if(!k&&!V&&(!Z||ue))return null;let Te;if(I)Te=I;else if(g){const he=mQ(g);Te=he&&BIe(he)?mm(he).body:mm(null).body}const Le=!V&&k&&(!Z||ue)?"none":void 0,je=Z?{in:V,onEnter:te,onExited:ye}:void 0;return j.jsx(mle,{disablePortal:M,container:Te,children:j.jsx(zIe,{anchorEl:g,direction:N,disablePortal:M,modifiers:x,ref:h,open:Z?!ue:V,placement:K,popperOptions:Q,popperRef:ie,slotProps:ae,slots:le,...fe,style:{position:"fixed",top:0,left:0,display:Le,...X},TransitionProps:je,children:T})})}),WIe=wi(HIe,{name:"MuiPopper",slot:"Root"})({}),gle=q.forwardRef(function(d,h){const g=NZ(),T=Ec({props:d,name:"MuiPopper"}),{anchorEl:I,component:N,components:M,componentsProps:k,container:x,disablePortal:V,keepMounted:K,modifiers:Q,open:ie,placement:X,popperOptions:Z,popperRef:ae,transition:le,slots:fe,slotProps:ue,...de}=T,te=(fe==null?void 0:fe.root)??(M==null?void 0:M.Root),ye={anchorEl:I,container:x,disablePortal:V,keepMounted:K,modifiers:Q,open:ie,placement:X,popperOptions:Z,popperRef:ae,transition:le,...de};return j.jsx(WIe,{as:N,direction:g?"rtl":"ltr",slots:{root:te},slotProps:ue??k,...ye,ref:h})}),YIe=ym(j.jsx("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12 17 15.59z"}));function KIe(o){return _c("MuiChip",o)}const Ci=Zo("MuiChip",["root","sizeSmall","sizeMedium","colorDefault","colorError","colorInfo","colorPrimary","colorSecondary","colorSuccess","colorWarning","disabled","clickable","clickableColorPrimary","clickableColorSecondary","deletable","deletableColorPrimary","deletableColorSecondary","outlined","filled","outlinedPrimary","outlinedSecondary","filledPrimary","filledSecondary","avatar","avatarSmall","avatarMedium","avatarColorPrimary","avatarColorSecondary","icon","iconSmall","iconMedium","iconColorPrimary","iconColorSecondary","label","labelSmall","labelMedium","deleteIcon","deleteIconSmall","deleteIconMedium","deleteIconColorPrimary","deleteIconColorSecondary","deleteIconOutlinedColorPrimary","deleteIconOutlinedColorSecondary","deleteIconFilledColorPrimary","deleteIconFilledColorSecondary","focusVisible"]),qIe=o=>{const{classes:d,disabled:h,size:g,color:T,iconColor:I,onDelete:N,clickable:M,variant:k}=o,x={root:["root",k,h&&"disabled",`size${Nn(g)}`,`color${Nn(T)}`,M&&"clickable",M&&`clickableColor${Nn(T)}`,N&&"deletable",N&&`deletableColor${Nn(T)}`,`${k}${Nn(T)}`],label:["label",`label${Nn(g)}`],avatar:["avatar",`avatar${Nn(g)}`,`avatarColor${Nn(T)}`],icon:["icon",`icon${Nn(g)}`,`iconColor${Nn(I)}`],deleteIcon:["deleteIcon",`deleteIcon${Nn(g)}`,`deleteIconColor${Nn(T)}`,`deleteIcon${Nn(k)}Color${Nn(T)}`]};return tl(x,KIe,d)},JIe=wi("div",{name:"MuiChip",slot:"Root",overridesResolver:(o,d)=>{const{ownerState:h}=o,{color:g,iconColor:T,clickable:I,onDelete:N,size:M,variant:k}=h;return[{[`& .${Ci.avatar}`]:d.avatar},{[`& .${Ci.avatar}`]:d[`avatar${Nn(M)}`]},{[`& .${Ci.avatar}`]:d[`avatarColor${Nn(g)}`]},{[`& .${Ci.icon}`]:d.icon},{[`& .${Ci.icon}`]:d[`icon${Nn(M)}`]},{[`& .${Ci.icon}`]:d[`iconColor${Nn(T)}`]},{[`& .${Ci.deleteIcon}`]:d.deleteIcon},{[`& .${Ci.deleteIcon}`]:d[`deleteIcon${Nn(M)}`]},{[`& .${Ci.deleteIcon}`]:d[`deleteIconColor${Nn(g)}`]},{[`& .${Ci.deleteIcon}`]:d[`deleteIcon${Nn(k)}Color${Nn(g)}`]},d.root,d[`size${Nn(M)}`],d[`color${Nn(g)}`],I&&d.clickable,I&&g!=="default"&&d[`clickableColor${Nn(g)})`],N&&d.deletable,N&&g!=="default"&&d[`deletableColor${Nn(g)}`],d[k],d[`${k}${Nn(g)}`]]}})(yd(({theme:o})=>{const d=o.palette.mode==="light"?o.palette.grey[700]:o.palette.grey[300];return{maxWidth:"100%",fontFamily:o.typography.fontFamily,fontSize:o.typography.pxToRem(13),display:"inline-flex",alignItems:"center",justifyContent:"center",height:32,lineHeight:1.5,color:(o.vars||o).palette.text.primary,backgroundColor:(o.vars||o).palette.action.selected,borderRadius:32/2,whiteSpace:"nowrap",transition:o.transitions.create(["background-color","box-shadow"]),cursor:"unset",outline:0,textDecoration:"none",border:0,padding:0,verticalAlign:"middle",boxSizing:"border-box",[`&.${Ci.disabled}`]:{opacity:(o.vars||o).palette.action.disabledOpacity,pointerEvents:"none"},[`& .${Ci.avatar}`]:{marginLeft:5,marginRight:-6,width:24,height:24,color:o.vars?o.vars.palette.Chip.defaultAvatarColor:d,fontSize:o.typography.pxToRem(12)},[`& .${Ci.avatarColorPrimary}`]:{color:(o.vars||o).palette.primary.contrastText,backgroundColor:(o.vars||o).palette.primary.dark},[`& .${Ci.avatarColorSecondary}`]:{color:(o.vars||o).palette.secondary.contrastText,backgroundColor:(o.vars||o).palette.secondary.dark},[`& .${Ci.avatarSmall}`]:{marginLeft:4,marginRight:-4,width:18,height:18,fontSize:o.typography.pxToRem(10)},[`& .${Ci.icon}`]:{marginLeft:5,marginRight:-6},[`& .${Ci.deleteIcon}`]:{WebkitTapHighlightColor:"transparent",color:o.vars?`rgba(${o.vars.palette.text.primaryChannel} / 0.26)`:Qa(o.palette.text.primary,.26),fontSize:22,cursor:"pointer",margin:"0 5px 0 -6px","&:hover":{color:o.vars?`rgba(${o.vars.palette.text.primaryChannel} / 0.4)`:Qa(o.palette.text.primary,.4)}},variants:[{props:{size:"small"},style:{height:24,[`& .${Ci.icon}`]:{fontSize:18,marginLeft:4,marginRight:-4},[`& .${Ci.deleteIcon}`]:{fontSize:16,marginRight:4,marginLeft:-4}}},...Object.entries(o.palette).filter($1(["contrastText"])).map(([h])=>({props:{color:h},style:{backgroundColor:(o.vars||o).palette[h].main,color:(o.vars||o).palette[h].contrastText,[`& .${Ci.deleteIcon}`]:{color:o.vars?`rgba(${o.vars.palette[h].contrastTextChannel} / 0.7)`:Qa(o.palette[h].contrastText,.7),"&:hover, &:active":{color:(o.vars||o).palette[h].contrastText}}}})),{props:h=>h.iconColor===h.color,style:{[`& .${Ci.icon}`]:{color:o.vars?o.vars.palette.Chip.defaultIconColor:d}}},{props:h=>h.iconColor===h.color&&h.color!=="default",style:{[`& .${Ci.icon}`]:{color:"inherit"}}},{props:{onDelete:!0},style:{[`&.${Ci.focusVisible}`]:{backgroundColor:o.vars?`rgba(${o.vars.palette.action.selectedChannel} / calc(${o.vars.palette.action.selectedOpacity} + ${o.vars.palette.action.focusOpacity}))`:Qa(o.palette.action.selected,o.palette.action.selectedOpacity+o.palette.action.focusOpacity)}}},...Object.entries(o.palette).filter($1(["dark"])).map(([h])=>({props:{color:h,onDelete:!0},style:{[`&.${Ci.focusVisible}`]:{background:(o.vars||o).palette[h].dark}}})),{props:{clickable:!0},style:{userSelect:"none",WebkitTapHighlightColor:"transparent",cursor:"pointer","&:hover":{backgroundColor:o.vars?`rgba(${o.vars.palette.action.selectedChannel} / calc(${o.vars.palette.action.selectedOpacity} + ${o.vars.palette.action.hoverOpacity}))`:Qa(o.palette.action.selected,o.palette.action.selectedOpacity+o.palette.action.hoverOpacity)},[`&.${Ci.focusVisible}`]:{backgroundColor:o.vars?`rgba(${o.vars.palette.action.selectedChannel} / calc(${o.vars.palette.action.selectedOpacity} + ${o.vars.palette.action.focusOpacity}))`:Qa(o.palette.action.selected,o.palette.action.selectedOpacity+o.palette.action.focusOpacity)},"&:active":{boxShadow:(o.vars||o).shadows[1]}}},...Object.entries(o.palette).filter($1(["dark"])).map(([h])=>({props:{color:h,clickable:!0},style:{[`&:hover, &.${Ci.focusVisible}`]:{backgroundColor:(o.vars||o).palette[h].dark}}})),{props:{variant:"outlined"},style:{backgroundColor:"transparent",border:o.vars?`1px solid ${o.vars.palette.Chip.defaultBorder}`:`1px solid ${o.palette.mode==="light"?o.palette.grey[400]:o.palette.grey[700]}`,[`&.${Ci.clickable}:hover`]:{backgroundColor:(o.vars||o).palette.action.hover},[`&.${Ci.focusVisible}`]:{backgroundColor:(o.vars||o).palette.action.focus},[`& .${Ci.avatar}`]:{marginLeft:4},[`& .${Ci.avatarSmall}`]:{marginLeft:2},[`& .${Ci.icon}`]:{marginLeft:4},[`& .${Ci.iconSmall}`]:{marginLeft:2},[`& .${Ci.deleteIcon}`]:{marginRight:5},[`& .${Ci.deleteIconSmall}`]:{marginRight:3}}},...Object.entries(o.palette).filter($1()).map(([h])=>({props:{variant:"outlined",color:h},style:{color:(o.vars||o).palette[h].main,border:`1px solid ${o.vars?`rgba(${o.vars.palette[h].mainChannel} / 0.7)`:Qa(o.palette[h].main,.7)}`,[`&.${Ci.clickable}:hover`]:{backgroundColor:o.vars?`rgba(${o.vars.palette[h].mainChannel} / ${o.vars.palette.action.hoverOpacity})`:Qa(o.palette[h].main,o.palette.action.hoverOpacity)},[`&.${Ci.focusVisible}`]:{backgroundColor:o.vars?`rgba(${o.vars.palette[h].mainChannel} / ${o.vars.palette.action.focusOpacity})`:Qa(o.palette[h].main,o.palette.action.focusOpacity)},[`& .${Ci.deleteIcon}`]:{color:o.vars?`rgba(${o.vars.palette[h].mainChannel} / 0.7)`:Qa(o.palette[h].main,.7),"&:hover, &:active":{color:(o.vars||o).palette[h].main}}}}))]}})),XIe=wi("span",{name:"MuiChip",slot:"Label",overridesResolver:(o,d)=>{const{ownerState:h}=o,{size:g}=h;return[d.label,d[`label${Nn(g)}`]]}})({overflow:"hidden",textOverflow:"ellipsis",paddingLeft:12,paddingRight:12,whiteSpace:"nowrap",variants:[{props:{variant:"outlined"},style:{paddingLeft:11,paddingRight:11}},{props:{size:"small"},style:{paddingLeft:8,paddingRight:8}},{props:{size:"small",variant:"outlined"},style:{paddingLeft:7,paddingRight:7}}]});function Gte(o){return o.key==="Backspace"||o.key==="Delete"}const aq=q.forwardRef(function(d,h){const g=Ec({props:d,name:"MuiChip"}),{avatar:T,className:I,clickable:N,color:M="default",component:k,deleteIcon:x,disabled:V=!1,icon:K,label:Q,onClick:ie,onDelete:X,onKeyDown:Z,onKeyUp:ae,size:le="medium",variant:fe="filled",tabIndex:ue,skipFocusWhenDisabled:de=!1,slots:te={},slotProps:ye={},...Te}=g,Le=q.useRef(null),je=Eu(Le,h),he=Gt=>{Gt.stopPropagation(),X&&X(Gt)},ke=Gt=>{Gt.currentTarget===Gt.target&&Gte(Gt)&&Gt.preventDefault(),Z&&Z(Gt)},We=Gt=>{Gt.currentTarget===Gt.target&&X&&Gte(Gt)&&X(Gt),ae&&ae(Gt)},ze=N!==!1&&ie?!0:N,$e=ze||X?O5:k||"div",et={...g,component:$e,disabled:V,size:le,color:M,iconColor:q.isValidElement(K)&&K.props.color||M,onDelete:!!X,clickable:ze,variant:fe},Oe=qIe(et),qe=$e===O5?{component:k||"div",focusVisibleClassName:Oe.focusVisible,...X&&{disableRipple:!0}}:{};let lt=null;X&&(lt=x&&q.isValidElement(x)?q.cloneElement(x,{className:Ki(x.props.className,Oe.deleteIcon),onClick:he}):j.jsx(YIe,{className:Oe.deleteIcon,onClick:he}));let Ge=null;T&&q.isValidElement(T)&&(Ge=q.cloneElement(T,{className:Ki(Oe.avatar,T.props.className)}));let Ae=null;K&&q.isValidElement(K)&&(Ae=q.cloneElement(K,{className:Ki(Oe.icon,K.props.className)}));const rt={slots:te,slotProps:ye},[yt,Lt]=el("root",{elementType:JIe,externalForwardedProps:{...rt,...Te},ownerState:et,shouldForwardComponentProp:!0,ref:je,className:Ki(Oe.root,I),additionalProps:{disabled:ze&&V?!0:void 0,tabIndex:de&&V?-1:ue,...qe},getSlotProps:Gt=>({...Gt,onClick:zt=>{var rn;(rn=Gt.onClick)==null||rn.call(Gt,zt),ie==null||ie(zt)},onKeyDown:zt=>{var rn;(rn=Gt.onKeyDown)==null||rn.call(Gt,zt),ke==null||ke(zt)},onKeyUp:zt=>{var rn;(rn=Gt.onKeyUp)==null||rn.call(Gt,zt),We==null||We(zt)}})}),[Pt,_n]=el("label",{elementType:XIe,externalForwardedProps:rt,ownerState:et,className:Oe.label});return j.jsxs(yt,{as:$e,...Lt,children:[Ge||Ae,j.jsx(Pt,{..._n,children:Q}),lt]})});function QIe(o){return typeof o=="string"}const ZIe=ym(j.jsx("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"}));function $Ie(o){return _c("MuiAvatar",o)}Zo("MuiAvatar",["root","colorDefault","circular","rounded","square","img","fallback"]);const eAe=o=>{const{classes:d,variant:h,colorDefault:g}=o;return tl({root:["root",h,g&&"colorDefault"],img:["img"],fallback:["fallback"]},$Ie,d)},tAe=wi("div",{name:"MuiAvatar",slot:"Root",overridesResolver:(o,d)=>{const{ownerState:h}=o;return[d.root,d[h.variant],h.colorDefault&&d.colorDefault]}})(yd(({theme:o})=>({position:"relative",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,width:40,height:40,fontFamily:o.typography.fontFamily,fontSize:o.typography.pxToRem(20),lineHeight:1,borderRadius:"50%",overflow:"hidden",userSelect:"none",variants:[{props:{variant:"rounded"},style:{borderRadius:(o.vars||o).shape.borderRadius}},{props:{variant:"square"},style:{borderRadius:0}},{props:{colorDefault:!0},style:{color:(o.vars||o).palette.background.default,...o.vars?{backgroundColor:o.vars.palette.Avatar.defaultBg}:{backgroundColor:o.palette.grey[400],...o.applyStyles("dark",{backgroundColor:o.palette.grey[600]})}}}]}))),nAe=wi("img",{name:"MuiAvatar",slot:"Img"})({width:"100%",height:"100%",textAlign:"center",objectFit:"cover",color:"transparent",textIndent:1e4}),rAe=wi(ZIe,{name:"MuiAvatar",slot:"Fallback"})({width:"75%",height:"75%"});function iAe({crossOrigin:o,referrerPolicy:d,src:h,srcSet:g}){const[T,I]=q.useState(!1);return q.useEffect(()=>{if(!h&&!g)return;I(!1);let N=!0;const M=new Image;return M.onload=()=>{N&&I("loaded")},M.onerror=()=>{N&&I("error")},M.crossOrigin=o,M.referrerPolicy=d,M.src=h,g&&(M.srcset=g),()=>{N=!1}},[o,d,h,g]),T}const sq=q.forwardRef(function(d,h){const g=Ec({props:d,name:"MuiAvatar"}),{alt:T,children:I,className:N,component:M="div",slots:k={},slotProps:x={},imgProps:V,sizes:K,src:Q,srcSet:ie,variant:X="circular",...Z}=g;let ae=null;const le={...g,component:M,variant:X},fe=iAe({...V,...typeof x.img=="function"?x.img(le):x.img,src:Q,srcSet:ie}),ue=Q||ie,de=ue&&fe!=="error";le.colorDefault=!de,delete le.ownerState;const te=eAe(le),[ye,Te]=el("root",{ref:h,className:Ki(te.root,N),elementType:tAe,externalForwardedProps:{slots:k,slotProps:x,component:M,...Z},ownerState:le}),[Le,je]=el("img",{className:te.img,elementType:nAe,externalForwardedProps:{slots:k,slotProps:{img:{...V,...x.img}}},additionalProps:{alt:T,src:Q,srcSet:ie,sizes:K},ownerState:le}),[he,ke]=el("fallback",{className:te.fallback,elementType:rAe,externalForwardedProps:{slots:k,slotProps:x},shouldForwardComponentProp:!0,ownerState:le});return de?ae=j.jsx(Le,{...je}):I||I===0?ae=I:ue&&T?ae=T[0]:ae=j.jsx(he,{...ke}),j.jsx(ye,{...Te,children:ae})}),aAe={entering:{opacity:1},entered:{opacity:1}},sAe=q.forwardRef(function(d,h){const g=cz(),T={enter:g.transitions.duration.enteringScreen,exit:g.transitions.duration.leavingScreen},{addEndListener:I,appear:N=!0,children:M,easing:k,in:x,onEnter:V,onEntered:K,onEntering:Q,onExit:ie,onExited:X,onExiting:Z,style:ae,timeout:le=T,TransitionComponent:fe=TE,...ue}=d,de=q.useRef(null),te=Eu(de,$5(M),h),ye=$e=>et=>{if($e){const Oe=de.current;et===void 0?$e(Oe):$e(Oe,et)}},Te=ye(Q),Le=ye(($e,et)=>{$ce($e);const Oe=dG({style:ae,timeout:le,easing:k},{mode:"enter"});$e.style.webkitTransition=g.transitions.create("opacity",Oe),$e.style.transition=g.transitions.create("opacity",Oe),V&&V($e,et)}),je=ye(K),he=ye(Z),ke=ye($e=>{const et=dG({style:ae,timeout:le,easing:k},{mode:"exit"});$e.style.webkitTransition=g.transitions.create("opacity",et),$e.style.transition=g.transitions.create("opacity",et),ie&&ie($e)}),We=ye(X),ze=$e=>{I&&I(de.current,$e)};return j.jsx(fe,{appear:N,in:x,nodeRef:de,onEnter:Le,onEntered:je,onEntering:Te,onExit:ke,onExited:We,onExiting:he,addEndListener:ze,timeout:le,...ue,children:($e,{ownerState:et,...Oe})=>q.cloneElement(M,{style:{opacity:0,visibility:$e==="exited"&&!x?"hidden":void 0,...aAe[$e],...ae,...M.props.style},ref:te,...Oe})})});function oAe(o){return _c("MuiBackdrop",o)}Zo("MuiBackdrop",["root","invisible"]);const cAe=o=>{const{classes:d,invisible:h}=o;return tl({root:["root",h&&"invisible"]},oAe,d)},lAe=wi("div",{name:"MuiBackdrop",slot:"Root",overridesResolver:(o,d)=>{const{ownerState:h}=o;return[d.root,h.invisible&&d.invisible]}})({position:"fixed",display:"flex",alignItems:"center",justifyContent:"center",right:0,bottom:0,top:0,left:0,backgroundColor:"rgba(0, 0, 0, 0.5)",WebkitTapHighlightColor:"transparent",variants:[{props:{invisible:!0},style:{backgroundColor:"transparent"}}]}),dAe=q.forwardRef(function(d,h){const g=Ec({props:d,name:"MuiBackdrop"}),{children:T,className:I,component:N="div",invisible:M=!1,open:k,components:x={},componentsProps:V={},slotProps:K={},slots:Q={},TransitionComponent:ie,transitionDuration:X,...Z}=g,ae={...g,component:N,invisible:M},le=cAe(ae),fe={transition:ie,root:x.Root,...Q},ue={...V,...K},de={component:N,slots:fe,slotProps:ue},[te,ye]=el("root",{elementType:lAe,externalForwardedProps:de,className:Ki(le.root,I),ownerState:ae}),[Te,Le]=el("transition",{elementType:sAe,externalForwardedProps:de,ownerState:ae});return j.jsx(Te,{in:k,timeout:X,...Z,...Le,children:j.jsx(te,{"aria-hidden":!0,...ye,classes:le,ref:h,children:T})})});function uAe(o){return _c("MuiButton",o)}const bA=Zo("MuiButton",["root","text","textInherit","textPrimary","textSecondary","textSuccess","textError","textInfo","textWarning","outlined","outlinedInherit","outlinedPrimary","outlinedSecondary","outlinedSuccess","outlinedError","outlinedInfo","outlinedWarning","contained","containedInherit","containedPrimary","containedSecondary","containedSuccess","containedError","containedInfo","containedWarning","disableElevation","focusVisible","disabled","colorInherit","colorPrimary","colorSecondary","colorSuccess","colorError","colorInfo","colorWarning","textSizeSmall","textSizeMedium","textSizeLarge","outlinedSizeSmall","outlinedSizeMedium","outlinedSizeLarge","containedSizeSmall","containedSizeMedium","containedSizeLarge","sizeMedium","sizeSmall","sizeLarge","fullWidth","startIcon","endIcon","icon","iconSizeSmall","iconSizeMedium","iconSizeLarge","loading","loadingWrapper","loadingIconPlaceholder","loadingIndicator","loadingPositionCenter","loadingPositionStart","loadingPositionEnd"]),fAe=q.createContext({}),hAe=q.createContext(void 0),pAe=o=>{const{color:d,disableElevation:h,fullWidth:g,size:T,variant:I,loading:N,loadingPosition:M,classes:k}=o,x={root:["root",N&&"loading",I,`${I}${Nn(d)}`,`size${Nn(T)}`,`${I}Size${Nn(T)}`,`color${Nn(d)}`,h&&"disableElevation",g&&"fullWidth",N&&`loadingPosition${Nn(M)}`],startIcon:["icon","startIcon",`iconSize${Nn(T)}`],endIcon:["icon","endIcon",`iconSize${Nn(T)}`],loadingIndicator:["loadingIndicator"],loadingWrapper:["loadingWrapper"]},V=tl(x,uAe,k);return{...k,...V}},_le=[{props:{size:"small"},style:{"& > *:nth-of-type(1)":{fontSize:18}}},{props:{size:"medium"},style:{"& > *:nth-of-type(1)":{fontSize:20}}},{props:{size:"large"},style:{"& > *:nth-of-type(1)":{fontSize:22}}}],mAe=wi(O5,{shouldForwardProp:o=>lz(o)||o==="classes",name:"MuiButton",slot:"Root",overridesResolver:(o,d)=>{const{ownerState:h}=o;return[d.root,d[h.variant],d[`${h.variant}${Nn(h.color)}`],d[`size${Nn(h.size)}`],d[`${h.variant}Size${Nn(h.size)}`],h.color==="inherit"&&d.colorInherit,h.disableElevation&&d.disableElevation,h.fullWidth&&d.fullWidth,h.loading&&d.loading]}})(yd(({theme:o})=>{const d=o.palette.mode==="light"?o.palette.grey[300]:o.palette.grey[800],h=o.palette.mode==="light"?o.palette.grey.A100:o.palette.grey[700];return{...o.typography.button,minWidth:64,padding:"6px 16px",border:0,borderRadius:(o.vars||o).shape.borderRadius,transition:o.transitions.create(["background-color","box-shadow","border-color","color"],{duration:o.transitions.duration.short}),"&:hover":{textDecoration:"none"},[`&.${bA.disabled}`]:{color:(o.vars||o).palette.action.disabled},variants:[{props:{variant:"contained"},style:{color:"var(--variant-containedColor)",backgroundColor:"var(--variant-containedBg)",boxShadow:(o.vars||o).shadows[2],"&:hover":{boxShadow:(o.vars||o).shadows[4],"@media (hover: none)":{boxShadow:(o.vars||o).shadows[2]}},"&:active":{boxShadow:(o.vars||o).shadows[8]},[`&.${bA.focusVisible}`]:{boxShadow:(o.vars||o).shadows[6]},[`&.${bA.disabled}`]:{color:(o.vars||o).palette.action.disabled,boxShadow:(o.vars||o).shadows[0],backgroundColor:(o.vars||o).palette.action.disabledBackground}}},{props:{variant:"outlined"},style:{padding:"5px 15px",border:"1px solid currentColor",borderColor:"var(--variant-outlinedBorder, currentColor)",backgroundColor:"var(--variant-outlinedBg)",color:"var(--variant-outlinedColor)",[`&.${bA.disabled}`]:{border:`1px solid ${(o.vars||o).palette.action.disabledBackground}`}}},{props:{variant:"text"},style:{padding:"6px 8px",color:"var(--variant-textColor)",backgroundColor:"var(--variant-textBg)"}},...Object.entries(o.palette).filter($1()).map(([g])=>({props:{color:g},style:{"--variant-textColor":(o.vars||o).palette[g].main,"--variant-outlinedColor":(o.vars||o).palette[g].main,"--variant-outlinedBorder":o.vars?`rgba(${o.vars.palette[g].mainChannel} / 0.5)`:Qa(o.palette[g].main,.5),"--variant-containedColor":(o.vars||o).palette[g].contrastText,"--variant-containedBg":(o.vars||o).palette[g].main,"@media (hover: hover)":{"&:hover":{"--variant-containedBg":(o.vars||o).palette[g].dark,"--variant-textBg":o.vars?`rgba(${o.vars.palette[g].mainChannel} / ${o.vars.palette.action.hoverOpacity})`:Qa(o.palette[g].main,o.palette.action.hoverOpacity),"--variant-outlinedBorder":(o.vars||o).palette[g].main,"--variant-outlinedBg":o.vars?`rgba(${o.vars.palette[g].mainChannel} / ${o.vars.palette.action.hoverOpacity})`:Qa(o.palette[g].main,o.palette.action.hoverOpacity)}}}})),{props:{color:"inherit"},style:{color:"inherit",borderColor:"currentColor","--variant-containedBg":o.vars?o.vars.palette.Button.inheritContainedBg:d,"@media (hover: hover)":{"&:hover":{"--variant-containedBg":o.vars?o.vars.palette.Button.inheritContainedHoverBg:h,"--variant-textBg":o.vars?`rgba(${o.vars.palette.text.primaryChannel} / ${o.vars.palette.action.hoverOpacity})`:Qa(o.palette.text.primary,o.palette.action.hoverOpacity),"--variant-outlinedBg":o.vars?`rgba(${o.vars.palette.text.primaryChannel} / ${o.vars.palette.action.hoverOpacity})`:Qa(o.palette.text.primary,o.palette.action.hoverOpacity)}}}},{props:{size:"small",variant:"text"},style:{padding:"4px 5px",fontSize:o.typography.pxToRem(13)}},{props:{size:"large",variant:"text"},style:{padding:"8px 11px",fontSize:o.typography.pxToRem(15)}},{props:{size:"small",variant:"outlined"},style:{padding:"3px 9px",fontSize:o.typography.pxToRem(13)}},{props:{size:"large",variant:"outlined"},style:{padding:"7px 21px",fontSize:o.typography.pxToRem(15)}},{props:{size:"small",variant:"contained"},style:{padding:"4px 10px",fontSize:o.typography.pxToRem(13)}},{props:{size:"large",variant:"contained"},style:{padding:"8px 22px",fontSize:o.typography.pxToRem(15)}},{props:{disableElevation:!0},style:{boxShadow:"none","&:hover":{boxShadow:"none"},[`&.${bA.focusVisible}`]:{boxShadow:"none"},"&:active":{boxShadow:"none"},[`&.${bA.disabled}`]:{boxShadow:"none"}}},{props:{fullWidth:!0},style:{width:"100%"}},{props:{loadingPosition:"center"},style:{transition:o.transitions.create(["background-color","box-shadow","border-color"],{duration:o.transitions.duration.short}),[`&.${bA.loading}`]:{color:"transparent"}}}]}})),gAe=wi("span",{name:"MuiButton",slot:"StartIcon",overridesResolver:(o,d)=>{const{ownerState:h}=o;return[d.startIcon,h.loading&&d.startIconLoadingStart,d[`iconSize${Nn(h.size)}`]]}})(({theme:o})=>({display:"inherit",marginRight:8,marginLeft:-4,variants:[{props:{size:"small"},style:{marginLeft:-2}},{props:{loadingPosition:"start",loading:!0},style:{transition:o.transitions.create(["opacity"],{duration:o.transitions.duration.short}),opacity:0}},{props:{loadingPosition:"start",loading:!0,fullWidth:!0},style:{marginRight:-8}},..._le]})),_Ae=wi("span",{name:"MuiButton",slot:"EndIcon",overridesResolver:(o,d)=>{const{ownerState:h}=o;return[d.endIcon,h.loading&&d.endIconLoadingEnd,d[`iconSize${Nn(h.size)}`]]}})(({theme:o})=>({display:"inherit",marginRight:-4,marginLeft:8,variants:[{props:{size:"small"},style:{marginRight:-2}},{props:{loadingPosition:"end",loading:!0},style:{transition:o.transitions.create(["opacity"],{duration:o.transitions.duration.short}),opacity:0}},{props:{loadingPosition:"end",loading:!0,fullWidth:!0},style:{marginLeft:-8}},..._le]})),EAe=wi("span",{name:"MuiButton",slot:"LoadingIndicator"})(({theme:o})=>({display:"none",position:"absolute",visibility:"visible",variants:[{props:{loading:!0},style:{display:"flex"}},{props:{loadingPosition:"start"},style:{left:14}},{props:{loadingPosition:"start",size:"small"},style:{left:10}},{props:{variant:"text",loadingPosition:"start"},style:{left:6}},{props:{loadingPosition:"center"},style:{left:"50%",transform:"translate(-50%)",color:(o.vars||o).palette.action.disabled}},{props:{loadingPosition:"end"},style:{right:14}},{props:{loadingPosition:"end",size:"small"},style:{right:10}},{props:{variant:"text",loadingPosition:"end"},style:{right:6}},{props:{loadingPosition:"start",fullWidth:!0},style:{position:"relative",left:-10}},{props:{loadingPosition:"end",fullWidth:!0},style:{position:"relative",right:-10}}]})),zte=wi("span",{name:"MuiButton",slot:"LoadingIconPlaceholder"})({display:"inline-block",width:"1em",height:"1em"}),vAe=q.forwardRef(function(d,h){const g=q.useContext(fAe),T=q.useContext(hAe),I=A5(g,d),N=Ec({props:I,name:"MuiButton"}),{children:M,color:k="primary",component:x="button",className:V,disabled:K=!1,disableElevation:Q=!1,disableFocusRipple:ie=!1,endIcon:X,focusVisibleClassName:Z,fullWidth:ae=!1,id:le,loading:fe=null,loadingIndicator:ue,loadingPosition:de="center",size:te="medium",startIcon:ye,type:Te,variant:Le="text",...je}=N,he=LZ(le),ke=ue??j.jsx(ile,{"aria-labelledby":he,color:"inherit",size:16}),We={...N,color:k,component:x,disabled:K,disableElevation:Q,disableFocusRipple:ie,fullWidth:ae,loading:fe,loadingIndicator:ke,loadingPosition:de,size:te,type:Te,variant:Le},ze=pAe(We),$e=(ye||fe&&de==="start")&&j.jsx(gAe,{className:ze.startIcon,ownerState:We,children:ye||j.jsx(zte,{className:ze.loadingIconPlaceholder,ownerState:We})}),et=(X||fe&&de==="end")&&j.jsx(_Ae,{className:ze.endIcon,ownerState:We,children:X||j.jsx(zte,{className:ze.loadingIconPlaceholder,ownerState:We})}),Oe=T||"",qe=typeof fe=="boolean"?j.jsx("span",{className:ze.loadingWrapper,style:{display:"contents"},children:fe&&j.jsx(EAe,{className:ze.loadingIndicator,ownerState:We,children:ke})}):null;return j.jsxs(mAe,{ownerState:We,className:Ki(g.className,ze.root,V,Oe),component:x,disabled:K||fe,focusRipple:!ie,focusVisibleClassName:Ki(ze.focusVisible,Z),ref:h,type:Te,id:fe?he:le,...je,classes:ze,children:[$e,de!=="end"&&qe,M,de==="end"&&qe,et]})}),SAe=iwe({createStyledComponent:wi("div",{name:"MuiContainer",slot:"Root",overridesResolver:(o,d)=>{const{ownerState:h}=o;return[d.root,d[`maxWidth${Nn(String(h.maxWidth))}`],h.fixed&&d.fixed,h.disableGutters&&d.disableGutters]}}),useThemeProps:o=>Ec({props:o,name:"MuiContainer"})});function Ele(o=window){const d=o.document.documentElement.clientWidth;return o.innerWidth-d}function yAe(o){const d=mm(o);return d.body===o?WA(o).innerWidth>d.documentElement.clientWidth:o.scrollHeight>o.clientHeight}function d5(o,d){d?o.setAttribute("aria-hidden","true"):o.removeAttribute("aria-hidden")}function Hte(o){return parseInt(WA(o).getComputedStyle(o).paddingRight,10)||0}function TAe(o){const h=["TEMPLATE","SCRIPT","STYLE","LINK","MAP","META","NOSCRIPT","PICTURE","COL","COLGROUP","PARAM","SLOT","SOURCE","TRACK"].includes(o.tagName),g=o.tagName==="INPUT"&&o.getAttribute("type")==="hidden";return h||g}function Wte(o,d,h,g,T){const I=[d,h,...g];[].forEach.call(o.children,N=>{const M=!I.includes(N),k=!TAe(N);M&&k&&d5(N,T)})}function oq(o,d){let h=-1;return o.some((g,T)=>d(g)?(h=T,!0):!1),h}function bAe(o,d){const h=[],g=o.container;if(!d.disableScrollLock){if(yAe(g)){const N=Ele(WA(g));h.push({value:g.style.paddingRight,property:"padding-right",el:g}),g.style.paddingRight=`${Hte(g)+N}px`;const M=mm(g).querySelectorAll(".mui-fixed");[].forEach.call(M,k=>{h.push({value:k.style.paddingRight,property:"padding-right",el:k}),k.style.paddingRight=`${Hte(k)+N}px`})}let I;if(g.parentNode instanceof DocumentFragment)I=mm(g).body;else{const N=g.parentElement,M=WA(g);I=(N==null?void 0:N.nodeName)==="HTML"&&M.getComputedStyle(N).overflowY==="scroll"?N:g}h.push({value:I.style.overflow,property:"overflow",el:I},{value:I.style.overflowX,property:"overflow-x",el:I},{value:I.style.overflowY,property:"overflow-y",el:I}),I.style.overflow="hidden"}return()=>{h.forEach(({value:I,el:N,property:M})=>{I?N.style.setProperty(M,I):N.style.removeProperty(M)})}}function CAe(o){const d=[];return[].forEach.call(o.children,h=>{h.getAttribute("aria-hidden")==="true"&&d.push(h)}),d}class wAe{constructor(){this.modals=[],this.containers=[]}add(d,h){let g=this.modals.indexOf(d);if(g!==-1)return g;g=this.modals.length,this.modals.push(d),d.modalRef&&d5(d.modalRef,!1);const T=CAe(h);Wte(h,d.mount,d.modalRef,T,!0);const I=oq(this.containers,N=>N.container===h);return I!==-1?(this.containers[I].modals.push(d),g):(this.containers.push({modals:[d],container:h,restore:null,hiddenSiblings:T}),g)}mount(d,h){const g=oq(this.containers,I=>I.modals.includes(d)),T=this.containers[g];T.restore||(T.restore=bAe(T,h))}remove(d,h=!0){const g=this.modals.indexOf(d);if(g===-1)return g;const T=oq(this.containers,N=>N.modals.includes(d)),I=this.containers[T];if(I.modals.splice(I.modals.indexOf(d),1),this.modals.splice(g,1),I.modals.length===0)I.restore&&I.restore(),d.modalRef&&d5(d.modalRef,h),Wte(I.container,d.mount,d.modalRef,I.hiddenSiblings,!1),this.containers.splice(T,1);else{const N=I.modals[I.modals.length-1];N.modalRef&&d5(N.modalRef,!1)}return g}isTopModal(d){return this.modals.length>0&&this.modals[this.modals.length-1]===d}}const RAe=["input","select","textarea","a[href]","button","[tabindex]","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])'].join(",");function IAe(o){const d=parseInt(o.getAttribute("tabindex")||"",10);return Number.isNaN(d)?o.contentEditable==="true"||(o.nodeName==="AUDIO"||o.nodeName==="VIDEO"||o.nodeName==="DETAILS")&&o.getAttribute("tabindex")===null?0:o.tabIndex:d}function AAe(o){if(o.tagName!=="INPUT"||o.type!=="radio"||!o.name)return!1;const d=g=>o.ownerDocument.querySelector(`input[type="radio"]${g}`);let h=d(`[name="${o.name}"]:checked`);return h||(h=d(`[name="${o.name}"]`)),h!==o}function OAe(o){return!(o.disabled||o.tagName==="INPUT"&&o.type==="hidden"||AAe(o))}function NAe(o){const d=[],h=[];return Array.from(o.querySelectorAll(RAe)).forEach((g,T)=>{const I=IAe(g);I===-1||!OAe(g)||(I===0?d.push(g):h.push({documentOrder:T,tabIndex:I,node:g}))}),h.sort((g,T)=>g.tabIndex===T.tabIndex?g.documentOrder-T.documentOrder:g.tabIndex-T.tabIndex).map(g=>g.node).concat(d)}function LAe(){return!0}function DAe(o){const{children:d,disableAutoFocus:h=!1,disableEnforceFocus:g=!1,disableRestoreFocus:T=!1,getTabbable:I=NAe,isEnabled:N=LAe,open:M}=o,k=q.useRef(!1),x=q.useRef(null),V=q.useRef(null),K=q.useRef(null),Q=q.useRef(null),ie=q.useRef(!1),X=q.useRef(null),Z=Eu($5(d),X),ae=q.useRef(null);q.useEffect(()=>{!M||!X.current||(ie.current=!h)},[h,M]),q.useEffect(()=>{if(!M||!X.current)return;const ue=mm(X.current);return X.current.contains(ue.activeElement)||(X.current.hasAttribute("tabIndex")||X.current.setAttribute("tabIndex","-1"),ie.current&&X.current.focus()),()=>{T||(K.current&&K.current.focus&&(k.current=!0,K.current.focus()),K.current=null)}},[M]),q.useEffect(()=>{if(!M||!X.current)return;const ue=mm(X.current),de=Te=>{ae.current=Te,!(g||!N()||Te.key!=="Tab")&&ue.activeElement===X.current&&Te.shiftKey&&(k.current=!0,V.current&&V.current.focus())},te=()=>{var je,he;const Te=X.current;if(Te===null)return;if(!ue.hasFocus()||!N()||k.current){k.current=!1;return}if(Te.contains(ue.activeElement)||g&&ue.activeElement!==x.current&&ue.activeElement!==V.current)return;if(ue.activeElement!==Q.current)Q.current=null;else if(Q.current!==null)return;if(!ie.current)return;let Le=[];if((ue.activeElement===x.current||ue.activeElement===V.current)&&(Le=I(X.current)),Le.length>0){const ke=!!((je=ae.current)!=null&&je.shiftKey&&((he=ae.current)==null?void 0:he.key)==="Tab"),We=Le[0],ze=Le[Le.length-1];typeof We!="string"&&typeof ze!="string"&&(ke?ze.focus():We.focus())}else Te.focus()};ue.addEventListener("focusin",te),ue.addEventListener("keydown",de,!0);const ye=setInterval(()=>{ue.activeElement&&ue.activeElement.tagName==="BODY"&&te()},50);return()=>{clearInterval(ye),ue.removeEventListener("focusin",te),ue.removeEventListener("keydown",de,!0)}},[h,g,T,N,M,I]);const le=ue=>{K.current===null&&(K.current=ue.relatedTarget),ie.current=!0,Q.current=ue.target;const de=d.props.onFocus;de&&de(ue)},fe=ue=>{K.current===null&&(K.current=ue.relatedTarget),ie.current=!0};return j.jsxs(q.Fragment,{children:[j.jsx("div",{tabIndex:M?0:-1,onFocus:fe,ref:x,"data-testid":"sentinelStart"}),q.cloneElement(d,{ref:Z,onFocus:le}),j.jsx("div",{tabIndex:M?0:-1,onFocus:fe,ref:V,"data-testid":"sentinelEnd"})]})}function PAe(o){return typeof o=="function"?o():o}function MAe(o){return o?o.props.hasOwnProperty("in"):!1}const Yte=()=>{},S7=new wAe;function kAe(o){const{container:d,disableEscapeKeyDown:h=!1,disableScrollLock:g=!1,closeAfterTransition:T=!1,onTransitionEnter:I,onTransitionExited:N,children:M,onClose:k,open:x,rootRef:V}=o,K=q.useRef({}),Q=q.useRef(null),ie=q.useRef(null),X=Eu(ie,V),[Z,ae]=q.useState(!x),le=MAe(M);let fe=!0;(o["aria-hidden"]==="false"||o["aria-hidden"]===!1)&&(fe=!1);const ue=()=>mm(Q.current),de=()=>(K.current.modalRef=ie.current,K.current.mount=Q.current,K.current),te=()=>{S7.mount(de(),{disableScrollLock:g}),ie.current&&(ie.current.scrollTop=0)},ye=tC(()=>{const et=PAe(d)||ue().body;S7.add(de(),et),ie.current&&te()}),Te=()=>S7.isTopModal(de()),Le=tC(et=>{Q.current=et,et&&(x&&Te()?te():ie.current&&d5(ie.current,fe))}),je=q.useCallback(()=>{S7.remove(de(),fe)},[fe]);q.useEffect(()=>()=>{je()},[je]),q.useEffect(()=>{x?ye():(!le||!T)&&je()},[x,je,le,T,ye]);const he=et=>Oe=>{var qe;(qe=et.onKeyDown)==null||qe.call(et,Oe),!(Oe.key!=="Escape"||Oe.which===229||!Te())&&(h||(Oe.stopPropagation(),k&&k(Oe,"escapeKeyDown")))},ke=et=>Oe=>{var qe;(qe=et.onClick)==null||qe.call(et,Oe),Oe.target===Oe.currentTarget&&k&&k(Oe,"backdropClick")};return{getRootProps:(et={})=>{const Oe=nle(o);delete Oe.onTransitionEnter,delete Oe.onTransitionExited;const qe={...Oe,...et};return{role:"presentation",...qe,onKeyDown:he(qe),ref:X}},getBackdropProps:(et={})=>{const Oe=et;return{"aria-hidden":!0,...Oe,onClick:ke(Oe),open:x}},getTransitionProps:()=>{const et=()=>{ae(!1),I&&I()},Oe=()=>{ae(!0),N&&N(),T&&je()};return{onEnter:Ite(et,(M==null?void 0:M.props.onEnter)??Yte),onExited:Ite(Oe,(M==null?void 0:M.props.onExited)??Yte)}},rootRef:X,portalRef:Le,isTopModal:Te,exited:Z,hasTransition:le}}function xAe(o){return _c("MuiModal",o)}Zo("MuiModal",["root","hidden","backdrop"]);const UAe=o=>{const{open:d,exited:h,classes:g}=o;return tl({root:["root",!d&&h&&"hidden"],backdrop:["backdrop"]},xAe,g)},jAe=wi("div",{name:"MuiModal",slot:"Root",overridesResolver:(o,d)=>{const{ownerState:h}=o;return[d.root,!h.open&&h.exited&&d.hidden]}})(yd(({theme:o})=>({position:"fixed",zIndex:(o.vars||o).zIndex.modal,right:0,bottom:0,top:0,left:0,variants:[{props:({ownerState:d})=>!d.open&&d.exited,style:{visibility:"hidden"}}]}))),VAe=wi(dAe,{name:"MuiModal",slot:"Backdrop"})({zIndex:-1}),BAe=q.forwardRef(function(d,h){const g=Ec({name:"MuiModal",props:d}),{BackdropComponent:T=VAe,BackdropProps:I,classes:N,className:M,closeAfterTransition:k=!1,children:x,container:V,component:K,components:Q={},componentsProps:ie={},disableAutoFocus:X=!1,disableEnforceFocus:Z=!1,disableEscapeKeyDown:ae=!1,disablePortal:le=!1,disableRestoreFocus:fe=!1,disableScrollLock:ue=!1,hideBackdrop:de=!1,keepMounted:te=!1,onClose:ye,onTransitionEnter:Te,onTransitionExited:Le,open:je,slotProps:he={},slots:ke={},theme:We,...ze}=g,$e={...g,closeAfterTransition:k,disableAutoFocus:X,disableEnforceFocus:Z,disableEscapeKeyDown:ae,disablePortal:le,disableRestoreFocus:fe,disableScrollLock:ue,hideBackdrop:de,keepMounted:te},{getRootProps:et,getBackdropProps:Oe,getTransitionProps:qe,portalRef:lt,isTopModal:Ge,exited:Ae,hasTransition:rt}=kAe({...$e,rootRef:h}),yt={...$e,exited:Ae},Lt=UAe(yt),Pt={};if(x.props.tabIndex===void 0&&(Pt.tabIndex="-1"),rt){const{onEnter:kt,onExited:Ht}=qe();Pt.onEnter=kt,Pt.onExited=Ht}const _n={slots:{root:Q.Root,backdrop:Q.Backdrop,...ke},slotProps:{...ie,...he}},[Gt,zt]=el("root",{ref:h,elementType:jAe,externalForwardedProps:{..._n,...ze,component:K},getSlotProps:et,ownerState:yt,className:Ki(M,Lt==null?void 0:Lt.root,!yt.open&&yt.exited&&(Lt==null?void 0:Lt.hidden))}),[rn,ir]=el("backdrop",{ref:I==null?void 0:I.ref,elementType:T,externalForwardedProps:_n,shouldForwardComponentProp:!0,additionalProps:I,getSlotProps:kt=>Oe({...kt,onClick:Ht=>{kt!=null&&kt.onClick&&kt.onClick(Ht)}}),className:Ki(I==null?void 0:I.className,Lt==null?void 0:Lt.backdrop),ownerState:yt});return!te&&!je&&(!rt||Ae)?null:j.jsx(mle,{ref:lt,container:V,disablePortal:le,children:j.jsxs(Gt,{...zt,children:[!de&&T?j.jsx(rn,{...ir}):null,j.jsx(DAe,{disableEnforceFocus:Z,disableAutoFocus:X,disableRestoreFocus:fe,isEnabled:Ge,open:je,children:q.cloneElement(x,Pt)})]})})});function FAe(o){return _c("MuiDivider",o)}const Kte=Zo("MuiDivider",["root","absolute","fullWidth","inset","middle","flexItem","light","vertical","withChildren","withChildrenVertical","textAlignRight","textAlignLeft","wrapper","wrapperVertical"]),GAe=o=>{const{absolute:d,children:h,classes:g,flexItem:T,light:I,orientation:N,textAlign:M,variant:k}=o;return tl({root:["root",d&&"absolute",k,I&&"light",N==="vertical"&&"vertical",T&&"flexItem",h&&"withChildren",h&&N==="vertical"&&"withChildrenVertical",M==="right"&&N!=="vertical"&&"textAlignRight",M==="left"&&N!=="vertical"&&"textAlignLeft"],wrapper:["wrapper",N==="vertical"&&"wrapperVertical"]},FAe,g)},zAe=wi("div",{name:"MuiDivider",slot:"Root",overridesResolver:(o,d)=>{const{ownerState:h}=o;return[d.root,h.absolute&&d.absolute,d[h.variant],h.light&&d.light,h.orientation==="vertical"&&d.vertical,h.flexItem&&d.flexItem,h.children&&d.withChildren,h.children&&h.orientation==="vertical"&&d.withChildrenVertical,h.textAlign==="right"&&h.orientation!=="vertical"&&d.textAlignRight,h.textAlign==="left"&&h.orientation!=="vertical"&&d.textAlignLeft]}})(yd(({theme:o})=>({margin:0,flexShrink:0,borderWidth:0,borderStyle:"solid",borderColor:(o.vars||o).palette.divider,borderBottomWidth:"thin",variants:[{props:{absolute:!0},style:{position:"absolute",bottom:0,left:0,width:"100%"}},{props:{light:!0},style:{borderColor:o.vars?`rgba(${o.vars.palette.dividerChannel} / 0.08)`:Qa(o.palette.divider,.08)}},{props:{variant:"inset"},style:{marginLeft:72}},{props:{variant:"middle",orientation:"horizontal"},style:{marginLeft:o.spacing(2),marginRight:o.spacing(2)}},{props:{variant:"middle",orientation:"vertical"},style:{marginTop:o.spacing(1),marginBottom:o.spacing(1)}},{props:{orientation:"vertical"},style:{height:"100%",borderBottomWidth:0,borderRightWidth:"thin"}},{props:{flexItem:!0},style:{alignSelf:"stretch",height:"auto"}},{props:({ownerState:d})=>!!d.children,style:{display:"flex",textAlign:"center",border:0,borderTopStyle:"solid",borderLeftStyle:"solid","&::before, &::after":{content:'""',alignSelf:"center"}}},{props:({ownerState:d})=>d.children&&d.orientation!=="vertical",style:{"&::before, &::after":{width:"100%",borderTop:`thin solid ${(o.vars||o).palette.divider}`,borderTopStyle:"inherit"}}},{props:({ownerState:d})=>d.orientation==="vertical"&&d.children,style:{flexDirection:"column","&::before, &::after":{height:"100%",borderLeft:`thin solid ${(o.vars||o).palette.divider}`,borderLeftStyle:"inherit"}}},{props:({ownerState:d})=>d.textAlign==="right"&&d.orientation!=="vertical",style:{"&::before":{width:"90%"},"&::after":{width:"10%"}}},{props:({ownerState:d})=>d.textAlign==="left"&&d.orientation!=="vertical",style:{"&::before":{width:"10%"},"&::after":{width:"90%"}}}]}))),HAe=wi("span",{name:"MuiDivider",slot:"Wrapper",overridesResolver:(o,d)=>{const{ownerState:h}=o;return[d.wrapper,h.orientation==="vertical"&&d.wrapperVertical]}})(yd(({theme:o})=>({display:"inline-block",paddingLeft:`calc(${o.spacing(1)} * 1.2)`,paddingRight:`calc(${o.spacing(1)} * 1.2)`,whiteSpace:"nowrap",variants:[{props:{orientation:"vertical"},style:{paddingTop:`calc(${o.spacing(1)} * 1.2)`,paddingBottom:`calc(${o.spacing(1)} * 1.2)`}}]}))),gQ=q.forwardRef(function(d,h){const g=Ec({props:d,name:"MuiDivider"}),{absolute:T=!1,children:I,className:N,orientation:M="horizontal",component:k=I||M==="vertical"?"div":"hr",flexItem:x=!1,light:V=!1,role:K=k!=="hr"?"separator":void 0,textAlign:Q="center",variant:ie="fullWidth",...X}=g,Z={...g,absolute:T,component:k,flexItem:x,light:V,orientation:M,role:K,textAlign:Q,variant:ie},ae=GAe(Z);return j.jsx(zAe,{as:k,className:Ki(ae.root,N),role:K,ref:h,ownerState:Z,"aria-orientation":K==="separator"&&(k!=="hr"||M==="vertical")?M:void 0,...X,children:I?j.jsx(HAe,{className:ae.wrapper,ownerState:Z,children:I}):null})});gQ&&(gQ.muiSkipListHighlight=!0);function _Q(o){return`scale(${o}, ${o**2})`}const WAe={entering:{opacity:1,transform:_Q(1)},entered:{opacity:1,transform:"none"}},cq=typeof navigator<"u"&&/^((?!chrome|android).)*(safari|mobile)/i.test(navigator.userAgent)&&/(os |version\/)15(.|_)4/i.test(navigator.userAgent),pG=q.forwardRef(function(d,h){const{addEndListener:g,appear:T=!0,children:I,easing:N,in:M,onEnter:k,onEntered:x,onEntering:V,onExit:K,onExited:Q,onExiting:ie,style:X,timeout:Z="auto",TransitionComponent:ae=TE,...le}=d,fe=hP(),ue=q.useRef(),de=cz(),te=q.useRef(null),ye=Eu(te,$5(I),h),Te=et=>Oe=>{if(et){const qe=te.current;Oe===void 0?et(qe):et(qe,Oe)}},Le=Te(V),je=Te((et,Oe)=>{$ce(et);const{duration:qe,delay:lt,easing:Ge}=dG({style:X,timeout:Z,easing:N},{mode:"enter"});let Ae;Z==="auto"?(Ae=de.transitions.getAutoHeightDuration(et.clientHeight),ue.current=Ae):Ae=qe,et.style.transition=[de.transitions.create("opacity",{duration:Ae,delay:lt}),de.transitions.create("transform",{duration:cq?Ae:Ae*.666,delay:lt,easing:Ge})].join(","),k&&k(et,Oe)}),he=Te(x),ke=Te(ie),We=Te(et=>{const{duration:Oe,delay:qe,easing:lt}=dG({style:X,timeout:Z,easing:N},{mode:"exit"});let Ge;Z==="auto"?(Ge=de.transitions.getAutoHeightDuration(et.clientHeight),ue.current=Ge):Ge=Oe,et.style.transition=[de.transitions.create("opacity",{duration:Ge,delay:qe}),de.transitions.create("transform",{duration:cq?Ge:Ge*.666,delay:cq?qe:qe||Ge*.333,easing:lt})].join(","),et.style.opacity=0,et.style.transform=_Q(.75),K&&K(et)}),ze=Te(Q),$e=et=>{Z==="auto"&&fe.start(ue.current||0,et),g&&g(te.current,et)};return j.jsx(ae,{appear:T,in:M,nodeRef:te,onEnter:je,onEntered:he,onEntering:Le,onExit:We,onExited:ze,onExiting:ke,addEndListener:$e,timeout:Z==="auto"?null:Z,...le,children:(et,{ownerState:Oe,...qe})=>q.cloneElement(I,{style:{opacity:0,transform:_Q(.75),visibility:et==="exited"&&!M?"hidden":void 0,...WAe[et],...X,...I.props.style},ref:ye,...qe})})});pG&&(pG.muiSupportAuto=!0);const EQ=q.createContext({});function YAe(o){return _c("MuiList",o)}Zo("MuiList",["root","padding","dense","subheader"]);const KAe=o=>{const{classes:d,disablePadding:h,dense:g,subheader:T}=o;return tl({root:["root",!h&&"padding",g&&"dense",T&&"subheader"]},YAe,d)},qAe=wi("ul",{name:"MuiList",slot:"Root",overridesResolver:(o,d)=>{const{ownerState:h}=o;return[d.root,!h.disablePadding&&d.padding,h.dense&&d.dense,h.subheader&&d.subheader]}})({listStyle:"none",margin:0,padding:0,position:"relative",variants:[{props:({ownerState:o})=>!o.disablePadding,style:{paddingTop:8,paddingBottom:8}},{props:({ownerState:o})=>o.subheader,style:{paddingTop:0}}]}),JAe=q.forwardRef(function(d,h){const g=Ec({props:d,name:"MuiList"}),{children:T,className:I,component:N="ul",dense:M=!1,disablePadding:k=!1,subheader:x,...V}=g,K=q.useMemo(()=>({dense:M}),[M]),Q={...g,component:N,dense:M,disablePadding:k},ie=KAe(Q);return j.jsx(EQ.Provider,{value:K,children:j.jsxs(qAe,{as:N,className:Ki(ie.root,I),ref:h,ownerState:Q,...V,children:[x,T]})})}),qte=Zo("MuiListItemIcon",["root","alignItemsFlexStart"]),Jte=Zo("MuiListItemText",["root","multiline","dense","inset","primary","secondary"]);function lq(o,d,h){return o===d?o.firstChild:d&&d.nextElementSibling?d.nextElementSibling:h?null:o.firstChild}function Xte(o,d,h){return o===d?h?o.firstChild:o.lastChild:d&&d.previousElementSibling?d.previousElementSibling:h?null:o.lastChild}function vle(o,d){if(d===void 0)return!0;let h=o.innerText;return h===void 0&&(h=o.textContent),h=h.trim().toLowerCase(),h.length===0?!1:d.repeating?h[0]===d.keys[0]:h.startsWith(d.keys.join(""))}function Wj(o,d,h,g,T,I){let N=!1,M=T(o,d,d?h:!1);for(;M;){if(M===o.firstChild){if(N)return!1;N=!0}const k=g?!1:M.disabled||M.getAttribute("aria-disabled")==="true";if(!M.hasAttribute("tabindex")||!vle(M,I)||k)M=T(o,M,h);else return M.focus(),!0}return!1}const XAe=q.forwardRef(function(d,h){const{actions:g,autoFocus:T=!1,autoFocusItem:I=!1,children:N,className:M,disabledItemsFocusable:k=!1,disableListWrap:x=!1,onKeyDown:V,variant:K="selectedMenu",...Q}=d,ie=q.useRef(null),X=q.useRef({keys:[],repeating:!0,previousKeyMatched:!0,lastTime:null});HA(()=>{T&&ie.current.focus()},[T]),q.useImperativeHandle(g,()=>({adjustStyleForScrollbar:(ue,{direction:de})=>{const te=!ie.current.style.width;if(ue.clientHeight<ie.current.clientHeight&&te){const ye=`${Ele(WA(ue))}px`;ie.current.style[de==="rtl"?"paddingLeft":"paddingRight"]=ye,ie.current.style.width=`calc(100% + ${ye})`}return ie.current}}),[]);const Z=ue=>{const de=ie.current,te=ue.key;if(ue.ctrlKey||ue.metaKey||ue.altKey){V&&V(ue);return}const Te=mm(de).activeElement;if(te==="ArrowDown")ue.preventDefault(),Wj(de,Te,x,k,lq);else if(te==="ArrowUp")ue.preventDefault(),Wj(de,Te,x,k,Xte);else if(te==="Home")ue.preventDefault(),Wj(de,null,x,k,lq);else if(te==="End")ue.preventDefault(),Wj(de,null,x,k,Xte);else if(te.length===1){const Le=X.current,je=te.toLowerCase(),he=performance.now();Le.keys.length>0&&(he-Le.lastTime>500?(Le.keys=[],Le.repeating=!0,Le.previousKeyMatched=!0):Le.repeating&&je!==Le.keys[0]&&(Le.repeating=!1)),Le.lastTime=he,Le.keys.push(je);const ke=Te&&!Le.repeating&&vle(Te,Le);Le.previousKeyMatched&&(ke||Wj(de,Te,!1,k,lq,Le))?ue.preventDefault():Le.previousKeyMatched=!1}V&&V(ue)},ae=Eu(ie,h);let le=-1;q.Children.forEach(N,(ue,de)=>{if(!q.isValidElement(ue)){le===de&&(le+=1,le>=N.length&&(le=-1));return}ue.props.disabled||(K==="selectedMenu"&&ue.props.selected||le===-1)&&(le=de),le===de&&(ue.props.disabled||ue.props.muiSkipListHighlight||ue.type.muiSkipListHighlight)&&(le+=1,le>=N.length&&(le=-1))});const fe=q.Children.map(N,(ue,de)=>{if(de===le){const te={};return I&&(te.autoFocus=!0),ue.props.tabIndex===void 0&&K==="selectedMenu"&&(te.tabIndex=0),q.cloneElement(ue,te)}return ue});return j.jsx(JAe,{role:"menu",ref:ae,className:M,onKeyDown:Z,tabIndex:T?0:-1,...Q,children:fe})});function QAe(o){return _c("MuiPopover",o)}Zo("MuiPopover",["root","paper"]);function Qte(o,d){let h=0;return typeof d=="number"?h=d:d==="center"?h=o.height/2:d==="bottom"&&(h=o.height),h}function Zte(o,d){let h=0;return typeof d=="number"?h=d:d==="center"?h=o.width/2:d==="right"&&(h=o.width),h}function $te(o){return[o.horizontal,o.vertical].map(d=>typeof d=="number"?`${d}px`:d).join(" ")}function y7(o){return typeof o=="function"?o():o}const ZAe=o=>{const{classes:d}=o;return tl({root:["root"],paper:["paper"]},QAe,d)},$Ae=wi(BAe,{name:"MuiPopover",slot:"Root"})({}),Sle=wi(nRe,{name:"MuiPopover",slot:"Paper"})({position:"absolute",overflowY:"auto",overflowX:"hidden",minWidth:16,minHeight:16,maxWidth:"calc(100% - 32px)",maxHeight:"calc(100% - 32px)",outline:0}),e2e=q.forwardRef(function(d,h){const g=Ec({props:d,name:"MuiPopover"}),{action:T,anchorEl:I,anchorOrigin:N={vertical:"top",horizontal:"left"},anchorPosition:M,anchorReference:k="anchorEl",children:x,className:V,container:K,elevation:Q=8,marginThreshold:ie=16,open:X,PaperProps:Z={},slots:ae={},slotProps:le={},transformOrigin:fe={vertical:"top",horizontal:"left"},TransitionComponent:ue,transitionDuration:de="auto",TransitionProps:te={},disableScrollLock:ye=!1,...Te}=g,Le=q.useRef(),je={...g,anchorOrigin:N,anchorReference:k,elevation:Q,marginThreshold:ie,transformOrigin:fe,TransitionComponent:ue,transitionDuration:de,TransitionProps:te},he=ZAe(je),ke=q.useCallback(()=>{if(k==="anchorPosition")return M;const kt=y7(I),Jt=(kt&&kt.nodeType===1?kt:mm(Le.current).body).getBoundingClientRect();return{top:Jt.top+Qte(Jt,N.vertical),left:Jt.left+Zte(Jt,N.horizontal)}},[I,N.horizontal,N.vertical,M,k]),We=q.useCallback(kt=>({vertical:Qte(kt,fe.vertical),horizontal:Zte(kt,fe.horizontal)}),[fe.horizontal,fe.vertical]),ze=q.useCallback(kt=>{const Ht={width:kt.offsetWidth,height:kt.offsetHeight},Jt=We(Ht);if(k==="none")return{top:null,left:null,transformOrigin:$te(Jt)};const tn=ke();let Yn=tn.top-Jt.vertical,oi=tn.left-Jt.horizontal;const Ri=Yn+Ht.height,jr=oi+Ht.width,dr=WA(y7(I)),Ii=dr.innerHeight-ie,sa=dr.innerWidth-ie;if(ie!==null&&Yn<ie){const ar=Yn-ie;Yn-=ar,Jt.vertical+=ar}else if(ie!==null&&Ri>Ii){const ar=Ri-Ii;Yn-=ar,Jt.vertical+=ar}if(ie!==null&&oi<ie){const ar=oi-ie;oi-=ar,Jt.horizontal+=ar}else if(jr>sa){const ar=jr-sa;oi-=ar,Jt.horizontal+=ar}return{top:`${Math.round(Yn)}px`,left:`${Math.round(oi)}px`,transformOrigin:$te(Jt)}},[I,k,ke,We,ie]),[$e,et]=q.useState(X),Oe=q.useCallback(()=>{const kt=Le.current;if(!kt)return;const Ht=ze(kt);Ht.top!==null&&kt.style.setProperty("top",Ht.top),Ht.left!==null&&(kt.style.left=Ht.left),kt.style.transformOrigin=Ht.transformOrigin,et(!0)},[ze]);q.useEffect(()=>(ye&&window.addEventListener("scroll",Oe),()=>window.removeEventListener("scroll",Oe)),[I,ye,Oe]);const qe=()=>{Oe()},lt=()=>{et(!1)};q.useEffect(()=>{X&&Oe()}),q.useImperativeHandle(T,()=>X?{updatePosition:()=>{Oe()}}:null,[X,Oe]),q.useEffect(()=>{if(!X)return;const kt=Bwe(()=>{Oe()}),Ht=WA(y7(I));return Ht.addEventListener("resize",kt),()=>{kt.clear(),Ht.removeEventListener("resize",kt)}},[I,X,Oe]);let Ge=de;const Ae={slots:{transition:ue,...ae},slotProps:{transition:te,paper:Z,...le}},[rt,yt]=el("transition",{elementType:pG,externalForwardedProps:Ae,ownerState:je,getSlotProps:kt=>({...kt,onEntering:(Ht,Jt)=>{var tn;(tn=kt.onEntering)==null||tn.call(kt,Ht,Jt),qe()},onExited:Ht=>{var Jt;(Jt=kt.onExited)==null||Jt.call(kt,Ht),lt()}}),additionalProps:{appear:!0,in:X}});de==="auto"&&!rt.muiSupportAuto&&(Ge=void 0);const Lt=K||(I?mm(y7(I)).body:void 0),[Pt,{slots:_n,slotProps:Gt,...zt}]=el("root",{ref:h,elementType:$Ae,externalForwardedProps:{...Ae,...Te},shouldForwardComponentProp:!0,additionalProps:{slots:{backdrop:ae.backdrop},slotProps:{backdrop:zwe(typeof le.backdrop=="function"?le.backdrop(je):le.backdrop,{invisible:!0})},container:Lt,open:X},ownerState:je,className:Ki(he.root,V)}),[rn,ir]=el("paper",{ref:Le,className:he.paper,elementType:Sle,externalForwardedProps:Ae,shouldForwardComponentProp:!0,additionalProps:{elevation:Q,style:$e?void 0:{opacity:0}},ownerState:je});return j.jsx(Pt,{...zt,...!QIe(Pt)&&{slots:_n,slotProps:Gt,disableScrollLock:ye},children:j.jsx(rt,{...yt,timeout:Ge,children:j.jsx(rn,{...ir,children:x})})})});function t2e(o){return _c("MuiMenu",o)}Zo("MuiMenu",["root","paper","list"]);const n2e={vertical:"top",horizontal:"right"},r2e={vertical:"top",horizontal:"left"},i2e=o=>{const{classes:d}=o;return tl({root:["root"],paper:["paper"],list:["list"]},t2e,d)},a2e=wi(e2e,{shouldForwardProp:o=>lz(o)||o==="classes",name:"MuiMenu",slot:"Root"})({}),s2e=wi(Sle,{name:"MuiMenu",slot:"Paper"})({maxHeight:"calc(100% - 96px)",WebkitOverflowScrolling:"touch"}),o2e=wi(XAe,{name:"MuiMenu",slot:"List"})({outline:0}),c2e=q.forwardRef(function(d,h){const g=Ec({props:d,name:"MuiMenu"}),{autoFocus:T=!0,children:I,className:N,disableAutoFocusItem:M=!1,MenuListProps:k={},onClose:x,open:V,PaperProps:K={},PopoverClasses:Q,transitionDuration:ie="auto",TransitionProps:{onEntering:X,...Z}={},variant:ae="selectedMenu",slots:le={},slotProps:fe={},...ue}=g,de=NZ(),te={...g,autoFocus:T,disableAutoFocusItem:M,MenuListProps:k,onEntering:X,PaperProps:K,transitionDuration:ie,TransitionProps:Z,variant:ae},ye=i2e(te),Te=T&&!M&&V,Le=q.useRef(null),je=(Ge,Ae)=>{Le.current&&Le.current.adjustStyleForScrollbar(Ge,{direction:de?"rtl":"ltr"}),X&&X(Ge,Ae)},he=Ge=>{Ge.key==="Tab"&&(Ge.preventDefault(),x&&x(Ge,"tabKeyDown"))};let ke=-1;q.Children.map(I,(Ge,Ae)=>{q.isValidElement(Ge)&&(Ge.props.disabled||(ae==="selectedMenu"&&Ge.props.selected||ke===-1)&&(ke=Ae))});const We={slots:le,slotProps:{list:k,transition:Z,paper:K,...fe}},ze=ple({elementType:le.root,externalSlotProps:fe.root,ownerState:te,className:[ye.root,N]}),[$e,et]=el("paper",{className:ye.paper,elementType:s2e,externalForwardedProps:We,shouldForwardComponentProp:!0,ownerState:te}),[Oe,qe]=el("list",{className:Ki(ye.list,k.className),elementType:o2e,shouldForwardComponentProp:!0,externalForwardedProps:We,getSlotProps:Ge=>({...Ge,onKeyDown:Ae=>{var rt;he(Ae),(rt=Ge.onKeyDown)==null||rt.call(Ge,Ae)}}),ownerState:te}),lt=typeof We.slotProps.transition=="function"?We.slotProps.transition(te):We.slotProps.transition;return j.jsx(a2e,{onClose:x,anchorOrigin:{vertical:"bottom",horizontal:de?"right":"left"},transformOrigin:de?n2e:r2e,slots:{root:le.root,paper:$e,backdrop:le.backdrop,...le.transition&&{transition:le.transition}},slotProps:{root:ze,paper:et,backdrop:typeof fe.backdrop=="function"?fe.backdrop(te):fe.backdrop,transition:{...lt,onEntering:(...Ge)=>{var Ae;je(...Ge),(Ae=lt==null?void 0:lt.onEntering)==null||Ae.call(lt,...Ge)}}},open:V,ref:h,transitionDuration:ie,ownerState:te,...ue,classes:Q,children:j.jsx(Oe,{actions:Le,autoFocus:T&&(ke===-1||M),autoFocusItem:Te,variant:ae,...qe,children:I})})});function l2e(o){return _c("MuiMenuItem",o)}const Yj=Zo("MuiMenuItem",["root","focusVisible","dense","disabled","divider","gutters","selected"]),d2e=(o,d)=>{const{ownerState:h}=o;return[d.root,h.dense&&d.dense,h.divider&&d.divider,!h.disableGutters&&d.gutters]},u2e=o=>{const{disabled:d,dense:h,divider:g,disableGutters:T,selected:I,classes:N}=o,k=tl({root:["root",h&&"dense",d&&"disabled",!T&&"gutters",g&&"divider",I&&"selected"]},l2e,N);return{...N,...k}},f2e=wi(O5,{shouldForwardProp:o=>lz(o)||o==="classes",name:"MuiMenuItem",slot:"Root",overridesResolver:d2e})(yd(({theme:o})=>({...o.typography.body1,display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",minHeight:48,paddingTop:6,paddingBottom:6,boxSizing:"border-box",whiteSpace:"nowrap","&:hover":{textDecoration:"none",backgroundColor:(o.vars||o).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${Yj.selected}`]:{backgroundColor:o.vars?`rgba(${o.vars.palette.primary.mainChannel} / ${o.vars.palette.action.selectedOpacity})`:Qa(o.palette.primary.main,o.palette.action.selectedOpacity),[`&.${Yj.focusVisible}`]:{backgroundColor:o.vars?`rgba(${o.vars.palette.primary.mainChannel} / calc(${o.vars.palette.action.selectedOpacity} + ${o.vars.palette.action.focusOpacity}))`:Qa(o.palette.primary.main,o.palette.action.selectedOpacity+o.palette.action.focusOpacity)}},[`&.${Yj.selected}:hover`]:{backgroundColor:o.vars?`rgba(${o.vars.palette.primary.mainChannel} / calc(${o.vars.palette.action.selectedOpacity} + ${o.vars.palette.action.hoverOpacity}))`:Qa(o.palette.primary.main,o.palette.action.selectedOpacity+o.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:o.vars?`rgba(${o.vars.palette.primary.mainChannel} / ${o.vars.palette.action.selectedOpacity})`:Qa(o.palette.primary.main,o.palette.action.selectedOpacity)}},[`&.${Yj.focusVisible}`]:{backgroundColor:(o.vars||o).palette.action.focus},[`&.${Yj.disabled}`]:{opacity:(o.vars||o).palette.action.disabledOpacity},[`& + .${Kte.root}`]:{marginTop:o.spacing(1),marginBottom:o.spacing(1)},[`& + .${Kte.inset}`]:{marginLeft:52},[`& .${Jte.root}`]:{marginTop:0,marginBottom:0},[`& .${Jte.inset}`]:{paddingLeft:36},[`& .${qte.root}`]:{minWidth:36},variants:[{props:({ownerState:d})=>!d.disableGutters,style:{paddingLeft:16,paddingRight:16}},{props:({ownerState:d})=>d.divider,style:{borderBottom:`1px solid ${(o.vars||o).palette.divider}`,backgroundClip:"padding-box"}},{props:({ownerState:d})=>!d.dense,style:{[o.breakpoints.up("sm")]:{minHeight:"auto"}}},{props:({ownerState:d})=>d.dense,style:{minHeight:32,paddingTop:4,paddingBottom:4,...o.typography.body2,[`& .${qte.root} svg`]:{fontSize:"1.25rem"}}}]}))),ene=q.forwardRef(function(d,h){const g=Ec({props:d,name:"MuiMenuItem"}),{autoFocus:T=!1,component:I="li",dense:N=!1,divider:M=!1,disableGutters:k=!1,focusVisibleClassName:x,role:V="menuitem",tabIndex:K,className:Q,...ie}=g,X=q.useContext(EQ),Z=q.useMemo(()=>({dense:N||X.dense||!1,disableGutters:k}),[X.dense,N,k]),ae=q.useRef(null);HA(()=>{T&&ae.current&&ae.current.focus()},[T]);const le={...g,dense:Z.dense,divider:M,disableGutters:k},fe=u2e(g),ue=Eu(ae,h);let de;return g.disabled||(de=K!==void 0?K:-1),j.jsx(EQ.Provider,{value:Z,children:j.jsx(f2e,{ref:ue,role:V,tabIndex:de,component:I,focusVisibleClassName:Ki(fe.focusVisible,x),className:Ki(fe.root,Q),...ie,ownerState:le,classes:fe})})});function h2e(o){return _c("MuiTooltip",o)}const uo=Zo("MuiTooltip",["popper","popperInteractive","popperArrow","popperClose","tooltip","tooltipArrow","touch","tooltipPlacementLeft","tooltipPlacementRight","tooltipPlacementTop","tooltipPlacementBottom","arrow"]);function p2e(o){return Math.round(o*1e5)/1e5}const m2e=o=>{const{classes:d,disableInteractive:h,arrow:g,touch:T,placement:I}=o,N={popper:["popper",!h&&"popperInteractive",g&&"popperArrow"],tooltip:["tooltip",g&&"tooltipArrow",T&&"touch",`tooltipPlacement${Nn(I.split("-")[0])}`],arrow:["arrow"]};return tl(N,h2e,d)},g2e=wi(gle,{name:"MuiTooltip",slot:"Popper",overridesResolver:(o,d)=>{const{ownerState:h}=o;return[d.popper,!h.disableInteractive&&d.popperInteractive,h.arrow&&d.popperArrow,!h.open&&d.popperClose]}})(yd(({theme:o})=>({zIndex:(o.vars||o).zIndex.tooltip,pointerEvents:"none",variants:[{props:({ownerState:d})=>!d.disableInteractive,style:{pointerEvents:"auto"}},{props:({open:d})=>!d,style:{pointerEvents:"none"}},{props:({ownerState:d})=>d.arrow,style:{[`&[data-popper-placement*="bottom"] .${uo.arrow}`]:{top:0,marginTop:"-0.71em","&::before":{transformOrigin:"0 100%"}},[`&[data-popper-placement*="top"] .${uo.arrow}`]:{bottom:0,marginBottom:"-0.71em","&::before":{transformOrigin:"100% 0"}},[`&[data-popper-placement*="right"] .${uo.arrow}`]:{height:"1em",width:"0.71em","&::before":{transformOrigin:"100% 100%"}},[`&[data-popper-placement*="left"] .${uo.arrow}`]:{height:"1em",width:"0.71em","&::before":{transformOrigin:"0 0"}}}},{props:({ownerState:d})=>d.arrow&&!d.isRtl,style:{[`&[data-popper-placement*="right"] .${uo.arrow}`]:{left:0,marginLeft:"-0.71em"}}},{props:({ownerState:d})=>d.arrow&&!!d.isRtl,style:{[`&[data-popper-placement*="right"] .${uo.arrow}`]:{right:0,marginRight:"-0.71em"}}},{props:({ownerState:d})=>d.arrow&&!d.isRtl,style:{[`&[data-popper-placement*="left"] .${uo.arrow}`]:{right:0,marginRight:"-0.71em"}}},{props:({ownerState:d})=>d.arrow&&!!d.isRtl,style:{[`&[data-popper-placement*="left"] .${uo.arrow}`]:{left:0,marginLeft:"-0.71em"}}}]}))),_2e=wi("div",{name:"MuiTooltip",slot:"Tooltip",overridesResolver:(o,d)=>{const{ownerState:h}=o;return[d.tooltip,h.touch&&d.touch,h.arrow&&d.tooltipArrow,d[`tooltipPlacement${Nn(h.placement.split("-")[0])}`]]}})(yd(({theme:o})=>({backgroundColor:o.vars?o.vars.palette.Tooltip.bg:Qa(o.palette.grey[700],.92),borderRadius:(o.vars||o).shape.borderRadius,color:(o.vars||o).palette.common.white,fontFamily:o.typography.fontFamily,padding:"4px 8px",fontSize:o.typography.pxToRem(11),maxWidth:300,margin:2,wordWrap:"break-word",fontWeight:o.typography.fontWeightMedium,[`.${uo.popper}[data-popper-placement*="left"] &`]:{transformOrigin:"right center"},[`.${uo.popper}[data-popper-placement*="right"] &`]:{transformOrigin:"left center"},[`.${uo.popper}[data-popper-placement*="top"] &`]:{transformOrigin:"center bottom",marginBottom:"14px"},[`.${uo.popper}[data-popper-placement*="bottom"] &`]:{transformOrigin:"center top",marginTop:"14px"},variants:[{props:({ownerState:d})=>d.arrow,style:{position:"relative",margin:0}},{props:({ownerState:d})=>d.touch,style:{padding:"8px 16px",fontSize:o.typography.pxToRem(14),lineHeight:`${p2e(16/14)}em`,fontWeight:o.typography.fontWeightRegular}},{props:({ownerState:d})=>!d.isRtl,style:{[`.${uo.popper}[data-popper-placement*="left"] &`]:{marginRight:"14px"},[`.${uo.popper}[data-popper-placement*="right"] &`]:{marginLeft:"14px"}}},{props:({ownerState:d})=>!d.isRtl&&d.touch,style:{[`.${uo.popper}[data-popper-placement*="left"] &`]:{marginRight:"24px"},[`.${uo.popper}[data-popper-placement*="right"] &`]:{marginLeft:"24px"}}},{props:({ownerState:d})=>!!d.isRtl,style:{[`.${uo.popper}[data-popper-placement*="left"] &`]:{marginLeft:"14px"},[`.${uo.popper}[data-popper-placement*="right"] &`]:{marginRight:"14px"}}},{props:({ownerState:d})=>!!d.isRtl&&d.touch,style:{[`.${uo.popper}[data-popper-placement*="left"] &`]:{marginLeft:"24px"},[`.${uo.popper}[data-popper-placement*="right"] &`]:{marginRight:"24px"}}},{props:({ownerState:d})=>d.touch,style:{[`.${uo.popper}[data-popper-placement*="top"] &`]:{marginBottom:"24px"}}},{props:({ownerState:d})=>d.touch,style:{[`.${uo.popper}[data-popper-placement*="bottom"] &`]:{marginTop:"24px"}}}]}))),E2e=wi("span",{name:"MuiTooltip",slot:"Arrow"})(yd(({theme:o})=>({overflow:"hidden",position:"absolute",width:"1em",height:"0.71em",boxSizing:"border-box",color:o.vars?o.vars.palette.Tooltip.bg:Qa(o.palette.grey[700],.9),"&::before":{content:'""',margin:"auto",display:"block",width:"100%",height:"100%",backgroundColor:"currentColor",transform:"rotate(45deg)"}})));let T7=!1;const tne=new dz;let Kj={x:0,y:0};function b7(o,d){return(h,...g)=>{d&&d(h,...g),o(h,...g)}}const nne=q.forwardRef(function(d,h){const g=Ec({props:d,name:"MuiTooltip"}),{arrow:T=!1,children:I,classes:N,components:M={},componentsProps:k={},describeChild:x=!1,disableFocusListener:V=!1,disableHoverListener:K=!1,disableInteractive:Q=!1,disableTouchListener:ie=!1,enterDelay:X=100,enterNextDelay:Z=0,enterTouchDelay:ae=700,followCursor:le=!1,id:fe,leaveDelay:ue=0,leaveTouchDelay:de=1500,onClose:te,onOpen:ye,open:Te,placement:Le="bottom",PopperComponent:je,PopperProps:he={},slotProps:ke={},slots:We={},title:ze,TransitionComponent:$e,TransitionProps:et,...Oe}=g,qe=q.isValidElement(I)?I:j.jsx("span",{children:I}),lt=cz(),Ge=NZ(),[Ae,rt]=q.useState(),[yt,Lt]=q.useState(null),Pt=q.useRef(!1),_n=Q||le,Gt=hP(),zt=hP(),rn=hP(),ir=hP(),[kt,Ht]=Fwe({controlled:Te,default:!1});let Jt=kt;const tn=LZ(fe),Yn=q.useRef(),oi=tC(()=>{Yn.current!==void 0&&(document.body.style.WebkitUserSelect=Yn.current,Yn.current=void 0),ir.clear()});q.useEffect(()=>oi,[oi]);const Ri=er=>{tne.clear(),T7=!0,Ht(!0),ye&&!Jt&&ye(er)},jr=tC(er=>{tne.start(800+ue,()=>{T7=!1}),Ht(!1),te&&Jt&&te(er),Gt.start(lt.transitions.duration.shortest,()=>{Pt.current=!1})}),dr=er=>{Pt.current&&er.type!=="touchstart"||(Ae&&Ae.removeAttribute("title"),zt.clear(),rn.clear(),X||T7&&Z?zt.start(T7?Z:X,()=>{Ri(er)}):Ri(er))},Ii=er=>{zt.clear(),rn.start(ue,()=>{jr(er)})},[,sa]=q.useState(!1),ar=er=>{uG(er.target)||(sa(!1),Ii(er))},Sn=er=>{Ae||rt(er.currentTarget),uG(er.target)&&(sa(!0),dr(er))},vc=er=>{Pt.current=!0;const yc=qe.props;yc.onTouchStart&&yc.onTouchStart(er)},Zi=er=>{vc(er),rn.clear(),Gt.clear(),oi(),Yn.current=document.body.style.WebkitUserSelect,document.body.style.WebkitUserSelect="none",ir.start(ae,()=>{document.body.style.WebkitUserSelect=Yn.current,dr(er)})},bm=er=>{qe.props.onTouchEnd&&qe.props.onTouchEnd(er),oi(),rn.start(de,()=>{jr(er)})};q.useEffect(()=>{if(!Jt)return;function er(yc){yc.key==="Escape"&&jr(yc)}return document.addEventListener("keydown",er),()=>{document.removeEventListener("keydown",er)}},[jr,Jt]);const jl=Eu($5(qe),rt,h);!ze&&ze!==0&&(Jt=!1);const Tr=q.useRef(),ss=er=>{const yc=qe.props;yc.onMouseMove&&yc.onMouseMove(er),Kj={x:er.clientX,y:er.clientY},Tr.current&&Tr.current.update()},Za={},Vh=typeof ze=="string";x?(Za.title=!Jt&&Vh&&!K?ze:null,Za["aria-describedby"]=Jt?tn:null):(Za["aria-label"]=Vh?ze:null,Za["aria-labelledby"]=Jt&&!Vh?tn:null);const ec={...Za,...Oe,...qe.props,className:Ki(Oe.className,qe.props.className),onTouchStart:vc,ref:jl,...le?{onMouseMove:ss}:{}},Cf={};ie||(ec.onTouchStart=Zi,ec.onTouchEnd=bm),K||(ec.onMouseOver=b7(dr,ec.onMouseOver),ec.onMouseLeave=b7(Ii,ec.onMouseLeave),_n||(Cf.onMouseOver=dr,Cf.onMouseLeave=Ii)),V||(ec.onFocus=b7(Sn,ec.onFocus),ec.onBlur=b7(ar,ec.onBlur),_n||(Cf.onFocus=Sn,Cf.onBlur=ar));const Sc={...g,isRtl:Ge,arrow:T,disableInteractive:_n,placement:Le,PopperComponentProp:je,touch:Pt.current},Fa=typeof ke.popper=="function"?ke.popper(Sc):ke.popper,ko=q.useMemo(()=>{var yc,Ty;let er=[{name:"arrow",enabled:!!yt,options:{element:yt,padding:4}}];return(yc=he.popperOptions)!=null&&yc.modifiers&&(er=er.concat(he.popperOptions.modifiers)),(Ty=Fa==null?void 0:Fa.popperOptions)!=null&&Ty.modifiers&&(er=er.concat(Fa.popperOptions.modifiers)),{...he.popperOptions,...Fa==null?void 0:Fa.popperOptions,modifiers:er}},[yt,he.popperOptions,Fa==null?void 0:Fa.popperOptions]),wf=m2e(Sc),Cm=typeof ke.transition=="function"?ke.transition(Sc):ke.transition,Td={slots:{popper:M.Popper,transition:M.Transition??$e,tooltip:M.Tooltip,arrow:M.Arrow,...We},slotProps:{arrow:ke.arrow??k.arrow,popper:{...he,...Fa??k.popper},tooltip:ke.tooltip??k.tooltip,transition:{...et,...Cm??k.transition}}},[Su,wE]=el("popper",{elementType:g2e,externalForwardedProps:Td,ownerState:Sc,className:Ki(wf.popper,he==null?void 0:he.className)}),[RE,wm]=el("transition",{elementType:pG,externalForwardedProps:Td,ownerState:Sc}),[uC,Bh]=el("tooltip",{elementType:_2e,className:wf.tooltip,externalForwardedProps:Td,ownerState:Sc}),[Fh,yu]=el("arrow",{elementType:E2e,className:wf.arrow,externalForwardedProps:Td,ownerState:Sc,ref:Lt});return j.jsxs(q.Fragment,{children:[q.cloneElement(qe,ec),j.jsx(Su,{as:je??gle,placement:Le,anchorEl:le?{getBoundingClientRect:()=>({top:Kj.y,left:Kj.x,right:Kj.x,bottom:Kj.y,width:0,height:0})}:Ae,popperRef:Tr,open:Ae?Jt:!1,id:tn,transition:!0,...Cf,...wE,popperOptions:ko,children:({TransitionProps:er})=>j.jsx(RE,{timeout:lt.transitions.duration.shorter,...er,...wm,children:j.jsxs(uC,{...Bh,children:[ze,T?j.jsx(Fh,{...yu}):null]})})})]})}),v2e=ym(j.jsx("path",{d:"M12 14c1.66 0 2.99-1.34 2.99-3L15 5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3m5.3-3c0 3-2.54 5.1-5.3 5.1S6.7 14 6.7 11H5c0 3.41 2.72 6.23 6 6.72V21h2v-3.28c3.28-.48 6-3.3 6-6.72z"})),S2e=ym(j.jsx("path",{d:"M19 11h-1.7c0 .74-.16 1.43-.43 2.05l1.23 1.23c.56-.98.9-2.09.9-3.28m-4.02.17c0-.06.02-.11.02-.17V5c0-1.66-1.34-3-3-3S9 3.34 9 5v.18zM4.27 3 3 4.27l6.01 6.01V11c0 1.66 1.33 3 2.99 3 .22 0 .44-.03.65-.08l1.66 1.66c-.71.33-1.5.52-2.31.52-2.76 0-5.3-2.1-5.3-5.1H5c0 3.41 2.72 6.23 6 6.72V21h2v-3.28c.91-.13 1.77-.45 2.54-.9L19.73 21 21 19.73z"})),y2e=ym(j.jsx("path",{d:"M3 9v6h4l5 5V4L7 9zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02M14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77"})),T2e=ym(j.jsx("path",{d:"M16.5 12c0-1.77-1.02-3.29-2.5-4.03v2.21l2.45 2.45c.03-.2.05-.41.05-.63m2.5 0c0 .94-.2 1.82-.54 2.64l1.51 1.51C20.63 14.91 21 13.5 21 12c0-4.28-2.99-7.86-7-8.77v2.06c2.89.86 5 3.54 5 6.71M4.27 3 3 4.27 7.73 9H3v6h4l5 5v-6.73l4.25 4.25c-.67.52-1.42.93-2.25 1.18v2.06c1.38-.31 2.63-.95 3.69-1.81L19.73 21 21 19.73l-9-9zM12 4 9.91 6.09 12 8.18z"})),rne=ym(j.jsx("path",{d:"M12 9c-1.6 0-3.15.25-4.6.72v3.1c0 .39-.23.74-.56.9-.98.49-1.87 1.12-2.66 1.85-.18.18-.43.28-.7.28-.28 0-.53-.11-.71-.29L.29 13.08c-.18-.17-.29-.42-.29-.7s.11-.53.29-.71C3.34 8.78 7.46 7 12 7s8.66 1.78 11.71 4.67c.18.18.29.43.29.71s-.11.53-.29.71l-2.48 2.48c-.18.18-.43.29-.71.29-.27 0-.52-.11-.7-.28-.79-.74-1.69-1.36-2.67-1.85-.33-.16-.56-.5-.56-.9v-3.1C15.15 9.25 13.6 9 12 9"})),yle=({onEndCall:o,onToggleMute:d,localStream:h,remoteStream:g})=>(q.useEffect(()=>{if(Array.isArray(h)){const T=h.find(I=>I.getTrack&&I.getTrack().kind==="video");if(T){const I=document.getElementById("local-video");I&&T.play(I)}}if(Array.isArray(g)){const T=g.find(I=>I.getTrack&&I.getTrack().kind==="video");if(T){const I=document.getElementById("remote-video");if(I){I.innerHTML="";const N=document.createElement("div");N.style.width="100%",N.style.height="100%",I.appendChild(N),T.play(N)}}}},[h,g]),j.jsxs("div",{className:"relative w-[50%] h-full flex flex-col items-center justify-center",children:[j.jsx("div",{id:"remote-video",className:"w-full h-full bg-black rounded-md overflow-hidden"}),j.jsx("div",{id:"local-video",className:"absolute bottom-24 right-4 w-40 h-28 bg-black rounded-md overflow-hidden border border-white shadow-lg"}),j.jsxs("div",{className:"absolute bottom-4 bg-white rounded-full px-6 py-3 flex items-center justify-between gap-6 shadow-md",children:[j.jsx(l0,{className:"text-cyan-600",children:j.jsx(Ave,{size:24})}),j.jsx(l0,{className:"text-cyan-600",onClick:()=>d==null?void 0:d(!1),children:j.jsx(JEe,{size:24})}),j.jsx(l0,{className:"text-cyan-600",children:j.jsx(Rve,{size:24})}),j.jsx(l0,{onClick:o,className:"!bg-red-500 hover:!bg-red-600 !text-white !w-10 !h-10",children:j.jsx(eve,{size:24})})]})]}));function Tle({onEndCall:o,onToggleMute:d,type:h,acceptCall:g,rejectCall:T,callStatus:I,isCaller:N,receiverDetail:M,isVideo:k,localStream:x,remoteStream:V}){var te,ye;const[K,Q]=q.useState(0),[ie,X]=q.useState(!1),[Z,ae]=q.useState(!0),[le,fe]=q.useState(!1),ue=JSON.parse(localStorage.getItem("user_Data"));q.useEffect(()=>{const Te=setInterval(()=>{Q(Le=>Le+1)},1e3);return()=>clearInterval(Te)},[]),q.useEffect(()=>{I==="ongoing"&&k&&fe(!0)},[I,k]);const de=Te=>{const Le=Math.floor(Te/60),je=Te%60;return`${Le.toString().padStart(2,"0")} : ${je.toString().padStart(2,"0")} min`};return j.jsxs("div",{className:`w-full h-full rounded-2xl flex flex-col items-center justify-center py-${h!=="call_invitation"&&k?"0":"8"} bg-cover bg-center bg-no-repeat`,style:{backgroundImage:`url(${yP})`},children:[I==="calling"&&!N&&j.jsxs("p",{className:"text-lg font-semibold text-black mb-5",children:["Incoming ",k?"Video":"Audio"," Call"]}),(I==="calling"||!k)&&j.jsxs("div",{className:"relative flex items-center justify-center w-48 h-48 overflow-visible",children:[j.jsx("div",{className:"absolute inset-0 z-0",children:j.jsx("div",{className:"w-full h-full rounded-full bg-gradient-to-tr from-cyan-400 to-blue-500 blur-2xl opacity-60"})}),j.jsx("div",{className:"relative z-10 w-40 h-40 rounded-full bg-gradient-to-tr from-[#00c6ff] to-[#0072ff] p-[6px] shadow-md",children:j.jsx("div",{className:"rounded-full w-full h-full flex items-center justify-center p-[4px]",children:j.jsx("img",{src:I==="calling"&&N?(ue==null?void 0:ue.url)||"https://randomuser.me/api/portraits/men/75.jpg":((te=M==null?void 0:M.user)==null?void 0:te.url)||"https://randomuser.me/api/portraits/men/75.jpg",alt:"User",className:"rounded-full w-full h-full object-cover"})})}),j.jsx("div",{className:"absolute bottom-3 right-3 w-5 h-5 bg-green-500 rounded-full border-4 border-white z-20"})]}),I==="calling"&&N?j.jsxs(j.Fragment,{children:[j.jsx("h2",{className:"text-xl font-bold text-black",children:(ue==null?void 0:ue.name)||"Michael Dam"}),j.jsx("div",{className:"mt-4 text-center",children:j.jsx("p",{className:"text-lg font-semibold text-black",children:"Calling..."})})]}):j.jsxs(j.Fragment,{children:[h!=="call_invitation"&&!k&&j.jsx("h2",{className:"text-xl font-bold text-black",children:((ye=M==null?void 0:M.user)==null?void 0:ye.name)||"Michael Dam"}),h!=="call_invitation"&&!k&&j.jsx("div",{className:"mt-7 text-center",children:j.jsxs("p",{className:"text-gray-600 mt-1 text-sm",children:["Call Duration: ",de(K)]})}),k?j.jsxs(j.Fragment,{children:[h!=="call_invitation"&&j.jsx(yle,{onEndCall:o,onToggleMute:d,localStream:x,remoteStream:V}),h==="call_invitation"&&k&&j.jsxs("div",{className:"mt-8 bg-white rounded-full px-6 py-3 flex items-center justify-between gap-10 shadow-md w-80 sm:w-96 md:w-[400px]",children:[h==="call_invitation"&&j.jsx(l0,{onClick:g,className:"!bg-green-500 hover:!bg-green-600 !text-white !w-12 !h-12",children:j.jsx(Ree,{})}),j.jsx(l0,{onClick:()=>{o==null||o(),T==null||T()},className:"!bg-red-500 hover:!bg-red-600 !text-white !w-12 !h-12",children:j.jsx(rne,{})})]})]}):j.jsxs("div",{className:"mt-8 bg-white rounded-full px-6 py-3 flex items-center justify-between gap-10 shadow-md w-80 sm:w-96 md:w-[400px]",children:[h!=="call_invitation"&&j.jsxs(j.Fragment,{children:[j.jsx(l0,{onClick:()=>ae(!Z),children:Z?j.jsx(y2e,{className:"text-cyan-600"}):j.jsx(T2e,{className:"text-cyan-600"})}),j.jsx(l0,{onClick:()=>{const Te=!ie;X(Te),d==null||d(Te)},children:ie?j.jsx(S2e,{className:"text-cyan-600"}):j.jsx(v2e,{className:"text-cyan-600"})})]}),h==="call_invitation"&&j.jsx(l0,{onClick:g,className:"!bg-green-500 hover:!bg-green-600 !text-white !w-12 !h-12",children:j.jsx(Ree,{})}),j.jsx(l0,{onClick:()=>{o==null||o(),T==null||T()},className:"!bg-red-500 hover:!bg-red-600 !text-white !w-12 !h-12",children:j.jsx(rne,{})})]})]})]})}const b2e="cb8359241f474aca9597df671df45af1",C2e="wss://loveai-api.vrajtechnosys.in/ws/users/",sy=JSON.parse(localStorage.getItem("user_Data")),w2e=q.forwardRef(({userId:o,peerId:d,receiverId:h,isVideo:g,token:T,callStatus:I,setCallStatus:N,receiverDetail:M},k)=>{const[x]=q.useState(()=>j7.createClient({mode:"rtc",codec:"vp8"})),[V,K]=q.useState([]),[Q,ie]=q.useState(!1),[X,Z]=q.useState(null),[ae,le]=q.useState(!1),[fe,ue]=q.useState([]),[de,te]=q.useState(Math.floor(1e5+Math.random()*9e5).toString());let ye;function Te(){ye=setInterval(()=>{console.log(" Checking tracks..."),V.forEach(Ge=>{var rt;if(!((Ge==null?void 0:Ge._isClosed)||!1)){console.warn(` Track ${Ge._ID} still open. Forcing close.`);try{((rt=Ge.mediaStreamTrack)==null?void 0:rt.readyState)!=="ended"&&Ge.mediaStreamTrack.stop(),typeof Ge.stop=="function"&&Ge.stop(),typeof Ge.close=="function"&&Ge.close(),Ge._isClosed=!0}catch(yt){console.error(" Error during cleanup:",yt)}}}),V.every(Ge=>Ge._isClosed)&&(console.log(" All tracks closed. Stopping cleanup check."),clearInterval(ye))},5e3)}const Le=q.useRef(null),je=q.useRef(!1),he=d;q.useEffect(()=>{const lt=new WebSocket(`${C2e}${o}?authorization=${T}`);return Le.current=lt,lt.onmessage=async Ge=>{const Ae=JSON.parse(Ge.data);switch(Ae.type){case"call_invitation":Ae.caller_id!==o&&(Z(Ae),N("calling"));break;case"call_accepted":Ae.recepient_id===o?console.log("Receiver (you) accepted."):Ae.caller_id===h&&(console.log("Receiver accepted. Caller joining call..."),N("call_accepted"),await Oe(Ae.channel_name));break;case"call_rejected":case"call_ended":console.log("Call ended by other party"),N("idle"),await qe();break}},()=>{lt.close()}},[o]);const ke=async lt=>{var Ae;const Ge=await Ur.post("/rtc_token",{uid:de,expireTime:3600,channelName:lt});return(Ae=Ge==null?void 0:Ge.data)==null?void 0:Ae.token},We=lt=>{var Ge;((Ge=Le.current)==null?void 0:Ge.readyState)===1&&Le.current.send(JSON.stringify(lt))},ze=()=>{We({type:"call_invitation",caller_id:o,caller_name:(sy==null?void 0:sy.name)||"Unknown",recepient_id:h,call_type:g?"video":"voice",channel_name:he}),le(!0),N("calling")},$e=async()=>{Z(null),We({type:"call_accepted",caller_id:o,caller_name:(sy==null?void 0:sy.name)||"Unknown",recepient_id:h,call_type:X==null?void 0:X.call_type,channel_name:X==null?void 0:X.channel_name}),N("call_accepted"),await Oe(X==null?void 0:X.channel_name)},et=()=>{We({type:"call_rejected",caller_id:o,caller_name:(sy==null?void 0:sy.name)||"Unknown",recepient_id:h,call_type:X==null?void 0:X.call_type,channel_name:X==null?void 0:X.channel_name}),Z(null),N("idle"),qe()},Oe=async lt=>{if(!(Q||je.current)){je.current=!0;try{const Ge=await ke(lt);await x.join(b2e,lt,Ge,Number(de));let Ae,rt;if(g){[Ae,rt]=await j7.createMicrophoneAndCameraTracks(),await x.publish([Ae,rt]);const yt=document.getElementById("local-video");yt&&rt.play(yt),K([Ae,rt])}else Ae=await j7.createMicrophoneAudioTrack(),await x.publish([Ae]),K([Ae]);ie(!0),x.on("user-published",async(yt,Lt)=>{if(await x.subscribe(yt,Lt),Lt==="video"){const Pt=document.getElementById("remote-video");Pt&&yt.videoTrack.play(Pt)}Lt==="audio"&&yt.audioTrack.play(),ue(Pt=>[...Pt,yt])}),x.on("user-unpublished",(yt,Lt)=>{if(Lt==="video"){const Pt=document.getElementById("remote-video");Pt&&(Pt.innerHTML="")}}),x.on("user-left",yt=>{ue(Lt=>Lt.filter(Pt=>Pt.uid!==yt.uid))})}catch(Ge){console.error("Join error:",Ge)}finally{je.current=!1}}},qe=async()=>{for(const Ae of V)Ae.stop(),Ae.close();const lt=document.getElementById("local-video");lt&&(lt.innerHTML="");const Ge=document.getElementById("remote-video");Ge&&(Ge.innerHTML=""),await x.leave(),x.removeAllListeners(),V&&(console.log(V,"localTrackslocalTrackslocalTrackslocalTracks"),V.forEach(Ae=>{var rt;(rt=Ae==null?void 0:Ae.mediaStreamTrack)!=null&&rt.stop&&Ae.mediaStreamTrack.stop(),Ae._isClosed||(Ae.stop(),Ae.close())})),Te(),K([]),ue([]),ie(!1),Z(null),le(!1),N("idle"),window.location.reload()};return q.useImperativeHandle(k,()=>({startCall:ze,leaveCall:qe,mute:()=>{const lt=V.find(Ge=>Ge.getTrackLabel().toLowerCase().includes("microphone"));lt&&lt.setEnabled(!1)},unmute:()=>{const lt=V.find(Ge=>Ge.getTrackLabel().toLowerCase().includes("microphone"));lt&&lt.setEnabled(!0)},stopCamera:()=>{const lt=V.find(Ge=>Ge.getTrackLabel().toLowerCase().includes("camera"));lt&&lt.setEnabled(!1),lt&&lt.stop()}})),j.jsx("div",{children:(X||I!=="idle")&&j.jsxs("div",{className:"fixed top-0 left-0 py-2 w-full h-full bg-[#000000b8] bg-opacity-50 flex items-end sm:items-center justify-center z-50",children:[j.jsx("div",{className:"bg-transparent p-6 rounded-2xl shadow-xl w-full h-full m-8 flex flex-col items-center justify-center",style:{animation:"slideUp 0.4s ease-out"},children:j.jsx(Tle,{onEndCall:()=>{We({type:"call_ended",caller_id:o,recepient_id:h,call_type:g?"video":"voice",channel_name:he}),qe()},userId:o,type:X==null?void 0:X.type,isCaller:ae,receiverDetail:M,callStatus:I,acceptCall:$e,rejectCall:et,isVideo:g,onToggleMute:lt=>{var Ge;(Ge=V[0])==null||Ge.setEnabled(!lt)}})}),j.jsx("style",{children:`
                @keyframes slideUp {
                  0% { transform: translateY(100%); opacity: 0; }
                  100% { transform: translateY(0); opacity: 1; }
                }
              `})]})})}),R2e="wss://loveai-api.vrajtechnosys.in/ws/chat/";function I2e({rooms:o,selectedId:d,setSelectedId:h,setResiverDetail:g}){return j.jsxs("div",{className:"w-80 bg-white border-r border-gray-200 flex flex-col",children:[j.jsx("div",{className:"p-4 font-semibold text-lg",children:"Messages"}),j.jsx("div",{className:"flex justify-center pb-2 ",children:j.jsx("input",{type:"text",placeholder:"Search Message",className:"w-full max-w-[290px] px-3 py-1.5 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400 bg-[#F3F3F3]"})}),j.jsx("div",{className:"flex-1 overflow-y-auto custom-scroll",children:o.map(T=>{var I,N;return j.jsxs("div",{onClick:()=>{g(T),h(T.chat_room_id)},className:`flex items-center gap-3 px-4 py-3 cursor-pointer transition-all rounded-xl m-2 ${d===T.chat_room_id?"bg-[#E8F8FF]":"hover:bg-gray-50"}`,children:[j.jsx("img",{src:((I=T.user)==null?void 0:I.url)||yP,className:"w-10 h-10  object-cover  rounded-lg"}),j.jsxs("div",{className:"flex-1",children:[j.jsx("div",{className:"font-medium text-sm",children:(N=T.user)==null?void 0:N.name}),j.jsx("div",{className:"text-xs text-gray-500 truncate",children:T.lastMessage})]}),j.jsx("div",{className:"text-xs text-gray-400 pl-2 min-w-[60px] text-right",children:new Date(T==null?void 0:T.last_updated).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]},T.chat_room_id)})})]})}function A2e({room:o,loading:d,onSend:h,resiverDetail:g,userId:T,handleVoiceCallFunc:I,handleVideoCallFunc:N,setCurrentRoom:M,selectedId:k,setSelectedId:x,setLoading:V,setRooms:K,countMessage:Q,totalCount:ie,setTotalCount:X}){var Lt,Pt,_n,Gt;const[Z,ae]=q.useState(""),[le,fe]=q.useState(!1),[ue,de]=q.useState([]),te=q.useRef(null),{token:ye}=JSON.parse(localStorage.getItem("user_Data")||"{}"),[Te,Le]=q.useState("idle"),[je,he]=q.useState(!0),[ke,We]=q.useState(!1),[ze,$e]=q.useState(0),et=q.useRef(),[Oe,qe]=q.useState(!1),lt=q.useRef(0),Ge=()=>{var zt;(zt=et.current)==null||zt.startCall(),Le("calling")};q.useEffect(()=>{Oe&&te.current&&(lt.current=te.current.scrollHeight)},[Oe]),q.useEffect(()=>{if(Oe&&te.current){const zt=te.current,rn=zt.scrollHeight,ir=lt.current;zt.scrollTop=rn-ir,qe(!1)}},[o==null?void 0:o.chat,Oe]),q.useEffect(()=>{!d&&!Oe&&te.current&&(te.current.scrollTop=te.current.scrollHeight)},[o==null?void 0:o.chat,d,Oe]);const Ae=q.useCallback(()=>{var rn;if(!k)return;qe(!0),Ur.get(`/chatrooms/${k}/chats?start=${ze===0?(rn=o==null?void 0:o.chat)==null?void 0:rn.length:Q<ze?Q:ze}&limit=25`,{headers:{token:ye}}).then(ir=>{if(X(ir.data.count),ir.data.list.length>0){const kt=ir.data.list.map(Jt=>({message:Jt.message,isMe:Jt.sender.id===T,message_type:Jt.message_type||"Msg",id:Jt.id}));K(Jt=>Jt.map(tn=>tn.chat_room_id===k?{...tn,chat:[...tn.chat||[],...kt]}:tn));const Ht=kt.filter(Jt=>!o.chat.some(tn=>tn.id===Jt.id));M({chat:[...o.chat,...Ht],log:""})}}).catch(console.error)},[k,o,ye,T,M,ze,Q,K]);q.useEffect(()=>{const zt=te.current;if(!zt)return;const rn=()=>{var Ri;const Ht=zt.scrollTop,Jt=zt.scrollHeight,tn=zt.clientHeight,Yn=Ht<=10,oi=Jt-Ht-tn<=10;ie!==((Ri=o.chat)==null?void 0:Ri.length)&&Yn&&!oi&&!d&&k&&!Oe&&Ae()};return zt.addEventListener("scroll",rn),()=>zt.removeEventListener("scroll",rn)},[d,k,Ae,Oe]),q.useEffect(()=>{We(!1)},[k]),q.useEffect(()=>{const zt=te.current;if(!zt)return;const rn=()=>{const Ht=zt.scrollTop,Jt=zt.scrollHeight,tn=zt.clientHeight,Yn=Ht<=50,oi=Jt-Ht-tn<=50;Yn&&!oi&&!d&&k&&Ae()};return zt.addEventListener("scroll",rn),()=>zt.removeEventListener("scroll",rn)},[d,k,Ae]),q.useEffect(()=>{We(!1)},[k]);const rt=zt=>{ae(rn=>rn+zt.emoji),fe(!1)},yt=async()=>{if(Z.trim()&&(h(Z,"Msg"),ae("")),ue.length>0){const zt=new FormData;ue.forEach(rn=>zt.append("files",rn));try{const ir=(await Ur.post("/chats/media",zt,{headers:{token:ye,"Content-Type":"multipart/form-data"}})).data;for(const kt of ir){const Ht=kt.path.split(".").pop().toLowerCase();let Jt="File";["jpg","jpeg","png","webp"].includes(Ht)?Jt="Image":["gif"].includes(Ht)?Jt="Gif":["mp4","mov","avi","webm"].includes(Ht)&&(Jt="Video"),Jt==="Image"?h(kt.url,Jt,kt.path):h(kt.url,Jt)}de([])}catch(rn){console.error("Media upload failed:",rn)}}};return d||!o?j.jsx("div",{className:"flex-1 flex items-center justify-center text-gray-400",children:"Loading"}):j.jsxs("div",{className:"flex flex-col h-full w-full bg-white overflow-hidden",children:[j.jsxs("div",{className:"flex items-center gap-3 border-b px-6 py-4 bg-white",children:[j.jsx("img",{src:((Lt=g==null?void 0:g.user)==null?void 0:Lt.url)||yP,className:"w-10 h-10 rounded-full object-cover"}),j.jsxs("div",{className:"flex-1",children:[j.jsx("div",{className:"font-semibold",children:(Pt=g==null?void 0:g.user)==null?void 0:Pt.name}),j.jsx("div",{className:"text-xs text-green-500",children:(_n=g==null?void 0:g.user)!=null&&_n.is_online?"Online":"Offline"})]}),j.jsxs("div",{className:"flex gap-2 items-center",children:[j.jsx("button",{className:"w-10 h-10 flex items-center justify-center rounded-md bg-[linear-gradient(95.88deg,_rgba(255,197,197,0.2)_-2.12%)]",onClick:()=>{he(!0),Ge()},children:j.jsx("img",{src:qve,alt:"video call"})}),j.jsx("button",{className:"w-10 h-10 flex items-center justify-center rounded-md bg-[linear-gradient(108.95deg, rgba(76, 200, 42, 0.16) -1.3%)]",onClick:()=>{he(!1),Ge()},children:j.jsx("img",{src:Jve,alt:"Call Button"})}),j.jsx(w2e,{ref:et,peerId:g==null?void 0:g.chat_room_id,userId:T,receiverId:(Gt=g==null?void 0:g.user)==null?void 0:Gt.id,receiverDetail:g,isVideo:je,token:ye,callStatus:Te,setCallStatus:Le})]})]}),j.jsx("div",{ref:te,className:"flex-1 w-full px-6 py-4 space-y-3 overflow-y-auto custom-scroll max-h-[calc(100vh-180px)]",children:[...o.chat||[]].reverse().map((zt,rn)=>{var kt,Ht,Jt;const ir=rn==0||((kt=o.chat[rn-1])==null?void 0:kt.isMe)===(zt==null?void 0:zt.isMe);return console.log(ir,"showAvatarshowAvatarshowAvatar",(Ht=o.chat[rn-1])==null?void 0:Ht.isMe,zt==null?void 0:zt.isMe),j.jsxs("div",{className:`flex gap-2 ${zt.isMe?"justify-end":"justify-start"} items-end`,children:[!ir&&j.jsx("img",{src:((Jt=g==null?void 0:g.user)==null?void 0:Jt.url)||yP,className:"w-8 h-8 rounded-full object-cover"}),j.jsx("div",{className:`text-sm sm:text-base rounded-xl px-4 py-2 shadow ${zt.isMe?"bg-[#979797] text-white":"bg-gray-100 text-gray-900"} max-w-[75%] sm:max-w-[65%] break-words whitespace-pre-wrap`,children:["Image","Gif"].includes(zt.message_type)?j.jsx("div",{className:"overflow-hidden border max-w-[250px] bg-white shadow-md border-[#00A3E0]",children:j.jsx("img",{src:zt.message||Oee,alt:"chat-media",className:"object-contain h-[200px] w-full",onError:tn=>{tn.target.onerror=null,tn.target.src=Oee}})}):zt.message_type==="Video"?j.jsx("video",{controls:!0,className:"rounded-md max-w-full",children:j.jsx("source",{src:zt.message,type:"video/mp4"})}):zt.message_type==="File"?j.jsx("a",{href:zt.message,target:"_blank",rel:"noopener noreferrer",className:"underline",children:"Download File"}):zt.message})]},rn)})}),ue.length>0&&j.jsx("div",{className:"flex gap-2 px-4 pb-2 overflow-x-auto",children:ue.map((zt,rn)=>{const ir=URL.createObjectURL(zt);return zt.type.startsWith("image/")?j.jsx("img",{src:ir,className:"w-16 h-16 rounded object-cover",alt:"preview"},rn):zt.type.startsWith("video/")?j.jsx("video",{src:ir,className:"w-16 h-16 rounded",muted:!0},rn):j.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded flex items-center justify-center text-sm",children:""},rn)})}),j.jsxs("div",{className:"border-t px-4 py-3 flex items-center bg-white gap-2 relative",children:[j.jsx("img",{src:"https://icons.getbootstrap.com/assets/icons/emoji-smile.svg",alt:"emoji",className:"w-6 h-6 cursor-pointer",onClick:()=>fe(!le)}),le&&j.jsx("div",{className:"absolute bottom-14 left-2 z-50",children:j.jsx(Sbe,{onEmojiClick:rt})}),j.jsx("input",{type:"file",id:"media-upload",className:"hidden",multiple:!0,onChange:zt=>{const rn=Array.from(zt.target.files||[]);de(ir=>[...ir,...rn])}}),j.jsx("button",{onClick:()=>document.getElementById("media-upload").click(),className:"p-2 rounded-full",children:j.jsx(QEe,{})}),j.jsx("input",{type:"text",placeholder:"Type a message",className:"flex-1 px-4 py-2 text-sm rounded-full border border-gray-200 shadow-sm focus:outline-none",value:Z,onChange:zt=>ae(zt.target.value),onKeyDown:zt=>{zt.key==="Enter"&&!zt.shiftKey&&(zt.preventDefault(),yt())}}),j.jsx("button",{onClick:yt,className:"p-2 rounded-full bg-blue-500 hover:bg-blue-600 text-white shadow-md",children:j.jsx(cve,{size:18})})]})]})}function O2e(){var je;const[o,d]=q.useState([]),[h,g]=q.useState(null),[T,I]=q.useState(null),[N,M]=q.useState({chat:[],log:""}),[k,x]=q.useState(!1),V=q.useRef(null),[K,Q]=q.useState(null),[ie,X]=q.useState(!1),[Z,ae]=q.useState(!1),[le,fe]=q.useState(0),ue=()=>{X(!0)},de=()=>{ae(!0)},{token:te,id:ye}=JSON.parse(localStorage.getItem("user_Data")||"{}");q.useEffect(()=>{Ur.get("/chatrooms").then(he=>{const ke=he.data.list.map(We=>{var ze;return{...We,lastMessage:((ze=We.last_message)==null?void 0:ze.message)||"",chat:[]}});d(ke),ke[0]&&(g(ke[0].chat_room_id),I(ke[0]))}).catch(console.error)},[]);const Te=q.useCallback(he=>{V.current&&V.current.close();const ke=`${R2e}${he}?authorization=${te}`,We=new WebSocket(ke);V.current=We,We.onmessage=ze=>{try{const $e=JSON.parse(ze.data),{from:et,message:Oe,room_id:qe,message_type:lt}=$e,Ge=et===String(ye);d(Ae=>Ae.map(rt=>rt.chat_room_id===qe?{...rt,chat:[{message:Oe,isMe:Ge,message_type:lt},...rt.chat],lastMessage:Oe}:rt)),qe===h&&M(Ae=>({...Ae,chat:[{message:Oe,isMe:Ge,message_type:lt},...Ae.chat]}))}catch($e){console.error("WebSocket message error:",$e)}}},[te,ye,h]),Le=q.useCallback((he,ke="Msg",We=null)=>{if(!V.current||V.current.readyState!==1)return;const ze={to:T.user.id,message:he,file:ke==="Image"?he:null,file_path:We,message_type:ke};V.current.send(JSON.stringify(ze)),M($e=>({...$e,chat:[{message:he,isMe:!0,message_type:ke},...$e.chat]})),d($e=>$e.map(et=>et.chat_room_id===h?{...et,chat:[{message:he,isMe:!0,message_type:ke},...et.chat],lastMessage:he}:et))},[h,(je=T==null?void 0:T.user)==null?void 0:je.id]);return q.useEffect(()=>{h&&(x(!0),Ur.get(`/chatrooms/${h}/chats?start=0&limit=30`,{headers:{token:te}}).then(he=>{const ke=he.data.list.map(We=>({message:We.message,isMe:We.sender.id===ye,message_type:We.message_type||"Msg",id:We.id}));fe(he.data.count),d(We=>We.map(ze=>ze.chat_room_id===h?{...ze,chat:ke}:ze)),M({chat:ke,log:""})}).catch(console.error).finally(()=>x(!1)),Te(h))},[h,te,ye,Te]),q.useEffect(()=>()=>{var he;return(he=V.current)==null?void 0:he.close()},[]),j.jsxs("div",{className:"flex bg-gray-100 h-screen",children:[j.jsx(I2e,{rooms:o,selectedId:h,setSelectedId:g,setResiverDetail:I}),j.jsx(A2e,{room:N,loading:k,onSend:Le,resiverDetail:T,userId:ye,handleVideoCallFunc:de,handleVoiceCallFunc:ue,setCurrentRoom:M,selectedId:h,setSelectedId:g,setLoading:x,setRooms:d,countMessage:le,totalCount:K,setTotalCount:Q})]})}const N2e="/assets/LOGO-C5MVvTcy.svg",L2e="data:image/svg+xml,%3csvg%20width='17'%20height='17'%20viewBox='0%200%2017%2017'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M1.05176%2015.8813H15.7432C15.752%2015.8813%2015.7606%2015.8838%2015.7686%2015.8871L15.7891%2015.9008C15.8014%2015.9132%2015.8086%2015.9302%2015.8086%2015.9477C15.8086%2015.9565%2015.807%2015.9651%2015.8037%2015.9731L15.7891%2015.9946C15.7768%2016.0066%2015.7604%2016.0131%2015.7432%2016.0131H1.05176C1.04326%2016.0131%201.03507%2016.0114%201.02734%2016.0082L1.00586%2015.9946C0.993517%2015.9822%200.986347%2015.9651%200.986328%2015.9477L0.991211%2015.9223L1.00586%2015.9008C1.01809%2015.8887%201.03455%2015.8814%201.05176%2015.8813ZM12.1279%201.7309C13.1973%200.658368%2014.6559%200.548068%2015.5068%201.21136L15.6689%201.35394L15.6719%201.35687C16.1172%201.79508%2016.2855%202.41432%2016.2061%203.0766C16.1359%203.66032%2015.8745%204.24585%2015.4805%204.69769L15.3037%204.88324L15.2949%204.89105L7.68164%2012.5121L7.67871%2012.5151L7.66504%2012.5229L7.65332%2012.5258L3.44922%2013.6557C3.4383%2013.6581%203.42682%2013.6586%203.41602%2013.6557L3.38574%2013.6381L3.36719%2013.6078V13.5717L4.49707%209.36957V9.36859L4.51172%209.3432L4.51465%209.34027L12.1279%201.7309Z'%20stroke='white'/%3e%3c/svg%3e",D2e="data:image/svg+xml,%3csvg%20width='18'%20height='17'%20viewBox='0%200%2018%2017'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M8.10682%209.28107C6.54643%209.28107%205.121%208.491%204.29472%207.16763C3.8503%206.45657%203.61328%205.63358%203.61328%204.79083C3.61328%203.58597%204.08403%202.45683%204.93665%201.60421C5.78598%200.761469%206.91183%200.297302%208.10682%200.297302H8.13315C9.32814%200.303886%2010.454%200.777929%2011.3%201.63384C12.1461%202.48975%2012.6069%203.62219%2012.6004%204.81717C12.5938%205.65004%2012.36%206.45986%2011.9189%207.16434C11.0926%208.491%209.66721%209.28107%208.10682%209.28107ZM8.10682%201.23222C7.15873%201.23222%206.2699%201.60092%205.59834%202.26919C4.92019%202.94075%204.5482%203.83946%204.5482%204.79413C4.5482%205.46239%204.73584%206.1142%205.08808%206.67713C5.74319%207.72727%206.87233%208.35274%208.11011%208.35274C9.3446%208.35274%2010.4737%207.72727%2011.1321%206.67713C11.4811%206.12079%2011.6654%205.47885%2011.672%204.81717C11.6786%203.86908%2011.3132%202.97367%2010.6416%202.29552C9.97007%201.61738%209.08124%201.2388%208.13315%201.23551C8.11999%201.23222%208.1134%201.23222%208.10682%201.23222ZM14.3517%2016.5135C13.1534%2016.5135%2012.0769%2015.651%2011.5403%2014.7984C11.3033%2014.4198%2011.3033%2013.9096%2011.5403%2013.531C12.0769%2012.6784%2013.1534%2011.8159%2014.3517%2011.8159C15.55%2011.8159%2016.6264%2012.6784%2017.163%2013.531C17.4%2013.9096%2017.4%2014.4198%2017.163%2014.7984C16.6264%2015.651%2015.5467%2016.5135%2014.3517%2016.5135ZM14.3517%2012.7475C13.5155%2012.7475%2012.7189%2013.4092%2012.3304%2014.0248C12.2843%2014.1005%2012.2843%2014.2223%2012.3304%2014.298C12.7189%2014.9136%2013.5155%2015.5753%2014.3517%2015.5753C15.1878%2015.5753%2015.9845%2014.9136%2016.373%2014.298C16.419%2014.2223%2016.419%2014.1005%2016.373%2014.0248C15.9845%2013.4092%2015.1878%2012.7475%2014.3517%2012.7475Z'%20fill='url(%23paint0_linear_4754_4671)'/%3e%3cpath%20d='M14.3521%2015.2886C13.7299%2015.2886%2013.2263%2014.7816%2013.2263%2014.1627C13.2263%2013.5405%2013.7332%2013.0369%2014.3521%2013.0369C14.9743%2013.0369%2015.478%2013.5438%2015.478%2014.1627C15.478%2014.7849%2014.971%2015.2886%2014.3521%2015.2886ZM14.3521%2013.9685C14.2468%2013.9685%2014.1579%2014.0541%2014.1579%2014.1627C14.1579%2014.2681%2014.2435%2014.3569%2014.3521%2014.3569C14.4575%2014.3569%2014.5464%2014.2714%2014.5464%2014.1627C14.5464%2014.0574%2014.4575%2013.9685%2014.3521%2013.9685ZM8.10726%2015.9865C5.5494%2015.9865%203.10676%2015.1997%201.03611%2013.7117C0.591699%2013.3924%200.387597%2012.8163%200.532443%2012.2797C0.720086%2011.5851%201.00649%2010.9168%201.37848%2010.298C2.53396%208.37874%204.86797%207.50966%207.05383%208.1878C7.39291%208.29314%207.74844%208.34582%208.11056%208.34582C8.46938%208.34582%208.82491%208.29314%209.16728%208.1878C11.0338%207.60842%2013.0584%208.16147%2014.3258%209.59347C14.441%209.72515%2014.4739%209.91279%2014.4081%2010.0741C14.3423%2010.2387%2014.1908%2010.3506%2014.0163%2010.3671C12.0708%2010.5383%2010.5466%2012.204%2010.5466%2014.1594C10.5466%2014.5117%2010.596%2014.8606%2010.6882%2015.1964C10.7244%2015.3215%2010.7046%2015.4598%2010.6355%2015.5684C10.5664%2015.6803%2010.4544%2015.756%2010.3228%2015.7791C9.59523%2015.9206%208.85125%2015.9865%208.10726%2015.9865ZM5.5527%208.89557C4.18653%208.89557%202.89608%209.5836%202.17843%2010.7819C1.84923%2011.3283%201.59904%2011.9143%201.43444%2012.5266C1.39165%2012.6879%201.4509%2012.8624%201.58258%2012.9579C3.49192%2014.3306%205.74692%2015.0548%208.10726%2015.0548C8.63069%2015.0548%209.15411%2015.0186%209.67424%2014.9462C9.63144%2014.6894%209.6084%2014.4261%209.6084%2014.1627C9.6084%2012.971%2010.0528%2011.8287%2010.8593%2010.9531C11.4387%2010.3243%2012.1663%209.87%2012.9662%209.62639C11.9687%208.91862%2010.6618%208.70135%209.43722%209.07992C9.00597%209.2116%208.55826%209.28073%208.10726%209.28073C7.65297%209.28073%207.20526%209.2116%206.77402%209.07992C6.3691%208.95483%205.95761%208.89557%205.5527%208.89557Z'%20fill='url(%23paint1_linear_4754_4671)'/%3e%3cdefs%3e%3clinearGradient%20id='paint0_linear_4754_4671'%20x1='3.5877'%20y1='1.91892'%20x2='16.6924'%20y2='1.35908'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20stop-color='%2300A3E0'/%3e%3cstop%20offset='0.854647'%20stop-color='%2300D4FF'/%3e%3c/linearGradient%3e%3clinearGradient%20id='paint1_linear_4754_4671'%20x1='0.458392'%20y1='8.76206'%20x2='14.6697'%20y2='7.42263'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20stop-color='%2300A3E0'/%3e%3cstop%20offset='0.854647'%20stop-color='%2300D4FF'/%3e%3c/linearGradient%3e%3c/defs%3e%3c/svg%3e",P2e="data:image/svg+xml,%3csvg%20width='11'%20height='11'%20viewBox='0%200%2011%2011'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20clip-path='url(%23clip0_4754_4678)'%3e%3cpath%20d='M10.2392%204.42176C10.098%204.32695%209.97057%204.21321%209.86035%204.08374C9.86858%203.90353%209.90484%203.7257%209.96783%203.55666C10.0861%203.15562%2010.2337%202.65672%209.9495%202.26645C9.66304%201.87297%209.14031%201.85991%208.72025%201.84914C8.5435%201.85622%208.36667%201.83722%208.19546%201.79276C8.1014%201.64512%208.02959%201.48443%207.98233%201.31587C7.84208%200.916659%207.66746%200.419826%207.19996%200.267888C6.74621%200.120305%206.33898%200.400576%205.97988%200.64693C5.83554%200.762171%205.67348%200.853262%205.5%200.916659C5.32642%200.853328%205.16428%200.762233%205.0199%200.64693C4.66125%200.400346%204.25379%200.120992%203.80027%200.268117C3.33277%200.420055%203.15815%200.916659%203.0179%201.31587C2.97068%201.48359%202.8996%201.64366%202.80683%201.79116C2.63507%201.83699%202.45736%201.85653%202.27975%201.84914C1.85969%201.85991%201.33696%201.8732%201.05073%202.26668C0.766563%202.65718%200.913917%203.15585%201.0324%203.55689C1.09464%203.72508%201.13118%203.90168%201.14079%204.08076C1.03092%204.21208%200.902819%204.32699%200.760375%204.42199C0.421667%204.68026%200%205.00201%200%205.49999C0%205.99797%200.421667%206.31972%200.760833%206.57822C0.901972%206.67304%201.02943%206.78677%201.13965%206.91624C1.13142%207.09645%201.09516%207.27428%201.03217%207.44333C0.913917%207.84437%200.766333%208.34326%201.0505%208.73353C1.33696%209.12678%201.85969%209.14008%202.27975%209.15085C2.4565%209.14377%202.63333%209.16276%202.80454%209.20722C2.8986%209.35487%202.97041%209.51555%203.01767%209.68412C3.15815%2010.0833%203.33254%2010.5802%203.80027%2010.7321C3.8831%2010.7594%203.96974%2010.7733%204.05694%2010.7733C4.40894%2010.7733%204.73023%2010.5522%205.02035%2010.3531C5.16462%2010.2378%205.3266%2010.1467%205.5%2010.0833C5.6735%2010.1467%205.83556%2010.2378%205.97988%2010.3531C6.33898%2010.5996%206.74621%2010.8788%207.19996%2010.7321C7.66746%2010.5802%207.84208%2010.0836%207.98233%209.68435C8.02948%209.51663%208.10048%209.35657%208.19317%209.20905C8.36493%209.16323%208.54264%209.14368%208.72025%209.15108C9.14031%209.1403%209.66327%209.12701%209.9495%208.73353C10.2337%208.34303%2010.0863%207.84437%209.96783%207.44333C9.90559%207.27514%209.86905%207.09853%209.85944%206.91945C9.96923%206.78815%2010.0973%206.67324%2010.2396%206.57822C10.5783%206.31972%2011%205.99797%2011%205.49999C11%205.00201%2010.5783%204.68026%2010.2392%204.42176ZM7.54279%204.67843L5.25112%206.9701C5.16517%207.05602%205.04862%207.10429%204.92708%207.10429C4.80555%207.10429%204.68899%207.05602%204.60304%206.9701L3.45721%205.82426C3.41462%205.78171%203.38084%205.73118%203.35778%205.67557C3.33472%205.61996%203.32285%205.56036%203.32282%205.50015C3.3228%205.43995%203.33464%205.38034%203.35766%205.32471C3.38068%205.26908%203.41443%205.21853%203.45698%205.17595C3.49953%205.13337%203.55006%205.09958%203.60567%205.07652C3.66128%205.05347%203.72089%205.04159%203.78109%205.04157C3.84129%205.04154%203.90091%205.05338%203.95653%205.0764C4.01216%205.09942%204.06271%205.13317%204.10529%205.17572L4.92708%205.99774L6.89471%204.03012C6.93699%203.98634%206.98756%203.95142%207.04348%203.9274C7.0994%203.90338%207.15954%203.89074%207.2204%203.89021C7.28126%203.88968%207.34161%203.90128%207.39794%203.92432C7.45426%203.94737%207.50544%203.9814%207.54847%204.02444C7.59151%204.06747%207.62554%204.11864%207.64859%204.17497C7.67163%204.2313%207.68323%204.29165%207.6827%204.35251C7.68217%204.41337%207.66953%204.47351%207.6455%204.52943C7.62148%204.58535%207.58657%204.63592%207.54279%204.6782V4.67843Z'%20fill='url(%23paint0_linear_4754_4678)'/%3e%3c/g%3e%3cdefs%3e%3clinearGradient%20id='paint0_linear_4754_4678'%20x1='-0.020498'%20y1='1.28157'%20x2='10.4705'%20y2='0.729363'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20stop-color='%2300A3E0'/%3e%3cstop%20offset='0.854647'%20stop-color='%2300D4FF'/%3e%3c/linearGradient%3e%3cclipPath%20id='clip0_4754_4678'%3e%3crect%20width='11'%20height='11'%20fill='white'/%3e%3c/clipPath%3e%3c/defs%3e%3c/svg%3e",ble=q.createContext(),M2e=({children:o})=>{const[d,h]=q.useState(!1),[g,T]=q.useState(null);return j.jsx(ble.Provider,{value:{ShowAbout:d,setShowAbout:h,aboutData:g,setAboutData:T},children:o})},Cle=()=>q.useContext(ble),ine=[{label:"Home",icon:j.jsx(kEe,{size:18}),navigate:"/dashboard/home"},{label:"Matches",icon:j.jsx(PEe,{size:18}),navigate:"/dashboard/matches"},{label:"Messages",icon:j.jsx(WEe,{size:18}),navigate:"/dashboard/messages"},{label:"Personal Information",icon:j.jsx(OA,{size:18}),navigate:"/dashboard/personalInfo"},{label:"Privacy & Permission",icon:j.jsx(jEe,{size:18})},{label:"Security",icon:j.jsx(fve,{size:18})},{label:"Data & Storage",icon:j.jsx(yEe,{size:18})},{label:"Feedback",icon:j.jsx(KEe,{size:18})},{label:"Language",icon:j.jsx(IEe,{size:18})},{label:"About Love AI",icon:j.jsx(Zse,{size:18}),disabled:!0}],k2e=()=>{const{setShowAbout:o,setAboutData:d}=Cle(),[h,g]=q.useState(()=>{const Z=ine.findIndex(ae=>ae.navigate===location.pathname);return Z!==-1?Z:0}),[T,I]=q.useState(null),N=xl(),M=q.useRef(null),k=JSON.parse(localStorage.getItem("user_Data"))||{},x=k==null?void 0:k.id,V=k.name||"Michael Dam",K=k.email||"michaeldam@loveai.com",Q=T||k.url||yP,ie=()=>{M.current.click()},X=Z=>{const ae=Z.target.files[0];if(!ae||!x)return;const le=new FileReader;le.onloadend=async()=>{var de;I(le.result);const fe=localStorage.getItem("access_token"),ue=new FormData;ue.append("file",ae);try{const te=await Ur.put(`/users/${x}/media?media=Profile`,ue,{headers:{token:fe,"Content-Type":"multipart/form-data"}}),ye=((de=te==null?void 0:te.data)==null?void 0:de.url)||le.result,Te={...k,url:ye};localStorage.setItem("user_Data",JSON.stringify(Te)),I(ye),alert(" Profile image updated.")}catch(te){console.error("Upload failed:",te.response||te),alert("Failed to update profile image.")}},le.readAsDataURL(ae)};return j.jsxs("div",{className:"h-screen w-72 bg-[linear-gradient(90deg,_#00D4FF_0%,_#00A3E0_100%)] text-white flex flex-col rounded-r-[30px] shadow-xl sidebar-con overflow-auto",children:[j.jsx("div",{className:"flex flex-col items-center pt-6",children:j.jsx("img",{src:N2e,alt:"Logo",className:"mb-6"})}),j.jsxs("div",{className:"relative flex flex-col items-center mb-4",children:[j.jsxs("div",{className:"rounded-full p-[5px] bg-[#90e6ff] w-[100px] h-[100px] flex items-center justify-center shadow-md relative",children:[j.jsx("img",{src:Q,alt:"Profile",className:"w-[84px] h-[84px] rounded-full object-cover border-2 border-white"}),j.jsx("div",{className:"absolute bottom-2 right-2 w-4 h-4 bg-green-500 rounded-full border-[3px] border-white"})]}),j.jsx("div",{className:"absolute top-1 right-[calc(50%-55px)] bg-[#FF6D9E] p-[6px] rounded-full shadow-md cursor-pointer",onClick:ie,children:j.jsx("img",{src:L2e,alt:"pencil"})}),j.jsx("input",{type:"file",accept:"image/*",ref:M,style:{display:"none"},onChange:X}),j.jsx("div",{className:"absolute bottom-0 right-[calc(50%-50px)] bg-white text-[#00A3E0] p-[6px] rounded-full shadow-md",children:j.jsx("img",{src:D2e,alt:"user icon"})})]}),j.jsxs("div",{className:"text-center mb-2",children:[j.jsxs("div",{className:"flex items-center justify-center gap-1 font-semibold",children:[V,j.jsx("div",{className:"bg-white rounded-full p-1",children:j.jsx("img",{src:P2e,alt:"verified icon",className:"w-3 h-3"})})]}),j.jsx("p",{className:"text-xs text-white/90",children:K})]}),j.jsx("div",{className:"flex flex-col w-full",style:{padding:"10px 0px 0px 20px"},children:ine.map((Z,ae)=>j.jsx("div",{onClick:()=>{Z.disabled||(o(!1),d(null),g(ae),Z.navigate&&N(Z.navigate))},className:`${h===ae?"bg-black/5 rounded-l-2xl":"text-white/90"} ${h-1===ae?"bg-black/5":""} ${h+1===ae?"bg-black/5":""}`,children:j.jsxs("div",{className:`group flex items-center gap-3 px-4 py-4 cursor-pointer transition-all duration-300 relative overflow-hidden pl-10 shadow-none sidebar-text
          ${h===ae?"rounded-l-2xl":"bg-[linear-gradient(90deg,_#00D4FF_0%,_#00A3E0_100%)] text-white/90"}
          ${h-1===ae?"bg-[linear-gradient(90deg,_#00D4FF_0%,_#00A3E0_100%)] rounded-br-4xl":""}
          ${h+1===ae?"bg-[linear-gradient(90deg,_#00D4FF_0%,_#00A3E0_100%)] rounded-tr-4xl":""}
        `,children:[j.jsx("span",{className:"z-10",children:Z.icon}),j.jsx("span",{className:"z-10 text-sm font-medium",children:Z.label})]})},ae))}),j.jsx("div",{className:"px-6 py-4",children:j.jsxs("button",{className:"w-full flex items-center justify-center gap-2 py-2 rounded-full bg-white text-red-500 font-semibold hover:bg-red-100 transition",onClick:()=>{localStorage.clear(),N("/login")},children:[j.jsx(BEe,{size:16}),"Log Out"]})})]})};var qj={},Jj={},ane={},sne={},dq,one;function $o(){return one||(one=1,dq=function(o){try{return!!o()}catch{return!0}}),dq}var uq,cne;function wle(){if(cne)return uq;cne=1;var o=$o();return uq=!o(function(){return Object.isExtensible(Object.preventExtensions({}))}),uq}var Xj,lne;function Ul(){if(lne)return Xj;lne=1;var o=function(d){return d&&d.Math===Math&&d};return Xj=o(typeof globalThis=="object"&&globalThis)||o(typeof window=="object"&&window)||o(typeof self=="object"&&self)||o(typeof r5=="object"&&r5)||o(typeof Xj=="object"&&Xj)||function(){return this}()||Function("return this")(),Xj}var fq,dne;function GZ(){if(dne)return fq;dne=1;var o=$o();return fq=!o(function(){var d=(function(){}).bind();return typeof d!="function"||d.hasOwnProperty("prototype")}),fq}var hq,une;function Mo(){if(une)return hq;une=1;var o=GZ(),d=Function.prototype,h=d.call,g=o&&d.bind.bind(h,h);return hq=o?g:function(T){return function(){return h.apply(T,arguments)}},hq}var pq,fne;function nl(){if(fne)return pq;fne=1;var o=typeof document=="object"&&document.all;return pq=typeof o>"u"&&o!==void 0?function(d){return typeof d=="function"||d===o}:function(d){return typeof d=="function"},pq}var mq={},gq,hne;function g0(){if(hne)return gq;hne=1;var o=$o();return gq=!o(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),gq}var _q,pne;function vu(){if(pne)return _q;pne=1;var o=nl();return _q=function(d){return typeof d=="object"?d!==null:o(d)},_q}var Eq,mne;function zZ(){if(mne)return Eq;mne=1;var o=Ul(),d=vu(),h=o.document,g=d(h)&&d(h.createElement);return Eq=function(T){return g?h.createElement(T):{}},Eq}var vq,gne;function Rle(){if(gne)return vq;gne=1;var o=g0(),d=$o(),h=zZ();return vq=!o&&!d(function(){return Object.defineProperty(h("div"),"a",{get:function(){return 7}}).a!==7}),vq}var Sq,_ne;function Ile(){if(_ne)return Sq;_ne=1;var o=g0(),d=$o();return Sq=o&&d(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),Sq}var yq,Ene;function bE(){if(Ene)return yq;Ene=1;var o=vu(),d=String,h=TypeError;return yq=function(g){if(o(g))return g;throw new h(d(g)+" is not an object")},yq}var Tq,vne;function lC(){if(vne)return Tq;vne=1;var o=GZ(),d=Function.prototype.call;return Tq=o?d.bind(d):function(){return d.apply(d,arguments)},Tq}var bq,Sne;function fz(){if(Sne)return bq;Sne=1;var o=Ul(),d=nl(),h=function(g){return d(g)?g:void 0};return bq=function(g,T){return arguments.length<2?h(o[g]):o[g]&&o[g][T]},bq}var Cq,yne;function HZ(){if(yne)return Cq;yne=1;var o=Mo();return Cq=o({}.isPrototypeOf),Cq}var wq,Tne;function hz(){if(Tne)return wq;Tne=1;var o=Ul(),d=o.navigator,h=d&&d.userAgent;return wq=h?String(h):"",wq}var Rq,bne;function Ale(){if(bne)return Rq;bne=1;var o=Ul(),d=hz(),h=o.process,g=o.Deno,T=h&&h.versions||g&&g.version,I=T&&T.v8,N,M;return I&&(N=I.split("."),M=N[0]>0&&N[0]<4?1:+(N[0]+N[1])),!M&&d&&(N=d.match(/Edge\/(\d+)/),(!N||N[1]>=74)&&(N=d.match(/Chrome\/(\d+)/),N&&(M=+N[1]))),Rq=M,Rq}var Iq,Cne;function Ole(){if(Cne)return Iq;Cne=1;var o=Ale(),d=$o(),h=Ul(),g=h.String;return Iq=!!Object.getOwnPropertySymbols&&!d(function(){var T=Symbol("symbol detection");return!g(T)||!(Object(T)instanceof Symbol)||!Symbol.sham&&o&&o<41}),Iq}var Aq,wne;function Nle(){if(wne)return Aq;wne=1;var o=Ole();return Aq=o&&!Symbol.sham&&typeof Symbol.iterator=="symbol",Aq}var Oq,Rne;function Lle(){if(Rne)return Oq;Rne=1;var o=fz(),d=nl(),h=HZ(),g=Nle(),T=Object;return Oq=g?function(I){return typeof I=="symbol"}:function(I){var N=o("Symbol");return d(N)&&h(N.prototype,T(I))},Oq}var Nq,Ine;function pz(){if(Ine)return Nq;Ine=1;var o=String;return Nq=function(d){try{return o(d)}catch{return"Object"}},Nq}var Lq,Ane;function GP(){if(Ane)return Lq;Ane=1;var o=nl(),d=pz(),h=TypeError;return Lq=function(g){if(o(g))return g;throw new h(d(g)+" is not a function")},Lq}var Dq,One;function eV(){return One||(One=1,Dq=function(o){return o==null}),Dq}var Pq,Nne;function WZ(){if(Nne)return Pq;Nne=1;var o=GP(),d=eV();return Pq=function(h,g){var T=h[g];return d(T)?void 0:o(T)},Pq}var Mq,Lne;function x2e(){if(Lne)return Mq;Lne=1;var o=lC(),d=nl(),h=vu(),g=TypeError;return Mq=function(T,I){var N,M;if(I==="string"&&d(N=T.toString)&&!h(M=o(N,T))||d(N=T.valueOf)&&!h(M=o(N,T))||I!=="string"&&d(N=T.toString)&&!h(M=o(N,T)))return M;throw new g("Can't convert object to primitive value")},Mq}var kq={exports:{}},xq,Dne;function tV(){return Dne||(Dne=1,xq=!1),xq}var Uq,Pne;function YZ(){if(Pne)return Uq;Pne=1;var o=Ul(),d=Object.defineProperty;return Uq=function(h,g){try{d(o,h,{value:g,configurable:!0,writable:!0})}catch{o[h]=g}return g},Uq}var Mne;function KZ(){if(Mne)return kq.exports;Mne=1;var o=tV(),d=Ul(),h=YZ(),g="__core-js_shared__",T=kq.exports=d[g]||h(g,{});return(T.versions||(T.versions=[])).push({version:"3.43.0",mode:o?"pure":"global",copyright:" 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.43.0/LICENSE",source:"https://github.com/zloirock/core-js"}),kq.exports}var jq,kne;function Dle(){if(kne)return jq;kne=1;var o=KZ();return jq=function(d,h){return o[d]||(o[d]=h||{})},jq}var Vq,xne;function mz(){if(xne)return Vq;xne=1;var o=eV(),d=TypeError;return Vq=function(h){if(o(h))throw new d("Can't call method on "+h);return h},Vq}var Bq,Une;function gz(){if(Une)return Bq;Une=1;var o=mz(),d=Object;return Bq=function(h){return d(o(h))},Bq}var Fq,jne;function Tm(){if(jne)return Fq;jne=1;var o=Mo(),d=gz(),h=o({}.hasOwnProperty);return Fq=Object.hasOwn||function(T,I){return h(d(T),I)},Fq}var Gq,Vne;function qZ(){if(Vne)return Gq;Vne=1;var o=Mo(),d=0,h=Math.random(),g=o(1.1.toString);return Gq=function(T){return"Symbol("+(T===void 0?"":T)+")_"+g(++d+h,36)},Gq}var zq,Bne;function jh(){if(Bne)return zq;Bne=1;var o=Ul(),d=Dle(),h=Tm(),g=qZ(),T=Ole(),I=Nle(),N=o.Symbol,M=d("wks"),k=I?N.for||N:N&&N.withoutSetter||g;return zq=function(x){return h(M,x)||(M[x]=T&&h(N,x)?N[x]:k("Symbol."+x)),M[x]},zq}var Hq,Fne;function U2e(){if(Fne)return Hq;Fne=1;var o=lC(),d=vu(),h=Lle(),g=WZ(),T=x2e(),I=jh(),N=TypeError,M=I("toPrimitive");return Hq=function(k,x){if(!d(k)||h(k))return k;var V=g(k,M),K;if(V){if(x===void 0&&(x="default"),K=o(V,k,x),!d(K)||h(K))return K;throw new N("Can't convert object to primitive value")}return x===void 0&&(x="number"),T(k,x)},Hq}var Wq,Gne;function Ple(){if(Gne)return Wq;Gne=1;var o=U2e(),d=Lle();return Wq=function(h){var g=o(h,"string");return d(g)?g:g+""},Wq}var zne;function CE(){if(zne)return mq;zne=1;var o=g0(),d=Rle(),h=Ile(),g=bE(),T=Ple(),I=TypeError,N=Object.defineProperty,M=Object.getOwnPropertyDescriptor,k="enumerable",x="configurable",V="writable";return mq.f=o?h?function(Q,ie,X){if(g(Q),ie=T(ie),g(X),typeof Q=="function"&&ie==="prototype"&&"value"in X&&V in X&&!X[V]){var Z=M(Q,ie);Z&&Z[V]&&(Q[ie]=X.value,X={configurable:x in X?X[x]:Z[x],enumerable:k in X?X[k]:Z[k],writable:!1})}return N(Q,ie,X)}:N:function(Q,ie,X){if(g(Q),ie=T(ie),g(X),d)try{return N(Q,ie,X)}catch{}if("get"in X||"set"in X)throw new I("Accessors not supported");return"value"in X&&(Q[ie]=X.value),Q},mq}var Yq={exports:{}},Kq,Hne;function Mle(){if(Hne)return Kq;Hne=1;var o=g0(),d=Tm(),h=Function.prototype,g=o&&Object.getOwnPropertyDescriptor,T=d(h,"name"),I=T&&(function(){}).name==="something",N=T&&(!o||o&&g(h,"name").configurable);return Kq={EXISTS:T,PROPER:I,CONFIGURABLE:N},Kq}var qq,Wne;function kle(){if(Wne)return qq;Wne=1;var o=Mo(),d=nl(),h=KZ(),g=o(Function.toString);return d(h.inspectSource)||(h.inspectSource=function(T){return g(T)}),qq=h.inspectSource,qq}var Jq,Yne;function xle(){if(Yne)return Jq;Yne=1;var o=Ul(),d=nl(),h=o.WeakMap;return Jq=d(h)&&/native code/.test(String(h)),Jq}var Xq,Kne;function _z(){return Kne||(Kne=1,Xq=function(o,d){return{enumerable:!(o&1),configurable:!(o&2),writable:!(o&4),value:d}}),Xq}var Qq,qne;function Ez(){if(qne)return Qq;qne=1;var o=g0(),d=CE(),h=_z();return Qq=o?function(g,T,I){return d.f(g,T,h(1,I))}:function(g,T,I){return g[T]=I,g},Qq}var Zq,Jne;function JZ(){if(Jne)return Zq;Jne=1;var o=Dle(),d=qZ(),h=o("keys");return Zq=function(g){return h[g]||(h[g]=d(g))},Zq}var $q,Xne;function vz(){return Xne||(Xne=1,$q={}),$q}var eJ,Qne;function Sz(){if(Qne)return eJ;Qne=1;var o=xle(),d=Ul(),h=vu(),g=Ez(),T=Tm(),I=KZ(),N=JZ(),M=vz(),k="Object already initialized",x=d.TypeError,V=d.WeakMap,K,Q,ie,X=function(fe){return ie(fe)?Q(fe):K(fe,{})},Z=function(fe){return function(ue){var de;if(!h(ue)||(de=Q(ue)).type!==fe)throw new x("Incompatible receiver, "+fe+" required");return de}};if(o||I.state){var ae=I.state||(I.state=new V);ae.get=ae.get,ae.has=ae.has,ae.set=ae.set,K=function(fe,ue){if(ae.has(fe))throw new x(k);return ue.facade=fe,ae.set(fe,ue),ue},Q=function(fe){return ae.get(fe)||{}},ie=function(fe){return ae.has(fe)}}else{var le=N("state");M[le]=!0,K=function(fe,ue){if(T(fe,le))throw new x(k);return ue.facade=fe,g(fe,le,ue),ue},Q=function(fe){return T(fe,le)?fe[le]:{}},ie=function(fe){return T(fe,le)}}return eJ={set:K,get:Q,has:ie,enforce:X,getterFor:Z},eJ}var Zne;function Ule(){if(Zne)return Yq.exports;Zne=1;var o=Mo(),d=$o(),h=nl(),g=Tm(),T=g0(),I=Mle().CONFIGURABLE,N=kle(),M=Sz(),k=M.enforce,x=M.get,V=String,K=Object.defineProperty,Q=o("".slice),ie=o("".replace),X=o([].join),Z=T&&!d(function(){return K(function(){},"length",{value:8}).length!==8}),ae=String(String).split("String"),le=Yq.exports=function(fe,ue,de){Q(V(ue),0,7)==="Symbol("&&(ue="["+ie(V(ue),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),de&&de.getter&&(ue="get "+ue),de&&de.setter&&(ue="set "+ue),(!g(fe,"name")||I&&fe.name!==ue)&&(T?K(fe,"name",{value:ue,configurable:!0}):fe.name=ue),Z&&de&&g(de,"arity")&&fe.length!==de.arity&&K(fe,"length",{value:de.arity});try{de&&g(de,"constructor")&&de.constructor?T&&K(fe,"prototype",{writable:!1}):fe.prototype&&(fe.prototype=void 0)}catch{}var te=k(fe);return g(te,"source")||(te.source=X(ae,typeof ue=="string"?ue:"")),fe};return Function.prototype.toString=le(function(){return h(this)&&x(this).source||N(this)},"toString"),Yq.exports}var tJ,$ne;function nV(){if($ne)return tJ;$ne=1;var o=nl(),d=CE(),h=Ule(),g=YZ();return tJ=function(T,I,N,M){M||(M={});var k=M.enumerable,x=M.name!==void 0?M.name:I;if(o(N)&&h(N,x,M),M.global)k?T[I]=N:g(I,N);else{try{M.unsafe?T[I]&&(k=!0):delete T[I]}catch{}k?T[I]=N:d.f(T,I,{value:N,enumerable:!1,configurable:!M.nonConfigurable,writable:!M.nonWritable})}return T},tJ}var nJ,ere;function jle(){if(ere)return nJ;ere=1;var o=nV();return nJ=function(d,h,g){for(var T in h)o(d,T,h[T],g);return d},nJ}var rJ={exports:{}},iJ={},aJ={},tre;function j2e(){if(tre)return aJ;tre=1;var o={}.propertyIsEnumerable,d=Object.getOwnPropertyDescriptor,h=d&&!o.call({1:2},1);return aJ.f=h?function(T){var I=d(this,T);return!!I&&I.enumerable}:o,aJ}var sJ,nre;function zP(){if(nre)return sJ;nre=1;var o=Mo(),d=o({}.toString),h=o("".slice);return sJ=function(g){return h(d(g),8,-1)},sJ}var oJ,rre;function Vle(){if(rre)return oJ;rre=1;var o=Mo(),d=$o(),h=zP(),g=Object,T=o("".split);return oJ=d(function(){return!g("z").propertyIsEnumerable(0)})?function(I){return h(I)==="String"?T(I,""):g(I)}:g,oJ}var cJ,ire;function HP(){if(ire)return cJ;ire=1;var o=Vle(),d=mz();return cJ=function(h){return o(d(h))},cJ}var are;function Ble(){if(are)return iJ;are=1;var o=g0(),d=lC(),h=j2e(),g=_z(),T=HP(),I=Ple(),N=Tm(),M=Rle(),k=Object.getOwnPropertyDescriptor;return iJ.f=o?k:function(V,K){if(V=T(V),K=I(K),M)try{return k(V,K)}catch{}if(N(V,K))return g(!d(h.f,V,K),V[K])},iJ}var lJ={},dJ,sre;function V2e(){if(sre)return dJ;sre=1;var o=Math.ceil,d=Math.floor;return dJ=Math.trunc||function(g){var T=+g;return(T>0?d:o)(T)},dJ}var uJ,ore;function Fle(){if(ore)return uJ;ore=1;var o=V2e();return uJ=function(d){var h=+d;return h!==h||h===0?0:o(h)},uJ}var fJ,cre;function B2e(){if(cre)return fJ;cre=1;var o=Fle(),d=Math.max,h=Math.min;return fJ=function(g,T){var I=o(g);return I<0?d(I+T,0):h(I,T)},fJ}var hJ,lre;function F2e(){if(lre)return hJ;lre=1;var o=Fle(),d=Math.min;return hJ=function(h){var g=o(h);return g>0?d(g,9007199254740991):0},hJ}var pJ,dre;function yz(){if(dre)return pJ;dre=1;var o=F2e();return pJ=function(d){return o(d.length)},pJ}var mJ,ure;function G2e(){if(ure)return mJ;ure=1;var o=HP(),d=B2e(),h=yz(),g=function(T){return function(I,N,M){var k=o(I),x=h(k);if(x===0)return!T&&-1;var V=d(M,x),K;if(T&&N!==N){for(;x>V;)if(K=k[V++],K!==K)return!0}else for(;x>V;V++)if((T||V in k)&&k[V]===N)return T||V||0;return!T&&-1}};return mJ={includes:g(!0),indexOf:g(!1)},mJ}var gJ,fre;function Gle(){if(fre)return gJ;fre=1;var o=Mo(),d=Tm(),h=HP(),g=G2e().indexOf,T=vz(),I=o([].push);return gJ=function(N,M){var k=h(N),x=0,V=[],K;for(K in k)!d(T,K)&&d(k,K)&&I(V,K);for(;M.length>x;)d(k,K=M[x++])&&(~g(V,K)||I(V,K));return V},gJ}var _J,hre;function XZ(){return hre||(hre=1,_J=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]),_J}var pre;function QZ(){if(pre)return lJ;pre=1;var o=Gle(),d=XZ(),h=d.concat("length","prototype");return lJ.f=Object.getOwnPropertyNames||function(T){return o(T,h)},lJ}var EJ={},mre;function z2e(){return mre||(mre=1,EJ.f=Object.getOwnPropertySymbols),EJ}var vJ,gre;function H2e(){if(gre)return vJ;gre=1;var o=fz(),d=Mo(),h=QZ(),g=z2e(),T=bE(),I=d([].concat);return vJ=o("Reflect","ownKeys")||function(M){var k=h.f(T(M)),x=g.f;return x?I(k,x(M)):k},vJ}var SJ,_re;function W2e(){if(_re)return SJ;_re=1;var o=Tm(),d=H2e(),h=Ble(),g=CE();return SJ=function(T,I,N){for(var M=d(I),k=g.f,x=h.f,V=0;V<M.length;V++){var K=M[V];!o(T,K)&&!(N&&o(N,K))&&k(T,K,x(I,K))}},SJ}var yJ,Ere;function zle(){if(Ere)return yJ;Ere=1;var o=$o(),d=nl(),h=/#|\.prototype\./,g=function(k,x){var V=I[T(k)];return V===M?!0:V===N?!1:d(x)?o(x):!!x},T=g.normalize=function(k){return String(k).replace(h,".").toLowerCase()},I=g.data={},N=g.NATIVE="N",M=g.POLYFILL="P";return yJ=g,yJ}var TJ,vre;function $A(){if(vre)return TJ;vre=1;var o=Ul(),d=Ble().f,h=Ez(),g=nV(),T=YZ(),I=W2e(),N=zle();return TJ=function(M,k){var x=M.target,V=M.global,K=M.stat,Q,ie,X,Z,ae,le;if(V?ie=o:K?ie=o[x]||T(x,{}):ie=o[x]&&o[x].prototype,ie)for(X in k){if(ae=k[X],M.dontCallGetSet?(le=d(ie,X),Z=le&&le.value):Z=ie[X],Q=N(V?X:x+(K?".":"#")+X,M.forced),!Q&&Z!==void 0){if(typeof ae==typeof Z)continue;I(ae,Z)}(M.sham||Z&&Z.sham)&&h(ae,"sham",!0),g(ie,X,ae,M)}},TJ}var bJ={},CJ,Sre;function Hle(){if(Sre)return CJ;Sre=1;var o=Mo();return CJ=o([].slice),CJ}var yre;function Y2e(){if(yre)return bJ;yre=1;var o=zP(),d=HP(),h=QZ().f,g=Hle(),T=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],I=function(N){try{return h(N)}catch{return g(T)}};return bJ.f=function(M){return T&&o(M)==="Window"?I(M):h(d(M))},bJ}var wJ,Tre;function K2e(){if(Tre)return wJ;Tre=1;var o=$o();return wJ=o(function(){if(typeof ArrayBuffer=="function"){var d=new ArrayBuffer(8);Object.isExtensible(d)&&Object.defineProperty(d,"a",{value:8})}}),wJ}var RJ,bre;function q2e(){if(bre)return RJ;bre=1;var o=$o(),d=vu(),h=zP(),g=K2e(),T=Object.isExtensible,I=o(function(){});return RJ=I||g?function(M){return!d(M)||g&&h(M)==="ArrayBuffer"?!1:T?T(M):!0}:T,RJ}var Cre;function ZZ(){if(Cre)return rJ.exports;Cre=1;var o=$A(),d=Mo(),h=vz(),g=vu(),T=Tm(),I=CE().f,N=QZ(),M=Y2e(),k=q2e(),x=qZ(),V=wle(),K=!1,Q=x("meta"),ie=0,X=function(de){I(de,Q,{value:{objectID:"O"+ie++,weakData:{}}})},Z=function(de,te){if(!g(de))return typeof de=="symbol"?de:(typeof de=="string"?"S":"P")+de;if(!T(de,Q)){if(!k(de))return"F";if(!te)return"E";X(de)}return de[Q].objectID},ae=function(de,te){if(!T(de,Q)){if(!k(de))return!0;if(!te)return!1;X(de)}return de[Q].weakData},le=function(de){return V&&K&&k(de)&&!T(de,Q)&&X(de),de},fe=function(){ue.enable=function(){},K=!0;var de=N.f,te=d([].splice),ye={};ye[Q]=1,de(ye).length&&(N.f=function(Te){for(var Le=de(Te),je=0,he=Le.length;je<he;je++)if(Le[je]===Q){te(Le,je,1);break}return Le},o({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:M.f}))},ue=rJ.exports={enable:fe,fastKey:Z,getWeakData:ae,onFreeze:le};return h[Q]=!0,rJ.exports}var IJ,wre;function J2e(){if(wre)return IJ;wre=1;var o=zP(),d=Mo();return IJ=function(h){if(o(h)==="Function")return d(h)},IJ}var AJ,Rre;function Wle(){if(Rre)return AJ;Rre=1;var o=J2e(),d=GP(),h=GZ(),g=o(o.bind);return AJ=function(T,I){return d(T),I===void 0?T:h?g(T,I):function(){return T.apply(I,arguments)}},AJ}var OJ,Ire;function rV(){return Ire||(Ire=1,OJ={}),OJ}var NJ,Are;function X2e(){if(Are)return NJ;Are=1;var o=jh(),d=rV(),h=o("iterator"),g=Array.prototype;return NJ=function(T){return T!==void 0&&(d.Array===T||g[h]===T)},NJ}var LJ,Ore;function Q2e(){if(Ore)return LJ;Ore=1;var o=jh(),d=o("toStringTag"),h={};return h[d]="z",LJ=String(h)==="[object z]",LJ}var DJ,Nre;function $Z(){if(Nre)return DJ;Nre=1;var o=Q2e(),d=nl(),h=zP(),g=jh(),T=g("toStringTag"),I=Object,N=h(function(){return arguments}())==="Arguments",M=function(k,x){try{return k[x]}catch{}};return DJ=o?h:function(k){var x,V,K;return k===void 0?"Undefined":k===null?"Null":typeof(V=M(x=I(k),T))=="string"?V:N?h(x):(K=h(x))==="Object"&&d(x.callee)?"Arguments":K},DJ}var PJ,Lre;function Yle(){if(Lre)return PJ;Lre=1;var o=$Z(),d=WZ(),h=eV(),g=rV(),T=jh(),I=T("iterator");return PJ=function(N){if(!h(N))return d(N,I)||d(N,"@@iterator")||g[o(N)]},PJ}var MJ,Dre;function Z2e(){if(Dre)return MJ;Dre=1;var o=lC(),d=GP(),h=bE(),g=pz(),T=Yle(),I=TypeError;return MJ=function(N,M){var k=arguments.length<2?T(N):M;if(d(k))return h(o(k,N));throw new I(g(N)+" is not iterable")},MJ}var kJ,Pre;function Kle(){if(Pre)return kJ;Pre=1;var o=lC(),d=bE(),h=WZ();return kJ=function(g,T,I){var N,M;d(g);try{if(N=h(g,"return"),!N){if(T==="throw")throw I;return I}N=o(N,g)}catch(k){M=!0,N=k}if(T==="throw")throw I;if(M)throw N;return d(N),I},kJ}var xJ,Mre;function e$(){if(Mre)return xJ;Mre=1;var o=Wle(),d=lC(),h=bE(),g=pz(),T=X2e(),I=yz(),N=HZ(),M=Z2e(),k=Yle(),x=Kle(),V=TypeError,K=function(ie,X){this.stopped=ie,this.result=X},Q=K.prototype;return xJ=function(ie,X,Z){var ae=Z&&Z.that,le=!!(Z&&Z.AS_ENTRIES),fe=!!(Z&&Z.IS_RECORD),ue=!!(Z&&Z.IS_ITERATOR),de=!!(Z&&Z.INTERRUPTED),te=o(X,ae),ye,Te,Le,je,he,ke,We,ze=function(et){return ye&&x(ye,"normal"),new K(!0,et)},$e=function(et){return le?(h(et),de?te(et[0],et[1],ze):te(et[0],et[1])):de?te(et,ze):te(et)};if(fe)ye=ie.iterator;else if(ue)ye=ie;else{if(Te=k(ie),!Te)throw new V(g(ie)+" is not iterable");if(T(Te)){for(Le=0,je=I(ie);je>Le;Le++)if(he=$e(ie[Le]),he&&N(Q,he))return he;return new K(!1)}ye=M(ie,Te)}for(ke=fe?ie.next:ye.next;!(We=d(ke,ye)).done;){try{he=$e(We.value)}catch(et){x(ye,"throw",et)}if(typeof he=="object"&&he&&N(Q,he))return he}return new K(!1)},xJ}var UJ,kre;function t$(){if(kre)return UJ;kre=1;var o=HZ(),d=TypeError;return UJ=function(h,g){if(o(g,h))return h;throw new d("Incorrect invocation")},UJ}var jJ,xre;function $2e(){if(xre)return jJ;xre=1;var o=jh(),d=o("iterator"),h=!1;try{var g=0,T={next:function(){return{done:!!g++}},return:function(){h=!0}};T[d]=function(){return this},Array.from(T,function(){throw 2})}catch{}return jJ=function(I,N){try{if(!N&&!h)return!1}catch{return!1}var M=!1;try{var k={};k[d]=function(){return{next:function(){return{done:M=!0}}}},I(k)}catch{}return M},jJ}var VJ,Ure;function Tz(){if(Ure)return VJ;Ure=1;var o=CE().f,d=Tm(),h=jh(),g=h("toStringTag");return VJ=function(T,I,N){T&&!N&&(T=T.prototype),T&&!d(T,g)&&o(T,g,{configurable:!0,value:I})},VJ}var BJ,jre;function eOe(){if(jre)return BJ;jre=1;var o=Mo(),d=GP();return BJ=function(h,g,T){try{return o(d(Object.getOwnPropertyDescriptor(h,g)[T]))}catch{}},BJ}var FJ,Vre;function tOe(){if(Vre)return FJ;Vre=1;var o=vu();return FJ=function(d){return o(d)||d===null},FJ}var GJ,Bre;function nOe(){if(Bre)return GJ;Bre=1;var o=tOe(),d=String,h=TypeError;return GJ=function(g){if(o(g))return g;throw new h("Can't set "+d(g)+" as a prototype")},GJ}var zJ,Fre;function qle(){if(Fre)return zJ;Fre=1;var o=eOe(),d=vu(),h=mz(),g=nOe();return zJ=Object.setPrototypeOf||("__proto__"in{}?function(){var T=!1,I={},N;try{N=o(Object.prototype,"__proto__","set"),N(I,[]),T=I instanceof Array}catch{}return function(k,x){return h(k),g(x),d(k)&&(T?N(k,x):k.__proto__=x),k}}():void 0),zJ}var HJ,Gre;function rOe(){if(Gre)return HJ;Gre=1;var o=nl(),d=vu(),h=qle();return HJ=function(g,T,I){var N,M;return h&&o(N=T.constructor)&&N!==I&&d(M=N.prototype)&&M!==I.prototype&&h(g,M),g},HJ}var WJ,zre;function iOe(){if(zre)return WJ;zre=1;var o=$A(),d=Ul(),h=Mo(),g=zle(),T=nV(),I=ZZ(),N=e$(),M=t$(),k=nl(),x=eV(),V=vu(),K=$o(),Q=$2e(),ie=Tz(),X=rOe();return WJ=function(Z,ae,le){var fe=Z.indexOf("Map")!==-1,ue=Z.indexOf("Weak")!==-1,de=fe?"set":"add",te=d[Z],ye=te&&te.prototype,Te=te,Le={},je=function(Oe){var qe=h(ye[Oe]);T(ye,Oe,Oe==="add"?function(Ge){return qe(this,Ge===0?0:Ge),this}:Oe==="delete"?function(lt){return ue&&!V(lt)?!1:qe(this,lt===0?0:lt)}:Oe==="get"?function(Ge){return ue&&!V(Ge)?void 0:qe(this,Ge===0?0:Ge)}:Oe==="has"?function(Ge){return ue&&!V(Ge)?!1:qe(this,Ge===0?0:Ge)}:function(Ge,Ae){return qe(this,Ge===0?0:Ge,Ae),this})},he=g(Z,!k(te)||!(ue||ye.forEach&&!K(function(){new te().entries().next()})));if(he)Te=le.getConstructor(ae,Z,fe,de),I.enable();else if(g(Z,!0)){var ke=new Te,We=ke[de](ue?{}:-0,1)!==ke,ze=K(function(){ke.has(1)}),$e=Q(function(Oe){new te(Oe)}),et=!ue&&K(function(){for(var Oe=new te,qe=5;qe--;)Oe[de](qe,qe);return!Oe.has(-0)});$e||(Te=ae(function(Oe,qe){M(Oe,ye);var lt=X(new te,Oe,Te);return x(qe)||N(qe,lt[de],{that:lt,AS_ENTRIES:fe}),lt}),Te.prototype=ye,ye.constructor=Te),(ze||et)&&(je("delete"),je("has"),fe&&je("get")),(et||We)&&je(de),ue&&ye.clear&&delete ye.clear}return Le[Z]=Te,o({global:!0,constructor:!0,forced:Te!==te},Le),ie(Te,Z),ue||le.setStrong(Te,Z,fe),Te},WJ}var YJ,Hre;function aOe(){if(Hre)return YJ;Hre=1;var o=zP();return YJ=Array.isArray||function(h){return o(h)==="Array"},YJ}var KJ,Wre;function sOe(){if(Wre)return KJ;Wre=1;var o=Mo(),d=$o(),h=nl(),g=$Z(),T=fz(),I=kle(),N=function(){},M=T("Reflect","construct"),k=/^\s*(?:class|function)\b/,x=o(k.exec),V=!k.test(N),K=function(X){if(!h(X))return!1;try{return M(N,[],X),!0}catch{return!1}},Q=function(X){if(!h(X))return!1;switch(g(X)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return V||!!x(k,I(X))}catch{return!0}};return Q.sham=!0,KJ=!M||d(function(){var ie;return K(K.call)||!K(Object)||!K(function(){ie=!0})||ie})?Q:K,KJ}var qJ,Yre;function oOe(){if(Yre)return qJ;Yre=1;var o=aOe(),d=sOe(),h=vu(),g=jh(),T=g("species"),I=Array;return qJ=function(N){var M;return o(N)&&(M=N.constructor,d(M)&&(M===I||o(M.prototype))?M=void 0:h(M)&&(M=M[T],M===null&&(M=void 0))),M===void 0?I:M},qJ}var JJ,Kre;function cOe(){if(Kre)return JJ;Kre=1;var o=oOe();return JJ=function(d,h){return new(o(d))(h===0?0:h)},JJ}var XJ,qre;function lOe(){if(qre)return XJ;qre=1;var o=Wle(),d=Mo(),h=Vle(),g=gz(),T=yz(),I=cOe(),N=d([].push),M=function(k){var x=k===1,V=k===2,K=k===3,Q=k===4,ie=k===6,X=k===7,Z=k===5||ie;return function(ae,le,fe,ue){for(var de=g(ae),te=h(de),ye=T(te),Te=o(le,fe),Le=0,je=ue||I,he=x?je(ae,ye):V||X?je(ae,0):void 0,ke,We;ye>Le;Le++)if((Z||Le in te)&&(ke=te[Le],We=Te(ke,Le,de),k))if(x)he[Le]=We;else if(We)switch(k){case 3:return!0;case 5:return ke;case 6:return Le;case 2:N(he,ke)}else switch(k){case 4:return!1;case 7:N(he,ke)}return ie?-1:K||Q?Q:he}};return XJ={forEach:M(0),map:M(1),filter:M(2),some:M(3),every:M(4),find:M(5),findIndex:M(6),filterReject:M(7)},XJ}var QJ,Jre;function dOe(){if(Jre)return QJ;Jre=1;var o=Mo(),d=jle(),h=ZZ().getWeakData,g=t$(),T=bE(),I=eV(),N=vu(),M=e$(),k=lOe(),x=Tm(),V=Sz(),K=V.set,Q=V.getterFor,ie=k.find,X=k.findIndex,Z=o([].splice),ae=0,le=function(de){return de.frozen||(de.frozen=new fe)},fe=function(){this.entries=[]},ue=function(de,te){return ie(de.entries,function(ye){return ye[0]===te})};return fe.prototype={get:function(de){var te=ue(this,de);if(te)return te[1]},has:function(de){return!!ue(this,de)},set:function(de,te){var ye=ue(this,de);ye?ye[1]=te:this.entries.push([de,te])},delete:function(de){var te=X(this.entries,function(ye){return ye[0]===de});return~te&&Z(this.entries,te,1),!!~te}},QJ={getConstructor:function(de,te,ye,Te){var Le=de(function(We,ze){g(We,je),K(We,{type:te,id:ae++,frozen:null}),I(ze)||M(ze,We[Te],{that:We,AS_ENTRIES:ye})}),je=Le.prototype,he=Q(te),ke=function(We,ze,$e){var et=he(We),Oe=h(T(ze),!0);return Oe===!0?le(et).set(ze,$e):Oe[et.id]=$e,We};return d(je,{delete:function(We){var ze=he(this);if(!N(We))return!1;var $e=h(We);return $e===!0?le(ze).delete(We):$e&&x($e,ze.id)&&delete $e[ze.id]},has:function(ze){var $e=he(this);if(!N(ze))return!1;var et=h(ze);return et===!0?le($e).has(ze):et&&x(et,$e.id)}}),d(je,ye?{get:function(ze){var $e=he(this);if(N(ze)){var et=h(ze);if(et===!0)return le($e).get(ze);if(et)return et[$e.id]}},set:function(ze,$e){return ke(this,ze,$e)}}:{add:function(ze){return ke(this,ze,!0)}}),Le}},QJ}var Xre;function uOe(){if(Xre)return sne;Xre=1;var o=wle(),d=Ul(),h=Mo(),g=jle(),T=ZZ(),I=iOe(),N=dOe(),M=vu(),k=Sz().enforce,x=$o(),V=xle(),K=Object,Q=Array.isArray,ie=K.isExtensible,X=K.isFrozen,Z=K.isSealed,ae=K.freeze,le=K.seal,fe=!d.ActiveXObject&&"ActiveXObject"in d,ue,de=function(We){return function(){return We(this,arguments.length?arguments[0]:void 0)}},te=I("WeakMap",de,N),ye=te.prototype,Te=h(ye.set),Le=function(){return o&&x(function(){var We=ae([]);return Te(new te,We,1),!X(We)})};if(V)if(fe){ue=N.getConstructor(de,"WeakMap",!0),T.enable();var je=h(ye.delete),he=h(ye.has),ke=h(ye.get);g(ye,{delete:function(We){if(M(We)&&!ie(We)){var ze=k(this);return ze.frozen||(ze.frozen=new ue),je(this,We)||ze.frozen.delete(We)}return je(this,We)},has:function(ze){if(M(ze)&&!ie(ze)){var $e=k(this);return $e.frozen||($e.frozen=new ue),he(this,ze)||$e.frozen.has(ze)}return he(this,ze)},get:function(ze){if(M(ze)&&!ie(ze)){var $e=k(this);return $e.frozen||($e.frozen=new ue),he(this,ze)?ke(this,ze):$e.frozen.get(ze)}return ke(this,ze)},set:function(ze,$e){if(M(ze)&&!ie(ze)){var et=k(this);et.frozen||(et.frozen=new ue),he(this,ze)?Te(this,ze,$e):et.frozen.set(ze,$e)}else Te(this,ze,$e);return this}})}else Le()&&g(ye,{set:function(ze,$e){var et;return Q(ze)&&(X(ze)?et=ae:Z(ze)&&(et=le)),Te(this,ze,$e),et&&et(ze),this}});return sne}var Qre;function fOe(){return Qre||(Qre=1,uOe()),ane}var Zre={},ZJ,$re;function hOe(){return $re||($re=1,ZJ={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}),ZJ}var $J,eie;function pOe(){if(eie)return $J;eie=1;var o=zZ(),d=o("span").classList,h=d&&d.constructor&&d.constructor.prototype;return $J=h===Object.prototype?void 0:h,$J}var eX={},tX,tie;function mOe(){if(tie)return tX;tie=1;var o=Gle(),d=XZ();return tX=Object.keys||function(g){return o(g,d)},tX}var nie;function gOe(){if(nie)return eX;nie=1;var o=g0(),d=Ile(),h=CE(),g=bE(),T=HP(),I=mOe();return eX.f=o&&!d?Object.defineProperties:function(M,k){g(M);for(var x=T(k),V=I(k),K=V.length,Q=0,ie;K>Q;)h.f(M,ie=V[Q++],x[ie]);return M},eX}var nX,rie;function _Oe(){if(rie)return nX;rie=1;var o=fz();return nX=o("document","documentElement"),nX}var rX,iie;function n$(){if(iie)return rX;iie=1;var o=bE(),d=gOe(),h=XZ(),g=vz(),T=_Oe(),I=zZ(),N=JZ(),M=">",k="<",x="prototype",V="script",K=N("IE_PROTO"),Q=function(){},ie=function(fe){return k+V+M+fe+k+"/"+V+M},X=function(fe){fe.write(ie("")),fe.close();var ue=fe.parentWindow.Object;return fe=null,ue},Z=function(){var fe=I("iframe"),ue="java"+V+":",de;return fe.style.display="none",T.appendChild(fe),fe.src=String(ue),de=fe.contentWindow.document,de.open(),de.write(ie("document.F=Object")),de.close(),de.F},ae,le=function(){try{ae=new ActiveXObject("htmlfile")}catch{}le=typeof document<"u"?document.domain&&ae?X(ae):Z():X(ae);for(var fe=h.length;fe--;)delete le[x][h[fe]];return le()};return g[K]=!0,rX=Object.create||function(ue,de){var te;return ue!==null?(Q[x]=o(ue),te=new Q,Q[x]=null,te[K]=ue):te=le(),de===void 0?te:d.f(te,de)},rX}var iX,aie;function EOe(){if(aie)return iX;aie=1;var o=jh(),d=n$(),h=CE().f,g=o("unscopables"),T=Array.prototype;return T[g]===void 0&&h(T,g,{configurable:!0,value:d(null)}),iX=function(I){T[g][I]=!0},iX}var aX,sie;function vOe(){if(sie)return aX;sie=1;var o=$o();return aX=!o(function(){function d(){}return d.prototype.constructor=null,Object.getPrototypeOf(new d)!==d.prototype}),aX}var sX,oie;function r$(){if(oie)return sX;oie=1;var o=Tm(),d=nl(),h=gz(),g=JZ(),T=vOe(),I=g("IE_PROTO"),N=Object,M=N.prototype;return sX=T?N.getPrototypeOf:function(k){var x=h(k);if(o(x,I))return x[I];var V=x.constructor;return d(V)&&x instanceof V?V.prototype:x instanceof N?M:null},sX}var oX,cie;function i$(){if(cie)return oX;cie=1;var o=$o(),d=nl(),h=vu(),g=n$(),T=r$(),I=nV(),N=jh(),M=tV(),k=N("iterator"),x=!1,V,K,Q;[].keys&&(Q=[].keys(),"next"in Q?(K=T(T(Q)),K!==Object.prototype&&(V=K)):x=!0);var ie=!h(V)||o(function(){var X={};return V[k].call(X)!==X});return ie?V={}:M&&(V=g(V)),d(V[k])||I(V,k,function(){return this}),oX={IteratorPrototype:V,BUGGY_SAFARI_ITERATORS:x},oX}var cX,lie;function SOe(){if(lie)return cX;lie=1;var o=i$().IteratorPrototype,d=n$(),h=_z(),g=Tz(),T=rV(),I=function(){return this};return cX=function(N,M,k,x){var V=M+" Iterator";return N.prototype=d(o,{next:h(+!x,k)}),g(N,V,!1,!0),T[V]=I,N},cX}var lX,die;function yOe(){if(die)return lX;die=1;var o=$A(),d=lC(),h=tV(),g=Mle(),T=nl(),I=SOe(),N=r$(),M=qle(),k=Tz(),x=Ez(),V=nV(),K=jh(),Q=rV(),ie=i$(),X=g.PROPER,Z=g.CONFIGURABLE,ae=ie.IteratorPrototype,le=ie.BUGGY_SAFARI_ITERATORS,fe=K("iterator"),ue="keys",de="values",te="entries",ye=function(){return this};return lX=function(Te,Le,je,he,ke,We,ze){I(je,Le,he);var $e=function(Pt){if(Pt===ke&&Ge)return Ge;if(!le&&Pt&&Pt in qe)return qe[Pt];switch(Pt){case ue:return function(){return new je(this,Pt)};case de:return function(){return new je(this,Pt)};case te:return function(){return new je(this,Pt)}}return function(){return new je(this)}},et=Le+" Iterator",Oe=!1,qe=Te.prototype,lt=qe[fe]||qe["@@iterator"]||ke&&qe[ke],Ge=!le&&lt||$e(ke),Ae=Le==="Array"&&qe.entries||lt,rt,yt,Lt;if(Ae&&(rt=N(Ae.call(new Te)),rt!==Object.prototype&&rt.next&&(!h&&N(rt)!==ae&&(M?M(rt,ae):T(rt[fe])||V(rt,fe,ye)),k(rt,et,!0,!0),h&&(Q[et]=ye))),X&&ke===de&&lt&&lt.name!==de&&(!h&&Z?x(qe,"name",de):(Oe=!0,Ge=function(){return d(lt,this)})),ke)if(yt={values:$e(de),keys:We?Ge:$e(ue),entries:$e(te)},ze)for(Lt in yt)(le||Oe||!(Lt in qe))&&V(qe,Lt,yt[Lt]);else o({target:Le,proto:!0,forced:le||Oe},yt);return(!h||ze)&&qe[fe]!==Ge&&V(qe,fe,Ge,{name:ke}),Q[Le]=Ge,yt},lX}var dX,uie;function TOe(){return uie||(uie=1,dX=function(o,d){return{value:o,done:d}}),dX}var uX,fie;function bOe(){if(fie)return uX;fie=1;var o=HP(),d=EOe(),h=rV(),g=Sz(),T=CE().f,I=yOe(),N=TOe(),M=tV(),k=g0(),x="Array Iterator",V=g.set,K=g.getterFor(x);uX=I(Array,"Array",function(ie,X){V(this,{type:x,target:o(ie),index:0,kind:X})},function(){var ie=K(this),X=ie.target,Z=ie.index++;if(!X||Z>=X.length)return ie.target=null,N(void 0,!0);switch(ie.kind){case"keys":return N(Z,!1);case"values":return N(X[Z],!1)}return N([Z,X[Z]],!1)},"values");var Q=h.Arguments=h.Array;if(d("keys"),d("values"),d("entries"),!M&&k&&Q.name!=="values")try{T(Q,"name",{value:"values"})}catch{}return uX}var hie;function COe(){if(hie)return Zre;hie=1;var o=Ul(),d=hOe(),h=pOe(),g=bOe(),T=Ez(),I=Tz(),N=jh(),M=N("iterator"),k=g.values,x=function(K,Q){if(K){if(K[M]!==k)try{T(K,M,k)}catch{K[M]=k}if(I(K,Q,!0),d[Q]){for(var ie in g)if(K[ie]!==g[ie])try{T(K,ie,g[ie])}catch{K[ie]=g[ie]}}}};for(var V in d)x(o[V]&&o[V].prototype,V);return x(h,"DOMTokenList"),Zre}var pie={},fX,mie;function wOe(){if(mie)return fX;mie=1;var o=pz(),d=TypeError;return fX=function(h,g){if(!delete h[g])throw new d("Cannot delete property "+o(g)+" of "+o(h))},fX}var hX,gie;function a$(){if(gie)return hX;gie=1;var o=$Z(),d=String;return hX=function(h){if(o(h)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return d(h)},hX}var pX,_ie;function ROe(){if(_ie)return pX;_ie=1;var o=Hle(),d=Math.floor,h=function(g,T){var I=g.length;if(I<8)for(var N=1,M,k;N<I;){for(k=N,M=g[N];k&&T(g[k-1],M)>0;)g[k]=g[--k];k!==N++&&(g[k]=M)}else for(var x=d(I/2),V=h(o(g,0,x),T),K=h(o(g,x),T),Q=V.length,ie=K.length,X=0,Z=0;X<Q||Z<ie;)g[X+Z]=X<Q&&Z<ie?T(V[X],K[Z])<=0?V[X++]:K[Z++]:X<Q?V[X++]:K[Z++];return g};return pX=h,pX}var mX,Eie;function IOe(){if(Eie)return mX;Eie=1;var o=$o();return mX=function(d,h){var g=[][d];return!!g&&o(function(){g.call(null,h||function(){return 1},1)})},mX}var gX,vie;function AOe(){if(vie)return gX;vie=1;var o=hz(),d=o.match(/firefox\/(\d+)/i);return gX=!!d&&+d[1],gX}var _X,Sie;function OOe(){if(Sie)return _X;Sie=1;var o=hz();return _X=/MSIE|Trident/.test(o),_X}var EX,yie;function NOe(){if(yie)return EX;yie=1;var o=hz(),d=o.match(/AppleWebKit\/(\d+)\./);return EX=!!d&&+d[1],EX}var Tie;function LOe(){if(Tie)return pie;Tie=1;var o=$A(),d=Mo(),h=GP(),g=gz(),T=yz(),I=wOe(),N=a$(),M=$o(),k=ROe(),x=IOe(),V=AOe(),K=OOe(),Q=Ale(),ie=NOe(),X=[],Z=d(X.sort),ae=d(X.push),le=M(function(){X.sort(void 0)}),fe=M(function(){X.sort(null)}),ue=x("sort"),de=!M(function(){if(Q)return Q<70;if(!(V&&V>3)){if(K)return!0;if(ie)return ie<603;var Te="",Le,je,he,ke;for(Le=65;Le<76;Le++){switch(je=String.fromCharCode(Le),Le){case 66:case 69:case 70:case 72:he=3;break;case 68:case 71:he=4;break;default:he=2}for(ke=0;ke<47;ke++)X.push({k:je+ke,v:he})}for(X.sort(function(We,ze){return ze.v-We.v}),ke=0;ke<X.length;ke++)je=X[ke].k.charAt(0),Te.charAt(Te.length-1)!==je&&(Te+=je);return Te!=="DGBEFHACIJK"}}),te=le||!fe||!ue||!de,ye=function(Te){return function(Le,je){return je===void 0?-1:Le===void 0?1:Te!==void 0?+Te(Le,je)||0:N(Le)>N(je)?1:-1}};return o({target:"Array",proto:!0,forced:te},{sort:function(Le){Le!==void 0&&h(Le);var je=g(this);if(de)return Le===void 0?Z(je):Z(je,Le);var he=[],ke=T(je),We,ze;for(ze=0;ze<ke;ze++)ze in je&&ae(he,je[ze]);for(k(he,ye(Le)),We=T(he),ze=0;ze<We;)je[ze]=he[ze++];for(;ze<ke;)I(je,ze++);return je}}),pie}var bie={},vX,Cie;function Jle(){return Cie||(Cie=1,vX=`	
\v\f\r \u2028\u2029\uFEFF`),vX}var SX,wie;function DOe(){if(wie)return SX;wie=1;var o=Mo(),d=mz(),h=a$(),g=Jle(),T=o("".replace),I=RegExp("^["+g+"]+"),N=RegExp("(^|[^"+g+"])["+g+"]+$"),M=function(k){return function(x){var V=h(d(x));return k&1&&(V=T(V,I,"")),k&2&&(V=T(V,N,"$1")),V}};return SX={start:M(1),end:M(2),trim:M(3)},SX}var yX,Rie;function POe(){if(Rie)return yX;Rie=1;var o=Ul(),d=$o(),h=Mo(),g=a$(),T=DOe().trim,I=Jle(),N=h("".charAt),M=o.parseFloat,k=o.Symbol,x=k&&k.iterator,V=1/M(I+"-0")!==-1/0||x&&!d(function(){M(Object(x))});return yX=V?function(Q){var ie=T(g(Q)),X=M(ie);return X===0&&N(ie,0)==="-"?-0:X}:M,yX}var Iie;function MOe(){if(Iie)return bie;Iie=1;var o=$A(),d=POe();return o({global:!0,forced:parseFloat!==d},{parseFloat:d}),bie}var Aie={},Oie={},TX,Nie;function kOe(){if(Nie)return TX;Nie=1;var o=Ule(),d=CE();return TX=function(h,g,T){return T.get&&o(T.get,g,{getter:!0}),T.set&&o(T.set,g,{setter:!0}),d.f(h,g,T)},TX}var bX,Lie;function xOe(){if(Lie)return bX;Lie=1;var o=g0(),d=CE(),h=_z();return bX=function(g,T,I){o?d.f(g,T,h(0,I)):g[T]=I},bX}var Die;function UOe(){if(Die)return Oie;Die=1;var o=$A(),d=Ul(),h=t$(),g=bE(),T=nl(),I=r$(),N=kOe(),M=xOe(),k=$o(),x=Tm(),V=jh(),K=i$().IteratorPrototype,Q=g0(),ie=tV(),X="constructor",Z="Iterator",ae=V("toStringTag"),le=TypeError,fe=d[Z],ue=ie||!T(fe)||fe.prototype!==K||!k(function(){fe({})}),de=function(){if(h(this,K),I(this)===K)throw new le("Abstract class Iterator not directly constructable")},te=function(ye,Te){Q?N(K,ye,{configurable:!0,get:function(){return Te},set:function(Le){if(g(this),this===K)throw new le("You can't redefine this property");x(this,ye)?this[ye]=Le:M(this,ye,Le)}}):K[ye]=Te};return x(K,ae)||te(ae,Z),(ue||!x(K,X)||K[X]===Object)&&te(X,de),de.prototype=K,o({global:!0,constructor:!0,forced:ue},{Iterator:de}),Oie}var Pie;function jOe(){return Pie||(Pie=1,UOe()),Aie}var Mie={},kie={},CX,xie;function VOe(){return xie||(xie=1,CX=function(o){return{iterator:o,next:o.next,done:!1}}),CX}var wX,Uie;function BOe(){if(Uie)return wX;Uie=1;var o=Ul();return wX=function(d,h){var g=o.Iterator,T=g&&g.prototype,I=T&&T[d],N=!1;if(I)try{I.call({next:function(){return{done:!0}},return:function(){N=!0}},-1)}catch(M){M instanceof h||(N=!1)}if(!N)return I},wX}var jie;function FOe(){if(jie)return kie;jie=1;var o=$A(),d=lC(),h=e$(),g=GP(),T=bE(),I=VOe(),N=Kle(),M=BOe(),k=M("forEach",TypeError);return o({target:"Iterator",proto:!0,real:!0,forced:k},{forEach:function(V){T(this);try{g(V)}catch(ie){N(this,"throw",ie)}if(k)return d(k,this,V);var K=I(this),Q=0;h(K,function(ie){V(ie,Q++)},{IS_RECORD:!0})}}),kie}var Vie;function GOe(){return Vie||(Vie=1,FOe()),Mie}function Xle(o){var d,h,g="";if(typeof o=="string"||typeof o=="number")g+=o;else if(typeof o=="object")if(Array.isArray(o))for(d=0;d<o.length;d++)o[d]&&(h=Xle(o[d]))&&(g&&(g+=" "),g+=h);else for(d in o)o[d]&&(g&&(g+=" "),g+=d);return g}function Bie(){for(var o,d,h=0,g="";h<arguments.length;)(o=arguments[h++])&&(d=Xle(o))&&(g&&(g+=" "),g+=d);return g}const zOe=Object.freeze(Object.defineProperty({__proto__:null,clsx:Bie,default:Bie},Symbol.toStringTag,{value:"Module"})),HOe=yde(zOe);var Fie;function WOe(){if(Fie)return Jj;Fie=1,fOe(),COe(),Object.defineProperty(Jj,"__esModule",{value:!0}),Jj.default=void 0,LOe(),MOe(),jOe(),GOe();var o=T(EG()),d=h(HOe);function h(de){return de&&de.__esModule?de:{default:de}}function g(de){if(typeof WeakMap!="function")return null;var te=new WeakMap,ye=new WeakMap;return(g=function(Le){return Le?ye:te})(de)}function T(de,te){if(de&&de.__esModule)return de;if(de===null||typeof de!="object"&&typeof de!="function")return{default:de};var ye=g(te);if(ye&&ye.has(de))return ye.get(de);var Te={__proto__:null},Le=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var je in de)if(je!=="default"&&{}.hasOwnProperty.call(de,je)){var he=Le?Object.getOwnPropertyDescriptor(de,je):null;he&&(he.get||he.set)?Object.defineProperty(Te,je,he):Te[je]=de[je]}return Te.default=de,ye&&ye.set(de,Te),Te}const I=Math.abs,N=parseFloat,M="min",k="max",x="any",V="vertical",K="tabindex",Q="data-lower",ie="data-upper",X="data-active",Z="data-vertical",ae="data-disabled",le="aria-label",fe="aria-labelledby";class ue extends o.PureComponent{constructor(){super(),this.element=(0,o.createRef)(),this.input=[],this.thumb=[(0,o.createRef)(),(0,o.createRef)()],this.range=(0,o.createRef)(),this.options={},this.isControlled=!1,this.externalInput=!1,this.isComponentMounted=!1,this.lastValueProp=[]}initiateInputRange(te){const ye=document.createElement("input");return ye.type="range",ye.min=this.options.min,ye.max=this.options.max,ye.step=this.options.step,ye.value=this.props.value?this.options.value[te]:this.options.defaultValue[te],ye}updateInputRange(te){this.input[te].min=this.options.min,this.input[te].max=this.options.max,this.input[te].step=this.options.step,this.input[te].value=this.props.value?this.options.value[te]:te===1?this.value.max:this.value.min}componentDidMount(){this.isComponentMounted||(this.input=[this.initiateInputRange(0),this.initiateInputRange(1)],this.value=this.setMinMaxProps(),this.index=this.setMinMaxProps(0,1),this.thumbWidth=this.setMinMaxProps(),this.thumbHeight=this.setMinMaxProps(),this.rangeLimits=this.setMinMaxProps(),this.sliderValue=this.setMinMaxProps(),this.maxRangeWidth=0,this.rangeWidth=0,this.isDragging=!1,this.thumbDrag=!1,this.startPos=0,this.reset(!0),this.addNodeEventListener(this.element.current,"pointerdown",te=>{this.elementFocused(te)}),this.thumb.forEach((te,ye)=>{this.addNodeEventListener(te.current,"pointerdown",Te=>{this.initiateThumbDrag(Te,ye,te.current)}),this.addNodeEventListener(te.current,"keydown",Te=>{Te.which>=37&&Te.which<=40&&(Te.preventDefault(),this.stepValue(ye,Te.which))})}),this.addNodeEventListener(this.range.current,"pointerdown",te=>{this.initiateRangeDrag(te)}),this.pointerMoveEvent=te=>{this.drag(te)},this.pointerUpEvent=()=>{this.isDragging&&(this.removeNodeAttribute(this.thumb[0].current,X),this.removeNodeAttribute(this.thumb[1].current,X),this.removeNodeAttribute(this.range.current,X),this.isDragging=!1,this.thumbDrag?this.options.onThumbDragEnd&&this.options.onThumbDragEnd():this.options.onRangeDragEnd&&this.options.onRangeDragEnd())},this.resizeEvent=()=>{this.syncThumbDimensions(),this.updateThumbs(),this.updateRange()},this.addNodeEventListener(document,"pointermove",this.pointerMoveEvent),this.addNodeEventListener(document,"pointerup",this.pointerUpEvent),this.addNodeEventListener(window,"resize",this.resizeEvent),this.isComponentMounted=!0)}componentDidUpdate(){this.updateInputRange(0),this.updateInputRange(1),this.reset()}componentWillUnmount(){this.removeNodeEventListener(document,"pointermove",this.pointerMoveEvent),this.removeNodeEventListener(document,"pointerup",this.pointerUpEvent),this.removeNodeEventListener(window,"resize",this.resizeEvent),this.isComponentMounted=!1}reset(){let te=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.isControlled=!!this.props.value,this.isControlled&&((te||this.props.value!==this.lastValueProp)&&(this.externalInput=!0),this.lastValueProp=this.props.value),this.maxRangeWidth=this.options.max-this.options.min,this.updateOrientation(),this.setValue("",!0,!1),this.updateRangeLimits(),this.updateDisabledState(),this.updateThumbsDisabledState(),this.updateTabIndexes(),te&&(this.sliderValue=this.value)}isNumber(te){return!isNaN(te)&&+te+""==te+""}setMinMaxProps(){let te=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,ye=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return{min:te,max:ye}}iterateMinMaxProps(te){[M,k].forEach(te)}getSetProps(te,ye,Te){if(te)return ye;Te()}setNodeAttribute(te,ye){let Te=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";te.setAttribute(ye,Te)}removeNodeAttribute(te,ye){te.removeAttribute(ye)}addNodeEventListener(te,ye,Te){let Le=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0;te.addEventListener(ye,Te,Le?{passive:!1,capture:!0}:{})}removeNodeEventListener(te,ye,Te){let Le=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0;te.removeEventListener(ye,Te,Le?{passive:!1,capture:!0}:{})}fallbackToDefault(te,ye){this.options[te]=this.props[te]?this.props[te]:ye}ifVerticalElse(te,ye){return this.options.orientation===V?te:ye}currentIndex(te){return te===1?this.index.max:this.index.min}safeMinMaxValues(){let te=!1;(!this.isNumber(this.options.min)||!this.isNumber(this.options.max))&&(te=!0),this.options.min=te?1:+this.options.min,this.options.max=te?1:+this.options.max}safeThumbsDisabledValues(){this.options.thumbsDisabled instanceof Array?(this.options.thumbsDisabled.length===1&&this.options.thumbsDisabled.push(!1),this.options.thumbsDisabled.length!==1&&this.options.thumbsDisabled.length!==2&&(this.options.thumbsDisabled=[!1,!1])):this.options.thumbsDisabled=[this.options.thumbsDisabled,this.options.thumbsDisabled],this.options.thumbsDisabled[0]=!!this.options.thumbsDisabled[0],this.options.thumbsDisabled[1]=!!this.options.thumbsDisabled[1]}setValue(te){let ye=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,Te=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const Le=this.setMinMaxProps(this.input[0].value,this.input[1].value);if(te=te||Le,this.input[this.index.min].value=te.min,this.input[this.index.max].value=this.thumbDrag||ye?te.max:te.min+this.rangeWidth,this.syncValues(),this.value.min>this.value.max){var je,he,ke,We;this.index.min=+!this.index.min,this.index.max=+!this.index.max,this.removeNodeAttribute(this.thumb[this.index.min].current,ie),this.removeNodeAttribute(this.thumb[this.index.max].current,Q),this.setNodeAttribute(this.thumb[this.index.min].current,Q),this.setNodeAttribute(this.thumb[this.index.max].current,ie),this.setNodeAttribute(this.thumb[this.index.min].current,le,(je=this.props)===null||je===void 0||(je=je.ariaLabel)===null||je===void 0?void 0:je[0]),this.setNodeAttribute(this.thumb[this.index.max].current,le,(he=this.props)===null||he===void 0||(he=he.ariaLabel)===null||he===void 0?void 0:he[1]),this.setNodeAttribute(this.thumb[this.index.min].current,fe,(ke=this.props)===null||ke===void 0||(ke=ke.ariaLabelledBy)===null||ke===void 0?void 0:ke[0]),this.setNodeAttribute(this.thumb[this.index.max].current,fe,(We=this.props)===null||We===void 0||(We=We.ariaLabelledBy)===null||We===void 0?void 0:We[1]),this.thumbDrag&&(this.thumbDrag=this.thumbDrag===M?k:M),this.syncValues()}this.sliderValue=ye?this.sliderValue:te;let ze=!1;const $e=[Le.min,Le.max].sort((Oe,qe)=>Oe-qe),et=[this.input[0].value,this.input[1].value].sort((Oe,qe)=>Oe-qe);($e[0]!==et[0]||ye)&&(ze=!0),($e[1]!==et[1]||ye)&&(ze=!0),ze&&(Te&&this.options.onInput&&this.options.onInput([this.value.min,this.value.max]),(!this.isControlled||this.externalInput)&&(this.externalInput=!1,this.syncThumbDimensions(),this.updateThumbs(),this.updateRange(),this.updateAriaValueAttributes()))}syncValues(){this.iterateMinMaxProps(te=>{this.value[te]=+this.input[this.index[te]].value})}updateThumbs(){this.iterateMinMaxProps(te=>{this.thumb[this.index[te]].current.style[this.ifVerticalElse("top","left")]="calc(".concat((this.value[te]-this.options.min)/this.maxRangeWidth*100,"% + ").concat((.5-(this.value[te]-this.options.min)/this.maxRangeWidth)*this.ifVerticalElse(this.thumbHeight,this.thumbWidth)[te],"px)")})}updateRange(){const te=this.element.current.getBoundingClientRect(),ye=(.5-(this.value.min-this.options.min)/this.maxRangeWidth)*this.ifVerticalElse(this.thumbHeight,this.thumbWidth).min/this.ifVerticalElse(te.bottom-te.top,te.right-te.left),Te=(.5-(this.value.max-this.options.min)/this.maxRangeWidth)*this.ifVerticalElse(this.thumbHeight,this.thumbWidth).max/this.ifVerticalElse(te.bottom-te.top,te.right-te.left);this.range.current.style[this.ifVerticalElse("top","left")]="".concat(((this.value.min-this.options.min)/this.maxRangeWidth+ye)*100,"%"),this.range.current.style[this.ifVerticalElse("height","width")]="".concat(((this.value.max-this.options.min)/this.maxRangeWidth-(this.value.min-this.options.min)/this.maxRangeWidth-ye+Te)*100,"%")}updateRangeLimits(){this.iterateMinMaxProps((te,ye)=>{this.rangeLimits[te]=this.options.thumbsDisabled[ye]?this.value[te]:this.options[te]})}updateTabIndexes(){this.iterateMinMaxProps((te,ye)=>{!this.options.disabled&&!this.options.thumbsDisabled[ye]?this.setNodeAttribute(this.thumb[this.currentIndex(ye)].current,K,0):this.removeNodeAttribute(this.thumb[this.currentIndex(ye)].current,K)})}updateAriaValueAttributes(){this.iterateMinMaxProps(te=>{this.setNodeAttribute(this.thumb[this.index[te]].current,"aria-valuemin",this.options.min),this.setNodeAttribute(this.thumb[this.index[te]].current,"aria-valuemax",this.options.max),this.setNodeAttribute(this.thumb[this.index[te]].current,"aria-valuenow",this.value[te]),this.setNodeAttribute(this.thumb[this.index[te]].current,"aria-valuetext",this.value[te])})}updateDisabledState(){this.options.disabled?this.setNodeAttribute(this.element.current,ae):this.removeNodeAttribute(this.element.current,ae)}updateThumbsDisabledState(){this.options.thumbsDisabled.forEach((te,ye)=>{const Te=this.currentIndex(ye);te?(this.setNodeAttribute(this.thumb[Te].current,ae),this.setNodeAttribute(this.thumb[Te].current,"aria-disabled",!0)):(this.removeNodeAttribute(this.thumb[Te].current,ae),this.setNodeAttribute(this.thumb[Te].current,"aria-disabled",!1))})}updateLimits(te){let ye=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.options[te]=ye,this.safeMinMaxValues(),this.iterateMinMaxProps(Te=>{this.input[0][Te]=this.options[Te],this.input[1][Te]=this.options[Te]}),this.maxRangeWidth=this.options.max-this.options.min,this.setValue("",!0),this.updateRangeLimits()}updateOrientation(){this.options.orientation===V?this.setNodeAttribute(this.element.current,Z):this.removeNodeAttribute(this.element.current,Z),this.range.current.style[this.ifVerticalElse("left","top")]="",this.range.current.style[this.ifVerticalElse("width","height")]="",this.thumb[0].current.style[this.ifVerticalElse("left","top")]="",this.thumb[1].current.style[this.ifVerticalElse("left","top")]=""}syncThumbDimensions(){this.iterateMinMaxProps(te=>{this.thumbWidth[te]=N(window.getComputedStyle(this.thumb[this.index[te]].current).width),this.thumbHeight[te]=N(window.getComputedStyle(this.thumb[this.index[te]].current).height)})}currentPosition(te,ye){const Te=this.element.current.getBoundingClientRect(),Le=ye.getBoundingClientRect(),je=(this.ifVerticalElse(Le.top-Te.top,Le.left-Te.left)+(te["client".concat(this.ifVerticalElse("Y","X"))]-ye.getBoundingClientRect()[this.ifVerticalElse("top","left")])-(this.thumbDrag?(.5-(this.value[this.thumbDrag]-this.options.min)/this.maxRangeWidth)*this.ifVerticalElse(this.thumbHeight,this.thumbWidth)[this.thumbDrag]:0))/this.ifVerticalElse(Te.bottom-Te.top,Te.right-Te.left)*this.maxRangeWidth+this.options.min;return je<this.options.min?this.options.min:je>this.options.max?this.options.max:je}doesntHaveClassName(te,ye){return!te.target.classList.contains(ye)}elementFocused(te){let ye=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,Te=!1;if(!this.options.disabled&&(this.doesntHaveClassName(te,"range-slider__thumb")&&this.doesntHaveClassName(te,"range-slider__range")||this.options.rangeSlideDisabled&&this.doesntHaveClassName(te,"range-slider__thumb"))&&(Te=!0),Te&&this.options.thumbsDisabled[0]&&this.options.thumbsDisabled[1]&&(Te=!1),Te){const Le=this.currentPosition(te,this.range.current),je=I(this.value.min-Le),he=I(this.value.max-Le);if(this.options.thumbsDisabled[0])Le>=this.value.min&&(this.setValue(this.setMinMaxProps(this.value.min,Le),!0,!ye),this.initiateThumbDrag(te,this.index.max,this.thumb[this.index.max].current,!ye));else if(this.options.thumbsDisabled[1])Le<=this.value.max&&(this.setValue(this.setMinMaxProps(Le,this.value.max),!0,!ye),this.initiateThumbDrag(te,this.index.min,this.thumb[this.index.min].current,!ye));else{let ke=this.index.max;je===he?this.setValue(this.setMinMaxProps(this.value.min,Le),!0,!ye):(this.setValue(this.setMinMaxProps(je<he?Le:this.value.min,he<je?Le:this.value.max),!0,!ye),ke=je<he?this.index.min:this.index.max),this.initiateThumbDrag(te,ke,this.thumb[ke].current,!ye)}ye&&this.elementFocused(te,!1)}}initiateDrag(te,ye){this.syncThumbDimensions(),this.setNodeAttribute(ye,X),this.startPos=this.currentPosition(te,ye),this.isDragging=!0}initiateThumbDrag(te,ye,Te){let Le=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0;!this.options.disabled&&!this.options.thumbsDisabled[this.currentIndex(ye)]&&(this.initiateDrag(te,Te),this.thumbDrag=this.index.min===ye?M:k,Le&&this.options.onThumbDragStart&&this.options.onThumbDragStart())}initiateRangeDrag(te){!this.options.disabled&&!this.options.rangeSlideDisabled&&(this.initiateDrag(te,this.range.current),this.rangeWidth=this.value.max-this.value.min,this.thumbDrag=!1,this.options.onRangeDragStart&&this.options.onRangeDragStart())}drag(te){if(this.isDragging){const ye=this.currentPosition(te,this.range.current),Te=ye-this.startPos;let Le=this.value.min,je=this.value.max;const he=this.thumbDrag?this.rangeLimits.min:this.options.min,ke=this.thumbDrag?this.rangeLimits.max:this.options.max;(!this.thumbDrag||this.thumbDrag===M)&&(Le=this.thumbDrag?ye:this.sliderValue.min+Te),(!this.thumbDrag||this.thumbDrag===k)&&(je=this.thumbDrag?ye:this.sliderValue.max+Te),Le>=he&&Le<=ke&&je>=he&&je<=ke?(this.setValue({min:Le,max:je}),this.startPos=ye):(Le>ke&&this.thumbDrag&&(this.setValue(this.setMinMaxProps(ke,ke)),this.startPos=ye),je<he&&this.thumbDrag&&(this.setValue(this.setMinMaxProps(he,he)),this.startPos=ye),Le<he&&(this.thumbDrag?this.setValue(this.setMinMaxProps(he,this.value.max)):this.setValue(this.setMinMaxProps(he,this.value.max-this.value.min+he)),this.startPos=ye),je>ke&&(this.thumbDrag?this.setValue(this.setMinMaxProps(this.value.min,ke)):this.setValue(this.setMinMaxProps(this.value.min-this.value.max+ke,ke)),this.startPos=ye)),this.thumbDrag||this.updateRangeLimits()}}actualStepValue(){const te=N(this.input[0].step);return this.input[0].step===x?x:te===0||isNaN(te)?1:te}stepValue(te,ye){const Te=(ye===37||ye===40?-1:1)*this.ifVerticalElse(-1,1);if(!this.options.disabled&&!this.options.thumbsDisabled[this.currentIndex(te)]){let Le=this.actualStepValue();Le=Le===x?1:Le;let je=this.value.min+Le*(this.index.min===te?Te:0),he=this.value.max+Le*(this.index.max===te?Te:0);je>this.rangeLimits.max&&(je=this.rangeLimits.max),he<this.rangeLimits.min&&(he=this.rangeLimits.min),this.setValue({min:je,max:he},!0)}}render(){var te,ye,Te,Le;return this.fallbackToDefault("rangeSlideDisabled",!1),this.fallbackToDefault("thumbsDisabled",[!1,!1]),this.fallbackToDefault("orientation","horizontal"),this.fallbackToDefault("defaultValue",[25,75]),this.fallbackToDefault("disabled",!1),this.fallbackToDefault("onThumbDragStart",!1),this.fallbackToDefault("onRangeDragStart",!1),this.fallbackToDefault("onThumbDragEnd",!1),this.fallbackToDefault("onRangeDragEnd",!1),this.fallbackToDefault("onInput",!1),this.fallbackToDefault("step",1),this.fallbackToDefault("min",0),this.fallbackToDefault("max",100),this.props.value&&this.fallbackToDefault("value",[25,75]),this.safeMinMaxValues(),this.safeThumbsDisabledValues(),o.default.createElement("div",{"data-testid":"element",id:this.props.id,ref:this.element,className:(0,d.default)("range-slider",this.props.className)},o.default.createElement("div",{ref:this.thumb[0],role:"slider",className:"range-slider__thumb","data-lower":!0,"aria-label":(te=this.props)===null||te===void 0||(te=te.ariaLabel)===null||te===void 0?void 0:te[0],"aria-labelledby":(ye=this.props)===null||ye===void 0||(ye=ye.ariaLabelledBy)===null||ye===void 0?void 0:ye[0]}),o.default.createElement("div",{ref:this.thumb[1],role:"slider",className:"range-slider__thumb","data-upper":!0,"aria-label":(Te=this.props)===null||Te===void 0||(Te=Te.ariaLabel)===null||Te===void 0?void 0:Te[1],"aria-labelledby":(Le=this.props)===null||Le===void 0||(Le=Le.ariaLabelledBy)===null||Le===void 0?void 0:Le[1]}),o.default.createElement("div",{ref:this.range,className:"range-slider__range"}))}}return Jj.default=ue,Jj}var Gie;function YOe(){if(Gie)return qj;Gie=1,Object.defineProperty(qj,"__esModule",{value:!0}),qj.default=void 0;var o=d(WOe());function d(h){return h&&h.__esModule?h:{default:h}}return qj.default=o.default,qj}var KOe=YOe();const qOe=_G(KOe);function JOe(){return j.jsxs(j.Fragment,{children:[j.jsxs("div",{className:"main-image-content",children:[j.jsx("p",{className:"text",children:"Update your personal photos here"}),j.jsx(QOe,{})]}),j.jsx(ZOe,{})]})}const XOe=5;function QOe(){const[d,h]=q.useState(Array(5).fill(null)),[g,T]=q.useState(Array(5).fill(null)),[I,N]=q.useState(Array(5).fill(null)),M=q.useRef(null),[k,x]=q.useState(null),[V,K]=q.useState(!1),Q=()=>JSON.parse(localStorage.getItem("user_Data"));q.useEffect(()=>{(async()=>{try{const fe=Q(),ue=fe==null?void 0:fe.id,de=fe==null?void 0:fe.token;if(!ue||!de){console.warn("User not authenticated");return}const te=await Ur.get(`/users/${ue}/gallary`,{headers:{token:de}}),ye=(te==null?void 0:te.data)||[];console.log("kanjjjj",ye);const Te=Array(5).fill(null),Le=Array(5).fill(null);ye.forEach((je,he)=>{he<5&&je.url&&(Te[he]=je.url,Le[he]=!0,console.log("kanjjjj",Te[he]))}),h(Te),N(Le)}catch(fe){console.error("Error fetching gallery images:",fe)}})()},[]);const ie=async le=>{const fe=le.target.files;if(fe&&fe[0]&&k!==null){const ue=fe[0],de=URL.createObjectURL(ue),te=[...d],ye=[...g];te[k]=de,ye[k]=ue,h(te),T(ye),await X(ue,k)}},X=async(le,fe)=>{K(!0);try{const ue=Q(),de=ue==null?void 0:ue.id,te=ue==null?void 0:ue.token;if(!de||!te){alert("User not authenticated");return}const ye=new FormData;ye.append("files",le);const Te=await Ur.post(`/users/${de}/gallary`,ye,{headers:{"Content-Type":"multipart/form-data",token:te}}),Le=[...I];Le[fe]=!0,N(Le),console.log("Photo uploaded successfully:",Te.data)}catch(ue){console.error("Photo upload failed:",ue),alert("Failed to upload photo. Please try again.");const de=[...d],te=[...g];de[fe]=null,te[fe]=null,h(de),T(te)}finally{K(!1)}},Z=le=>{V||(x(le),M.current.click())},ae=le=>{if(d.filter(te=>te).length<=1){alert("Sorry, at least one photo is required.");return}const ue=[...d];ue[le]=null,h(ue);const de=[...I];de[le]=!1,N(de)};return j.jsxs(j.Fragment,{children:[j.jsxs("div",{className:"w-full flex gap-4 overflow-x-auto",children:[d.map((le,fe)=>j.jsx("div",{onClick:()=>Z(fe),className:`relative unuploaded-image flex items-center justify-center cursor-pointer ${le?"uploaded-image":""} ${V&&k===fe?"opacity-50":""}`,children:le?j.jsxs(j.Fragment,{children:[j.jsx("img",{src:le,alt:`Uploaded ${fe+1}`,className:"w-full h-full object-cover rounded-xl"}),I[fe]&&j.jsx("div",{className:"delete-btn",onClick:ue=>{ue.stopPropagation(),ae(fe)},children:""}),V&&k===fe&&j.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center",children:j.jsx("div",{className:"text-white text-sm",children:"Uploading..."})})]}):j.jsxs("div",{className:"flex flex-col items-center text-gray-500 ",children:[j.jsx(_Ee,{size:28,className:"mb-1 text-blue-500"}),j.jsx("p",{className:"text-sm",children:"Add Photo"})]})},fe)),j.jsx("input",{type:"file",accept:"image/*",className:"hidden",ref:M,onChange:ie})]}),V&&j.jsx("div",{className:"text-center text-sm text-blue-600 mt-2",children:"Uploading photo..."})]})}function ZOe(){const[o,d]=q.useState({}),[h,g]=q.useState(null),[T,I]=q.useState(""),[N,M]=q.useState([18,25]),[k,x]=q.useState([]),[V,K]=q.useState({education_id:"",profession_id:"",language_id:"",status_id:"",religion_id:"",city_id:"",drinking_id:"",smoking_id:"",eating_id:"",match_intent:"LoveCommitment"}),[Q,ie]=q.useState(""),[X,Z]=q.useState([18,25]),[ae,le]=q.useState([]),[fe,ue]=q.useState(""),[de,te]=q.useState(""),[ye,Te]=q.useState(""),[Le,je]=q.useState(""),[he,ke]=q.useState(""),[We,ze]=q.useState(""),[$e,et]=q.useState([]),[Oe,qe]=q.useState([]),[lt,Ge]=q.useState([]),[Ae,rt]=q.useState([]),[yt,Lt]=q.useState("");q.useEffect(()=>{const kt=JSON.parse(localStorage.getItem("user_Data")),Ht=kt==null?void 0:kt.id;Ur.get("/interests").then(Jt=>Ge(Jt.data)).catch(Jt=>console.error("Failed to fetch interests:",Jt)),Ht&&(Ur.get(`/users/${Ht}/info`).then(Jt=>{var Ri,jr,dr,Ii,sa,ar,Sn,vc,Zi;const tn=Jt.data,Yn={id:tn.id,name:tn.name,email:tn.email,username:tn.username,gender:tn.gender,dob:tn.dob,url:tn.url,education_id:((Ri=tn.educations)==null?void 0:Ri.id)||"",profession_id:((jr=tn.professions)==null?void 0:jr.id)||"",language_id:((dr=tn.languages)==null?void 0:dr.id)||"",status_id:((Ii=tn.statuses)==null?void 0:Ii.id)||"",religion_id:((sa=tn.religions)==null?void 0:sa.id)||"",drinking_id:((ar=tn.drinking)==null?void 0:ar.id)||"",smoking_id:((Sn=tn.smoking)==null?void 0:Sn.id)||"",eating_id:((vc=tn.eating)==null?void 0:vc.id)||"",city_id:((Zi=tn.city)==null?void 0:Zi.id)||"",about:tn.about||"",cityAndCountryName:tn.city,country_code:tn.country_code,number:tn.number,token:kt==null?void 0:kt.token},oi={education_id:Yn.education_id,profession_id:Yn.profession_id,language_id:Yn.language_id,status_id:Yn.status_id,religion_id:Yn.religion_id,city_id:Yn.city_id,drinking_id:Yn.drinking_id,smoking_id:Yn.smoking_id,eating_id:Yn.eating_id,match_intent:"LoveCommitment"};d(Yn),K(oi),g(oi),ie(Yn.about||""),I(Yn.about||""),ue(Yn.name||""),te(Yn.username||""),Te(Yn.dob||""),je(Yn.gender||""),ze(Yn.email||""),ke(`+${Yn.country_code} ${Yn.number}`||""),M([18,25])}),Ur.get(`/users/${Ht}/interests`,{headers:{token:kt==null?void 0:kt.token}}).then(Jt=>{var oi;const tn=((oi=Jt.data)==null?void 0:oi.interests)||[];tn.map(Ri=>{var Ii,sa,ar;const jr=(sa=(Ii=Ri.interest)==null?void 0:Ii.category)==null?void 0:sa.e_name,dr=(ar=Ri.interest)==null?void 0:ar.e_name;return`${jr}-${dr}`});const Yn=tn.map(Ri=>{var jr;return(jr=Ri.interest)==null?void 0:jr.id});rt(Yn),x(Yn)}).catch(Jt=>{console.error("Failed to fetch interests:",Jt),le([]),x([])}))},[]),q.useEffect(()=>{Ur.get("/dropdowns").then(kt=>{et(kt.data)}),Ur.get("/locations").then(kt=>{qe(kt.data)})},[]);const Pt=o==null?void 0:o.token,_n=kt=>{const{name:Ht,value:Jt}=kt.target;K(tn=>({...tn,[Ht]:Jt}))},Gt=kt=>{Lt("");const Ht=kt.id;if(Ae.includes(Ht))rt(Ae.filter(tn=>tn!==Ht));else{if(Ae.length>=XOe){Lt("You can only select up to 5 interests.");return}rt([...Ae,Ht])}},zt=async kt=>{try{await Ur.post("/users/interests",{interest_ids:kt},{headers:{token:localStorage.getItem("authToken")||Pt}})}catch(Ht){throw console.error("Failed to update interests:",Ht),Ht}},rn=async kt=>{kt.preventDefault();const Ht={name:fe,username:de,dob:ye,gender:Le},Jt=JSON.stringify(V)!==JSON.stringify(h),tn=Ht.name!==o.name||Ht.username!==o.username||Ht.dob!==o.dob||Ht.gender!==o.gender,Yn=Q!==T,oi=JSON.stringify(Ae)!==JSON.stringify(k),Ri=JSON.stringify(X)!==JSON.stringify(N);try{if(tn){await Ur.put("/profile",Ht,{headers:{token:Pt,"Content-Type":"application/json"}});const jr={...o,...Ht};localStorage.setItem("user_Data",JSON.stringify(jr)),d(jr)}(Jt||Yn||Ri)&&await Ur.put("/personalise",{...V,about:Q,distance_range:X,match_intent:"LoveCommitment"},{headers:{token:Pt,"Content-Type":"application/json"}}),oi&&Ae.length>0&&await zt(Ae),g(V),I(Q),M(X),x(Ae),alert("Profile updated successfully!")}catch(jr){console.error("Update failed:",jr),alert("Something went wrong during update.")}},ir=kt=>{const Ht=$e.find(Jt=>Jt.name.toLowerCase().includes(kt));return(Ht==null?void 0:Ht.sub_categories)||[]};return j.jsxs("form",{className:"main-image-content-2",onSubmit:rn,children:[j.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[j.jsxs("div",{children:[j.jsx("label",{className:"block text-sm mb-1",children:"Full Name*"}),j.jsx("input",{className:"input",placeholder:"Enter your full name",value:fe,onChange:kt=>ue(kt.target.value)})]}),j.jsxs("div",{children:[j.jsx("label",{className:"block text-sm mb-1",children:"User Name*"}),j.jsx("input",{className:"input",placeholder:"Enter your username",value:de,onChange:kt=>te(kt.target.value)})]}),j.jsxs("div",{children:[j.jsx("label",{className:"block text-sm mb-1",children:"Mobile Number*"}),j.jsx("input",{className:"input",placeholder:"Enter your mobile number",value:he,readOnly:!0})]}),j.jsxs("div",{children:[j.jsx("label",{className:"block text-sm mb-1",children:"Date of Birth*"}),j.jsx("input",{className:"input",type:"date",value:ye,onChange:kt=>Te(kt.target.value)})]}),j.jsxs("div",{children:[j.jsx("label",{className:"block text-sm mb-1",children:"Email*"}),j.jsx("input",{className:"input",placeholder:"Enter your email",value:We,readOnly:!0})]}),j.jsxs("div",{children:[j.jsx("label",{className:"block text-sm font-medium mb-1",children:"Distance Preference (km)"}),j.jsxs("div",{className:"flex justify-between text-sm text-gray-700 font-semibold mb-1 px-1",children:[j.jsxs("span",{children:[X[0]," km"]}),j.jsxs("span",{children:[X[1]," km"]})]}),j.jsx(qOe,{min:1,max:100,step:1,value:X,onInput:Z,className:"!h-3"})]}),j.jsxs("div",{children:[j.jsx("label",{className:"block text-sm mb-1",children:"Gender"}),j.jsx("div",{className:"flex gap-4",children:["Male","Female","Prefer not to say"].map(kt=>j.jsxs("label",{className:"flex items-center gap-2",children:[j.jsx("input",{type:"radio",name:"gender",value:kt,checked:Le===kt,onChange:()=>je(kt),className:"accent-blue-500"}),j.jsx("span",{className:"text-sm",children:kt})]},kt))})]}),j.jsxs("div",{children:[j.jsx("label",{className:"block text-sm mb-1",children:"Location*"}),j.jsx("input",{className:"input",placeholder:"Enter your Location",value:o.cityAndCountryName&&o.cityAndCountryName.country?`${o.cityAndCountryName.e_name}, ${o.cityAndCountryName.country.e_name}`:"",readOnly:!0})]})]}),j.jsx("span",{children:"General Information"}),j.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-5",children:[{label:"Education",name:"education_id",key:"education"},{label:"Profession",name:"profession_id",key:"profession"},{label:"Language",name:"language_id",key:"language"},{label:"Status",name:"status_id",key:"status"},{label:"Religion",name:"religion_id",key:"religion"},{label:"Location",name:"city_id",key:"city"}].map(({label:kt,name:Ht,key:Jt})=>j.jsxs("div",{children:[j.jsxs("label",{className:"block text-sm mb-1",children:["Select Your ",kt,j.jsx("span",{className:"text-red-500",children:"*"})]}),j.jsxs("select",{name:Ht,value:V[Ht],onChange:_n,className:"input",children:[j.jsx("option",{value:"",children:`Select Your ${kt}`}),Jt==="city"?Oe.map(tn=>j.jsx("option",{value:tn.id,children:tn.e_name},tn.id)):ir(Jt).map(tn=>j.jsx("option",{value:tn.id,children:tn.e_name},tn.id))]})]},Ht))}),j.jsx("span",{children:"Life Style"}),j.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-5",children:[{label:"Drinking",name:"drinking_id",key:"drinking"},{label:"Smoking",name:"smoking_id",key:"smoking"},{label:"Eating",name:"eating_id",key:"eating"}].map(({label:kt,name:Ht,key:Jt})=>j.jsxs("div",{children:[j.jsxs("label",{className:"block text-sm mb-1",children:[kt,j.jsx("span",{className:"text-red-500",children:"*"})]}),j.jsxs("select",{name:Ht,value:V[Ht],onChange:_n,className:"input",children:[j.jsx("option",{value:"",children:`Select Your ${kt}`}),Jt==="city"?Oe.map(tn=>j.jsx("option",{value:tn.id,children:tn.e_name},tn.id)):ir(Jt).map(tn=>j.jsx("option",{value:tn.id,children:tn.e_name},tn.id))]})]},Ht))}),j.jsxs("div",{children:[j.jsx("label",{className:"block text-sm mb-1",children:"About Yourself"}),j.jsx("textarea",{className:"input",placeholder:"Write a brief description (300 characters)",rows:"3",value:Q,onChange:kt=>ie(kt.target.value)})]}),j.jsxs("div",{children:[j.jsx("label",{className:"block text-sm font-medium mb-1",children:"Your Interest"}),j.jsx("p",{className:"text-sm mb-2",children:"Select up to 5 interests"}),j.jsx("div",{className:"space-y-4",children:lt.map(kt=>j.jsxs("div",{children:[j.jsxs("h3",{className:"text-gray-700 font-semibold flex items-center gap-2 mb-2",children:[kt.url&&j.jsx("img",{src:kt.url,alt:kt.e_name,className:"w-5 h-5 rounded-full"}),kt.e_name]}),j.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:kt.category.map(Ht=>j.jsxs("button",{type:"button",onClick:()=>Gt({...Ht}),className:`px-4 py-2 rounded-full text-sm font-medium transition-all flex items-center gap-2
                  ${Ae.includes(Ht.id)?"bg-gradient-to-r from-[#00D4FF] to-[#00A3E0] text-white":"bg-gradient-to-r from-[#FF9999] to-[#FF999980] text-white"}
                `,children:[Ht.url&&j.jsx("img",{src:Ht.url,alt:Ht.e_name,className:"w-4 h-4 rounded-full"}),Ht.e_name]},Ht.id))})]},kt.id))})]}),j.jsx("button",{type:"submit",className:"w-full bg-gradient-to-r from-cyan-500 to-blue-500 text-white py-2 rounded-xl font-semibold hover:opacity-90",children:"UPDATE"}),j.jsx("div",{className:"pt-2",children:yt&&j.jsx("p",{className:`mt-2 text-center text-sm ${yt.startsWith("")?"text-green-600":"text-red-600"}`,children:yt})})]})}function $Oe(){return j.jsx("div",{className:"flex bg-gray-100 min-h-screen",children:j.jsx("div",{className:"flex flex-col w-full gap-4",children:j.jsx(JOe,{})})})}const eNe="data:image/svg+xml,%3csvg%20width='30'%20height='30'%20viewBox='0%200%2030%2030'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20clip-path='url(%23clip0_4754_4430)'%3e%3cpath%20d='M27.239%2012.1063C26.8687%2011.8576%2026.5343%2011.5592%2026.2451%2011.2195C26.2667%2010.7467%2026.3618%2010.2802%2026.5271%209.83667C26.8373%208.78452%2027.2245%207.47564%2026.479%206.45174C25.7275%205.41943%2024.3561%205.38516%2023.254%205.3569C22.7903%205.37547%2022.3264%205.32564%2021.8772%205.209C21.6304%204.82165%2021.442%204.40007%2021.318%203.95784C20.9501%202.91049%2020.4919%201.60703%2019.2654%201.20841C18.075%200.821219%2017.0066%201.55652%2016.0645%202.20285C15.6858%202.50519%2015.2606%202.74417%2014.8055%202.91049C14.3501%202.74434%2013.9247%202.50535%2013.5459%202.20285C12.605%201.55592%2011.536%200.823022%2010.3462%201.20901C9.11967%201.60763%208.66153%202.91049%208.29358%203.95784C8.1697%204.39787%207.98321%204.81782%207.73985%205.20479C7.28923%205.32502%206.823%205.37631%206.35702%205.3569C5.25496%205.38516%203.88355%205.42003%203.13262%206.45234C2.38709%207.47684%202.77368%208.78512%203.08452%209.83727C3.24781%2010.2785%203.34368%2010.7419%203.3689%2011.2117C3.08066%2011.5562%202.74457%2011.8577%202.37086%2012.1069C1.48224%2012.7845%200.375977%2013.6286%200.375977%2014.9351C0.375977%2016.2416%201.48224%2017.0857%202.37206%2017.7639C2.74235%2018.0126%203.07674%2018.311%203.3659%2018.6507C3.34432%2019.1235%203.24918%2019.59%203.08392%2020.0335C2.77368%2021.0857%202.38649%2022.3946%203.13202%2023.4185C3.88355%2024.4502%205.25496%2024.485%206.35702%2024.5133C6.82073%2024.4947%207.28465%2024.5446%207.73383%2024.6612C7.98061%2025.0486%208.16901%2025.4701%208.29298%2025.9124C8.66153%2026.9597%209.11907%2028.2632%2010.3462%2028.6618C10.5635%2028.7333%2010.7908%2028.7698%2011.0196%2028.77C11.943%2028.77%2012.786%2028.1898%2013.5471%2027.6674C13.9256%2027.3651%2014.3506%2027.1261%2014.8055%2026.9597C15.2607%2027.1259%2015.6859%2027.3649%2016.0645%2027.6674C17.0066%2028.3143%2018.075%2029.0466%2019.2654%2028.6618C20.4919%2028.2632%2020.9501%2026.9603%2021.318%2025.913C21.4417%2025.473%2021.628%2025.053%2021.8712%2024.666C22.3218%2024.5458%2022.788%2024.4945%2023.254%2024.5139C24.3561%2024.4856%2025.7281%2024.4508%2026.479%2023.4185C27.2245%2022.394%2026.8379%2021.0857%2026.5271%2020.0335C26.3638%2019.5923%2026.2679%2019.1289%2026.2427%2018.6591C26.5308%2018.3146%2026.8667%2018.0132%2027.2402%2017.7639C28.1288%2017.0857%2029.235%2016.2416%2029.235%2014.9351C29.235%2013.6286%2028.1288%2012.7845%2027.239%2012.1063ZM20.1649%2012.7797L14.1526%2018.792C13.9271%2019.0174%2013.6213%2019.1441%2013.3024%2019.1441C12.9836%2019.1441%2012.6778%2019.0174%2012.4523%2018.792L9.44614%2015.7858C9.33442%2015.6742%209.24578%2015.5416%209.18529%2015.3958C9.12479%2015.2499%209.09363%2015.0935%209.09357%2014.9355C9.09352%2014.7776%209.12457%2014.6212%209.18496%2014.4752C9.24535%2014.3293%209.3339%2014.1967%209.44554%2014.085C9.55718%2013.9732%209.68973%2013.8846%209.83563%2013.8241C9.98153%2013.7636%2010.1379%2013.7325%2010.2959%2013.7324C10.4538%2013.7323%2010.6102%2013.7634%2010.7561%2013.8238C10.9021%2013.8842%2011.0347%2013.9727%2011.1464%2014.0844L13.3024%2016.241L18.4646%2011.0788C18.5755%2010.964%2018.7082%2010.8724%2018.8549%2010.8093C19.0016%2010.7463%2019.1594%2010.7131%2019.3191%2010.7118C19.4787%2010.7104%2019.6371%2010.7408%2019.7848%2010.8013C19.9326%2010.8617%2020.0669%2010.951%2020.1798%2011.0639C20.2927%2011.1768%2020.382%2011.3111%2020.4424%2011.4588C20.5029%2011.6066%2020.5333%2011.765%2020.5319%2011.9246C20.5305%2012.0843%2020.4974%2012.2421%2020.4343%2012.3888C20.3713%2012.5355%2020.2797%2012.6682%2020.1649%2012.7791V12.7797Z'%20fill='url(%23paint0_linear_4754_4430)'/%3e%3c/g%3e%3cdefs%3e%3clinearGradient%20id='paint0_linear_4754_4430'%20x1='0.322199'%20y1='3.86786'%20x2='27.8459'%20y2='2.41911'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20offset='0.145353'%20stop-color='%2300D4FF'/%3e%3cstop%20offset='1'%20stop-color='%2300A3E0'/%3e%3c/linearGradient%3e%3cclipPath%20id='clip0_4754_4430'%3e%3crect%20width='28.8591'%20height='28.8591'%20fill='white'%20transform='translate(0.375977%200.505585)'/%3e%3c/clipPath%3e%3c/defs%3e%3c/svg%3e",tNe="data:image/svg+xml,%3csvg%20width='13'%20height='12'%20viewBox='0%200%2013%2012'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M7.30045%205.98186L12.0326%2010.7165C12.2698%2010.9538%2012.2698%2011.3385%2012.0326%2011.5757C11.7955%2011.813%2011.411%2011.813%2011.1738%2011.5757L6.44165%206.84107L1.70948%2011.5757C1.47233%2011.813%201.08784%2011.813%200.850715%2011.5757C0.613586%2011.3384%200.613564%2010.9537%200.850715%2010.7165L5.58288%205.98186L0.850715%201.24723C0.613564%201.00995%200.613564%200.625269%200.850715%200.388017C1.08787%200.150742%201.47235%200.150764%201.70948%200.388017L6.44165%205.12265L11.1738%200.388017C11.4109%200.150742%2011.7954%200.150764%2012.0326%200.388017C12.2697%200.625292%2012.2697%201.00997%2012.0326%201.24723L7.30045%205.98186Z'%20fill='white'/%3e%3c/svg%3e",nNe="data:image/svg+xml,%3csvg%20width='16'%20height='15'%20viewBox='0%200%2016%2015'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M8.02539%200.536316C8.14335%200.536383%208.25963%200.56395%208.36621%200.616394L8.46875%200.676941C8.56812%200.74605%208.6523%200.837283%208.71387%200.944519L8.76758%201.05682L10.2334%204.73749L10.291%204.88104L10.4443%204.89374L14.2451%205.2121V5.21112C14.4018%205.22496%2014.5518%205.28713%2014.6768%205.38983C14.7706%205.46707%2014.8478%205.56509%2014.9014%205.67694L14.9473%205.79315C14.9849%205.91336%2014.9965%206.04071%2014.9814%206.16522L14.957%206.28925C14.9133%206.4518%2014.8243%206.59578%2014.7031%206.70428L14.0547%207.28534L14.0576%207.28436L11.8086%209.29803L11.6982%209.39667L11.7314%209.54022L12.6143%2013.4201V13.4211C12.6427%2013.5441%2012.6447%2013.6715%2012.6201%2013.7941L12.5869%2013.9152C12.5447%2014.0338%2012.4777%2014.14%2012.3926%2014.2267L12.3018%2014.3068C12.173%2014.4039%2012.0203%2014.4584%2011.8633%2014.465L11.7451%2014.4611C11.6673%2014.4524%2011.591%2014.4315%2011.5186%2014.3996L11.4141%2014.3439L8.16113%2012.2678L8.02637%2012.1818L7.89258%2012.2678L4.63672%2014.3439C4.50138%2014.4289%204.34597%2014.4708%204.18945%2014.4641L4.07324%2014.4494C3.99618%2014.4342%203.92149%2014.4073%203.85156%2014.3693L3.75098%2014.3049C3.65454%2014.232%203.57423%2014.1376%203.5166%2014.0285L3.4668%2013.9142C3.42464%2013.7957%203.40839%2013.6692%203.41895%2013.5441L3.43848%2013.4201L4.3252%209.54022L4.3584%209.39667L4.24805%209.29803L1.34961%206.70428C1.22868%206.59589%201.13948%206.45154%201.0957%206.28925C1.06285%206.16741%201.05715%206.03996%201.07715%205.9162L1.10547%205.79413C1.14289%205.67408%201.20483%205.56516%201.28613%205.47479L1.37402%205.39081C1.49798%205.28831%201.6471%205.22589%201.80273%205.21112L1.80371%205.2121L5.60449%204.89374L5.75879%204.88104L5.81641%204.73749L7.28223%201.05682C7.32848%200.939932%207.39917%200.836334%207.4873%200.753113L7.58105%200.676941C7.71327%200.585036%207.86808%200.536316%208.02539%200.536316Z'%20stroke='white'%20stroke-width='0.5'/%3e%3c/svg%3e",rNe="data:image/svg+xml,%3csvg%20width='29'%20height='22'%20viewBox='0%200%2029%2022'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M22.3413%2016.8608V13.3336H18.408V10.9821H22.3413V7.45489H24.9635V10.9821H28.8968V13.3336H24.9635V16.8608H22.3413ZM13.1637%2021.5638L9.00094%2018.2129C7.42763%2016.9392%206.07808%2015.8026%204.95229%2014.8033C3.8265%2013.8039%202.89781%2012.8633%202.16622%2011.9815C1.43463%2011.0997%200.899266%2010.2473%200.56013%209.42425C0.220995%208.60124%200.0518637%207.73903%200.0527377%206.83763C0.0527377%204.99563%200.741061%203.46247%202.11771%202.23813C3.49435%201.0138%205.2097%200.401235%207.26374%200.400452C8.40002%200.400452%209.48168%200.611301%2010.5087%201.033C11.5357%201.4547%2012.4207%202.05707%2013.1637%202.84011C13.9066%202.05628%2014.7916%201.45391%2015.8186%201.033C16.8456%200.612085%2017.9273%200.401235%2019.0636%200.400452C20.921%200.400452%2022.4781%200.905236%2023.735%201.9148C24.9919%202.92437%2025.7729%204.10482%2026.0779%205.45613C25.6846%205.31896%2025.2913%205.21628%2024.8979%205.14809C24.5046%205.0799%2024.1222%205.04541%2023.7507%205.04462C21.5437%205.04462%2019.6645%205.73557%2018.113%207.11745C16.5616%208.49934%2015.7858%2010.1795%2015.7858%2012.1578C15.7858%2013.1768%2016.0153%2014.1421%2016.4742%2015.0537C16.9331%2015.9653%2017.5777%2016.744%2018.408%2017.3899C17.9929%2017.723%2017.4522%2018.1494%2016.7862%2018.6691C16.1202%2019.1888%2015.5464%2019.6442%2015.0647%2020.0353L13.1637%2021.5638Z'%20fill='white'/%3e%3c/svg%3e",iNe="/assets/blueheart-aaHlBVUR.png",aNe="data:image/svg+xml,%3csvg%20width='27'%20height='24'%20viewBox='0%200%2027%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M8.56275%201.80997C4.91028%201.80997%201.94922%204.77103%201.94922%208.4235C1.94922%2015.037%209.76522%2021.0493%2013.9738%2022.4478C18.1824%2021.0493%2025.9984%2015.037%2025.9984%208.4235C25.9984%204.77103%2023.0374%201.80997%2019.3849%201.80997C17.1483%201.80997%2015.1703%202.92044%2013.9738%204.62012C13.3639%203.75157%2012.5537%203.04274%2011.6118%202.55359C10.6699%202.06444%209.62408%201.80937%208.56275%201.80997Z'%20fill='%23EDC65D'%20stroke='%23EDC65D'%20stroke-width='2'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",Qle=({id:o,name:d,age:h,distance:g,interests:T,occupation:I,rating:N,image:M,onInteract:k,flag:x="home",handleShowAboutUser:V})=>{const Q=Sy().pathname==="/dashboard/home";return j.jsxs("div",{className:"relative w-full max-w-[290px] h-[24rem] rounded-3xl overflow-hidden shadow-2xl  bg-white",style:{cursor:"pointer"},onClick:()=>V(o),children:[j.jsx("div",{className:"absolute inset-0 bg-cover bg-center",style:{backgroundImage:`url(${M})`}}),j.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-black/30 to-transparent z-10"}),j.jsxs("div",{className:"rating-badge absolute top-0 left-0 z-20 flex items-center text-white text-sm",children:[j.jsx("div",{className:"flex items-center space-x-1",children:j.jsxs("div",{className:"relative w-6 h-6",children:[j.jsx("img",{src:aNe,alt:"golden heart",className:"w-full h-full"}),j.jsx("img",{src:iNe,alt:"blue heart",className:"absolute inset-0 w-3 h-3 m-auto"})]})}),Q?j.jsx("span",{className:"ml-2 font-semibold",children:3.5}):j.jsx("span",{className:"text-white text-sm font-medium",children:N})]}),j.jsx("div",{className:"absolute top-2 right-2 z-20 tick-badge",children:j.jsx("img",{src:eNe,alt:"verified",className:"w-4 h-4"})}),x!=="matches"&&j.jsxs("div",{className:"action-buttons absolute bottom-20 w-full z-20 flex justify-center items-center gap-3",children:[j.jsx("div",{className:"flex flex-col items-center",children:j.jsxs("div",{className:"relative flex flex-col items-center group",children:[j.jsx("button",{className:"cross-button h-10 w-10 p-2 rounded-full shadow-md border-2 border-white bg-red-300",onClick:()=>k(o,"pass",{id:o,name:d,age:h,distance:g,interests:T,occupation:I,rating:N,image:M}),children:j.jsx("img",{src:tNe,alt:"pass",className:"w-full h-full object-contain"})}),j.jsx("div",{className:"absolute bottom-8 z-10 flex-col items-center hidden mb-2 group-hover:flex",children:j.jsxs("div",{className:"relative px-2 py-1 text-sm text-black bg-white rounded-md shadow-lg font-medium",children:["Pass",j.jsx("div",{className:"absolute left-1/2 -bottom-1.5 transform -translate-x-1/2 w-3 h-3 bg-white rotate-45 z-0"})]})})]})}),j.jsx("div",{className:"flex flex-col items-center",children:j.jsxs("div",{className:"relative flex flex-col items-center group",children:[j.jsx("button",{className:"heart-button h-12 w-12 p-2 rounded-full shadow-md border-2 border-white",onClick:()=>k(o,"save",{id:o,name:d,age:h,distance:g,interests:T,occupation:I,rating:N,image:M}),children:j.jsx("img",{src:rNe,alt:"heart",className:"w-full h-full object-contain"})}),j.jsx("div",{className:"absolute bottom-10 z-10 flex-col items-center hidden mb-2 group-hover:flex",children:j.jsxs("div",{className:"relative px-2 py-1 text-sm text-black bg-white rounded-md shadow-lg font-medium",children:["Save",j.jsx("div",{className:"absolute left-1/2 -bottom-1.5 transform -translate-x-1/2 w-3 h-3 bg-white rotate-45 z-0"})]})})]})}),j.jsx("div",{className:"flex flex-col items-center",children:j.jsxs("div",{className:"relative flex flex-col items-center group",children:[j.jsx("button",{className:"star-button h-10 w-10 p-2 rounded-full shadow-md border-2 border-white",onClick:()=>k(o,"like",{id:o,name:d,age:h,distance:g,interests:T,occupation:I,rating:N,image:M}),children:j.jsx("img",{src:nNe,alt:"like",className:"w-full h-full object-contain"})}),j.jsx("div",{className:"absolute bottom-8 z-10 flex-col items-center hidden mb-2 group-hover:flex",children:j.jsxs("div",{className:"relative px-2 py-1 text-sm text-black bg-white rounded-md shadow-lg font-medium",children:["Like",j.jsx("div",{className:"absolute left-1/2 -bottom-1.5 transform -translate-x-1/2 w-3 h-3 bg-white rotate-45 z-0"})]})})]})})]}),j.jsxs("div",{className:" bottom-card-bar absolute bottom-0 w-full text-white text-center px-4 pb-3 pt-4 z-20 backdrop-blur-md bg-black/40 rounded-t-xl",children:[j.jsxs("h2",{className:"mt-3 user-detail text-base font-semibold truncate",children:[d,", ",h,"Yr, ",g]}),j.jsxs("p",{className:"text-sm interest-user truncate",children:[j.jsx("strong",{children:"Interests"}),":",Array.isArray(T)?` ${T.slice(0,2).join(", ")}${T.length>2?"...":""}`:` ${T.split(",").slice(0,2).join(", ")}${T.split(",").length>2?"...":""}`]}),j.jsxs("p",{className:"text-sm interest-user truncate",children:[j.jsx("strong",{children:"Occupation"}),": ",(I==null?void 0:I.split(",")[0])||I]})]})]})},sNe="data:image/svg+xml,%3csvg%20width='22'%20height='22'%20viewBox='0%200%2022%2022'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M16.4997%2011.9167H5.49967C4.94967%2011.9167%204.58301%2011.55%204.58301%2011C4.58301%2010.45%204.94967%2010.0833%205.49967%2010.0833H16.4997C17.0497%2010.0833%2017.4163%2010.45%2017.4163%2011C17.4163%2011.55%2017.0497%2011.9167%2016.4997%2011.9167ZM13.7497%2017.4167H8.24967C7.69967%2017.4167%207.33301%2017.05%207.33301%2016.5C7.33301%2015.95%207.69967%2015.5833%208.24967%2015.5833H13.7497C14.2997%2015.5833%2014.6663%2015.95%2014.6663%2016.5C14.6663%2017.05%2014.2997%2017.4167%2013.7497%2017.4167ZM19.2497%206.41666H2.74967C2.19967%206.41666%201.83301%206.05%201.83301%205.5C1.83301%204.94999%202.19967%204.58333%202.74967%204.58333H19.2497C19.7997%204.58333%2020.1663%204.94999%2020.1663%205.5C20.1663%206.05%2019.7997%206.41666%2019.2497%206.41666Z'%20fill='white'/%3e%3c/svg%3e",oP=({label:o,options:d,selected:h,onToggle:g})=>j.jsxs("div",{className:"mb-6",children:[j.jsx("p",{className:"text-sm text-pink-500 font-medium mb-2",children:o}),j.jsx("div",{className:"flex flex-wrap gap-2",children:d.map(T=>{const I=h.includes(T);return j.jsx("button",{onClick:()=>g(T),className:`
              px-4 py-1 text-sm rounded-full
              ${I?"bg-[linear-gradient(87.11deg,_#00A3E0_4.15%,_#00D4FF_81.96%)] text-white":"bg-[#F2F4F7] text-gray-700 hover:bg-gray-200"}
            `,children:T},T)})})]});function Zle({setProfiles:o,setLoading:d}){const[h,g]=q.useState(!1),[T,I]=q.useState(""),[N,M]=q.useState(0),k=21,x=70,[V,K]=q.useState(),[Q,ie]=q.useState(),X=Ge=>(Ge-k)/(x-k)*100,[Z,ae]=q.useState(""),[le,fe]=q.useState([]),[ue,de]=q.useState([]),[te,ye]=q.useState([]),[Te,Le]=q.useState(""),[je,he]=q.useState(null),ke=()=>{d(!0),Ur.get("/users/matches?start=0&limit=8").then(Ge=>{o(Ge.data.list||[])}).catch(()=>{}).finally(()=>{d(!1),I(""),M(0),K(k),ie(x),ae(""),fe([]),de([]),ye([]),Le(""),he(null),g(!1)})},We=(Ge,Ae,rt)=>Ge.includes(rt)?Ae(Ge.filter(yt=>yt!==rt)):Ae([...Ge,rt]),ze=Ge=>We(le,fe,Ge),$e=Ge=>We(ue,de,Ge),et=Ge=>We(te,ye,Ge),Oe=async()=>{d(!0);try{const Ge={start:0,limit:8,search:T||void 0,min_age:V||void 0,max_age:Q||void 0,distance:N||void 0,gender:Z||void 0,interests:le.length?le:void 0,languages:ue.length?ue:void 0,religions:te.length?te:void 0,match_intent:Te||void 0,is_verified:je},{data:Ae}=await Ur.get("/users/matches",{params:Ge});o(Ae.list||[])}catch(Ge){console.error(Ge)}d(!1),g(!1)};q.useEffect(()=>{T.length>=3&&Oe()},[T]);const qe=Ge=>{I(Ge.target.value),console.log("seeee",T)},lt=async Ge=>{d(!0);try{const Ae={start:0,limit:8,search:T||void 0,min_age:V||void 0,max_age:Q||void 0,distance:N||void 0,gender:Ge||void 0,interests:le.length?le:void 0,languages:ue.length?ue:void 0,religions:te.length?te:void 0,match_intent:Te||void 0,is_verified:je},{data:rt}=await Ur.get("/users/matches",{params:Ae});o(rt.list||[])}catch(Ae){console.error(Ae)}d(!1),g(!1)};return j.jsxs(j.Fragment,{children:[j.jsxs("div",{className:"w-full flex flex-wrap items-center gap-4 md:gap-6 px-4 md:px-8 py-4 bg-white shadow",children:[j.jsxs("div",{className:"flex items-center flex-grow md:flex-none md:w-[500px] border border-gray-200 rounded-full px-4 py-2",style:{height:"60px"},children:[j.jsx("input",{type:"text",placeholder:"Search by name...",className:"flex-grow outline-none text-sm text-gray-700",value:T,onChange:qe}),j.jsx(sve,{className:"w-4 h-4 text-gray-400"})]}),j.jsx("div",{className:"flex flex-wrap items-center gap-4 md:gap-8 pl-0 md:pl-8 text-sm font-medium text-gray-700",children:["Random","Male","Female"].map((Ge,Ae)=>j.jsxs("span",{onClick:()=>{ae(Ge),lt(Ge)},className:`flex items-center gap-1 cursor-pointer ${Z===Ge?"text-cyan-600":"text-gray-700"}`,style:{fontFamily:"Rubik",fontWeight:500,fontSize:"18px",lineHeight:"20px",letterSpacing:"0px",verticalAlign:"middle"},children:[j.jsx(OA,{className:"w-4 h-4"}),Ge==="Male"?"Men":Ge==="Female"?"Women":"Random"]},Ge))}),j.jsx("div",{className:"ml-auto",children:j.jsxs("button",{onClick:()=>g(!0),className:"flex items-center justify-center gap-2 text-white px-5 py-2 rounded-full hover:bg-cyan-500 text-sm font-medium shadow",style:{width:"150px",height:"50px",borderRadius:"100px",opacity:1,background:"linear-gradient(87.11deg, #00D4FF 17.38%, #00A3E0 95.19%)"},children:[j.jsx("img",{src:sNe,alt:"Filter",className:"w-6 h-6"}),j.jsx("span",{style:{fontFamily:"Rubik,sans-serif",fontWeight:400,fontSize:"20px",lineHeight:"20px",letterSpacing:"0px",verticalAlign:"middle"},children:"Filter"})]})})]}),j.jsx("div",{className:`
          fixed inset-y-0 right-0 z-50 w-full sm:w-[420px] bg-white shadow-lg
          transform transition-transform duration-300
          ${h?"translate-x-0":"translate-x-full"}
        `,children:j.jsxs("div",{className:`
            p-6 h-full flex flex-col overflow-y-auto
            [&::-webkit-scrollbar]:hidden [-ms-overflow-style:none] [scrollbar-width:none]
          `,children:[j.jsx("div",{className:"flex justify-end mb-4",children:j.jsx(YX,{className:"w-5 h-5 cursor-pointer hover:text-red-500",onClick:()=>g(!1)})}),j.jsxs("div",{className:"flex justify-between items-center mb-4",children:[j.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Filter & Show"}),j.jsx("div",{children:j.jsx("button",{className:"text-sm text-red-500 underline",onClick:()=>ke(),children:"Reset all"})})]}),j.jsxs("div",{className:"mb-6",children:[j.jsx("p",{className:"text-sm text-pink-500 font-medium mb-1",children:"Distance range"}),j.jsx("input",{type:"range",min:"0",max:"500",value:N,onChange:Ge=>M(Ge.target.value),className:"w-full accent-cyan-400"}),j.jsxs("div",{className:"flex justify-between text-xs text-gray-500",children:[j.jsx("span",{children:"0.00 km"}),j.jsx("span",{children:"500.00 km"})]})]}),j.jsxs("div",{className:"mb-6",children:[j.jsx("p",{className:"text-sm text-pink-500 font-medium mb-1",children:"Age"}),j.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mb-1",children:[j.jsx("span",{children:V}),j.jsx("span",{children:Q})]}),j.jsxs("div",{className:"relative h-2",children:[j.jsx("div",{className:"absolute inset-0 bg-gray-300 rounded-full"}),j.jsx("div",{className:"absolute h-2 bg-cyan-400 rounded-full",style:{left:`${X(V)}%`,width:`${X(Q)-X(V)}%`}}),j.jsx("input",{type:"range",min:k,max:x,value:V,onChange:Ge=>{const Ae=Math.min(Number(Ge.target.value),Q-1);K(Ae)},className:`
                  absolute w-full h-2 appearance-none bg-transparent
                  pointer-events-none
                  [&::-webkit-slider-thumb]:pointer-events-auto
                  [&::-webkit-slider-thumb]:w-4
                  [&::-webkit-slider-thumb]:h-4
                  [&::-webkit-slider-thumb]:rounded-full
                  [&::-webkit-slider-thumb]:bg-white
                  [&::-webkit-slider-thumb]:border-2
                  [&::-webkit-slider-thumb]:border-cyan-400
                  [&::-webkit-slider-thumb]:-mt-1
                `}),j.jsx("input",{type:"range",min:k,max:x,value:Q,onChange:Ge=>{const Ae=Math.max(Number(Ge.target.value),V+1);ie(Ae)},className:`
                  absolute w-full h-2 appearance-none bg-transparent
                  pointer-events-none
                  [&::-webkit-slider-thumb]:pointer-events-auto
                  [&::-webkit-slider-thumb]:w-4
                  [&::-webkit-slider-thumb]:h-4
                  [&::-webkit-slider-thumb]:rounded-full
                  [&::-webkit-slider-thumb]:bg-white
                  [&::-webkit-slider-thumb]:border-2
                  [&::-webkit-slider-thumb]:border-cyan-400
                  [&::-webkit-slider-thumb]:-mt-1
                `})]})]}),j.jsx(oP,{label:"Search Preferences",options:["Male","Female","Random"],selected:Z?[Z]:[],onToggle:Ge=>ae(Ge==="Random"?"":Ge)}),j.jsx(oP,{label:"Interests",options:["Travel","Cooking","Hiking","Yoga","Gaming","Movies","Books","Animals","Wine","Comedy","Football","Meditation","Pet allowed"],selected:le,onToggle:ze}),j.jsx(oP,{label:"Languages I Know",options:["English","Gujarati","Hindi","Bengali","Portuguese","Russian","Japanese","Turkish","French","Korean","German","Vietnamese"],selected:ue,onToggle:$e}),j.jsx(oP,{label:"Religion",options:["Casual","Friendship","Dating","Buddhism","Judaism","Sikhism","Taoism","Jainism","Shintoism","Bah' Faith","Zoroastrianism"],selected:te,onToggle:et}),j.jsx(oP,{label:"Relationship Goals",options:["Love Commitment","Casual Fun"],selected:Te?[Te==="LoveCommitment"?"Love Commitment":"Casual Fun"]:[],onToggle:Ge=>{var Ae,rt;return Le(Te===((Ae=Ge==null?void 0:Ge.split(" "))==null?void 0:Ae.join(""))?"":(rt=Ge==null?void 0:Ge.split(" "))==null?void 0:rt.join(""))}}),j.jsx(oP,{label:"Verify Profile",options:["Unverify","Verify"],selected:je===!0?["Verify"]:je===!1?["Unverify"]:[],onToggle:Ge=>he(je===(Ge==="Verify")?null:Ge==="Verify")}),j.jsxs("div",{className:"flex justify-between mt-auto pt-4 border-t border-gray-200",children:[j.jsx("button",{className:`
                w-1/2 mr-2 px-4 py-2
                bg-gradient-to-r from-[#00A3E0] to-[#00D4FF]
                text-white rounded-full hover:opacity-90 transition
              `,onClick:ke,children:"Reset"}),j.jsx("button",{className:`
                w-1/2 ml-2 px-4 py-2
                bg-gradient-to-r from-[#FFC5C5] to-[#FF9999]
                text-white rounded-full hover:opacity-90 transition
              `,onClick:Oe,children:"Apply"})]})]})})]})}const oNe="data:image/svg+xml,%3csvg%20width='42'%20height='36'%20viewBox='0%200%2042%2036'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M12.3596%201C6.38962%201%201.5498%205.83982%201.5498%2011.8098C1.5498%2022.6195%2014.325%2032.4465%2021.2039%2034.7323C28.0828%2032.4465%2040.858%2022.6195%2040.858%2011.8098C40.858%205.83982%2036.0182%201%2030.0482%201C26.3926%201%2023.1595%202.81506%2021.2039%205.59316C20.2069%204.17353%2018.8827%203.01495%2017.3432%202.21544C15.8037%201.41593%2014.0943%200.999022%2012.3596%201Z'%20fill='url(%23paint0_linear_4754_4549)'%20stroke='url(%23paint1_linear_4754_4549)'%20stroke-width='2'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cdefs%3e%3clinearGradient%20id='paint0_linear_4754_4549'%20x1='2.33597'%20y1='-1.35868'%20x2='33.7825'%20y2='34.0187'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20stop-color='%23B37D33'/%3e%3cstop%20offset='0.5'%20stop-color='%23FEF18B'/%3e%3cstop%20offset='1'%20stop-color='%23D8B65E'/%3e%3c/linearGradient%3e%3clinearGradient%20id='paint1_linear_4754_4549'%20x1='2.33597'%20y1='-1.35868'%20x2='33.7825'%20y2='34.0187'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20stop-color='%23B37D33'/%3e%3cstop%20offset='0.5'%20stop-color='%23FEF18B'/%3e%3cstop%20offset='1'%20stop-color='%23D8B65E'/%3e%3c/linearGradient%3e%3c/defs%3e%3c/svg%3e",cNe="data:image/svg+xml,%3csvg%20width='43'%20height='36'%20viewBox='0%200%2043%2036'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M12.7463%201C6.77634%201%201.93652%205.83982%201.93652%2011.8098C1.93652%2022.6195%2014.7117%2032.4465%2021.5906%2034.7323C28.4695%2032.4465%2041.2447%2022.6195%2041.2447%2011.8098C41.2447%205.83982%2036.4049%201%2030.4349%201C26.7793%201%2023.5462%202.81506%2021.5906%205.59316C20.5937%204.17353%2019.2694%203.01495%2017.7299%202.21544C16.1904%201.41593%2014.481%200.999022%2012.7463%201Z'%20fill='%23979797'%20stroke='%23979797'%20stroke-width='2'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",lNe="/assets/pink%20heart%20logo-BSTvOCTY.svg",dNe="/assets/blue%20heart-CEN2pi2O.svg",uNe=({filled:o})=>j.jsx("div",{className:"relative w-10 h-10",children:o?j.jsxs(j.Fragment,{children:[j.jsx("img",{src:oNe,alt:"gold heart background",className:"w-full h-full absolute inset-0 object-contain"}),j.jsx("img",{src:dNe,alt:"logo inside gold heart",className:"absolute inset-0 w-5 h-5 m-auto rounded-full object-cover z-10"})]}):j.jsxs(j.Fragment,{children:[j.jsx("img",{src:cNe,alt:"blank heart background",className:"w-full h-full absolute inset-0 object-contain"}),j.jsx("img",{src:lNe,alt:"logo inside blank heart",className:"absolute inset-0 w-5 h-5 m-auto rounded-full object-cover z-10"})]})}),fNe=()=>{const[o,d]=q.useState(3),h=JSON.parse(localStorage.getItem("user_Data"))||{};h==null||h.id;const g=h.name||"Michael Dam";return h.email,j.jsxs("div",{className:"text-center",children:[j.jsx("div",{className:"flex gap-2 px-4 justify-center",children:[1,2,3,4,5].map((T,I)=>j.jsx("div",{onClick:()=>d(T),className:"cursor-pointer",children:j.jsx(uNe,{filled:T<=o})},I))}),j.jsxs("span",{className:"text-xs",children:[g," has earned ",o," out of 5 LoveAi hearts for volunteering & good deeds"]})]})},hNe=()=>{const o=xl(),d=()=>{o("/dashboard/subscription")};return j.jsxs("div",{className:"w-full flex justify-between items-center p-4 pr-8 bg-white shadow h-[14vh] mb-4",children:[j.jsxs("div",{className:"flex flex-col",children:[j.jsxs("div",{className:"flex items-center justify-center gap-2 text-sm text-gray-700",children:[j.jsx("span",{className:"text-[12px] font-bold ",children:"Good deeds points"}),j.jsx(Zse,{className:"w-3 h-3 text-gray-500 text-[10px]"})]}),j.jsx(fNe,{})]}),j.jsxs("div",{className:"flex items-center gap-4",children:[j.jsxs("button",{className:"flex bg-gradient-to-l from-[#FF9999] to-[#FFC5C5] rounded-2xl py-2 px-5 text-white font-medium shadow-md",onClick:d,children:[j.jsx(vEe,{className:"mr-2"}),"Upgrade Now"]}),j.jsxs("div",{className:"relative",children:[j.jsx(uEe,{className:"w-10 h-11 text-white bg-cyan-500 p-2 rounded-full"}),j.jsx("span",{className:"absolute -top-1 -right-1 bg-green-500 text-white text-xs w-4 h-4 rounded-full flex items-center justify-center",children:"1"})]}),j.jsxs("div",{className:"flex items-center text-sm text-gray-700 font-medium cursor-pointer",children:["English (UK)",j.jsx(hEe,{className:"w-4 h-4 ml-1 text-gray-500"})]})]})]})};function pNe(){const[o,d]=q.useState([]),[h,g]=q.useState(!0),[T,I]=q.useState(!0),[N,M]=q.useState(0),[k,x]=q.useState(null),V=xl(),K=q.useRef(),Q=(ae,le,fe)=>{Ur.post("/users/interact",{target_user_id:ae,action:le}).then(ue=>{d(de=>de.filter(te=>te.id!==ae)),ue.data.is_match&&x(fe)}).catch(ue=>{console.error("Interaction failed:",ue),alert("Interaction failed")})},ie=(ae=0)=>{g(!0),Ur.get(`/users/matches?start=${ae*4}&limit=4`).then(le=>{const fe=le.data.list||[];d(ue=>[...ue,...fe]),I(fe.length===4),g(!1)}).catch(le=>{console.error("Failed to fetch profiles",le),g(!1)})};q.useEffect(()=>{const ae=JSON.parse(localStorage.getItem("user_Data")),le=localStorage.getItem("userId");ae||Ur.get(`/users/${le}/info`).then(fe=>{localStorage.setItem("user_Data",JSON.stringify({...fe.data,token:localStorage.getItem("authToken")}))}).catch(fe=>{console.error("Failed to fetch user data",fe)}),ie(0)},[]);const X=q.useCallback(ae=>{h||!T||(K.current&&K.current.disconnect(),K.current=new IntersectionObserver(le=>{le[0].isIntersecting&&M(fe=>{const ue=fe+1;return ie(ue),ue})}),ae&&K.current.observe(ae))},[h,T]),Z=()=>{const ae=k==null?void 0:k.id,le=localStorage.getItem("authToken");if(!ae||!le){console.error("Missing target user ID or token");return}Ur.post(`/chatrooms?target_user_id=${ae}`,null,{headers:{token:le}}).then(fe=>{x(null),V("/dashboard/messages")}).catch(fe=>{console.error("Failed to create or get chat room",fe),alert("Something went wrong. Try again!")})};return j.jsxs(j.Fragment,{children:[j.jsx("div",{className:"flex bg-gray-100 min-h-screen",children:j.jsxs("div",{className:"flex flex-col w-full gap-4 max-h-screen",children:[j.jsx(Zle,{profiles:o,setProfiles:d,setLoading:g}),j.jsxs("div",{className:"flex-1 overflow-y-auto px-10 pt-2 pb-4 custom-scroll",children:[j.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:h&&o.length===0?j.jsx("p",{className:"col-span-full text-center text-gray-500",children:"Loading..."}):o.length===0?j.jsx("p",{className:"col-span-full text-center text-gray-500",children:"No matches found."}):o.map((ae,le)=>{var ue,de;const fe=o.length===le+1;return j.jsx("div",{ref:fe?X:null,children:j.jsx(Qle,{id:ae.id,name:ae.name,age:ae.age,image:ae.profile_picture,distance:"N/A",interests:((ue=ae.interests)==null?void 0:ue.map(te=>te.e_name).join(", "))||"N/A",occupation:Array.isArray(ae.occupation)?ae.occupation.slice(0,2).map(te=>te.e_name).join(", ")+(ae.occupation.length>2?"...":""):((de=ae.occupation)==null?void 0:de.e_name)||"N/A",onInteract:Q})},ae.id)})}),h&&o.length>0&&j.jsx("p",{className:"text-center text-sm text-gray-400 mt-4",children:"Loading more..."})]})]})}),k&&j.jsxs("div",{className:"fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 z-50 bg-white shadow-xl rounded-2xl p-6 w-[90%] max-w-sm text-center border border-blue-200 z-[9999]",children:[j.jsxs("p",{className:"text-lg text-blue-600 font-semibold mb-3",children:["You and ",j.jsx("span",{className:"capitalize",children:k.name})," liked each other"]}),j.jsx("button",{className:"bg-gradient-to-r from-cyan-500 to-blue-500 text-white font-bold py-2 px-6 rounded-full",onClick:Z,children:"SAY HELLO!"})]})]})}const cP=({children:o})=>j.jsxs("div",{className:"flex h-screen overflow-hidden",children:[j.jsx(k2e,{}),j.jsx("div",{className:"flex-1 flex flex-col bg-gray-50 h-full overflow-hidden",children:j.jsxs("div",{className:"flex-1 overflow-y-auto custom-scroll p-4",children:[j.jsx(hNe,{}),o]})})]});var $le={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},zie=fo.createContext&&fo.createContext($le),mNe=["attr","size","title"];function gNe(o,d){if(o==null)return{};var h=_Ne(o,d),g,T;if(Object.getOwnPropertySymbols){var I=Object.getOwnPropertySymbols(o);for(T=0;T<I.length;T++)g=I[T],!(d.indexOf(g)>=0)&&Object.prototype.propertyIsEnumerable.call(o,g)&&(h[g]=o[g])}return h}function _Ne(o,d){if(o==null)return{};var h={};for(var g in o)if(Object.prototype.hasOwnProperty.call(o,g)){if(d.indexOf(g)>=0)continue;h[g]=o[g]}return h}function mG(){return mG=Object.assign?Object.assign.bind():function(o){for(var d=1;d<arguments.length;d++){var h=arguments[d];for(var g in h)Object.prototype.hasOwnProperty.call(h,g)&&(o[g]=h[g])}return o},mG.apply(this,arguments)}function Hie(o,d){var h=Object.keys(o);if(Object.getOwnPropertySymbols){var g=Object.getOwnPropertySymbols(o);d&&(g=g.filter(function(T){return Object.getOwnPropertyDescriptor(o,T).enumerable})),h.push.apply(h,g)}return h}function gG(o){for(var d=1;d<arguments.length;d++){var h=arguments[d]!=null?arguments[d]:{};d%2?Hie(Object(h),!0).forEach(function(g){ENe(o,g,h[g])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(h)):Hie(Object(h)).forEach(function(g){Object.defineProperty(o,g,Object.getOwnPropertyDescriptor(h,g))})}return o}function ENe(o,d,h){return d=vNe(d),d in o?Object.defineProperty(o,d,{value:h,enumerable:!0,configurable:!0,writable:!0}):o[d]=h,o}function vNe(o){var d=SNe(o,"string");return typeof d=="symbol"?d:d+""}function SNe(o,d){if(typeof o!="object"||!o)return o;var h=o[Symbol.toPrimitive];if(h!==void 0){var g=h.call(o,d);if(typeof g!="object")return g;throw new TypeError("@@toPrimitive must return a primitive value.")}return(d==="string"?String:Number)(o)}function ede(o){return o&&o.map((d,h)=>fo.createElement(d.tag,gG({key:h},d.attr),ede(d.child)))}function tde(o){return d=>fo.createElement(yNe,mG({attr:gG({},o.attr)},d),ede(o.child))}function yNe(o){var d=h=>{var{attr:g,size:T,title:I}=o,N=gNe(o,mNe),M=T||h.size||"1em",k;return h.className&&(k=h.className),o.className&&(k=(k?k+" ":"")+o.className),fo.createElement("svg",mG({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},h.attr,g,N,{className:k,style:gG(gG({color:o.color||h.color},h.style),o.style),height:M,width:M,xmlns:"http://www.w3.org/2000/svg"}),I&&fo.createElement("title",null,I),o.children)};return zie!==void 0?fo.createElement(zie.Consumer,null,h=>d(h)):d($le)}function TNe(o){return tde({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M352.92 80C288 80 256 144 256 144s-32-64-96.92-64c-52.76 0-94.54 44.14-95.08 96.81-1.1 109.33 86.73 187.08 183 252.42a16 16 0 0 0 18 0c96.26-65.34 184.09-143.09 183-252.42-.54-52.67-42.32-96.81-95.08-96.81z"},child:[]},{tag:"path",attr:{fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M48 256h112l48-96 48 160 48-96 32 64h128"},child:[]}]})(o)}function bNe(o){return tde({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M336 16l0 64c0 8.8-7.2 16-16 16s-16-7.2-16-16l0-64c0-8.8 7.2-16 16-16s16 7.2 16 16zm-98.7 7.1l32 48c4.9 7.4 2.9 17.3-4.4 22.2s-17.3 2.9-22.2-4.4l-32-48c-4.9-7.4-2.9-17.3 4.4-22.2s17.3-2.9 22.2 4.4zM135 119c9.4-9.4 24.6-9.4 33.9 0L292.7 242.7c10.1 10.1 27.3 2.9 27.3-11.3l0-39.4c0-17.7 14.3-32 32-32s32 14.3 32 32l0 153.6c0 57.1-30 110-78.9 139.4c-64 38.4-145.8 28.3-198.5-24.4L7 361c-9.4-9.4-9.4-24.6 0-33.9s24.6-9.4 33.9 0l53 53c6.1 6.1 16 6.1 22.1 0s6.1-16 0-22.1L23 265c-9.4-9.4-9.4-24.6 0-33.9s24.6-9.4 33.9 0l93 93c6.1 6.1 16 6.1 22.1 0s6.1-16 0-22.1L55 185c-9.4-9.4-9.4-24.6 0-33.9s24.6-9.4 33.9 0l117 117c6.1 6.1 16 6.1 22.1 0s6.1-16 0-22.1l-93-93c-9.4-9.4-9.4-24.6 0-33.9zM433.1 484.9c-24.2 14.5-50.9 22.1-77.7 23.1c48.1-39.6 76.6-99 76.6-162.4l0-98.1c8.2-.1 16-6.4 16-16l0-39.4c0-17.7 14.3-32 32-32s32 14.3 32 32l0 153.6c0 57.1-30 110-78.9 139.4zM424.9 18.7c7.4 4.9 9.3 14.8 4.4 22.2l-32 48c-4.9 7.4-14.8 9.3-22.2 4.4s-9.3-14.8-4.4-22.2l32-48c4.9-7.4 14.8-9.3 22.2-4.4z"},child:[]}]})(o)}const CNe=ym([j.jsx("path",{d:"M21 2h-8c-1.1 0-2 .9-2 2v3.5h1.5c1.1 0 2 .9 2 2v4.95c1.04.48 2.24.68 3.5.47 2.93-.49 5-3.17 5-6.14V4c0-1.1-.9-2-2-2m-7 4.5c0-.55.45-1 1-1s1 .45 1 1-.45 1-1 1-1-.45-1-1m4.85 4.38h-3.72c-.38 0-.63-.41-.44-.75.39-.66 1.27-1.13 2.3-1.13s1.91.47 2.3 1.14c.19.33-.06.74-.44.74M19 7.5c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1"},"0"),j.jsx("path",{d:"M11 9H3c-1.1 0-2 .9-2 2v4.79c0 3.05 2.19 5.77 5.21 6.16C9.87 22.42 13 19.57 13 16v-5c0-1.1-.9-2-2-2m-7 4.5c0-.55.45-1 1-1s1 .45 1 1-.45 1-1 1-1-.45-1-1m5.3 3.25c-.38.67-1.27 1.14-2.3 1.14s-1.91-.47-2.3-1.14c-.19-.34.06-.75.44-.75h3.72c.38 0 .63.41.44.75M9 14.5c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1"},"1")]),wNe={"Non-Vegetarian":bEe,Never:lEe,"Looking to Quit Smoking":mEe},RX={bgcolor:"transparent",width:20,height:20},IX={backgroundImage:"linear-gradient(to right, rgba(255,153,153,1), rgba(255,102,102,1))",color:"white",border:"none",borderRadius:"9999px",fontSize:"0.75rem",height:"28px"},RNe={Comedy:CNe,Movies:Iee,Outdoors:Iee,Fitness:TNe};function nde({aboutData:o}){var ke,We;const[d,h]=q.useState(null),[g,T]=q.useState(0),[I,N]=q.useState([]),M=!!d,k=ze=>h(ze.currentTarget),x=()=>h(null),{id:V,name:K,dob:Q,city:ie,languages:X,professions:Z,statuses:ae,religions:le,about:fe,interests:ue=[],eating:de,drinking:te,smoking:ye,url:Te}=o||{},Le=Q?new Date().getFullYear()-new Date(Q).getFullYear():"--",je=[{id:1,label:ae==null?void 0:ae.e_name,IconComponent:OA},{id:2,label:le==null?void 0:le.e_name,IconComponent:OA},{id:3,label:`${Le} Years`,IconComponent:OA},{id:4,label:ie!=null&&ie.e_name&&((ke=ie==null?void 0:ie.country)!=null&&ke.e_name)?`${ie.e_name}, ${ie.country.e_name}`:null,IconComponent:wee},{id:5,label:X==null?void 0:X.e_name,IconComponent:OA},{id:6,label:Z==null?void 0:Z.e_name,IconComponent:OA}],he=[de==null?void 0:de.e_name,te==null?void 0:te.e_name,ye==null?void 0:ye.e_name];return q.useEffect(()=>{V&&Ur.get(`/users/${V}/gallary`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}).then(ze=>{Array.isArray(ze.data)&&N(ze.data.map($e=>$e.url))}).catch(ze=>{console.error("Gallery fetch failed:",ze)})},[V]),j.jsx(SAe,{maxWidth:"lg",children:j.jsx("div",{className:"mt-1 px-1 sm:px-6 lg:px-0",children:j.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[j.jsxs("div",{className:"md:col-span-1 flex flex-col items-center mt-2",children:[j.jsxs("div",{className:"relative aspect-2/3 rounded-4xl overflow-hidden max-w-xs mx-auto",children:[j.jsx("img",{src:Te||"src/assets/IMG (1).png",alt:"Profile",className:"w-full h-full object-cover rounded-lg"}),j.jsxs("div",{className:"absolute bottom-18 left-1/2 transform -translate-x-1/2 flex gap-2 bg-white bg-opacity-70 rounded-full px-3 py-1 shadow-md",children:[j.jsx("button",{className:"w-8 h-8 rounded-full bg-gradient-to-r from-[#FF9999] to-[#FF66CC] flex items-center justify-center",children:j.jsx(YX,{className:"text-white",size:16})}),j.jsx("button",{className:"w-10 h-10 rounded-full bg-gradient-to-r from-cyan-400 to-blue-500 flex items-center justify-center",children:j.jsx(LEe,{className:"text-white",size:20})}),j.jsx("button",{className:"w-8 h-8 rounded-full bg-gradient-to-r from-[#FF9999] to-[#FF66CC] flex items-center justify-center",children:j.jsx(gve,{className:"text-white fill-white",size:16})})]})]}),j.jsxs("div",{className:"mt-4 flex justify-center gap-2",children:[j.jsx("button",{className:"bg-gradient-to-r from-cyan-400 to-blue-500 rounded-full p-2",children:j.jsx(YX,{className:"text-white",size:20})}),j.jsxs("button",{className:"bg-gradient-to-r from-cyan-400 to-blue-500 text-white px-4 py-2 rounded-full flex items-center gap-2",children:[j.jsx(bNe,{}),"Say Hello"]})]})]}),j.jsxs("div",{className:"md:col-span-2",children:[j.jsxs("div",{className:"flex justify-between items-start ",children:[j.jsx("h2",{className:"text-lg font-semibold capitalize",children:K}),j.jsxs("div",{className:"flex items-center gap-2 text-sm text-black",children:[j.jsx(wee,{size:16,color:"#38BDF8"}),j.jsxs("span",{children:[ie==null?void 0:ie.e_name,", ",(We=ie==null?void 0:ie.country)==null?void 0:We.e_name]}),j.jsx(l0,{onClick:k,children:j.jsx(wEe,{size:20})})]})]}),j.jsxs(c2e,{anchorEl:d,open:M,onClose:x,children:[j.jsxs(ene,{onClick:x,sx:{px:6,py:.5},children:[j.jsx(dve,{size:28,className:"pr-3"})," Block"]}),j.jsxs(ene,{onClick:x,sx:{px:6,py:.5},children:[j.jsx(yve,{size:28,className:"pr-3"})," Report"]})]}),j.jsx(gQ,{sx:{borderBottomWidth:1,borderColor:"black",paddingTop:"-40px"}}),j.jsx("h3",{className:"font-semibold text-lg mt-2",children:"About Me"}),j.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:je.map(({id:ze,label:$e,IconComponent:et})=>$e?j.jsx(aq,{avatar:j.jsx(sq,{sx:RX,children:j.jsx(et,{size:18,style:{color:"white"}})}),label:$e,variant:"outlined",sx:IX},ze):null)}),j.jsx("p",{className:"text-black mt-2 text-sm leading-relaxed",children:fe||"No about description provided."}),j.jsx("h3",{className:"text-lg font-semibold mt-1",children:"Life Style"}),j.jsx("div",{className:"flex flex-wrap gap-2 mt-1",children:he.map((ze,$e)=>{const et=wNe[ze];return ze?j.jsx(aq,{label:ze,variant:"outlined",avatar:et&&j.jsx(sq,{sx:RX,children:j.jsx(et,{size:14,style:{color:"white"}})}),sx:IX},$e):null})}),j.jsx("h3",{className:"text-lg font-semibold mt-1",children:"Interested"}),j.jsxs("div",{className:"flex items-center gap-6 mt-1 ml-3",children:[j.jsxs("div",{className:"flex items-center gap-1 text-sm font-semibold text-gray-800",children:[j.jsx("img",{src:"src/assets/Mask group.svg",alt:""}),j.jsx("span",{children:"Entertainment"})]}),j.jsxs("div",{className:"flex items-center ml-10 gap-2 text-sm font-semibold text-gray-800",children:[j.jsx("img",{src:"src/assets/Mask group2.png",alt:""}),j.jsx("span",{children:"Wellness"})]})]}),j.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:ue.map(({interest:ze},$e)=>{const et=ze==null?void 0:ze.e_name,Oe=RNe[et];return j.jsx(aq,{label:et,variant:"outlined",avatar:Oe&&j.jsx(sq,{sx:RX,children:j.jsx(Oe,{size:14,style:{color:"white"}})}),sx:IX},$e)})}),j.jsxs("div",{className:"mt-2",children:[j.jsx("h2",{className:"text-lg font-semibold mb-2",children:"Gallery"}),j.jsx("div",{className:`
                grid gap-3
                grid-cols-1 sm:grid-cols-2 md:grid-cols-3
                lg:grid-cols-4 xl:grid-cols-5
              `,children:I.map((ze,$e)=>j.jsx("div",{className:"w-full overflow-hidden rounded-2xl cursor-pointer",onClick:()=>T($e),children:j.jsx("img",{src:ze,alt:`Gallery ${$e+1}`,className:"w-full h-full object-cover"})},$e))})]})]})]})})})}function INe(){const{ShowAbout:o,setShowAbout:d,aboutData:h,setAboutData:g}=Cle(),[T,I]=q.useState([]),[N,M]=q.useState(!0),k=xl(),[x,V]=q.useState(null),K=(X,Z,ae)=>{Ur.post("/users/interact",{target_user_id:X,action:Z}).then(le=>{I(fe=>fe.filter(ue=>ue.id!==X)),le.data.is_match&&V(ae)}).catch(le=>{console.error("Interaction failed:",le),alert("Interaction failed")})};q.useEffect(()=>{const X=JSON.parse(localStorage.getItem("user_Data")),Z=localStorage.getItem("userId");X||Ur.get(`/users/${Z}/info`).then(ae=>{const le=ae.data;localStorage.setItem("user_Data",JSON.stringify({...le,token:localStorage.getItem("authToken")}))}).catch(ae=>{console.error("Failed to fetch profiles",ae),M(!1)}),Ur.get("/users/mutuals?start=0&limit=10").then(ae=>{I(ae.data.list||[]),M(!1)}).catch(ae=>{console.error("Failed to fetch profiles",ae),M(!1)})},[]);const Q=()=>{const X=x==null?void 0:x.id,Z=localStorage.getItem("authToken");if(!X||!Z){console.error("Missing target user ID or token");return}Ur.post(`/chatrooms?target_user_id=${X}`,null,{headers:{token:Z}}).then(ae=>{console.log("Chat room created:",ae.data),V(null),k("/dashboard/messages")}).catch(ae=>{console.error("Failed to create or get chat room",ae),alert("Something went wrong. Try again!")})},ie=X=>{Ur.get(`/users/${X}/info`).then(Z=>{console.log("resresresres",Z.data),d(!0),g(Z.data)}).catch(Z=>{console.error("Failed to create or get chat room",Z),alert("Something went wrong. Try again!")})};return j.jsx(j.Fragment,{children:o?j.jsx(nde,{aboutData:h}):j.jsxs(j.Fragment,{children:[j.jsx("div",{className:"flex bg-gray-100 min-h-screen",children:j.jsxs("div",{className:"flex flex-col w-full gap-4 max-h-screen",children:[j.jsx(Zle,{profiles:T,setProfiles:I,setLoading:M}),j.jsx("div",{className:"flex-1 overflow-y-auto px-10 pt-2 pb-4 custom-scroll",children:j.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:N?j.jsx("p",{className:"col-span-full text-center text-gray-500",children:"Loading..."}):T.length===0?j.jsx("p",{className:"col-span-full text-center text-gray-500",children:"No matches found."}):T.map((X,Z)=>{var ae,le,fe;return j.jsx(Qle,{id:X.id,name:X.name,age:X.age,distance:"N/A",interests:((ae=X.interests)==null?void 0:ae.map(ue=>ue.e_name).join(", "))||"N/A",occupation:((le=X.occupation)==null?void 0:le.e_name)||"N/A",rating:((fe=X.score)==null?void 0:fe.toString())||"0",image:X.profile_picture||"https://via.placeholder.com/300",onInteract:K,flag:"matches",handleShowAboutUser:ue=>ie(ue)},Z)})})})]})}),x&&j.jsxs("div",{className:"fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 z-50 bg-white shadow-xl rounded-2xl p-6 w-[90%] max-w-sm text-center border border-blue-200 z-[9999]",children:[j.jsxs("p",{className:"text-lg text-blue-600 font-semibold mb-3",children:["You and ",j.jsx("span",{className:"capitalize",children:x.name})," liked each other"]}),j.jsx("button",{className:"bg-gradient-to-r from-cyan-500 to-blue-500 text-white font-bold py-2 px-6 rounded-full",onClick:Q,children:"SAY HELLO!"})]})]})})}const lP=({children:o})=>localStorage.getItem("authToken")&&localStorage.getItem("user_Data")?o:j.jsx(Sue,{to:"/login",replace:!0}),ANe=ym(j.jsx("path",{d:"M9 16.17 4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"})),ONe=ym(j.jsx("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})),Wie=({title:o,description:d,features:h,isPremium:g,yearly:T,onToggle:I})=>j.jsxs("div",{className:"rounded-[30px] shadow-xl px-8 py-8 w-full max-w-md flex flex-col items-center bg-white border",style:{border:"0.6px solid #FFFFFF",boxShadow:"0px 0px 20px 0px #00000026"},children:[j.jsx("h3",{className:`text-2xl font-bold ${g?"text-pink-500":"text-blue-500"}`,children:o}),j.jsx("p",{className:"text-xs mt-1 text-[#f77c7c]",children:d}),j.jsx("div",{className:"w-full mt-4",children:j.jsxs("div",{className:`${g?"bg-gradient-to-r from-pink-400 to-pink-500":"bg-gradient-to-r from-cyan-400 to-blue-500"} rounded-r-full px-4 py-4 text-white text-center text-sm font-semibold relative`,children:[j.jsx("div",{className:"text-[11px] mb-1 font-medium",children:"Save up to 20% on yearly subscription"}),j.jsx("div",{className:"text-[13px] mb-2",children:"1199.88 ILS/Year And 99.99 ILS/Month"}),j.jsxs("div",{className:"flex items-center justify-center mt-3",children:[j.jsx("span",{className:`text-xs font-semibold mr-2 ${T?"text-white":"text-white/60"}`,children:"Yearly"}),j.jsx("div",{className:"relative w-12 h-6 bg-white rounded-full flex items-center px-1 cursor-pointer",onClick:I,children:j.jsx("div",{className:`w-5 h-5 ${g?"bg-gradient-to-r from-pink-400 to-pink-500":"bg-gradient-to-r from-cyan-400 to-blue-500"} rounded-full shadow-md transform transition-transform duration-300 ${T?"translate-x-0":"translate-x-6"}`})}),j.jsx("span",{className:`text-xs font-semibold ml-2 ${T?"text-white/60":"text-white"}`,children:"Monthly"})]})]})}),j.jsx("ul",{className:"text-sm w-full space-y-2 mt-5",children:h.map((N,M)=>j.jsxs("li",{className:"flex items-center gap-2",children:[N.included?j.jsx("div",{className:"w-5 h-5 rounded-full flex items-center justify-center opacity-50 pointer-events-none",style:{background:"linear-gradient(75.05deg, rgba(207, 45, 47, 0.8) 5.71%, #F4585A 58.75%)"},children:j.jsx(ANe,{sx:{fontSize:14,color:"#ffffff"}})}):j.jsx("div",{className:"w-5 h-5 rounded-full flex items-center justify-center",style:{background:"linear-gradient(75.05deg, rgba(207, 45, 47, 0.8) 5.71%, #F4585A 58.75%)"},children:j.jsx(ONe,{sx:{fontSize:14,color:"#fff"}})}),j.jsx("span",{children:N.label})]},M))}),j.jsx(vAe,{variant:"contained",fullWidth:!0,sx:{mt:4,bgcolor:g?"#ff4081":"#2196f3","&:hover":{bgcolor:g?"#f50057":"#1976d2"},borderRadius:"2rem",fontWeight:"bold"},children:"GET STARTED"}),j.jsxs("p",{className:"text-[11px] text-center text-gray-600 mt-2 leading-4",children:["*Unlock also via kindness  ",j.jsx("br",{}),j.jsx("span",{className:"text-blue-500 underline",children:"You can cancel anytime"})]})]});function NNe(){const[o,d]=q.useState(!0),h=[{label:"20 Swipes Daily Limit",included:!0},{label:"Unlimited Favorites Access",included:!0},{label:"Your Story Limited Access",included:!0},{label:"Unlimited Profile Photos",included:!0},{label:"Advanced Filter Option",included:!0},{label:"Includes Chat Feature",included:!0},{label:"No Audio Call",included:!1},{label:"No Video Call",included:!1}],g=[{label:"Unlimited Swipes",included:!0},{label:"Unlimited Favorites Access",included:!0},{label:"Full Story Access",included:!0},{label:"Unlimited Profile Photos",included:!0},{label:"Advanced AI Filter",included:!0},{label:"Includes Chat Feature",included:!0},{label:"Unlimited Audio Call",included:!0},{label:"Unlimited Video Call",included:!0}];return j.jsxs("div",{className:"flex flex-col items-center py-10 px-4 bg-white min-h-screen",children:[j.jsx("div",{className:"flex justify-center mb-6",children:j.jsxs("div",{className:"flex items-center bg-white shadow-md px-6 py-3 rounded-full space-x-4",style:{boxShadow:"0px 0px 20px 0px #00000026"},children:[j.jsx("span",{className:`text-sm font-semibold ${o?"text-black":"text-gray-400"}`,children:"Yearly"}),j.jsxs("div",{className:"relative w-14 h-7 flex items-center cursor-pointer",onClick:()=>d(!o),children:[j.jsx("div",{className:"w-full h-full bg-gradient-to-r from-cyan-400 to-blue-500 rounded-full transition-colors duration-300"}),j.jsx("div",{className:`absolute w-6 h-6 bg-white rounded-full shadow-md transform transition-all duration-300 ${o?"left-1":"right-1"}`})]}),j.jsx("span",{className:`text-sm font-semibold ${o?"text-gray-400":"text-pink-500"}`,children:"Monthly"})]})}),j.jsxs("div",{className:"flex flex-col md:flex-row gap-8",children:[j.jsx(Wie,{title:"Standard",description:"For dreamers ready to find their match",price:o?"1999.99 /Year or 166.99 /Month":"999.99 /6-Month or 166.99 /Month",features:h,isPremium:!1}),j.jsx(Wie,{title:"Premium",description:"Designed for Emerging Love Seekers",price:o?"3999.99 /Year or 333.99 /Month":"1999.99 /6-Month or 333.99 /Month",features:g,isPremium:!0})]})]})}const LNe=ym([j.jsx("circle",{cx:"12",cy:"12",r:"3.2"},"0"),j.jsx("path",{d:"M9 2 7.17 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2h-3.17L15 2zm3 15c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5"},"1")]),DNe=ym(j.jsx("path",{d:"M22 16V4c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2m-11-4 2.03 2.71L16 11l4 5H8zM2 6v14c0 1.1.9 2 2 2h14v-2H4V6z"}));function PNe(){const[o,d]=q.useState("Support"),[h,g]=q.useState({fullName:"",email:"",phoneNumber:"",message:"",uploadedImage:null}),[T,I]=q.useState(null),[N,M]=q.useState({}),k=Q=>{const{name:ie,value:X}=Q.target;g(Z=>({...Z,[ie]:X})),N[ie]&&M(Z=>({...Z,[ie]:""}))},x=Q=>{const ie=Q.target.files[0];ie&&ie.size<=5*1024*1024?(g(X=>({...X,uploadedImage:ie})),I(URL.createObjectURL(ie))):alert("File must be less than 5MB")},V=()=>{const Q={};return h.fullName.trim()||(Q.fullName="Full Name is required"),h.email.trim()?/\S+@\S+\.\S+/.test(h.email)||(Q.email="Please enter a valid email address"):Q.email="Email is required",h.phoneNumber.trim()||(Q.phoneNumber="Phone Number is required"),h.message.trim()||(Q.message="Message is required"),M(Q),Object.keys(Q).length===0},K=Q=>{Q.preventDefault(),V()&&console.log("Form submitted:",h)};return j.jsxs("div",{className:"max-w-6xl mx-auto p-6 bg-white rounded-2xl",style:{boxShadow:"0px 0px 4px 0px #00000026"},children:[j.jsx("h1",{className:"text-2xl font-medium text-gray-800 mb-8",children:"Help Center"}),j.jsxs("div",{className:"mb-8",children:[j.jsxs("div",{className:"flex justify-between items-end",children:[j.jsx("div",{className:"w-1/2 text-center",children:j.jsx("button",{onClick:()=>d("FAQ"),className:`pb-2 font-medium text-sm ${o==="FAQ"?"text-black font-semibold":"text-gray-500 hover:text-gray-700"}`,children:"FAQ"})}),j.jsx("div",{className:"w-1/2 text-center",children:j.jsx("button",{onClick:()=>d("Support"),className:`pb-2 font-medium text-sm ${o==="Support"?"text-black font-semibold":"text-gray-500 hover:text-gray-700"}`,children:"Support"})})]}),j.jsxs("div",{className:"flex h-1 w-full rounded-full overflow-hidden mt-1",children:[j.jsx("div",{className:"w-1/2 bg-red-200"}),j.jsx("div",{className:"w-1/2 bg-cyan-400"})]})]}),o==="Support"&&j.jsxs("div",{className:"space-y-6",children:[j.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[j.jsxs("div",{children:[j.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Full Name*"}),j.jsx("input",{type:"text",name:"fullName",value:h.fullName,onChange:k,placeholder:"Use full name (as it appears on your ID)",className:"w-full px-4 py-3 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm"}),N.fullName&&j.jsx("p",{className:"mt-1 text-xs text-red-500",children:N.fullName})]}),j.jsxs("div",{children:[j.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email*"}),j.jsx("input",{type:"email",name:"email",value:h.email,onChange:k,placeholder:"Enter your email address",className:"w-full px-4 py-3 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm"}),N.email&&j.jsx("p",{className:"mt-1 text-xs text-red-500",children:N.email})]}),j.jsxs("div",{children:[j.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone Number*"}),j.jsx("input",{type:"tel",name:"phoneNumber",value:h.phoneNumber,onChange:k,placeholder:"+977 Enter your phone number",className:"w-full px-4 py-3 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm"}),N.phoneNumber&&j.jsx("p",{className:"mt-1 text-xs text-red-500",children:N.phoneNumber})]})]}),j.jsxs("div",{children:[j.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Message*"}),j.jsx("textarea",{name:"message",value:h.message,onChange:k,rows:"4",placeholder:"Tell us more about your issue...",className:"w-full px-3 py-2 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm resize-vertical"}),N.message&&j.jsx("p",{className:"mt-1 text-xs text-red-500",children:N.message})]}),j.jsxs("div",{children:[j.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Upload Image"}),j.jsxs("div",{className:"flex flex-col md:flex-row items-start md:items-center gap-4",children:[j.jsxs("div",{className:"w-full max-w-md",children:[j.jsxs("label",{htmlFor:"image-upload",className:"flex items-center justify-between px-3 py-3 bg-gray-100 border border-gray-300 text-gray-500 text-sm rounded-full cursor-pointer hover:bg-gray-200 transition",children:[h.uploadedImage?h.uploadedImage.name:"Attach an image",j.jsx("input",{type:"file",id:"image-upload",accept:"image/png, image/jpeg",onChange:x,className:"hidden"})]}),j.jsx("p",{className:"mt-1 text-xs text-gray-400",children:"Max 5MB, JPG/PNG only"})]}),j.jsxs("div",{className:"flex gap-4 mt-2 md:mt-0",children:[j.jsx(nne,{title:"Take a photo",arrow:!0,children:j.jsxs("button",{className:"flex flex-col items-center gap-1",children:[j.jsx("div",{className:"bg-cyan-400 text-white rounded-xl p-3 hover:bg-cyan-500 transition",children:j.jsx(LNe,{})}),j.jsx("span",{className:"text-xs text-black",children:"Take a photo"})]})}),j.jsx(nne,{title:"Choose from Gallery",arrow:!0,children:j.jsxs("button",{className:"flex flex-col items-center gap-1",children:[j.jsx("div",{className:"bg-red-300 text-white rounded-xl p-3 hover:bg-red-400 transition",children:j.jsx(DNe,{})}),j.jsx("span",{className:"text-xs text-black",children:"Choose from Gallery"})]})})]})]}),T&&j.jsx("img",{src:T,alt:"Preview",className:"mt-4 rounded-xl max-h-40 border border-gray-200 object-contain"})]}),j.jsx("div",{className:"pt-4 flex justify-center",children:j.jsx("button",{onClick:K,className:`bg-cyan-400 hover:bg-cyan-500 text-white font-medium py-3 px-6 rounded-md
 transition duration-200 text-sm`,children:"SUBMIT YOUR QUERY"})})]}),o==="FAQ"&&j.jsx("div",{className:"text-center py-12",children:j.jsx("p",{className:"text-gray-500",children:"FAQ content would go here..."})})]})}function MNe(){return j.jsx(Yue,{children:j.jsxs(Tue,{children:[j.jsx(Lo,{path:"/signup",element:j.jsx(Mhe,{})}),j.jsx(Lo,{path:"/signup/verify",element:j.jsx(xhe,{})}),j.jsx(Lo,{path:"/signup/confirm-password",element:j.jsx(jhe,{})}),j.jsx(Lo,{path:"/profile/data",element:j.jsx(Lve,{})}),j.jsx(Lo,{path:"/profile/general-info",element:j.jsx(Pve,{})}),j.jsx(Lo,{path:"/profile/lifestyle",element:j.jsx(kve,{})}),j.jsx(Lo,{path:"/profile/interests",element:j.jsx(Uve,{})}),j.jsx(Lo,{path:"/profile/photos",element:j.jsx(Bve,{})}),j.jsx(Lo,{path:"/profile/ideal-match",element:j.jsx(Wve,{})}),j.jsx(Lo,{path:"/",element:j.jsx(Aee,{})}),j.jsx(Lo,{path:"/login",element:j.jsx(Aee,{})}),j.jsx(Lo,{path:"/videocallstart",element:j.jsx(Tle,{})}),j.jsx(Lo,{path:"/videocalling",element:j.jsx(yle,{})}),j.jsx(Lo,{path:"/helpcenter",element:j.jsx(PNe,{})}),j.jsx(Lo,{path:"/dashboard/subscription",element:j.jsx(lP,{children:j.jsx(cP,{children:j.jsx(NNe,{})})})}),j.jsx(Lo,{path:"/dashboard/home",element:j.jsx(lP,{children:j.jsx(cP,{children:j.jsx(pNe,{})})})}),j.jsx(Lo,{path:"/dashboard/matches",element:j.jsx(lP,{children:j.jsx(cP,{children:j.jsx(INe,{})})})}),j.jsx(Lo,{path:"/dashboard/messages",element:j.jsx(lP,{children:j.jsx(cP,{children:j.jsx(O2e,{})})})}),j.jsx(Lo,{path:"/dashboard/personalInfo",element:j.jsx(lP,{children:j.jsx(cP,{children:j.jsx($Oe,{})})})}),j.jsx(Lo,{path:"/dashboard/about-page",element:j.jsx(lP,{children:j.jsx(cP,{children:j.jsx(nde,{})})})})]})})}function kNe(){return j.jsx(MNe,{})}/**
 * @license agora-rtc-react
 * @version 2.4.0
 *
 * Copyright (c) Agora, Inc.
 *
 * This source code is licensed under the MIT license.
 */var xNe=Object.create,s$=Object.defineProperty,UNe=Object.getOwnPropertyDescriptor,jNe=Object.getOwnPropertyNames,VNe=Object.getPrototypeOf,BNe=Object.prototype.hasOwnProperty,FNe=(o,d)=>()=>(d||o((d={exports:{}}).exports,d),d.exports),GNe=(o,d)=>{for(var h in d)s$(o,h,{get:d[h],enumerable:!0})},rde=(o,d,h,g)=>{if(d&&typeof d=="object"||typeof d=="function")for(let T of jNe(d))!BNe.call(o,T)&&T!==h&&s$(o,T,{get:()=>d[T],enumerable:!(g=UNe(d,T))||g.enumerable});return o},zNe=(o,d,h)=>(rde(o,d,"default"),h),e2=(o,d,h)=>(h=o!=null?xNe(VNe(o)):{},rde(!o||!o.__esModule?s$(h,"default",{value:o,enumerable:!0}):h,o)),t2=FNe((o,d)=>{(function(h,g){typeof o=="object"&&typeof d<"u"?d.exports=g():typeof define=="function"&&define.amd?define(g):(h=typeof globalThis<"u"?globalThis:h||self).AgoraRTC=g()})(o,function(){function h(n,i){return i.forEach(function(a){a&&typeof a!="string"&&!Array.isArray(a)&&Object.keys(a).forEach(function(c){if(c!=="default"&&!(c in n)){var u=Object.getOwnPropertyDescriptor(a,c);Object.defineProperty(n,c,u.get?u:{enumerable:!0,get:function(){return a[c]}})}})}),Object.freeze(n)}var g=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function T(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var I=function(n){try{return!!n()}catch{return!0}},N=!I(function(){var n=(function(){}).bind();return typeof n!="function"||n.hasOwnProperty("prototype")}),M=N,k=Function.prototype,x=k.call,V=M&&k.bind.bind(x,x),K=M?V:function(n){return function(){return x.apply(n,arguments)}},Q=K({}.isPrototypeOf),ie=function(n){return n&&n.Math==Math&&n},X=ie(typeof globalThis=="object"&&globalThis)||ie(typeof window=="object"&&window)||ie(typeof self=="object"&&self)||ie(typeof g=="object"&&g)||function(){return this}()||g||Function("return this")(),Z=N,ae=Function.prototype,le=ae.apply,fe=ae.call,ue=typeof Reflect=="object"&&Reflect.apply||(Z?fe.bind(le):function(){return fe.apply(le,arguments)}),de=K,te=de({}.toString),ye=de("".slice),Te=function(n){return ye(te(n),8,-1)},Le=Te,je=K,he=function(n){if(Le(n)==="Function")return je(n)},ke=typeof document=="object"&&document.all,We={all:ke,IS_HTMLDDA:ke===void 0&&ke!==void 0},ze=We.all,$e=We.IS_HTMLDDA?function(n){return typeof n=="function"||n===ze}:function(n){return typeof n=="function"},et={},Oe=!I(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7}),qe=N,lt=Function.prototype.call,Ge=qe?lt.bind(lt):function(){return lt.apply(lt,arguments)},Ae={},rt={}.propertyIsEnumerable,yt=Object.getOwnPropertyDescriptor,Lt=yt&&!rt.call({1:2},1);Ae.f=Lt?function(n){var i=yt(this,n);return!!i&&i.enumerable}:rt;var Pt,_n,Gt=function(n,i){return{enumerable:!(1&n),configurable:!(2&n),writable:!(4&n),value:i}},zt=I,rn=Te,ir=Object,kt=K("".split),Ht=zt(function(){return!ir("z").propertyIsEnumerable(0)})?function(n){return rn(n)=="String"?kt(n,""):ir(n)}:ir,Jt=function(n){return n==null},tn=Jt,Yn=TypeError,oi=function(n){if(tn(n))throw Yn("Can't call method on "+n);return n},Ri=Ht,jr=oi,dr=function(n){return Ri(jr(n))},Ii=$e,sa=We.all,ar=We.IS_HTMLDDA?function(n){return typeof n=="object"?n!==null:Ii(n)||n===sa}:function(n){return typeof n=="object"?n!==null:Ii(n)},Sn={},vc=Sn,Zi=X,bm=$e,jl=function(n){return bm(n)?n:void 0},Tr=function(n,i){return arguments.length<2?jl(vc[n])||jl(Zi[n]):vc[n]&&vc[n][i]||Zi[n]&&Zi[n][i]},ss=typeof navigator<"u"&&String(navigator.userAgent)||"",Za=X,Vh=ss,ec=Za.process,Cf=Za.Deno,Sc=ec&&ec.versions||Cf&&Cf.version,Fa=Sc&&Sc.v8;Fa&&(_n=(Pt=Fa.split("."))[0]>0&&Pt[0]<4?1:+(Pt[0]+Pt[1])),!_n&&Vh&&(!(Pt=Vh.match(/Edge\/(\d+)/))||Pt[1]>=74)&&(Pt=Vh.match(/Chrome\/(\d+)/))&&(_n=+Pt[1]);var ko=_n,wf=ko,Cm=I,Td=X.String,Su=!!Object.getOwnPropertySymbols&&!Cm(function(){var n=Symbol();return!Td(n)||!(Object(n)instanceof Symbol)||!Symbol.sham&&wf&&wf<41}),wE=Su&&!Symbol.sham&&typeof Symbol.iterator=="symbol",RE=Tr,wm=$e,uC=Q,Bh=Object,Fh=wE?function(n){return typeof n=="symbol"}:function(n){var i=RE("Symbol");return wm(i)&&uC(i.prototype,Bh(n))},yu=String,er=function(n){try{return yu(n)}catch{return"Object"}},yc=$e,Ty=er,os=TypeError,$i=function(n){if(yc(n))return n;throw os(Ty(n)+" is not a function")},Tc=$i,Rf=Jt,Rm=function(n,i){var a=n[i];return Rf(a)?void 0:Tc(a)},fC=Ge,hC=$e,pC=ar,E0=TypeError,IE={exports:{}},Im=X,v0=Object.defineProperty,AE=function(n,i){try{v0(Im,n,{value:i,configurable:!0,writable:!0})}catch{Im[n]=i}return i},Gh="__core-js_shared__",cs=X[Gh]||AE(Gh,{}),OE=cs;(IE.exports=function(n,i){return OE[n]||(OE[n]=i!==void 0?i:{})})("versions",[]).push({version:"3.31.1",mode:"pure",copyright:" 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.31.1/LICENSE",source:"https://github.com/zloirock/core-js"});var zh=IE.exports,Vl=oi,S0=Object,Tu=function(n){return S0(Vl(n))},bd=Tu,i2=K({}.hasOwnProperty),ls=Object.hasOwn||function(n,i){return i2(bd(n),i)},Ga=K,by=0,If=Math.random(),mC=Ga(1 .toString),Cy=function(n){return"Symbol("+(n===void 0?"":n)+")_"+mC(++by+If,36)},Hh=zh,wy=ls,Ry=Cy,YP=Su,a2=wE,po=X.Symbol,Af=Hh("wks"),gC=a2?po.for||po:po&&po.withoutSetter||Ry,Ai=function(n){return wy(Af,n)||(Af[n]=YP&&wy(po,n)?po[n]:gC("Symbol."+n)),Af[n]},ea=Ge,NE=ar,_C=Fh,rl=Rm,EC=function(n,i){var a,c;if(hC(a=n.toString)&&!pC(c=fC(a,n))||hC(a=n.valueOf)&&!pC(c=fC(a,n))||i!=="string")return c;throw E0("Can't convert object to primitive value")},s2=TypeError,vC=Ai("toPrimitive"),y0=function(n,i){if(!NE(n)||_C(n))return n;var a,c=rl(n,vC);if(c){if(a=ea(c,n,i),!NE(a)||_C(a))return a;throw s2("Can't convert object to primitive value")}return EC(n,i)},o2=Fh,LE=function(n){var i=y0(n,"string");return o2(i)?i:i+""},Of=ar,Iy=X.document,Ay=Of(Iy)&&Of(Iy.createElement),Oy=function(n){return Ay?Iy.createElement(n):{}},DE=Oy,c2=!Oe&&!I(function(){return Object.defineProperty(DE("div"),"a",{get:function(){return 7}}).a!=7}),l2=Oe,Ny=Ge,SC=Ae,yC=Gt,T0=dr,b0=LE,d2=ls,TC=c2,bC=Object.getOwnPropertyDescriptor;et.f=l2?bC:function(n,i){if(n=T0(n),i=b0(i),TC)try{return bC(n,i)}catch{}if(d2(n,i))return yC(!Ny(SC.f,n,i),n[i])};var C0=I,Nf=$e,CC=/#|\.prototype\./,Lf=function(n,i){var a=wC[Bl(n)];return a==u2||a!=Ly&&(Nf(i)?C0(i):!!i)},Bl=Lf.normalize=function(n){return String(n).replace(CC,".").toLowerCase()},wC=Lf.data={},Ly=Lf.NATIVE="N",u2=Lf.POLYFILL="P",PE=Lf,ME=$i,f2=N,bc=he(he.bind),Cc=function(n,i){return ME(n),i===void 0?n:f2?bc(n,i):function(){return n.apply(i,arguments)}},$a={},mo=Oe&&I(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42}),h2=ar,RC=String,IC=TypeError,Es=function(n){if(h2(n))return n;throw IC(RC(n)+" is not an object")},Ks=Oe,p2=c2,KP=mo,Dy=Es,kE=LE,Py=TypeError,AC=Object.defineProperty,OC=Object.getOwnPropertyDescriptor,NC="enumerable",xE="configurable",UE="writable";$a.f=Ks?KP?function(n,i,a){if(Dy(n),i=kE(i),Dy(a),typeof n=="function"&&i==="prototype"&&"value"in a&&UE in a&&!a[UE]){var c=OC(n,i);c&&c[UE]&&(n[i]=a.value,a={configurable:xE in a?a[xE]:c[xE],enumerable:NC in a?a[NC]:c[NC],writable:!1})}return AC(n,i,a)}:AC:function(n,i,a){if(Dy(n),i=kE(i),Dy(a),p2)try{return AC(n,i,a)}catch{}if("get"in a||"set"in a)throw Py("Accessors not supported");return"value"in a&&(n[i]=a.value),n};var My=$a,qP=Gt,Wh=Oe?function(n,i,a){return My.f(n,i,qP(1,a))}:function(n,i,a){return n[i]=a,n},bu=X,jE=ue,LC=he,JP=$e,XP=et.f,QP=PE,Am=Sn,w0=Cc,R0=Wh,Om=ls,m2=function(n){var i=function(a,c,u){if(this instanceof i){switch(arguments.length){case 0:return new n;case 1:return new n(a);case 2:return new n(a,c)}return new n(a,c,u)}return jE(n,this,arguments)};return i.prototype=n.prototype,i},br=function(n,i){var a,c,u,_,S,C,R,e,t,r=n.target,s=n.global,l=n.stat,f=n.proto,m=s?bu:l?bu[r]:(bu[r]||{}).prototype,E=s?Am:Am[r]||R0(Am,r,{})[r],y=E.prototype;for(_ in i)c=!(a=QP(s?_:r+(l?".":"#")+_,n.forced))&&m&&Om(m,_),C=E[_],c&&(R=n.dontCallGetSet?(t=XP(m,_))&&t.value:m[_]),S=c&&R?R:i[_],c&&typeof C==typeof S||(e=n.bind&&c?w0(S,bu):n.wrap&&c?m2(S):f&&JP(S)?LC(S):S,(n.sham||S&&S.sham||C&&C.sham)&&R0(e,"sham",!0),R0(E,_,e),f&&(Om(Am,u=r+"Prototype")||R0(Am,u,{}),R0(Am[u],_,S),n.real&&y&&(a||!y[_])&&R0(y,_,S)))},pr=Math.ceil,ZP=Math.floor,$P=Math.trunc||function(n){var i=+n;return(i>0?ZP:pr)(i)},eM=$P,VE=function(n){var i=+n;return i!=i||i===0?0:eM(i)},Nm=VE,tM=Math.max,g2=Math.min,ky=function(n,i){var a=Nm(n);return a<0?tM(a+i,0):g2(a,i)},xy=VE,_2=Math.min,DC=function(n){return n>0?_2(xy(n),9007199254740991):0},Lm=DC,Df=function(n){return Lm(n.length)},Yh=dr,nM=ky,E2=Df,PC=function(n){return function(i,a,c){var u,_=Yh(i),S=E2(_),C=nM(c,S);if(n&&a!=a){for(;S>C;)if((u=_[C++])!=u)return!0}else for(;S>C;C++)if((n||C in _)&&_[C]===a)return n||C||0;return!n&&-1}},Kh={includes:PC(!0),indexOf:PC(!1)},Dm=Kh.includes;br({target:"Array",proto:!0,forced:I(function(){return!Array(1).includes()})},{includes:function(n){return Dm(this,n,arguments.length>1?arguments[1]:void 0)}});var rM=Sn,tc=function(n){return rM[n+"Prototype"]},v2=tc("Array").includes,il=ar,MC=Te,kC=Ai("match"),xC=function(n){var i;return il(n)&&((i=n[kC])!==void 0?!!i:MC(n)=="RegExp")},S2=xC,UC=TypeError,y2={};y2[Ai("toStringTag")]="z";var jC=String(y2)==="[object z]",T2=jC,VC=$e,Uy=Te,al=Ai("toStringTag"),qh=Object,b2=Uy(function(){return arguments}())=="Arguments",Cd=T2?Uy:function(n){var i,a,c;return n===void 0?"Undefined":n===null?"Null":typeof(a=function(u,_){try{return u[_]}catch{}}(i=qh(n),al))=="string"?a:b2?Uy(i):(c=Uy(i))=="Object"&&VC(i.callee)?"Arguments":c},C2=Cd,Pf=String,nc=function(n){if(C2(n)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return Pf(n)},iM=Ai("match"),Ls=br,BC=function(n){if(S2(n))throw UC("The method doesn't accept regular expressions");return n},BE=oi,jy=nc,w2=function(n){var i=/./;try{"/./"[n](i)}catch{try{return i[iM]=!1,"/./"[n](i)}catch{}}return!1},Jh=K("".indexOf);Ls({target:"String",proto:!0,forced:!w2("includes")},{includes:function(n){return!!~Jh(jy(BE(this)),jy(BC(n)),arguments.length>1?arguments[1]:void 0)}});var I0=tc("String").includes,Vy=Q,R2=v2,Xh=I0,By=Array.prototype,Fy=String.prototype,Gy=function(n){var i=n.includes;return n===By||Vy(By,n)&&i===By.includes?R2:typeof n=="string"||n===Fy||Vy(Fy,n)&&i===Fy.includes?Xh:i},ft=T(Gy),aM=$i,ht=Tu,I2=Ht,A2=Df,FC=TypeError,wd=function(n){return function(i,a,c,u){aM(a);var _=ht(i),S=I2(_),C=A2(_),R=0,e=1;if(c<2)for(;;){if(R in S){u=S[R],R+=e;break}if(R+=e,C<=R)throw FC("Reduce of empty array with no initial value")}for(;C>R;R+=e)R in S&&(u=a(u,S[R],R,_));return u}},GC={left:wd()},sl=I,rc=function(n,i){var a=[][n];return!!a&&sl(function(){a.call(null,i||function(){return 1},1)})},Rd=typeof process<"u"&&Te(process)=="process",zC=GC.left;br({target:"Array",proto:!0,forced:!Rd&&ko>79&&ko<83||!rc("reduce")},{reduce:function(n){var i=arguments.length;return zC(this,n,i,i>1?arguments[1]:void 0)}});var Pm=tc("Array").reduce,Qh=Q,HC=Pm,Zh=Array.prototype,FE=function(n){var i=n.reduce;return n===Zh||Qh(Zh,n)&&i===Zh.reduce?HC:i},Mm=FE,Ds=T(Mm),sM=Te,go=Array.isArray||function(n){return sM(n)=="Array"},WC=br,Mf=go,zy=K([].reverse),GE=[1,2];WC({target:"Array",proto:!0,forced:String(GE)===String(GE.reverse())},{reverse:function(){return Mf(this)&&(this.length=this.length),zy(this)}});var $h=tc("Array").reverse,wc=Q,YC=$h,Fl=Array.prototype,A0=function(n){var i=n.reverse;return n===Fl||wc(Fl,n)&&i===Fl.reverse?YC:i},zE=A0,HE=T(zE),ol=Cy,cl=zh("keys"),Cu=function(n){return cl[n]||(cl[n]=ol(n))},kf=!I(function(){function n(){}return n.prototype.constructor=null,Object.getPrototypeOf(new n)!==n.prototype}),Id=ls,km=$e,KC=Tu,Hy=kf,Wy=Cu("IE_PROTO"),qs=Object,wa=qs.prototype,Si=Hy?qs.getPrototypeOf:function(n){var i=KC(n);if(Id(i,Wy))return i[Wy];var a=i.constructor;return km(a)&&i instanceof a?a.prototype:i instanceof qs?wa:null},xm=K,wu=$i,qC=$e,Um=String,JC=TypeError,Yy=function(n,i,a){try{return xm(wu(Object.getOwnPropertyDescriptor(n,i)[a]))}catch{}},WE=Es,jm=function(n){if(typeof n=="object"||qC(n))return n;throw JC("Can't set "+Um(n)+" as a prototype")},O2=Object.setPrototypeOf||("__proto__"in{}?function(){var n,i=!1,a={};try{(n=Yy(Object.prototype,"__proto__","set"))(a,[]),i=a instanceof Array}catch{}return function(c,u){return WE(c),jm(u),i?n(c,u):c.__proto__=u,c}}():void 0),ep={},O0={},xf=ls,Uf=dr,tp=Kh.indexOf,jf=O0,Ky=K([].push),qy=function(n,i){var a,c=Uf(n),u=0,_=[];for(a in c)!xf(jf,a)&&xf(c,a)&&Ky(_,a);for(;i.length>u;)xf(c,a=i[u++])&&(~tp(_,a)||Ky(_,a));return _},Vm=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Jy=qy,Ru=Vm.concat("length","prototype");ep.f=Object.getOwnPropertyNames||function(n){return Jy(n,Ru)};var za={};za.f=Object.getOwnPropertySymbols;var N0=Tr,N2=ep,oM=za,cM=Es,L2=K([].concat),vs=N0("Reflect","ownKeys")||function(n){var i=N2.f(cM(n)),a=oM.f;return a?L2(i,a(n)):i},L0=ls,YE=vs,KE=et,Bm=$a,np={},D0=qy,lM=Vm,qE=Object.keys||function(n){return D0(n,lM)},dM=Oe,D2=mo,rp=$a,XC=Es,Xy=dr,P2=qE;np.f=dM&&!D2?Object.defineProperties:function(n,i){XC(n);for(var a,c=Xy(i),u=P2(i),_=u.length,S=0;_>S;)rp.f(n,a=u[S++],c[a]);return n};var Iu,QC=Tr("document","documentElement"),Qy=Es,P0=np,ZC=Vm,Zy=O0,M2=QC,JE=Oy,$y="prototype",eT="script",Gl=Cu("IE_PROTO"),M0=function(){},tT=function(n){return"<"+eT+">"+n+"</"+eT+">"},Vf=function(n){n.write(tT("")),n.close();var i=n.parentWindow.Object;return n=null,i},zl=function(){try{Iu=new ActiveXObject("htmlfile")}catch{}var n,i,a;zl=typeof document<"u"?document.domain&&Iu?Vf(Iu):(i=JE("iframe"),a="java"+eT+":",i.style.display="none",M2.appendChild(i),i.src=String(a),(n=i.contentWindow.document).open(),n.write(tT("document.F=Object")),n.close(),n.F):Vf(Iu);for(var c=ZC.length;c--;)delete zl[$y][ZC[c]];return zl()};Zy[Gl]=!0;var Bf=Object.create||function(n,i){var a;return n!==null?(M0[$y]=Qy(n),a=new M0,M0[$y]=null,a[Gl]=n):a=zl(),i===void 0?a:P0.f(a,i)},$C=ar,ew=Wh,ip=Error,Fm=K("".replace),tw=String(ip("zxcasd").stack),XE=/\n\s*at [^:]*:[^\n]*/,Gm=XE.test(tw),QE=Gt,ZE=!I(function(){var n=Error("a");return!("stack"in n)||(Object.defineProperty(n,"stack",QE(1,7)),n.stack!==7)}),zm=Wh,nw=function(n,i){if(Gm&&typeof n=="string"&&!ip.prepareStackTrace)for(;i--;)n=Fm(n,XE,"");return n},ap=ZE,Nr=Error.captureStackTrace,ci={},Ss=ci,$E=Ai("iterator"),k0=Array.prototype,sp=function(n){return n!==void 0&&(Ss.Array===n||k0[$E]===n)},nT=Cd,x0=Rm,U0=Jt,uM=ci,es=Ai("iterator"),Ad=function(n){if(!U0(n))return x0(n,es)||x0(n,"@@iterator")||uM[nT(n)]},rw=Ge,k2=$i,x2=Es,U2=er,iw=Ad,rT=TypeError,ev=function(n,i){var a=arguments.length<2?iw(n):i;if(k2(a))return x2(rw(a,n));throw rT(U2(n)+" is not iterable")},Rc=Ge,ds=Es,j0=Rm,V0=function(n,i,a){var c,u;ds(n);try{if(!(c=j0(n,"return"))){if(i==="throw")throw a;return a}c=Rc(c,n)}catch(_){u=!0,c=_}if(i==="throw")throw a;if(u)throw c;return ds(c),a},iT=Cc,aw=Ge,Ff=Es,aT=er,sw=sp,tv=Df,ow=Q,cw=ev,j2=Ad,sT=V0,V2=TypeError,nv=function(n,i){this.stopped=n,this.result=i},oT=nv.prototype,B0=function(n,i,a){var c,u,_,S,C,R,e,t=a&&a.that,r=!(!a||!a.AS_ENTRIES),s=!(!a||!a.IS_RECORD),l=!(!a||!a.IS_ITERATOR),f=!(!a||!a.INTERRUPTED),m=iT(i,t),E=function(b){return c&&sT(c,"normal",b),new nv(!0,b)},y=function(b){return r?(Ff(b),f?m(b[0],b[1],E):m(b[0],b[1])):f?m(b,E):m(b)};if(s)c=n.iterator;else if(l)c=n;else{if(!(u=j2(n)))throw V2(aT(n)+" is not iterable");if(sw(u)){for(_=0,S=tv(n);S>_;_++)if((C=y(n[_]))&&ow(oT,C))return C;return new nv(!1)}c=cw(n,u)}for(R=s?n.next:c.next;!(e=aw(R,c)).done;){try{C=y(e.value)}catch(b){sT(c,"throw",b)}if(typeof C=="object"&&C&&ow(oT,C))return C}return new nv(!1)},fM=nc,B2=br,lw=Q,F2=Si,F0=O2,dw=function(n,i,a){for(var c=YE(i),u=Bm.f,_=KE.f,S=0;S<c.length;S++){var C=c[S];L0(n,C)||a&&L0(a,C)||u(n,C,_(i,C))}},uw=Bf,Hm=Wh,rv=Gt,G0=function(n,i){$C(i)&&"cause"in i&&ew(n,"cause",i.cause)},hM=function(n,i,a,c){ap&&(Nr?Nr(n,i):zm(n,"stack",nw(a,c)))},G2=B0,z0=function(n,i){return n===void 0?arguments.length<2?"":i:fM(n)},cT=Ai("toStringTag"),op=Error,lT=[].push,Od=function(n,i){var a,c=lw(H0,this);F0?a=F0(op(),c?F2(this):H0):(a=c?this:uw(H0),Hm(a,cT,"Error")),i!==void 0&&Hm(a,"message",z0(i)),hM(a,Od,a.stack,1),arguments.length>2&&G0(a,arguments[2]);var u=[];return G2(n,lT,{that:u}),Hm(a,"errors",u),a};F0?F0(Od,op):dw(Od,op,{name:!0});var H0=Od.prototype=uw(op.prototype,{constructor:rv(1,Od),message:rv(1,""),name:rv(1,"AggregateError")});B2({global:!0},{AggregateError:Od});var Wm,W0,iv,z2=$e,fw=X.WeakMap,hw=z2(fw)&&/native code/.test(String(fw)),Y0=X,H2=ar,cp=Wh,K0=ls,Ym=cs,av=Cu,q0=O0,pw="Object already initialized",sv=Y0.TypeError,mw=Y0.WeakMap;if(hw||Ym.state){var Hl=Ym.state||(Ym.state=new mw);Hl.get=Hl.get,Hl.has=Hl.has,Hl.set=Hl.set,Wm=function(n,i){if(Hl.has(n))throw sv(pw);return i.facade=n,Hl.set(n,i),i},W0=function(n){return Hl.get(n)||{}},iv=function(n){return Hl.has(n)}}else{var Km=av("state");q0[Km]=!0,Wm=function(n,i){if(K0(n,Km))throw sv(pw);return i.facade=n,cp(n,Km,i),i},W0=function(n){return K0(n,Km)?n[Km]:{}},iv=function(n){return K0(n,Km)}}var qm,dT,ov,Nd={set:Wm,get:W0,has:iv,enforce:function(n){return iv(n)?W0(n):Wm(n,{})},getterFor:function(n){return function(i){var a;if(!H2(i)||(a=W0(i)).type!==n)throw sv("Incompatible receiver, "+n+" required");return a}}},cv=Oe,lv=ls,dv=Function.prototype,W2=cv&&Object.getOwnPropertyDescriptor,Ic=lv(dv,"name"),lp={PROPER:Ic&&(function(){}).name==="something",CONFIGURABLE:Ic&&(!cv||cv&&W2(dv,"name").configurable)},dp=Wh,Gf=function(n,i,a,c){return c&&c.enumerable?n[i]=a:dp(n,i,a),n},Jm=I,Ld=$e,J0=ar,uv=Bf,X0=Si,Y2=Gf,fv=Ai("iterator"),up=!1;[].keys&&("next"in(ov=[].keys())?(dT=X0(X0(ov)))!==Object.prototype&&(qm=dT):up=!0);var K2=!J0(qm)||Jm(function(){var n={};return qm[fv].call(n)!==n});Ld((qm=K2?{}:uv(qm))[fv])||Y2(qm,fv,function(){return this});var ys={IteratorPrototype:qm,BUGGY_SAFARI_ITERATORS:up},Au=Cd,fp=jC?{}.toString:function(){return"[object "+Au(this)+"]"},q2=jC,hp=$a.f,Ou=Wh,Ps=ls,Q0=fp,hv=Ai("toStringTag"),Nu=function(n,i,a,c){if(n){var u=a?n:n.prototype;Ps(u,hv)||hp(u,hv,{configurable:!0,value:i}),c&&!q2&&Ou(u,"toString",Q0)}},gw=ys.IteratorPrototype,J2=Bf,Xm=Gt,uT=Nu,X2=ci,Q2=function(){return this},fT=function(n,i,a,c){var u=i+" Iterator";return n.prototype=J2(gw,{next:Xm(+!c,a)}),uT(n,u,!1,!0),X2[u]=Q2,n},hT=br,_w=Ge,Dd=lp,Z2=fT,$2=Si,pM=Nu,Ew=Gf,Ms=ci,_o=ys,pT=Dd.PROPER,pv=_o.BUGGY_SAFARI_ITERATORS,mT=Ai("iterator"),vw="keys",mv="values",gv="entries",Sw=function(){return this},gT=function(n,i,a,c,u,_,S){Z2(a,i,c);var C,R,e,t=function(y){if(y===u&&m)return m;if(!pv&&y in l)return l[y];switch(y){case vw:case mv:case gv:return function(){return new a(this,y)}}return function(){return new a(this)}},r=i+" Iterator",s=!1,l=n.prototype,f=l[mT]||l["@@iterator"]||u&&l[u],m=!pv&&f||t(u),E=i=="Array"&&l.entries||f;if(E&&(C=$2(E.call(new n)))!==Object.prototype&&C.next&&(pM(C,r,!0,!0),Ms[r]=Sw),pT&&u==mv&&f&&f.name!==mv&&(s=!0,m=function(){return _w(f,this)}),u)if(R={values:t(mv),keys:_?m:t(vw),entries:t(gv)},S)for(e in R)(pv||s||!(e in l))&&Ew(l,e,R[e]);else hT({target:i,proto:!0,forced:pv||s},R);return S&&l[mT]!==m&&Ew(l,mT,m,{}),Ms[i]=m,R},_v=function(n,i){return{value:n,done:i}},eO=dr,_T=ci,Qm=Nd;$a.f;var Ev=gT,ET=_v,Zm="Array Iterator",vv=Qm.set,yw=Qm.getterFor(Zm);Ev(Array,"Array",function(n,i){vv(this,{type:Zm,target:eO(n),index:0,kind:i})},function(){var n=yw(this),i=n.target,a=n.kind,c=n.index++;return!i||c>=i.length?(n.target=void 0,ET(void 0,!0)):ET(a=="keys"?c:a=="values"?i[c]:[c,i[c]],!1)},"values"),_T.Arguments=_T.Array;var Tw=$a,zf=function(n,i,a){return Tw.f(n,i,a)},tO=Tr,Lu=zf,vT=Oe,nO=Ai("species"),Sv=Q,Du=TypeError,ST=function(n,i){if(Sv(i,n))return n;throw Du("Incorrect invocation")},yT=$e,$m=cs,ga=K(Function.toString);yT($m.inspectSource)||($m.inspectSource=function(n){return ga(n)});var rO=$m.inspectSource,mM=K,iO=I,eg=$e,pp=Cd,aO=rO,yv=function(){},Tv=[],ll=Tr("Reflect","construct"),TT=/^\s*(?:class|function)\b/,bT=mM(TT.exec),sO=!TT.exec(yv),tg=function(n){if(!eg(n))return!1;try{return ll(yv,Tv,n),!0}catch{return!1}},bv=function(n){if(!eg(n))return!1;switch(pp(n)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return sO||!!bT(TT,aO(n))}catch{return!0}};bv.sham=!0;var mp,ng,Pd,Da,gp=!ll||iO(function(){var n;return tg(tg.call)||!tg(Object)||!tg(function(){n=!0})||n})?bv:tg,oO=gp,Js=er,Cv=TypeError,CT=Es,Z0=function(n){if(oO(n))return n;throw Cv(Js(n)+" is not a constructor")},qi=Jt,ic=Ai("species"),dl=function(n,i){var a,c=CT(n).constructor;return c===void 0||qi(a=CT(c)[ic])?i:Z0(a)},_p=K([].slice),cO=TypeError,$0=function(n,i){if(n<i)throw cO("Not enough arguments");return n},wT=/(?:ipad|iphone|ipod).*applewebkit/i.test(ss),_a=X,Md=ue,lO=Cc,Ac=$e,RT=ls,xo=I,Ep=QC,Oc=_p,wv=Oy,ac=$0,Pu=wT,dO=Rd,Hf=_a.setImmediate,rg=_a.clearImmediate,e_=_a.process,Wf=_a.Dispatch,uO=_a.Function,IT=_a.MessageChannel,Rv=_a.String,AT=0,vp={},Iv="onreadystatechange";xo(function(){mp=_a.location});var Av=function(n){if(RT(vp,n)){var i=vp[n];delete vp[n],i()}},bw=function(n){return function(){Av(n)}},Oi=function(n){Av(n.data)},oa=function(n){_a.postMessage(Rv(n),mp.protocol+"//"+mp.host)};Hf&&rg||(Hf=function(n){ac(arguments.length,1);var i=Ac(n)?n:uO(n),a=Oc(arguments,1);return vp[++AT]=function(){Md(i,void 0,a)},ng(AT),AT},rg=function(n){delete vp[n]},dO?ng=function(n){e_.nextTick(bw(n))}:Wf&&Wf.now?ng=function(n){Wf.now(bw(n))}:IT&&!Pu?(Da=(Pd=new IT).port2,Pd.port1.onmessage=Oi,ng=lO(Da.postMessage,Da)):_a.addEventListener&&Ac(_a.postMessage)&&!_a.importScripts&&mp&&mp.protocol!=="file:"&&!xo(oa)?(ng=oa,_a.addEventListener("message",Oi,!1)):ng=Iv in wv("script")?function(n){Ep.appendChild(wv("script"))[Iv]=function(){Ep.removeChild(this),Av(n)}}:function(n){setTimeout(bw(n),0)});var Lr={set:Hf,clear:rg},ii=function(){this.head=null,this.tail=null};ii.prototype={add:function(n){var i={item:n,next:null},a=this.tail;a?a.next=i:this.head=i,this.tail=i},get:function(){var n=this.head;if(n)return(this.head=n.next)===null&&(this.tail=null),n.item}};var Zr,ks,kd,Mu,t_,xd=ii,Ha=/ipad|iphone|ipod/i.test(ss)&&typeof Pebble<"u",Ud=/web0s(?!.*chrome)/i.test(ss),Nc=X,OT=Cc,Wl=et.f,Yf=Lr.set,n_=xd,xs=wT,Ov=Ha,Nv=Ud,Sp=Rd,r_=Nc.MutationObserver||Nc.WebKitMutationObserver,ku=Nc.document,Xs=Nc.process,jd=Nc.Promise,Yl=Wl(Nc,"queueMicrotask"),yp=Yl&&Yl.value;if(!yp){var ig=new n_,Tp=function(){var n,i;for(Sp&&(n=Xs.domain)&&n.exit();i=ig.get();)try{i()}catch(a){throw ig.head&&Zr(),a}n&&n.enter()};xs||Sp||Nv||!r_||!ku?!Ov&&jd&&jd.resolve?((Mu=jd.resolve(void 0)).constructor=jd,t_=OT(Mu.then,Mu),Zr=function(){t_(Tp)}):Sp?Zr=function(){Xs.nextTick(Tp)}:(Yf=OT(Yf,Nc),Zr=function(){Yf(Tp)}):(ks=!0,kd=ku.createTextNode(""),new r_(Tp).observe(kd,{characterData:!0}),Zr=function(){kd.data=ks=!ks}),yp=function(n){ig.head||Zr(),ig.add(n)}}var Cw=yp,xu=function(n){try{return{error:!1,value:n()}}catch(i){return{error:!0,value:i}}},Kf=X.Promise,Lc=typeof Deno=="object"&&Deno&&typeof Deno.version=="object",NT=!Lc&&!Rd&&typeof window=="object"&&typeof document=="object",Dc=X,ag=Kf,ww=$e,LT=PE,Uu=rO,sg=Ai,i_=NT,og=Lc,qf=ko,Jf=ag&&ag.prototype,fO=sg("species"),bp=ww(Dc.PromiseRejectionEvent),Rw=LT("Promise",function(){var n=Uu(ag),i=n!==String(ag);if(!i&&qf===66||!Jf.catch||!Jf.finally)return!0;if(!qf||qf<51||!/native code/.test(n)){var a=new ag(function(u){u(1)}),c=function(u){u(function(){},function(){})};if((a.constructor={})[fO]=c,!(a.then(function(){})instanceof c))return!0}return!i&&(i_||og)&&!bp}),Lv={CONSTRUCTOR:Rw,REJECTION_EVENT:bp},ju={},hO=$i,Iw=TypeError,DT=function(n){var i,a;this.promise=new n(function(c,u){if(i!==void 0||a!==void 0)throw Iw("Bad Promise constructor");i=c,a=u}),this.resolve=hO(i),this.reject=hO(a)};ju.f=function(n){return new DT(n)};var Xf,Dv,Aw=br,Pv=Rd,ul=X,sc=Ge,Ow=Gf,pO=Nu,PT=function(n){var i=tO(n);vT&&i&&!i[nO]&&Lu(i,nO,{configurable:!0,get:function(){return this}})},MT=$i,Mv=$e,ca=ar,a_=ST,Cp=dl,cg=Lr.set,Nw=Cw,gM=function(n,i){try{arguments.length==1?console.error(n):console.error(n,i)}catch{}},_M=xu,kT=xd,Qf=Nd,kv=Kf,xv=Lv,xT=ju,Vd="Promise",fl=xv.CONSTRUCTOR,Uv=xv.REJECTION_EVENT,Lw=Qf.getterFor(Vd),mO=Qf.set,Dw=kv&&kv.prototype,wp=kv,jv=Dw,Pw=ul.TypeError,Rp=ul.document,Vv=ul.process,UT=xT.f,Mw=UT,kw=!!(Rp&&Rp.createEvent&&ul.dispatchEvent),jT="unhandledrejection",s_=function(n){var i;return!(!ca(n)||!Mv(i=n.then))&&i},VT=function(n,i){var a,c,u,_=i.value,S=i.state==1,C=S?n.ok:n.fail,R=n.resolve,e=n.reject,t=n.domain;try{C?(S||(i.rejection===2&&xw(i),i.rejection=1),C===!0?a=_:(t&&t.enter(),a=C(_),t&&(t.exit(),u=!0)),a===n.promise?e(Pw("Promise-chain cycle")):(c=s_(a))?sc(c,a,R,e):R(a)):e(_)}catch(r){t&&!u&&t.exit(),e(r)}},lg=function(n,i){n.notified||(n.notified=!0,Nw(function(){for(var a,c=n.reactions;a=c.get();)VT(a,n);n.notified=!1,i&&!n.rejection&&FT(n)}))},BT=function(n,i,a){var c,u;kw?((c=Rp.createEvent("Event")).promise=i,c.reason=a,c.initEvent(n,!1,!0),ul.dispatchEvent(c)):c={promise:i,reason:a},!Uv&&(u=ul["on"+n])?u(c):n===jT&&gM("Unhandled promise rejection",a)},FT=function(n){sc(cg,ul,function(){var i,a=n.facade,c=n.value;if(Pr(n)&&(i=_M(function(){Pv?Vv.emit("unhandledRejection",c,a):BT(jT,a,c)}),n.rejection=Pv||Pr(n)?2:1,i.error))throw i.value})},Pr=function(n){return n.rejection!==1&&!n.parent},xw=function(n){sc(cg,ul,function(){var i=n.facade;Pv?Vv.emit("rejectionHandled",i):BT("rejectionhandled",i,n.value)})},Zf=function(n,i,a){return function(c){n(i,c,a)}},$f=function(n,i,a){n.done||(n.done=!0,a&&(n=a),n.value=i,n.state=2,lg(n,!0))},Bv=function(n,i,a){if(!n.done){n.done=!0,a&&(n=a);try{if(n.facade===i)throw Pw("Promise can't be resolved itself");var c=s_(i);c?Nw(function(){var u={done:!1};try{sc(c,i,Zf(Bv,u,n),Zf($f,u,n))}catch(_){$f(u,_,n)}}):(n.value=i,n.state=1,lg(n,!1))}catch(u){$f({done:!1},u,n)}}};fl&&(jv=(wp=function(n){a_(this,jv),MT(n),sc(Xf,this);var i=Lw(this);try{n(Zf(Bv,i),Zf($f,i))}catch(a){$f(i,a)}}).prototype,(Xf=function(n){mO(this,{type:Vd,done:!1,notified:!1,parent:!1,reactions:new kT,rejection:!1,state:0,value:void 0})}).prototype=Ow(jv,"then",function(n,i){var a=Lw(this),c=UT(Cp(this,wp));return a.parent=!0,c.ok=!Mv(n)||n,c.fail=Mv(i)&&i,c.domain=Pv?Vv.domain:void 0,a.state==0?a.reactions.add(c):Nw(function(){VT(c,a)}),c.promise}),Dv=function(){var n=new Xf,i=Lw(n);this.promise=n,this.resolve=Zf(Bv,i),this.reject=Zf($f,i)},xT.f=UT=function(n){return n===wp||n===void 0?new Dv(n):Mw(n)}),Aw({global:!0,wrap:!0,forced:fl},{Promise:wp}),pO(wp,Vd,!1,!0),PT(Vd);var Fv=Ai("iterator"),dg=!1;try{var Gv=0,ug={next:function(){return{done:!!Gv++}},return:function(){dg=!0}};ug[Fv]=function(){return this},Array.from(ug,function(){throw 2})}catch{}var Uw=Kf,EM=function(n,i){if(!dg)return!1;var a=!1;try{var c={};c[Fv]=function(){return{next:function(){return{done:a=!0}}}},n(c)}catch{}return a},eh=Lv.CONSTRUCTOR||!EM(function(n){Uw.all(n).then(void 0,function(){})}),fg=Ge,GT=$i,zv=ju,Ji=xu,jw=B0;br({target:"Promise",stat:!0,forced:eh},{all:function(n){var i=this,a=zv.f(i),c=a.resolve,u=a.reject,_=Ji(function(){var S=GT(i.resolve),C=[],R=0,e=1;jw(n,function(t){var r=R++,s=!1;e++,fg(S,i,t).then(function(l){s||(s=!0,C[r]=l,--e||c(C))},u)}),--e||c(C)});return _.error&&u(_.value),a.promise}});var Qs=br,vM=Lv.CONSTRUCTOR;Kf&&Kf.prototype,Qs({target:"Promise",proto:!0,forced:vM,real:!0},{catch:function(n){return this.then(void 0,n)}});var Vw=Ge,o_=$i,zT=ju,gO=xu,_O=B0;br({target:"Promise",stat:!0,forced:eh},{race:function(n){var i=this,a=zT.f(i),c=a.reject,u=gO(function(){var _=o_(i.resolve);_O(n,function(S){Vw(_,i,S).then(a.resolve,c)})});return u.error&&c(u.value),a.promise}});var Bw=Ge,Fw=ju;br({target:"Promise",stat:!0,forced:Lv.CONSTRUCTOR},{reject:function(n){var i=Fw.f(this);return Bw(i.reject,void 0,n),i.promise}});var SM=Es,EO=ar,yM=ju,Gw=function(n,i){if(SM(n),EO(i)&&i.constructor===n)return i;var a=yM.f(n);return(0,a.resolve)(i),a.promise},TM=br,bM=Kf,Ip=Lv.CONSTRUCTOR,vO=Gw,zw=Tr("Promise"),CM=!Ip;TM({target:"Promise",stat:!0,forced:!0},{resolve:function(n){return vO(CM&&this===zw?bM:this,n)}});var wM=Ge,HT=$i,RM=ju,Bd=xu,Hw=B0;br({target:"Promise",stat:!0,forced:eh},{allSettled:function(n){var i=this,a=RM.f(i),c=a.resolve,u=a.reject,_=Bd(function(){var S=HT(i.resolve),C=[],R=0,e=1;Hw(n,function(t){var r=R++,s=!1;e++,wM(S,i,t).then(function(l){s||(s=!0,C[r]={status:"fulfilled",value:l},--e||c(C))},function(l){s||(s=!0,C[r]={status:"rejected",reason:l},--e||c(C))})}),--e||c(C)});return _.error&&u(_.value),a.promise}});var SO=Ge,yO=$i,Hv=Tr,Kl=ju,TO=xu,WT=B0,Vu="No one promise resolved";br({target:"Promise",stat:!0,forced:eh},{any:function(n){var i=this,a=Hv("AggregateError"),c=Kl.f(i),u=c.resolve,_=c.reject,S=TO(function(){var C=yO(i.resolve),R=[],e=0,t=1,r=!1;WT(n,function(s){var l=e++,f=!1;t++,SO(C,i,s).then(function(m){f||r||(r=!0,u(m))},function(m){f||r||(f=!0,R[l]=m,--t||_(new a(R,Vu)))})}),--t||_(new a(R,Vu))});return S.error&&_(S.value),c.promise}});var IM=br,Ww=Kf,c_=I,bO=Tr,AM=$e,OM=dl,CO=Gw,wO=Ww&&Ww.prototype;IM({target:"Promise",proto:!0,real:!0,forced:!!Ww&&c_(function(){wO.finally.call({then:function(){}},function(){})})},{finally:function(n){var i=OM(this,bO("Promise")),a=AM(n);return this.then(a?function(c){return CO(i,n()).then(function(){return c})}:n,a?function(c){return CO(i,n()).then(function(){throw c})}:n)}});var Yw=K,NM=VE,LM=nc,RO=oi,l_=Yw("".charAt),hg=Yw("".charCodeAt),YT=Yw("".slice),Kw=function(n){return function(i,a){var c,u,_=LM(RO(i)),S=NM(a),C=_.length;return S<0||S>=C?n?"":void 0:(c=hg(_,S))<55296||c>56319||S+1===C||(u=hg(_,S+1))<56320||u>57343?n?l_(_,S):c:n?YT(_,S,S+2):u-56320+(c-55296<<10)+65536}},Ap={codeAt:Kw(!1),charAt:Kw(!0)},Wv=Ap.charAt,KT=nc,Yv=Nd,qw=gT,qT=_v,Kv="String Iterator",Jw=Yv.set,IO=Yv.getterFor(Kv);qw(String,"String",function(n){Jw(this,{type:Kv,string:KT(n),index:0})},function(){var n,i=IO(this),a=i.string,c=i.index;return c>=a.length?qT(void 0,!0):(n=Wv(a,c),i.index+=n.length,qT(n,!1))});var Xw=Sn.Promise,AO={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},qv=X,DM=Cd,PM=Wh,Qw=ci,Jv=Ai("toStringTag");for(var pg in AO){var d_=qv[pg],Zw=d_&&d_.prototype;Zw&&DM(Zw)!==Jv&&PM(Zw,Jv,pg),Qw[pg]=Qw.Array}var u_=Xw,Et=T(u_),OO=tc("Array").values,$w=Cd,eR=ls,NO=Q,tR=OO,JT=Array.prototype,XT={DOMTokenList:!0,NodeList:!0},MM=function(n){var i=n.values;return n===JT||NO(JT,n)&&i===JT.values||eR(XT,$w(n))?tR:i},Pc=T(MM),QT=I,Xv=Ai("iterator"),mg=!QT(function(){var n=new URL("b?a=1&b=2&c=3","http://a"),i=n.searchParams,a=new URLSearchParams("a=1&a=2"),c="";return n.pathname="c%20d",i.forEach(function(u,_){i.delete("b"),c+=_+u}),a.delete("a",2),!n.toJSON||!a.has("a",1)||a.has("a",2)||!i.size&&!0||!i.sort||n.href!=="http://a/c%20d?a=1&c=3"||i.get("c")!=="3"||String(new URLSearchParams("?a=1"))!=="a=1"||!i[Xv]||new URL("https://a@b").username!=="a"||new URLSearchParams(new URLSearchParams("a=b")).get("a")!=="b"||new URL("http://").host!=="xn--e1aybc"||new URL("http://a#").hash!=="#%D0%B1"||c!=="a1c3"||new URL("http://x",void 0).host!=="x"}),gt=Gf,LO=LE,nR=$a,Op=Gt,Fd=function(n,i,a){var c=LO(i);c in n?nR.f(n,c,Op(0,a)):n[c]=a},th=ky,gg=Df,Qv=Fd,Np=Array,oc=Math.max,Zv=function(n,i,a){for(var c=gg(n),u=th(i,c),_=th(a===void 0?c:a,c),S=Np(oc(_-u,0)),C=0;u<_;u++,C++)Qv(S,C,n[u]);return S.length=C,S},f_=Zv,DO=Math.floor,ZT=function(n,i){var a=n.length,c=DO(a/2);return a<8?h_(n,i):rR(n,ZT(f_(n,0,c),i),ZT(f_(n,c),i),i)},h_=function(n,i){for(var a,c,u=n.length,_=1;_<u;){for(c=_,a=n[_];c&&i(n[c-1],a)>0;)n[c]=n[--c];c!==_++&&(n[c]=a)}return n},rR=function(n,i,a,c){for(var u=i.length,_=a.length,S=0,C=0;S<u||C<_;)n[S+C]=S<u&&C<_?c(i[S],a[C])<=0?i[S++]:a[C++]:S<u?i[S++]:a[C++];return n},iR=ZT,p_=br,nh=X,m_=Ge,Mc=K,Lp=Oe,g_=mg,aR=Gf,kM=zf,$v=function(n,i,a){for(var c in i)a&&a.unsafe&&n[c]?n[c]=i[c]:gt(n,c,i[c],a);return n},p=Nu,v=fT,w=Nd,L=ST,U=$e,H=ls,pe=Cc,Ce=Cd,Fe=Es,it=ar,pt=nc,xt=Bf,ct=Gt,dt=ev,tr=Ad,wn=$0,ta=iR,nt=Ai("iterator"),Je="URLSearchParams",st=Je+"Iterator",Nt=w.set,sn=w.getterFor(Je),Gr=w.getterFor(st),Rn=Object.getOwnPropertyDescriptor,Vn=function(n){if(!Lp)return nh[n];var i=Rn(nh,n);return i&&i.value},Us=Vn("fetch"),$r=Vn("Request"),hl=Vn("Headers"),sR=$r&&$r.prototype,iV=hl&&hl.prototype,Rz=nh.RegExp,PO=nh.TypeError,aV=nh.decodeURIComponent,xM=nh.encodeURIComponent,sV=Mc("".charAt),MO=Mc([].join),eS=Mc([].push),$T=Mc("".replace),rh=Mc([].shift),eb=Mc([].splice),UM=Mc("".split),oV=Mc("".slice),Iz=/\+/g,cV=Array(4),Az=function(n){return cV[n-1]||(cV[n-1]=Rz("((?:%[\\da-f]{2}){"+n+"})","gi"))},Oz=function(n){try{return aV(n)}catch{return n}},kO=function(n){var i=$T(n,Iz," "),a=4;try{return aV(i)}catch{for(;a;)i=$T(i,Az(a--),Oz);return i}},lV=/[!'()~]|%20/g,jM={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},Nz=function(n){return jM[n]},dV=function(n){return $T(xM(n),lV,Nz)},VM=v(function(n,i){Nt(this,{type:st,iterator:dt(sn(n).entries),kind:i})},"Iterator",function(){var n=Gr(this),i=n.kind,a=n.iterator.next(),c=a.value;return a.done||(a.value=i==="keys"?c.key:i==="values"?c.value:[c.key,c.value]),a},!0),uV=function(n){this.entries=[],this.url=null,n!==void 0&&(it(n)?this.parseObject(n):this.parseQuery(typeof n=="string"?sV(n,0)==="?"?oV(n,1):n:pt(n)))};uV.prototype={type:Je,bindURL:function(n){this.url=n,this.update()},parseObject:function(n){var i,a,c,u,_,S,C,R=tr(n);if(R)for(a=(i=dt(n,R)).next;!(c=m_(a,i)).done;){if(_=(u=dt(Fe(c.value))).next,(S=m_(_,u)).done||(C=m_(_,u)).done||!m_(_,u).done)throw PO("Expected sequence with length 2");eS(this.entries,{key:pt(S.value),value:pt(C.value)})}else for(var e in n)H(n,e)&&eS(this.entries,{key:e,value:pt(n[e])})},parseQuery:function(n){if(n)for(var i,a,c=UM(n,"&"),u=0;u<c.length;)(i=c[u++]).length&&(a=UM(i,"="),eS(this.entries,{key:kO(rh(a)),value:kO(MO(a,"="))}))},serialize:function(){for(var n,i=this.entries,a=[],c=0;c<i.length;)n=i[c++],eS(a,dV(n.key)+"="+dV(n.value));return MO(a,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var oR=function(){L(this,Zs);var n=Nt(this,new uV(arguments.length>0?arguments[0]:void 0));Lp||(this.size=n.entries.length)},Zs=oR.prototype;if($v(Zs,{append:function(n,i){var a=sn(this);wn(arguments.length,2),eS(a.entries,{key:pt(n),value:pt(i)}),Lp||this.length++,a.updateURL()},delete:function(n){for(var i=sn(this),a=wn(arguments.length,1),c=i.entries,u=pt(n),_=a<2?void 0:arguments[1],S=_===void 0?_:pt(_),C=0;C<c.length;){var R=c[C];if(R.key!==u||S!==void 0&&R.value!==S)C++;else if(eb(c,C,1),S!==void 0)break}Lp||(this.size=c.length),i.updateURL()},get:function(n){var i=sn(this).entries;wn(arguments.length,1);for(var a=pt(n),c=0;c<i.length;c++)if(i[c].key===a)return i[c].value;return null},getAll:function(n){var i=sn(this).entries;wn(arguments.length,1);for(var a=pt(n),c=[],u=0;u<i.length;u++)i[u].key===a&&eS(c,i[u].value);return c},has:function(n){for(var i=sn(this).entries,a=wn(arguments.length,1),c=pt(n),u=a<2?void 0:arguments[1],_=u===void 0?u:pt(u),S=0;S<i.length;){var C=i[S++];if(C.key===c&&(_===void 0||C.value===_))return!0}return!1},set:function(n,i){var a=sn(this);wn(arguments.length,1);for(var c,u=a.entries,_=!1,S=pt(n),C=pt(i),R=0;R<u.length;R++)(c=u[R]).key===S&&(_?eb(u,R--,1):(_=!0,c.value=C));_||eS(u,{key:S,value:C}),Lp||(this.size=u.length),a.updateURL()},sort:function(){var n=sn(this);ta(n.entries,function(i,a){return i.key>a.key?1:-1}),n.updateURL()},forEach:function(n){for(var i,a=sn(this).entries,c=pe(n,arguments.length>1?arguments[1]:void 0),u=0;u<a.length;)c((i=a[u++]).value,i.key,this)},keys:function(){return new VM(this,"keys")},values:function(){return new VM(this,"values")},entries:function(){return new VM(this,"entries")}},{enumerable:!0}),aR(Zs,nt,Zs.entries,{}),aR(Zs,"toString",function(){return sn(this).serialize()},{enumerable:!0}),Lp&&kM(Zs,"size",{get:function(){return sn(this).entries.length},configurable:!0,enumerable:!0}),p(oR,Je),p_({global:!0,forced:!g_},{URLSearchParams:oR}),!g_&&U(hl)){var Lz=Mc(iV.has),fV=Mc(iV.set),BM=function(n){if(it(n)){var i,a=n.body;if(Ce(a)===Je)return i=n.headers?new hl(n.headers):new hl,Lz(i,"content-type")||fV(i,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),xt(n,{body:ct(0,pt(a)),headers:ct(0,i)})}return n};if(U(Us)&&p_({global:!0,dontCallGetSet:!0,forced:!0},{fetch:function(n){return Us(n,arguments.length>1?BM(arguments[1]):{})}}),U($r)){var FM=function(n){return L(this,sR),new $r(n,arguments.length>1?BM(arguments[1]):{})};sR.constructor=FM,FM.prototype=sR,p_({global:!0,dontCallGetSet:!0,forced:!0},{Request:FM})}}var pl,tb={URLSearchParams:oR,getState:sn},Dz=Sn.URLSearchParams,hV=Oe,nb=K,pV=Ge,mV=I,ql=qE,Pz=za,gV=Ae,xO=Tu,cR=Ht,__=Object.assign,GM=Object.defineProperty,Mz=nb([].concat),kz=!__||mV(function(){if(hV&&__({b:1},__(GM({},"a",{enumerable:!0,get:function(){GM(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var n={},i={},a=Symbol(),c="abcdefghijklmnopqrst";return n[a]=7,c.split("").forEach(function(u){i[u]=u}),__({},n)[a]!=7||ql(__({},i)).join("")!=c})?function(n,i){for(var a=xO(n),c=arguments.length,u=1,_=Pz.f,S=gV.f;c>u;)for(var C,R=cR(arguments[u++]),e=_?Mz(ql(R),_(R)):ql(R),t=e.length,r=0;t>r;)C=e[r++],hV&&!pV(S,R,C)||(a[C]=R[C]);return a}:__,xz=Es,Uz=V0,jz=Cc,UO=Ge,_V=Tu,E_=function(n,i,a,c){try{return c?i(xz(a)[0],a[1]):i(a)}catch(u){Uz(n,"throw",u)}},EV=sp,Vz=gp,vV=Df,zM=Fd,SV=ev,Bz=Ad,yV=Array,tS=K,jO=2147483647,Fz=/[^\0-\u007E]/,TV=/[.\u3002\uFF0E\uFF61]/g,HM="Overflow: input needs wider integers to process",bV=RangeError,Gz=tS(TV.exec),rb=Math.floor,VO=String.fromCharCode,BO=tS("".charCodeAt),WM=tS([].join),ih=tS([].push),ib=tS("".replace),zz=tS("".split),Hz=tS("".toLowerCase),YM=function(n){return n+22+75*(n<26)},KM=function(n,i,a){var c=0;for(n=a?rb(n/700):n>>1,n+=rb(n/i);n>455;)n=rb(n/35),c+=36;return rb(c+36*n/(n+38))},Bu=function(n){var i=[];n=function(y){for(var b=[],A=0,O=y.length;A<O;){var D=BO(y,A++);if(D>=55296&&D<=56319&&A<O){var P=BO(y,A++);(64512&P)==56320?ih(b,((1023&D)<<10)+(1023&P)+65536):(ih(b,D),A--)}else ih(b,D)}return b}(n);var a,c,u=n.length,_=128,S=0,C=72;for(a=0;a<n.length;a++)(c=n[a])<128&&ih(i,VO(c));var R=i.length,e=R;for(R&&ih(i,"-");e<u;){var t=jO;for(a=0;a<n.length;a++)(c=n[a])>=_&&c<t&&(t=c);var r=e+1;if(t-_>rb((jO-S)/r))throw bV(HM);for(S+=(t-_)*r,_=t,a=0;a<n.length;a++){if((c=n[a])<_&&++S>jO)throw bV(HM);if(c==_){for(var s=S,l=36;;){var f=l<=C?1:l>=C+26?26:l-C;if(s<f)break;var m=s-f,E=36-f;ih(i,VO(YM(f+m%E))),s=rb(m/E),l+=36}ih(i,VO(YM(s))),C=KM(S,r,e==R),S=0,e++}}S++,_++}return WM(i,"")},Wz=br,qM=Oe,CV=mg,JM=X,wV=Cc,Fu=K,ab=Gf,Gu=zf,Yz=ST,XM=ls,QM=kz,ah=function(n){var i=_V(n),a=Vz(this),c=arguments.length,u=c>1?arguments[1]:void 0,_=u!==void 0;_&&(u=jz(u,c>2?arguments[2]:void 0));var S,C,R,e,t,r,s=Bz(i),l=0;if(!s||this===yV&&EV(s))for(S=vV(i),C=a?new this(S):yV(S);S>l;l++)r=_?u(i[l],l):i[l],zM(C,l,r);else for(t=(e=SV(i,s)).next,C=a?new this:[];!(R=UO(t,e)).done;l++)r=_?E_(e,u,[R.value,l],!0):R.value,zM(C,l,r);return C.length=l,C},zu=Zv,Kz=Ap.codeAt,qz=function(n){var i,a,c=[],u=zz(ib(Hz(n),TV,"."),".");for(i=0;i<u.length;i++)a=u[i],ih(c,Gz(Fz,a)?"xn--"+Bu(a):a);return WM(c,".")},_g=nc,Jz=Nu,Xz=$0,RV=tb,IV=Nd,ZM=IV.set,FO=IV.getterFor("URL"),Qz=RV.URLSearchParams,Zz=RV.getState,lR=JM.URL,$M=JM.TypeError,GO=JM.parseInt,$z=Math.floor,ek=Math.pow,Hu=Fu("".charAt),sh=Fu(/./.exec),sb=Fu([].join),nS=Fu(1 .toString),tk=Fu([].pop),ob=Fu([].push),zO=Fu("".replace),AV=Fu([].shift),OV=Fu("".split),dR=Fu("".slice),Eg=Fu("".toLowerCase),nk=Fu([].unshift),HO="Invalid scheme",cb="Invalid host",vg="Invalid port",NV=/[a-z]/i,eH=/[\d+-.a-z]/i,rk=/\d/,LV=/^0x/i,tH=/^[0-7]+$/,nH=/^\d+$/,DV=/^[\da-f]+$/i,ik=/[\0\t\n\r #%/:<>?@[\\\]^|]/,rH=/[\0\t\n\r #/:<>?@[\\\]^|]/,ak=/^[\u0000-\u0020]+/,PV=/(^|[^\u0000-\u0020])[\u0000-\u0020]+$/,Wu=/[\t\n\r]/g,v_=function(n){var i,a,c,u;if(typeof n=="number"){for(i=[],a=0;a<4;a++)nk(i,n%256),n=$z(n/256);return sb(i,".")}if(typeof n=="object"){for(i="",c=function(_){for(var S=null,C=1,R=null,e=0,t=0;t<8;t++)_[t]!==0?(e>C&&(S=R,C=e),R=null,e=0):(R===null&&(R=t),++e);return e>C&&(S=R,C=e),S}(n),a=0;a<8;a++)u&&n[a]===0||(u&&(u=!1),c===a?(i+=a?":":"::",u=!0):(i+=nS(n[a],16),a<7&&(i+=":")));return"["+i+"]"}return n},ml={},MV=QM({},ml,{" ":1,'"':1,"<":1,">":1,"`":1}),WO=QM({},MV,{"#":1,"?":1,"{":1,"}":1}),uR=QM({},WO,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),Gd=function(n,i){var a=Kz(n,0);return a>32&&a<127&&!XM(i,n)?n:encodeURIComponent(n)},Jl={ftp:21,file:null,http:80,https:443,ws:80,wss:443},fR=function(n,i){var a;return n.length==2&&sh(NV,Hu(n,0))&&((a=Hu(n,1))==":"||!i&&a=="|")},kV=function(n){var i;return n.length>1&&fR(dR(n,0,2))&&(n.length==2||(i=Hu(n,2))==="/"||i==="\\"||i==="?"||i==="#")},Sg=function(n){return n==="."||Eg(n)==="%2e"},sk={},xV={},YO={},ok={},UV={},lb={},jV={},VV={},S_={},db={},ub={},ck={},KO={},Xl={},Yu={},rS={},fb={},Dp={},iS={},yg={},Tg={},lk=function(n,i,a){var c,u,_,S=_g(n);if(i){if(u=this.parse(S))throw $M(u);this.searchParams=null}else{if(a!==void 0&&(c=new lk(a,!0)),u=this.parse(S,null,c))throw $M(u);(_=Zz(new Qz)).bindURL(this),this.searchParams=_}};lk.prototype={type:"URL",parse:function(n,i,a){var c,u,_,S,C,R=this,e=i||sk,t=0,r="",s=!1,l=!1,f=!1;for(n=_g(n),i||(R.scheme="",R.username="",R.password="",R.host=null,R.port=null,R.path=[],R.query=null,R.fragment=null,R.cannotBeABaseURL=!1,n=zO(n,ak,""),n=zO(n,PV,"$1")),n=zO(n,Wu,""),c=ah(n);t<=c.length;){switch(u=c[t],e){case sk:if(!u||!sh(NV,u)){if(i)return HO;e=YO;continue}r+=Eg(u),e=xV;break;case xV:if(u&&(sh(eH,u)||u=="+"||u=="-"||u=="."))r+=Eg(u);else{if(u!=":"){if(i)return HO;r="",e=YO,t=0;continue}if(i&&(R.isSpecial()!=XM(Jl,r)||r=="file"&&(R.includesCredentials()||R.port!==null)||R.scheme=="file"&&!R.host))return;if(R.scheme=r,i)return void(R.isSpecial()&&Jl[R.scheme]==R.port&&(R.port=null));r="",R.scheme=="file"?e=Xl:R.isSpecial()&&a&&a.scheme==R.scheme?e=ok:R.isSpecial()?e=VV:c[t+1]=="/"?(e=UV,t++):(R.cannotBeABaseURL=!0,ob(R.path,""),e=iS)}break;case YO:if(!a||a.cannotBeABaseURL&&u!="#")return HO;if(a.cannotBeABaseURL&&u=="#"){R.scheme=a.scheme,R.path=zu(a.path),R.query=a.query,R.fragment="",R.cannotBeABaseURL=!0,e=Tg;break}e=a.scheme=="file"?Xl:lb;continue;case ok:if(u!="/"||c[t+1]!="/"){e=lb;continue}e=S_,t++;break;case UV:if(u=="/"){e=db;break}e=Dp;continue;case lb:if(R.scheme=a.scheme,u==pl)R.username=a.username,R.password=a.password,R.host=a.host,R.port=a.port,R.path=zu(a.path),R.query=a.query;else if(u=="/"||u=="\\"&&R.isSpecial())e=jV;else if(u=="?")R.username=a.username,R.password=a.password,R.host=a.host,R.port=a.port,R.path=zu(a.path),R.query="",e=yg;else{if(u!="#"){R.username=a.username,R.password=a.password,R.host=a.host,R.port=a.port,R.path=zu(a.path),R.path.length--,e=Dp;continue}R.username=a.username,R.password=a.password,R.host=a.host,R.port=a.port,R.path=zu(a.path),R.query=a.query,R.fragment="",e=Tg}break;case jV:if(!R.isSpecial()||u!="/"&&u!="\\"){if(u!="/"){R.username=a.username,R.password=a.password,R.host=a.host,R.port=a.port,e=Dp;continue}e=db}else e=S_;break;case VV:if(e=S_,u!="/"||Hu(r,t+1)!="/")continue;t++;break;case S_:if(u!="/"&&u!="\\"){e=db;continue}break;case db:if(u=="@"){s&&(r="%40"+r),s=!0,_=ah(r);for(var m=0;m<_.length;m++){var E=_[m];if(E!=":"||f){var y=Gd(E,uR);f?R.password+=y:R.username+=y}else f=!0}r=""}else if(u==pl||u=="/"||u=="?"||u=="#"||u=="\\"&&R.isSpecial()){if(s&&r=="")return"Invalid authority";t-=ah(r).length+1,r="",e=ub}else r+=u;break;case ub:case ck:if(i&&R.scheme=="file"){e=rS;continue}if(u!=":"||l){if(u==pl||u=="/"||u=="?"||u=="#"||u=="\\"&&R.isSpecial()){if(R.isSpecial()&&r=="")return cb;if(i&&r==""&&(R.includesCredentials()||R.port!==null))return;if(S=R.parseHost(r))return S;if(r="",e=fb,i)return;continue}u=="["?l=!0:u=="]"&&(l=!1),r+=u}else{if(r=="")return cb;if(S=R.parseHost(r))return S;if(r="",e=KO,i==ck)return}break;case KO:if(!sh(rk,u)){if(u==pl||u=="/"||u=="?"||u=="#"||u=="\\"&&R.isSpecial()||i){if(r!=""){var b=GO(r,10);if(b>65535)return vg;R.port=R.isSpecial()&&b===Jl[R.scheme]?null:b,r=""}if(i)return;e=fb;continue}return vg}r+=u;break;case Xl:if(R.scheme="file",u=="/"||u=="\\")e=Yu;else{if(!a||a.scheme!="file"){e=Dp;continue}if(u==pl)R.host=a.host,R.path=zu(a.path),R.query=a.query;else if(u=="?")R.host=a.host,R.path=zu(a.path),R.query="",e=yg;else{if(u!="#"){kV(sb(zu(c,t),""))||(R.host=a.host,R.path=zu(a.path),R.shortenPath()),e=Dp;continue}R.host=a.host,R.path=zu(a.path),R.query=a.query,R.fragment="",e=Tg}}break;case Yu:if(u=="/"||u=="\\"){e=rS;break}a&&a.scheme=="file"&&!kV(sb(zu(c,t),""))&&(fR(a.path[0],!0)?ob(R.path,a.path[0]):R.host=a.host),e=Dp;continue;case rS:if(u==pl||u=="/"||u=="\\"||u=="?"||u=="#"){if(!i&&fR(r))e=Dp;else if(r==""){if(R.host="",i)return;e=fb}else{if(S=R.parseHost(r))return S;if(R.host=="localhost"&&(R.host=""),i)return;r="",e=fb}continue}r+=u;break;case fb:if(R.isSpecial()){if(e=Dp,u!="/"&&u!="\\")continue}else if(i||u!="?")if(i||u!="#"){if(u!=pl&&(e=Dp,u!="/"))continue}else R.fragment="",e=Tg;else R.query="",e=yg;break;case Dp:if(u==pl||u=="/"||u=="\\"&&R.isSpecial()||!i&&(u=="?"||u=="#")){if((C=Eg(C=r))===".."||C==="%2e."||C===".%2e"||C==="%2e%2e"?(R.shortenPath(),u=="/"||u=="\\"&&R.isSpecial()||ob(R.path,"")):Sg(r)?u=="/"||u=="\\"&&R.isSpecial()||ob(R.path,""):(R.scheme=="file"&&!R.path.length&&fR(r)&&(R.host&&(R.host=""),r=Hu(r,0)+":"),ob(R.path,r)),r="",R.scheme=="file"&&(u==pl||u=="?"||u=="#"))for(;R.path.length>1&&R.path[0]==="";)AV(R.path);u=="?"?(R.query="",e=yg):u=="#"&&(R.fragment="",e=Tg)}else r+=Gd(u,WO);break;case iS:u=="?"?(R.query="",e=yg):u=="#"?(R.fragment="",e=Tg):u!=pl&&(R.path[0]+=Gd(u,ml));break;case yg:i||u!="#"?u!=pl&&(u=="'"&&R.isSpecial()?R.query+="%27":R.query+=u=="#"?"%23":Gd(u,ml)):(R.fragment="",e=Tg);break;case Tg:u!=pl&&(R.fragment+=Gd(u,MV))}t++}},parseHost:function(n){var i,a,c;if(Hu(n,0)=="["){if(Hu(n,n.length-1)!="]"||(i=function(u){var _,S,C,R,e,t,r,s=[0,0,0,0,0,0,0,0],l=0,f=null,m=0,E=function(){return Hu(u,m)};if(E()==":"){if(Hu(u,1)!=":")return;m+=2,f=++l}for(;E();){if(l==8)return;if(E()!=":"){for(_=S=0;S<4&&sh(DV,E());)_=16*_+GO(E(),16),m++,S++;if(E()=="."){if(S==0||(m-=S,l>6))return;for(C=0;E();){if(R=null,C>0){if(!(E()=="."&&C<4))return;m++}if(!sh(rk,E()))return;for(;sh(rk,E());){if(e=GO(E(),10),R===null)R=e;else{if(R==0)return;R=10*R+e}if(R>255)return;m++}s[l]=256*s[l]+R,++C!=2&&C!=4||l++}if(C!=4)return;break}if(E()==":"){if(m++,!E())return}else if(E())return;s[l++]=_}else{if(f!==null)return;m++,f=++l}}if(f!==null)for(t=l-f,l=7;l!=0&&t>0;)r=s[l],s[l--]=s[f+t-1],s[f+--t]=r;else if(l!=8)return;return s}(dR(n,1,-1)),!i))return cb;this.host=i}else if(this.isSpecial()){if(n=qz(n),sh(ik,n)||(i=function(u){var _,S,C,R,e,t,r,s=OV(u,".");if(s.length&&s[s.length-1]==""&&s.length--,(_=s.length)>4)return u;for(S=[],C=0;C<_;C++){if((R=s[C])=="")return u;if(e=10,R.length>1&&Hu(R,0)=="0"&&(e=sh(LV,R)?16:8,R=dR(R,e==8?1:2)),R==="")t=0;else{if(!sh(e==10?nH:e==8?tH:DV,R))return u;t=GO(R,e)}ob(S,t)}for(C=0;C<_;C++)if(t=S[C],C==_-1){if(t>=ek(256,5-_))return null}else if(t>255)return null;for(r=tk(S),C=0;C<S.length;C++)r+=S[C]*ek(256,3-C);return r}(n),i===null))return cb;this.host=i}else{if(sh(rH,n))return cb;for(i="",a=ah(n),c=0;c<a.length;c++)i+=Gd(a[c],ml);this.host=i}},cannotHaveUsernamePasswordPort:function(){return!this.host||this.cannotBeABaseURL||this.scheme=="file"},includesCredentials:function(){return this.username!=""||this.password!=""},isSpecial:function(){return XM(Jl,this.scheme)},shortenPath:function(){var n=this.path,i=n.length;!i||this.scheme=="file"&&i==1&&fR(n[0],!0)||n.length--},serialize:function(){var n=this,i=n.scheme,a=n.username,c=n.password,u=n.host,_=n.port,S=n.path,C=n.query,R=n.fragment,e=i+":";return u!==null?(e+="//",n.includesCredentials()&&(e+=a+(c?":"+c:"")+"@"),e+=v_(u),_!==null&&(e+=":"+_)):i=="file"&&(e+="//"),e+=n.cannotBeABaseURL?S[0]:S.length?"/"+sb(S,"/"):"",C!==null&&(e+="?"+C),R!==null&&(e+="#"+R),e},setHref:function(n){var i=this.parse(n);if(i)throw $M(i);this.searchParams.update()},getOrigin:function(){var n=this.scheme,i=this.port;if(n=="blob")try{return new Pp(n.path[0]).origin}catch{return"null"}return n!="file"&&this.isSpecial()?n+"://"+v_(this.host)+(i!==null?":"+i:""):"null"},getProtocol:function(){return this.scheme+":"},setProtocol:function(n){this.parse(_g(n)+":",sk)},getUsername:function(){return this.username},setUsername:function(n){var i=ah(_g(n));if(!this.cannotHaveUsernamePasswordPort()){this.username="";for(var a=0;a<i.length;a++)this.username+=Gd(i[a],uR)}},getPassword:function(){return this.password},setPassword:function(n){var i=ah(_g(n));if(!this.cannotHaveUsernamePasswordPort()){this.password="";for(var a=0;a<i.length;a++)this.password+=Gd(i[a],uR)}},getHost:function(){var n=this.host,i=this.port;return n===null?"":i===null?v_(n):v_(n)+":"+i},setHost:function(n){this.cannotBeABaseURL||this.parse(n,ub)},getHostname:function(){var n=this.host;return n===null?"":v_(n)},setHostname:function(n){this.cannotBeABaseURL||this.parse(n,ck)},getPort:function(){var n=this.port;return n===null?"":_g(n)},setPort:function(n){this.cannotHaveUsernamePasswordPort()||((n=_g(n))==""?this.port=null:this.parse(n,KO))},getPathname:function(){var n=this.path;return this.cannotBeABaseURL?n[0]:n.length?"/"+sb(n,"/"):""},setPathname:function(n){this.cannotBeABaseURL||(this.path=[],this.parse(n,fb))},getSearch:function(){var n=this.query;return n?"?"+n:""},setSearch:function(n){(n=_g(n))==""?this.query=null:(Hu(n,0)=="?"&&(n=dR(n,1)),this.query="",this.parse(n,yg)),this.searchParams.update()},getSearchParams:function(){return this.searchParams.facade},getHash:function(){var n=this.fragment;return n?"#"+n:""},setHash:function(n){(n=_g(n))!=""?(Hu(n,0)=="#"&&(n=dR(n,1)),this.fragment="",this.parse(n,Tg)):this.fragment=null},update:function(){this.query=this.searchParams.serialize()||null}};var Pp=function(n){var i=Yz(this,Uo),a=Xz(arguments.length,1)>1?arguments[1]:void 0,c=ZM(i,new lk(n,!1,a));qM||(i.href=c.serialize(),i.origin=c.getOrigin(),i.protocol=c.getProtocol(),i.username=c.getUsername(),i.password=c.getPassword(),i.host=c.getHost(),i.hostname=c.getHostname(),i.port=c.getPort(),i.pathname=c.getPathname(),i.search=c.getSearch(),i.searchParams=c.getSearchParams(),i.hash=c.getHash())},Uo=Pp.prototype,Ku=function(n,i){return{get:function(){return FO(this)[n]()},set:i&&function(a){return FO(this)[i](a)},configurable:!0,enumerable:!0}};if(qM&&(Gu(Uo,"href",Ku("serialize","setHref")),Gu(Uo,"origin",Ku("getOrigin")),Gu(Uo,"protocol",Ku("getProtocol","setProtocol")),Gu(Uo,"username",Ku("getUsername","setUsername")),Gu(Uo,"password",Ku("getPassword","setPassword")),Gu(Uo,"host",Ku("getHost","setHost")),Gu(Uo,"hostname",Ku("getHostname","setHostname")),Gu(Uo,"port",Ku("getPort","setPort")),Gu(Uo,"pathname",Ku("getPathname","setPathname")),Gu(Uo,"search",Ku("getSearch","setSearch")),Gu(Uo,"searchParams",Ku("getSearchParams")),Gu(Uo,"hash",Ku("getHash","setHash"))),ab(Uo,"toJSON",function(){return FO(this).serialize()},{enumerable:!0}),ab(Uo,"toString",function(){return FO(this).serialize()},{enumerable:!0}),lR){var qO=lR.createObjectURL,y_=lR.revokeObjectURL;qO&&ab(Pp,"createObjectURL",wV(qO,lR)),y_&&ab(Pp,"revokeObjectURL",wV(y_,lR))}Jz(Pp,"URL"),Wz({global:!0,forced:!CV,sham:!qM},{URL:Pp});var BV=br,FV=I,iH=$0,JO=nc,aH=mg,GV=Tr("URL");BV({target:"URL",stat:!0,forced:!(aH&&FV(function(){GV.canParse()}))},{canParse:function(n){var i=iH(arguments.length,1),a=JO(n),c=i<2||arguments[1]===void 0?void 0:JO(arguments[1]);try{return!!new GV(a,c)}catch{return!1}}});var XO=T(Sn.URL);let dk=!0,zV=!0;function QO(n,i,a){let c=n.match(i);return c&&c.length>=a&&parseInt(c[a],10)}function aS(n,i,a){if(!n.RTCPeerConnection)return;let c=n.RTCPeerConnection.prototype,u=c.addEventListener;c.addEventListener=function(S,C){if(S!==i)return u.apply(this,arguments);let R=e=>{let t=a(e);t&&(C.handleEvent?C.handleEvent(t):C(t))};return this._eventMap=this._eventMap||{},this._eventMap[i]||(this._eventMap[i]=new Map),this._eventMap[i].set(C,R),u.apply(this,[S,R])};let _=c.removeEventListener;c.removeEventListener=function(S,C){if(S!==i||!this._eventMap||!this._eventMap[i])return _.apply(this,arguments);if(!this._eventMap[i].has(C))return _.apply(this,arguments);let R=this._eventMap[i].get(C);return this._eventMap[i].delete(C),this._eventMap[i].size===0&&delete this._eventMap[i],Object.keys(this._eventMap).length===0&&delete this._eventMap,_.apply(this,[S,R])},Object.defineProperty(c,"on"+i,{get(){return this["_on"+i]},set(S){this["_on"+i]&&(this.removeEventListener(i,this["_on"+i]),delete this["_on"+i]),S&&this.addEventListener(i,this["_on"+i]=S)},enumerable:!0,configurable:!0})}function sH(n){return typeof n!="boolean"?new Error("Argument type: "+typeof n+". Please use a boolean."):(dk=n,n?"adapter.js logging disabled":"adapter.js logging enabled")}function oH(n){return typeof n!="boolean"?new Error("Argument type: "+typeof n+". Please use a boolean."):(zV=!n,"adapter.js deprecation warnings "+(n?"disabled":"enabled"))}function hb(){if(typeof window=="object"){if(dk)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function pb(n,i){zV&&console.warn(n+" is deprecated, please use "+i+" instead.")}function uk(n){return Object.prototype.toString.call(n)==="[object Object]"}function fk(n){var i;return uk(n)?Ds(i=Object.keys(n)).call(i,function(a,c){let u=uk(n[c]),_=u?fk(n[c]):n[c],S=u&&!Object.keys(_).length;return _===void 0||S?a:Object.assign(a,{[c]:_})},{}):n}function hR(n,i,a){i&&!a.has(i.id)&&(a.set(i.id,i),Object.keys(i).forEach(c=>{c.endsWith("Id")?hR(n,n.get(i[c]),a):c.endsWith("Ids")&&i[c].forEach(u=>{hR(n,n.get(u),a)})}))}function bg(n,i,a){let c=a?"outbound-rtp":"inbound-rtp",u=new Map;if(i===null)return u;let _=[];return n.forEach(S=>{S.type==="track"&&S.trackIdentifier===i.id&&_.push(S)}),_.forEach(S=>{n.forEach(C=>{C.type===c&&C.trackId===S.id&&hR(n,C,u)})}),u}let pR=hb;function mb(n,i){let a=n&&n.navigator;if(!a.mediaDevices)return;let c=function(S){if(typeof S!="object"||S.mandatory||S.optional)return S;let C={};return Object.keys(S).forEach(R=>{if(R==="require"||R==="advanced"||R==="mediaSource")return;let e=typeof S[R]=="object"?S[R]:{ideal:S[R]};e.exact!==void 0&&typeof e.exact=="number"&&(e.min=e.max=e.exact);let t=function(r,s){return r?r+s.charAt(0).toUpperCase()+s.slice(1):s==="deviceId"?"sourceId":s};if(e.ideal!==void 0){C.optional=C.optional||[];let r={};typeof e.ideal=="number"?(r[t("min",R)]=e.ideal,C.optional.push(r),r={},r[t("max",R)]=e.ideal,C.optional.push(r)):(r[t("",R)]=e.ideal,C.optional.push(r))}e.exact!==void 0&&typeof e.exact!="number"?(C.mandatory=C.mandatory||{},C.mandatory[t("",R)]=e.exact):["min","max"].forEach(r=>{e[r]!==void 0&&(C.mandatory=C.mandatory||{},C.mandatory[t(r,R)]=e[r])})}),S.advanced&&(C.optional=(C.optional||[]).concat(S.advanced)),C},u=function(S,C){if(i.version>=61)return C(S);if((S=JSON.parse(JSON.stringify(S)))&&typeof S.audio=="object"){let R=function(e,t,r){t in e&&!(r in e)&&(e[r]=e[t],delete e[t])};R((S=JSON.parse(JSON.stringify(S))).audio,"autoGainControl","googAutoGainControl"),R(S.audio,"noiseSuppression","googNoiseSuppression"),S.audio=c(S.audio)}if(S&&typeof S.video=="object"){let R=S.video.facingMode;R=R&&(typeof R=="object"?R:{ideal:R});let e=i.version<66;if(R&&(R.exact==="user"||R.exact==="environment"||R.ideal==="user"||R.ideal==="environment")&&(!a.mediaDevices.getSupportedConstraints||!a.mediaDevices.getSupportedConstraints().facingMode||e)){let t;if(delete S.video.facingMode,R.exact==="environment"||R.ideal==="environment"?t=["back","rear"]:R.exact!=="user"&&R.ideal!=="user"||(t=["front"]),t)return a.mediaDevices.enumerateDevices().then(r=>{let s=(r=r.filter(l=>l.kind==="videoinput")).find(l=>t.some(f=>{var m;return ft(m=l.label.toLowerCase()).call(m,f)}));return!s&&r.length&&ft(t).call(t,"back")&&(s=r[r.length-1]),s&&(S.video.deviceId=R.exact?{exact:s.deviceId}:{ideal:s.deviceId}),S.video=c(S.video),pR("chrome: "+JSON.stringify(S)),C(S)})}S.video=c(S.video)}return pR("chrome: "+JSON.stringify(S)),C(S)},_=function(S){return i.version>=64?S:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[S.name]||S.name,message:S.message,constraint:S.constraint||S.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}};if(a.getUserMedia=(function(S,C,R){u(S,e=>{a.webkitGetUserMedia(e,C,t=>{R&&R(_(t))})})}).bind(a),a.mediaDevices.getUserMedia){let S=a.mediaDevices.getUserMedia.bind(a.mediaDevices);a.mediaDevices.getUserMedia=function(C){return u(C,R=>S(R).then(e=>{if(R.audio&&!e.getAudioTracks().length||R.video&&!e.getVideoTracks().length)throw e.getTracks().forEach(t=>{t.stop()}),new DOMException("","NotFoundError");return e},e=>Et.reject(_(e))))}}}function hk(n){n.MediaStream=n.MediaStream||n.webkitMediaStream}function HV(n){if(typeof n=="object"&&n.RTCPeerConnection&&!("ontrack"in n.RTCPeerConnection.prototype)){Object.defineProperty(n.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(a){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=a)},enumerable:!0,configurable:!0});let i=n.RTCPeerConnection.prototype.setRemoteDescription;n.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=a=>{a.stream.addEventListener("addtrack",c=>{let u;u=n.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(S=>S.track&&S.track.id===c.track.id):{track:c.track};let _=new Event("track");_.track=c.track,_.receiver=u,_.transceiver={receiver:u},_.streams=[a.stream],this.dispatchEvent(_)}),a.stream.getTracks().forEach(c=>{let u;u=n.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(S=>S.track&&S.track.id===c.id):{track:c};let _=new Event("track");_.track=c,_.receiver=u,_.transceiver={receiver:u},_.streams=[a.stream],this.dispatchEvent(_)})},this.addEventListener("addstream",this._ontrackpoly)),i.apply(this,arguments)}}else aS(n,"track",i=>(i.transceiver||Object.defineProperty(i,"transceiver",{value:{receiver:i.receiver}}),i))}function ZO(n){if(typeof n=="object"&&n.RTCPeerConnection&&!("getSenders"in n.RTCPeerConnection.prototype)&&"createDTMFSender"in n.RTCPeerConnection.prototype){let i=function(u,_){return{track:_,get dtmf(){return this._dtmf===void 0&&(_.kind==="audio"?this._dtmf=u.createDTMFSender(_):this._dtmf=null),this._dtmf},_pc:u}};if(!n.RTCPeerConnection.prototype.getSenders){n.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};let u=n.RTCPeerConnection.prototype.addTrack;n.RTCPeerConnection.prototype.addTrack=function(S,C){let R=u.apply(this,arguments);return R||(R=i(this,S),this._senders.push(R)),R};let _=n.RTCPeerConnection.prototype.removeTrack;n.RTCPeerConnection.prototype.removeTrack=function(S){_.apply(this,arguments);let C=this._senders.indexOf(S);C!==-1&&this._senders.splice(C,1)}}let a=n.RTCPeerConnection.prototype.addStream;n.RTCPeerConnection.prototype.addStream=function(u){this._senders=this._senders||[],a.apply(this,[u]),u.getTracks().forEach(_=>{this._senders.push(i(this,_))})};let c=n.RTCPeerConnection.prototype.removeStream;n.RTCPeerConnection.prototype.removeStream=function(u){this._senders=this._senders||[],c.apply(this,[u]),u.getTracks().forEach(_=>{let S=this._senders.find(C=>C.track===_);S&&this._senders.splice(this._senders.indexOf(S),1)})}}else if(typeof n=="object"&&n.RTCPeerConnection&&"getSenders"in n.RTCPeerConnection.prototype&&"createDTMFSender"in n.RTCPeerConnection.prototype&&n.RTCRtpSender&&!("dtmf"in n.RTCRtpSender.prototype)){let i=n.RTCPeerConnection.prototype.getSenders;n.RTCPeerConnection.prototype.getSenders=function(){let a=i.apply(this,[]);return a.forEach(c=>c._pc=this),a},Object.defineProperty(n.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function pk(n){if(!n.RTCPeerConnection)return;let i=n.RTCPeerConnection.prototype.getStats;n.RTCPeerConnection.prototype.getStats=function(){let[a,c,u]=arguments;if(arguments.length>0&&typeof a=="function")return i.apply(this,arguments);if(i.length===0&&(arguments.length===0||typeof a!="function"))return i.apply(this,[]);let _=function(C){let R={};return C.result().forEach(e=>{let t={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};e.names().forEach(r=>{t[r]=e.stat(r)}),R[t.id]=t}),R},S=function(C){return new Map(Object.keys(C).map(R=>[R,C[R]]))};if(arguments.length>=2){let C=function(R){c(S(_(R)))};return i.apply(this,[C,a])}return new Et((C,R)=>{i.apply(this,[function(e){C(S(_(e)))},R])}).then(c,u)}}function $O(n){if(!(typeof n=="object"&&n.RTCPeerConnection&&n.RTCRtpSender&&n.RTCRtpReceiver))return;if(!("getStats"in n.RTCRtpSender.prototype)){let a=n.RTCPeerConnection.prototype.getSenders;a&&(n.RTCPeerConnection.prototype.getSenders=function(){let u=a.apply(this,[]);return u.forEach(_=>_._pc=this),u});let c=n.RTCPeerConnection.prototype.addTrack;c&&(n.RTCPeerConnection.prototype.addTrack=function(){let u=c.apply(this,arguments);return u._pc=this,u}),n.RTCRtpSender.prototype.getStats=function(){let u=this;return this._pc.getStats().then(_=>bg(_,u.track,!0))}}if(!("getStats"in n.RTCRtpReceiver.prototype)){let a=n.RTCPeerConnection.prototype.getReceivers;a&&(n.RTCPeerConnection.prototype.getReceivers=function(){let c=a.apply(this,[]);return c.forEach(u=>u._pc=this),c}),aS(n,"track",c=>(c.receiver._pc=c.srcElement,c)),n.RTCRtpReceiver.prototype.getStats=function(){let c=this;return this._pc.getStats().then(u=>bg(u,c.track,!1))}}if(!("getStats"in n.RTCRtpSender.prototype)||!("getStats"in n.RTCRtpReceiver.prototype))return;let i=n.RTCPeerConnection.prototype.getStats;n.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof n.MediaStreamTrack){let a=arguments[0],c,u,_;return this.getSenders().forEach(S=>{S.track===a&&(c?_=!0:c=S)}),this.getReceivers().forEach(S=>(S.track===a&&(u?_=!0:u=S),S.track===a)),_||c&&u?Et.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):c?c.getStats():u?u.getStats():Et.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return i.apply(this,arguments)}}function mk(n){n.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(_=>this._shimmedLocalStreams[_][0])};let i=n.RTCPeerConnection.prototype.addTrack;n.RTCPeerConnection.prototype.addTrack=function(_,S){if(!S)return i.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};let C=i.apply(this,arguments);return this._shimmedLocalStreams[S.id]?this._shimmedLocalStreams[S.id].indexOf(C)===-1&&this._shimmedLocalStreams[S.id].push(C):this._shimmedLocalStreams[S.id]=[S,C],C};let a=n.RTCPeerConnection.prototype.addStream;n.RTCPeerConnection.prototype.addStream=function(_){this._shimmedLocalStreams=this._shimmedLocalStreams||{},_.getTracks().forEach(R=>{if(this.getSenders().find(e=>e.track===R))throw new DOMException("Track already exists.","InvalidAccessError")});let S=this.getSenders();a.apply(this,arguments);let C=this.getSenders().filter(R=>S.indexOf(R)===-1);this._shimmedLocalStreams[_.id]=[_].concat(C)};let c=n.RTCPeerConnection.prototype.removeStream;n.RTCPeerConnection.prototype.removeStream=function(_){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[_.id],c.apply(this,arguments)};let u=n.RTCPeerConnection.prototype.removeTrack;n.RTCPeerConnection.prototype.removeTrack=function(_){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},_&&Object.keys(this._shimmedLocalStreams).forEach(S=>{let C=this._shimmedLocalStreams[S].indexOf(_);C!==-1&&this._shimmedLocalStreams[S].splice(C,1),this._shimmedLocalStreams[S].length===1&&delete this._shimmedLocalStreams[S]}),u.apply(this,arguments)}}function gk(n,i){if(!n.RTCPeerConnection)return;if(n.RTCPeerConnection.prototype.addTrack&&i.version>=65)return mk(n);let a=n.RTCPeerConnection.prototype.getLocalStreams;n.RTCPeerConnection.prototype.getLocalStreams=function(){let R=a.apply(this);return this._reverseStreams=this._reverseStreams||{},R.map(e=>this._reverseStreams[e.id])};let c=n.RTCPeerConnection.prototype.addStream;n.RTCPeerConnection.prototype.addStream=function(R){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},R.getTracks().forEach(e=>{if(this.getSenders().find(t=>t.track===e))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[R.id]){let e=new n.MediaStream(R.getTracks());this._streams[R.id]=e,this._reverseStreams[e.id]=R,R=e}c.apply(this,[R])};let u=n.RTCPeerConnection.prototype.removeStream;function _(R,e){let t=e.sdp;return Object.keys(R._reverseStreams||[]).forEach(r=>{let s=R._reverseStreams[r],l=R._streams[s.id];t=t.replace(new RegExp(l.id,"g"),s.id)}),new RTCSessionDescription({type:e.type,sdp:t})}n.RTCPeerConnection.prototype.removeStream=function(R){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},u.apply(this,[this._streams[R.id]||R]),delete this._reverseStreams[this._streams[R.id]?this._streams[R.id].id:R.id],delete this._streams[R.id]},n.RTCPeerConnection.prototype.addTrack=function(R,e){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");let t=[].slice.call(arguments,1);if(t.length!==1||!t[0].getTracks().find(s=>s===R))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(s=>s.track===R))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};let r=this._streams[e.id];if(r)r.addTrack(R),Et.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{let s=new n.MediaStream([R]);this._streams[e.id]=s,this._reverseStreams[s.id]=e,this.addStream(s)}return this.getSenders().find(s=>s.track===R)},["createOffer","createAnswer"].forEach(function(R){let e=n.RTCPeerConnection.prototype[R],t={[R](){let r=arguments;return arguments.length&&typeof arguments[0]=="function"?e.apply(this,[s=>{let l=_(this,s);r[0].apply(null,[l])},s=>{r[1]&&r[1].apply(null,s)},arguments[2]]):e.apply(this,arguments).then(s=>_(this,s))}};n.RTCPeerConnection.prototype[R]=t[R]});let S=n.RTCPeerConnection.prototype.setLocalDescription;n.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=function(R,e){let t=e.sdp;return Object.keys(R._reverseStreams||[]).forEach(r=>{let s=R._reverseStreams[r],l=R._streams[s.id];t=t.replace(new RegExp(s.id,"g"),l.id)}),new RTCSessionDescription({type:e.type,sdp:t})}(this,arguments[0]),S.apply(this,arguments)):S.apply(this,arguments)};let C=Object.getOwnPropertyDescriptor(n.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(n.RTCPeerConnection.prototype,"localDescription",{get(){let R=C.get.apply(this);return R.type===""?R:_(this,R)}}),n.RTCPeerConnection.prototype.removeTrack=function(R){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!R._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(R._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");let e;this._streams=this._streams||{},Object.keys(this._streams).forEach(t=>{this._streams[t].getTracks().find(r=>R.track===r)&&(e=this._streams[t])}),e&&(e.getTracks().length===1?this.removeStream(this._reverseStreams[e.id]):e.removeTrack(R.track),this.dispatchEvent(new Event("negotiationneeded")))}}function mR(n,i){!n.RTCPeerConnection&&n.webkitRTCPeerConnection&&(n.RTCPeerConnection=n.webkitRTCPeerConnection),n.RTCPeerConnection&&i.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(a){let c=n.RTCPeerConnection.prototype[a],u={[a](){return arguments[0]=new(a==="addIceCandidate"?n.RTCIceCandidate:n.RTCSessionDescription)(arguments[0]),c.apply(this,arguments)}};n.RTCPeerConnection.prototype[a]=u[a]})}function _k(n,i){aS(n,"negotiationneeded",a=>{let c=a.target;if(!(i.version<72||c.getConfiguration&&c.getConfiguration().sdpSemantics==="plan-b")||c.signalingState==="stable")return a})}var Ek=Object.freeze({__proto__:null,fixNegotiationNeeded:_k,shimAddTrackRemoveTrack:gk,shimAddTrackRemoveTrackWithNative:mk,shimGetDisplayMedia:function(n,i){n.navigator.mediaDevices&&"getDisplayMedia"in n.navigator.mediaDevices||n.navigator.mediaDevices&&(typeof i=="function"?n.navigator.mediaDevices.getDisplayMedia=function(a){return i(a).then(c=>{let u=a.video&&a.video.width,_=a.video&&a.video.height,S=a.video&&a.video.frameRate;return a.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:c,maxFrameRate:S||3}},u&&(a.video.mandatory.maxWidth=u),_&&(a.video.mandatory.maxHeight=_),n.navigator.mediaDevices.getUserMedia(a)})}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))},shimGetSendersWithDtmf:ZO,shimGetStats:pk,shimGetUserMedia:mb,shimMediaStream:hk,shimOnTrack:HV,shimPeerConnection:mR,shimSenderReceiverGetStats:$O});function gR(n,i){let a=n&&n.navigator,c=n&&n.MediaStreamTrack;if(a.getUserMedia=function(u,_,S){pb("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),a.mediaDevices.getUserMedia(u).then(_,S)},!(i.version>55&&"autoGainControl"in a.mediaDevices.getSupportedConstraints())){let u=function(S,C,R){C in S&&!(R in S)&&(S[R]=S[C],delete S[C])},_=a.mediaDevices.getUserMedia.bind(a.mediaDevices);if(a.mediaDevices.getUserMedia=function(S){return typeof S=="object"&&typeof S.audio=="object"&&(S=JSON.parse(JSON.stringify(S)),u(S.audio,"autoGainControl","mozAutoGainControl"),u(S.audio,"noiseSuppression","mozNoiseSuppression")),_(S)},c&&c.prototype.getSettings){let S=c.prototype.getSettings;c.prototype.getSettings=function(){let C=S.apply(this,arguments);return u(C,"mozAutoGainControl","autoGainControl"),u(C,"mozNoiseSuppression","noiseSuppression"),C}}if(c&&c.prototype.applyConstraints){let S=c.prototype.applyConstraints;c.prototype.applyConstraints=function(C){return this.kind==="audio"&&typeof C=="object"&&(C=JSON.parse(JSON.stringify(C)),u(C,"autoGainControl","mozAutoGainControl"),u(C,"noiseSuppression","mozNoiseSuppression")),S.apply(this,[C])}}}}function _R(n){typeof n=="object"&&n.RTCTrackEvent&&"receiver"in n.RTCTrackEvent.prototype&&!("transceiver"in n.RTCTrackEvent.prototype)&&Object.defineProperty(n.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function ER(n,i){if(typeof n!="object"||!n.RTCPeerConnection&&!n.mozRTCPeerConnection)return;!n.RTCPeerConnection&&n.mozRTCPeerConnection&&(n.RTCPeerConnection=n.mozRTCPeerConnection),i.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(u){let _=n.RTCPeerConnection.prototype[u],S={[u](){return arguments[0]=new(u==="addIceCandidate"?n.RTCIceCandidate:n.RTCSessionDescription)(arguments[0]),_.apply(this,arguments)}};n.RTCPeerConnection.prototype[u]=S[u]});let a={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},c=n.RTCPeerConnection.prototype.getStats;n.RTCPeerConnection.prototype.getStats=function(){let[u,_,S]=arguments;return c.apply(this,[u||null]).then(C=>{if(i.version<53&&!_)try{C.forEach(R=>{R.type=a[R.type]||R.type})}catch(R){if(R.name!=="TypeError")throw R;C.forEach((e,t)=>{C.set(t,Object.assign({},e,{type:a[e.type]||e.type}))})}return C}).then(_,S)}}function eN(n){if(typeof n!="object"||!n.RTCPeerConnection||!n.RTCRtpSender||n.RTCRtpSender&&"getStats"in n.RTCRtpSender.prototype)return;let i=n.RTCPeerConnection.prototype.getSenders;i&&(n.RTCPeerConnection.prototype.getSenders=function(){let c=i.apply(this,[]);return c.forEach(u=>u._pc=this),c});let a=n.RTCPeerConnection.prototype.addTrack;a&&(n.RTCPeerConnection.prototype.addTrack=function(){let c=a.apply(this,arguments);return c._pc=this,c}),n.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Et.resolve(new Map)}}function tN(n){if(typeof n!="object"||!n.RTCPeerConnection||!n.RTCRtpSender||n.RTCRtpSender&&"getStats"in n.RTCRtpReceiver.prototype)return;let i=n.RTCPeerConnection.prototype.getReceivers;i&&(n.RTCPeerConnection.prototype.getReceivers=function(){let a=i.apply(this,[]);return a.forEach(c=>c._pc=this),a}),aS(n,"track",a=>(a.receiver._pc=a.srcElement,a)),n.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function nN(n){n.RTCPeerConnection&&!("removeStream"in n.RTCPeerConnection.prototype)&&(n.RTCPeerConnection.prototype.removeStream=function(i){pb("removeStream","removeTrack"),this.getSenders().forEach(a=>{var c;a.track&&ft(c=i.getTracks()).call(c,a.track)&&this.removeTrack(a)})})}function vk(n){n.DataChannel&&!n.RTCDataChannel&&(n.RTCDataChannel=n.DataChannel)}function rN(n){if(typeof n!="object"||!n.RTCPeerConnection)return;let i=n.RTCPeerConnection.prototype.addTransceiver;i&&(n.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let a=arguments[1]&&arguments[1].sendEncodings;a===void 0&&(a=[]),a=[...a];let c=a.length>0;c&&a.forEach(_=>{if("rid"in _&&!/^[a-z0-9]{0,16}$/i.test(_.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in _&&!(parseFloat(_.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in _&&!(parseFloat(_.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});let u=i.apply(this,arguments);if(c){let{sender:_}=u,S=_.getParameters();(!("encodings"in S)||S.encodings.length===1&&Object.keys(S.encodings[0]).length===0)&&(S.encodings=a,_.sendEncodings=a,this.setParametersPromises.push(_.setParameters(S).then(()=>{delete _.sendEncodings}).catch(()=>{delete _.sendEncodings})))}return u})}function sS(n){if(typeof n!="object"||!n.RTCRtpSender)return;let i=n.RTCRtpSender.prototype.getParameters;i&&(n.RTCRtpSender.prototype.getParameters=function(){let a=i.apply(this,arguments);return"encodings"in a||(a.encodings=[].concat(this.sendEncodings||[{}])),a})}function oh(n){if(typeof n!="object"||!n.RTCPeerConnection)return;let i=n.RTCPeerConnection.prototype.createOffer;n.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Et.all(this.setParametersPromises).then(()=>i.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):i.apply(this,arguments)}}function Sk(n){if(typeof n!="object"||!n.RTCPeerConnection)return;let i=n.RTCPeerConnection.prototype.createAnswer;n.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Et.all(this.setParametersPromises).then(()=>i.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):i.apply(this,arguments)}}var T_=Object.freeze({__proto__:null,shimAddTransceiver:rN,shimCreateAnswer:Sk,shimCreateOffer:oh,shimGetDisplayMedia:function(n,i){n.navigator.mediaDevices&&"getDisplayMedia"in n.navigator.mediaDevices||n.navigator.mediaDevices&&(n.navigator.mediaDevices.getDisplayMedia=function(a){if(!a||!a.video){let c=new DOMException("getDisplayMedia without video constraints is undefined");return c.name="NotFoundError",c.code=8,Et.reject(c)}return a.video===!0?a.video={mediaSource:i}:a.video.mediaSource=i,n.navigator.mediaDevices.getUserMedia(a)})},shimGetParameters:sS,shimGetUserMedia:gR,shimOnTrack:_R,shimPeerConnection:ER,shimRTCDataChannel:vk,shimReceiverGetStats:tN,shimRemoveStream:nN,shimSenderGetStats:eN});function Mp(n){if(typeof n=="object"&&n.RTCPeerConnection){if("getLocalStreams"in n.RTCPeerConnection.prototype||(n.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in n.RTCPeerConnection.prototype)){let i=n.RTCPeerConnection.prototype.addTrack;n.RTCPeerConnection.prototype.addStream=function(a){var c;this._localStreams||(this._localStreams=[]),ft(c=this._localStreams).call(c,a)||this._localStreams.push(a),a.getAudioTracks().forEach(u=>i.call(this,u,a)),a.getVideoTracks().forEach(u=>i.call(this,u,a))},n.RTCPeerConnection.prototype.addTrack=function(a){for(var c=arguments.length,u=new Array(c>1?c-1:0),_=1;_<c;_++)u[_-1]=arguments[_];return u&&u.forEach(S=>{var C;this._localStreams?ft(C=this._localStreams).call(C,S)||this._localStreams.push(S):this._localStreams=[S]}),i.apply(this,arguments)}}"removeStream"in n.RTCPeerConnection.prototype||(n.RTCPeerConnection.prototype.removeStream=function(i){this._localStreams||(this._localStreams=[]);let a=this._localStreams.indexOf(i);if(a===-1)return;this._localStreams.splice(a,1);let c=i.getTracks();this.getSenders().forEach(u=>{ft(c).call(c,u.track)&&this.removeTrack(u)})})}}function iN(n){if(typeof n=="object"&&n.RTCPeerConnection&&("getRemoteStreams"in n.RTCPeerConnection.prototype||(n.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in n.RTCPeerConnection.prototype))){Object.defineProperty(n.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(a){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=a),this.addEventListener("track",this._onaddstreampoly=c=>{c.streams.forEach(u=>{var _;if(this._remoteStreams||(this._remoteStreams=[]),ft(_=this._remoteStreams).call(_,u))return;this._remoteStreams.push(u);let S=new Event("addstream");S.stream=u,this.dispatchEvent(S)})})}});let i=n.RTCPeerConnection.prototype.setRemoteDescription;n.RTCPeerConnection.prototype.setRemoteDescription=function(){let a=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(c){c.streams.forEach(u=>{if(a._remoteStreams||(a._remoteStreams=[]),a._remoteStreams.indexOf(u)>=0)return;a._remoteStreams.push(u);let _=new Event("addstream");_.stream=u,a.dispatchEvent(_)})}),i.apply(a,arguments)}}}function oS(n){if(typeof n!="object"||!n.RTCPeerConnection)return;let i=n.RTCPeerConnection.prototype,a=i.createOffer,c=i.createAnswer,u=i.setLocalDescription,_=i.setRemoteDescription,S=i.addIceCandidate;i.createOffer=function(R,e){let t=arguments.length>=2?arguments[2]:arguments[0],r=a.apply(this,[t]);return e?(r.then(R,e),Et.resolve()):r},i.createAnswer=function(R,e){let t=arguments.length>=2?arguments[2]:arguments[0],r=c.apply(this,[t]);return e?(r.then(R,e),Et.resolve()):r};let C=function(R,e,t){let r=u.apply(this,[R]);return t?(r.then(e,t),Et.resolve()):r};i.setLocalDescription=C,C=function(R,e,t){let r=_.apply(this,[R]);return t?(r.then(e,t),Et.resolve()):r},i.setRemoteDescription=C,C=function(R,e,t){let r=S.apply(this,[R]);return t?(r.then(e,t),Et.resolve()):r},i.addIceCandidate=C}function kc(n){let i=n&&n.navigator;if(i.mediaDevices&&i.mediaDevices.getUserMedia){let a=i.mediaDevices,c=a.getUserMedia.bind(a);i.mediaDevices.getUserMedia=u=>c(zd(u))}!i.getUserMedia&&i.mediaDevices&&i.mediaDevices.getUserMedia&&(i.getUserMedia=(function(a,c,u){i.mediaDevices.getUserMedia(a).then(c,u)}).bind(i))}function zd(n){return n&&n.video!==void 0?Object.assign({},n,{video:fk(n.video)}):n}function yk(n){if(!n.RTCPeerConnection)return;let i=n.RTCPeerConnection;n.RTCPeerConnection=function(a,c){if(a&&a.iceServers){let u=[];for(let _=0;_<a.iceServers.length;_++){let S=a.iceServers[_];!S.hasOwnProperty("urls")&&S.hasOwnProperty("url")?(pb("RTCIceServer.url","RTCIceServer.urls"),S=JSON.parse(JSON.stringify(S)),S.urls=S.url,delete S.url,u.push(S)):u.push(a.iceServers[_])}a.iceServers=u}return new i(a,c)},n.RTCPeerConnection.prototype=i.prototype,"generateCertificate"in i&&Object.defineProperty(n.RTCPeerConnection,"generateCertificate",{get:()=>i.generateCertificate})}function Tk(n){typeof n=="object"&&n.RTCTrackEvent&&"receiver"in n.RTCTrackEvent.prototype&&!("transceiver"in n.RTCTrackEvent.prototype)&&Object.defineProperty(n.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function WV(n){let i=n.RTCPeerConnection.prototype.createOffer;n.RTCPeerConnection.prototype.createOffer=function(a){if(a){a.offerToReceiveAudio!==void 0&&(a.offerToReceiveAudio=!!a.offerToReceiveAudio);let c=this.getTransceivers().find(_=>_.receiver.track.kind==="audio");a.offerToReceiveAudio===!1&&c?c.direction==="sendrecv"?c.setDirection?c.setDirection("sendonly"):c.direction="sendonly":c.direction==="recvonly"&&(c.setDirection?c.setDirection("inactive"):c.direction="inactive"):a.offerToReceiveAudio!==!0||c||this.addTransceiver("audio",{direction:"recvonly"}),a.offerToReceiveVideo!==void 0&&(a.offerToReceiveVideo=!!a.offerToReceiveVideo);let u=this.getTransceivers().find(_=>_.receiver.track.kind==="video");a.offerToReceiveVideo===!1&&u?u.direction==="sendrecv"?u.setDirection?u.setDirection("sendonly"):u.direction="sendonly":u.direction==="recvonly"&&(u.setDirection?u.setDirection("inactive"):u.direction="inactive"):a.offerToReceiveVideo!==!0||u||this.addTransceiver("video",{direction:"recvonly"})}return i.apply(this,arguments)}}function bk(n){typeof n!="object"||n.AudioContext||(n.AudioContext=n.webkitAudioContext)}var YV=Object.freeze({__proto__:null,shimAudioContext:bk,shimCallbacksAPI:oS,shimConstraints:zd,shimCreateOfferLegacy:WV,shimGetUserMedia:kc,shimLocalStreamsAPI:Mp,shimRTCIceServerUrls:yk,shimRemoteStreamsAPI:iN,shimTrackEventTransceiver:Tk}),Ck=`	
\v\f\r \u2028\u2029\uFEFF`,cH=oi,wk=nc,Rk=Ck,KV=K("".replace),lH=RegExp("^["+Rk+"]+"),dH=RegExp("(^|[^"+Rk+"])["+Rk+"]+$"),qV=function(n){return function(i){var a=wk(cH(i));return a=KV(a,lH,""),a=KV(a,dH,"$1"),a}},uH={trim:qV()},fH=lp.PROPER,aN=I,Ik=Ck,JV=uH.trim;br({target:"String",proto:!0,forced:function(n){return aN(function(){return!!Ik[n]()||""[n]()!==""||fH&&Ik[n].name!==n})}("trim")},{trim:function(){return JV(this)}});var sN=tc("String").trim,cS=Q,hH=sN,Ak=String.prototype,XV=function(n){var i=n.trim;return typeof n=="string"||n===Ak||cS(Ak,n)&&i===Ak.trim?hH:i},js=T(XV),Ok={exports:{}};(function(n){let i={generateIdentifier:function(){return Math.random().toString(36).substring(2,12)}};i.localCName=i.generateIdentifier(),i.splitLines=function(a){return a.trim().split(`
`).map(c=>c.trim())},i.splitSections=function(a){return a.split(`
m=`).map((c,u)=>(u>0?"m="+c:c).trim()+`\r
`)},i.getDescription=function(a){let c=i.splitSections(a);return c&&c[0]},i.getMediaSections=function(a){let c=i.splitSections(a);return c.shift(),c},i.matchPrefix=function(a,c){return i.splitLines(a).filter(u=>u.indexOf(c)===0)},i.parseCandidate=function(a){let c;c=a.indexOf("a=candidate:")===0?a.substring(12).split(" "):a.substring(10).split(" ");let u={foundation:c[0],component:{1:"rtp",2:"rtcp"}[c[1]]||c[1],protocol:c[2].toLowerCase(),priority:parseInt(c[3],10),ip:c[4],address:c[4],port:parseInt(c[5],10),type:c[7]};for(let _=8;_<c.length;_+=2)switch(c[_]){case"raddr":u.relatedAddress=c[_+1];break;case"rport":u.relatedPort=parseInt(c[_+1],10);break;case"tcptype":u.tcpType=c[_+1];break;case"ufrag":u.ufrag=c[_+1],u.usernameFragment=c[_+1];break;default:u[c[_]]===void 0&&(u[c[_]]=c[_+1])}return u},i.writeCandidate=function(a){let c=[];c.push(a.foundation);let u=a.component;u==="rtp"?c.push(1):u==="rtcp"?c.push(2):c.push(u),c.push(a.protocol.toUpperCase()),c.push(a.priority),c.push(a.address||a.ip),c.push(a.port);let _=a.type;return c.push("typ"),c.push(_),_!=="host"&&a.relatedAddress&&a.relatedPort&&(c.push("raddr"),c.push(a.relatedAddress),c.push("rport"),c.push(a.relatedPort)),a.tcpType&&a.protocol.toLowerCase()==="tcp"&&(c.push("tcptype"),c.push(a.tcpType)),(a.usernameFragment||a.ufrag)&&(c.push("ufrag"),c.push(a.usernameFragment||a.ufrag)),"candidate:"+c.join(" ")},i.parseIceOptions=function(a){return a.substring(14).split(" ")},i.parseRtpMap=function(a){let c=a.substring(9).split(" "),u={payloadType:parseInt(c.shift(),10)};return c=c[0].split("/"),u.name=c[0],u.clockRate=parseInt(c[1],10),u.channels=c.length===3?parseInt(c[2],10):1,u.numChannels=u.channels,u},i.writeRtpMap=function(a){let c=a.payloadType;a.preferredPayloadType!==void 0&&(c=a.preferredPayloadType);let u=a.channels||a.numChannels||1;return"a=rtpmap:"+c+" "+a.name+"/"+a.clockRate+(u!==1?"/"+u:"")+`\r
`},i.parseExtmap=function(a){let c=a.substring(9).split(" ");return{id:parseInt(c[0],10),direction:c[0].indexOf("/")>0?c[0].split("/")[1]:"sendrecv",uri:c[1],attributes:c.slice(2).join(" ")}},i.writeExtmap=function(a){return"a=extmap:"+(a.id||a.preferredId)+(a.direction&&a.direction!=="sendrecv"?"/"+a.direction:"")+" "+a.uri+(a.attributes?" "+a.attributes:"")+`\r
`},i.parseFmtp=function(a){let c={},u,_=a.substring(a.indexOf(" ")+1).split(";");for(let S=0;S<_.length;S++)u=_[S].trim().split("="),c[u[0].trim()]=u[1];return c},i.writeFmtp=function(a){let c="",u=a.payloadType;if(a.preferredPayloadType!==void 0&&(u=a.preferredPayloadType),a.parameters&&Object.keys(a.parameters).length){let _=[];Object.keys(a.parameters).forEach(S=>{a.parameters[S]!==void 0?_.push(S+"="+a.parameters[S]):_.push(S)}),c+="a=fmtp:"+u+" "+_.join(";")+`\r
`}return c},i.parseRtcpFb=function(a){let c=a.substring(a.indexOf(" ")+1).split(" ");return{type:c.shift(),parameter:c.join(" ")}},i.writeRtcpFb=function(a){let c="",u=a.payloadType;return a.preferredPayloadType!==void 0&&(u=a.preferredPayloadType),a.rtcpFeedback&&a.rtcpFeedback.length&&a.rtcpFeedback.forEach(_=>{c+="a=rtcp-fb:"+u+" "+_.type+(_.parameter&&_.parameter.length?" "+_.parameter:"")+`\r
`}),c},i.parseSsrcMedia=function(a){let c=a.indexOf(" "),u={ssrc:parseInt(a.substring(7,c),10)},_=a.indexOf(":",c);return _>-1?(u.attribute=a.substring(c+1,_),u.value=a.substring(_+1)):u.attribute=a.substring(c+1),u},i.parseSsrcGroup=function(a){let c=a.substring(13).split(" ");return{semantics:c.shift(),ssrcs:c.map(u=>parseInt(u,10))}},i.getMid=function(a){let c=i.matchPrefix(a,"a=mid:")[0];if(c)return c.substring(6)},i.parseFingerprint=function(a){let c=a.substring(14).split(" ");return{algorithm:c[0].toLowerCase(),value:c[1].toUpperCase()}},i.getDtlsParameters=function(a,c){return{role:"auto",fingerprints:i.matchPrefix(a+c,"a=fingerprint:").map(i.parseFingerprint)}},i.writeDtlsParameters=function(a,c){let u="a=setup:"+c+`\r
`;return a.fingerprints.forEach(_=>{u+="a=fingerprint:"+_.algorithm+" "+_.value+`\r
`}),u},i.parseCryptoLine=function(a){let c=a.substring(9).split(" ");return{tag:parseInt(c[0],10),cryptoSuite:c[1],keyParams:c[2],sessionParams:c.slice(3)}},i.writeCryptoLine=function(a){return"a=crypto:"+a.tag+" "+a.cryptoSuite+" "+(typeof a.keyParams=="object"?i.writeCryptoKeyParams(a.keyParams):a.keyParams)+(a.sessionParams?" "+a.sessionParams.join(" "):"")+`\r
`},i.parseCryptoKeyParams=function(a){if(a.indexOf("inline:")!==0)return null;let c=a.substring(7).split("|");return{keyMethod:"inline",keySalt:c[0],lifeTime:c[1],mkiValue:c[2]?c[2].split(":")[0]:void 0,mkiLength:c[2]?c[2].split(":")[1]:void 0}},i.writeCryptoKeyParams=function(a){return a.keyMethod+":"+a.keySalt+(a.lifeTime?"|"+a.lifeTime:"")+(a.mkiValue&&a.mkiLength?"|"+a.mkiValue+":"+a.mkiLength:"")},i.getCryptoParameters=function(a,c){return i.matchPrefix(a+c,"a=crypto:").map(i.parseCryptoLine)},i.getIceParameters=function(a,c){let u=i.matchPrefix(a+c,"a=ice-ufrag:")[0],_=i.matchPrefix(a+c,"a=ice-pwd:")[0];return u&&_?{usernameFragment:u.substring(12),password:_.substring(10)}:null},i.writeIceParameters=function(a){let c="a=ice-ufrag:"+a.usernameFragment+`\r
a=ice-pwd:`+a.password+`\r
`;return a.iceLite&&(c+=`a=ice-lite\r
`),c},i.parseRtpParameters=function(a){let c={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},u=i.splitLines(a)[0].split(" ");c.profile=u[2];for(let S=3;S<u.length;S++){let C=u[S],R=i.matchPrefix(a,"a=rtpmap:"+C+" ")[0];if(R){let e=i.parseRtpMap(R),t=i.matchPrefix(a,"a=fmtp:"+C+" ");switch(e.parameters=t.length?i.parseFmtp(t[0]):{},e.rtcpFeedback=i.matchPrefix(a,"a=rtcp-fb:"+C+" ").map(i.parseRtcpFb),c.codecs.push(e),e.name.toUpperCase()){case"RED":case"ULPFEC":c.fecMechanisms.push(e.name.toUpperCase())}}}i.matchPrefix(a,"a=extmap:").forEach(S=>{c.headerExtensions.push(i.parseExtmap(S))});let _=i.matchPrefix(a,"a=rtcp-fb:* ").map(i.parseRtcpFb);return c.codecs.forEach(S=>{_.forEach(C=>{S.rtcpFeedback.find(R=>R.type===C.type&&R.parameter===C.parameter)||S.rtcpFeedback.push(C)})}),c},i.writeRtpDescription=function(a,c){let u="";u+="m="+a+" ",u+=c.codecs.length>0?"9":"0",u+=" "+(c.profile||"UDP/TLS/RTP/SAVPF")+" ",u+=c.codecs.map(S=>S.preferredPayloadType!==void 0?S.preferredPayloadType:S.payloadType).join(" ")+`\r
`,u+=`c=IN IP4 0.0.0.0\r
`,u+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,c.codecs.forEach(S=>{u+=i.writeRtpMap(S),u+=i.writeFmtp(S),u+=i.writeRtcpFb(S)});let _=0;return c.codecs.forEach(S=>{S.maxptime>_&&(_=S.maxptime)}),_>0&&(u+="a=maxptime:"+_+`\r
`),c.headerExtensions&&c.headerExtensions.forEach(S=>{u+=i.writeExtmap(S)}),u},i.parseRtpEncodingParameters=function(a){let c=[],u=i.parseRtpParameters(a),_=u.fecMechanisms.indexOf("RED")!==-1,S=u.fecMechanisms.indexOf("ULPFEC")!==-1,C=i.matchPrefix(a,"a=ssrc:").map(s=>i.parseSsrcMedia(s)).filter(s=>s.attribute==="cname"),R=C.length>0&&C[0].ssrc,e,t=i.matchPrefix(a,"a=ssrc-group:FID").map(s=>s.substring(17).split(" ").map(l=>parseInt(l,10)));t.length>0&&t[0].length>1&&t[0][0]===R&&(e=t[0][1]),u.codecs.forEach(s=>{if(s.name.toUpperCase()==="RTX"&&s.parameters.apt){let l={ssrc:R,codecPayloadType:parseInt(s.parameters.apt,10)};R&&e&&(l.rtx={ssrc:e}),c.push(l),_&&(l=JSON.parse(JSON.stringify(l)),l.fec={ssrc:R,mechanism:S?"red+ulpfec":"red"},c.push(l))}}),c.length===0&&R&&c.push({ssrc:R});let r=i.matchPrefix(a,"b=");return r.length&&(r=r[0].indexOf("b=TIAS:")===0?parseInt(r[0].substring(7),10):r[0].indexOf("b=AS:")===0?1e3*parseInt(r[0].substring(5),10)*.95-16e3:void 0,c.forEach(s=>{s.maxBitrate=r})),c},i.parseRtcpParameters=function(a){let c={},u=i.matchPrefix(a,"a=ssrc:").map(C=>i.parseSsrcMedia(C)).filter(C=>C.attribute==="cname")[0];u&&(c.cname=u.value,c.ssrc=u.ssrc);let _=i.matchPrefix(a,"a=rtcp-rsize");c.reducedSize=_.length>0,c.compound=_.length===0;let S=i.matchPrefix(a,"a=rtcp-mux");return c.mux=S.length>0,c},i.writeRtcpParameters=function(a){let c="";return a.reducedSize&&(c+=`a=rtcp-rsize\r
`),a.mux&&(c+=`a=rtcp-mux\r
`),a.ssrc!==void 0&&a.cname&&(c+="a=ssrc:"+a.ssrc+" cname:"+a.cname+`\r
`),c},i.parseMsid=function(a){let c,u=i.matchPrefix(a,"a=msid:");if(u.length===1)return c=u[0].substring(7).split(" "),{stream:c[0],track:c[1]};let _=i.matchPrefix(a,"a=ssrc:").map(S=>i.parseSsrcMedia(S)).filter(S=>S.attribute==="msid");return _.length>0?(c=_[0].value.split(" "),{stream:c[0],track:c[1]}):void 0},i.parseSctpDescription=function(a){let c=i.parseMLine(a),u=i.matchPrefix(a,"a=max-message-size:"),_;u.length>0&&(_=parseInt(u[0].substring(19),10)),isNaN(_)&&(_=65536);let S=i.matchPrefix(a,"a=sctp-port:");if(S.length>0)return{port:parseInt(S[0].substring(12),10),protocol:c.fmt,maxMessageSize:_};let C=i.matchPrefix(a,"a=sctpmap:");if(C.length>0){let R=C[0].substring(10).split(" ");return{port:parseInt(R[0],10),protocol:R[1],maxMessageSize:_}}},i.writeSctpDescription=function(a,c){let u=[];return u=a.protocol!=="DTLS/SCTP"?["m="+a.kind+" 9 "+a.protocol+" "+c.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+c.port+`\r
`]:["m="+a.kind+" 9 "+a.protocol+" "+c.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+c.port+" "+c.protocol+` 65535\r
`],c.maxMessageSize!==void 0&&u.push("a=max-message-size:"+c.maxMessageSize+`\r
`),u.join("")},i.generateSessionId=function(){return Math.random().toString().substr(2,22)},i.writeSessionBoilerplate=function(a,c,u){let _,S=c!==void 0?c:2;return _=a||i.generateSessionId(),`v=0\r
o=`+(u||"thisisadapterortc")+" "+_+" "+S+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},i.getDirection=function(a,c){let u=i.splitLines(a);for(let _=0;_<u.length;_++)switch(u[_]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return u[_].substring(2)}return c?i.getDirection(c):"sendrecv"},i.getKind=function(a){return i.splitLines(a)[0].split(" ")[0].substring(2)},i.isRejected=function(a){return a.split(" ",2)[1]==="0"},i.parseMLine=function(a){let c=i.splitLines(a)[0].substring(2).split(" ");return{kind:c[0],port:parseInt(c[1],10),protocol:c[2],fmt:c.slice(3).join(" ")}},i.parseOLine=function(a){let c=i.matchPrefix(a,"o=")[0].substring(2).split(" ");return{username:c[0],sessionId:c[1],sessionVersion:parseInt(c[2],10),netType:c[3],addressType:c[4],address:c[5]}},i.isValidSDP=function(a){if(typeof a!="string"||a.length===0)return!1;let c=i.splitLines(a);for(let u=0;u<c.length;u++)if(c[u].length<2||c[u].charAt(1)!=="=")return!1;return!0},n.exports=i})(Ok);var Nk=Ok.exports,b_=T(Nk),QV=h({__proto__:null,default:b_},[Nk]);function vR(n){if(!n.RTCIceCandidate||n.RTCIceCandidate&&"foundation"in n.RTCIceCandidate.prototype)return;let i=n.RTCIceCandidate;n.RTCIceCandidate=function(a){if(typeof a=="object"&&a.candidate&&a.candidate.indexOf("a=")===0&&((a=JSON.parse(JSON.stringify(a))).candidate=a.candidate.substr(2)),a.candidate&&a.candidate.length){let c=new i(a),u=b_.parseCandidate(a.candidate),_=Object.assign(c,u);return _.toJSON=function(){return{candidate:_.candidate,sdpMid:_.sdpMid,sdpMLineIndex:_.sdpMLineIndex,usernameFragment:_.usernameFragment}},_}return new i(a)},n.RTCIceCandidate.prototype=i.prototype,aS(n,"icecandidate",a=>(a.candidate&&Object.defineProperty(a,"candidate",{value:new n.RTCIceCandidate(a.candidate),writable:"false"}),a))}function oN(n){!n.RTCIceCandidate||n.RTCIceCandidate&&"relayProtocol"in n.RTCIceCandidate.prototype||aS(n,"icecandidate",i=>{if(i.candidate){let a=b_.parseCandidate(i.candidate.candidate);a.type==="relay"&&(i.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[a.priority>>24])}return i})}function SR(n,i){if(!n.RTCPeerConnection)return;"sctp"in n.RTCPeerConnection.prototype||Object.defineProperty(n.RTCPeerConnection.prototype,"sctp",{get(){return this._sctp===void 0?null:this._sctp}});let a=function(C){if(!C||!C.sdp)return!1;let R=b_.splitSections(C.sdp);return R.shift(),R.some(e=>{let t=b_.parseMLine(e);return t&&t.kind==="application"&&t.protocol.indexOf("SCTP")!==-1})},c=function(C){let R=C.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(R===null||R.length<2)return-1;let e=parseInt(R[1],10);return e!=e?-1:e},u=function(C){let R=65536;return i.browser==="firefox"&&(R=i.version<57?C===-1?16384:2147483637:i.version<60?i.version===57?65535:65536:2147483637),R},_=function(C,R){let e=65536;i.browser==="firefox"&&i.version===57&&(e=65535);let t=b_.matchPrefix(C.sdp,"a=max-message-size:");return t.length>0?e=parseInt(t[0].substr(19),10):i.browser==="firefox"&&R!==-1&&(e=2147483637),e},S=n.RTCPeerConnection.prototype.setRemoteDescription;n.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,i.browser==="chrome"&&i.version>=76){let{sdpSemantics:C}=this.getConfiguration();C==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return this._sctp===void 0?null:this._sctp},enumerable:!0,configurable:!0})}if(a(arguments[0])){let C=c(arguments[0]),R=u(C),e=_(arguments[0],C),t;t=R===0&&e===0?Number.POSITIVE_INFINITY:R===0||e===0?Math.max(R,e):Math.min(R,e);let r={};Object.defineProperty(r,"maxMessageSize",{get:()=>t}),this._sctp=r}return S.apply(this,arguments)}}function yR(n){if(!n.RTCPeerConnection||!("createDataChannel"in n.RTCPeerConnection.prototype))return;function i(c,u){let _=c.send;c.send=function(){let S=arguments[0],C=S.length||S.size||S.byteLength;if(c.readyState==="open"&&u.sctp&&C>u.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+u.sctp.maxMessageSize+" bytes)");return _.apply(c,arguments)}}let a=n.RTCPeerConnection.prototype.createDataChannel;n.RTCPeerConnection.prototype.createDataChannel=function(){let c=a.apply(this,arguments);return i(c,this),c},aS(n,"datachannel",c=>(i(c.channel,c.target),c))}function cN(n){if(!n.RTCPeerConnection||"connectionState"in n.RTCPeerConnection.prototype)return;let i=n.RTCPeerConnection.prototype;Object.defineProperty(i,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(i,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(a){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),a&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=a)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(a=>{let c=i[a];i[a]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=u=>{let _=u.target;if(_._lastConnectionState!==_.connectionState){_._lastConnectionState=_.connectionState;let S=new Event("connectionstatechange",u);_.dispatchEvent(S)}return u},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),c.apply(this,arguments)}})}function lN(n,i){if(!n.RTCPeerConnection||i.browser==="chrome"&&i.version>=71||i.browser==="safari"&&i.version>=605)return;let a=n.RTCPeerConnection.prototype.setRemoteDescription;n.RTCPeerConnection.prototype.setRemoteDescription=function(c){if(c&&c.sdp&&c.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){let u=c.sdp.split(`
`).filter(_=>js(_).call(_)!=="a=extmap-allow-mixed").join(`
`);n.RTCSessionDescription&&c instanceof n.RTCSessionDescription?arguments[0]=new n.RTCSessionDescription({type:c.type,sdp:u}):c.sdp=u}return a.apply(this,arguments)}}function TR(n,i){if(!n.RTCPeerConnection||!n.RTCPeerConnection.prototype)return;let a=n.RTCPeerConnection.prototype.addIceCandidate;a&&a.length!==0&&(n.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(i.browser==="chrome"&&i.version<78||i.browser==="firefox"&&i.version<68||i.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Et.resolve():a.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Et.resolve())})}function bR(n,i){if(!n.RTCPeerConnection||!n.RTCPeerConnection.prototype)return;let a=n.RTCPeerConnection.prototype.setLocalDescription;a&&a.length!==0&&(n.RTCPeerConnection.prototype.setLocalDescription=function(){let c=arguments[0]||{};if(typeof c!="object"||c.type&&c.sdp)return a.apply(this,arguments);if(c={type:c.type,sdp:c.sdp},!c.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":c.type="offer";break;default:c.type="answer"}return c.sdp||c.type!=="offer"&&c.type!=="answer"?a.apply(this,[c]):(c.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(u=>a.apply(this,[u]))})}var ZV=Object.freeze({__proto__:null,removeExtmapAllowMixed:lN,shimAddIceCandidateNullOrEmpty:TR,shimConnectionState:cN,shimMaxMessageSize:SR,shimParameterlessSetLocalDescription:bR,shimRTCIceCandidate:vR,shimRTCIceCandidateRelayProtocol:oN,shimSendThrowTypeError:yR});(function(){let{window:n}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0},a=hb,c=function(_){let S={browser:null,version:null};if(_===void 0||!_.navigator)return S.browser="Not a browser.",S;let{navigator:C}=_;if(C.mozGetUserMedia)S.browser="firefox",S.version=QO(C.userAgent,/Firefox\/(\d+)\./,1);else if(C.webkitGetUserMedia||_.isSecureContext===!1&&_.webkitRTCPeerConnection)S.browser="chrome",S.version=QO(C.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else{if(!_.RTCPeerConnection||!C.userAgent.match(/AppleWebKit\/(\d+)\./))return S.browser="Not a supported browser.",S;S.browser="safari",S.version=QO(C.userAgent,/AppleWebKit\/(\d+)\./,1),S.supportsUnifiedPlan=_.RTCRtpTransceiver&&"currentDirection"in _.RTCRtpTransceiver.prototype}return S}(n),u={browserDetails:c,commonShim:ZV,extractVersion:QO,disableLog:sH,disableWarnings:oH,sdp:QV};switch(c.browser){case"chrome":if(!Ek||!mR||!i.shimChrome)return a("Chrome shim is not included in this adapter release."),u;if(c.version===null)return a("Chrome shim can not determine version, not shimming."),u;a("adapter.js shimming chrome."),u.browserShim=Ek,TR(n,c),bR(n),mb(n,c),hk(n),mR(n,c),HV(n),gk(n,c),ZO(n),pk(n),$O(n),_k(n,c),vR(n),oN(n),cN(n),SR(n,c),yR(n),lN(n,c);break;case"firefox":if(!T_||!ER||!i.shimFirefox)return a("Firefox shim is not included in this adapter release."),u;a("adapter.js shimming firefox."),u.browserShim=T_,TR(n,c),bR(n),gR(n,c),ER(n,c),_R(n),nN(n),eN(n),tN(n),vk(n),rN(n),sS(n),oh(n),Sk(n),vR(n),cN(n),SR(n,c),yR(n);break;case"safari":if(!YV||!i.shimSafari)return a("Safari shim is not included in this adapter release."),u;a("adapter.js shimming safari."),u.browserShim=YV,TR(n,c),bR(n),yk(n),WV(n),oS(n),Mp(n),iN(n),Tk(n),kc(n),bk(n),vR(n),oN(n),SR(n,c),yR(n),lN(n,c);break;default:a("Unsupported browser!")}})({window:typeof window>"u"?void 0:window});var dN=er,$V=TypeError,Lk=ss.match(/firefox\/(\d+)/i),e9=!!Lk&&+Lk[1],t9=/MSIE|Trident/.test(ss),uN=ss.match(/AppleWebKit\/(\d+)\./),n9=!!uN&&+uN[1],r9=br,Dk=K,i9=$i,a9=Tu,Pk=Df,s9=function(n,i){if(!delete n[i])throw $V("Cannot delete property "+dN(i)+" of "+dN(n))},Mk=nc,fN=I,o9=iR,c9=rc,kk=e9,l9=t9,xk=ko,Uk=n9,Cg=[],jk=Dk(Cg.sort),d9=Dk(Cg.push),u9=fN(function(){Cg.sort(void 0)}),f9=fN(function(){Cg.sort(null)}),pH=c9("sort"),h9=!fN(function(){if(xk)return xk<70;if(!(kk&&kk>3)){if(l9)return!0;if(Uk)return Uk<603;var n,i,a,c,u="";for(n=65;n<76;n++){switch(i=String.fromCharCode(n),n){case 66:case 69:case 70:case 72:a=3;break;case 68:case 71:a=4;break;default:a=2}for(c=0;c<47;c++)Cg.push({k:i+c,v:a})}for(Cg.sort(function(_,S){return S.v-_.v}),c=0;c<Cg.length;c++)i=Cg[c].k.charAt(0),u.charAt(u.length-1)!==i&&(u+=i);return u!=="DGBEFHACIJK"}});r9({target:"Array",proto:!0,forced:u9||!f9||!pH||!h9},{sort:function(n){n!==void 0&&i9(n);var i=a9(this);if(h9)return n===void 0?jk(i):jk(i,n);var a,c,u=[],_=Pk(i);for(c=0;c<_;c++)c in i&&d9(u,i[c]);for(o9(u,function(S){return function(C,R){return R===void 0?-1:C===void 0?1:S!==void 0?+S(C,R)||0:Mk(C)>Mk(R)?1:-1}}(n)),a=Pk(u),c=0;c<a;)i[c]=u[c++];for(;c<_;)s9(i,c++);return i}});var Vk=tc("Array").sort,p9=Q,mH=Vk,Bk=Array.prototype,gH=function(n){var i=n.sort;return n===Bk||p9(Bk,n)&&i===Bk.sort?mH:i},CR=T(gH),Fk=X;br({global:!0,forced:Fk.globalThis!==Fk},{globalThis:Fk});var m9=T(X),hN={exports:{}};(function(n,i){(function(a,c){var u="function",_="undefined",S="object",C="string",R="major",e="model",t="name",r="type",s="vendor",l="version",f="architecture",m="console",E="mobile",y="tablet",b="smarttv",A="wearable",O="embedded",D="Amazon",P="Apple",F="ASUS",B="BlackBerry",Y="Browser",$="Chrome",ee="Firefox",Ee="Google",Re="Huawei",Ie="LG",we="Microsoft",Ue="Motorola",ve="Opera",Ne="Samsung",Ve="Sharp",Be="Sony",W="Xiaomi",ce="Zebra",Se="Facebook",Xe="Chromium OS",en="Mac OS",He=function(Hr){for(var gi={},Wr=0;Wr<Hr.length;Wr++)gi[Hr[Wr].toUpperCase()]=Hr[Wr];return gi},tt=function(Hr,gi){return typeof Hr===C&&St(gi).indexOf(St(Hr))!==-1},St=function(Hr){return Hr.toLowerCase()},Ze=function(Hr,gi){if(typeof Hr===C)return Hr=Hr.replace(/^\s\s*/,""),typeof gi===_?Hr:Hr.substring(0,350)},J=function(Hr,gi){for(var Wr,Ws,Ml,Fi,Zn,Ta,$c=0;$c<gi.length&&!Zn;){var pd=gi[$c],ha=gi[$c+1];for(Wr=Ws=0;Wr<pd.length&&!Zn&&pd[Wr];)if(Zn=pd[Wr++].exec(Hr))for(Ml=0;Ml<ha.length;Ml++)Ta=Zn[++Ws],typeof(Fi=ha[Ml])===S&&Fi.length>0?Fi.length===2?typeof Fi[1]==u?this[Fi[0]]=Fi[1].call(this,Ta):this[Fi[0]]=Fi[1]:Fi.length===3?typeof Fi[1]!==u||Fi[1].exec&&Fi[1].test?this[Fi[0]]=Ta?Ta.replace(Fi[1],Fi[2]):c:this[Fi[0]]=Ta?Fi[1].call(this,Ta,Fi[2]):c:Fi.length===4&&(this[Fi[0]]=Ta?Fi[3].call(this,Ta.replace(Fi[1],Fi[2])):c):this[Fi]=Ta||c;$c+=2}},_e=function(Hr,gi){for(var Wr in gi)if(typeof gi[Wr]===S&&gi[Wr].length>0){for(var Ws=0;Ws<gi[Wr].length;Ws++)if(tt(gi[Wr][Ws],Hr))return Wr==="?"?c:Wr}else if(tt(gi[Wr],Hr))return Wr==="?"?c:Wr;return Hr},be={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},ot={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[l,[t,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[l,[t,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[t,l],[/opios[\/ ]+([\w\.]+)/i],[l,[t,ve+" Mini"]],[/\bopr\/([\w\.]+)/i],[l,[t,ve]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|qq|duckduckgo)\/([-\w\.]+)/i,/(weibo)__([\d\.]+)/i],[t,l],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[l,[t,"UC"+Y]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i],[l,[t,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[l,[t,"WeChat"]],[/konqueror\/([\w\.]+)/i],[l,[t,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[l,[t,"IE"]],[/yabrowser\/([\w\.]+)/i],[l,[t,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[t,/(.+)/,"$1 Secure "+Y],l],[/\bfocus\/([\w\.]+)/i],[l,[t,ee+" Focus"]],[/\bopt\/([\w\.]+)/i],[l,[t,ve+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[l,[t,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[l,[t,"Dolphin"]],[/coast\/([\w\.]+)/i],[l,[t,ve+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[l,[t,"MIUI "+Y]],[/fxios\/([-\w\.]+)/i],[l,[t,ee]],[/\bqihu|(qi?ho?o?|360)browser/i],[[t,"360 "+Y]],[/(oculus|samsung|sailfish|huawei)browser\/([\w\.]+)/i],[[t,/(.+)/,"$1 "+Y],l],[/(comodo_dragon)\/([\w\.]+)/i],[[t,/_/g," "],l],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[t,l],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i,/\[(linkedin)app\]/i],[t],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[t,Se],l],[/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/ ]([-\w\.]+)/i],[t,l],[/\bgsa\/([\w\.]+) .*safari\//i],[l,[t,"GSA"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[l,[t,$+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[t,$+" WebView"],l],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[l,[t,"Android "+Y]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[t,l],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[l,[t,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[l,t],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[t,[l,_e,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[t,l],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[t,"Netscape"],l],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[l,[t,ee+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i,/panasonic;(viera)/i],[t,l],[/(cobalt)\/([\w\.]+)/i],[t,[l,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[f,"amd64"]],[/(ia32(?=;))/i],[[f,St]],[/((?:i[346]|x)86)[;\)]/i],[[f,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[f,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[f,"armhf"]],[/windows (ce|mobile); ppc;/i],[[f,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[f,/ower/,"",St]],[/(sun4\w)[;\)]/i],[[f,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[f,St]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[e,[s,Ne],[r,y]],[/\b((?:s[cgp]h|gt|sm)-\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[e,[s,Ne],[r,E]],[/\((ip(?:hone|od)[\w ]*);/i],[e,[s,P],[r,E]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[e,[s,P],[r,y]],[/(macintosh);/i],[e,[s,P]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[e,[s,Ve],[r,E]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[e,[s,Re],[r,y]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[e,[s,Re],[r,E]],[/\b(poco[\w ]+)(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[e,/_/g," "],[s,W],[r,E]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[e,/_/g," "],[s,W],[r,y]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[e,[s,"OPPO"],[r,E]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[e,[s,"Vivo"],[r,E]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[e,[s,"Realme"],[r,E]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[e,[s,Ue],[r,E]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[e,[s,Ue],[r,y]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[e,[s,Ie],[r,y]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[e,[s,Ie],[r,E]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[e,[s,"Lenovo"],[r,y]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[e,/_/g," "],[s,"Nokia"],[r,E]],[/(pixel c)\b/i],[e,[s,Ee],[r,y]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[e,[s,Ee],[r,E]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[e,[s,Be],[r,E]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[e,"Xperia Tablet"],[s,Be],[r,y]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[e,[s,"OnePlus"],[r,E]],[/(alexa)webm/i,/(kf[a-z]{2}wi)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[e,[s,D],[r,y]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[e,/(.+)/g,"Fire Phone $1"],[s,D],[r,E]],[/(playbook);[-\w\),; ]+(rim)/i],[e,s,[r,y]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[e,[s,B],[r,E]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[e,[s,F],[r,y]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[e,[s,F],[r,E]],[/(nexus 9)/i],[e,[s,"HTC"],[r,y]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[s,[e,/_/g," "],[r,E]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[e,[s,"Acer"],[r,y]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[e,[s,"Meizu"],[r,E]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[s,e,[r,E]],[/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[s,e,[r,y]],[/(surface duo)/i],[e,[s,we],[r,y]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[e,[s,"Fairphone"],[r,E]],[/(u304aa)/i],[e,[s,"AT&T"],[r,E]],[/\bsie-(\w*)/i],[e,[s,"Siemens"],[r,E]],[/\b(rct\w+) b/i],[e,[s,"RCA"],[r,y]],[/\b(venue[\d ]{2,7}) b/i],[e,[s,"Dell"],[r,y]],[/\b(q(?:mv|ta)\w+) b/i],[e,[s,"Verizon"],[r,y]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[e,[s,"Barnes & Noble"],[r,y]],[/\b(tm\d{3}\w+) b/i],[e,[s,"NuVision"],[r,y]],[/\b(k88) b/i],[e,[s,"ZTE"],[r,y]],[/\b(nx\d{3}j) b/i],[e,[s,"ZTE"],[r,E]],[/\b(gen\d{3}) b.+49h/i],[e,[s,"Swiss"],[r,E]],[/\b(zur\d{3}) b/i],[e,[s,"Swiss"],[r,y]],[/\b((zeki)?tb.*\b) b/i],[e,[s,"Zeki"],[r,y]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[s,"Dragon Touch"],e,[r,y]],[/\b(ns-?\w{0,9}) b/i],[e,[s,"Insignia"],[r,y]],[/\b((nxa|next)-?\w{0,9}) b/i],[e,[s,"NextBook"],[r,y]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[s,"Voice"],e,[r,E]],[/\b(lvtel\-)?(v1[12]) b/i],[[s,"LvTel"],e,[r,E]],[/\b(ph-1) /i],[e,[s,"Essential"],[r,E]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[e,[s,"Envizen"],[r,y]],[/\b(trio[-\w\. ]+) b/i],[e,[s,"MachSpeed"],[r,y]],[/\btu_(1491) b/i],[e,[s,"Rotor"],[r,y]],[/(shield[\w ]+) b/i],[e,[s,"Nvidia"],[r,y]],[/(sprint) (\w+)/i],[s,e,[r,E]],[/(kin\.[onetw]{3})/i],[[e,/\./g," "],[s,we],[r,E]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[e,[s,ce],[r,y]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[e,[s,ce],[r,E]],[/smart-tv.+(samsung)/i],[s,[r,b]],[/hbbtv.+maple;(\d+)/i],[[e,/^/,"SmartTV"],[s,Ne],[r,b]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[s,Ie],[r,b]],[/(apple) ?tv/i],[s,[e,P+" TV"],[r,b]],[/crkey/i],[[e,$+"cast"],[s,Ee],[r,b]],[/droid.+aft(\w)( bui|\))/i],[e,[s,D],[r,b]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[e,[s,Ve],[r,b]],[/(bravia[\w ]+)( bui|\))/i],[e,[s,Be],[r,b]],[/(mitv-\w{5}) bui/i],[e,[s,W],[r,b]],[/Hbbtv.*(technisat) (.*);/i],[s,e,[r,b]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[s,Ze],[e,Ze],[r,b]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[r,b]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[s,e,[r,m]],[/droid.+; (shield) bui/i],[e,[s,"Nvidia"],[r,m]],[/(playstation [345portablevi]+)/i],[e,[s,Be],[r,m]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[e,[s,we],[r,m]],[/((pebble))app/i],[s,e,[r,A]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[e,[s,P],[r,A]],[/droid.+; (glass) \d/i],[e,[s,Ee],[r,A]],[/droid.+; (wt63?0{2,3})\)/i],[e,[s,ce],[r,A]],[/(quest( 2| pro)?)/i],[e,[s,Se],[r,A]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[s,[r,O]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[e,[r,E]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[e,[r,y]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[r,y]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[r,E]],[/(android[-\w\. ]{0,9});.+buil/i],[e,[s,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[l,[t,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[l,[t,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i],[t,l],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[l,t]],os:[[/microsoft (windows) (vista|xp)/i],[t,l],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[t,[l,_e,be]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[t,"Windows"],[l,_e,be]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/cfnetwork\/.+darwin/i],[[l,/_/g,"."],[t,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[t,en],[l,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[l,t],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[t,l],[/\(bb(10);/i],[l,[t,B]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[l,[t,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[l,[t,ee+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[l,[t,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[l,[t,"watchOS"]],[/crkey\/([\d\.]+)/i],[l,[t,$+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[t,Xe],l],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[t,l],[/(sunos) ?([\w\.\d]*)/i],[[t,"Solaris"],l],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux)/i,/(unix) ?([\w\.]*)/i],[t,l]]},an=function(Hr,gi){if(typeof Hr===S&&(gi=Hr,Hr=c),!(this instanceof an))return new an(Hr,gi).getResult();var Wr=typeof a!==_&&a.navigator?a.navigator:c,Ws=Hr||(Wr&&Wr.userAgent?Wr.userAgent:""),Ml=Wr&&Wr.userAgentData?Wr.userAgentData:c,Fi=gi?function(Zn,Ta){var $c={};for(var pd in Zn)Ta[pd]&&Ta[pd].length%2==0?$c[pd]=Ta[pd].concat(Zn[pd]):$c[pd]=Zn[pd];return $c}(ot,gi):ot;return this.getBrowser=function(){var Zn={};return Zn[t]=c,Zn[l]=c,J.call(Zn,Ws,Fi.browser),Zn[R]=function(Ta){return typeof Ta===C?Ta.replace(/[^\d\.]/g,"").split(".")[0]:c}(Zn[l]),Wr&&Wr.brave&&typeof Wr.brave.isBrave==u&&(Zn[t]="Brave"),Zn},this.getCPU=function(){var Zn={};return Zn[f]=c,J.call(Zn,Ws,Fi.cpu),Zn},this.getDevice=function(){var Zn={};return Zn[s]=c,Zn[e]=c,Zn[r]=c,J.call(Zn,Ws,Fi.device),!Zn[r]&&Ml&&Ml.mobile&&(Zn[r]=E),Zn[e]=="Macintosh"&&Wr&&typeof Wr.standalone!==_&&Wr.maxTouchPoints&&Wr.maxTouchPoints>2&&(Zn[e]="iPad",Zn[r]=y),Zn},this.getEngine=function(){var Zn={};return Zn[t]=c,Zn[l]=c,J.call(Zn,Ws,Fi.engine),Zn},this.getOS=function(){var Zn={};return Zn[t]=c,Zn[l]=c,J.call(Zn,Ws,Fi.os),!Zn[t]&&Ml&&Ml.platform!="Unknown"&&(Zn[t]=Ml.platform.replace(/chrome os/i,Xe).replace(/macos/i,en)),Zn},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return Ws},this.setUA=function(Zn){return Ws=typeof Zn===C&&Zn.length>350?Ze(Zn,350):Zn,this},this.setUA(Ws),this};an.VERSION="0.7.34",an.BROWSER=He([t,l,R]),an.CPU=He([f]),an.DEVICE=He([e,s,r,m,E,b,y,A,O]),an.ENGINE=an.OS=He([t,l]),n.exports&&(i=n.exports=an),i.UAParser=an;var hr=typeof a!==_&&(a.jQuery||a.Zepto);if(hr&&!hr.ua){var Bi=new an;hr.ua=Bi.getResult(),hr.ua.get=function(){return Bi.getUA()},hr.ua.set=function(Hr){Bi.setUA(Hr);var gi=Bi.getResult();for(var Wr in gi)hr.ua[Wr]=gi[Wr]}}})(typeof window=="object"?window:g)})(hN,hN.exports);var _H=T(hN.exports),EH=Cd,vH=ls,SH=Jt,Gk=ci,yH=Ai("iterator"),Eo=Object,g9=function(n){if(SH(n))return!1;var i=Eo(n);return i[yH]!==void 0||"@@iterator"in i||vH(Gk,EH(i))},_9=T(g9),lS=Lr.clear;br({global:!0,bind:!0,forced:X.clearImmediate!==lS},{clearImmediate:lS});var TH=typeof Bun=="function"&&Bun&&typeof Bun.version=="string",wR=X,zk=ue,pN=$e,mN=TH,Hk=ss,Wk=_p,gN=$0,_N=wR.Function,bH=/MSIE .\./.test(Hk)||mN&&function(){var n=wR.Bun.version.split(".");return n.length<3||n[0]==0&&(n[1]<3||n[1]==3&&n[2]==0)}(),Yk=br,Kk=X,EN=Lr.set,CH=function(n,i){var a=1;return bH?function(c,u){var _=gN(arguments.length,1)>a,S=pN(c)?c:_N(c),C=_?Wk(arguments,a):[],R=_?function(){zk(S,this,C)}:S;return n(R)}:n},qk=Kk.setImmediate?CH(EN):EN;Yk({global:!0,bind:!0,forced:Kk.setImmediate!==qk},{setImmediate:qk});var Jk=T(Sn.setImmediate),wH=br,RH=Cw,IH=$i,AH=$0,OH=Rd,NH=X.process;wH({global:!0,dontCallGetSet:!0},{queueMicrotask:function(n){AH(arguments.length,1),IH(n);var i=OH&&NH.domain;RH(i?i.bind(n):n)}});var E9=T(Sn.queueMicrotask);function v9(n,i){return function(){return n.apply(i,arguments)}}let{toString:LH}=Object.prototype,{getPrototypeOf:vN}=Object,RR=(Xk=Object.create(null),n=>{let i=LH.call(n);return Xk[i]||(Xk[i]=i.slice(8,-1).toLowerCase())});var Xk;let qu=n=>(n=n.toLowerCase(),i=>RR(i)===n),IR=n=>i=>typeof i===n,{isArray:gb}=Array,AR=IR("undefined"),S9=qu("ArrayBuffer"),DH=IR("string"),Hd=IR("function"),Qk=IR("number"),OR=n=>n!==null&&typeof n=="object",SN=n=>{if(RR(n)!=="object")return!1;let i=vN(n);return!(i!==null&&i!==Object.prototype&&Object.getPrototypeOf(i)!==null||Symbol.toStringTag in n||_9(n))},Zk=qu("Date"),yN=qu("File"),y9=qu("Blob"),TN=qu("FileList"),$k=qu("URLSearchParams"),[ch,bN,_b,NR]=["ReadableStream","Request","Response","Headers"].map(qu);function Eb(n,i){let a,c,{allOwnKeys:u=!1}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(n!=null)if(typeof n!="object"&&(n=[n]),gb(n))for(a=0,c=n.length;a<c;a++)i.call(null,n[a],a,n);else{let _=u?Object.getOwnPropertyNames(n):Object.keys(n),S=_.length,C;for(a=0;a<S;a++)C=_[a],i.call(null,n[C],C,n)}}function T9(n,i){i=i.toLowerCase();let a=Object.keys(n),c,u=a.length;for(;u-- >0;)if(c=a[u],i===c.toLowerCase())return c;return null}let $s=m9!==void 0?m9:typeof self<"u"?self:typeof window<"u"?window:global,e4=n=>!AR(n)&&n!==$s,CN=(vb=typeof Uint8Array<"u"&&vN(Uint8Array),n=>vb&&n instanceof vb);var vb;let PH=qu("HTMLFormElement"),b9=(n=>{let{hasOwnProperty:i}=n;return(a,c)=>i.call(a,c)})(Object.prototype),MH=qu("RegExp"),C9=(n,i)=>{let a=Object.getOwnPropertyDescriptors(n),c={};Eb(a,(u,_)=>{let S;(S=i(u,_,n))!==!1&&(c[_]=S||u)}),Object.defineProperties(n,c)},t4="abcdefghijklmnopqrstuvwxyz",w9="0123456789",R9={DIGIT:w9,ALPHA:t4,ALPHA_DIGIT:t4+t4.toUpperCase()+w9},kH=qu("AsyncFunction"),I9=(Sb=typeof Jk=="function",n4=Hd($s.postMessage),Sb?Jk:n4?(wg="axios@".concat(Math.random()),LR=[],$s.addEventListener("message",n=>{let{source:i,data:a}=n;i===$s&&a===wg&&LR.length&&LR.shift()()},!1),n=>{LR.push(n),$s.postMessage(wg,"*")}):n=>setTimeout(n));var Sb,n4,wg,LR;let xH=E9!==void 0?E9.bind($s):typeof process<"u"&&process.nextTick||I9;var _t={isArray:gb,isArrayBuffer:S9,isBuffer:function(n){return n!==null&&!AR(n)&&n.constructor!==null&&!AR(n.constructor)&&Hd(n.constructor.isBuffer)&&n.constructor.isBuffer(n)},isFormData:n=>{let i;return n&&(typeof FormData=="function"&&n instanceof FormData||Hd(n.append)&&((i=RR(n))==="formdata"||i==="object"&&Hd(n.toString)&&n.toString()==="[object FormData]"))},isArrayBufferView:function(n){let i;return i=typeof ArrayBuffer<"u"&&ArrayBuffer.isView?ArrayBuffer.isView(n):n&&n.buffer&&S9(n.buffer),i},isString:DH,isNumber:Qk,isBoolean:n=>n===!0||n===!1,isObject:OR,isPlainObject:SN,isReadableStream:ch,isRequest:bN,isResponse:_b,isHeaders:NR,isUndefined:AR,isDate:Zk,isFile:yN,isBlob:y9,isRegExp:MH,isFunction:Hd,isStream:n=>OR(n)&&Hd(n.pipe),isURLSearchParams:$k,isTypedArray:CN,isFileList:TN,forEach:Eb,merge:function n(){let{caseless:i}=e4(this)&&this||{},a={},c=(u,_)=>{let S=i&&T9(a,_)||_;SN(a[S])&&SN(u)?a[S]=n(a[S],u):SN(u)?a[S]=n({},u):gb(u)?a[S]=u.slice():a[S]=u};for(let u=0,_=arguments.length;u<_;u++)arguments[u]&&Eb(arguments[u],c);return a},extend:function(n,i,a){let{allOwnKeys:c}=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return Eb(i,(u,_)=>{a&&Hd(u)?n[_]=v9(u,a):n[_]=u},{allOwnKeys:c}),n},trim:n=>js(n)?js(n).call(n):n.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:n=>(n.charCodeAt(0)===65279&&(n=n.slice(1)),n),inherits:(n,i,a,c)=>{n.prototype=Object.create(i.prototype,c),n.prototype.constructor=n,Object.defineProperty(n,"super",{value:i.prototype}),a&&Object.assign(n.prototype,a)},toFlatObject:(n,i,a,c)=>{let u,_,S,C={};if(i=i||{},n==null)return i;do{for(u=Object.getOwnPropertyNames(n),_=u.length;_-- >0;)S=u[_],c&&!c(S,n,i)||C[S]||(i[S]=n[S],C[S]=!0);n=a!==!1&&vN(n)}while(n&&(!a||a(n,i))&&n!==Object.prototype);return i},kindOf:RR,kindOfTest:qu,endsWith:(n,i,a)=>{n=String(n),(a===void 0||a>n.length)&&(a=n.length),a-=i.length;let c=n.indexOf(i,a);return c!==-1&&c===a},toArray:n=>{if(!n)return null;if(gb(n))return n;let i=n.length;if(!Qk(i))return null;let a=new Array(i);for(;i-- >0;)a[i]=n[i];return a},forEachEntry:(n,i)=>{let a=(n&&n[Symbol.iterator]).call(n),c;for(;(c=a.next())&&!c.done;){let u=c.value;i.call(n,u[0],u[1])}},matchAll:(n,i)=>{let a,c=[];for(;(a=n.exec(i))!==null;)c.push(a);return c},isHTMLForm:PH,hasOwnProperty:b9,hasOwnProp:b9,reduceDescriptors:C9,freezeMethods:n=>{C9(n,(i,a)=>{if(Hd(n)&&["arguments","caller","callee"].indexOf(a)!==-1)return!1;let c=n[a];Hd(c)&&(i.enumerable=!1,"writable"in i?i.writable=!1:i.set||(i.set=()=>{throw Error("Can not rewrite read-only method '"+a+"'")}))})},toObjectSet:(n,i)=>{let a={},c=u=>{u.forEach(_=>{a[_]=!0})};return gb(n)?c(n):c(String(n).split(i)),a},toCamelCase:n=>n.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(i,a,c){return a.toUpperCase()+c}),noop:()=>{},toFiniteNumber:(n,i)=>n!=null&&Number.isFinite(n=+n)?n:i,findKey:T9,global:$s,isContextDefined:e4,ALPHABET:R9,generateString:function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:16,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:R9.ALPHA_DIGIT,a="",{length:c}=i;for(;n--;)a+=i[Math.random()*c|0];return a},isSpecCompliantForm:function(n){return!!(n&&Hd(n.append)&&n[Symbol.toStringTag]==="FormData"&&n[Symbol.iterator])},toJSONObject:n=>{let i=new Array(10),a=(c,u)=>{if(OR(c)){if(i.indexOf(c)>=0)return;if(!("toJSON"in c)){i[u]=c;let _=gb(c)?[]:{};return Eb(c,(S,C)=>{let R=a(S,u+1);!AR(R)&&(_[C]=R)}),i[u]=void 0,_}}return c};return a(n,0)},isAsyncFn:kH,isThenable:n=>n&&(OR(n)||Hd(n))&&Hd(n.then)&&Hd(n.catch),setImmediate:I9,asap:xH};function Mr(n,i,a,c,u){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=n,this.name="AxiosError",i&&(this.code=i),a&&(this.config=a),c&&(this.request=c),u&&(this.response=u,this.status=u.status?u.status:null)}_t.inherits(Mr,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:_t.toJSONObject(this.config),code:this.code,status:this.status}}});let r4=Mr.prototype,A9={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(n=>{A9[n]={value:n}}),Object.defineProperties(Mr,A9),Object.defineProperty(r4,"isAxiosError",{value:!0}),Mr.from=(n,i,a,c,u,_)=>{let S=Object.create(r4);return _t.toFlatObject(n,S,function(C){return C!==Error.prototype},C=>C!=="isAxiosError"),Mr.call(S,n.message,i,a,c,u),S.cause=n,S.name=n.name,_&&Object.assign(S,_),S};function wN(n){return _t.isPlainObject(n)||_t.isArray(n)}function O9(n){return _t.endsWith(n,"[]")?n.slice(0,-2):n}function i4(n,i,a){return n?n.concat(i).map(function(c,u){return c=O9(c),!a&&u?"["+c+"]":c}).join(a?".":""):i}let N9=_t.toFlatObject(_t,{},null,function(n){return/^is[A-Z]/.test(n)});function DR(n,i,a){if(!_t.isObject(n))throw new TypeError("target must be an object");i=i||new FormData;let c=(a=_t.toFlatObject(a,{metaTokens:!0,dots:!1,indexes:!1},!1,function(s,l){return!_t.isUndefined(l[s])})).metaTokens,u=a.visitor||e,_=a.dots,S=a.indexes,C=(a.Blob||typeof Blob<"u"&&Blob)&&_t.isSpecCompliantForm(i);if(!_t.isFunction(u))throw new TypeError("visitor must be a function");function R(s){if(s===null)return"";if(_t.isDate(s))return s.toISOString();if(!C&&_t.isBlob(s))throw new Mr("Blob is not supported. Use a Buffer instead.");return _t.isArrayBuffer(s)||_t.isTypedArray(s)?C&&typeof Blob=="function"?new Blob([s]):Buffer.from(s):s}function e(s,l,f){let m=s;if(s&&!f&&typeof s=="object"){if(_t.endsWith(l,"{}"))l=c?l:l.slice(0,-2),s=JSON.stringify(s);else if(_t.isArray(s)&&function(E){return _t.isArray(E)&&!E.some(wN)}(s)||(_t.isFileList(s)||_t.endsWith(l,"[]"))&&(m=_t.toArray(s)))return l=O9(l),m.forEach(function(E,y){!_t.isUndefined(E)&&E!==null&&i.append(S===!0?i4([l],y,_):S===null?l:l+"[]",R(E))}),!1}return!!wN(s)||(i.append(i4(f,l,_),R(s)),!1)}let t=[],r=Object.assign(N9,{defaultVisitor:e,convertValue:R,isVisitable:wN});if(!_t.isObject(n))throw new TypeError("data must be an object");return function s(l,f){if(!_t.isUndefined(l)){if(t.indexOf(l)!==-1)throw Error("Circular reference detected in "+f.join("."));t.push(l),_t.forEach(l,function(m,E){(!(_t.isUndefined(m)||m===null)&&u.call(i,m,_t.isString(E)?js(E).call(E):E,f,r))===!0&&s(m,f?f.concat(E):[E])}),t.pop()}}(n),i}function RN(n){let i={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(n).replace(/[!'()~]|%20|%00/g,function(a){return i[a]})}function yb(n,i){this._pairs=[],n&&DR(n,this,i)}let L9=yb.prototype;function mt(n){return encodeURIComponent(n).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Dr(n,i,a){if(!i)return n;let c=a&&a.encode||mt;_t.isFunction(a)&&(a={serialize:a});let u=a&&a.serialize,_;if(_=u?u(i,a):_t.isURLSearchParams(i)?i.toString():new yb(i,a).toString(c),_){let S=n.indexOf("#");S!==-1&&(n=n.slice(0,S)),n+=(n.indexOf("?")===-1?"?":"&")+_}return n}L9.append=function(n,i){this._pairs.push([n,i])},L9.toString=function(n){let i=n?function(a){return n.call(this,a,RN)}:RN;return this._pairs.map(function(a){return i(a[0])+"="+i(a[1])},"").join("&")};var a4=class{constructor(){this.handlers=[]}use(n,i,a){return this.handlers.push({fulfilled:n,rejected:i,synchronous:!!a&&a.synchronous,runWhen:a?a.runWhen:null}),this.handlers.length-1}eject(n){this.handlers[n]&&(this.handlers[n]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(n){_t.forEach(this.handlers,function(i){i!==null&&n(i)})}},s4={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},IN={exports:{}},D9=br,P9=Oe,M9=$a.f;D9({target:"Object",stat:!0,forced:Object.defineProperty!==M9,sham:!P9},{defineProperty:M9});var PR=Sn.Object,k9=IN.exports=function(n,i,a){return PR.defineProperty(n,i,a)};PR.defineProperty.sham&&(k9.sham=!0);var AN=T(IN.exports),x9=TypeError,U9=go,j9=gp,V9=ar,B9=Ai("species"),o4=Array,UH=function(n){var i;return U9(n)&&(i=n.constructor,(j9(i)&&(i===o4||U9(i.prototype))||V9(i)&&(i=i[B9])===null)&&(i=void 0)),i===void 0?o4:i},F9=function(n,i){return new(UH(n))(i===0?0:i)},G9=I,z9=ko,jH=Ai("species"),c4=function(n){return z9>=51||!G9(function(){var i=[];return(i.constructor={})[jH]=function(){return{foo:1}},i[n](Boolean).foo!==1})},VH=br,H9=I,BH=go,FH=ar,GH=Tu,W9=Df,Y9=function(n){if(n>9007199254740991)throw x9("Maximum allowed index exceeded");return n},l4=Fd,zH=F9,HH=c4,WH=ko,d4=Ai("isConcatSpreadable"),YH=WH>=51||!H9(function(){var n=[];return n[d4]=!1,n.concat()[0]!==n}),KH=function(n){if(!FH(n))return!1;var i=n[d4];return i!==void 0?!!i:BH(n)};VH({target:"Array",proto:!0,forced:!YH||!HH("concat")},{concat:function(n){var i,a,c,u,_,S=GH(this),C=zH(S,0),R=0;for(i=-1,c=arguments.length;i<c;i++)if(KH(_=i===-1?S:arguments[i]))for(u=W9(_),Y9(R+u),a=0;a<u;a++,R++)a in _&&l4(C,R,_[a]);else Y9(R+1),l4(C,R++,_);return C.length=R,C}});var K9={},qH=Te,JH=dr,q9=ep.f,J9=Zv,u4=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];K9.f=function(n){return u4&&qH(n)=="Window"?function(i){try{return q9(i)}catch{return J9(u4)}}(n):q9(JH(n))};var Tb={},XH=Ai;Tb.f=XH;var X9=Sn,Q9=ls,QH=Tb,ZH=$a.f,us=function(n){var i=X9.Symbol||(X9.Symbol={});Q9(i,n)||ZH(i,n,{value:QH.f(n)})},$H=Ge,eW=Tr,Z9=Ai,tW=Gf,f4=function(){var n=eW("Symbol"),i=n&&n.prototype,a=i&&i.valueOf,c=Z9("toPrimitive");i&&!i[c]&&tW(i,c,function(u){return $H(a,this)},{})},bb=Cc,nW=Ht,$9=Tu,rW=Df,iW=F9;K([].push);var aW=function(n){return function(i,a,c,u){for(var _,S,C=$9(i),R=nW(C),e=bb(a,c),t=rW(R),r=0,s=u||iW,l=void 0;t>r;r++)r in R&&(S=e(_=R[r],r,C));return l}},ts={forEach:aW(0)},ON=br,h4=X,p4=Ge,sW=K,dS=Oe,Cb=Su,oW=I,jo=ls,cW=Q,m4=Es,MR=dr,g4=LE,eB=nc,wb=Gt,Rg=Bf,NN=qE,lW=ep,uS=K9,Rb=za,tB=et,vo=$a,dW=np,LN=Ae,kR=Gf,_4=zf,E4=zh,DN=O0,fS=Cy,nB=Ai,uW=Tb,rB=us,fW=f4,iB=Nu,v4=Nd,PN=ts.forEach,gl=Cu("hidden"),xR="Symbol",UR="prototype",S4=v4.set,y4=v4.getterFor(xR),Ju=Object[UR],hS=h4.Symbol,MN=hS&&hS[UR],hW=h4.TypeError,T4=h4.QObject,aB=tB.f,C_=vo.f,jR=uS.f,Ql=LN.f,VR=sW([].push),Wd=E4("symbols"),BR=E4("op-symbols"),sB=E4("wks"),Yd=!T4||!T4[UR]||!T4[UR].findChild,Ig=dS&&oW(function(){return Rg(C_({},"a",{get:function(){return C_(this,"a",{value:7}).a}})).a!=7})?function(n,i,a){var c=aB(Ju,i);c&&delete Ju[i],C_(n,i,a),c&&n!==Ju&&C_(Ju,i,c)}:C_,Ib=function(n,i){var a=Wd[n]=Rg(MN);return S4(a,{type:xR,tag:n,description:i}),dS||(a.description=i),a},kN=function(n,i,a){n===Ju&&kN(BR,i,a),m4(n);var c=g4(i);return m4(a),jo(Wd,c)?(a.enumerable?(jo(n,gl)&&n[gl][c]&&(n[gl][c]=!1),a=Rg(a,{enumerable:wb(0,!1)})):(jo(n,gl)||C_(n,gl,wb(1,{})),n[gl][c]=!0),Ig(n,c,a)):C_(n,c,a)},b4=function(n,i){m4(n);var a=MR(i),c=NN(a).concat(w4(a));return PN(c,function(u){dS&&!p4(xN,a,u)||kN(n,u,a[u])}),n},xN=function(n){var i=g4(n),a=p4(Ql,this,i);return!(this===Ju&&jo(Wd,i)&&!jo(BR,i))&&(!(a||!jo(this,i)||!jo(Wd,i)||jo(this,gl)&&this[gl][i])||a)},C4=function(n,i){var a=MR(n),c=g4(i);if(a!==Ju||!jo(Wd,c)||jo(BR,c)){var u=aB(a,c);return!u||!jo(Wd,c)||jo(a,gl)&&a[gl][c]||(u.enumerable=!0),u}},w_=function(n){var i=jR(MR(n)),a=[];return PN(i,function(c){jo(Wd,c)||jo(DN,c)||VR(a,c)}),a},w4=function(n){var i=n===Ju,a=jR(i?BR:MR(n)),c=[];return PN(a,function(u){!jo(Wd,u)||i&&!jo(Ju,u)||VR(c,Wd[u])}),c};Cb||(hS=function(){if(cW(MN,this))throw hW("Symbol is not a constructor");var n=arguments.length&&arguments[0]!==void 0?eB(arguments[0]):void 0,i=fS(n),a=function(c){this===Ju&&p4(a,BR,c),jo(this,gl)&&jo(this[gl],i)&&(this[gl][i]=!1),Ig(this,i,wb(1,c))};return dS&&Yd&&Ig(Ju,i,{configurable:!0,set:a}),Ib(i,n)},kR(MN=hS[UR],"toString",function(){return y4(this).tag}),kR(hS,"withoutSetter",function(n){return Ib(fS(n),n)}),LN.f=xN,vo.f=kN,dW.f=b4,tB.f=C4,lW.f=uS.f=w_,Rb.f=w4,uW.f=function(n){return Ib(nB(n),n)},dS&&_4(MN,"description",{configurable:!0,get:function(){return y4(this).description}})),ON({global:!0,wrap:!0,forced:!Cb,sham:!Cb},{Symbol:hS}),PN(NN(sB),function(n){rB(n)}),ON({target:xR,stat:!0,forced:!Cb},{useSetter:function(){Yd=!0},useSimple:function(){Yd=!1}}),ON({target:"Object",stat:!0,forced:!Cb,sham:!dS},{create:function(n,i){return i===void 0?Rg(n):b4(Rg(n),i)},defineProperty:kN,defineProperties:b4,getOwnPropertyDescriptor:C4}),ON({target:"Object",stat:!0,forced:!Cb},{getOwnPropertyNames:w_}),fW(),iB(hS,xR),DN[gl]=!0;var oB=Su&&!!Symbol.for&&!!Symbol.keyFor,cB=br,Ag=Tr,FR=ls,pW=nc,UN=zh,lB=oB,GR=UN("string-to-symbol-registry"),R4=UN("symbol-to-string-registry");cB({target:"Symbol",stat:!0,forced:!lB},{for:function(n){var i=pW(n);if(FR(GR,i))return GR[i];var a=Ag("Symbol")(i);return GR[i]=a,R4[a]=i,a}});var jN=br,I4=ls,dB=Fh,uB=er,fB=oB,A4=zh("symbol-to-string-registry");jN({target:"Symbol",stat:!0,forced:!fB},{keyFor:function(n){if(!dB(n))throw TypeError(uB(n)+" is not a symbol");if(I4(A4,n))return A4[n]}});var O4=go,mW=$e,hB=Te,gW=nc,pB=K([].push),mB=br,gB=Tr,VN=ue,_W=Ge,zR=K,_B=I,EB=$e,vB=Fh,SB=_p,yB=function(n){if(mW(n))return n;if(O4(n)){for(var i=n.length,a=[],c=0;c<i;c++){var u=n[c];typeof u=="string"?pB(a,u):typeof u!="number"&&hB(u)!="Number"&&hB(u)!="String"||pB(a,gW(u))}var _=a.length,S=!0;return function(C,R){if(S)return S=!1,R;if(O4(this))return R;for(var e=0;e<_;e++)if(a[e]===C)return R}}},TB=Su,EW=String,Og=gB("JSON","stringify"),BN=zR(/./.exec),N4=zR("".charAt),vW=zR("".charCodeAt),bB=zR("".replace),CB=zR(1 .toString),SW=/[\uD800-\uDFFF]/g,Ab=/^[\uD800-\uDBFF]$/,L4=/^[\uDC00-\uDFFF]$/,D4=!TB||_B(function(){var n=gB("Symbol")();return Og([n])!="[null]"||Og({a:n})!="{}"||Og(Object(n))!="{}"}),P4=_B(function(){return Og("\uDF06\uD834")!=='"\\udf06\\ud834"'||Og("\uDEAD")!=='"\\udead"'}),wB=function(n,i){var a=SB(arguments),c=yB(i);if(EB(c)||n!==void 0&&!vB(n))return a[1]=function(u,_){if(EB(c)&&(_=_W(c,this,EW(u),_)),!vB(_))return _},VN(Og,null,a)},yW=function(n,i,a){var c=N4(a,i-1),u=N4(a,i+1);return BN(Ab,n)&&!BN(L4,u)||BN(L4,n)&&!BN(Ab,c)?"\\u"+CB(vW(n,0),16):n};Og&&mB({target:"JSON",stat:!0,forced:D4||P4},{stringify:function(n,i,a){var c=SB(arguments),u=VN(D4?wB:Og,null,c);return P4&&typeof u=="string"?bB(u,SW,yW):u}});var RB=za,TW=Tu;br({target:"Object",stat:!0,forced:!Su||I(function(){RB.f(1)})},{getOwnPropertySymbols:function(n){var i=RB.f;return i?i(TW(n)):[]}}),us("asyncIterator"),us("hasInstance"),us("isConcatSpreadable"),us("iterator"),us("match"),us("matchAll"),us("replace"),us("search"),us("species"),us("split");var R_=f4;us("toPrimitive"),R_();var FN=Tr,IB=Nu;us("toStringTag"),IB(FN("Symbol"),"Symbol"),us("unscopables"),Nu(X.JSON,"JSON",!0);var bW=Sn.Symbol,CW=Ai,wW=$a.f,AB=CW("metadata"),M4=Function.prototype;M4[AB]===void 0&&wW(M4,AB,{value:null}),us("dispose"),us("metadata");var OB=bW;us("asyncDispose");var NB=K,GN=Tr("Symbol"),RW=GN.keyFor,IW=NB(GN.prototype.valueOf),k4=GN.isRegisteredSymbol||function(n){try{return RW(IW(n))!==void 0}catch{return!1}};br({target:"Symbol",stat:!0},{isRegisteredSymbol:k4});for(var AW=zh,LB=Tr,OW=K,NW=Fh,LW=Ai,zN=LB("Symbol"),DB=zN.isWellKnownSymbol,x4=LB("Object","getOwnPropertyNames"),PB=OW(zN.prototype.valueOf),MB=AW("wks"),U4=0,HN=x4(zN),DW=HN.length;U4<DW;U4++)try{var kB=HN[U4];NW(zN[kB])&&LW(kB)}catch{}var j4=function(n){if(DB&&DB(n))return!0;try{for(var i=PB(n),a=0,c=x4(MB),u=c.length;a<u;a++)if(MB[c[a]]==i)return!0}catch{}return!1};br({target:"Symbol",stat:!0,forced:!0},{isWellKnownSymbol:j4}),us("matcher"),us("observable"),br({target:"Symbol",stat:!0},{isRegistered:k4}),br({target:"Symbol",stat:!0,forced:!0},{isWellKnown:j4}),us("metadataKey"),us("patternMatch"),us("replaceAll");var Ob=T(OB),V4=T(Tb.f("iterator"));function HR(n){return HR=typeof Ob=="function"&&typeof V4=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Ob=="function"&&i.constructor===Ob&&i!==Ob.prototype?"symbol":typeof i},HR(n)}var PW=T(Tb.f("toPrimitive"));function MW(n){var i=function(a,c){if(HR(a)!=="object"||a===null)return a;var u=a[PW];if(u!==void 0){var _=u.call(a,c);if(HR(_)!=="object")return _;throw new TypeError("@@toPrimitive must return a primitive value.")}return(c==="string"?String:Number)(a)}(n,"string");return HR(i)==="symbol"?i:String(i)}function re(n,i,a){return(i=MW(i))in n?AN(n,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):n[i]=a,n}var B4=T(Dz),xB={isBrowser:!0,classes:{URLSearchParams:B4!==void 0?B4:yb,FormData:typeof FormData<"u"?FormData:null,Blob:typeof Blob<"u"?Blob:null},protocols:["http","https","file","blob","url","data"]};let F4=typeof window<"u"&&typeof document<"u",WN=typeof navigator=="object"&&navigator||void 0,G4=F4&&(!WN||["ReactNative","NativeScript","NS"].indexOf(WN.product)<0),UB=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",kW=F4&&window.location.href||"http://localhost";function z4(n,i){var a=Object.keys(n);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(n);i&&(c=c.filter(function(u){return Object.getOwnPropertyDescriptor(n,u).enumerable})),a.push.apply(a,c)}return a}function H4(n){for(var i=1;i<arguments.length;i++){var a=arguments[i]!=null?arguments[i]:{};i%2?z4(Object(a),!0).forEach(function(c){re(n,c,a[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(a)):z4(Object(a)).forEach(function(c){Object.defineProperty(n,c,Object.getOwnPropertyDescriptor(a,c))})}return n}var Vs=H4(H4({},Object.freeze({__proto__:null,hasBrowserEnv:F4,hasStandardBrowserEnv:G4,hasStandardBrowserWebWorkerEnv:UB,navigator:WN,origin:kW})),xB),jB=Es,WR=Ge,xW=ls,UW=Q,ne=function(){var n=jB(this),i="";return n.hasIndices&&(i+="d"),n.global&&(i+="g"),n.ignoreCase&&(i+="i"),n.multiline&&(i+="m"),n.dotAll&&(i+="s"),n.unicode&&(i+="u"),n.unicodeSets&&(i+="v"),n.sticky&&(i+="y"),i},W4=RegExp.prototype,VB=function(n){var i=n.flags;return i!==void 0||"flags"in W4||xW(n,"flags")||!UW(W4,n)?i:WR(ne,n)},Y4=Ap.charAt,YN=Ge,jW=Es,VW=$e,BW=Te,BB=/./.exec,FB=TypeError,xc=br,GB=Ge,zB=he,FW=fT,KN=_v,HB=oi,K4=DC,Nb=nc,GW=Es,WB=Jt,zW=Te,HW=xC,YB=VB,WW=Rm,YW=I,KW=dl,KB=function(n,i,a){return i+(a?Y4(n,i).length:1)},qB=function(n,i){var a=n.exec;if(VW(a)){var c=YN(a,n,i);return c!==null&&jW(c),c}if(BW(n)==="RegExp")return YN(BB,n,i);throw FB("RegExp#exec called on incompatible receiver")},JB=Nd,qN=Ai("matchAll"),q4="RegExp String",J4=q4+" Iterator",YR=JB.set,qW=JB.getterFor(J4),JW=TypeError,X4=zB("".indexOf),JN=zB("".matchAll),XN=!!JN&&!YW(function(){JN("a",/./)}),XW=FW(function(n,i,a,c){YR(this,{type:J4,regexp:n,string:i,global:a,unicode:c,done:!1})},q4,function(){var n=qW(this);if(n.done)return KN(void 0,!0);var i=n.regexp,a=n.string,c=qB(i,a);return c===null?(n.done=!0,KN(void 0,!0)):n.global?(Nb(c[0])===""&&(i.lastIndex=KB(a,K4(i.lastIndex),n.unicode)),KN(c,!1)):(n.done=!0,KN(c,!1))}),XB=function(n){var i,a,c,u=GW(this),_=Nb(n),S=KW(u,RegExp),C=Nb(YB(u));return i=new S(S===RegExp?u.source:u,C),a=!!~X4(C,"g"),c=!!~X4(C,"u"),i.lastIndex=K4(u.lastIndex),new XW(i,_,a,c)};xc({target:"String",proto:!0,forced:XN},{matchAll:function(n){var i,a,c,u,_=HB(this);if(WB(n)){if(XN)return JN(_,n)}else{if(HW(n)&&(i=Nb(HB(YB(n))),!~X4(i,"g")))throw JW("`.matchAll` does not allow non-global regexes");if(XN)return JN(_,n);if((c=WW(n,qN))===void 0&&zW(n)=="RegExp"&&(c=XB),c)return GB(c,n,_)}return a=Nb(_),u=new RegExp(n,"g"),GB(XB,u,a)}});var QW=tc("String").matchAll,ZW=Q,$W=QW,QN=String.prototype,eY=function(n){var i=n.matchAll;return typeof n=="string"||n===QN||ZW(QN,n)&&i===QN.matchAll?$W:i},QB=T(eY);function Q4(n){function i(a,c,u,_){let S=a[_++];if(S==="__proto__")return!0;let C=Number.isFinite(+S),R=_>=a.length;return S=!S&&_t.isArray(u)?u.length:S,R?(_t.hasOwnProp(u,S)?u[S]=[u[S],c]:u[S]=c,!C):(u[S]&&_t.isObject(u[S])||(u[S]=[]),i(a,c,u[S],_)&&_t.isArray(u[S])&&(u[S]=function(e){let t={},r=Object.keys(e),s,l=r.length,f;for(s=0;s<l;s++)f=r[s],t[f]=e[f];return t}(u[S])),!C)}if(_t.isFormData(n)&&_t.isFunction(n.entries)){let a={};return _t.forEachEntry(n,(c,u)=>{i(function(_){return QB(_t).call(_t,/\w+|\[(\w*)]/g,_).map(S=>S[0]==="[]"?"":S[1]||S[0])}(c),u,a,0)}),a}return null}let Z4={transitional:s4,adapter:["xhr","http","fetch"],transformRequest:[function(n,i){let a=i.getContentType()||"",c=a.indexOf("application/json")>-1,u=_t.isObject(n);if(u&&_t.isHTMLForm(n)&&(n=new FormData(n)),_t.isFormData(n))return c?JSON.stringify(Q4(n)):n;if(_t.isArrayBuffer(n)||_t.isBuffer(n)||_t.isStream(n)||_t.isFile(n)||_t.isBlob(n)||_t.isReadableStream(n))return n;if(_t.isArrayBufferView(n))return n.buffer;if(_t.isURLSearchParams(n))return i.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),n.toString();let _;if(u){if(a.indexOf("application/x-www-form-urlencoded")>-1)return function(S,C){return DR(S,new Vs.classes.URLSearchParams,Object.assign({visitor:function(R,e,t,r){return Vs.isNode&&_t.isBuffer(R)?(this.append(e,R.toString("base64")),!1):r.defaultVisitor.apply(this,arguments)}},C))}(n,this.formSerializer).toString();if((_=_t.isFileList(n))||a.indexOf("multipart/form-data")>-1){let S=this.env&&this.env.FormData;return DR(_?{"files[]":n}:n,S&&new S,this.formSerializer)}}return u||c?(i.setContentType("application/json",!1),function(S,C,R){if(_t.isString(S))try{return(C||JSON.parse)(S),js(_t).call(_t,S)}catch(e){if(e.name!=="SyntaxError")throw e}return(R||JSON.stringify)(S)}(n)):n}],transformResponse:[function(n){let i=this.transitional||Z4.transitional,a=i&&i.forcedJSONParsing,c=this.responseType==="json";if(_t.isResponse(n)||_t.isReadableStream(n))return n;if(n&&_t.isString(n)&&(a&&!this.responseType||c)){let u=!(i&&i.silentJSONParsing)&&c;try{return JSON.parse(n)}catch(_){if(u)throw _.name==="SyntaxError"?Mr.from(_,Mr.ERR_BAD_RESPONSE,this,null,this.response):_}}return n}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Vs.classes.FormData,Blob:Vs.classes.Blob},validateStatus:function(n){return n>=200&&n<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};_t.forEach(["delete","get","head","post","put","patch"],n=>{Z4.headers[n]={}});var $4=Z4;let tY=_t.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),ZN=Symbol("internals");function I_(n){var i;return n&&js(i=String(n)).call(i).toLowerCase()}function Lb(n){return n===!1||n==null?n:_t.isArray(n)?n.map(Lb):String(n)}function ex(n,i,a,c,u){return _t.isFunction(c)?c.call(this,i,a):(u&&(i=a),_t.isString(i)?_t.isString(c)?i.indexOf(c)!==-1:_t.isRegExp(c)?c.test(i):void 0:void 0)}class KR{constructor(i){i&&this.set(i)}set(i,a,c){let u=this;function _(R,e,t){let r=I_(e);if(!r)throw new Error("header name must be a non-empty string");let s=_t.findKey(u,r);(!s||u[s]===void 0||t===!0||t===void 0&&u[s]!==!1)&&(u[s||e]=Lb(R))}let S=(R,e)=>_t.forEach(R,(t,r)=>_(t,r,e));if(_t.isPlainObject(i)||i instanceof this.constructor)S(i,a);else if(_t.isString(i)&&(i=js(i).call(i))&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(js(C=i).call(C)))S((R=>{let e={},t,r,s;return R&&R.split(`
`).forEach(function(l){var f,m;s=l.indexOf(":"),t=js(f=l.substring(0,s)).call(f).toLowerCase(),r=js(m=l.substring(s+1)).call(m),!t||e[t]&&tY[t]||(t==="set-cookie"?e[t]?e[t].push(r):e[t]=[r]:e[t]=e[t]?e[t]+", "+r:r)}),e})(i),a);else if(_t.isHeaders(i))for(let[R,e]of i.entries())_(e,R,c);else i!=null&&_(a,i,c);var C;return this}get(i,a){if(i=I_(i)){let c=_t.findKey(this,i);if(c){let u=this[c];if(!a)return u;if(a===!0)return function(_){let S=Object.create(null),C=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g,R;for(;R=C.exec(_);)S[R[1]]=R[2];return S}(u);if(_t.isFunction(a))return a.call(this,u,c);if(_t.isRegExp(a))return a.exec(u);throw new TypeError("parser must be boolean|regexp|function")}}}has(i,a){if(i=I_(i)){let c=_t.findKey(this,i);return!(!c||this[c]===void 0||a&&!ex(0,this[c],c,a))}return!1}delete(i,a){let c=this,u=!1;function _(S){if(S=I_(S)){let C=_t.findKey(c,S);!C||a&&!ex(0,c[C],C,a)||(delete c[C],u=!0)}}return _t.isArray(i)?i.forEach(_):_(i),u}clear(i){let a=Object.keys(this),c=a.length,u=!1;for(;c--;){let _=a[c];i&&!ex(0,this[_],_,i,!0)||(delete this[_],u=!0)}return u}normalize(i){let a=this,c={};return _t.forEach(this,(u,_)=>{var S;let C=_t.findKey(c,_);if(C)return a[C]=Lb(u),void delete a[_];let R=i?function(e){return js(e).call(e).toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,s)=>r.toUpperCase()+s)}(_):js(S=String(_)).call(S);R!==_&&delete a[_],a[R]=Lb(u),c[R]=!0}),this}concat(){for(var i=arguments.length,a=new Array(i),c=0;c<i;c++)a[c]=arguments[c];return this.constructor.concat(this,...a)}toJSON(i){let a=Object.create(null);return _t.forEach(this,(c,u)=>{c!=null&&c!==!1&&(a[u]=i&&_t.isArray(c)?c.join(", "):c)}),a}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(i=>{let[a,c]=i;return a+": "+c}).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(i){return i instanceof this?i:new this(i)}static concat(i){let a=new this(i);for(var c=arguments.length,u=new Array(c>1?c-1:0),_=1;_<c;_++)u[_-1]=arguments[_];return u.forEach(S=>a.set(S)),a}static accessor(i){let a=(this[ZN]=this[ZN]={accessors:{}}).accessors,c=this.prototype;function u(_){let S=I_(_);a[S]||(function(C,R){let e=_t.toCamelCase(" "+R);["get","set","has"].forEach(t=>{Object.defineProperty(C,t+e,{value:function(r,s,l){return this[t].call(this,R,r,s,l)},configurable:!0})})}(c,_),a[S]=!0)}return _t.isArray(i)?i.forEach(u):u(i),this}}KR.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),_t.reduceDescriptors(KR.prototype,(n,i)=>{let{value:a}=n,c=i[0].toUpperCase()+i.slice(1);return{get:()=>a,set(u){this[c]=u}}}),_t.freezeMethods(KR);var lh=KR;function tx(n,i){let a=this||$4,c=i||a,u=lh.from(c.headers),_=c.data;return _t.forEach(n,function(S){_=S.call(a,_,u.normalize(),i?i.status:void 0)}),u.normalize(),_}function ZB(n){return!(!n||!n.__CANCEL__)}function A_(n,i,a){Mr.call(this,n??"canceled",Mr.ERR_CANCELED,i,a),this.name="CanceledError"}function $B(n,i,a){let c=a.config.validateStatus;a.status&&c&&!c(a.status)?i(new Mr("Request failed with status code "+a.status,[Mr.ERR_BAD_REQUEST,Mr.ERR_BAD_RESPONSE][Math.floor(a.status/100)-4],a.config,a.request,a)):n(a)}_t.inherits(A_,Mr,{__CANCEL__:!0});let $N=function(n,i){let a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:3,c=0,u=function(_,S){_=_||10;let C=new Array(_),R=new Array(_),e,t=0,r=0;return S=S!==void 0?S:1e3,function(s){let l=Date.now(),f=R[r];e||(e=l),C[t]=s,R[t]=l;let m=r,E=0;for(;m!==t;)E+=C[m++],m%=_;if(t=(t+1)%_,t===r&&(r=(r+1)%_),l-e<S)return;let y=f&&l-f;return y?Math.round(1e3*E/y):void 0}}(50,250);return function(_,S){let C,R,e=0,t=1e3/S,r=function(s){e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Date.now(),C=null,R&&(clearTimeout(R),R=null),_.apply(null,s)};return[function(){let s=Date.now(),l=s-e;for(var f=arguments.length,m=new Array(f),E=0;E<f;E++)m[E]=arguments[E];l>=t?r(m,s):(C=m,R||(R=setTimeout(()=>{R=null,r(C)},t-l)))},()=>C&&r(C)]}(_=>{let S=_.loaded,C=_.lengthComputable?_.total:void 0,R=S-c,e=u(R);c=S,n({loaded:S,total:C,progress:C?S/C:void 0,bytes:R,rate:e||void 0,estimated:e&&C&&S<=C?(C-S)/e:void 0,event:_,lengthComputable:C!=null,[i?"download":"upload"]:!0})},a)},nx=(n,i)=>{let a=n!=null;return[c=>i[0]({lengthComputable:a,total:n,loaded:c}),i[1]]},eL=n=>function(){for(var i=arguments.length,a=new Array(i),c=0;c<i;c++)a[c]=arguments[c];return _t.asap(()=>n(...a))};var rx=Vs.hasStandardBrowserEnv?((n,i)=>a=>(a=new XO(a,Vs.origin),n.protocol===a.protocol&&n.host===a.host&&(i||n.port===a.port)))(new XO(Vs.origin),Vs.navigator&&/(msie|trident)/i.test(Vs.navigator.userAgent)):()=>!0,nY=Vs.hasStandardBrowserEnv?{write(n,i,a,c,u,_){let S=[n+"="+encodeURIComponent(i)];_t.isNumber(a)&&S.push("expires="+new Date(a).toGMTString()),_t.isString(c)&&S.push("path="+c),_t.isString(u)&&S.push("domain="+u),_===!0&&S.push("secure"),document.cookie=S.join("; ")},read(n){let i=document.cookie.match(new RegExp("(^|;\\s*)("+n+")=([^;]*)"));return i?decodeURIComponent(i[3]):null},remove(n){this.write(n,"",Date.now()-864e5)}}:{write(){},read:()=>null,remove(){}};function ix(n,i){return n&&!function(a){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(a)}(i)?function(a,c){return c?a.replace(/\/?\/$/,"")+"/"+c.replace(/^\/+/,""):a}(n,i):i}function Db(n,i){var a=Object.keys(n);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(n);i&&(c=c.filter(function(u){return Object.getOwnPropertyDescriptor(n,u).enumerable})),a.push.apply(a,c)}return a}let qR=n=>n instanceof lh?function(i){for(var a=1;a<arguments.length;a++){var c=arguments[a]!=null?arguments[a]:{};a%2?Db(Object(c),!0).forEach(function(u){re(i,u,c[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(c)):Db(Object(c)).forEach(function(u){Object.defineProperty(i,u,Object.getOwnPropertyDescriptor(c,u))})}return i}({},n):n;function Ng(n,i){i=i||{};let a={};function c(e,t,r,s){return _t.isPlainObject(e)&&_t.isPlainObject(t)?_t.merge.call({caseless:s},e,t):_t.isPlainObject(t)?_t.merge({},t):_t.isArray(t)?t.slice():t}function u(e,t,r,s){return _t.isUndefined(t)?_t.isUndefined(e)?void 0:c(void 0,e,0,s):c(e,t,0,s)}function _(e,t){if(!_t.isUndefined(t))return c(void 0,t)}function S(e,t){return _t.isUndefined(t)?_t.isUndefined(e)?void 0:c(void 0,e):c(void 0,t)}function C(e,t,r){return r in i?c(e,t):r in n?c(void 0,e):void 0}let R={url:_,method:_,data:_,baseURL:S,transformRequest:S,transformResponse:S,paramsSerializer:S,timeout:S,timeoutMessage:S,withCredentials:S,withXSRFToken:S,adapter:S,responseType:S,xsrfCookieName:S,xsrfHeaderName:S,onUploadProgress:S,onDownloadProgress:S,decompress:S,maxContentLength:S,maxBodyLength:S,beforeRedirect:S,transport:S,httpAgent:S,httpsAgent:S,cancelToken:S,socketPath:S,responseEncoding:S,validateStatus:C,headers:(e,t,r)=>u(qR(e),qR(t),0,!0)};return _t.forEach(Object.keys(Object.assign({},n,i)),function(e){let t=R[e]||u,r=t(n[e],i[e],e);_t.isUndefined(r)&&t!==C||(a[e]=r)}),a}var JR=n=>{let i=Ng({},n),a,{data:c,withXSRFToken:u,xsrfHeaderName:_,xsrfCookieName:S,headers:C,auth:R}=i;if(i.headers=C=lh.from(C),i.url=Dr(ix(i.baseURL,i.url),n.params,n.paramsSerializer),R&&C.set("Authorization","Basic "+btoa((R.username||"")+":"+(R.password?unescape(encodeURIComponent(R.password)):""))),_t.isFormData(c)){if(Vs.hasStandardBrowserEnv||Vs.hasStandardBrowserWebWorkerEnv)C.setContentType(void 0);else if((a=C.getContentType())!==!1){let[e,...t]=a?a.split(";").map(r=>js(r).call(r)).filter(Boolean):[];C.setContentType([e||"multipart/form-data",...t].join("; "))}}if(Vs.hasStandardBrowserEnv&&(u&&_t.isFunction(u)&&(u=u(i)),u||u!==!1&&rx(i.url))){let e=_&&S&&nY.read(S);e&&C.set(_,e)}return i},dh=typeof XMLHttpRequest<"u"&&function(n){return new Et(function(i,a){let c=JR(n),u=c.data,_=lh.from(c.headers).normalize(),S,C,R,e,t,{responseType:r,onUploadProgress:s,onDownloadProgress:l}=c;function f(){e&&e(),t&&t(),c.cancelToken&&c.cancelToken.unsubscribe(S),c.signal&&c.signal.removeEventListener("abort",S)}let m=new XMLHttpRequest;function E(){if(!m)return;let b=lh.from("getAllResponseHeaders"in m&&m.getAllResponseHeaders());$B(function(A){i(A),f()},function(A){a(A),f()},{data:r&&r!=="text"&&r!=="json"?m.response:m.responseText,status:m.status,statusText:m.statusText,headers:b,config:n,request:m}),m=null}m.open(c.method.toUpperCase(),c.url,!0),m.timeout=c.timeout,"onloadend"in m?m.onloadend=E:m.onreadystatechange=function(){m&&m.readyState===4&&(m.status!==0||m.responseURL&&m.responseURL.indexOf("file:")===0)&&setTimeout(E)},m.onabort=function(){m&&(a(new Mr("Request aborted",Mr.ECONNABORTED,n,m)),m=null)},m.onerror=function(){a(new Mr("Network Error",Mr.ERR_NETWORK,n,m)),m=null},m.ontimeout=function(){let b=c.timeout?"timeout of "+c.timeout+"ms exceeded":"timeout exceeded",A=c.transitional||s4;c.timeoutErrorMessage&&(b=c.timeoutErrorMessage),a(new Mr(b,A.clarifyTimeoutError?Mr.ETIMEDOUT:Mr.ECONNABORTED,n,m)),m=null},u===void 0&&_.setContentType(null),"setRequestHeader"in m&&_t.forEach(_.toJSON(),function(b,A){m.setRequestHeader(A,b)}),_t.isUndefined(c.withCredentials)||(m.withCredentials=!!c.withCredentials),r&&r!=="json"&&(m.responseType=c.responseType),l&&([R,t]=$N(l,!0),m.addEventListener("progress",R)),s&&m.upload&&([C,e]=$N(s),m.upload.addEventListener("progress",C),m.upload.addEventListener("loadend",e)),(c.cancelToken||c.signal)&&(S=b=>{m&&(a(!b||b.type?new A_(null,n,m):b),m.abort(),m=null)},c.cancelToken&&c.cancelToken.subscribe(S),c.signal&&(c.signal.aborted?S():c.signal.addEventListener("abort",S)));let y=function(b){let A=/^([-+\w]{1,25})(:?\/\/|:)/.exec(b);return A&&A[1]||""}(c.url);y&&Vs.protocols.indexOf(y)===-1?a(new Mr("Unsupported protocol "+y+":",Mr.ERR_BAD_REQUEST,n)):m.send(u||null)})},ax=(n,i)=>{let{length:a}=n=n?n.filter(Boolean):[];if(i||a){let c,u=new AbortController,_=function(e){if(!c){c=!0,C();let t=e instanceof Error?e:this.reason;u.abort(t instanceof Mr?t:new A_(t instanceof Error?t.message:t))}},S=i&&setTimeout(()=>{S=null,_(new Mr("timeout ".concat(i," of ms exceeded"),Mr.ETIMEDOUT))},i),C=()=>{n&&(S&&clearTimeout(S),S=null,n.forEach(e=>{e.unsubscribe?e.unsubscribe(_):e.removeEventListener("abort",_)}),n=null)};n.forEach(e=>e.addEventListener("abort",_));let{signal:R}=u;return R.unsubscribe=()=>_t.asap(C),R}},e8=u_,Pb=ju;br({target:"Promise",stat:!0,forced:!0},{withResolvers:function(){var n=Pb.f(this);return{promise:n.promise,resolve:n.resolve,reject:n.reject}}});var t8=ju,tL=xu;br({target:"Promise",stat:!0,forced:!0},{try:function(n){var i=t8.f(this),a=tL(n);return(a.error?i.reject:i.resolve)(a.value),i.promise}});var nL=T(e8),sx=Tb.f("asyncIterator"),rY=T(sx);function ox(n,i){this.v=n,this.k=i}function Mb(n){var i,a;function c(_,S){try{var C=n[_](S),R=C.value,e=R instanceof ox;nL.resolve(e?R.v:R).then(function(t){if(e){var r=_==="return"?"return":"next";if(!R.k||t.done)return c(r,t);t=n[r](t).value}u(C.done?"return":"normal",t)},function(t){c("throw",t)})}catch(t){u("throw",t)}}function u(_,S){switch(_){case"return":i.resolve({value:S,done:!0});break;case"throw":i.reject(S);break;default:i.resolve({value:S,done:!1})}(i=i.next)?c(i.key,i.arg):a=null}this._invoke=function(_,S){return new nL(function(C,R){var e={key:_,arg:S,resolve:C,reject:R,next:null};a?a=a.next=e:(i=a=e,c(_,S))})},typeof n.return!="function"&&(this.return=void 0)}function Zl(n){return function(){return new Mb(n.apply(this,arguments))}}function Kn(n){return new ox(n,0)}function kp(n){var i={},a=!1;function c(u,_){return a=!0,{done:!1,value:new ox(_=new nL(function(S){S(n[u](_))}),1)}}return i[Ob!==void 0&&V4||"@@iterator"]=function(){return this},i.next=function(u){return a?(a=!1,u):c("next",u)},typeof n.throw=="function"&&(i.throw=function(u){if(a)throw a=!1,u;return c("throw",u)}),typeof n.return=="function"&&(i.return=function(u){return a?(a=!1,u):c("return",u)}),i}Mb.prototype[typeof Ob=="function"&&rY||"@@asyncIterator"]=function(){return this},Mb.prototype.next=function(n){return this._invoke("next",n)},Mb.prototype.throw=function(n){return this._invoke("throw",n)},Mb.prototype.return=function(n){return this._invoke("return",n)};var rL=T(sx);function cx(n){var i,a,c,u=2;for(typeof Symbol<"u"&&(a=rL,c=Symbol.iterator);u--;){if(a&&(i=n[a])!=null)return i.call(n);if(c&&(i=n[c])!=null)return new iL(i.call(n));a="@@asyncIterator",c="@@iterator"}throw new TypeError("Object is not async iterable")}function iL(n){function i(a){if(Object(a)!==a)return Et.reject(new TypeError(a+" is not an object."));var c=a.done;return Et.resolve(a.value).then(function(u){return{value:u,done:c}})}return iL=function(a){this.s=a,this.n=a.next},iL.prototype={s:null,n:null,next:function(){return i(this.n.apply(this.s,arguments))},return:function(a){var c=this.s.return;return c===void 0?Et.resolve({value:a,done:!0}):i(c.apply(this.s,arguments))},throw:function(a){var c=this.s.return;return c===void 0?Et.reject(a):i(c.apply(this.s,arguments))}},new iL(n)}let lx=function*(n,i){let a=n.byteLength;if(!i||a<i)return void(yield n);let c,u=0;for(;u<a;)c=u+i,yield n.slice(u,c),u=c},n8=function(){var n=Zl(function*(i,a){var c,u=!1,_=!1;try{for(var S,C=cx(iY(i));u=!(S=yield Kn(C.next())).done;u=!1){let R=S.value;yield*kp(cx(lx(R,a)))}}catch(R){_=!0,c=R}finally{try{u&&C.return!=null&&(yield Kn(C.return()))}finally{if(_)throw c}}});return function(i,a){return n.apply(this,arguments)}}(),iY=function(){var n=Zl(function*(i){if(i[rL])return void(yield*kp(cx(i)));let a=i.getReader();try{for(;;){let{done:c,value:u}=yield Kn(a.read());if(c)break;yield u}}finally{yield Kn(a.cancel())}});return function(i){return n.apply(this,arguments)}}(),aL=(n,i,a,c)=>{let u=n8(n,i),_,S=0,C=R=>{_||(_=!0,c&&c(R))};return new ReadableStream({async pull(R){try{let{done:e,value:t}=await u.next();if(e)return C(),void R.close();let r=t.byteLength;if(a){let s=S+=r;a(s)}R.enqueue(new Uint8Array(t))}catch(e){throw C(e),e}},cancel:R=>(C(R),u.return())},{highWaterMark:2})};function $l(n,i){var a=Object.keys(n);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(n);i&&(c=c.filter(function(u){return Object.getOwnPropertyDescriptor(n,u).enumerable})),a.push.apply(a,c)}return a}function kb(n){for(var i=1;i<arguments.length;i++){var a=arguments[i]!=null?arguments[i]:{};i%2?$l(Object(a),!0).forEach(function(c){re(n,c,a[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(a)):$l(Object(a)).forEach(function(c){Object.defineProperty(n,c,Object.getOwnPropertyDescriptor(a,c))})}return n}let xn=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",XR=xn&&typeof ReadableStream=="function",dx=xn&&(typeof TextEncoder=="function"?(sL=new TextEncoder,n=>sL.encode(n)):async n=>new Uint8Array(await new Response(n).arrayBuffer()));var sL;let QR=function(n){try{for(var i=arguments.length,a=new Array(i>1?i-1:0),c=1;c<i;c++)a[c-1]=arguments[c];return!!n(...a)}catch{return!1}},aY=XR&&QR(()=>{let n=!1,i=new Request(Vs.origin,{body:new ReadableStream,method:"POST",get duplex(){return n=!0,"half"}}).headers.has("Content-Type");return n&&!i}),ux=XR&&QR(()=>_t.isReadableStream(new Response("").body)),oL={stream:ux&&(n=>n.body)};var fx;xn&&(fx=new Response,["text","arrayBuffer","blob","formData","stream"].forEach(n=>{!oL[n]&&(oL[n]=_t.isFunction(fx[n])?i=>i[n]():(i,a)=>{throw new Mr("Response type '".concat(n,"' is not supported"),Mr.ERR_NOT_SUPPORT,a)})}));let r8=async(n,i)=>_t.toFiniteNumber(n.getContentLength())??(async c=>c==null?0:_t.isBlob(c)?c.size:_t.isSpecCompliantForm(c)?(await new Request(Vs.origin,{method:"POST",body:c}).arrayBuffer()).byteLength:_t.isArrayBufferView(c)||_t.isArrayBuffer(c)?c.byteLength:(_t.isURLSearchParams(c)&&(c+=""),_t.isString(c)?(await dx(c)).byteLength:void 0))(i);var i8=xn&&(async n=>{let{url:i,method:a,data:c,signal:u,cancelToken:_,timeout:S,onDownloadProgress:C,onUploadProgress:R,responseType:e,headers:t,withCredentials:r="same-origin",fetchOptions:s}=JR(n);e=e?(e+"").toLowerCase():"text";let l,f=ax([u,_&&_.toAbortSignal()],S),m=f&&f.unsubscribe&&(()=>{f.unsubscribe()}),E;try{if(R&&aY&&a!=="get"&&a!=="head"&&(E=await r8(t,c))!==0){let D,P=new Request(i,{method:"POST",body:c,duplex:"half"});if(_t.isFormData(c)&&(D=P.headers.get("content-type"))&&t.setContentType(D),P.body){let[F,B]=nx(E,$N(eL(R)));c=aL(P.body,65536,F,B)}}_t.isString(r)||(r=r?"include":"omit");let y="credentials"in Request.prototype;l=new Request(i,kb(kb({},s),{},{signal:f,method:a.toUpperCase(),headers:t.normalize().toJSON(),body:c,duplex:"half",credentials:y?r:void 0}));let b=await fetch(l),A=ux&&(e==="stream"||e==="response");if(ux&&(C||A&&m)){let D={};["status","statusText","headers"].forEach(Y=>{D[Y]=b[Y]});let P=_t.toFiniteNumber(b.headers.get("content-length")),[F,B]=C&&nx(P,$N(eL(C),!0))||[];b=new Response(aL(b.body,65536,F,()=>{B&&B(),m&&m()}),D)}e=e||"text";let O=await oL[_t.findKey(oL,e)||"text"](b,n);return!A&&m&&m(),await new Et((D,P)=>{$B(D,P,{data:O,headers:lh.from(b.headers),status:b.status,statusText:b.statusText,config:n,request:l})})}catch(y){throw m&&m(),y&&y.name==="TypeError"&&/fetch/i.test(y.message)?Object.assign(new Mr("Network Error",Mr.ERR_NETWORK,n,l),{cause:y.cause||y}):Mr.from(y,y&&y.code,n,l)}});let xb={http:null,xhr:dh,fetch:i8};_t.forEach(xb,(n,i)=>{if(n){try{Object.defineProperty(n,"name",{value:i})}catch{}Object.defineProperty(n,"adapterName",{value:i})}});let hx=n=>"- ".concat(n),sY=n=>_t.isFunction(n)||n===null||n===!1;var px={getAdapter:n=>{n=_t.isArray(n)?n:[n];let{length:i}=n,a,c,u={};for(let _=0;_<i;_++){let S;if(a=n[_],c=a,!sY(a)&&(c=xb[(S=String(a)).toLowerCase()],c===void 0))throw new Mr("Unknown adapter '".concat(S,"'"));if(c)break;u[S||"#"+_]=c}if(!c){let _=Object.entries(u).map(S=>{let[C,R]=S;return"adapter ".concat(C," ")+(R===!1?"is not supported by the environment":"is not available in the build")});throw new Mr("There is no suitable adapter to dispatch the request "+(i?_.length>1?`since :
`+_.map(hx).join(`
`):" "+hx(_[0]):"as no adapter specified"),"ERR_NOT_SUPPORT")}return c},adapters:xb};function cL(n){if(n.cancelToken&&n.cancelToken.throwIfRequested(),n.signal&&n.signal.aborted)throw new A_(null,n)}function a8(n){return cL(n),n.headers=lh.from(n.headers),n.data=tx.call(n,n.transformRequest),["post","put","patch"].indexOf(n.method)!==-1&&n.headers.setContentType("application/x-www-form-urlencoded",!1),px.getAdapter(n.adapter||$4.adapter)(n).then(function(i){return cL(n),i.data=tx.call(n,n.transformResponse,i),i.headers=lh.from(i.headers),i},function(i){return ZB(i)||(cL(n),i&&i.response&&(i.response.data=tx.call(n,n.transformResponse,i.response),i.response.headers=lh.from(i.response.headers))),Et.reject(i)})}let lL="1.7.9",pS={};["object","boolean","number","function","string","symbol"].forEach((n,i)=>{pS[n]=function(a){return typeof a===n||"a"+(i<1?"n ":" ")+n}});let mx={};pS.transitional=function(n,i,a){function c(u,_){return"[Axios v"+lL+"] Transitional option '"+u+"'"+_+(a?". "+a:"")}return(u,_,S)=>{if(n===!1)throw new Mr(c(_," has been removed"+(i?" in "+i:"")),Mr.ERR_DEPRECATED);return i&&!mx[_]&&(mx[_]=!0,console.warn(c(_," has been deprecated since v"+i+" and will be removed in the near future"))),!n||n(u,_,S)}},pS.spelling=function(n){return(i,a)=>(console.warn("".concat(a," is likely a misspelling of ").concat(n)),!0)};var dL={assertOptions:function(n,i,a){if(typeof n!="object")throw new Mr("options must be an object",Mr.ERR_BAD_OPTION_VALUE);let c=Object.keys(n),u=c.length;for(;u-- >0;){let _=c[u],S=i[_];if(S){let C=n[_],R=C===void 0||S(C,_,n);if(R!==!0)throw new Mr("option "+_+" must be "+R,Mr.ERR_BAD_OPTION_VALUE)}else if(a!==!0)throw new Mr("Unknown option "+_,Mr.ERR_BAD_OPTION)}},validators:pS};let xp=dL.validators,Ub=class{constructor(n){this.defaults=n,this.interceptors={request:new a4,response:new a4}}async request(n,i){try{return await this._request(n,i)}catch(a){if(a instanceof Error){let c={};Error.captureStackTrace?Error.captureStackTrace(c):c=new Error;let u=c.stack?c.stack.replace(/^.+\n/,""):"";try{a.stack?u&&!String(a.stack).endsWith(u.replace(/^.+\n.+\n/,""))&&(a.stack+=`
`+u):a.stack=u}catch{}}throw a}}_request(n,i){typeof n=="string"?(i=i||{}).url=n:i=n||{},i=Ng(this.defaults,i);let{transitional:a,paramsSerializer:c,headers:u}=i;a!==void 0&&dL.assertOptions(a,{silentJSONParsing:xp.transitional(xp.boolean),forcedJSONParsing:xp.transitional(xp.boolean),clarifyTimeoutError:xp.transitional(xp.boolean)},!1),c!=null&&(_t.isFunction(c)?i.paramsSerializer={serialize:c}:dL.assertOptions(c,{encode:xp.function,serialize:xp.function},!0)),dL.assertOptions(i,{baseUrl:xp.spelling("baseURL"),withXsrfToken:xp.spelling("withXSRFToken")},!0),i.method=(i.method||this.defaults.method||"get").toLowerCase();let _=u&&_t.merge(u.common,u[i.method]);u&&_t.forEach(["delete","get","head","post","put","patch","common"],l=>{delete u[l]}),i.headers=lh.concat(_,u);let S=[],C=!0;this.interceptors.request.forEach(function(l){typeof l.runWhen=="function"&&l.runWhen(i)===!1||(C=C&&l.synchronous,S.unshift(l.fulfilled,l.rejected))});let R=[],e;this.interceptors.response.forEach(function(l){R.push(l.fulfilled,l.rejected)});let t,r=0;if(!C){let l=[a8.bind(this),void 0];for(l.unshift.apply(l,S),l.push.apply(l,R),t=l.length,e=Et.resolve(i);r<t;)e=e.then(l[r++],l[r++]);return e}t=S.length;let s=i;for(r=0;r<t;){let l=S[r++],f=S[r++];try{s=l(s)}catch(m){f.call(this,m);break}}try{e=a8.call(this,s)}catch(l){return Et.reject(l)}for(r=0,t=R.length;r<t;)e=e.then(R[r++],R[r++]);return e}getUri(n){return Dr(ix((n=Ng(this.defaults,n)).baseURL,n.url),n.params,n.paramsSerializer)}};_t.forEach(["delete","get","head","options"],function(n){Ub.prototype[n]=function(i,a){return this.request(Ng(a||{},{method:n,url:i,data:(a||{}).data}))}}),_t.forEach(["post","put","patch"],function(n){function i(a){return function(c,u,_){return this.request(Ng(_||{},{method:n,headers:a?{"Content-Type":"multipart/form-data"}:{},url:c,data:u}))}}Ub.prototype[n]=i(),Ub.prototype[n+"Form"]=i(!0)});var ZR=Ub;class gx{constructor(i){if(typeof i!="function")throw new TypeError("executor must be a function.");let a;this.promise=new Et(function(u){a=u});let c=this;this.promise.then(u=>{if(!c._listeners)return;let _=c._listeners.length;for(;_-- >0;)c._listeners[_](u);c._listeners=null}),this.promise.then=u=>{let _,S=new Et(C=>{c.subscribe(C),_=C}).then(u);return S.cancel=function(){c.unsubscribe(_)},S},i(function(u,_,S){c.reason||(c.reason=new A_(u,_,S),a(c.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(i){this.reason?i(this.reason):this._listeners?this._listeners.push(i):this._listeners=[i]}unsubscribe(i){if(!this._listeners)return;let a=this._listeners.indexOf(i);a!==-1&&this._listeners.splice(a,1)}toAbortSignal(){let i=new AbortController,a=c=>{i.abort(c)};return this.subscribe(a),i.signal.unsubscribe=()=>this.unsubscribe(a),i.signal}static source(){let i;return{token:new gx(function(a){i=a}),cancel:i}}}var s8=gx;let $R={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries($R).forEach(n=>{let[i,a]=n;$R[a]=i});var o8=$R;let Bs=function n(i){let a=new ZR(i),c=v9(ZR.prototype.request,a);return _t.extend(c,ZR.prototype,a,{allOwnKeys:!0}),_t.extend(c,a,null,{allOwnKeys:!0}),c.create=function(u){return n(Ng(i,u))},c}($4);Bs.Axios=ZR,Bs.CanceledError=A_,Bs.CancelToken=s8,Bs.isCancel=ZB,Bs.VERSION=lL,Bs.toFormData=DR,Bs.AxiosError=Mr,Bs.Cancel=Bs.CanceledError,Bs.all=function(n){return Et.all(n)},Bs.spread=function(n){return function(i){return n.apply(null,i)}},Bs.isAxiosError=function(n){return _t.isObject(n)&&n.isAxiosError===!0},Bs.mergeConfig=Ng,Bs.AxiosHeaders=lh,Bs.formToJSON=n=>Q4(_t.isHTMLForm(n)?new FormData(n):n),Bs.getAdapter=px.getAdapter,Bs.HttpStatusCode=o8,Bs.default=Bs;var eo=Bs;let c8=()=>{};function O_(){let n={promise:void 0,isResolved:!1,isRejected:!1,isFinished:!1,resolve:void 0,reject:void 0,cancel:c8};return n.promise=new Et((i,a)=>{n.resolve=c=>{n.isFinished||(n.isResolved=!0,n.isFinished=!0,i(c),n.value=c)},n.reject=c=>{n.isFinished||(n.isRejected=!0,n.isFinished=!0,a(c))}}),n}let Kd=new Map,mS=new Map,qd=new Map,Ra=function(n){return n.WIN_10="Windows 10",n.WIN_81="Windows 8.1",n.WIN_8="Windows 8",n.WIN_7="Windows 7",n.WIN_VISTA="Windows Vista",n.WIN_SERVER_2003="Windows Server 2003",n.WIN_XP="Windows XP",n.WIN_2000="Windows 2000",n.ANDROID="Android",n.HARMONY_OS="HarmonyOS",n.OPEN_BSD="Open BSD",n.SUN_OS="Sun OS",n.LINUX="Linux",n.IOS="iOS",n.MAC_OS="Mac OS",n.CHROMIUM_OS="Chromium OS",n.QNX="QNX",n.UNIX="UNIX",n.BEOS="BeOS",n.OS_2="OS/2",n.SEARCH_BOT="Search Bot",n}({}),cr=function(n){return n.CHROME="Chrome",n.SAFARI="Safari",n.EDGE="Edge",n.FIREFOX="Firefox",n.OPERA="OPR",n.QQ="QQBrowser",n.WECHAT="MicroMessenger",n}({}),uL=new _H,uh=uL.getResult(),Ts=null;function En(n){if(!Ts){uh=uL.getResult();let i=function(C){if(C.engine.name==="Blink"&&C.browser.name!=="WeChat")return cr.CHROME;switch(C.browser.name){case"Chrome Headless":case"Chrome":case"Chromium":return cr.CHROME;case"Safari":case"Mobile Safari":return cr.SAFARI;case"Edge":return cr.EDGE;case"Firefox":return cr.FIREFOX;case"QQ":case"QQBrowser":return cr.QQ;case"Opera":return cr.OPERA;case"WeChat":return cr.WECHAT;default:return C.browser.name||""}}(uh),a=l8(uh),c=function(C){return C.os.name==="Windows"?C.os.version?C.os.name+" "+C.os.version:C.os.name:C.os.name||""}(uh),u=uh.os.version,_=l8(uh,!1),S=uh.device.type;if(!(i&&a&&c&&u))return{name:i,version:a,os:c,osVersion:u,browserVersion:_,deviceType:S};Ts={name:i,version:a,os:c,osVersion:u,browserVersion:_,deviceType:S}}return Ts}function l8(n){let i,a=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];return i=n.engine.name==="Blink"?n.engine.version||"":n.browser.version||"",a?i.split(".")[0]:i}function N_(){return En().os}function eI(){let n=En();return"".concat(n.os," ").concat(n.osVersion)}function gS(){let n=En();return!!(uh.engine.name==="WebKit"&&n.os===Ra.MAC_OS&&navigator.maxTouchPoints&&navigator.maxTouchPoints>0&&n.name!==cr.SAFARI||Ea()&&n.name!==cr.SAFARI)}function Vo(){return En().name===cr.CHROME}function mr(){return En().name===cr.SAFARI}function sr(){return En().name===cr.EDGE}function Ni(){return En().name===cr.FIREFOX}function Ea(){return En().os===Ra.IOS}function _S(n){let i=En();return!(i.name!==cr.CHROME||!i.osVersion)&&Number(i.version)>=n}function qn(n){let i=En();return!(i.name!==cr.CHROME||!i.osVersion)&&Number(i.version)<n}function fL(n,i,a){let c=En();return!(c.name!==n||!c.osVersion)&&(a?Number(c.version)>=i&&Number(c.version)<=a:Number(c.version)===i)}function jb(n){let i=En();return!(i.name!==cr.EDGE||!i.osVersion)&&Number(i.version)>=n}function _x(n){let i=En();return!(i.name!==cr.SAFARI||!i.osVersion)&&Number(i.version)>=n}function tI(n,i,a){let c=En();if(c.os!==Ra.IOS||!c.osVersion)return!1;let u=c.osVersion.split(".");return i&&Number(u[0])===n&&Number(u[1])<i||Number(u[0])<n}function Up(n,i,a){let c=En();if(c.name!==cr.SAFARI||!c.osVersion||!c.browserVersion)return!1;let u=c.browserVersion.split(".");return a?i&&Number(u[0])===n&&Number(u[1])<i||Number(u[0])<n:i?Number(u[0])===n&&Number(u[1])<=i||Number(u[0])<n:Number(u[0])<=n}function ns(n){let i=En();return!(i.name!==cr.OPERA||!i.osVersion)&&Number(i.version)>=n}function Ex(){let n=En();if(n.os!==Ra.IOS||!n.osVersion)return!1;let i=n.osVersion.split(".");return Number(i[0])<14||Number(i[0])===14&&Number(i[1])<=6}function ei(){let n=En();if(n.os!==Ra.IOS||!n.osVersion)return!1;let i=n.osVersion.split(".");return Number(i[0])===15}function to(){let n=En();if(n.os!==Ra.IOS||!n.osVersion)return!1;let i=n.osVersion.split(".");return Number(i[0])===16}function Vb(){let n=En();if(n.os!==Ra.IOS||!n.osVersion)return!1;let i=n.osVersion.split(".");return Number(i[0])===15&&Number(i[1])>=1}function Jd(){return mr()&&navigator.maxTouchPoints>0}function hL(){return En().name===cr.WECHAT}function pL(){return window.navigator.appVersion&&window.navigator.appVersion.match(/Chrome\/([\w\W]*?)\./)!==null&&window.navigator.appVersion.match(/Chrome\/([\w\W]*?)\./)[1]<=35}function mL(){let n=N_();return function(){let{deviceType:i}=En();return i==="mobile"||i==="tablet"}()||n===Ra.ANDROID||n===Ra.IOS||n===Ra.HARMONY_OS}function jp(){let n=En();return n.name!==cr.EDGE&&n.name!==cr.SAFARI&&!!navigator.userAgent.toLocaleLowerCase().match(/chrome\/[\d]./i)}function nI(){return N_()===Ra.ANDROID}function ES(){let n=En();return nI()&&(n.name===cr.CHROME||n.name===cr.WECHAT||/chrome|chromium/i.test(navigator.userAgent))}function vx(n,i){var a=Object.keys(n);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(n);i&&(c=c.filter(function(u){return Object.getOwnPropertyDescriptor(n,u).enumerable})),a.push.apply(a,c)}return a}function Ct(n){for(var i=1;i<arguments.length;i++){var a=arguments[i]!=null?arguments[i]:{};i%2?vx(Object(a),!0).forEach(function(c){un(n,c,a[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(a)):vx(Object(a)).forEach(function(c){Object.defineProperty(n,c,Object.getOwnPropertyDescriptor(a,c))})}return n}function un(n,i,a){return(i=function(c){var u=function(_,S){if(typeof _!="object"||_===null)return _;var C=_[Symbol.toPrimitive];if(C!==void 0){var R=C.call(_,"string");if(typeof R!="object")return R;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(_)}(c);return typeof u=="symbol"?u:String(u)}(i))in n?Object.defineProperty(n,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):n[i]=a,n}let oe=function(n){return n.UNEXPECTED_ERROR="UNEXPECTED_ERROR",n.UNEXPECTED_RESPONSE="UNEXPECTED_RESPONSE",n.TIMEOUT="TIMEOUT",n.INVALID_PARAMS="INVALID_PARAMS",n.NOT_READABLE="NOT_READABLE",n.NOT_SUPPORTED="NOT_SUPPORTED",n.INVALID_OPERATION="INVALID_OPERATION",n.OPERATION_ABORTED="OPERATION_ABORTED",n.WEB_SECURITY_RESTRICT="WEB_SECURITY_RESTRICT",n.EXCHANGE_SDP_FAILED="EXCHANGE_SDP_FAILED",n.ADD_CANDIDATE_FAILED="ADD_CANDIDATE_FAILED",n.DATACHANNEL_FAILED="DATACHANNEL_FAILED",n.NETWORK_ERROR="NETWORK_ERROR",n.NETWORK_TIMEOUT="NETWORK_TIMEOUT",n.NETWORK_RESPONSE_ERROR="NETWORK_RESPONSE_ERROR",n.API_INVOKE_TIMEOUT="API_INVOKE_TIMEOUT",n.ENUMERATE_DEVICES_FAILED="ENUMERATE_DEVICES_FAILED",n.DEVICE_NOT_FOUND="DEVICE_NOT_FOUND",n.ELECTRON_IS_NULL="ELECTRON_IS_NULL",n.ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR="ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR",n.CHROME_PLUGIN_NO_RESPONSE="CHROME_PLUGIN_NO_RESPONSE",n.CHROME_PLUGIN_NOT_INSTALL="CHROME_PLUGIN_NOT_INSTALL",n.MEDIA_OPTION_INVALID="MEDIA_OPTION_INVALID",n.PERMISSION_DENIED="PERMISSION_DENIED",n.CONSTRAINT_NOT_SATISFIED="CONSTRAINT_NOT_SATISFIED",n.TRACK_IS_DISABLED="TRACK_IS_DISABLED",n.GET_VIDEO_ELEMENT_VISIBLE_ERROR="GET_VIDEO_ELEMENT_VISIBLE_ERROR",n.SHARE_AUDIO_NOT_ALLOWED="SHARE_AUDIO_NOT_ALLOWED",n.LOW_STREAM_ENCODING_ERROR="LOW_STREAM_ENCODING_ERROR",n.SET_ENCODING_PARAMETER_ERROR="SET_ENCODING_PARAMETER_ERROR",n.TRACK_STATE_UNREACHABLE="TRACK_STATE_UNREACHABLE",n.INVALID_UINT_UID_FROM_STRING_UID="INVALID_UINT_UID_FROM_STRING_UID",n.CAN_NOT_GET_PROXY_SERVER="CAN_NOT_GET_PROXY_SERVER",n.CAN_NOT_GET_GATEWAY_SERVER="CAN_NOT_GET_GATEWAY_SERVER",n.VOID_GATEWAY_ADDRESS="VOID_GATEWAY_ADDRESS",n.UID_CONFLICT="UID_CONFLICT",n.MULTI_UNILBS_RESPONSE_ERROR="MULTI_UNILBS_RESPONSE_ERROR",n.UPDATE_TICKET_FAILED="UPDATE_TICKET_FAILED",n.TOKEN_EXPIRE="TOKEN_EXPIRE",n.INVALID_LOCAL_TRACK="INVALID_LOCAL_TRACK",n.INVALID_TRACK="INVALID_TRACK",n.SENDER_NOT_FOUND="SENDER_NOT_FOUND",n.CREATE_OFFER_FAILED="CREATE_OFFER_FAILED",n.SET_ANSWER_FAILED="SET_ANSWER_FAILED",n.ICE_FAILED="ICE_FAILED",n.PC_CLOSED="PC_CLOSED",n.SENDER_REPLACE_FAILED="SENDER_REPLACE_FAILED",n.GET_LOCAL_CAPABILITIES_FAILED="GET_LOCAL_CAPABILITIES_FAILED",n.GET_LOCAL_CONNECTION_PARAMS_FAILED="GET_LOCAL_CONNECTION_PARAMS_FAILED",n.SUBSCRIBE_FAILED="SUBSCRIBE_FAILED",n.UNSUBSCRIBE_FAILED="UNSUBSCRIBE_FAILED",n.GATEWAY_P2P_LOST="GATEWAY_P2P_LOST",n.NO_ICE_CANDIDATE="NO_ICE_CANDIDATE",n.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS="CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS",n.EXIST_DISABLED_VIDEO_TRACK="EXIST_DISABLED_VIDEO_TRACK",n.INVALID_REMOTE_USER="INVALID_REMOTE_USER",n.REMOTE_USER_IS_NOT_PUBLISHED="REMOTE_USER_IS_NOT_PUBLISHED",n.CUSTOM_REPORT_SEND_FAILED="CUSTOM_REPORT_SEND_FAILED",n.CUSTOM_REPORT_FREQUENCY_TOO_HIGH="CUSTOM_REPORT_FREQUENCY_TOO_HIGH",n.FETCH_AUDIO_FILE_FAILED="FETCH_AUDIO_FILE_FAILED",n.READ_LOCAL_AUDIO_FILE_ERROR="READ_LOCAL_AUDIO_FILE_ERROR",n.DECODE_AUDIO_FILE_FAILED="DECODE_AUDIO_FILE_FAILED",n.WS_ABORT="WS_ABORT",n.WS_DISCONNECT="WS_DISCONNECT",n.WS_ERR="WS_ERR",n.EXTERNAL_SIGNAL_ABORT="EXTERNAL_SIGNAL_ABORT",n.LIVE_STREAMING_TASK_CONFLICT="LIVE_STREAMING_TASK_CONFLICT",n.LIVE_STREAMING_INVALID_ARGUMENT="LIVE_STREAMING_INVALID_ARGUMENT",n.LIVE_STREAMING_INTERNAL_SERVER_ERROR="LIVE_STREAMING_INTERNAL_SERVER_ERROR",n.LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED="LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED",n.LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED="LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED",n.LIVE_STREAMING_CDN_ERROR="LIVE_STREAMING_CDN_ERROR",n.LIVE_STREAMING_INVALID_RAW_STREAM="LIVE_STREAMING_INVALID_RAW_STREAM",n.LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT="LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT",n.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE="LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE",n.LIVE_STREAMING_WARN_FREQUENT_REQUEST="LIVE_STREAMING_WARN_FREQUENT_REQUEST",n.WEBGL_INTERNAL_ERROR="WEBGL_INTERNAL_ERROR",n.BEAUTY_PROCESSOR_INTERNAL_ERROR="BEAUTY_PROCESSOR_INTERNAL_ERROR",n.CROSS_CHANNEL_WAIT_STATUS_ERROR="CROSS_CHANNEL_WAIT_STATUS_ERROR",n.CROSS_CHANNEL_FAILED_JOIN_SRC="CROSS_CHANNEL_FAILED_JOIN_SEC",n.CROSS_CHANNEL_FAILED_JOIN_DEST="CROSS_CHANNEL_FAILED_JOIN_DEST",n.CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST="CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST",n.CROSS_CHANNEL_SERVER_ERROR_RESPONSE="CROSS_CHANNEL_SERVER_ERROR_RESPONSE",n.METADATA_OUT_OF_RANGE="METADATA_OUT_OF_RANGE",n.LOCAL_AEC_ERROR="LOCAL_AEC_ERROR",n.INVALID_PLUGIN="INVALID_PLUGIN",n.DISCONNECT_P2P="DISCONNECT_P2P",n.CONVERTING_IMAGEDATA_TO_BLOB_FAILED="CONVERTING_IMAGEDATA_TO_BLOB_FAILED",n.CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED="CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED",n.INIT_DATACHANNEL_TIMEOUT="INIT_DATACHANNEL_TIMEOUT",n.CREATE_DATACHANNEL_ERROR="CREATE_DATACHANNEL_ERROR",n.DATACHANNEL_CONNECTION_TIMEOUT="DATACHANNEL_CONNECTION_TIMEOUT",n.PROHIBITED_OPERATION="PROHIBITED_OPERATION",n.IMAGE_MODERATION_UPLOAD_FAILED="IMAGE_MODERATION_UPLOAD_FAILED",n.P2P_MESSAGE_FAILED="P2P_MESSAGE_FAILED",n}({}),Ye=class extends Error{constructor(n){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",a=arguments.length>2?arguments[2]:void 0;super(i),un(this,"code",void 0),un(this,"message",void 0),un(this,"data",void 0),un(this,"name","AgoraRTCException"),this.code=n,this.message="AgoraRTCError ".concat(this.code,": ").concat(i),this.data=a}toString(){return this.data?"".concat(this.message,`
data: `).concat(JSON.stringify(this.data)):this.message}print(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"error",i=arguments.length>1?arguments[1]:void 0;return n==="error"&&(i||console).error(this.toString()),n==="warning"&&(i||console).warn(this.toString()),this}throw(n){throw this.print("error",n),this}};function Vp(n,i){if(typeof n!="boolean")throw new Ye(oe.INVALID_PARAMS,"Invalid ".concat(i,": The value is of the boolean type."))}function Ia(n,i,a){if(!ft(a).call(a,n))throw new Ye(oe.INVALID_PARAMS,"".concat(i," can only be set as ").concat(JSON.stringify(a)))}function Cr(n,i){let a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,c=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1e4;if(n<a||n>c||(!(arguments.length>4&&arguments[4]!==void 0)||arguments[4])&&!function(u){return typeof u=="number"&&u%1==0}(n))throw new Ye(oe.INVALID_PARAMS,"invalid ".concat(i,": the value range is [").concat(a,", ").concat(c,"]. integer only"))}function fh(n,i){if(typeof n!="number"){if(!(n.min||n.max||n.ideal||n.exact))throw new Ye(oe.INVALID_PARAMS,"".concat(i," is not a valid ConstrainLong"));n.min!==void 0&&Cr(n.min,"".concat(i,".min"),0,1/0),n.max!==void 0&&Cr(n.max,"".concat(i,".max"),1,1/0),n.exact!==void 0&&Cr(n.exact,"".concat(i,".exact"),1,1/0),n.ideal!==void 0&&Cr(n.ideal,"".concat(i,".ideal"),1,1/0)}else Cr(n,i,1,1/0)}function Pa(n,i){let a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,c=arguments.length>3&&arguments[3]!==void 0?arguments[3]:255,u=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4];if(n==null)throw new Ye(oe.INVALID_PARAMS,"".concat(i||"param"," cannot be empty"));if(!Sx(n,a,c,u))throw new Ye(oe.INVALID_PARAMS,"Invalid ".concat(i||"string param",": Length of the string: [").concat(a,",").concat(c,"].").concat(u?" ASCII characters only.":""))}function Xd(n,i){if(!Array.isArray(n))throw new Ye(oe.INVALID_PARAMS,"".concat(i," should be an array"))}function Bt(n){return n==null}function Sx(n){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:255,c=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3];return typeof n=="string"&&n.length<=a&&n.length>=i&&(!c||function(u){if(typeof u!="string")return!1;for(let _=0;_<u.length;_+=1){let S=u.charCodeAt(_);if(S<0||S>255)return!1}return!0}(n))}var It=function(n){return n.COVERED="COVERED",n.POSITION="POSITION",n.SIZE="SIZE",n.STYLE="STYLE",n}(It||{}),se=function(n){return n.UNMOUNTED="UNMOUNTED",n.INVALID_HTML_ELEMENT="INVALID_HTML_ELEMENT",n}(se||{});let Ke=new class{constructor(){un(this,"_clientSize",null),un(this,"getClientWidth",()=>document.documentElement?document.documentElement.clientWidth:document.body.clientWidth),un(this,"getClientHeight",()=>document.documentElement?document.documentElement.clientHeight:document.body.clientHeight),un(this,"getStyle",n=>window.getComputedStyle(n,null)),un(this,"checkCssVisibleProperty",n=>{var i;let a=!0,c=this.getStyle(n),{display:u,visibility:_,opacity:S,filter:C}=c;return(u==="none"||ft(i=["hidden","collapse"]).call(i,_)||Number(S)<.1)&&(a=!1),!!a&&(C&&C.split(" ").filter(R=>{var e;let t=R.split("(")[0];return ft(e=["brightness","blur","opacity"]).call(e,t)}).map(R=>{let[e,t]=R.split(/\(|\)/);return[e,Number(t.match(/^[0-9\.]+/))]}).forEach(R=>{let[e,t]=R;switch(e){case"brightness":(t<.1||t>3)&&(a=!1);break;case"blur":t>3&&(a=!1);break;case"opacity":t<.1&&(a=!1)}}),a)}),un(this,"checkPropertyUpToAllParentNodes",(n,i)=>{let a=!0,c=!0,u=S=>i(S),_=n;for(;_&&c;)u(_)||(a=!1,c=!1),_=_.parentElement,_||(c=!1);return a}),un(this,"checkActualCssVisibleIncludeInherit",n=>this.checkPropertyUpToAllParentNodes(n,this.checkCssVisibleProperty)),un(this,"getSizeAboutClient",n=>{let{width:i,height:a,left:c,right:u,top:_,bottom:S}=n.getBoundingClientRect(),C=this.getClientWidth(),R=this.getClientHeight();return{width:i,height:a,left:c,right:u,top:_,bottom:S,clientWidth:C,clientHeight:R,clientMin:Math.min(C,R)}}),un(this,"checkActualSize",()=>{let{width:n,height:i,clientMin:a}=this._clientSize;return this.checkSizeIsVisible(n,i,a)}),un(this,"elementFromPoint",(n,i)=>document.elementFromPoint?document.elementFromPoint(n,i):null),un(this,"checkCoverForAPoint",(n,i,a)=>{let c=this.elementFromPoint(n,i);return c!==null&&c!==a}),un(this,"getPointPositionList",()=>{let{width:n,height:i,left:a,top:c}=this._clientSize,u=n/6,_=i/6,S=[],C=10**6;for(let R=0;R<5;R++)for(let e=0;e<5;e++){let t=(a*C+(R===0?.1:R===4?(u*R*C-1e5)/C:u*R)*C)/C,r=(c*C+(e===0?.1:e===4?(_*e*C-1e5)/C:_*e)*C)/C;S.push({x:t,y:r})}return[...S]}),un(this,"checkElementCover",n=>this.getPointPositionList().map(i=>this.checkCoverForAPoint(i.x,i.y,n)).filter(i=>!!i).length>6),un(this,"checkSizeIsVisible",(n,i,a)=>(n>50||a/n<=10)&&(i>50||a/i<=10)),un(this,"checkSizeOfPartInClient",()=>{let{left:n,right:i,top:a,bottom:c,clientHeight:u,clientWidth:_,clientMin:S}=this._clientSize,C,R,e,t;if(n<0)C=0;else{if(!(n<_))return!1;C=n}if(i<0)return!1;if(R=i<_?i:_,a<0)e=0;else{if(!(a<u))return!1;e=a}if(c<0)return!1;t=c<u?c:u;let r=R-C,s=t-e;return this.checkSizeIsVisible(r,s,S)}),un(this,"returnHiddenResult",n=>(this._clientSize=null,{visible:!1,reason:n})),un(this,"checkOneElementVisible",n=>{if(n instanceof HTMLElement){if(this.checkElementIsMountedOnDom(n)){if(this.checkActualCssVisibleIncludeInherit(n)){if(this._clientSize=this.getSizeAboutClient(n),this.checkElementCover(n))return this.returnHiddenResult(It.COVERED);{let i=this.checkActualSize(),a=this.checkSizeOfPartInClient();return i&&!a?this.returnHiddenResult(It.POSITION):i?(this._clientSize=null,{visible:!0}):this.returnHiddenResult(It.SIZE)}}return this.returnHiddenResult(It.STYLE)}return this.returnHiddenResult(se.UNMOUNTED)}return this.returnHiddenResult(se.INVALID_HTML_ELEMENT)}),un(this,"checkElementIsMountedOnDom",n=>this.checkPropertyUpToAllParentNodes(n,i=>i.nodeName.toUpperCase()!=="HTML"?i.parentElement!==null:!!document.documentElement))}};function hh(n){return new TextEncoder().encode(n)}let Aa=function(n,i){let a=new Uint8Array(n.byteLength+i.byteLength);return a.set(new Uint8Array(n),0),a.set(new Uint8Array(i),n.byteLength),a},wr=async n=>function(i,a){let c="";return new Uint8Array(i).forEach(u=>{c+=u.toString(a).padStart(2,"0")}),c}(await crypto.subtle.digest("SHA-256",hh(n)),16),li=class{constructor(){un(this,"_events",{}),un(this,"addListener",this.on)}getListeners(n){return this._events[n]?this._events[n].map(i=>i.listener):[]}on(n,i){this._events[n]||(this._events[n]=[]);let a=this._events[n];this._indexOfListener(a,i)===-1&&a.push({listener:i,once:!1})}once(n,i){this._events[n]||(this._events[n]=[]);let a=this._events[n];this._indexOfListener(a,i)===-1&&a.push({listener:i,once:!0})}off(n,i){if(!this._events[n])return;let a=this._events[n],c=this._indexOfListener(a,i);c!==-1&&a.splice(c,1),this._events[n].length===0&&delete this._events[n]}removeAllListeners(n){n?delete this._events[n]:this._events={}}emit(n){this._events[n]||(this._events[n]=[]);let i=this._events[n].map(_=>_);for(var a=arguments.length,c=new Array(a>1?a-1:0),u=1;u<a;u++)c[u-1]=arguments[u];for(let _=0;_<i.length;_+=1){let S=i[_];S.once&&this.off(n,S.listener),S.listener.apply(this,c||[])}}safeEmit(n){for(var i=arguments.length,a=new Array(i>1?i-1:0),c=1;c<i;c++)a[c-1]=arguments[c];[...this._events[n]||[]].forEach(u=>{u.once&&this.off(n,u.listener);try{u.listener.apply(this,a)}catch(_){console.error("safeEmit event:".concat(n," error ").concat(_==null?void 0:_.toString()))}})}_indexOfListener(n,i){let a=n.length;for(;a--;)if(n[a].listener===i)return a;return-1}},Oa=null;function Bp(){if(Oa)return Oa;if(window.electron)return Oa=window.electron;if(!window.require)return null;try{return Oa=window.require("electron"),Oa}catch{return null}}let bn=function(n){return n.CREATE_CLIENT="createClient",n.CHECK_SYSTEM_REQUIREMENTS="checkSystemRequirements",n.SET_AREA="setArea",n.PRELOAD="PRELOAD",n.CHECK_VIDEO_TRACK_IS_ACTIVE="checkVideoTrackIsActive",n.CHECK_AUDIO_TRACK_IS_ACTIVE="checkAudioTrackIsActive",n.CREATE_MIC_AUDIO_TRACK="createMicrophoneAudioTrack",n.CREATE_CUSTOM_AUDIO_TRACK="createCustomAudioTrack",n.CREATE_BUFFER_AUDIO_TRACK="createBufferSourceAudioTrack",n.CREATE_CAM_VIDEO_TRACK="createCameraVideoTrack",n.CREATE_CUSTOM_VIDEO_TRACK="createCustomVideoTrack",n.CREATE_MIC_AND_CAM_TRACKS="createMicrophoneAndCameraTracks",n.CREATE_SCREEN_VIDEO_TRACK="createScreenVideoTrack",n.SET_ENCRYPTION_CONFIG="Client.setEncryptionConfig",n.START_PROXY_SERVER="Client.startProxyServer",n.STOP_PROXY_SERVER="Client.stopProxyServer",n.SET_PROXY_SERVER="Client.setProxyServer",n.SET_TURN_SERVER="Client.setTurnServer",n.SET_CLIENT_ROLE="Client.setClientRole",n.SET_LOW_STREAM_PARAMETER="Client.setLowStreamParameter",n.ENABLE_DUAL_STREAM="Client.enableDualStream",n.DISABLE_DUAL_STREAM="Client.disableDualStream",n.JOIN="Client.join",n.LEAVE="Client.leave",n.PUBLISH="Client.publish",n.UNPUBLISH="Client.unpublish",n.SUBSCRIBE="Client.subscribe",n.MASS_SUBSCRIBE="Client.massSubscribe",n.MASS_UNSUBSCRIBE="Client.massUnsubscribe",n.UNSUBSCRIBE="Client.unsubscribe",n.RENEW_TOKEN="Client.renewToken",n.SET_REMOTE_VIDEO_STREAM_TYPE="Client.setRemoteVideoStreamType",n.SET_STREAM_FALLBACK_OPTION="Client.setStreamFallbackOption",n.ENABLE_AUDIO_VOLUME_INDICATOR="Client.enableAudioVolumeIndicator",n.SEND_CUSTOM_REPORT_MESSAGE="Client.sendCustomReportMessage",n.INSPECT_VIDEO_CONTENT="Client.inspectVideoContent",n.STOP_INSPECT_VIDEO_CONTENT="Client.stopInspectVideoContent",n.JOIN_FALLBACK_TO_PROXY="Client._joinFallbackToProxy",n.ON_LIVE_STREAM_WARNING="Client.onLiveStreamWarning",n.ON_LIVE_STREAM_ERROR="Client.onLiveStreamingError",n.START_LIVE_STREAMING="Client.startLiveStreaming",n.SET_LIVE_TRANSCODING="Client.setLiveTranscoding",n.STOP_LIVE_STREAMING="Client.stopLiveStreaming",n.START_CHANNEL_MEDIA_RELAY="Client.startChannelMediaRelay",n.UPDATE_CHANNEL_MEDIA_RELAY="Client.updateChannelMediaRelay",n.STOP_CHANNEL_MEDIA_RELAY="Client.stopChannelMediaRelay",n.REQUEST_CONFIG_DISTRIBUTE="_config-distribute-request",n.SET_CONFIG_DISTRIBUTE="_configDistribute",n.LOCAL_TRACK_SET_MUTED="LocalTrack.setMute",n.LOCAL_AUDIO_TRACK_PLAY="LocalAudioTrack.play",n.LOCAL_AUDIO_TRACK_PLAY_IN_ELEMENT="LocalAudioTrack.playInElement",n.LOCAL_AUDIO_TRACK_STOP="LocalAudioTrack.stop",n.LOCAL_AUDIO_TRACK_SET_VOLUME="LocalAudioTrack.setVolume",n.MIC_AUDIO_TRACK_SET_DEVICE="MicrophoneAudioTrack.setDevice",n.BUFFER_AUDIO_TRACK_START="BufferSourceAudioTrack.startProcessAudioBuffer",n.BUFFER_AUDIO_TRACK_STOP="BufferSourceAudioTrack.stopProcessAudioBuffer",n.BUFFER_AUDIO_TRACK_PAUSE="BufferSourceAudioTrack.pauseProcessAudioBuffer",n.BUFFER_AUDIO_TRACK_RESUME="BufferSourceAudioTrack.resumeProcessAudioBuffer",n.BUFFER_AUDIO_TRACK_SEEK="BufferSourceAudioTrack.seekAudioBuffer",n.LOCAL_VIDEO_TRACK_PLAY="LocalVideoTrack.play",n.LOCAL_VIDEO_TRACK_STOP="LocalVideoTrack.stop",n.LOCAL_VIDEO_TRACK_GET_VIDEO_VISIBLE="LocalVideoTrack.getVideoElementVisibleStatus",n.LOCAL_VIDEO_TRACK_BEAUTY="LocalVideoTrack.setBeautyEffect",n.LOCAL_VIDEO_SEND_SEI_DATA="LocalVideoTrack.sendSeiData",n.CAM_VIDEO_TRACK_SET_DEVICE="CameraVideoTrack.setDevice",n.CAM_VIDEO_TRACK_SET_ENCODER_CONFIG="CameraVideoTrack.setEncoderConfiguration",n.REMOTE_VIDEO_TRACK_PLAY="RemoteVideoTrack.play",n.REMOTE_VIDEO_TRACK_STOP="RemoteVideoTrack.stop",n.REMOTE_VIDEO_TRACK_GET_VIDEO_VISIBLE="RemoteVideoTrack.getVideoElementVisibleStatus",n.REMOTE_AUDIO_TRACK_PLAY="RemoteAudioTrack.play",n.REMOTE_AUDIO_TRACK_STOP="RemoteAudioTrack.stop",n.REMOTE_AUDIO_SET_VOLUME="RemoteAudioTrack.setVolume",n.REMOTE_AUDIO_SET_OUTPUT_DEVICE="RemoteAudioTrack.setOutputDevice",n.GET_MEDIA_STREAM_TRACK="Track.getMediaStreamTrack",n.STREAM_TYPE_CHANGE="streamTypeChange",n.CONNECTION_STATE_CHANGE="connectionStateChange",n.LOAD_CONFIG_FROM_LOCALSTORAGE="loadConfigFromLocalStorage",n.IMAGE_MODERATION_UPLOAD="imageModerationUpload",n.REPUB_AFTER_PC_CONNECTED="repubAfterPCConnected",n}({}),Li=function(n){return n.TRACER="tracer",n}({});function Bb(n){return Cr(n.timeout,"config.timeout",0,1e5),Cr(n.timeoutFactor,"config.timeoutFactor",0,100,!1),Cr(n.maxRetryCount,"config.maxRetryConfig",0,1/0),Cr(n.maxRetryTimeout,"config.maxRetryTimeout",0,1/0),!0}let yx=function(n){return n[n.AUDIENCE_LEVEL_LOW_LATENCY=1]="AUDIENCE_LEVEL_LOW_LATENCY",n[n.AUDIENCE_LEVEL_ULTRA_LOW_LATENCY=2]="AUDIENCE_LEVEL_ULTRA_LOW_LATENCY",n[n.AUDIENCE_LEVEL_SYNC_LATENCY=3]="AUDIENCE_LEVEL_SYNC_LATENCY",n}({}),ur=function(n){return n.LEAVE="LEAVE",n.NETWORK_ERROR="NETWORK_ERROR",n.SERVER_ERROR="SERVER_ERROR",n.UID_BANNED="UID_BANNED",n.FALLBACK="FALLBACK",n.IP_BANNED="IP_BANNED",n.CHANNEL_BANNED="CHANNEL_BANNED",n.LICENSE_MISSING="LICENSE_MISSING",n.LICENSE_EXPIRED="LICENSE_EXPIRED",n.LICENSE_MINUTES_EXCEEDED="LICENSE_MINUTES_EXCEEDED",n.LICENSE_PERIOD_INVALID="LICENSE_PERIOD_INVALID",n.LICENSE_MULTIPLE_SDK_SERVICE="LICENSE_MULTIPLE_SDK_SERVICE",n.LICENSE_ILLEGAL="LICENSE_ILLEGAL",n.TOKEN_EXPIRE="TOKEN_EXPIRE",n}({});function vS(n){if(!Array.isArray(n)||n.length<1)return!1;try{n.forEach(i=>{if(!i.urls)throw Error()})}catch{return!1}return!0}function Tx(n){return Pa(n.turnServerURL,"turnServerURL"),Pa(n.username,"username"),Pa(n.password,"password"),n.udpport&&Cr(n.udpport,"udpport",1,99999,!0),n.forceturn&&Vp(n.forceturn,"forceturn"),n.security&&Vp(n.security,"security"),n.tcpport&&Cr(n.tcpport,"tcpport",1,99999,!0),!0}function rI(n){return n.level!==void 0&&Ia(n.level,"level",[1,2,3]),n.delay!==void 0&&Cr(n.delay,"delay",0,3e3,!0),!0}let Xt=function(n){return n.PEERCONNECTION_STATE_CHANGE="peerconnection-state-change",n.AUDIO_METADATA="audio-metadata",n.CONNECTION_STATE_CHANGE="connection-state-change",n.MEDIA_RECONNECT_START="media-reconnect-start",n.MEDIA_RECONNECT_END="media-reconnect-end",n.IS_USING_CLOUD_PROXY="is-using-cloud-proxy",n.USER_JOINED="user-joined",n.USER_LEAVED="user-left",n.USER_PUBLISHED="user-published",n.USER_UNPUBLISHED="user-unpublished",n.USER_INFO_UPDATED="user-info-updated",n.CLIENT_BANNED="client-banned",n.CHANNEL_MEDIA_RELAY_STATE="channel-media-relay-state",n.CHANNEL_MEDIA_RELAY_EVENT="channel-media-relay-event",n.VOLUME_INDICATOR="volume-indicator",n.CRYPT_ERROR="crypt-error",n.ON_TOKEN_PRIVILEGE_WILL_EXPIRE="token-privilege-will-expire",n.ON_TOKEN_PRIVILEGE_DID_EXPIRE="token-privilege-did-expire",n.NETWORK_QUALITY="network-quality",n.STREAM_TYPE_CHANGED="stream-type-changed",n.STREAM_FALLBACK="stream-fallback",n.RECEIVE_METADATA="receive-metadata",n.STREAM_MESSAGE="stream-message",n.LIVE_STREAMING_ERROR="live-streaming-error",n.LIVE_STREAMING_WARNING="live-streaming-warning",n.EXCEPTION="exception",n.ERROR="error",n.P2P_LOST="p2p_lost",n.JOIN_FALLBACK_TO_PROXY="join-fallback-to-proxy",n.CHANNEL_FALLBACK_TO_WEBSOCKET="channel-fallback-to-websocket",n.MEDIA_CONNECTION_TYPE_CHANGE="media-connection-type-change",n.PUBLISHED_USER_LIST="published-user-list",n.CONTENT_INSPECT_CONNECTION_STATE_CHANGE="content-inspect-connection-state-change",n.CONTENT_INSPECT_ERROR="content-inspect-error",n.CONTENT_INSPECT_RESULT="content-inspect-result",n.IMAGE_MODERATION_CONNECTION_STATE_CHANGE="image-moderation-connection-state-change",n}({}),Ma=function(n){return n.NETWORK_ERROR="NETWORK_ERROR",n.SERVER_ERROR="SERVER_ERROR",n.MULTI_IP="MULTI_IP",n.TIMEOUT="TIMEOUT",n.OFFLINE="OFFLINE",n.LEAVE="LEAVE",n.P2P_FAILED="P2P_FAILED",n.FALLBACK="FALLBACK",n.REGIONAL_DISTRIBUTION="REGIONAL_DISTRIBUTION",n}({}),Uc=function(n){return n.ONLINE="ONLINE",n.OFFLINE="OFFLINE",n}({}),Di=function(n){return n.NETWORK_STATE_CHANGE="NETWORK_STATE_CHANGE",n.ONLINE="ONLINE",n.OFFLINE="OFFLINE",n}({});function Bn(n,i){for(var a=arguments.length,c=new Array(a>2?a-2:0),u=2;u<a;u++)c[u-2]=arguments[u];return n.getListeners(i).length===0?Et.reject(new Ye(oe.UNEXPECTED_ERROR,"can not emit promise")):new Et((_,S)=>{n.emit(i,...c,_,S)})}function Vr(n,i){if(n.getListeners(i).length===0)return Et.resolve();for(var a=arguments.length,c=new Array(a>2?a-2:0),u=2;u<a;u++)c[u-2]=arguments[u];return Bn(n,i,...c)}function ed(n,i){if(n.getListeners(i).length===0)return null;for(var a=arguments.length,c=new Array(a>2?a-2:0),u=2;u<a;u++)c[u-2]=arguments[u];return nr(n,i,...c)}function nr(n,i){let a=null,c=null;for(var u=arguments.length,_=new Array(u>2?u-2:0),S=2;S<u;S++)_[S-2]=arguments[S];if(n.emit(i,..._,C=>{a=C},C=>{c=C}),c!==null)throw c;if(a===null)throw new Ye(oe.UNEXPECTED_ERROR,"handler is not sync");return a}let ki=new class extends li{set networkState(n){this.emit(Di.NETWORK_STATE_CHANGE,n,this._networkState),n===Uc.ONLINE?this.emit(Di.ONLINE):n===Uc.OFFLINE&&(this.onlineWaiter=new Et(i=>{this.once(Di.ONLINE,()=>{this.onlineWaiter=void 0,i(Uc.ONLINE)})}),this.emit(Di.OFFLINE)),this._networkState=n}get networkState(){return this._networkState}get isOnline(){return this._networkState===Uc.ONLINE}constructor(){super(),un(this,"_moduleName","network-indicator"),un(this,"_networkState",Uc.ONLINE),un(this,"onlineWaiter",void 0),window.addEventListener("online",()=>{this.networkState=Uc.ONLINE}),window.addEventListener("offline",()=>{this.networkState=Uc.OFFLINE})}};function iI(n,i){let a=n.indexOf(i);a!==-1&&n.splice(a,1)}function L_(n){let i=[];return n.forEach(a=>{i.indexOf(a)===-1&&i.push(a)}),i}function In(n){Et!==void 0?Et.resolve().then(n):setTimeout(n,0)}function Fn(n){return JSON.parse(JSON.stringify(n))}function Fs(n){try{return Fn(n)}catch{return n}}let SS={};function la(n,i){SS[i]||(SS[i]=!0,n())}function fr(n){let i=window.atob(n),a=new Uint8Array(new ArrayBuffer(i.length));for(let c=0;c<i.length;c+=1)a[c]=i.charCodeAt(c);return a}function Gs(n){let i="";for(let a=0;a<n.length;a+=1)i+=String.fromCharCode(n[a]);return window.btoa(i)}function Fb(n){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:16,a=new TextEncoder().encode(n);if(a.length>i)a=a.slice(0,i);else if(a.length<i){let c=new Uint8Array(i);c.set(a),a=c}return a}function na(){for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];let c=Ds(i).call(i,(S,C)=>S+C.length,0),u=new Uint8Array(new ArrayBuffer(c)),_=0;return i.forEach(S=>{u.set(S,_),_+=S.length}),u}function Qd(n){return window.TextEncoder?new TextEncoder().encode(n).length:n.length}function yS(n){let i=0;return(/DingTalk/i.test(navigator.userAgent)||/AliApp/i.test(navigator.userAgent))&&n.realFormData&&(n=n.realFormData),n.forEach(a=>{i+=typeof a=="string"?Qd(a):a.size}),i+138}function gL(n){let i=new Ye(oe.TIMEOUT,"timeout");return new Et((a,c)=>{window.setTimeout(()=>c(i),n)})}function Mn(n){return new Et(i=>{window.setTimeout(i,n)})}function gr(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:7,i=arguments.length>1?arguments[1]:void 0,a=Math.random().toString(16).substr(2,n).toLowerCase();return a.length===n?"".concat(i).concat(a):"".concat(i).concat(a)+gr(n-a.length,"")}function D_(){return gr(32,"").toUpperCase()}let ph=()=>{},P_=new class{constructor(){un(this,"fnMap",new Map)}throttleByKey(n,i,a,c){for(var u=arguments.length,_=new Array(u>4?u-4:0),S=4;S<u;S++)_[S-4]=arguments[S];if(this.fnMap.has(i)){let C=this.fnMap.get(i);if(C.threshold!==a){C.fn(...C.args),clearTimeout(C.timer);let R=window.setTimeout(()=>{let e=this.fnMap.get(i);e&&e.fn(...e.args),this.fnMap.delete(i)},a);this.fnMap.set(i,{fn:n,threshold:a,timer:R,args:_,skipFn:c})}else C.skipFn&&C.skipFn(...C.args),this.fnMap.set(i,Ct(Ct({},C),{},{fn:n,args:_,skipFn:c}))}else{let C=window.setTimeout(()=>{let R=this.fnMap.get(i);R&&R.fn(...R.args),this.fnMap.delete(i)},a);this.fnMap.set(i,{fn:n,threshold:a,timer:C,args:_,skipFn:c})}}},Lg=P_.throttleByKey.bind(P_);function bx(n){return typeof n=="object"&&n!==null&&!(n instanceof RegExp)}function _L(n,i){if(!bx(n)||!bx(i)||Array.isArray(n)&&!Array.isArray(i)||!Array.isArray(n)&&Array.isArray(i))return i;if(Array.isArray(i)&&Array.isArray(n)){let a=[...n];for(let c=0;c<i.length;c++)a[c]=_L(n[c],i[c]);return a}{let a=Ct({},n);for(let c in i)Object.prototype.hasOwnProperty.call(i,c)&&(Object.prototype.hasOwnProperty.call(n,c)?a[c]=_L(n[c],i[c]):a[c]=i[c]);return a}}function mh(n,i){let a=[0];if(a=new Array(i).fill(0),n===0)return a;let c=0;for(;n>0&&(a[c]=255&n,n>>=8,c++,c!==i););return a}function EL(n){return typeof n=="number"?n:n.exact||n.ideal||n.max||n.min||0}function d8(n){let i="0123456789abcdef";function a(A){let O,D="";for(O=0;O<=3;O++)D+=i.charAt(A>>8*O+4&15)+i.charAt(A>>8*O&15);return D}function c(A,O){let D=(65535&A)+(65535&O);return(A>>16)+(O>>16)+(D>>16)<<16|65535&D}function u(A,O,D,P,F,B){return c(function(Y,$){return Y<<$|Y>>>32-$}(c(c(O,A),c(P,B)),F),D)}function _(A,O,D,P,F,B,Y){return u(O&D|~O&P,A,O,F,B,Y)}function S(A,O,D,P,F,B,Y){return u(O&P|D&~P,A,O,F,B,Y)}function C(A,O,D,P,F,B,Y){return u(O^D^P,A,O,F,B,Y)}function R(A,O,D,P,F,B,Y){return u(D^(O|~P),A,O,F,B,Y)}let e=function(A){let O,D=1+(A.length+8>>6),P=new Array(16*D);for(O=0;O<16*D;O++)P[O]=0;for(O=0;O<A.length;O++)P[O>>2]|=A.charCodeAt(O)<<O%4*8;return P[O>>2]|=128<<O%4*8,P[16*D-2]=8*A.length,P}(n),t,r,s,l,f,m=1732584193,E=-271733879,y=-1732584194,b=271733878;for(t=0;t<e.length;t+=16)r=m,s=E,l=y,f=b,m=_(m,E,y,b,e[t+0],7,-680876936),b=_(b,m,E,y,e[t+1],12,-389564586),y=_(y,b,m,E,e[t+2],17,606105819),E=_(E,y,b,m,e[t+3],22,-1044525330),m=_(m,E,y,b,e[t+4],7,-176418897),b=_(b,m,E,y,e[t+5],12,1200080426),y=_(y,b,m,E,e[t+6],17,-1473231341),E=_(E,y,b,m,e[t+7],22,-45705983),m=_(m,E,y,b,e[t+8],7,1770035416),b=_(b,m,E,y,e[t+9],12,-1958414417),y=_(y,b,m,E,e[t+10],17,-42063),E=_(E,y,b,m,e[t+11],22,-1990404162),m=_(m,E,y,b,e[t+12],7,1804603682),b=_(b,m,E,y,e[t+13],12,-40341101),y=_(y,b,m,E,e[t+14],17,-1502002290),E=_(E,y,b,m,e[t+15],22,1236535329),m=S(m,E,y,b,e[t+1],5,-165796510),b=S(b,m,E,y,e[t+6],9,-1069501632),y=S(y,b,m,E,e[t+11],14,643717713),E=S(E,y,b,m,e[t+0],20,-373897302),m=S(m,E,y,b,e[t+5],5,-701558691),b=S(b,m,E,y,e[t+10],9,38016083),y=S(y,b,m,E,e[t+15],14,-660478335),E=S(E,y,b,m,e[t+4],20,-405537848),m=S(m,E,y,b,e[t+9],5,568446438),b=S(b,m,E,y,e[t+14],9,-1019803690),y=S(y,b,m,E,e[t+3],14,-187363961),E=S(E,y,b,m,e[t+8],20,1163531501),m=S(m,E,y,b,e[t+13],5,-1444681467),b=S(b,m,E,y,e[t+2],9,-51403784),y=S(y,b,m,E,e[t+7],14,1735328473),E=S(E,y,b,m,e[t+12],20,-1926607734),m=C(m,E,y,b,e[t+5],4,-378558),b=C(b,m,E,y,e[t+8],11,-2022574463),y=C(y,b,m,E,e[t+11],16,1839030562),E=C(E,y,b,m,e[t+14],23,-35309556),m=C(m,E,y,b,e[t+1],4,-1530992060),b=C(b,m,E,y,e[t+4],11,1272893353),y=C(y,b,m,E,e[t+7],16,-155497632),E=C(E,y,b,m,e[t+10],23,-1094730640),m=C(m,E,y,b,e[t+13],4,681279174),b=C(b,m,E,y,e[t+0],11,-358537222),y=C(y,b,m,E,e[t+3],16,-722521979),E=C(E,y,b,m,e[t+6],23,76029189),m=C(m,E,y,b,e[t+9],4,-640364487),b=C(b,m,E,y,e[t+12],11,-421815835),y=C(y,b,m,E,e[t+15],16,530742520),E=C(E,y,b,m,e[t+2],23,-995338651),m=R(m,E,y,b,e[t+0],6,-198630844),b=R(b,m,E,y,e[t+7],10,1126891415),y=R(y,b,m,E,e[t+14],15,-1416354905),E=R(E,y,b,m,e[t+5],21,-57434055),m=R(m,E,y,b,e[t+12],6,1700485571),b=R(b,m,E,y,e[t+3],10,-1894986606),y=R(y,b,m,E,e[t+10],15,-1051523),E=R(E,y,b,m,e[t+1],21,-2054922799),m=R(m,E,y,b,e[t+8],6,1873313359),b=R(b,m,E,y,e[t+15],10,-30611744),y=R(y,b,m,E,e[t+6],15,-1560198380),E=R(E,y,b,m,e[t+13],21,1309151649),m=R(m,E,y,b,e[t+4],6,-145523070),b=R(b,m,E,y,e[t+11],10,-1120210379),y=R(y,b,m,E,e[t+2],15,718787259),E=R(E,y,b,m,e[t+9],21,-343485551),m=c(m,r),E=c(E,s),y=c(y,l),b=c(b,f);return a(m)+a(E)+a(y)+a(b)}let fs=1,Br=console,Na=class{static setLogger(n){Br=n}constructor(n,i){un(this,"id",void 0),un(this,"lockingPromise",Et.resolve()),un(this,"locks",0),un(this,"name",""),un(this,"lockId",void 0),this.lockId=fs++,n&&(this.name=n),i&&(this.id=i),this.logger("created")}logger(n,i){let a=(this.id?"[".concat(this.id,"]"):"")+"[lock-".concat(this.name,"-").concat(this.lockId,"]"),c=n==="created"?"is ".concat(n,"."):"is ".concat(n,", current queue ").concat(this.locks,". ").concat(i??"");Br.debug("".concat(a," ").concat(c))}setId(n){this.id=n}get isLocked(){return this.locks>0}lock(n){let i;this.locks+=1,this.logger("locked",n);let a=new Et(u=>{i=()=>{this.locks-=1,this.logger("unlocked",n),u()}}),c=this.lockingPromise.then(()=>i);return this.lockingPromise=this.lockingPromise.then(()=>a),c}};function Dg(n,i){return function(a,c,u){let _=u.value;if(typeof _!="function")throw new Error("Cannot use mutex on object property.");return u.value=async function(){let S=this[i];if(!S)throw new Error("mutex property key ".concat(i," doesn't exist on ").concat(n));let C=await S.lock("From ".concat(n,".").concat(c));try{for(var R=arguments.length,e=new Array(R),t=0;t<R;t++)e[t]=arguments[t];return await _.apply(this,e)}finally{C()}},u}}let da={timeout:500,timeoutFactor:1.5,maxRetryCount:1/0,maxRetryTimeout:1e4};function vL(n,i){let a=Math.floor(i.timeout*Math.pow(i.timeoutFactor,n));return Math.min(i.maxRetryTimeout,a)}function Xu(n,i,a,c){let u=Object.assign({},da,c),_=u.timeout,S=async()=>{await function(e){return new Et(t=>{window.setTimeout(t,e)})}(_),_*=u.timeoutFactor,_=Math.min(u.maxRetryTimeout,_)},C=!1,R=new Et(async(e,t)=>{i=i||(()=>!1),a=a||(()=>!0);for(let r=0;r<u.maxRetryCount;r+=1){if(C)return t(new Ye(oe.OPERATION_ABORTED));try{let s=await n();if(!i(s,r)||r+1===u.maxRetryCount)return e(s);await S()}catch(s){if(!a(s,r)||r+1===u.maxRetryCount)return t(s);await S()}}});return R.cancel=()=>C=!0,R}let Gb,Cx=class{constructor(n){un(this,"input",[]),un(this,"size",void 0),this.size=n}add(n){this.input.push(n),this.input.length>this.size&&this.input.splice(0,1)}mean(){var n;return this.input.length===0?0:Ds(n=this.input).call(n,(i,a)=>i+a)/this.input.length}},zb=0,aI=0;function SL(n,i,a,c){return new Et((u,_)=>{i.responseType=i.responseType||"json",i.data&&!a?(i.data=JSON.stringify(i.data),zb+=Qd(i.data)):a&&(i.data.size?zb+=i.data.size:i.data instanceof FormData?zb+=yS(i.data):zb+=Qd(JSON.stringify(i.data))),i.headers=i.headers||{},i.headers["Content-Type"]=i.headers["Content-Type"]||"application/json",i.method="POST",i.url=n,eo.request(i).then(S=>{typeof S.data=="string"?aI+=Qd(S.data):S.data instanceof ArrayBuffer||S.data instanceof Uint8Array?aI+=S.data.byteLength:aI+=Qd(JSON.stringify(S.data)),u(S.data)}).catch(S=>{eo.isCancel(S)?_(new Ye(oe.OPERATION_ABORTED,"cancel token canceled")):S.code==="ECONNABORTED"?_(new Ye(oe.NETWORK_TIMEOUT,S.message)):S.response?_(new Ye(oe.NETWORK_RESPONSE_ERROR,S.response.status)):_(new Ye(oe.NETWORK_ERROR,S.message))})})}async function oY(n,i){let a=new Blob([i.data],{type:"buffer"});return await SL(n,Ct(Ct({},i),{},{data:a,headers:{"Content-Type":"application/octet-stream"}}),!0)}let wx=()=>window.isSecureContext!==void 0;function Gi(n){if(Array.isArray(n))return n.map(a=>a);if(!TS(n))return n;let i={};for(let a in n){let c=n[a];TS(c)||Array.isArray(c)?i[a]=Gi(c):i[a]=c}return i}function TS(n){return!(typeof n!="object"||Array.isArray(n)||!n)}let ra=class{constructor(n){un(this,"input",[]),un(this,"size",void 0),this.size=n}add(n){this.input.push(n),this.input.length>this.size&&this.input.splice(0,1)}diffMean(){return this.input.length===0?0:(this.input[this.input.length-1]-this.input[0])/this.input.length}},Qu={address:"unknown",candidateType:"unknown",id:"unknown",port:0,priority:0,protocol:"unknown",type:"unknown"},_l={timestamp:0,bitrate:{actualEncoded:0,transmit:0},sendPacketLossRate:0,recvPacketLossRate:0,videoRecv:[],videoSend:[],audioRecv:[],audioSend:[],selectedCandidatePair:{id:"unknown",localCandidate:Qu,remoteCandidate:Qu},updateInterval:0},sI={firsCount:0,nacksCount:0,plisCount:0,framesDecodeCount:0,framesDecodeInterval:0,framesDecodeFreezeTime:0,decodeFrameRate:0,bytes:0,packetsLost:0,packetLostRate:0,packets:0,ssrc:0,qpSumPerFrame:0,framesDroppedCount:0,outputFrameRate:0,packetsDiscarded:0,framesAssembledFromMultiplePackets:0,totalProcessingDelay:0,avgDecodeMs:0,avgFramesAssembledFromMultiplePacketsMs:0,avgProcessingDelayMs:0,avgInterFrameDelayMs:0,totalAssemblyTime:0},Rx={firsCount:0,nacksCount:0,plisCount:0,frameCount:0,bytes:0,packets:0,packetsLost:0,packetLostRate:0,ssrc:0,rttMs:0,jitterMs:0,qpSumPerFrame:0},oI={bytes:0,packets:0,packetsLost:0,packetLostRate:0,ssrc:0,rttMs:0,jitterMs:0},yL={jitterBufferMs:0,jitterMs:0,bytes:0,packetsLost:0,packetLostRate:0,packetsDiscarded:0,packets:0,ssrc:0,receivedFrames:0,droppedFrames:0,concealedSamples:0,totalSamplesReceived:0},cI=class{constructor(n,i){un(this,"onFirstVideoReceived",void 0),un(this,"onFirstVideoDecoded",void 0),un(this,"onFirstAudioReceived",void 0),un(this,"onFirstVideoDecodedTimeout",void 0),un(this,"onFirstAudioDecoded",void 0),un(this,"onSelectedLocalCandidateChanged",void 0),un(this,"onSelectedRemoteCandidateChanged",void 0),un(this,"videoIsReady",!1),un(this,"videoIsReady2",{}),un(this,"pc",void 0),un(this,"options",void 0),un(this,"intervalTimer",void 0),un(this,"stats",Gi(_l)),un(this,"isFirstVideoReceived",{}),un(this,"isFirstVideoDecoded",{}),un(this,"isFirstAudioReceived",{}),un(this,"isFirstAudioDecoded",{}),un(this,"isFirstVideoDecodedTimeout",{}),un(this,"lossRateWindowStats",[]),this.pc=n,this.options=i,this.intervalTimer=window.setInterval(async()=>{this.updateStats()},this.options.updateInterval)}getStats(){return this.stats}getSelectedCandidatePair(){return new Et(n=>{n({local:Ct({},Qu),remote:Ct({},Qu)})})}setVideoIsReady(n){this.videoIsReady=n}setVideoIsReady2(n,i){this.videoIsReady2[n]=i}getVideoIsReady(n){return this.videoIsReady2[n]||!1}setIsFirstAudioDecoded(n){}destroy(){window.clearInterval(this.intervalTimer),this.pc=void 0}calcLossRate(n){this.lossRateWindowStats.push(n),this.lossRateWindowStats.length>this.options.lossRateInterval&&this.lossRateWindowStats.splice(0,1);let i=this.lossRateWindowStats.length,a=["videoSend","audioSend","videoRecv","audioRecv"],c=0,u=0,_=0,S=0;for(let C of a)n[C].forEach((R,e)=>{if(!this.lossRateWindowStats[i-1][C][e]||!this.lossRateWindowStats[0][C][e])return;let t=this.lossRateWindowStats[i-1][C][e].packets-this.lossRateWindowStats[0][C][e].packets,r=this.lossRateWindowStats[i-1][C][e].packetsLost-this.lossRateWindowStats[0][C][e].packetsLost;C==="videoSend"||C==="audioSend"?(c+=t,_+=r):(u+=t,S+=r),Number.isNaN(t)||Number.isNaN(t)?R.packetLostRate=0:R.packetLostRate=t<=0||r<=0?0:r/(t+r)});n.sendPacketLossRate=c<=0||_<=0?0:_/(c+_),n.recvPacketLossRate=u<=0||S<=0?0:S/(u+S)}},cY=class extends cI{constructor(){super(...arguments),un(this,"_stats",_l),un(this,"lastDecodeVideoReceiverStats",new Map)}async updateStats(){let n=await this._getStats(),i=this.statsResponsesToObjects(n);this._stats=Gi(_l);let a=i.filter(u=>u.type==="ssrc");this.processSSRCStats(a);let c=i.find(u=>u.type==="VideoBwe");c&&this.processBandwidthStats(c),this._stats.timestamp=Date.now(),this.calcLossRate(this._stats),this.stats=this._stats}processBandwidthStats(n){this._stats.bitrate={actualEncoded:Number(n.googActualEncBitrate),targetEncoded:Number(n.googTargetEncBitrate),retransmit:Number(n.googRetransmitBitrate),transmit:Number(n.googTransmitBitrate)},this._stats.sendBandwidth=Number(n.googAvailableSendBandwidth)}processSSRCStats(n){n.forEach(i=>{var a;let c=ft(a=i.id).call(a,"send");switch("".concat(i.mediaType,"_").concat(c?"send":"recv")){case"video_send":{let u=Gi(Rx);u.codec=i.googCodecName,u.adaptionChangeReason="none",i.googCpuLimitedResolution&&(u.adaptionChangeReason="cpu"),i.googBandwidthLimitedResolution&&(u.adaptionChangeReason="bandwidth"),u.avgEncodeMs=Number(i.googAvgEncodeMs),u.inputFrame={width:Number(i.googFrameWidthInput)||Number(i.googFrameWidthSent),height:Number(i.googFrameHeightInput)||Number(i.googFrameHeightSent),frameRate:Number(i.googFrameRateInput)},u.sentFrame={width:Number(i.googFrameWidthSent),height:Number(i.googFrameHeightSent),frameRate:Number(i.googFrameRateInput)},u.firsCount=Number(i.googFirReceived),u.nacksCount=Number(i.googNacksReceived),u.plisCount=Number(i.googPlisReceived),u.frameCount=Number(i.framesEncoded),u.bytes=Number(i.bytesSent),u.packets=Number(i.packetsSent),u.packetsLost=Number(i.packetsLost),u.ssrc=Number(i.ssrc),u.rttMs=Number(i.googRtt||0),this._stats.videoSend.push(u),this._stats.rtt=u.rttMs;break}case"video_recv":{let u=Gi(sI),_=this.lastDecodeVideoReceiverStats.get(Number(i.ssrc));if(u.codec=i.googCodecName,u.targetDelayMs=Number(i.googTargetDelayMs),u.renderDelayMs=Number(i.googRenderDelayMs),u.currentDelayMs=Number(i.googCurrentDelayMs),u.minPlayoutDelayMs=Number(i.googMinPlayoutDelayMs),u.decodeMs=Number(i.googDecodeMs),u.maxDecodeMs=Number(i.googMaxDecodeMs),u.receivedFrame={width:Number(i.googFrameWidthReceived),height:Number(i.googFrameHeightReceived),frameRate:Number(i.googFrameRateReceived)},u.decodedFrame={width:Number(i.googFrameWidthReceived),height:Number(i.googFrameHeightReceived),frameRate:Number(i.googFrameRateDecoded)},u.decodeFrameRate=Number(i.googFrameRateDecoded),u.outputFrame={width:Number(i.googFrameWidthReceived),height:Number(i.googFrameHeightReceived),frameRate:Number(i.googFrameRateOutput)},u.jitterBufferMs=Number(i.googJitterBufferMs),u.firsCount=Number(i.googFirsSent),u.nacksCount=Number(i.googNacksSent),u.plisCount=Number(i.googPlisSent),u.framesDecodeCount=Number(i.framesDecoded),u.bytes=Number(i.bytesReceived),u.packets=Number(i.packetsReceived),u.packetsLost=Number(i.packetsLost),u.ssrc=Number(i.ssrc),u.packets>0&&!this.isFirstVideoReceived[u.ssrc]&&(this.onFirstVideoReceived&&this.onFirstVideoReceived(u.ssrc),this.isFirstVideoReceived[u.ssrc]=!0),u.framesDecodeCount>0&&!this.isFirstVideoDecoded[u.ssrc]&&(this.onFirstVideoDecoded&&this.onFirstVideoDecoded(u.ssrc,u.decodedFrame.width,u.decodedFrame.height),this.isFirstVideoDecoded[u.ssrc]=!0),_){let S=_.stats,C=Date.now()-_.lts;u.framesDecodeFreezeTime=S.framesDecodeFreezeTime,u.framesDecodeInterval=S.framesDecodeInterval,u.framesDecodeCount>S.framesDecodeCount&&this.isFirstVideoDecoded[u.ssrc]?(_.lts=Date.now(),u.framesDecodeInterval=C,u.framesDecodeInterval>=this.options.freezeRateLimit&&(this.getVideoIsReady(parseInt(i.ssrc,10))?u.framesDecodeFreezeTime+=u.framesDecodeInterval:this.setVideoIsReady2(parseInt(i.ssrc,10),!0))):u.framesDecodeCount<_.stats.framesDecodeCount&&(u.framesDecodeInterval=0)}this.lastDecodeVideoReceiverStats.set(u.ssrc,{stats:Ct({},u),lts:Date.now()}),this._stats.videoRecv.push(u);break}case"audio_recv":{let u=Gi(yL);u.codec=i.googCodecName,u.outputLevel=Math.abs(Number(i.audioOutputLevel))/32767,u.decodingCNG=Number(i.googDecodingCNG),u.decodingCTN=Number(i.googDecodingCTN),u.decodingCTSG=Number(i.googDecodingCTSG),u.decodingNormal=Number(i.googDecodingNormal),u.decodingPLC=Number(i.googDecodingPLC),u.decodingPLCCNG=Number(i.googDecodingPLCCNG),u.expandRate=Number(i.googExpandRate),u.accelerateRate=Number(i.googAccelerateRate),u.preemptiveExpandRate=Number(i.googPreemptiveExpandRate),u.secondaryDecodedRate=Number(i.googSecondaryDecodedRate),u.speechExpandRate=Number(i.googSpeechExpandRate),u.preferredJitterBufferMs=Number(i.googPreferredJitterBufferMs),u.jitterBufferMs=Number(i.googJitterBufferMs),u.jitterMs=Number(i.googJitterReceived),u.bytes=Number(i.bytesReceived),u.packets=Number(i.packetsReceived),u.packetsLost=Number(i.packetsLost),u.ssrc=Number(i.ssrc),u.receivedFrames=Number(i.googDecodingCTN)||Number(i.packetsReceived),u.droppedFrames=Number(i.googDecodingPLC)+Number(i.googDecodingPLCCNG)||Number(i.packetsLost),u.receivedFrames>0&&!this.isFirstAudioReceived[u.ssrc]&&(this.onFirstAudioReceived&&this.onFirstAudioReceived(u.ssrc),this.isFirstAudioReceived[u.ssrc]=!0),u.decodingNormal>0&&!this.isFirstAudioDecoded[u.ssrc]&&(this.onFirstAudioDecoded&&this.onFirstAudioDecoded(u.ssrc),this.isFirstAudioDecoded[u.ssrc]=!0),this._stats.audioRecv.push(u);break}case"audio_send":{let u=Gi(oI);u.codec=i.googCodecName,u.inputLevel=Math.abs(Number(i.audioInputLevel))/32767,u.aecReturnLoss=Number(i.googEchoCancellationReturnLoss||0),u.aecReturnLossEnhancement=Number(i.googEchoCancellationReturnLossEnhancement||0),u.residualEchoLikelihood=Number(i.googResidualEchoLikelihood||0),u.residualEchoLikelihoodRecentMax=Number(i.googResidualEchoLikelihoodRecentMax||0),u.bytes=Number(i.bytesSent),u.packets=Number(i.packetsSent),u.packetsLost=Number(i.packetsLost),u.ssrc=Number(i.ssrc),u.rttMs=Number(i.googRtt||0),this._stats.rtt=u.rttMs,this._stats.audioSend.push(u);break}}})}_getStats(){return new Et((n,i)=>{this.pc.getStats(n,i)})}statsResponsesToObjects(n){let i=[];return n.result().forEach(a=>{let c={id:a.id,timestamp:a.timestamp.valueOf().toString(),type:a.type};a.names().forEach(u=>{c[u]=a.stat(u)}),i.push(c)}),i}},Hb=function(n){return n.BANDWIDTH="bandwidth",n.CPU="cpu",n.NONE="none",n.OTHER="other",n}({}),El=function(n){return n.L1T1="L1T1",n.L1T2="L1T2",n.L1T3="L1T3",n.L1T3_KEY="L1T3_KEY",n.L2T1_KEY="L2T1_KEY",n.L2T2_KEY="L2T2_KEY",n.L2T3_KEY="L2T3_KEY",n.L3T1_KEY="L3T1_KEY",n.L3T2_KEY="L3T2_KEY",n.L3T3_KEY="L3T3_KEY",n}({}),TL=function(n){return n[n.new=0]="new",n[n.connecting=1]="connecting",n[n.connected=2]="connected",n[n.disconnected=3]="disconnected",n[n.failed=4]="failed",n[n.closed=5]="closed",n}({}),jc=function(n){return n.CERTIFICATE="certificate",n.CODEC="codec",n.CANDIDATE_PAIR="candidate-pair",n.LOCAL_CANDIDATE="local-candidate",n.REMOTE_CANDIDATE="remote-candidate",n.INBOUND="inbound-rtp",n.TRACK="track",n.OUTBOUND="outbound-rtp",n.PC="peer-connection",n.REMOTE_INBOUND="remote-inbound-rtp",n.REMOTE_OUTBOUND="remote-outbound-rtp",n.TRANSPORT="transport",n.CSRC="csrc",n.DATA_CHANNEL="data-channel",n.STREAM="stream",n.SENDER="sender",n.RECEIVER="receiver",n}({});var vl=function(n){return n[n.kNone=1]="kNone",n[n.kMillisecondsFromSeconds=1e3]="kMillisecondsFromSeconds",n[n.kBytesToBits=8]="kBytesToBits",n}(vl||{});function Pg(n,i,a,c){let u=arguments.length>4&&arguments[4]!==void 0?arguments[4]:vl.kNone;if(!i)return;let _=Number(i[a]);if(typeof _!="number")return;let S=Number(i[c]);if(typeof S!="number")return;if(!n)return S?_/S*u:void 0;let C=Number(n[a]);if(typeof C!="number")return;let R=Number(n[c]);if(typeof R!="number")return;let e=S-R;return e?(_-C)/e*u:void 0}let Ix=class extends cI{constructor(){super(...arguments),un(this,"_stats",_l),un(this,"report",void 0),un(this,"lastDecodeVideoReceiverStats",new Map),un(this,"lastVideoFramesRecv",new Map),un(this,"lastVideoFramesSent",new Map),un(this,"lastVideoFramesDecode",new Map),un(this,"lastVideoFramesOutput",new Map),un(this,"lastVideoJBDelay",new Map),un(this,"lastAudioJBDelay",new Map),un(this,"mediaBytesSent",new Map),un(this,"mediaBytesRetransmit",new Map),un(this,"mediaBytesTargetEncode",new Map),un(this,"lastDecodeAudioReceiverStats",new Map),un(this,"lastEncoderMs",new Map)}async updateStats(){this.report=await this.pc.getStats(),this._stats=Gi(_l),this.report.forEach(n=>{switch(n.type){case jc.OUTBOUND:case jc.INBOUND:{let i=n.mediaType||n.kind,a=!i&&"frameWidth"in n,c=!i&&!("frameWidth"in n);n.type===jc.OUTBOUND?i==="audio"||c?this.processAudioOutboundStats(n):(i==="video"||a)&&this.processVideoOutboundStats(n):n.type===jc.INBOUND&&(i==="audio"||c?this.processAudioInboundStats(n):(i==="video"||a)&&this.processVideoInboundStats(n));break}case jc.TRANSPORT:{let i=this.report.get(n.selectedCandidatePairId);i&&this.processCandidatePairStats(i);break}case jc.CANDIDATE_PAIR:n.selected&&this.processCandidatePairStats(n)}}),this.updateSendBitrate(),this._stats.updateInterval=Date.now()-this.stats.timestamp,this._stats.timestamp=Date.now(),this.calcLossRate(this._stats),this.stats=this._stats}async getSelectedCandidatePair(){let n=await this.pc.getStats(),i={local:Ct({},Qu),remote:Ct({},Qu)};return n.forEach(a=>{let c;if(a.type===jc.TRANSPORT&&(c=n.get(a.selectedCandidatePairId)),a.type===jc.CANDIDATE_PAIR&&a.selected&&(c=a),c){let u=(_,S)=>{_.type=S.type,_.id=S.id,S.address&&(_.address=S.address),S.candidateType&&(_.candidateType=S.candidateType),S.port&&(_.port=S.port),S.priority&&(_.priority=S.priority),S.protocol&&(_.protocol=S.protocol),S.relayProtocol&&(_.relayProtocol=S.relayProtocol)};if(c.localCandidateId){let _=n.get(c.localCandidateId);_&&u(i.local,_)}if(c.remoteCandidateId){let _=n.get(c.remoteCandidateId);_&&u(i.remote,_)}}}),i}processCandidatePairStats(n){if(this._stats.sendBandwidth=n.availableOutgoingBitrate||0,n.currentRoundTripTime&&(this._stats.rtt=1e3*n.currentRoundTripTime),this._stats.videoSend.forEach(i=>{n.currentRoundTripTime&&(i.rttMs=1e3*n.currentRoundTripTime)}),this._stats.audioSend.forEach(i=>{n.currentRoundTripTime&&(i.rttMs=1e3*n.currentRoundTripTime)}),this._stats.selectedCandidatePair.id=n.id,n.localCandidateId){let i=this.report.get(n.localCandidateId);i&&this.processCandidateStats(i)}if(n.remoteCandidateId){let i=this.report.get(n.remoteCandidateId);i&&this.processCandidateStats(i)}}processCandidateStats(n){let i;n.type===jc.LOCAL_CANDIDATE&&(i=this._stats.selectedCandidatePair.localCandidate),n.type===jc.REMOTE_CANDIDATE&&(i=this._stats.selectedCandidatePair.remoteCandidate),i&&(i.type=n.type,i.id=n.id,n.address&&(i.address=n.address),n.candidateType&&(i.candidateType=n.candidateType),n.port&&(i.port=n.port),n.priority&&(i.priority=n.priority),n.protocol&&(i.protocol=n.protocol),n.relayProtocol&&(i.relayProtocol=n.relayProtocol),n.type===jc.LOCAL_CANDIDATE&&this.stats.selectedCandidatePair.localCandidate.id!==i.id&&this.onSelectedLocalCandidateChanged&&this.onSelectedLocalCandidateChanged(Ct({},i),Ct({},this.stats.selectedCandidatePair.localCandidate)),n.type===jc.REMOTE_CANDIDATE&&this.stats.selectedCandidatePair.remoteCandidate.id!==i.id&&this.onSelectedRemoteCandidateChanged&&this.onSelectedRemoteCandidateChanged(Ct({},i),Ct({},this.stats.selectedCandidatePair.remoteCandidate)))}processAudioInboundStats(n){let i=this._stats.audioRecv.find(c=>c.ssrc===n.ssrc);i||(i=Gi(yL),this._stats.audioRecv.push(i)),i.ssrc=n.ssrc,i.packets=n.packetsReceived,i.packetsLost=n.packetsLost,i.packetsDiscarded=n.packetsDiscarded,i.bytes=n.bytesReceived,i.jitterMs=1e3*n.jitter,i.retransmittedBytesReceived=n.retransmittedBytesReceived,i.retransmittedPacketsReceived=n.retransmittedPacketsReceived,i.totalProcessingDelay=n.totalProcessingDelay,i.jitterBufferEmittedCount=n.jitterBufferEmittedCount;let a=this.lastDecodeAudioReceiverStats.get(i.ssrc);i.avgProcessingDelayMs=Pg(a,i,"totalProcessingDelay","jitterBufferEmittedCount",vl.kMillisecondsFromSeconds),this.processAudioTrackReceiverStats(n,n.trackId,i),n.codecId&&(i.codec=this.getCodecFromCodecStats(n.codecId)),i.receivedFrames||(i.receivedFrames=n.packetsReceived),i.droppedFrames||(i.droppedFrames=n.packetsLost),i.receivedFrames>0&&!this.isFirstAudioReceived[i.ssrc]&&(this.onFirstAudioReceived&&this.onFirstAudioReceived(i.ssrc),this.isFirstAudioReceived[i.ssrc]=!0),i.outputLevel&&i.outputLevel>0&&!this.isFirstAudioDecoded[i.ssrc]&&(this.onFirstAudioDecoded&&this.onFirstAudioDecoded(i.ssrc),this.isFirstAudioDecoded[i.ssrc]=!0),typeof n.concealedSamples=="number"&&(i.concealedSamples=n.concealedSamples),this.lastDecodeAudioReceiverStats.set(i.ssrc,Ct({},i))}processVideoInboundStats(n){let i=this._stats.videoRecv.find(S=>S.ssrc===n.ssrc);i||(i=Gi(sI),this._stats.videoRecv.push(i)),i.ssrc=n.ssrc,i.packets=n.packetsReceived,i.packetsLost=n.packetsLost,i.bytes=n.bytesReceived,i.firsCount=n.firCount,i.nacksCount=n.nackCount,i.plisCount=n.pliCount,i.framesDecodeCount=n.framesDecoded,i.framesDroppedCount=n.framesDropped,i.totalInterFrameDelay=n.totalInterFrameDelay,i.totalSquaredInterFrameDelay=n.totalSquaredInterFrameDelay,i.totalFreezesDuration=n.totalFreezesDuration,i.totalProcessingDelay=n.totalProcessingDelay,i.packetsDiscarded=n.packetsDiscarded,i.framesAssembledFromMultiplePackets=n.framesAssembledFromMultiplePackets,i.totalAssemblyTime=n.totalAssemblyTime,i.keyFramesDecoded=n.keyFramesDecoded,i.retransmittedBytesReceived=n.retransmittedBytesReceived,i.retransmittedPacketsReceived=n.retransmittedPacketsReceived;let a=this.lastDecodeVideoReceiverStats.get(i.ssrc),c=this.lastVideoFramesDecode.get(i.ssrc),u=this.lastVideoFramesOutput.get(i.ssrc),_=Date.now();if(i.framesDecodeCount>0&&!this.isFirstVideoDecoded[i.ssrc]){let S=i.decodedFrame?i.decodedFrame.width:0,C=i.decodedFrame?i.decodedFrame.height:0;this.onFirstVideoDecoded&&this.onFirstVideoDecoded(i.ssrc,S,C),this.isFirstVideoDecoded[i.ssrc]=!0}if(a){let S=a.stats,C=_-a.lts;i.framesDecodeFreezeTime=S.framesDecodeFreezeTime,i.framesDecodeInterval=S.framesDecodeInterval,!this.isFirstVideoDecoded[i.ssrc]&&C>this.options.firstVideoDecodedTimeout&&!this.isFirstVideoDecodedTimeout[i.ssrc]&&(this.onFirstVideoDecodedTimeout&&this.onFirstVideoDecodedTimeout(i.ssrc),this.isFirstVideoDecodedTimeout[i.ssrc]=!0),i.framesDecodeCount>S.framesDecodeCount&&this.isFirstVideoDecoded[i.ssrc]?(a.lts=Date.now(),i.framesDecodeInterval=C,i.framesDecodeInterval>=this.options.freezeRateLimit&&(this.getVideoIsReady(parseInt(n.ssrc))?i.framesDecodeFreezeTime+=i.framesDecodeInterval:this.setVideoIsReady2(parseInt(n.ssrc,10),!0))):i.framesDecodeCount<S.framesDecodeCount&&(i.framesDecodeInterval=0),n.framesDecoded&&n.qpSum&&(a.stats.framesDecodeCount>n.framesDecoded?i.qpSumPerFrame=n.qpSum/n.framesDecoded:i.qpSumPerFrame=(n.qpSum-a.qpSum)/(n.framesDecoded-a.stats.framesDecodeCount))}n.totalDecodeTime&&(i.decodeMs=1e3*n.totalDecodeTime,i.avgDecodeMs=Pg(a==null?void 0:a.stats,i,"decodeMs","framesDecodeCount")),i.avgProcessingDelayMs=Pg(a==null?void 0:a.stats,i,"totalProcessingDelay","framesDecodeCount",vl.kMillisecondsFromSeconds),i.avgFramesAssembledFromMultiplePacketsMs=Pg(a==null?void 0:a.stats,i,"totalAssemblyTime","framesAssembledFromMultiplePackets",vl.kMillisecondsFromSeconds),i.avgInterFrameDelayMs=Pg(a==null?void 0:a.stats,i,"totalInterFrameDelay","framesDecodeCount",vl.kMillisecondsFromSeconds),c&&_-c.lts>=800?(i.decodeFrameRate=Math.round((i.framesDecodeCount-c.count)/((_-c.lts)/1e3)),this.lastVideoFramesDecode.set(i.ssrc,{count:i.framesDecodeCount,lts:_,rate:i.decodeFrameRate})):c?i.decodeFrameRate=c.rate:this.lastVideoFramesDecode.set(i.ssrc,{count:i.framesDecodeCount,lts:_,rate:0}),i.framesDroppedCount&&n.framesReceived&&(u&&_-u.lts>=800?(i.outputFrameRate=Math.round((n.framesReceived-i.framesDroppedCount-u.count)/((_-u.lts)/1e3)),this.lastVideoFramesOutput.set(i.ssrc,{count:n.framesReceived-i.framesDroppedCount,lts:_,rate:Math.max(i.outputFrameRate,0)})):u?i.outputFrameRate=u.rate:this.lastVideoFramesOutput.set(i.ssrc,{count:n.framesReceived-i.framesDroppedCount,lts:_,rate:0})),this.processVideoTrackReceiverStats(n,n.trackId,i),n.codecId&&(i.codec=this.getCodecFromCodecStats(n.codecId)),n.framerateMean&&(i.framesRateFirefox=n.framerateMean),i.packets>0&&!this.isFirstVideoReceived[i.ssrc]&&(this.onFirstVideoReceived&&this.onFirstVideoReceived(i.ssrc),this.isFirstVideoReceived[i.ssrc]=!0),this.lastDecodeVideoReceiverStats.set(i.ssrc,{stats:Ct({},i),lts:a?a.lts:Date.now(),qpSum:n.qpSum})}processVideoOutboundStats(n){let i=this._stats.videoSend.find(c=>c.ssrc===n.ssrc);i||(i=Gi(Rx),this._stats.videoSend.push(i));let a=this.mediaBytesSent.get(n.ssrc);if(a)a.add(n.bytesSent);else{let c=new ra(10);c.add(n.bytesSent),this.mediaBytesSent.set(n.ssrc,c)}if(n.retransmittedBytesSent!==void 0){let c=this.mediaBytesRetransmit.get(n.ssrc);if(c)c.add(n.retransmittedBytesSent);else{let u=new ra(10);u.add(n.retransmittedBytesSent),this.mediaBytesRetransmit.set(n.ssrc,u)}}if(n.totalEncodedBytesTarget){let c=this.mediaBytesTargetEncode.get(n.ssrc);if(c)c.add(n.totalEncodedBytesTarget);else{let u=new ra(10);u.add(n.totalEncodedBytesTarget),this.mediaBytesTargetEncode.set(n.ssrc,u)}}if(i.ssrc=n.ssrc,i.bytes=n.bytesSent,i.packets=n.packetsSent,i.firsCount=n.firCount,i.nacksCount=n.nackCount,i.plisCount=n.pliCount,i.frameCount=n.framesEncoded,i.adaptionChangeReason=n.qualityLimitationReason,i.scalabilityMode=n.scalabilityMode,i.retransmittedBytesSent=n.retransmittedBytesSent,i.retransmittedPacketsSent=n.retransmittedPacketsSent,i.hugeFramesSent=n.hugeFramesSent,i.keyFramesEncoded=n.keyFramesEncoded,n.totalEncodeTime&&n.framesEncoded){let c=this.lastEncoderMs.get(n.ssrc);if(!c||c.lastFrameCount>n.framesEncoded)i.avgEncodeMs=1e3*n.totalEncodeTime/n.framesEncoded;else{let u=n.framesEncoded-c.lastFrameCount,_=n.totalEncodeTime-c.lastEncoderTime;i.avgEncodeMs=1e3*_/u}}if(n.framesEncoded&&n.qpSum){let c=this.lastEncoderMs.get(n.ssrc);!c||c.lastFrameCount>n.framesEncoded?i.qpSumPerFrame=n.qpSum/n.framesEncoded:i.qpSumPerFrame=(n.qpSum-c.lastQpSum)/(n.framesEncoded-c.lastFrameCount)}if(this.lastEncoderMs.set(n.ssrc,{lastFrameCount:n.framesEncoded,lastEncoderTime:n.totalEncodeTime,lastQpSum:n.qpSum,lts:Date.now()}),n.codecId&&(i.codec=this.getCodecFromCodecStats(n.codecId)),n.mediaSourceId&&this.processVideoMediaSource(n.mediaSourceId,i),this.processVideoTrackSenderStats(n,n.trackId,i),n.remoteId)this.processRemoteInboundStats(n.remoteId,i);else{let c=this.findRemoteStatsId(n.ssrc,jc.REMOTE_INBOUND);c&&this.processRemoteInboundStats(c,i)}}processAudioOutboundStats(n){let i=this._stats.audioSend.find(a=>a.ssrc===n.ssrc);if(i||(i=Gi(oI),this._stats.audioSend.push(i)),i.ssrc=n.ssrc,i.packets=n.packetsSent,i.bytes=n.bytesSent,i.retransmittedBytesSent=n.retransmittedBytesSent,i.retransmittedPacketsSent=n.retransmittedPacketsSent,n.mediaSourceId&&this.processAudioMediaSource(n.mediaSourceId,i),n.codecId&&(i.codec=this.getCodecFromCodecStats(n.codecId)),this.processAudioTrackSenderStats(n,n.trackId,i),n.remoteId)this.processRemoteInboundStats(n.remoteId,i);else{let a=this.findRemoteStatsId(n.ssrc,jc.REMOTE_INBOUND);a&&this.processRemoteInboundStats(a,i)}}findRemoteStatsId(n,i){var a;let c=Array.from(Pc(a=this.report).call(a)).find(u=>u.type===i&&u.ssrc===n);return c?c.id:null}processVideoMediaSource(n,i){let a=this.report.get(n);a&&a.width&&a.height&&a.framesPerSecond&&(i.inputFrame={width:a.width,height:a.height,frameRate:a.framesPerSecond})}processAudioMediaSource(n,i){let a=this.report.get(n);a&&(i.inputLevel=a.audioLevel)}processVideoTrackSenderStats(n,i,a){var c,u,_,S;let C=i?this.report.get(i):void 0,R=(c=C==null?void 0:C.framesSent)!==null&&c!==void 0?c:n.framesSent;if(typeof R!="number")return;let e=(u=C==null?void 0:C.frameWidth)!==null&&u!==void 0?u:n.frameWidth,t=(_=C==null?void 0:C.frameHeight)!==null&&_!==void 0?_:n.frameHeight,r=(S=C==null?void 0:C.framesPerSecond)!==null&&S!==void 0?S:n.framesPerSecond;if(typeof e=="number"&&typeof t=="number"||(e=0,t=0),r==null){let s=Date.now(),l=this.lastVideoFramesSent.get(a.ssrc);l&&s-l.lts>=800?(r=Math.round((R-l.count)/((s-l.lts)/1e3)),this.lastVideoFramesSent.set(a.ssrc,{count:R,lts:s,rate:r})):l?r=l.rate:this.lastVideoFramesSent.set(a.ssrc,{count:R,lts:s,rate:0})}a.sentFrame={width:e,height:t,frameRate:Math.max(0,r)}}processVideoTrackReceiverStats(n,i,a){var c,u,_,S,C;let R=i?this.report.get(i):void 0,e=(c=R==null?void 0:R.framesReceived)!==null&&c!==void 0?c:n.framesReceived,t=(u=R==null?void 0:R.frameWidth)!==null&&u!==void 0?u:n.frameWidth,r=(_=R==null?void 0:R.frameHeight)!==null&&_!==void 0?_:n.frameHeight,s=(S=R==null?void 0:R.jitterBufferDelay)!==null&&S!==void 0?S:n.jitterBufferDelay,l=(C=R==null?void 0:R.jitterBufferEmittedCount)!==null&&C!==void 0?C:n.jitterBufferEmittedCount;if(typeof e=="number"){let f=this.lastVideoFramesRecv.get(a.ssrc),m=Date.now();a.framesReceivedCount=e;let E=0;f&&m-f.lts>=800?(E=Math.round((e-f.count)/((m-f.lts)/1e3)),this.lastVideoFramesRecv.set(a.ssrc,{count:e,lts:m,rate:E})):f?E=f.rate:this.lastVideoFramesRecv.set(a.ssrc,{count:e,lts:m,rate:0}),a.receivedFrame={width:t||0,height:r||0,frameRate:E||0},a.decodedFrame={width:t||0,height:r||0,frameRate:a.decodeFrameRate||0},a.outputFrame={width:t||0,height:r||0,frameRate:a.outputFrameRate||a.decodeFrameRate||0}}if(s&&l){let f=this.lastVideoJBDelay.get(a.ssrc)||{jitterBufferDelay:0,jitterBufferEmittedCount:0,jitterBufferMs:0},m=f.jitterBufferMs,E=l-f.jitterBufferEmittedCount;E>0&&(m=1e3*(s-f.jitterBufferDelay)/E),a.jitterBufferMs=m,a.currentDelayMs=Math.round(m),this.lastVideoJBDelay.set(a.ssrc,{jitterBufferDelay:s,jitterBufferEmittedCount:l,jitterBufferMs:a.currentDelayMs})}}processAudioTrackSenderStats(n,i,a){var c,u,_,S;let C=i?this.report.get(i):void 0,R=(c=(u=C==null?void 0:C.echoReturnLoss)!==null&&u!==void 0?u:n.echoReturnLoss)!==null&&c!==void 0?c:0,e=(_=(S=C==null?void 0:C.echoReturnLossEnhancement)!==null&&S!==void 0?S:n.echoReturnLossEnhancement)!==null&&_!==void 0?_:0;a.aecReturnLoss=R,a.aecReturnLossEnhancement=e}processAudioTrackReceiverStats(n,i,a){var c,u,_,S,C,R,e;let t=i?this.report.get(i):void 0,r=(c=t==null?void 0:t.removedSamplesForAcceleration)!==null&&c!==void 0?c:n.removedSamplesForAcceleration,s=(u=t==null?void 0:t.totalSamplesReceived)!==null&&u!==void 0?u:n.totalSamplesReceived,l=(_=t==null?void 0:t.jitterBufferDelay)!==null&&_!==void 0?_:n.jitterBufferDelay,f=(S=t==null?void 0:t.jitterBufferEmittedCount)!==null&&S!==void 0?S:n.jitterBufferEmittedCount,m=(C=t==null?void 0:t.audioLevel)!==null&&C!==void 0?C:n==null?void 0:n.audioLevel,E=(R=t==null?void 0:t.totalSamplesDuration)!==null&&R!==void 0?R:n==null?void 0:n.totalSamplesDuration,y=(e=t==null?void 0:t.concealedSamples)!==null&&e!==void 0?e:n.concealedSamples;if(typeof s=="number"&&(a.totalSamplesReceived=s),r&&s&&(a.accelerateRate=r/s),l&&f){let A=this.lastAudioJBDelay.get(a.ssrc)||{jitterBufferDelay:0,jitterBufferEmittedCount:0,jitterBufferMs:0},O=A.jitterBufferMs,D=f-A.jitterBufferEmittedCount;D>0&&(O=1e3*(l-A.jitterBufferDelay)/D),a.jitterBufferMs=Math.round(O),this.lastAudioJBDelay.set(a.ssrc,{jitterBufferDelay:l,jitterBufferEmittedCount:f,jitterBufferMs:a.jitterBufferMs})}a.outputLevel=m;let b=1920;E&&s&&(b=s/E/50,a.receivedFrames=Math.round(s/b)),y&&(a.droppedFrames=Math.round(y/b))}processRemoteInboundStats(n,i){let a=this.report.get(n);a&&(i.packetsLost=a.packetsLost,a.roundTripTime&&(i.rttMs=1e3*a.roundTripTime),a.jitter&&(i.jitterMs=1e3*a.jitter),a.timestamp&&(i.timestamp=a.timestamp))}getCodecFromCodecStats(n){let i=this.report.get(n);if(!i)return"";let a=i.mimeType.match(/\/(.*)$/);return a&&a[1]?a[1]:""}updateSendBitrate(){let n=0,i=null,a=null;this.mediaBytesSent.forEach(u=>{n+=u.diffMean()}),this.mediaBytesRetransmit.forEach(u=>{i=i===null?u.diffMean():i+u.diffMean()}),this.mediaBytesTargetEncode.forEach(u=>{a=a===null?u.diffMean():a+u.diffMean()});let c=i!==null?n-i:n;this._stats.bitrate={actualEncoded:8*c/(this.options.updateInterval/1e3),transmit:8*n/(this.options.updateInterval/1e3)},i!==null&&(this._stats.bitrate.retransmit=8*i/(this.options.updateInterval/1e3)),a!==null&&(this._stats.bitrate.targetEncoded=8*a/(this.options.updateInterval/1e3))}},u8=class extends cI{updateStats(){return Et.resolve()}};function bL(n){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:250,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:8,c=arguments.length>3&&arguments[3]!==void 0?arguments[3]:500,u=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1e4,_=function(){let S=navigator.userAgent.toLocaleLowerCase().match(/chrome\/[\d]*/i);return S&&S[0]?Number(S[0].split("/")[1]):null}();return _?_<76?new cY(n,{updateInterval:i,lossRateInterval:a,freezeRateLimit:c,firstVideoDecodedTimeout:u}):new Ix(n,{updateInterval:i,lossRateInterval:a,freezeRateLimit:c,firstVideoDecodedTimeout:u}):function(S){if(!window.RTCStatsReport)return!1;let C=S.getStats();return!!(C instanceof Et||function(R){return!!R&&(typeof R=="object"||typeof R=="function")&&typeof R.then=="function"}(C))}(n)?new Ix(n,{updateInterval:i,lossRateInterval:a,freezeRateLimit:c,firstVideoDecodedTimeout:u}):new u8(n,{updateInterval:i,lossRateInterval:a,freezeRateLimit:c,firstVideoDecodedTimeout:u})}let Ax="websdk_ng_install_id";function lI(){try{if(ge("INSTALL_ID"))return ge("INSTALL_ID");let n=window.localStorage.getItem(Ax);return n||(n=D_(),window.localStorage.setItem(Ax,n)),Sr("INSTALL_ID",n),n}catch{return}}let Zd=function(n){if(n.match(/[0-9]+\.[0-9]+\.[0-9]+$/))return n;let i=n.match(/([0-9]+\.[0-9]+\.[0-9]+)\-([0-9]+)/);if(i&&i[1]&&i[2]){let a=i[1],c=i[2];return"".concat(a,".").concat(c)}return"4.0.0.999"}("4.23.2"),bS=function(){try{return JSON.parse("true")===!0}catch{return!0}}(),Fp=function(n){return n.Default="default",n.Auto="auto",n.Relay="relay",n.SdRtn="sd-rtn",n}({}),rs=function(){let n="us".concat("erna","me"),i="pa".concat("sswo","rd"),a=["t","s","t"];a.splice(1,0,"e");let c=a.join(""),u=[];for(let C=0;C<6;C++)u.push("1");let _=u.join(""),S={};return S[n]=c,S[i]=_,Object.assign(S,{turnServerURL:"",tcpport:3433,udpport:3478,forceturn:!1})}();window.DEFAULT_TURN_CONFIG=rs;let cc={ENABLE_PUBLISHED_USER_LIST:!0,MAX_SUBSCRIPTION:50,SUBSCRIBE_AUDIO_FILTER_TOPN:void 0,ENABLE_PUBLISH_AUDIO_FILTER:void 0,ENABLE_USER_LICENSE_CHECK:!0,DISABLE_FEC:void 0,ENABLE_NTP_REPORT:!1,ENABLE_INSTANT_VIDEO:!1,ENABLE_USER_AUTO_REBALANCE_CHECK:!0,ENABLE_LOSSBASED_BWE:!0,ENABLE_AUT_CC:!1,ENABLE_CC_FALLBACK:void 0,SUBSCRIBE_TWCC:!0,PUBLISH_TWCC:!1,ENABLE_SVC_DEFAULT_CODECS:["H264","VP8","VP9","AV1"],SVC:[],ENABLE_FULL_LINK_AV_SYNC:!1,SVC_MODE:null,PRE_SUB_NUM:2,ENABLE_AUT_FEEDBACK:!1,SVC_EXTENDED:["VP9"]},M_={MIN_FRAME_RATE:1,MAX_FRAME_RATE:30,MAX_THRESHOLD_FRAMERATE:30,BITRATE_MIN_THRESHOLD:100,BITRATE_MAX_THRESHOLD:100,MAX_SCALE:5,BWE_SCALE_UP_THRESHOLD:.6,BWE_SCALE_DOWN_THRESHOLD:.6,PERF_SCALE_UP_THRESHOLD:.7,PERF_SCALE_DOWN_THRESHOLD:.6,MOTION_RESOLUTION_FACTOR:.8,MOTION_BITRATE_FACTOR:.6,DETAIL_FRAMERATE_FACTOR:.8,DETAIL_BITRATE_FACTOR:.6,BALANCE_RESOLUTION_FACTOR:.9,BALANCE_FRAMERATE_FACTOR:.9,BALANCE_BITRATE_FACTOR:.6,OVERUSE_TIMES_THRESHOLD:10,UNDERUSE_TIMES_THRESHOLD:40},CS="v4.23.2-0-g1599fdac-dirty(3/4/2025, 5:13:36 PM)",CL={ENABLE_EVENT_REPORT:!0,UPLOAD_LOG:!1,ENABLE_AG_ADAPTATION:!0,FORCE_AG_HIGH_FRAMERATE:!1,FORCE_SUPPORT_AG_ADAPTATION:!1,ENCODER_CONFIG_LIMIT:{},CAMERA_CAPTURE_CONFIG:void 0,ENABLE_PRELOAD:!0,NEW_ICE_RESTART:!1,ICE_RESTART_INTERVAL:1e4,RESTART_SEQUENCE:["udp_tcp_relay","relay"],FIRST_TCP_CANDIDATE:!1,FIRST_TCP_CANDIDATE_INTERVAL:1e3,TURN_DOMAIN:"edge.agora.io",USE_TURN_IP:!1,NEW_TURN_MODE:void 0,NEW_FORCE_TURN:!1},ai=Ct(Ct(Ct({},CL),{},{PROCESS_ID:"",ENCRYPT_AES:!0,AREAS:["CHINA","GLOBAL"],WEBCS_DOMAIN:["webrtc2-ap-web-1.agora.io","webrtc2-2.ap.sd-rtn.com"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-ap-web-3.agora.io","webrtc2-4.ap.sd-rtn.com"],PROXY_CS:["ap-proxy-1.agora.io","ap-proxy-2.agora.io"],CDS_AP:["cds-ap-web-1.agora.io","cds-web-2.ap.sd-rtn.com","cds-ap-web-3.agora.io","cds-web-4.ap.sd-rtn.com"],ACCOUNT_REGISTER:["sua-ap-web-1.agora.io","sua-web-2.ap.sd-rtn.com","sua-ap-web-3.agora.io","sua-web-4.ap.sd-rtn.com"],UAP_AP:["uap-ap-web-1.agora.io","uap-web-2.ap.sd-rtn.com","uap-ap-web-3.agora.io","uap-web-4.ap.sd-rtn.com"],LOG_UPLOAD_SERVER:"logservice.agora.io",EVENT_REPORT_DOMAIN:"statscollector-1.agora.io",EVENT_REPORT_BACKUP_DOMAIN:"web-2.statscollector.sd-rtn.com",GATEWAY_ADDRESS:[],GATEWAY_WSS_ADDRESS:"",LIVE_STREAMING_ADDRESS:"",HTTP_CONNECT_TIMEOUT:5e3,SIGNAL_REQUEST_TIMEOUT:1e4,REPORT_STATS:!0,NOT_REPORT_EVENT:[],PING_PONG_TIME_OUT:10,WEBSOCKET_TIMEOUT_MIN:1e4,EVENT_REPORT_SEND_INTERVAL:3e3,CONFIG_DISTRIBUTE_INTERVAL:3e5,ENABLE_CONFIG_DISTRIBUTE:!0,CANDIDATE_TIMEOUT:5e3,SHOW_REPORT_INVOKER_LOG:!1,SHOW_REPORT_USER_INVOKER_LOG:!0,JOIN_EXTEND:"",PUB_EXTEND:"",SUB_EXTEND:"",FORCE_TURN:!1,TURN_ENABLE_TCP:!0,TURN_ENABLE_UDP:!0,MAX_UPLOAD_CACHE:50,UPLOAD_CACHE_INTERVAL:2e3,AJAX_REQUEST_CONCURRENT:3,REPORT_APP_SCENARIO:void 0,GATEWAY_DOMAINS:["edge.agora.io","edge.sd-rtn.com"],CONNECT_GATEWAY_WITHOUT_DOMAIN:!1,WORKER_DOMAIN:"edge.agora.io",EVENT_REPORT_RETRY:!0,CHROME_FORCE_PLAN_B:!1,AUDIO_SOURCE_VOLUME_UPDATE_INTERVAL:400,AUDIO_SOURCE_AVG_VOLUME_DURATION:3e3,AUDIO_VOLUME_INDICATION_INTERVAL:2e3,VOLUME_VOICE_WEIGHT:10,GET_VOLUME_OF_MUTED_AUDIO_TRACK:!1,STATS_UPDATE_INTERVAL:250,NORMAL_EVENT_QUEUE_CAPACITY:100,CUSTOM_REPORT:!0,CUSTOM_REPORT_LIMIT:20,PROXY_SERVER_TYPE2:"webnginx-proxy.agora.io",PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.sd-rtn.com","webrtc-cloud-proxy.agora.io"],CUSTOM_PUB_ANSWER_MODIFIER:null,CUSTOM_SUB_ANSWER_MODIFIER:null,CUSTOM_PUB_OFFER_MODIFIER:null,CUSTOM_SUB_OFFER_MODIFIER:null,DSCP_TYPE:"high",REMOVE_NEW_CODECS:!0,FRAGEMENT_LENGTH:3,WEBSOCKET_COMPRESS:!1,SIMULCAST:!1,PRELOAD_MEDIA_COUNT:0,CHECK_VIDEO_VISIBLE_INTERVAL:3e4,CHECK_LOCAL_STATS_INTERVAL:250,PROFILE_SWITCH_INTERVAL:2e3,UNSUPPORTED_VIDEO_CODEC:[],ENUMERATE_DEVICES_INTERVAL:!1,ENUMERATE_DEVICES_INTERVAL_TIME:1e4,USE_NEW_TOKEN:!1,CLOSE_AFB_FOR_LOCAL_AP:!0,JOIN_MAX_CONCURRENCY:6,JOIN_WITH_FALLBACK_SIGNAL_PROXY:!0,JOIN_WITH_FALLBACK_MEDIA_PROXY:!0,JOIN_WITH_FALLBACK_MEDIA_PROXY_FORCE:!1,JOIN_GATEWAY_TRY_443PORT_DURATION:2e3,JOIN_GATEWAY_USE_443PORT_ONLY:!1,JOIN_GATEWAY_USE_DUAL_DOMAIN:!0,JOIN_GATEWAY_FALLBACK_PORT:443,USE_TURN_SERVER_OF_GATEWAY:!1,H264_PROFILE_LEVEL_ID:"",USE_NEW_LOG:!1,LOG_VERSION:3,MEDIA_DEVICE_CONSTRAINTS:null,ENCRYPT_PROXY_USERNAME_AND_PSW:!0,SDP_LOGGING:!1,CSP_DETECTED_HOSTNAME_LIST:["agora.io","sd-rtn.com"],REMOTE_AUDIO_TRACK_USES_WEB_AUDIO:!1,LOCAL_AUDIO_TRACK_USES_WEB_AUDIO:!1,BITRATE_ADAPTER_TYPE:"STANDARD_BITRATE",AI_DENOISER_PARAMETERS:{excludedLinks:[]},ADJUST_3A_FROM_PLUGINS:!0,RAISE_H264_BASELINE_PRIORITY:!0,FILTER_SEND_H264_BASELINE:!1,FIRST_H264_PROFILE_LEVEL_ID:"42001f",FIRST_PACKETIZATION_MODE:"",X_GOOGLE_START_BITRATE:void 0,NEW_REPORT_SERVER:!1,NEW_REPORT_SERVER_DOMAINS:["data-reporting.agora.io","data-reporting.agora.io"],VIDEO_INSPECT_WORKER_MESSAGE_LENGTH_LIMIT:3e5,VIDEO_INSPECT_INTERVAL_MINIMUM:1e3,VIDEO_INSPECT_QUALITY_RATIO:.9,VIDEO_INSPECT_WORKER_MANAGER_HOST:"edge.agora.io",VIDEO_INSPECT_WORKER_MANAGER_PORT:"",VIDEO_INSPECT_WORKER_PORT:"",SHOW_VIDEO_INSPECT_WORKER_MESSAGE:!1,STATS_COLLECTOR_PORT:443,FORCE_TURN_TCP:!1,WEBAUDIO_INIT_OPTIONS:void 0,FILTER_VIDEO_FEC:!0,FILTER_AUDIO_FEC:!1,CHROME_DUAL_STREAM_USE_ENCODING:!0,DISABLE_DUAL_STREAM_USE_ENCODING:!1,EXTENSION_USAGE_UPLOAD_INTERVAL:1e4,ICE_RESTART:!0,FINGERPRINT:null,ENABLE_VIDEO_FRAME_CALLBACK:!0,VIDEO_FREEZE_DURATION:500,SPATIALIZER_PARAMETERS:{},UPLOAD_LOG_INTERVAL:3e3,UPLOAD_LOG_REQUEST_RETRY_INTERVAL:2e3,UPLOAD_LOG_REQUEST_MAX_RETRY_INTERVAL:2e4,UPLOAD_LOG_TRY_INTERVAL_WHILE_OFF:5e3,UPLOAD_LOG_RETRY_INTERVAL_V1:1e4,UPLOAD_LOG_TWICE_RETRY_INTERVAL_V1:200,UPLOAD_LOG_LENGTH_EACH_TIME:10,APP_TYPE:0,DISABLE_WEBAUDIO:!1,CHANNEL_MEDIA_RELAY_SERVERS:void 0,KEEP_LAST_FRAME:!0,FORWARD_P2P_CREATION:!0,SYNC_GROUP:!0,BLOCK_LOCAL_CLIENT:!1,ENABLE_AUDIO_TOPN:!1,ENABLE_AUDIO_METADATA:!1,ENABLE_AUDIO_PTS_METADATA:!1,TOPN_SMOOTH_LEVEL:void 0,TOPN_NEW_SPEAKER_DELAY:void 0,TOPN_SWITCH_HOLD_MS:void 0,TOPN_AUDIO_GAIN:void 0,TOPN_SILENCE_THRESHOLD:250,AP_AREA:!0,ENABLE_ENCODED_TRANSFORM:!1,ENABLE_VIDEO_SEI:!1,IMAGE_MODERATION_WORKER_HOST:"edge.agora.io",IMAGE_MODERATION_WORKER_MESSAGE_LENGTH_LIMIT:3e5,IMAGE_MODERATION_INTERVAL_MINIMUM:1e3,SHOW_IMAGE_MODERATION_WORKER_MESSAGE:!1,IMAGE_MODERATION_QUALITY_RATIO:.9,IMAGE_MODERATION_UPLOAD_REPORT_INTERVAL:5e3,SHOW_GLOBAL_CLIENT_LIST:!1,DATASTREAM_MAX_RETRANSMITS:10,TCP_CANDIDATE_ONLY:!1,EXTERNAL_SIGNAL_REQUEST_TIMEOUT:3e3,SHOW_P2P_LOG:!1,MAX_P2P_TIMEOUT:3e4,P2P_TOKEN_INTERVAL:1e3,SHOW_DATASTREAM2_LOG:!1,RESTRICTION_SET_PLAYBACK_DEVICE:!0,USE_PURE_ENCRYPTION_MASTER_KEY:!1,ACCOUNT_REGISTER_RETRY_TIMEOUT:1,ACCOUNT_REGISTER_RETRY_RATIO:2,ACCOUNT_REGISTER_RETRY_TIMEOUT_MAX:6e4,ACCOUNT_REGISTER_RETRY_COUNT_MAX:1e5,AUDIO_CONTEXT:null,WEBCS_BACKUP_CONNECT_TIMEOUT:6e3,PLAYER_STATE_DEFER:2e3,SIGNAL_REQUEST_WATCH_INTERVAL:1e3,FILEPATH_LENMAX:255,DUALSTREAM_OPERATION_CHECK:!0,MEDIA_ELEMENT_EXISTS_DEPTH:3,SHIM_CANDIDATE:!1,LEAVE_MSG_TIMEOUT:2e3,STATS_FILTER:{transportId:!0,googTrackId:!0},FILTER_VIDEO_CODEC:[],USE_NEW_NETWORK_CONFIG:!1,AUTO_RESET_AUDIO_ROUTE:!1,PLUGIN_INFO:[],OVERUSE_DETECTOR_PARAMS:M_,CUSTOM_ADAPTATION_DEFAULT_MODE:"",HIDE_NO_POSTER:!1,AP_CACHE_NUM:10,AP_UPDATE_INTERVAL:12e4,AP_CACHE_LIFETIME:12e4,MAX_PRELOAD_ASYNC_LENGTH:3,DISABLE_SCREEN_SHARE_REMB:!1},cc),{},{USE_CANDIDATE_FROM_AP_DETAIL:!1,AP_REQUEST_DETAIL:void 0,ENABLE_ROLE_SELECT_EDGE:!1,CLIENT_ROLE_OPTIONS:void 0,COMPATIBLE_SDP_EXTENSION:["gdpr_forbidden"],LIMIT_BITRATE:void 0,EXPERIMENTS:{},USE_PUB_RTX:!0,USE_SUB_RTX:!0,ENABLE_DATASTREAM_2:!1,USE_XR:!0,ENABLE_PREALLOC_PC:!1,ENABLE_PRE_SUB:!1,ENABLE_SVC:!1},{INSTALL_ID:""});function Sr(n,i,a){var c,u,_;ft(c=Object.keys(ai)).call(c,n)&&(!a&&ft(u=Object.keys(hs)).call(u,n)||(ai[n]=i,n!=="ENABLE_VIDEO_SEI"&&n!=="ENABLE_AUDIO_TOPN"&&n!=="ENABLE_AUDIO_METADATA"&&n!=="ENABLE_AUDIO_PTS_METADATA"||i!==!0||(ai.ENABLE_ENCODED_TRANSFORM=!0,n==="ENABLE_AUDIO_PTS_METADATA"&&(ai.ENABLE_AUDIO_METADATA=!0)),n==="USE_NEW_NETWORK_CONFIG"&&i&&(_=!!i,ai.USE_NEW_NETWORK_CONFIG=_,_&&(ai.WEBCS_DOMAIN=["webrtc2-2.ap.sd-rtn.com"],ai.WEBCS_DOMAIN_BACKUP_LIST=["webrtc2-4.ap.sd-rtn.com"],ai.CDS_AP=["cds-web-2.ap.sd-rtn.com","cds-web-4.ap.sd-rtn.com"],ai.ACCOUNT_REGISTER=["sua-web-2.ap.sd-rtn.com","sua-web-4.ap.sd-rtn.com"],ai.EVENT_REPORT_DOMAIN="web-2.statscollector.sd-rtn.com",ai.EVENT_REPORT_BACKUP_DOMAIN="statscollector-1.agora.io",ai.GATEWAY_DOMAINS=["edge.sd-rtn.com"])),n==="ENABLE_PRE_SUB"&&i&&(ai.ENABLE_INSTANT_VIDEO=!0,ai.ENABLE_PREALLOC_PC=!0),n==="ENABLE_SVC"&&i&&(ai.ENABLE_AUT_CC=!0),n==="NEW_FORCE_TURN"&&i&&(ai.NEW_TURN_MODE||(ai.NEW_TURN_MODE=4))))}function ge(n){return ai[n]}bS||(ai.WEBCS_DOMAIN=["ap-web-1-oversea.agora.io","ap-web-1-north-america.agora.io"],ai.WEBCS_DOMAIN_BACKUP_LIST=["ap-web-2-oversea.agora.io","ap-web-2-north-america.agora.io"],ai.PROXY_CS=["proxy-ap-web-oversea.agora.io","proxy-ap-web-america.agora.io"],ai.CDS_AP=["cds-ap-web-oversea.agora.io","cds-ap-web-america.agora.io","cds-ap-web-america2.agora.io"],ai.ACCOUNT_REGISTER=["sua-ap-web-oversea.agora.io","sua-ap-web-america.agora.io","sua-ap-web-america2.agora.io"],ai.UAP_AP=["uap-ap-web-oversea.agora.io","uap-ap-web-america.agora.io","uap-ap-web-america2.agora.io"],ai.LOG_UPLOAD_SERVER="logservice-oversea.agora.io",ai.EVENT_REPORT_DOMAIN="statscollector-1-oversea.agora.io",ai.EVENT_REPORT_BACKUP_DOMAIN="statscollector-2-oversea.agora.io",ai.PROXY_SERVER_TYPE3="webrtc-cloud-proxy.agora.io",ai.AREAS=["NORTH_AMERICA","OVERSEA"]);let wL=function(n){return n[n.REALTIME=1]="REALTIME",n}({}),hs={};var Ln=function(n){return n.SET_SESSION_ID="SET_SESSION_ID",n.SET_P2P_ID="SET_P2P_id",n.SET_DC_ID="SET_DC_id",n.SET_UID="SET_UID",n.SET_INT_UID="SET_INT_UID",n.SET_PUB_ID="SET_PUB_ID",n.SET_CLOUD_PROXY_SERVER_MODE="SET_CLOUD_PROXY_SERVER_MODE",n.KEY_METRIC_CLIENT_CREATED="KEY_METRIC_CLIENT_CREATED",n.KEY_METRIC_JOIN_START="KEY_METRIC_JOIN_START",n.AVOID_JOIN_START="AVOID_JOIN_START",n.KEY_METRIC_JOIN_END="KEY_METRIC_JOIN_END",n.KEY_METRIC_REQUEST_AP_START="KEY_METRIC_REQUEST_AP_START",n.KEY_METRIC_REQUEST_AP_END="KEY_METRIC_REQUEST_AP_END",n.KEY_METRIC_JOIN_GATEWAY_START="KEY_METRIC_JOIN_GATEWAY_START",n.KEY_METRIC_JOIN_GATEWAY_END="KEY_METRIC_JOIN_GATEWAY_END",n.KEY_METRIC_PEER_CONNECTION_START="KEY_METRIC_PEER_CONNECTION_START",n.KEY_METRIC_PEER_CONNECTION_END="KEY_METRIC_PEER_CONNECTION_END",n.KEY_METRIC_DESCRIPTION_START="KEY_METRIC_DESCRIPTION_START",n.KEY_METRIC_ICE_CONNECTION_END="KEY_METRIC_ICE_CONNECTION_END",n.KEY_METRIC_SIGNAL_CHANNEL_OPEN="KEY_METRIC_SIGNAL_CHANNEL_OPEN",n.KEY_METRIC_PUBLISH="KEY_METRIC_PUBLISH",n.KEY_METRIC_SUBSCRIBE="KEY_METRIC_SUBSCRIBE",n.RECORD_JOIN_CHANNEL_SERVICE="RECORD_JOIN_CHANNEL_SERVICE",n.RESET_JOIN_CHANNEL_SERVICE_RECORDS="RESET_JOIN_CHANNEL_SERVICE_RECORDS",n.RESET_KEY_METRICS="RESET_KEY_METRICS",n.SET_USE_P2P="SET_USE_P2P",n.SET_TRANSPORT_TYPE="SET_TRANSPORT_TYPE",n}(Ln||{});let Gp=function(n){return n.h264="h264",n.h265="h265",n.vp8="vp8",n.vp9="vp9",n.av1="av1",n}({});(function(n){n.opus="opus",n.pcma="pcma",n.pcmu="pcmu",n.g722="g722"})({});let ps=128,RL=96,IL=1e3,k_=10,Ox=0;var ti=(()=>{var n={8:(c,u,_)=>{_.r(u),_.d(u,{Parser:()=>Y,Printer:()=>Ie,parse:()=>Ne,print:()=>Ve});let S=`
`,C="".concat("\r").concat(S),R=" ",e;function t(Be){return Be>="0"&&Be<="9"}function r(Be){return Be>="!"&&Be<="~"}function s(Be){return r(Be)||Be>=""&&Be<=""}function l(Be){return Be==="!"||Be>="#"&&Be<="'"||Be>="*"&&Be<="+"||Be>="-"&&Be<="."||Be>="0"&&Be<="9"||Be>="A"&&Be<="Z"||Be>="^"&&Be<="~"}function f(Be){return Be>="1"&&Be<="9"}function m(Be){return Be>="A"&&Be<="Z"||Be>="a"&&Be<="z"}function E(Be){return Be==="d"||Be==="h"||Be==="m"||Be==="s"}function y(Be){return Be>""&&Be<"	"||Be>"\v"&&Be<"\f"||Be>""&&Be<""}function b(Be){return m(Be)||t(Be)||Be==="+"||Be==="/"}function A(Be){return t(Be)||m(Be)||Be==="+"||Be==="/"||Be==="-"||Be==="_"}function O(Be){return m(Be)||t(Be)||Be==="+"||Be==="/"}function D(Be,W){var ce=Object.keys(Be);if(Object.getOwnPropertySymbols){var Se=Object.getOwnPropertySymbols(Be);W&&(Se=Se.filter(function(Xe){return Object.getOwnPropertyDescriptor(Be,Xe).enumerable})),ce.push.apply(ce,Se)}return ce}function P(Be){for(var W=1;W<arguments.length;W++){var ce=arguments[W]!=null?arguments[W]:{};W%2?D(Object(ce),!0).forEach(function(Se){F(Be,Se,ce[Se])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Be,Object.getOwnPropertyDescriptors(ce)):D(Object(ce)).forEach(function(Se){Object.defineProperty(Be,Se,Object.getOwnPropertyDescriptor(ce,Se))})}return Be}function F(Be,W,ce){return W in Be?Object.defineProperty(Be,W,{value:ce,enumerable:!0,configurable:!0,writable:!0}):Be[W]=ce,Be}(function(Be){Be.VERSION="v",Be.ORIGIN="o",Be.SESSION_NAME="s",Be.INFORMATION="i",Be.URI="u",Be.EMAIL="e",Be.PHONE="p",Be.CONNECTION="c",Be.BANDWIDTH="b",Be.TIME="t",Be.REPEAT="r",Be.ZONE_ADJUSTMENTS="z",Be.KEY="k",Be.ATTRIBUTE="a",Be.MEDIA="m"})(e||(e={}));class B{consumeText(W,ce){let Se=ce;for(;Se<W.length;){let Xe=W[Se];if(Xe==="\0"||Xe==="\r"||Xe===S)break;Se+=1}if(Se-ce==0)throw new Error("Invalid text, at ".concat(W));return Se}consumeUnicastAddress(W,ce,Se){return this.consumeTill(W,ce,R)}consumeOneOrMore(W,ce,Se){let Xe=ce;for(;Se(W[Xe]);)Xe++;if(Xe-ce==0)throw new Error("Invalid rule at ".concat(ce,"."));return Xe}consumeSpace(W,ce){if(W[ce]===R)return ce+1;throw new Error("Invalid space at ".concat(ce,"."))}consumeIP4Address(W,ce){let Se=ce;for(let Xe=0;Xe<4;Xe++)if(Se=this.consumeDecimalUChar(W,Se),Xe!==3){if(W[Se]!==".")throw new Error("Invalid IP4 address.");Se++}return Se}consumeDecimalUChar(W,ce){let Se=ce;for(let en=0;en<3&&t(W[Se]);en++,Se++);if(Se-ce==0)throw new Error("Invalid decimal uchar.");let Xe=parseInt(W.slice(ce,Se));if(Xe>=0&&Xe<=255)return Se;throw new Error("Invalid decimal uchar")}consumeIP6Address(W,ce){let Se=this.consumeHexpart(W,ce);return W[Se]===":"&&(Se+=1,Se=this.consumeIP4Address(W,Se)),Se}consumeHexpart(W,ce){let Se=ce;if(W[Se]===":"&&W[Se+1]===":"){Se+=2;try{Se=this.consumeHexseq(W,Se)}catch{}return Se}if(Se=this.consumeHexseq(W,Se),W[Se]===":"&&W[Se+1]===":"){Se+=2;try{Se=this.consumeHexseq(W,Se)}catch{}return Se}return Se}consumeHexseq(W,ce){let Se=ce;for(;Se=this.consumeHex4(W,Se),W[Se]===":"&&W[Se+1]!==":";)Se+=1;return Se}consumeHex4(W,ce){let Se=0;for(;Se<4;Se++)if(!((Xe=W[ce+Se])>="0"&&Xe<="9"||Xe>="a"&&Xe<="f"||Xe>="A"&&Xe<="F")){if(Se===0)throw new Error("Invalid hex 4");break}var Xe;return ce+Se}consumeFQDN(W,ce){let Se=ce;for(;t(W[Se])||m(W[Se])||W[Se]==="-"||W[Se]===".";)Se+=1;if(Se-ce<4)throw new Error("Invalid FQDN");return Se}consumeExtnAddr(W,ce){return this.consumeOneOrMore(W,ce,s)}consumeMulticastAddress(W,ce,Se){switch(Se){case"IP4":case"ip4":return this.consumeIP4MulticastAddress(W,ce);case"IP6":case"ip6":return this.consumeIP6MulticastAddress(W,ce);default:try{return this.consumeFQDN(W,ce)}catch{return this.consumeExtnAddr(W,ce)}}}consumeIP6MulticastAddress(W,ce){let Se=this.consumeHexpart(W,ce);return W[Se]==="/"?this.consumeInteger(W,Se+1):Se}consumeIP4MulticastAddress(W,ce){let Se=ce+3,Xe=W.slice(ce,Se),en=parseInt(Xe);if(en<224||en>239)throw new Error("Invalid IP4 multicast address, IPv4 multicast addresses may be in the range 224.0.0.0 to 239.255.255.255.");for(let He=0;He<3;He++){if(W[Se]!==".")throw new Error("Invalid IP4 multicast address.");Se+=1,Se=this.consumeDecimalUChar(W,Se)}return W[Se]==="/"&&(Se+=1),Se=this.consumeTTL(W,Se),W[Se]==="/"&&(Se=this.consumeInteger(W,Se)),Se}consumeInteger(W,ce){if(!f(W[ce]))throw new Error("Invalid integer.");for(ce+=1;t(W[ce]);)ce+=1;return ce}consumeTTL(W,ce){if(W[ce]==="0")return ce+1;if(!f(W[ce]))throw new Error("Invalid TTL.");ce+=1;for(let Se=0;Se<2&&t(W[ce]);Se++)ce+=1;return ce}consumeToken(W,ce){return this.consumeOneOrMore(W,ce,l)}consumeTime(W,ce){let Se=ce;if(W[Se]==="0")return Se+1;for(f(W[Se])&&(Se+=1);t(W[Se]);)Se++;if(Se-ce<10)throw new Error("Invalid time");return Se}consumeAddress(W,ce){return this.consumeTill(W,ce,R)}consumeTypedTime(W,ce){let Se=ce;return Se=this.consumeOneOrMore(W,Se,t),E(W[Se])?Se+1:Se}consumeRepeatInterval(W,ce){if(!f(W[ce]))throw new Error("Invalid repeat interval");for(ce+=1;t(W[ce]);)ce+=1;return E(W[ce])&&(ce+=1),ce}consumePort(W,ce){return this.consumeOneOrMore(W,ce,t)}consume(W,ce,Se){for(let Xe=0;Xe<Se.length;Xe++){if(ce+Xe>=W.length)throw new Error("consume exceeding value length");if(W[ce+Xe]!==Se[Xe])throw new Error("consume ".concat(Se," failed at ").concat(Xe))}return ce+Se.length}consumeTill(W,ce,Se){let Xe=ce;for(;Xe<W.length&&(typeof Se!="string"||W[Xe]!==Se)&&(typeof Se!="function"||!Se(W[Xe]));)Xe++;return Xe}}class Y extends B{constructor(){super(),F(this,"records",[]),F(this,"currentLine",0)}parse(W){let ce=this.probeEOL(W);this.records=W.split(ce).filter(Bi=>!!js(Bi).call(Bi)).map(this.parseLine),this.currentLine=0;let Se=this.parseVersion(),Xe=this.parseOrigin(),en=this.parseSessionName(),He=this.parseInformation(),tt=this.parseUri(),St=this.parseEmail(),Ze=this.parsePhone(),J=this.parseConnection(),_e=this.parseBandWidth(),be=this.parseTimeFields(),ot=this.parseKey(),an=this.parseSessionAttribute(),hr=this.parseMediaDescription();if(this.currentLine!==this.records.length)throw new Error("parsing failed, non exhaustive sdp lines.");return{version:Se,origin:Xe,sessionName:en,information:He,uri:tt,emails:St,phones:Ze,connection:J,bandwidths:_e,timeFields:be,key:ot,attributes:an,mediaDescriptions:hr}}getCurrentRecord(){let W=this.records[this.currentLine];if(!W)throw new Error("Record doesn't exit.");return W}probeEOL(W){for(let ce=0;ce<W.length;ce++)if(W[ce]===S)return W[ce-1]==="\r"?C:S;throw new Error("Invalid newline character.")}parseLine(W,ce){if(W.length<2)throw new Error("Invalid sdp line, sdp line should be of form <type>=<value>.");let Se=W[0];if(W[1]!=="=")throw new Error('Invalid sdp line, <type> should be a single character followed by an "=" sign.');return{type:Se,value:W.slice(2),line:ce,cur:0}}parseSessionAttribute(){let W=new ee;for(;this.currentLine<this.records.length;){let ce=this.getCurrentRecord();if(ce.type!==e.ATTRIBUTE)break;let Se={attField:this.extractOneOrMore(ce,Xe=>l(Xe)&&Xe!==":"),_cur:0};ce.value[ce.cur]===":"&&(ce.cur+=1,Se.attValue=this.extractOneOrMore(ce,y)),W.parse(Se),this.currentLine++}return W.digest()}parseMediaAttributes(W){let ce=new Ee(W);for(;this.currentLine<this.records.length;){let Se=this.getCurrentRecord();if(Se.type!==e.ATTRIBUTE)break;let Xe={attField:this.extractOneOrMore(Se,en=>l(en)&&en!==":"),_cur:0};Se.value[Se.cur]===":"&&(Se.cur+=1,Xe.attValue=this.extractOneOrMore(Se,y)),ce.parse(Xe),this.currentLine++}return ce.digest()}parseKey(){let W=this.getCurrentRecord();if(W.type===e.KEY){if(W.value==="prompt"||W.value==="clear:"||W.value==="base64:"||W.value==="uri:")return W.value;throw this.currentLine++,new Error("Invalid key.")}}parseZone(){let W=this.getCurrentRecord();if(W.type===e.ZONE_ADJUSTMENTS){let ce=[];for(;;)try{let Se=this.extract(W,this.consumeTime);this.consumeSpaceForRecord(W);let Xe=!1;W.value[W.cur]==="-"&&(Xe=!0,W.cur+=1);let en=this.extract(W,this.consumeTypedTime);ce.push({time:Se,typedTime:en,back:Xe})}catch{break}if(ce.length===0)throw new Error("Invalid zone adjustments");return this.currentLine++,ce}return[]}parseRepeat(){let W=[];for(;;){let ce=this.getCurrentRecord();if(ce.type!==e.REPEAT)break;{let Se=this.extract(ce,this.consumeRepeatInterval),Xe=this.parseTypedTime(ce);W.push({repeatInterval:Se,typedTimes:Xe}),this.currentLine++}}return W}parseTypedTime(W){let ce=[];for(;;)try{this.consumeSpaceForRecord(W),ce.push(this.extract(W,this.consumeTypedTime))}catch{break}if(ce.length===0)throw new Error("Invalid typed time.");return ce}parseTime(){let W=this.getCurrentRecord(),ce=this.extract(W,this.consumeTime);this.consumeSpaceForRecord(W);let Se=this.extract(W,this.consumeTime);return this.currentLine++,{startTime:ce,stopTime:Se}}parseBandWidth(){let W=[];for(;this.currentLine<this.records.length;){let ce=this.getCurrentRecord();if(ce.type!==e.BANDWIDTH)break;{let Se=this.extractOneOrMore(ce,l);if(ce.value[ce.cur]!==":")throw new Error("Invalid bandwidth field.");ce.cur++;let Xe=this.extractOneOrMore(ce,t);W.push({bwtype:Se,bandwidth:Xe}),this.currentLine++}}return W}parseVersion(){let W=this.getCurrentRecord();if(W.type!==e.VERSION)throw new Error("first sdp record must be version");let ce=W.value.slice(0,this.consumeOneOrMore(W.value,0,t));if(ce.length!==W.value.length)throw new Error('invalid proto version, "v='.concat(W.value,'"'));return this.currentLine++,ce}parseOrigin(){let W=this.getCurrentRecord();if(W.type!==e.ORIGIN)throw new Error("second line of sdp must be origin");let ce=this.extractOneOrMore(W,s);this.consumeSpaceForRecord(W);let Se=this.extractOneOrMore(W,t);this.consumeSpaceForRecord(W);let Xe=this.extractOneOrMore(W,t);this.consumeSpaceForRecord(W);let en=this.extractOneOrMore(W,l);this.consumeSpaceForRecord(W);let He=this.extractOneOrMore(W,l);this.consumeSpaceForRecord(W);let tt=this.extract(W,this.consumeUnicastAddress);return this.currentLine++,{username:ce,sessId:Se,sessVersion:Xe,nettype:en,addrtype:He,unicastAddress:tt}}parseSessionName(){let W=this.getCurrentRecord();if(W.type===e.SESSION_NAME){let ce=this.extract(W,this.consumeText);return this.currentLine++,ce}}parseInformation(){let W=this.getCurrentRecord();if(W.type!==e.INFORMATION)return;let ce=this.extract(W,this.consumeText);return this.currentLine++,ce}parseUri(){let W=this.getCurrentRecord();if(W.type===e.URI)return this.currentLine++,W.value}parseEmail(){let W=[];for(;;){let ce=this.getCurrentRecord();if(ce.type!==e.EMAIL)break;W.push(ce.value),this.currentLine++}return W}parsePhone(){let W=[];for(;;){let ce=this.getCurrentRecord();if(ce.type!==e.PHONE)break;W.push(ce.value),this.currentLine++}return W}parseConnection(){let W=this.getCurrentRecord();if(W.type===e.CONNECTION){let ce=this.extractOneOrMore(W,l);this.consumeSpaceForRecord(W);let Se=this.extractOneOrMore(W,l);this.consumeSpaceForRecord(W);let Xe=this.extract(W,this.consumeAddress);return this.currentLine++,{nettype:ce,addrtype:Se,address:Xe}}}parseMedia(){let W=this.getCurrentRecord(),ce=this.extract(W,this.consumeToken);this.consumeSpaceForRecord(W);let Se=this.extract(W,this.consumePort);W.value[W.cur]==="/"&&(W.cur+=1,Se+=this.extract(W,this.consumeInteger)),this.consumeSpaceForRecord(W);let Xe=[];for(Xe.push(this.extract(W,this.consumeToken));W.value[W.cur]==="/";)W.cur+=1,Xe.push(this.extract(W,this.consumeToken));if(Xe.length===0)throw new Error("Invalid proto");let en=this.parseFmt(W);return this.currentLine++,{mediaType:ce,port:Se,protos:Xe,fmts:en}}parseTimeFields(){let W=[];for(;this.getCurrentRecord().type===e.TIME;){let ce=this.parseTime(),Se=this.parseRepeat(),Xe=this.parseZone();W.push({time:ce,repeats:Se,zones:Xe})}return W}parseMediaDescription(){let W=[];for(;this.currentLine<this.records.length&&this.getCurrentRecord().type===e.MEDIA;){let ce=this.parseMedia(),Se=this.parseInformation(),Xe=this.parseConnections(),en=this.parseBandWidth(),He=this.parseKey(),tt=this.parseMediaAttributes(ce);W.push({media:ce,information:Se,connections:Xe,bandwidths:en,key:He,attributes:tt})}return W}parseConnections(){let W=[];for(;this.currentLine<this.records.length&&this.getCurrentRecord().type===e.CONNECTION;)W.push(this.parseConnection());return W}parseFmt(W){let ce=[];for(;;)try{this.consumeSpaceForRecord(W),ce.push(this.extract(W,this.consumeToken))}catch{break}if(ce.length===0)throw new Error("Invalid fmts");return ce}extract(W,ce){for(var Se=arguments.length,Xe=new Array(Se>2?Se-2:0),en=2;en<Se;en++)Xe[en-2]=arguments[en];let He=ce.call(this,W.value,W.cur,...Xe),tt=W.value.slice(W.cur,He);return W.cur=He,tt}extractOneOrMore(W,ce){let Se=this.consumeOneOrMore(W.value,W.cur,ce),Xe=W.value.slice(W.cur,Se);return W.cur=Se,Xe}consumeSpaceForRecord(W){if(W.value[W.cur]!==R)throw new Error("Invalid space at ".concat(W.cur,"."));W.cur+=1}}class $ extends B{constructor(){super(...arguments),F(this,"attributes",void 0),F(this,"digested",!1)}extractOneOrMore(W,ce,Se){let Xe=this.consumeOneOrMore(W.attValue,W._cur,ce),en=W.attValue.slice(W._cur,Xe),[He,tt]=Se||[];if(typeof He=="number"&&en.length<He)throw new Error("error in length, should be more or equal than ".concat(He," characters."));if(typeof tt=="number"&&en.length>tt)throw new Error("error in length, should be less or equal than ".concat(tt," characters."));return W._cur=Xe,en}consumeAttributeSpace(W){if(W.attValue[W._cur]!==R)throw new Error("Invalid space at ".concat(W._cur,"."));W._cur+=1}extract(W,ce){if(!W.attValue)throw new Error("Nothing to extract from attValue.");for(var Se=arguments.length,Xe=new Array(Se>2?Se-2:0),en=2;en<Se;en++)Xe[en-2]=arguments[en];let He=ce.call(this,W.attValue,W._cur,...Xe),tt=W.attValue.slice(W._cur,He);return W._cur=He,tt}atEnd(W){if(!W.attValue)throw new Error;return W._cur>=W.attValue.length}peekChar(W){if(!W.attValue)throw new Error;return W.attValue[W._cur]}peek(W,ce){if(!W.attValue)throw new Error;for(let Se=0;Se<ce.length;Se++)if(ce[Se]!==W.attValue[W._cur+Se])return!1;return!0}parseIceUfrag(W){if(this.attributes.iceUfrag)throw new Error("Invalid ice-ufrag, should be only a single line if 'a=ice-ufrag'");this.attributes.iceUfrag=this.extractOneOrMore(W,b,[4,256])}parseIcePwd(W){if(this.attributes.icePwd)throw new Error("Invalid ice-pwd, should be only a single line if 'a=ice-pwd'");this.attributes.icePwd=this.extractOneOrMore(W,b,[22,256])}parseIceOptions(W){if(this.attributes.iceOptions)throw new Error("Invalid ice-options, should be only one 'ice-options' line");let ce=[];for(;!this.atEnd(W);){ce.push(this.extractOneOrMore(W,b));try{this.consumeAttributeSpace(W)}catch(Se){if(this.atEnd(W))break;throw Se}}this.attributes.iceOptions=ce}parseFingerprint(W){let ce=this.extract(W,this.consumeToken);this.consumeAttributeSpace(W);let Se=this.extract(W,this.consumeTill);this.attributes.fingerprints.push({hashFunction:ce,fingerprint:Se})}parseExtmap(W){let ce=this.extractOneOrMore(W,t),Se;this.peekChar(W)==="/"&&(this.extract(W,this.consume,"/"),Se=this.extract(W,this.consumeToken)),this.consumeAttributeSpace(W);let Xe=this.extract(W,this.consumeTill,R),en=P(P({entry:parseInt(ce,10)},Se&&{direction:Se}),{},{extensionName:Xe});this.peekChar(W)===R&&(this.consumeAttributeSpace(W),en.extensionAttributes=this.extract(W,this.consumeTill)),this.attributes.extmaps.push(en)}parseSetup(W){if(this.attributes.setup)throw new Error("must only be one single 'a=setup' line.");let ce=this.extract(W,this.consumeTill);if(ce!=="active"&&ce!=="passive"&&ce!=="actpass"&&ce!=="holdconn")throw new Error("role must be one of 'active', 'passive', 'actpass', 'holdconn'.");this.attributes.setup=ce}}class ee extends ${constructor(){super(...arguments),F(this,"attributes",{unrecognized:[],groups:[],extmaps:[],fingerprints:[],identities:[]})}parse(W){if(this.digested)throw new Error("already digested");try{switch(W.attField){case"group":this.parseGroup(W);break;case"ice-lite":this.parseIceLite();break;case"ice-ufrag":this.parseIceUfrag(W);break;case"ice-pwd":this.parseIcePwd(W);break;case"ice-options":this.parseIceOptions(W);break;case"fingerprint":this.parseFingerprint(W);break;case"setup":this.parseSetup(W);break;case"tls-id":this.parseTlsId(W);break;case"identity":this.parseIdentity(W);break;case"extmap":this.parseExtmap(W);break;case"msid-semantic":this.parseMsidSemantic(W);break;default:W.ignored=!0,this.attributes.unrecognized.push(W)}}catch(ce){throw console.error("parsing session attribute ".concat(W.attField,' error, "a=').concat(W.attField,":").concat(W.attValue,'"')),ce}if(!W.ignored&&W.attValue&&!this.atEnd(W))throw new Error("attribute parsing error")}digest(){return this.digested=!0,this.attributes}parseGroup(W){let ce=this.extract(W,this.consumeToken),Se=[];for(;!this.atEnd(W)&&this.peekChar(W)===R;)this.consumeAttributeSpace(W),Se.push(this.extract(W,this.consumeToken));this.attributes.groups.push({semantic:ce,identificationTag:Se})}parseIceLite(){if(this.attributes.iceLite)throw new Error("Invalid ice-lite, should be only a single line of 'a=ice-lite'");this.attributes.iceLite=!0}parseTlsId(W){if(this.attributes.tlsId)throw new Error("must be only one tld-id line");this.attributes.tlsId=this.extractOneOrMore(W,A)}parseIdentity(W){let ce=this.extractOneOrMore(W,O),Se=[];for(;!this.atEnd(W)&&this.peekChar(W)===R;){this.consumeAttributeSpace(W);let Xe=this.extract(W,this.consumeToken);this.extract(W,this.consume,"=");let en=this.extractOneOrMore(W,He=>He!==R&&y(He));Se.push({name:Xe,value:en})}this.attributes.identities.push({assertionValue:ce,extensions:Se})}parseMsidSemantic(W){this.peekChar(W)===R&&this.consumeAttributeSpace(W);let ce={semantic:this.extract(W,this.consumeToken),identifierList:[]};for(;;){try{this.consumeAttributeSpace(W)}catch{break}if(this.peekChar(W)==="*"){this.extract(W,this.consume,"*"),ce.applyForAll=!0;break}{let Se=this.extract(W,this.consumeTill,R);ce.identifierList.push(Se)}}this.attributes.msidSemantic=ce}}class Ee extends ${constructor(W){super(),F(this,"attributes",void 0),W.protos.indexOf("RTP")!==-1||W.protos.indexOf("rtp"),this.attributes={unrecognized:[],candidates:[],extmaps:[],fingerprints:[],imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:[],ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:[]}}parse(W){if(this.digested)throw new Error("already digested");try{switch(W.attField){case"extmap":this.parseExtmap(W);break;case"setup":this.parseSetup(W);break;case"ice-ufrag":this.parseIceUfrag(W);break;case"ice-pwd":this.parseIcePwd(W);break;case"ice-options":this.parseIceOptions(W);break;case"candidate":this.parseCandidate(W);break;case"remote-candidate":this.parseRemoteCandidate(W);break;case"end-of-candidates":this.parseEndOfCandidates();break;case"fingerprint":this.parseFingerprint(W);break;case"rtpmap":this.parseRtpmap(W);break;case"ptime":this.parsePtime(W);break;case"maxptime":this.parseMaxPtime(W);break;case"sendrecv":case"recvonly":case"sendonly":case"inactive":this.parseDirection(W);break;case"ssrc":this.parseSSRC(W);break;case"fmtp":this.parseFmtp(W);break;case"rtcp-fb":this.parseRtcpFb(W);break;case"rtcp-mux":this.parseRTCPMux();break;case"rtcp-mux-only":this.parseRTCPMuxOnly();break;case"rtcp-rsize":this.parseRTCPRsize();break;case"rtcp":this.parseRTCP(W);break;case"mid":this.parseMid(W);break;case"msid":this.parseMsid(W);break;case"imageattr":this.parseImageAttr(W);break;case"rid":this.parseRid(W);break;case"simulcast":this.parseSimulcast(W);break;case"sctp-port":this.parseSctpPort(W);break;case"max-message-size":this.parseMaxMessageSize(W);break;case"ssrc-group":this.parseSSRCGroup(W);break;default:W.ignored=!0,this.attributes.unrecognized.push(W)}}catch(ce){throw console.error("parsing media attribute ".concat(W.attField,' error, "a=').concat(W.attField,":").concat(W.attValue,'"')),ce}if(!W.ignored&&W.attValue&&!this.atEnd(W))throw new Error("attribute parsing error")}parseCandidate(W){let ce=this.extractOneOrMore(W,b,[1,32]);this.consumeAttributeSpace(W);let Se=this.extractOneOrMore(W,t,[1,5]);this.consumeAttributeSpace(W);let Xe=this.extract(W,this.consumeToken);this.consumeAttributeSpace(W);let en=this.extractOneOrMore(W,t,[1,10]);this.consumeAttributeSpace(W);let He=this.extract(W,this.consumeAddress);this.consumeAttributeSpace(W);let tt=this.extract(W,this.consumePort);this.consumeAttributeSpace(W),this.extract(W,this.consume,"typ"),this.consumeAttributeSpace(W);let St={foundation:ce,componentId:Se,transport:Xe,priority:en,connectionAddress:He,port:tt,type:this.extract(W,this.consumeToken),extension:{}};for(this.peek(W," raddr")&&(this.extract(W,this.consume," raddr"),this.consumeAttributeSpace(W),St.relAddr=this.extract(W,this.consumeAddress)),this.peek(W," rport")&&(this.extract(W,this.consume," rport"),this.consumeAttributeSpace(W),St.relPort=this.extract(W,this.consumePort));this.peekChar(W)===R;){this.consumeAttributeSpace(W);let Ze=this.extract(W,this.consumeToken);this.consumeAttributeSpace(W),St.extension[Ze]=this.extractOneOrMore(W,r)}this.attributes.candidates.push(St)}parseRemoteCandidate(W){let ce=[];for(;;){let Se=this.extractOneOrMore(W,t,[1,5]);this.consumeAttributeSpace(W);let Xe=this.extract(W,this.consumeAddress);this.consumeAttributeSpace(W);let en=this.extract(W,this.consumePort);ce.push({componentId:Se,connectionAddress:Xe,port:en});try{this.consumeAttributeSpace(W)}catch{break}}this.attributes.remoteCandidatesList.push(ce)}parseEndOfCandidates(){if(this.attributes.endOfCandidates)throw new Error("must be only one line of end-of-candidates");this.attributes.endOfCandidates=!0}parseRtpmap(W){let ce=this.extract(W,this.consumeToken);this.consumeAttributeSpace(W);let Se=this.extract(W,this.consumeTill,"/");this.extract(W,this.consume,"/");let Xe={encodingName:Se,clockRate:this.extractOneOrMore(W,t)};this.atEnd(W)||this.peekChar(W)!=="/"||(this.extract(W,this.consume,"/"),Xe.encodingParameters=parseInt(this.extract(W,this.consumeTill),10));let en=this.attributes.payloads.find(He=>He.payloadType===parseInt(ce,10));en?en.rtpMap=Xe:this.attributes.payloads.push({payloadType:parseInt(ce,10),rtpMap:Xe,rtcpFeedbacks:[]})}parsePtime(W){if(this.attributes.ptime)throw new Error("must be only one line of ptime");this.attributes.ptime=this.extract(W,this.consumeTill)}parseMaxPtime(W){if(this.attributes.maxPtime)throw new Error("must be only one line of ptime");this.attributes.maxPtime=this.extract(W,this.consumeTill)}parseDirection(W){if(this.attributes.direction)throw new Error("must be only one line of direction info");this.attributes.direction=W.attField}parseSSRC(W){let ce=this.extractOneOrMore(W,t);this.consumeAttributeSpace(W);let Se=this.extract(W,this.consumeTill,":"),Xe;this.peekChar(W)===":"&&(this.extract(W,this.consume,":"),Xe=this.extract(W,this.consumeTill));let en=this.attributes.ssrcs.find(He=>He.ssrcId===parseInt(ce,10));en?en.attributes[Se]=Xe:this.attributes.ssrcs.push({ssrcId:parseInt(ce,10),attributes:{[Se]:Xe}})}parseFmtp(W){let ce=this.extract(W,this.consumeTill,R);this.consumeAttributeSpace(W);let Se=this.extract(W,this.consumeTill),Xe={};Se.split(";").forEach(He=>{let[tt,St]=He.split("=");tt=js(tt).call(tt);let Ze=typeof St=="string"?js(St).call(St):null;typeof tt=="string"&&tt.length>0&&(Xe[tt]=Ze)});let en=this.attributes.payloads.find(He=>He.payloadType===parseInt(ce,10));en?en.fmtp={parameters:Xe}:this.attributes.payloads.push({payloadType:parseInt(ce,10),rtcpFeedbacks:[],fmtp:{parameters:Xe}})}parseFmtParameters(W){let ce={},Se=this.extract(W,this.consumeTill,"=");W._cur++;let Xe=this.extract(W,this.consumeTill,";");for(ce[Se]=Xe;W.attValue[W._cur]===";";){let en=this.extract(W,this.consumeTill,"=");W._cur++;let He=this.extract(W,this.consumeTill,";");ce[en]=He}return ce}parseRtcpFb(W){let ce="";ce=this.peekChar(W)==="*"?this.extract(W,this.consume,"*"):this.extract(W,this.consumeTill,R),this.consumeAttributeSpace(W);let Se=this.extract(W,this.consumeTill,R),Xe;if(Se==="trr-int")Xe={type:Se,interval:this.extract(W,this.consumeTill)};else{let en={type:Se};this.peekChar(W)===R&&(this.consumeAttributeSpace(W),en.parameter=this.extract(W,this.consumeToken),this.peekChar(W)===R&&(en.additional=this.extract(W,this.consumeTill))),Xe=en}if(ce==="*")this.attributes.rtcpFeedbackWildcards.push(Xe);else{let en=this.attributes.payloads.find(He=>He.payloadType===parseInt(ce,10));en?en.rtcpFeedbacks.push(Xe):this.attributes.payloads.push({payloadType:parseInt(ce,10),rtcpFeedbacks:[Xe]})}}parseRTCPMux(){if(this.attributes.rtcpMux)throw new Error("must be single line of rtcp-mux");this.attributes.rtcpMux=!0}parseRTCPMuxOnly(){if(this.attributes.rtcpMuxOnly)throw new Error("must be single line of rtcp-only");this.attributes.rtcpMuxOnly=!0}parseRTCPRsize(){if(this.attributes.rtcpRsize)throw new Error("must be single line of rtcp-rsize");this.attributes.rtcpRsize=!0}parseRTCP(W){if(this.attributes.rtcp)throw new Error("must be single line of rtcp");let ce={port:this.extract(W,this.consumePort)};this.peekChar(W)===R&&(this.consumeAttributeSpace(W),ce.netType=this.extractOneOrMore(W,l),this.consumeAttributeSpace(W),ce.addressType=this.extractOneOrMore(W,l),this.consumeAttributeSpace(W),ce.address=this.extract(W,this.consumeAddress)),this.attributes.rtcp=ce}parseMsid(W){let ce={id:this.extractOneOrMore(W,l,[1,64])};this.peekChar(W)===R&&(this.consumeAttributeSpace(W),ce.appdata=this.extractOneOrMore(W,l,[1,64])),this.attributes.msids.push(ce)}parseImageAttr(W){this.attributes.imageattr.push(W.attValue)}parseRid(W){let ce=this.extractOneOrMore(W,Xe=>m(Xe)||t(Xe)||Xe==="_"||Xe==="-");this.consumeAttributeSpace(W);let Se={id:ce,direction:this.extract(W,this.consumeToken),params:[]};if(this.peekChar(W)===R){if(this.consumeAttributeSpace(W),this.peek(W,"pt=")){this.extract(W,this.consume,"pt=");let Xe=[];for(;;){let en=this.extract(W,this.consumeToken);Xe.push(en);try{this.extract(W,this.consume,",")}catch{break}}Se.payloads=Xe,this.peekChar(W)===R&&this.extract(W,this.consume,R)}for(;;){let Xe=this.extract(W,this.consumeToken);switch(Xe){case"depend":{let en={type:Xe,rids:this.extract(W,this.consume,"=").split(",")};Se.params.push(en);break}default:{let en={type:Xe};this.peekChar(W)==="="&&(this.extract(W,this.consume,"="),en.val=this.extract(W,this.consumeTill,";")),Se.params.push(en)}}try{this.extract(W,this.consume,";")}catch{break}}}this.attributes.rids.push(Se)}parseSimulcast(W){if(this.attributes.simulcast)throw new Error("must be single line of simulcast");this.attributes.simulcast=W.attValue,this.extract(W,this.consumeTill)}parseSctpPort(W){this.attributes.sctpPort=this.extractOneOrMore(W,t,[1,5])}parseMaxMessageSize(W){this.attributes.maxMessageSize=this.extractOneOrMore(W,t,[1,void 0])}digest(){return this.digested=!0,this.attributes}parseMid(W){this.attributes.mid=this.extract(W,this.consumeToken)}parseSSRCGroup(W){let ce=this.extract(W,this.consumeToken),Se=[];for(;;)try{this.consumeAttributeSpace(W);let Xe=this.extract(W,this.consumeInteger);Se.push(parseInt(Xe,10))}catch{break}this.attributes.ssrcGroups.push({semantic:ce,ssrcIds:Se})}}function Re(Be,W,ce){return W in Be?Object.defineProperty(Be,W,{value:ce,enumerable:!0,configurable:!0,writable:!0}):Be[W]=ce,Be}class Ie{constructor(){Re(this,"eol",C)}print(W,ce){let Se="";return ce&&(this.eol=ce),Se+=this.printVersion(W.version),Se+=this.printOrigin(W.origin),Se+=this.printSessionName(W.sessionName),Se+=this.printInformation(W.information),Se+=this.printUri(W.uri),Se+=this.printEmail(W.emails),Se+=this.printPhone(W.phones),Se+=this.printConnection(W.connection),Se+=this.printBandwidth(W.bandwidths),Se+=this.printTimeFields(W.timeFields),Se+=this.printKey(W.key),Se+=this.printSessionAttributes(W.attributes),Se+=this.printMediaDescription(W.mediaDescriptions),Se}printVersion(W){return"v=".concat(W).concat(this.eol)}printOrigin(W){return"o=".concat(W.username," ").concat(W.sessId," ").concat(W.sessVersion," ").concat(W.nettype," ").concat(W.addrtype," ").concat(W.unicastAddress).concat(this.eol)}printSessionName(W){return W?"s=".concat(W).concat(this.eol):""}printInformation(W){return W?"i=".concat(W).concat(this.eol):""}printUri(W){return W?"u=".concat(W).concat(this.eol):""}printEmail(W){let ce="";for(let Se of W)ce+="e=".concat(Se).concat(this.eol);return ce}printPhone(W){let ce="";for(let Se of W)ce+="e=".concat(Se).concat(this.eol);return ce}printConnection(W){return W?"c=".concat(W.nettype," ").concat(W.addrtype," ").concat(W.address).concat(this.eol):""}printBandwidth(W){let ce="";for(let Se of W)ce+="b=".concat(Se.bwtype,":").concat(Se.bandwidth).concat(this.eol);return ce}printTimeFields(W){let ce="";for(let Se of W){ce+="t=".concat(Se.time.startTime," ").concat(Se.time.startTime).concat(this.eol);for(let Xe of Se.repeats)ce+="r=".concat(Xe.repeatInterval," ").concat(Xe.typedTimes.join(" ")).concat(this.eol);Se.zoneAdjustments&&(ce+="z=",ce+="z=".concat(Se.zoneAdjustments.map(Xe=>"".concat(Xe.time," ").concat(Xe.back?"-":""," ").concat(Xe.typedTime)).join(" ")).concat(this.eol),ce+=this.eol)}return ce}printKey(W){return W?"k=".concat(W).concat(this.eol):""}printAttributes(W){let ce="";for(let Se of W)ce+="a=".concat(Se.attField).concat(Se.attValue?":".concat(Se.attValue):"").concat(this.eol);return ce}printMediaDescription(W){let ce="";for(let Se of W)ce+=this.printMedia(Se.media),ce+=this.printInformation(Se.information),ce+=this.printConnections(Se.connections),ce+=this.printBandwidth(Se.bandwidths),ce+=this.printKey(Se.key),ce+=this.printMediaAttributes(Se);return ce}printConnections(W){let ce="";for(let Se of W)ce+=this.printConnection(Se);return ce}printMedia(W){return"m=".concat(W.mediaType," ").concat(W.port," ").concat(W.protos.join("/")," ").concat(W.fmts.join(" ")).concat(this.eol)}printSessionAttributes(W){return new Ue(this.eol).print(W)}printMediaAttributes(W){return new ve(this.eol).print(W)}}class we{constructor(W){Re(this,"eol",void 0),this.eol=W}printIceUfrag(W){return W===void 0?"":"a=ice-ufrag:".concat(W).concat(this.eol)}printIcePwd(W){return W===void 0?"":"a=ice-pwd:".concat(W).concat(this.eol)}printIceOptions(W){return W===void 0?"":"a=ice-options:".concat(W.join(R)).concat(this.eol)}printFingerprints(W){return W.length>0?W.map(ce=>"a=fingerprint:".concat(ce.hashFunction).concat(R).concat(ce.fingerprint)).join(this.eol)+this.eol:""}printExtmap(W){return W.map(ce=>"a=extmap:".concat(ce.entry).concat(ce.direction?"/".concat(ce.direction):"").concat(R).concat(ce.extensionName).concat(ce.extensionAttributes?"".concat(R).concat(ce.extensionAttributes):"").concat(this.eol)).join("")}printSetup(W){return W===void 0?"":"a=setup:".concat(W).concat(this.eol)}printUnrecognized(W){return W.map(ce=>"a=".concat(ce.attField).concat(ce.attValue?":".concat(ce.attValue):"").concat(this.eol)).join("")}}class Ue extends we{print(W){let ce="";return ce+=this.printGroups(W.groups),ce+=this.printMsidSemantic(W.msidSemantic),ce+=this.printIceLite(W.iceLite),ce+=this.printIceUfrag(W.iceUfrag),ce+=this.printIcePwd(W.icePwd),ce+=this.printIceOptions(W.iceOptions),ce+=this.printFingerprints(W.fingerprints),ce+=this.printSetup(W.setup),ce+=this.printTlsId(W.tlsId),ce+=this.printIdentity(W.identities),ce+=this.printExtmap(W.extmaps),ce+=this.printUnrecognized(W.unrecognized),ce}printGroups(W){let ce="";return W.length>0&&(ce+=W.map(Se=>"a=group:".concat(Se.semantic).concat(Se.identificationTag.map(Xe=>"".concat(R).concat(Xe)).join("")).concat(this.eol)).join("")),ce}printIceLite(W){return W===void 0?"":"a=ice-lite"+this.eol}printTlsId(W){return W?"a=tls-id:".concat(W).concat(this.eol):""}printIdentity(W){return W.length===0?"":W.map(ce=>"a=identity:".concat(ce.assertionValue).concat(ce.extensions.map(Se=>"".concat(R).concat(Se.name).concat(Se.value?"=".concat(Se.value):"")))).join(this.eol)+this.eol}printMsidSemantic(W){if(!W)return"";let ce="a=msid-semantic:".concat(W.semantic);return W.applyForAll?ce+="".concat(R,"*"):W.identifierList.length>0&&(ce+=W.identifierList.map(Se=>"".concat(R).concat(Se))),ce+this.eol}}class ve extends we{print(W){let ce=W.attributes,Se="";return Se+=this.printRTCP(ce.rtcp),Se+=this.printIceUfrag(ce.iceUfrag),Se+=this.printIcePwd(ce.icePwd),Se+=this.printIceOptions(ce.iceOptions),Se+=this.printCandidates(ce.candidates),Se+=this.printRemoteCandidatesList(ce.remoteCandidatesList),Se+=this.printEndOfCandidates(ce.endOfCandidates),Se+=this.printFingerprints(ce.fingerprints),Se+=this.printSetup(ce.setup),Se+=this.printMid(ce.mid),Se+=this.printExtmap(ce.extmaps),Se+=this.printRTPRelated(ce),Se+=this.printPtime(ce.ptime),Se+=this.printMaxPtime(ce.maxPtime),Se+=this.printDirection(ce.direction),Se+=this.printSSRCGroups(ce.ssrcGroups),Se+=this.printSSRC(ce.ssrcs),Se+=this.printRTCPMux(ce.rtcpMux),Se+=this.printRTCPMuxOnly(ce.rtcpMuxOnly),Se+=this.printRTCPRsize(ce.rtcpRsize),Se+=this.printMSId(ce.msids),Se+=this.printImageattr(ce.imageattr),Se+=this.printRid(ce.rids),Se+=this.printSimulcast(ce.simulcast),Se+=this.printSCTPPort(ce.sctpPort),Se+=this.printMaxMessageSize(ce.maxMessageSize),Se+=this.printUnrecognized(ce.unrecognized),Se}printCandidates(W){return W.map(ce=>"a=candidate:".concat(ce.foundation).concat(R).concat(ce.componentId).concat(R).concat(ce.transport).concat(R).concat(ce.priority).concat(R).concat(ce.connectionAddress).concat(R).concat(ce.port).concat(R,"typ").concat(R).concat(ce.type).concat(ce.relAddr?"".concat(R,"raddr").concat(R).concat(ce.relAddr):"").concat(ce.relPort?"".concat(R,"rport").concat(R).concat(ce.relPort):"").concat(Object.keys(ce.extension).map(Se=>"".concat(R).concat(Se).concat(R).concat(ce.extension[Se])).join("")).concat(this.eol)).join("")}printRemoteCandidatesList(W){return W.map(ce=>"a=remote-candidates:".concat(ce.join(R)).concat(this.eol)).join("")}printEndOfCandidates(W){return W===void 0?"":"a=end-of-candidates"+this.eol}printRTPRelated(W){if(!W.payloads)return"";let ce=W.payloads,Se="";Se+=W.rtcpFeedbackWildcards.map(Xe=>this.printRTCPFeedback("*",Xe)).join("");for(let Xe of ce)Se+=this.printRtpMap(Xe.payloadType,Xe.rtpMap),Se+=this.printFmtp(Xe.payloadType,Xe.fmtp),Se+=Xe.rtcpFeedbacks.map(en=>this.printRTCPFeedback(Xe.payloadType,en)).join("");return Se}printFmtp(W,ce){if(!ce)return"";let Se=Object.keys(ce.parameters);return Se.length===1&&ce.parameters[Se[0]]===null?"a=fmtp:".concat(W).concat(R).concat(Se[0]).concat(this.eol):"a=fmtp:".concat(W).concat(R).concat(Object.keys(ce.parameters).map(Xe=>"".concat(Xe,"=").concat(ce.parameters[Xe])).join(";")).concat(this.eol)}printRtpMap(W,ce){return ce?"a=rtpmap:".concat(W).concat(R).concat(ce.encodingName,"/").concat(ce.clockRate).concat(ce.encodingParameters?"/".concat(ce.encodingParameters):"").concat(this.eol):""}printRTCPFeedback(W,ce){let Se="a=rtcp-fb:".concat(W).concat(R),Xe=ce;return Xe.type==="trr-int"?Se+="ttr-int".concat(R).concat(Xe.interval):(Se+="".concat(Xe.type),Xe.parameter&&(Se+="".concat(R).concat(Xe.parameter),Xe.additional&&(Se+="".concat(R).concat(Xe.additional)))),Se+this.eol}printPtime(W){return W===void 0?"":"a=ptime:".concat(W).concat(this.eol)}printMaxPtime(W){return W===void 0?"":"a=maxptime:".concat(W).concat(this.eol)}printDirection(W){return W===void 0?"":"a=".concat(W).concat(this.eol)}printSSRC(W){return W.map(ce=>Object.keys(ce.attributes).map(Se=>"a=ssrc:".concat(ce.ssrcId.toString(10)).concat(R).concat(Se).concat(ce.attributes[Se]?":".concat(ce.attributes[Se]):"").concat(this.eol)).join("")).join("")}printRTCPMux(W){return W===void 0?"":"a=rtcp-mux".concat(this.eol)}printRTCPMuxOnly(W){return W===void 0?"":"a=rtcp-mux-only".concat(this.eol)}printRTCPRsize(W){return W===void 0?"":"a=rtcp-rsize".concat(this.eol)}printRTCP(W){if(W===void 0)return"";let ce="a=rtcp:".concat(W.port);return W.netType&&(ce+="".concat(R).concat(W.netType)),W.addressType&&(ce+="".concat(R).concat(W.addressType)),W.address&&(ce+="".concat(R).concat(W.address)),ce+this.eol}printMSId(W){return W.map(ce=>"a=msid:".concat(ce.id).concat(ce.appdata?"".concat(R).concat(ce.appdata):"").concat(this.eol)).join("")}printImageattr(W){return W.map(ce=>"a=imageattr:".concat(ce).concat(this.eol)).join("")}printRid(W){return W.map(ce=>{let Se="a=rid:".concat(ce.id).concat(R).concat(ce.direction);return ce.payloads&&(Se+="".concat(R,"pt=").concat(ce.payloads.join(","))),ce.params.length>0&&(Se+="".concat(R).concat(ce.params.map(Xe=>Xe.type==="depend"?"depend=".concat(Xe.rids.join(",")):"".concat(Xe.type,"=").concat(Xe.val)).join(";"))),Se+this.eol}).join("")}printSimulcast(W){return W===void 0?"":"a=simulcast:".concat(W).concat(this.eol)}printSCTPPort(W){return W===void 0?"":"a=sctp-port:".concat(W).concat(this.eol)}printMaxMessageSize(W){return W===void 0?"":"a=max-message-size:".concat(W).concat(this.eol)}printMid(W){return W===void 0?"":"a=mid:".concat(W).concat(this.eol)}printSSRCGroups(W){return W.map(ce=>"a=ssrc-group:".concat(ce.semantic).concat(ce.ssrcIds.map(Se=>"".concat(R).concat(Se.toString(10))).join("")).concat(this.eol)).join("")}}function Ne(Be){return new Y().parse(Be)}function Ve(Be,W){return new Ie().print(Be,W)}}},i={};function a(c){if(i[c])return i[c].exports;var u=i[c]={exports:{}};return n[c](u,u.exports,a),u.exports}return a.d=(c,u)=>{for(var _ in u)a.o(u,_)&&!a.o(c,_)&&Object.defineProperty(c,_,{enumerable:!0,get:u[_]})},a.o=(c,u)=>Object.prototype.hasOwnProperty.call(c,u),a.r=c=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(c,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(c,"__esModule",{value:!0})},a(8)})();function Dn(n){return ti.parse(n)}function me(n,i){return ti.print(n,i)}var f8=tc("Array").keys,gh=Cd,Gn=ls,AL=Q,h8=f8,Nx=Array.prototype,p8={DOMTokenList:!0,NodeList:!0},Wb=function(n){var i=n.keys;return n===Nx||AL(Nx,n)&&i===Nx.keys||Gn(p8,gh(n))?h8:i},td=T(Wb);function Lx(n,i){var a=Object.keys(n);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(n);i&&(c=c.filter(function(u){return Object.getOwnPropertyDescriptor(n,u).enumerable})),a.push.apply(a,c)}return a}function on(n){for(var i=1;i<arguments.length;i++){var a=arguments[i]!=null?arguments[i]:{};i%2?Lx(Object(a),!0).forEach(function(c){zr(n,c,a[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(a)):Lx(Object(a)).forEach(function(c){Object.defineProperty(n,c,Object.getOwnPropertyDescriptor(a,c))})}return n}function zr(n,i,a){return(i=function(c){var u=function(_,S){if(typeof _!="object"||_===null)return _;var C=_[Symbol.toPrimitive];if(C!==void 0){var R=C.call(_,"string");if(typeof R!="object")return R;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(_)}(c);return typeof u=="symbol"?u:String(u)}(i))in n?Object.defineProperty(n,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):n[i]=a,n}let m8=new class extends li{constructor(){super(...arguments),zr(this,"currentUploadLogID",0)}reportLogUploadError(n){let{errorRange:i}=n;i[i.length-1]&&i[i.length-1]>this.currentUploadLogID&&(this.currentUploadLogID=i[i.length-1],this.emit("REPORT_LOG_UPLOAD",n))}};class lY{constructor(i){zr(this,"logger",void 0),zr(this,"prefixLists",[]),this.logger=i}debug(){for(var i=arguments.length,a=new Array(i),c=0;c<i;c++)a[c]=arguments[c];this.logger.debug(...this.prefixLists,...a)}info(){for(var i=arguments.length,a=new Array(i),c=0;c<i;c++)a[c]=arguments[c];this.logger.info(...this.prefixLists,...a)}warning(){for(var i=arguments.length,a=new Array(i),c=0;c<i;c++)a[c]=arguments[c];this.logger.warning(...this.prefixLists,...a)}error(){for(var i=arguments.length,a=new Array(i),c=0;c<i;c++)a[c]=arguments[c];this.logger.error(...this.prefixLists,...a)}prefix(i){return this.prefixLists.push(i),this}popPrefix(){return this.prefixLists.pop(),this}}function Dx(){let n=new Date;return n.toTimeString().split(" ")[0]+":"+n.getMilliseconds()}function g8(){let n=new Date,i=/((\d+:){2}\d+)/.exec(new Date().toUTCString());return i?(i==null?void 0:i[0])+":"+n.getUTCMilliseconds():n.toTimeString().split(" ")[0]+":"+n.getMilliseconds()}let $d={DEBUG:0,INFO:1,WARNING:2,ERROR:3,NONE:4},Yb=Date.now(),dI=n=>{for(let i in $d)if(Object.prototype.hasOwnProperty.call($d,i)&&$d[i]===n)return i;return"DEFAULT"},z=new class{constructor(){zr(this,"proxyServerURL",void 0),zr(this,"logLevel",$d.DEBUG),zr(this,"uploadState","collecting"),zr(this,"uploadLogWaitingList",[]),zr(this,"uploadLogUploadingList",[]),zr(this,"uploadErrorCount",0),zr(this,"currentLogID",0),zr(this,"url",void 0),zr(this,"extLog",(n,i)=>{this.appendLogToWaitingList(n,...i)})}debug(){for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];let c=[$d.DEBUG].concat(i);this.log.apply(this,c)}info(){for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];let c=[$d.INFO].concat(i);this.log.apply(this,c)}warning(){for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];let c=[$d.WARNING].concat(i);this.log.apply(this,c)}warn(){this.warning(...arguments)}error(){for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];let c=[$d.ERROR].concat(i);this.log.apply(this,c)}upload(){for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];let c=[$d.DEBUG].concat(i);this.uploadLog.apply(this,c)}setLogLevel(n){n=Math.min(Math.max(0,n),4),this.logLevel=n}enableLogUpload(){Sr("UPLOAD_LOG",!0)}disableLogUpload(){Sr("UPLOAD_LOG",!1),this.uploadLogUploadingList=[],this.uploadLogWaitingList=[]}setProxyServer(n){this.proxyServerURL=n}prefix(n){return new lY(this).prefix(n)}log(){for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];if(Date.now()-Yb<100)return void setTimeout(()=>{this.log(...i)},Date.now()-Yb);let c=Math.max(0,Math.min(4,i[0]));if(i[0]=Dx()+" Agora-SDK [".concat(dI(c),"]:"),this.appendLogToWaitingList(c,...i),c<this.logLevel)return;let u=Dx()+" %cAgora-SDK [".concat(dI(c),"]:"),_=[];if(!ge("USE_NEW_LOG"))switch(c){case $d.DEBUG:_=[u,"color: #64B5F6;"].concat(i.slice(1)),console.log.apply(console,_);break;case $d.INFO:_=[u,"color: #1E88E5; font-weight: bold;"].concat(i.slice(1)),console.log.apply(console,_);break;case $d.WARNING:_=[u,"color: #FB8C00; font-weight: bold;"].concat(i.slice(1)),console.warn.apply(console,_);break;case $d.ERROR:_=[u,"color: #B00020; font-weight: bold;"].concat(i.slice(1)),console.error.apply(console,_)}}uploadLog(){for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];if(Date.now()-Yb<100)return void setTimeout(()=>{this.uploadLog(...i)},Date.now()-Yb);let c=Math.max(0,Math.min(4,i[0]));i[0]=Dx()+" Agora-SDK [".concat(dI(c),"]:"),this.appendLogToWaitingList(c,...i)}appendLogToWaitingList(n){if(!ge("UPLOAD_LOG"))return;for(var i=arguments.length,a=new Array(i>1?i-1:0),c=1;c<i;c++)a[c-1]=arguments[c];Array.isArray(a[0])?a[0][0]=g8()+" Agora-SDK [".concat(dI(n),"]:"):a[0]=g8()+" Agora-SDK [".concat(dI(n),"]:");let u="";a.forEach(_=>{typeof _=="object"&&(_=JSON.stringify(_)),u+="".concat(_," ")}),this.uploadLogWaitingList.push({payload_str:u,log_level:n,log_item_id:this.currentLogID++}),this.uploadState==="uploading"&&this.uploadLogUploadingList.length===0&&this.uploadLogInterval()}startUpload(){this.uploadState="uploading",this.uploadLogUploadingList.length===0&&this.uploadLogInterval()}async uploadLogs(){let n=this.uploadLogUploadingList,i={sdk_version:Zd,process_id:ge("PROCESS_ID"),payload:JSON.stringify(n)};return Xu(async()=>{let a=await eo.post(this.url||(this.proxyServerURL?"https://".concat(this.proxyServerURL,"/ls/?h=").concat(ge("LOG_UPLOAD_SERVER"),"&p=443&d=upload/v1"):"https://".concat(ge("LOG_UPLOAD_SERVER"),"/upload/v1")),i,{responseType:"text"});if(a.data!=="OK"){let c=new Error("unexpected upload log response");throw c.response=a,c}},()=>(this.uploadLogUploadingList=[],!1),a=>{let c={status:-1,message:a.message,errorRange:n.map(u=>u.log_item_id)};return a.response?(c.status=a.response.status,c.data=a.response.data,c.headers=a.response.headers):a.request&&(c.status=a.request.status),m8.reportLogUploadError(c),!0},{timeout:ge("UPLOAD_LOG_REQUEST_RETRY_INTERVAL"),maxRetryTimeout:ge("UPLOAD_LOG_REQUEST_MAX_RETRY_INTERVAL")})}uploadLogInterval(){this.uploadLogUploadingList.length===0&&this.uploadLogWaitingList.length===0||(this.uploadLogUploadingList.length===0&&(this.uploadLogUploadingList=this.uploadLogWaitingList.splice(0,ge("UPLOAD_LOG_LENGTH_EACH_TIME"))),this.uploadLogs().then(()=>{this.uploadErrorCount=0,this.uploadLogWaitingList.length>0&&window.setTimeout(()=>this.uploadLogInterval(),ge("UPLOAD_LOG_INTERVAL"))}).catch(n=>{this.uploadErrorCount+=1,this.uploadErrorCount<2?window.setTimeout(()=>this.uploadLogInterval(),ge("UPLOAD_LOG_TWICE_RETRY_INTERVAL_V1")):window.setTimeout(()=>this.uploadLogInterval(),ge("UPLOAD_LOG_RETRY_INTERVAL_V1"))}))}};var Sl;function xi(n){return Pa(n.reportId,"params.reportId",0,100,!1),Pa(n.category,"params.category",0,100,!1),Pa(n.event,"params.event",0,100,!1),Pa(n.label,"params.label",0,100,!1),Cr(n.value,"params.value",Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,!1),!0}(Sl={}).FREE="free",Sl.UPLOADING="uploading",function(n){n[n.MISC=0]="MISC",n[n.INTERNAL_EVENT=1]="INTERNAL_EVENT",n[n.PUBLIC_EVENT=2]="PUBLIC_EVENT",n[n.WEB_EVENT=3]="WEB_EVENT",n[n.INTERNAL_API=4]="INTERNAL_API",n[n.WEB_API=5]="WEB_API",n[n.PUBLIC_API=6]="PUBLIC_API"}({});let _8={sid:"",lts:0,success:null,cname:null,uid:null,peer:null,cid:null,elapse:null,extend:null,vid:0},qt=function(n){return n.PUBLISH="publish",n.SUBSCRIBE="subscribe",n.WS_COMPRESSOR_INIT="ws_compressor_init",n.SESSION_INIT="session_init",n.JOIN_CHOOSE_SERVER="join_choose_server",n.REQ_USER_ACCOUNT="req_user_account",n.JOIN_GATEWAY="join_gateway",n.REJOIN_GATEWAY="rejoin_gateway",n.STREAM_SWITCH="stream_switch",n.REQUEST_PROXY_WORKER_MANAGER="request_proxy_worker_manager",n.REQUEST_PROXY_APPCENTER="request_proxy_appcenter",n.FIRST_VIDEO_RECEIVED="first_video_received",n.FIRST_AUDIO_RECEIVED="first_audio_received",n.FIRST_VIDEO_DECODE="first_video_decode",n.FIRST_AUDIO_DECODE="first_audio_decode",n.ON_ADD_AUDIO_STREAM="on_add_audio_stream",n.ON_ADD_VIDEO_STREAM="on_add_video_stream",n.ON_UPDATE_STREAM="on_update_stream",n.ON_REMOVE_STREAM="on_remove_stream",n.USER_ANALYTICS="req_user_analytics",n.PC_STATS="pc_stats",n.UPDATE_REMOTE_RTPCAPABILITIES="update_remote_rtpCapabilities",n.AB_TEST="ab_test",n}({}),di=function(n){return n.SESSION="io.agora.pb.Wrtc.Session",n.JOIN_CHOOSE_SERVER="io.agora.pb.Wrtc.JoinChooseServer",n.REQ_USER_ACCOUNT="io.agora.pb.Wrtc.ReqUserAccount",n.JOIN_GATEWAY="io.agora.pb.Wrtc.JoinGateway",n.RE_JOIN_GATEWAY="io.agora.pb.Wrtc.ReJoinGateway",n.PUBLISH="io.agora.pb.Wrtc.Publish",n.SUBSCRIBE="io.agora.pb.Wrtc.Subscribe",n.WS_COMPRESSOR_INIT="io.agora.pb.Wrtc.WsCompressorInit",n.STREAM_SWITCH="io.agora.pb.Wrtc.StreamSwitch",n.AUDIO_SENDING_STOPPED="io.agora.pb.Wrtc.AudioSendingStopped",n.VIDEO_SENDING_STOPPED="io.agora.pb.Wrtc.VideoSendingStopped",n.REQUEST_PROXY_APPCENTER="io.agora.pb.Wrtc.RequestProxyAppCenter",n.REQUEST_PROXY_WORKER_MANAGER="io.agora.pb.Wrtc.RequestProxyWorkerManager",n.API_INVOKE="io.agora.pb.Wrtc.ApiInvoke",n.FIRST_VIDEO_RECEIVED="io.agora.pb.Wrtc.FirstVideoReceived",n.FIRST_AUDIO_RECEIVED="io.agora.pb.Wrtc.FirstAudioReceived",n.FIRST_VIDEO_DECODE="io.agora.pb.Wrtc.FirstVideoDecode",n.FIRST_AUDIO_DECODE="io.agora.pb.Wrtc.FirstAudioDecode",n.ON_ADD_AUDIO_STREAM="io.agora.pb.Wrtc.OnAddAudioStream",n.ON_ADD_VIDEO_STREAM="io.agora.pb.Wrtc.OnAddVideoStream",n.ON_UPDATE_STREAM="io.agora.pb.Wrtc.OnUpdateStream",n.ON_REMOVE_STREAM="io.agora.pb.Wrtc.OnRemoveStream",n.JOIN_CHANNEL_TIMEOUT="io.agora.pb.Wrtc.JoinChannelTimeout",n.PEER_PUBLISH_STATUS="io.agora.pb.Wrtc.PeerPublishStatus",n.WORKER_EVENT="io.agora.pb.Wrtc.WorkerEvent",n.AP_WORKER_EVENT="io.agora.pb.Wrtc.APWorkerEvent",n.JOIN_WEB_PROXY_AP="io.agora.pb.Wrtc.JoinWebProxyAP",n.WEBSOCKET_QUIT="io.agora.pb.Wrtc.WebSocketQuit",n.USER_ANALYTICS="io.agora.pb.Wrtc.UserAnalytics",n.AUTOPLAY_FAILED="io.agora.pb.Wrtc.AutoplayFailed",n.PC_STATS="io.agora.pb.Wrtc.PCStats",n.UPDATE_REMOTE_RTPCAPABILITIES="io.agora.pb.Wrtc.UpdateRemoteRTPCapabilities",n.AB_TEST="io.agora.pb.Wrtc.ABTest",n}({});(function(n){n[n.WORKER_EVENT=156]="WORKER_EVENT",n[n.AP_WORKER_EVENT=160]="AP_WORKER_EVENT"})({});let dY=function(n){return n[n.SESSION=26]="SESSION",n[n.JOIN_CHOOSE_SERVER=27]="JOIN_CHOOSE_SERVER",n[n.REQ_USER_ACCOUNT=196]="REQ_USER_ACCOUNT",n[n.JOIN_GATEWAY=28]="JOIN_GATEWAY",n[n.PUBLISH=30]="PUBLISH",n[n.SUBSCRIBE=29]="SUBSCRIBE",n[n.WS_COMPRESSOR_INIT=9430]="WS_COMPRESSOR_INIT",n[n.STREAM_SWITCH=32]="STREAM_SWITCH",n[n.AUDIO_SENDING_STOPPED=33]="AUDIO_SENDING_STOPPED",n[n.VIDEO_SENDING_STOPPED=34]="VIDEO_SENDING_STOPPED",n[n.REQUEST_PROXY_APPCENTER=35]="REQUEST_PROXY_APPCENTER",n[n.REQUEST_PROXY_WORKER_MANAGER=36]="REQUEST_PROXY_WORKER_MANAGER",n[n.API_INVOKE=41]="API_INVOKE",n[n.FIRST_VIDEO_RECEIVED=348]="FIRST_VIDEO_RECEIVED",n[n.FIRST_AUDIO_RECEIVED=349]="FIRST_AUDIO_RECEIVED",n[n.FIRST_VIDEO_DECODE=350]="FIRST_VIDEO_DECODE",n[n.FIRST_AUDIO_DECODE=351]="FIRST_AUDIO_DECODE",n[n.ON_ADD_AUDIO_STREAM=352]="ON_ADD_AUDIO_STREAM",n[n.ON_ADD_VIDEO_STREAM=353]="ON_ADD_VIDEO_STREAM",n[n.ON_UPDATE_STREAM=356]="ON_UPDATE_STREAM",n[n.ON_REMOVE_STREAM=355]="ON_REMOVE_STREAM",n[n.JOIN_CHANNEL_TIMEOUT=407]="JOIN_CHANNEL_TIMEOUT",n[n.PEER_PUBLISH_STATUS=408]="PEER_PUBLISH_STATUS",n[n.WORKER_EVENT=156]="WORKER_EVENT",n[n.AP_WORKER_EVENT=160]="AP_WORKER_EVENT",n[n.JOIN_WEB_PROXY_AP=700]="JOIN_WEB_PROXY_AP",n[n.WEBSOCKET_QUIT=671]="WEBSOCKET_QUIT",n[n.USER_ANALYTICS=1e4]="USER_ANALYTICS",n[n.AUTOPLAY_FAILED=9178]="AUTOPLAY_FAILED",n}({});function $t(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return function(i,a,c){let u=c.value;if(typeof u=="function"){let _=n.className||i.__className__||(i.constructor.name==="AgoraRTCClient"?"Client":i.constructor.name);c.value=function(){for(var S,C=arguments.length,R=new Array(C),e=0;e<C;e++)R[e]=arguments[e];let t=R;if(n.argsMap)try{t=n.argsMap(this,...R)}catch(s){z.warning(s),t=[]}try{JSON.stringify(t)}catch{z.warning("arguments for method ".concat(_,".").concat(String(a)," not serializable for apiInvoke.")),t=[]}let r=(n.report||jt).reportApiInvoke(this._sessionId||null,{id:this._clientId||((S=this.store)===null||S===void 0?void 0:S.clientId)||this._ID,name:"".concat(_,".").concat(String(a)),options:t,tag:Li.TRACER,reportResult:n.reportResult},n.throttleTime);try{let s=u.apply(this,R);return s instanceof Et?s.then(l=>(r.onSuccess(n.reportResult&&l),l)).catch(l=>{throw r.onError(l),l}):(r.onSuccess(n.reportResult&&s),s)}catch(s){throw r.onError(s),s}}}return c}}let jt=new class{constructor(){zr(this,"baseInfoMap",new Map),zr(this,"proxyServer",void 0),zr(this,"eventUploadTimer",void 0),zr(this,"setSessionIdTimer",void 0),zr(this,"url",void 0),zr(this,"sids",new Set),zr(this,"backupUrl",void 0),zr(this,"_appId",void 0),zr(this,"_aid",0),zr(this,"keyEventUploadPendingItems",[]),zr(this,"normalEventUploadPendingItems",[]),zr(this,"apiInvokeUploadPendingItems",[]),zr(this,"apiInvokeCount",0),zr(this,"apiInvokeLoggedCount",0),zr(this,"ltsList",[]),zr(this,"lastSendNormalEventTime",Date.now()),zr(this,"customReportCounterTimer",void 0),zr(this,"customReportCount",0),zr(this,"extApiInvoke",async n=>{for(let i of n){let a=on(on({},i),{},{sid:null,invokeId:++this.apiInvokeCount,tag:Li.TRACER});this.sendApiInvoke(a)}}),this.eventUploadTimer=window.setInterval(this.doSend.bind(this),ge("EVENT_REPORT_SEND_INTERVAL")),this.setSessionIdTimer=window.setInterval(this.appendSessionId.bind(this),ge("EVENT_REPORT_SEND_INTERVAL"))}getBaseInfoBySessionId(n){return this.baseInfoMap.get(n)}setAppId(n){this._appId=n,this._aid=parseInt(n.replace(/[a-fA-F0-9]{8}/g,i=>{let[a,c]=i;return a+c}),16)||0}reportApiInvoke(n,i,a){i.timeout=i.timeout||6e4,i.reportResult=i.reportResult===void 0||i.reportResult;let c=Date.now();this.apiInvokeCount+=1;let u=this.apiInvokeCount,_=!!ge("SHOW_REPORT_INVOKER_LOG"),S=!!ge("SHOW_REPORT_USER_INVOKER_LOG"),C=_||S&&i.id;C&&(this.apiInvokeLoggedCount+=1);let R=this.apiInvokeLoggedCount;function e(l,f){if(C){let m="[apiInvoke-".concat(R,"]");i.id&&(m+="[".concat(i.id,"]")),i.name&&(m+="[".concat(i.name,"]")),z.info("".concat(m," ").concat(l),l==="start"?i.options:f||"")}}let t=()=>({tag:i.tag,invokeId:u,sid:n,name:i.name,apiInvokeTime:c,options:i.options,states:i.states||null});e("start");let r=!1;Mn(i.timeout).then(()=>{r||(this.sendApiInvoke(on(on({},t()),{},{error:oe.API_INVOKE_TIMEOUT,success:!1})),e("timeout"))});let s=new Ye(oe.UNEXPECTED_ERROR,"".concat(i.name,": this api invoke is end"));return{onSuccess:l=>{let f=()=>{if(r)throw s;return r=!0,this.sendApiInvoke(on(on({},t()),{},{success:!0},i.reportResult&&{result:l})),e("onSuccess"),l};return a?Lg(f,i.name+"Success",a,()=>r=!0):f()},onError:l=>{let f=()=>{if(r)throw l;r=!0,this.sendApiInvoke(on(on({},t()),{},{success:!1,error:l})),e("onFailure",l.toString())};return a?Lg(f,i.name+"Error",a,()=>r=!0):f()}}}sessionInit(n,i){if(this.baseInfoMap.has(n))return;let a=Date.now(),c=this.createBaseInfo(n,a);c.cname=i.cname;let u=Object.assign({},{willUploadConsoleLog:ge("UPLOAD_LOG"),maxTouchPoints:navigator.maxTouchPoints,areaVersion:bS?"global":"oversea",areas:ge("AREAS")&&ge("AREAS").join(",")},i.extend),{stringUid:_,channelProfile:S,channelMode:C,isABTestSuccess:R,lsid:e,clientRole:t}=i,r=Date.now(),s=on(on({},c),{},{eventType:qt.SESSION_INIT,appid:i.appid,browser:navigator.userAgent,buildFormat:i.buildFormat,build:CS,lts:r,elapse:r-a,extend:JSON.stringify(u),mode:i.mode,process:ge("PROCESS_ID"),appType:ge("APP_TYPE"),success:!0,version:Zd,stringUid:_,channelProfile:S,channelMode:C,isABTestSuccess:R,lsid:e,clientType:ft(l=window.navigator.userAgent).call(l,"AgoraWebView")?42:20,clientRole:t,serviceId:ge("PROCESS_ID"),extensionID:ge("PLUGIN_INFO").join(",")||""});var l;this.send({type:di.SESSION,data:s},!0)}joinChooseServer(n,i){let a=this.baseInfoMap.get(n);if(!a)return;let c=a.info,u=Date.now(),_=on(on({},c),{},{role:i.role,eventType:qt.JOIN_CHOOSE_SERVER,lts:u,eventElapse:i.elapse||u-i.lts,chooseServerAddr:i.csAddr,errorCode:i.ec,elapse:u-a.startTime,success:i.succ,chooseServerAddrList:JSON.stringify(i.serverList),uid:i.uid?parseInt(i.uid):null,cid:i.cid?parseInt(i.cid):null,chooseServerIp:i.csIp||"",opid:i.opid,unilbsServerIds:i.unilbsServerIds,extend:i.extend||void 0,isHttp3:i.isHttp3,corssRegionTagReq:i.corssRegionTagReq||void 0,corssRegionTagRes:i.corssRegionTagRes||void 0});this.send({type:di.JOIN_CHOOSE_SERVER,data:_},!0)}reqUserAccount(n,i){let a=this.baseInfoMap.get(n);if(!a)return;let c=a.info,u=Date.now(),_=on(on({},c),{},{eventType:qt.REQ_USER_ACCOUNT,lts:u,success:i.success,serverAddress:i.serverAddr,stringUid:i.stringUid,uid:i.uid,errorCode:i.errorCode,elapse:i.elapse||u-a.startTime,eventElapse:u-i.lts,extend:JSON.stringify(i.extend)});this.send({type:di.REQ_USER_ACCOUNT,data:_},!0)}joinGateway(n,i){let a=this.baseInfoMap.get(n);if(!a)return;let c=a.info;i.vid&&(c.vid=i.vid),c.uid=i.uid,c.cid=i.cid;let u=Date.now(),{firstSuccess:_,avoidJoinStartTime:S,addr:C,isProxy:R}=i,e=u-(_&&S?S:a.startTime),t=on(on({},c),{},{eventType:qt.JOIN_GATEWAY,lts:u,gatewayAddr:i.addr,success:i.succ,errorCode:i.ec,errorMsg:i.errorMsg||"",elapse:e,eventElapse:u-i.lts,firstSuccess:_,signalChannel:i.signalChannel,preload:i.preload?1:0,installId:lI(),isABTestSuccess:i.isABTestSuccess?1:0}),r=t.success?1:0;if(i.succ&&(a.lastJoinSuccessTime=u),_)this.send({type:di.JOIN_GATEWAY,data:t},!0);else{let s;if(C)if(R){let f=C.match(/h=(\d{1,3}-){3}\d{1,3}/g),m=C.match(/p=[0-9]{1,6}/g);s={isSuccess:r,gatewayIp:f&&f.length?f[0].split("=")[1].replace(/-/g,"."):"",port:m&&m.length?m[0].split("=")[1]:"",isProxy:R?1:0}}else{let f=C.match(/wss:\/\/(\d{1,3}-){3}\d{1,3}/g),m=C.match(/(:|p=)[0-9]{1,6}/g);s={isSuccess:r,gatewayIp:f&&f.length?f[0].split("//")[1].replace(/-/g,"."):"",port:m&&m.length?m[0].split(/:|p=/g)[1]:"",isProxy:R?1:0}}else s={isSuccess:r,gatewayIp:"",port:"",isProxy:R?1:0};delete t.success,delete t.eventType,delete t.firstSuccess,t.vid=Number(t.vid);let l=Object.assign({},t,s,{eventType:qt.REJOIN_GATEWAY});this.send({type:di.RE_JOIN_GATEWAY,data:l},!0)}}joinChannelTimeout(n,i){let a=this.baseInfoMap.get(n);if(!a)return;let c=Date.now(),u=on(on({},a.info),{},{lts:c,timeout:i,elapse:c-a.startTime});this.send({type:di.JOIN_CHANNEL_TIMEOUT,data:u},!0)}publish(n,i){let a=this.baseInfoMap.get(n);if(!a)return;let c=a.info,u=Date.now(),_=on(on({},c),{},{eventType:qt.PUBLISH,lts:u,eventElapse:i.eventElapse,elapse:u-a.startTime,success:i.succ,errorCode:i.ec,videoName:i.videoName,audioName:i.audioName,screenName:i.screenName,screenshare:i.screenshare,audio:i.audio,video:i.video,p2pid:i.p2pid,publishRequestid:i.publishRequestid});this.send({type:di.PUBLISH,data:_},!0)}subscribe(n,i,a){let c=this.baseInfoMap.get(n);if(!c)return;let u=c.info,_=Date.now(),S=on(on({},u),{},{eventType:qt.SUBSCRIBE,lts:_,eventElapse:i.eventElapse,elapse:_-c.startTime,success:i.succ,errorCode:i.ec,video:i.video,audio:i.audio,subscribeRequestid:i.subscribeRequestid,p2pid:i.p2pid,preSsrc:i.preSsrc?1:0},a&&{extend:JSON.stringify({isMassSubscribe:!0})});typeof i.peerid=="string"?S.peerSuid=i.peerid:S.peer=i.peerid,this.send({type:di.SUBSCRIBE,data:S},!0)}wsCompressorInit(n){var i;let a=[...td(i=this.baseInfoMap).call(i)],c=a.length?a[0]:"UnableToGetSid",u=this.baseInfoMap.get(c);if(!u)return;let _=u.info,S=Date.now(),C=on(on({},_),{},{eventType:qt.WS_COMPRESSOR_INIT,lts:S,eventElapse:n.eventElapse,elapse:S-u.startTime,status:n.status?1:2});this.send({type:di.WS_COMPRESSOR_INIT,data:C},!0)}firstRemoteVideoDecode(n,i,a,c){let u=this.baseInfoMap.get(n);if(!u)return;let _=u.info,S=Date.now(),C=on(on(on({},_),c),{},{elapse:S-u.startTime,eventType:i,lts:S,firstDecodeFrame:Math.max((c.firstFrame||S)-u.startTime,0),apEnd:Math.max(c.apEnd-u.startTime,0),apStart:Math.max(c.apStart-u.startTime,0),joinGwEnd:Math.max(c.joinGwEnd-u.startTime,0),joinGwStart:Math.max(c.joinGwStart-u.startTime,0),pcEnd:Math.max(c.pcEnd-u.startTime,0),pcStart:Math.max(c.pcStart-u.startTime,0),subscriberEnd:Math.max(c.subscriberEnd-u.startTime,0),subscriberStart:Math.max(c.subscriberStart-u.startTime,0),videoAddNotify:Math.max(c.videoAddNotify-u.startTime,0)});this.send({type:a,data:C},!0)}firstRemoteFrame(n,i,a,c){let u=this.baseInfoMap.get(n);if(!u)return;let _=u.info,S=Date.now(),C=on(on(on({},_),c),{},{elapse:S-u.startTime,eventType:i,lts:S});this.send({type:a,data:C},!0)}abTest(n,i){let a=this.baseInfoMap.get(n);if(!a)return;let c=a.info,u=Date.now(),_=on(on(on({},c),i),{},{vid:c.vid===void 0?0:Number(c.vid),elapse:u-a.startTime,eventType:qt.AB_TEST,lts:u});this.send({type:di.AB_TEST,data:_},!0)}pcStats(n,i){let a=this.baseInfoMap.get(n);if(!a)return;let c=a.info,u=Date.now(),_=on(on(on({},c),i),{},{vid:c.vid===void 0?0:Number(c.vid),elapse:u-a.startTime,eventType:qt.PC_STATS,lts:u,preallocation:i.preallocation?1:0});this.send({type:di.PC_STATS,data:_},!0)}updateRemoteRTPCapabilities(n,i){if(n){let a=this.baseInfoMap.get(n);if(!a)return;let c=a.info,u=Date.now(),_=on(on(on({},c),i),{},{vid:c.vid===void 0?0:Number(c.vid),eventType:qt.UPDATE_REMOTE_RTPCAPABILITIES,lts:u});this.send({type:di.UPDATE_REMOTE_RTPCAPABILITIES,data:_},!0)}}onGatewayStream(n,i,a,c){let u=this.baseInfoMap.get(n);if(!u)return;let _=u.info,S=Date.now(),C=on(on(on({},_),c),{},{eventType:i,lts:S});this.send({type:a,data:C},!0)}streamSwitch(n,i){let a=this.baseInfoMap.get(n);if(!a)return;let c=a.info,u=Date.now(),_=on(on({},c),{},{eventType:qt.STREAM_SWITCH,lts:u,isDual:i.isdual,elapse:u-a.startTime,success:i.succ});this.send({type:di.STREAM_SWITCH,data:_},!0)}requestProxyAppCenter(n,i){let a=this.baseInfoMap.get(n);if(!a)return;let c=a.info,u=Date.now(),_=on(on({},c),{},{eventType:qt.REQUEST_PROXY_APPCENTER,lts:u,eventElapse:u-i.lts,elapse:u-a.startTime,APAddr:i.APAddr,workerManagerList:i.workerManagerList,response:i.response,errorCode:i.ec,success:i.succ});this.send({type:di.REQUEST_PROXY_APPCENTER,data:_},!0)}requestProxyWorkerManager(n,i){let a=this.baseInfoMap.get(n);if(!a)return;let c=a.info,u=Date.now(),_=on(on({},c),{},{eventType:qt.REQUEST_PROXY_WORKER_MANAGER,lts:u,eventElapse:u-i.lts,elapse:u-a.startTime,workerManagerAddr:i.workerManagerAddr,response:i.response,errorCode:i.ec,success:i.succ});this.send({type:di.REQUEST_PROXY_WORKER_MANAGER,data:_},!0)}setProxyServer(n){this.proxyServer=n,n?z.debug("reportProxyServerurl: ".concat(n)):z.debug("disable reportProxyServerurl: ".concat(n))}peerPublishStatus(n,i){let a=this.baseInfoMap.get(n);if(!a)return;let c=a.info,u=Date.now(),_=on(on({},c),{},{subscribeElapse:i.subscribeElapse,peer:i.peer,peerPublishDuration:Math.max(i.audioPublishDuration,i.videoPublishDuration),audiotag:i.audioPublishDuration>0?1:-1,videotag:i.videoPublishDuration>0?1:-1,lts:u,elapse:u-a.startTime,joinChannelSuccessElapse:u-(a.lastJoinSuccessTime||u),peerPublishDurationVideo:i.videoPublishDuration,peerPublishDurationAudio:i.audioPublishDuration});this.send({type:di.PEER_PUBLISH_STATUS,data:_},!0)}workerEvent(n,i){let a=this.baseInfoMap.get(n);if(!a)return;let c=a.info,u=Date.now();(function(_,S,C){let R=_[S];if(!R||typeof R!="string")return[_];_[S]="";let e=Qd(JSON.stringify(_)),t=0,r=[],s=0;for(let l=0;l<R.length;l++)s+=R.charCodeAt(l)<=127?1:3,s<=C-e||(r[r.length]=Ct(Ct({},_),{},{[S]:R.substring(t,l)}),t=l,s=R.charCodeAt(l)<=127?1:3);return t!==R.length-1&&(r[r.length]=Ct(Ct({},_),{},{[S]:R.substring(t)})),r})(on(on(on({},c),i),{},{elapse:u-a.startTime,lts:u,productType:"WebRTC"}),"payload",1300).forEach(_=>this.send({type:di.WORKER_EVENT,data:_},!0))}apworkerEvent(n,i){let a=this.baseInfoMap.get(n);if(!a)return;let c=a.info,u=Date.now(),_=on(on(on({},c),i),{},{elapse:u-a.startTime,lts:u});this.send({type:di.AP_WORKER_EVENT,data:_},!0)}joinWebProxyAP(n,i){let a=this.baseInfoMap.get(n);if(!a)return;let c=a.info,u=Date.now(),_=on(on(on({},c),i),{},{elapse:u-a.startTime,lts:u,extend:i.extend||void 0});this.send({type:di.JOIN_WEB_PROXY_AP,data:_},!0)}WebSocketQuit(n,i){let a=this.baseInfoMap.get(n);if(!a)return;let c=a.info,u=Date.now(),_=on(on(on({},c),i),{},{elapse:u-a.startTime,lts:u});this.send({type:di.WEBSOCKET_QUIT,data:_},!0)}async sendCustomReportMessage(n,i){if(this.customReportCount+=i.length,this.customReportCount>ge("CUSTOM_REPORT_LIMIT"))throw new Ye(oe.CUSTOM_REPORT_FREQUENCY_TOO_HIGH);this.customReportCounterTimer||(this.customReportCounterTimer=window.setInterval(()=>{this.customReportCount=0},5e3));let a=Date.now(),c=i.map(u=>({type:di.USER_ANALYTICS,data:on(on({sid:n},u),{},{lts:a})}));try{ge("NEW_REPORT_SERVER")?await this.postDataToStatsCollector2(c):await this.postDataToStatsCollector(c)}catch(u){throw z.error("send custom report message failed",u.toString()),new Ye(oe.CUSTOM_REPORT_SEND_FAILED,u.message)}}sendApiInvoke(n){let i=ge("NOT_REPORT_EVENT");if(n.tag&&ft(i)&&ft(i).call(i,n.tag))return!1;if(n.sid===null)return this.apiInvokeUploadPendingItems.push(n),!1;let a=this.baseInfoMap.get(n.sid);if(!a)return this.apiInvokeUploadPendingItems.push(n),!1;let{cname:c,uid:u,cid:_}=a.info,S;if(n.lts=n.lts||Date.now(),n.error)if(n.error instanceof Ye){let{code:R,message:e}=n.error;S=R||e||n.error.toString()}else S=n.error.toString();let C={invokeId:n.invokeId,sid:n.sid,cname:c,cid:_,uid:u,lts:n.lts,success:n.success,elapse:n.lts-a.startTime,execElapse:n.lts-n.apiInvokeTime,apiName:n.name,options:n.options?JSON.stringify(n.options):void 0,execStates:n.states?JSON.stringify(n.states):void 0,execResult:n.result?JSON.stringify(n.result):void 0,errorCode:n.error?S:void 0,errorMsg:n.error?JSON.stringify(n.error):void 0};return this.send({type:di.API_INVOKE,data:C},!1),!0}addSid(n){this.sids.add(n)}removeSid(n){this.sids.delete(n)}appendSessionId(){let n=this.apiInvokeUploadPendingItems;if(n.length===0)return;let i=Array.from(this.sids).find(a=>a!==null);i&&n.forEach(a=>{a&&(a.sid=i,this.sendApiInvoke(Object.assign({},a)))}),n.length=0}send(n,i){if(i)return this.keyEventUploadPendingItems.push(n),void this.sendItems(this.keyEventUploadPendingItems,!0);this.normalEventUploadPendingItems.push(n),this.normalEventUploadPendingItems.length>ge("NORMAL_EVENT_QUEUE_CAPACITY")&&this.normalEventUploadPendingItems.splice(0,1),this.normalEventUploadPendingItems.length>=10&&this.sendItems(this.normalEventUploadPendingItems,!1)}doSend(){this.keyEventUploadPendingItems.length>0&&this.sendItems(this.keyEventUploadPendingItems,!0),this.normalEventUploadPendingItems.length>0&&Date.now()-this.lastSendNormalEventTime>=5e3&&this.sendItems(this.normalEventUploadPendingItems,!1)}sendItems(n,i){let a=[],c=[];for(;n.length;){let _=n.shift();a.length<20?a.push(_):c.push(_)}n.push(...c);for(let _ of[...a]){var u;this.ltsList.indexOf(_.data.lts)!==-1?(_.data.lts=this.ltsList[this.ltsList.length-1]+1,this.ltsList.push(_.data.lts)):(this.ltsList.push(_.data.lts),CR(u=this.ltsList).call(u,(S,C)=>S-C))}return i||(this.lastSendNormalEventTime=Date.now()),ge("ENABLE_EVENT_REPORT")&&a.length&&(ge("NEW_REPORT_SERVER")?this.postDataToStatsCollector2(a):this.postDataToStatsCollector(a)).catch((_=>S=>{ge("EVENT_REPORT_RETRY")&&(i?this.keyEventUploadPendingItems=this.keyEventUploadPendingItems.concat(_):(this.normalEventUploadPendingItems=this.normalEventUploadPendingItems.concat(_),this.normalEventUploadPendingItems.length>ge("NORMAL_EVENT_QUEUE_CAPACITY")&&(this.normalEventUploadPendingItems.splice(0,this.normalEventUploadPendingItems.length-ge("NORMAL_EVENT_QUEUE_CAPACITY")),z.warning("report: drop normal events"))))})(a)),n}async postDataToStatsCollector2(n){ki.networkState===Uc.OFFLINE&&await Et.race([ki.onlineWaiter,Mn(2*da.maxRetryTimeout)]);let i=u=>{let _=new Uint8Array;return u.forEach(S=>{let C=hh(JSON.stringify(S.data)),R=new ArrayBuffer(5),e=(r=>{let s=0;return Object.entries(di).forEach(l=>{let[f,m]=l;m===r.type&&(s=dY[f])}),s})(S),t=new DataView(R);t.setUint16(0,C.byteLength,!0),t.setUint8(2,255&e),t.setUint8(3,e>>>8&255),t.setUint8(4,e>>>16&255),_=Aa(_,new Uint8Array(R)),_=Aa(_,C)}),_},a="event",c=this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(ge("NEW_REPORT_SERVER_DOMAINS")[0],"&p=443&d=").concat(a):"https://".concat(ge("NEW_REPORT_SERVER_DOMAINS")[0],"/").concat(a);for(let u=0;u<2;u+=1){u===1&&(c=this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(ge("NEW_REPORT_SERVER_DOMAINS")[1],"&p=443&d=").concat(a):"https://".concat(ge("NEW_REPORT_SERVER_DOMAINS")[1],"/").concat(a));try{await SL(c,{timeout:1e4,data:i(n),headers:on(on({biz:"webrtc",sendts:Math.round(Date.now()/1e3),debug:"false"},this._appId&&{appid:this._appId}),{},{"Content-Type":"application/octet-stream"})},!0)}catch(_){if(u===1)throw _;continue}return}}async postDataToStatsCollector(n){let i=arguments.length>1&&arguments[1]!==void 0&&arguments[1],a=(C=>{let R=C&&C.data.sid&&this.baseInfoMap.get(C.data.sid);return R&&R.info.vid&&+R.info.vid||0})(n[0]),c=a?void 0:this._aid,u={msgType:"EventMessages",sentTs:Math.round(Date.now()/1e3),payloads:n.map(C=>JSON.stringify(C)),vid:a,aid:c};ki.networkState===Uc.OFFLINE&&await Et.race([ki.onlineWaiter,Mn(2*da.maxRetryTimeout)]);let _=i?"/events/proto-raws":"/events/messages",S=this.url||(this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(ge("EVENT_REPORT_DOMAIN"),"&p=").concat(ge("STATS_COLLECTOR_PORT"),"&d=").concat(_):"https://".concat(ge("EVENT_REPORT_DOMAIN"),":").concat(ge("STATS_COLLECTOR_PORT")).concat(_));for(let C=0;C<2;C+=1){C===1&&(S=this.backupUrl||(this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(ge("EVENT_REPORT_BACKUP_DOMAIN"),"&p=").concat(ge("STATS_COLLECTOR_PORT"),"&d=").concat(_):"https://".concat(ge("EVENT_REPORT_BACKUP_DOMAIN"),":").concat(ge("STATS_COLLECTOR_PORT")).concat(_)));try{i?await oY(S,{timeout:1e4,data:u}):await SL(S,{timeout:1e4,data:u})}catch(R){if(C===1)throw R;continue}return}}createBaseInfo(n,i){let a=Object.assign({},_8);return a.sid=n,this.baseInfoMap.set(n,{info:a,startTime:i}),a}reportResourceTiming(n,i){let a=performance.getEntriesByName(n),c=a[a.length-1];c&&this.reportApiInvoke(i,{name:"Client.resourceTiming",options:c,tag:Li.TRACER}).onSuccess()}};m8.on("REPORT_LOG_UPLOAD",n=>{n.networkState=ki.networkState,jt.reportApiInvoke(null,{name:"logUploadError",options:n,tag:Li.TRACER}).onSuccess("logUploadError")});class De extends Ye{constructor(i){super(i,arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",arguments.length>2?arguments[2]:void 0),zr(this,"name","AgoraRTCException")}print(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"error";return super.print(i,z)}throw(){super.throw(z)}}let ka={getDisplayMedia:!1,getStreamFromExtension:!1,supportUnifiedPlan:!1,supportMinBitrate:!1,supportSetRtpSenderParameters:!1,supportDualStream:!0,webAudioMediaStreamDest:!1,supportReplaceTrack:!1,supportWebGL:!1,webAudioWithAEC:!1,supportRequestFrame:!1,supportShareAudio:!1,supportDualStreamEncoding:!1,supportDataChannel:!1,supportPCSetConfiguration:!1,supportWebRTCEncodedTransform:!1,supportWebRTCInsertableStream:!1,supportRequestVideoFrameCallback:!1,supportWebCrypto:!1};function Un(){return ka}function G(){return"setSinkId"in HTMLAudioElement.prototype&&(!ge("RESTRICTION_SET_PLAYBACK_DEVICE")||(Vo()||sr())&&!mL())}function Px(){return!ka.supportUnifiedPlan||ge("CHROME_FORCE_PLAN_B")&&jp()}let ms=function(n){return n.IOS_15_16_INTERRUPTION_START="ios15_16-interruption-start",n.IOS_15_16_INTERRUPTION_END="ios15_16-interruption-end",n.IOS_INTERRUPTION_START="ios-interruption-start",n.IOS_INTERRUPTION_END="ios-interruption-end",n.STATE_CHANGE="state-change",n}({});function Kb(n,i,a){return{sampleRate:n,stereo:i,bitrate:a}}function fn(n,i,a,c,u){return{width:n,height:i,frameRate:a,bitrateMin:c,bitrateMax:u}}function _r(n,i,a,c,u){return{width:{max:n},height:{max:i},frameRate:a,bitrateMin:c,bitrateMax:u}}function Mx(n,i){return{numSpatialLayers:n,numTemporalLayers:i}}let nn={"90p":fn(160,90),"90p_1":fn(160,90),"120p":fn(160,120,15,30,65),"120p_1":fn(160,120,15,30,65),"120p_3":fn(120,120,15,30,50),"120p_4":fn(212,120),"180p":fn(320,180,15,30,140),"180p_1":fn(320,180,15,30,140),"180p_3":fn(180,180,15,30,100),"180p_4":fn(240,180,15,30,120),"240p":fn(320,240,15,40,200),"240p_1":fn(320,240,15,40,200),"240p_3":fn(240,240,15,40,140),"240p_4":fn(424,240,15,40,220),"360p":fn(640,360,15,80,400),"360p_1":fn(640,360,15,80,400),"360p_3":fn(360,360,15,80,260),"360p_4":fn(640,360,30,80,600),"360p_6":fn(360,360,30,80,400),"360p_7":fn(480,360,15,80,320),"360p_8":fn(480,360,30,80,490),"360p_9":fn(640,360,15,80,800),"360p_10":fn(640,360,24,80,800),"360p_11":fn(640,360,24,80,1e3),"480p":fn(640,480,15,100,500),"480p_1":fn(640,480,15,100,500),"480p_2":fn(640,480,30,100,1e3),"480p_3":fn(480,480,15,100,400),"480p_4":fn(640,480,30,100,750),"480p_6":fn(480,480,30,100,600),"480p_8":fn(848,480,15,100,610),"480p_9":fn(848,480,30,100,930),"480p_10":fn(640,480,10,100,400),"720p":fn(1280,720,15,120,1130),"720p_auto":fn(1280,720,30,900,3e3),"720p_1":fn(1280,720,15,120,1130),"720p_2":fn(1280,720,30,120,2e3),"720p_3":fn(1280,720,30,120,1710),"720p_5":fn(960,720,15,120,910),"720p_6":fn(960,720,30,120,1380),"1080p":fn(1920,1080,15,120,2080),"1080p_1":fn(1920,1080,15,120,2080),"1080p_2":fn(1920,1080,30,120,3e3),"1080p_3":fn(1920,1080,30,120,3150),"1080p_5":fn(1920,1080,60,120,4780),"1440p":fn(2560,1440,30,120,4850),"1440p_1":fn(2560,1440,30,120,4850),"1440p_2":fn(2560,1440,60,120,7350),"4k":fn(3840,2160,30,120,8910),"4k_1":fn(3840,2160,30,120,8910),"4k_3":fn(3840,2160,60,120,13500)},Vt={"480p":_r(640,480,5),"480p_1":_r(640,480,5),"480p_2":_r(640,480,30),"480p_3":_r(640,480,15),"720p":_r(1280,720,5),"720p_auto":fn(1280,720,30,900,3e3),"720p_1":_r(1280,720,5),"720p_2":_r(1280,720,30),"720p_3":_r(1280,720,15),"1080p":_r(1920,1080,5),"1080p_1":_r(1920,1080,5),"1080p_2":_r(1920,1080,30),"1080p_3":_r(1920,1080,15)},xe={"1SL1TL":Mx(1,1),"3SL3TL":Mx(3,3),"2SL3TL":Mx(2,3)};function zi(n){return n||(n="480p_1"),typeof n=="string"?Object.assign({},nn[n]):n}function zn(n){return typeof n=="string"?Object.assign({},Vt[n]):n}function uI(n){return typeof n=="string"?Object.assign({},xe[n]):n}let E8={speech_low_quality:Kb(16e3,!1),speech_standard:Kb(32e3,!1,18),music_standard:Kb(48e3,!1),standard_stereo:Kb(48e3,!0,56),high_quality:Kb(48e3,!1,128),high_quality_stereo:Kb(48e3,!0,192)};function xa(n){return typeof n=="string"?Object.assign({},E8[n]):n}let _h=[];function Jn(n){return Ia(n,"mediaSource",["screen","window","application"]),!0}let bt=function(n){return n.NEED_RENEGOTIATE="@need_renegotiate",n.NEED_REPLACE_TRACK="@need_replace_track",n.NEED_REPLACE_MIXING_TRACK="@need_replace_mixing_track",n.NEED_CLOSE="@need_close",n.NEED_ENABLE_TRACK="@need_enable_track",n.NEED_DISABLE_TRACK="@need_disable_track",n.NEED_SESSION_ID="@need_sid",n.SET_OPTIMIZATION_MODE="@set_optimization_mode",n.GET_STATS="@get_stats",n.GET_RTC_STATS="@get_rtc_stats",n.GET_LOW_VIDEO_TRACK="@get_low_video_track",n.NEED_RESET_REMOTE_SDP="@need_reset_remote_sdp",n.NEED_UPDATE_VIDEO_ENCODER="@need_update_video_encoder",n.NEED_UPDATE_VIDEO_SEND_PARAMETERS="@need_update_video_send_parameters",n.NEED_MUTE_TRACK="@need_mute_track",n.NEED_UNMUTE_TRACK="@need_unmute_track",n}({}),kr=function(n){return n.SCREEN_TRACK="screen_track",n.CUSTOM_TRACK="custome_track",n.LOW_STREAM="low_stream",n.SCREEN_LOW_TRACK="screen_low_track",n}({}),qb=function(n){return n[n.HIGH_STREAM=0]="HIGH_STREAM",n[n.LOW_STREAM=1]="LOW_STREAM",n}({}),uY=function(n){return n[n.HIGH_STREAM=0]="HIGH_STREAM",n[n.LOW_STREAM=1]="LOW_STREAM",n[n.HIGH_STREAM_LAYER1=4]="HIGH_STREAM_LAYER1",n[n.HIGH_STREAM_LAYER2=5]="HIGH_STREAM_LAYER2",n[n.HIGH_STREAM_LAYER3=6]="HIGH_STREAM_LAYER3",n[n.HIGH_STREAM_LAYER4=7]="HIGH_STREAM_LAYER4",n[n.HIGH_STREAM_LAYER5=8]="HIGH_STREAM_LAYER5",n[n.HIGH_STREAM_LAYER6=9]="HIGH_STREAM_LAYER6",n}({}),fY=function(n){return n[n.DISABLE=0]="DISABLE",n[n.LOW_STREAM=1]="LOW_STREAM",n[n.AUDIO_ONLY=2]="AUDIO_ONLY",n[n.HIGH_STREAM_LAYER1=3]="HIGH_STREAM_LAYER1",n[n.HIGH_STREAM_LAYER2=4]="HIGH_STREAM_LAYER2",n[n.HIGH_STREAM_LAYER3=5]="HIGH_STREAM_LAYER3",n[n.HIGH_STREAM_LAYER4=6]="HIGH_STREAM_LAYER4",n[n.HIGH_STREAM_LAYER5=7]="HIGH_STREAM_LAYER5",n[n.HIGH_STREAM_LAYER6=8]="HIGH_STREAM_LAYER6",n}({}),Bo=function(n){return n.TRANSCEIVER_UPDATED="transceiver-updated",n.SEI_TO_SEND="sei-to-send",n.SEI_RECEIVED="sei-received",n.TRACK_UPDATED="track-updated",n}({}),x_=function(n){return n.SOURCE_STATE_CHANGE="source-state-change",n.TRACK_ENDED="track-ended",n.BEAUTY_EFFECT_OVERLOAD="beauty-effect-overload",n.VIDEO_ELEMENT_VISIBLE_STATUS="video-element-visible-status",n.CLOSED="closed",n}({}),Mg=function(n){return n.FIRST_FRAME_DECODED="first-frame-decoded",n.VIDEO_ELEMENT_VISIBLE_STATUS="video-element-visible-status",n.VIDEO_STATE_CHANGED="video-state-changed",n}({}),Jb=function(n){return n.AUDIO="audio",n.VIDEO="video",n.DATA="data",n}({}),lc=function(n){return n.AUDIO_SOURCE_STATE_CHANGE="audio_source_state_change",n.RECEIVE_TRACK_BUFFER="receive_track_buffer",n.ON_AUDIO_BUFFER="on_audio_buffer",n.UPDATE_SOURCE="update_source",n}({});(function(n){n.UPDATE_TRACK_SOURCE="update-track-source"})({});let U_={sendVolumeLevel:0,sendBitrate:0,sendBytes:0,sendPackets:0,sendPacketsLost:0,sendJitterMs:0,sendRttMs:0,currentPacketLossRate:0},OL={sendBytes:0,sendBitrate:0,sendPackets:0,sendPacketsLost:0,sendJitterMs:0,sendRttMs:0,sendResolutionHeight:0,sendResolutionWidth:0,captureResolutionHeight:0,captureResolutionWidth:0,targetSendBitrate:0,totalDuration:0,totalFreezeTime:0,currentPacketLossRate:0},Dt={transportDelay:0,end2EndDelay:0,receiveBitrate:0,receiveLevel:0,receiveBytes:0,receiveDelay:0,receivePackets:0,receivePacketsLost:0,receivePacketsDiscarded:0,totalDuration:0,totalFreezeTime:0,freezeRate:0,packetLossRate:0,currentPacketLossRate:0,publishDuration:-1},xr={uplinkNetworkQuality:0,downlinkNetworkQuality:0},wS={transportDelay:0,end2EndDelay:0,receiveBitrate:0,receiveBytes:0,receiveDelay:0,receivePackets:0,receivePacketsLost:0,receiveResolutionHeight:0,receiveResolutionWidth:0,totalDuration:0,totalFreezeTime:0,freezeRate:0,packetLossRate:0,currentPacketLossRate:0,publishDuration:-1},Fo=function(n){return n.ON_TRACK="on_track",n.ON_NODE="on_node",n}({}),nd=function(n){return n.REQUEST_UPDATE_CONSTRAINTS="request_update_constraints",n.REQUEST_CONSTRAINTS="request_constraints",n}({}),Eh=function(n){return n.IDLE="IDLE",n.INITING="INITING",n.INITEND="INITEND",n}({}),Zu=function(n){return n.STATE_CHANGE="state_change",n.RECORDING_DEVICE_CHANGED="recordingDeviceChanged",n.PLAYOUT_DEVICE_CHANGED="playoutDeviceChanged",n.CAMERA_DEVICE_CHANGED="cameraDeviceChanged",n}({}),is=function(n){return n.NONE="none",n.INIT="init",n.CANPLAY="canplay",n.PLAYING="playing",n.PAUSED="paused",n.SUSPEND="suspend",n.STALLED="stalled",n.WAITING="waiting",n.ERROR="error",n.DESTROYED="destroyed",n.ABORT="abort",n.ENDED="ended",n.EMPTIED="emptied",n.LOADEDDATA="loadeddata",n}({}),yl=function(n){return n[n.VideoStateStopped=0]="VideoStateStopped",n[n.VideoStateStarting=1]="VideoStateStarting",n[n.VideoStateDecoding=2]="VideoStateDecoding",n[n.VideoStateFrozen=3]="VideoStateFrozen",n}({}),Vc={uninit:100,none:110,init:120,loadeddata:130,canplay:200,playing:210,paused:220,suspend:300,stalled:310,waiting:320,error:330,destroyed:340,abort:350,ended:360,emptied:370},Xb=function(n){return n.OPEN="open",n.MESSAGE="message",n.CLOSE="close",n.CLOSING="closing",n.ERROR="error",n}({});function NL(n,i){var a=Object.keys(n);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(n);i&&(c=c.filter(function(u){return Object.getOwnPropertyDescriptor(n,u).enumerable})),a.push.apply(a,c)}return a}function ui(n){for(var i=1;i<arguments.length;i++){var a=arguments[i]!=null?arguments[i]:{};i%2?NL(Object(a),!0).forEach(function(c){Me(n,c,a[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(a)):NL(Object(a)).forEach(function(c){Object.defineProperty(n,c,Object.getOwnPropertyDescriptor(a,c))})}return n}function Me(n,i,a){return(i=function(c){var u=function(_,S){if(typeof _!="object"||_===null)return _;var C=_[Symbol.toPrimitive];if(C!==void 0){var R=C.call(_,"string");if(typeof R!="object")return R;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(_)}(c);return typeof u=="symbol"?u:String(u)}(i))in n?Object.defineProperty(n,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):n[i]=a,n}function Xn(n,i,a,c,u){var _,S,C={};return Object.keys(c).forEach(function(R){C[R]=c[R]}),C.enumerable=!!C.enumerable,C.configurable=!!C.configurable,("value"in C||C.initializer)&&(C.writable=!0),C=Ds(_=HE(S=a.slice()).call(S)).call(_,function(R,e){return e(n,i,R)||R},C),u&&C.initializer!==void 0&&(C.value=C.initializer?C.initializer.call(u):void 0,C.initializer=void 0),C.initializer===void 0&&(Object.defineProperty(n,i,C),C=null),C}class So extends li{set _mediaStreamTrack(i){i!==this.mediaStreamTrack&&(this.safeEmit(Bo.TRACK_UPDATED,i),this.mediaStreamTrack=i)}get _mediaStreamTrack(){return this.mediaStreamTrack}constructor(i,a){super(),Me(this,"trackMediaType",void 0),Me(this,"_ID",void 0),Me(this,"_rtpTransceiver",void 0),Me(this,"_lowRtpTransceiver",void 0),Me(this,"_hints",[]),Me(this,"_isClosed",!1),Me(this,"_originMediaStreamTrack",void 0),Me(this,"mediaStreamTrack",void 0),Me(this,"_external",{}),this._ID=a||gr(8,"track-"),this._originMediaStreamTrack=i,this.mediaStreamTrack=i,function(c){ft(_h).call(_h,c)||_h.push(c)}(this)}toString(){return this._ID}getTrackId(){return this._ID}getMediaStreamTrack(i){return i||la(()=>{var a;jt.reportApiInvoke(null,{name:bn.GET_MEDIA_STREAM_TRACK,options:[],tag:Li.TRACER}).onSuccess(((a=this._mediaStreamTrack)===null||a===void 0?void 0:a.label)||"")},this.mediaStreamTrack.id||this.getTrackId()),this._mediaStreamTrack}getRTCRtpTransceiver(i){return i===qb.LOW_STREAM?this._lowRtpTransceiver:this._rtpTransceiver}getMediaStreamTrackSettings(){return this.getMediaStreamTrack(!0).getSettings()}close(){this._isClosed=!0,this._lowRtpTransceiver=void 0,this._rtpTransceiver=void 0,function(i){let a=_h.indexOf(i);a!==-1&&_h.splice(a,1)}(this),this.emit(x_.CLOSED),this.removeAllListeners(Bo.SEI_RECEIVED)}_updateRtpTransceiver(i,a){if(a===qb.LOW_STREAM){if(this._lowRtpTransceiver===i)return;this._lowRtpTransceiver=i}else{if(this._rtpTransceiver===i)return;this._rtpTransceiver=i}this.emit(Bo.TRANSCEIVER_UPDATED,i,a)}}class yo extends So{get isExternalTrack(){return this._isExternalTrack}get muted(){return this._muted}get enabled(){return this._enabled}get processorContext(){return this._processorContext}constructor(i,a){super(i,a),Me(this,"_enabled",!0),Me(this,"_muted",!1),Me(this,"_isExternalTrack",!1),Me(this,"_isClosed",!1),Me(this,"_enabledMutex",void 0),Me(this,"processor",void 0),Me(this,"_processorContext",void 0),Me(this,"_handleTrackEnded",()=>{this.onTrackEnded()}),this._enabledMutex=new Na("".concat(this.getTrackId())),i.addEventListener("ended",this._handleTrackEnded)}getTrackLabel(){var i,a;return(i=(a=this._originMediaStreamTrack)===null||a===void 0?void 0:a.label)!==null&&i!==void 0?i:""}close(){this._isClosed||(this.stop(),this._originMediaStreamTrack.stop(),this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack.stop(),this._mediaStreamTrack=null),this._originMediaStreamTrack=null,this._enabledMutex=null,z.debug("[".concat(this.getTrackId(),"] close")),this.emit(bt.NEED_CLOSE),super.close())}async _updateOriginMediaStreamTrack(i,a){let c=arguments.length>2&&arguments[2]!==void 0&&arguments[2];this._isExternalTrack=c,i!==this._originMediaStreamTrack&&(this._originMediaStreamTrack&&(this._originMediaStreamTrack.removeEventListener("ended",this._handleTrackEnded),a&&this._originMediaStreamTrack.stop()),i.addEventListener("ended",this._handleTrackEnded),this._originMediaStreamTrack=i,this._muted&&(this._originMediaStreamTrack.enabled=!1),this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await Vr(this,bt.NEED_REPLACE_TRACK,this),this.processor&&this._processorContext&&this.processor.updateInput({track:this._originMediaStreamTrack,context:this._processorContext}))}_getDefaultPlayerConfig(){return{}}onTrackEnded(){z.debug("[".concat(this.getTrackId(),"] track ended")),this.safeEmit(x_.TRACK_ENDED)}stateCheck(i,a){if(z.debug("check track state, [muted: ".concat(this._muted,", enabled: ").concat(this._enabled,"] to [").concat(i,": ").concat(a,"]")),Vp(a,i),this._enabled&&this._muted&&i==="enabled"&&a===!1)throw new Ye(oe.TRACK_STATE_UNREACHABLE,"cannot set enabled while the track is muted").print("error",z);if(!this._enabled&&!this._muted&&i==="muted"&&a===!0)throw new Ye(oe.TRACK_STATE_UNREACHABLE,"cannot set muted while the track is disabled").print("error",z)}getProcessorStats(){return this._processorContext&&this._processorContext.gatherStats()||[]}getProcessorUsage(){return this._processorContext?this._processorContext.gatherUsage():Et.resolve([])}}let Qb=window.AudioContext||window.webkitAudioContext,no=null,Tn=new class extends li{constructor(){super(...arguments),Me(this,"prevState",void 0),Me(this,"curState",void 0),Me(this,"currentTime",void 0),Me(this,"currentTimeStuckAt",void 0),Me(this,"interruptDetectorTrack",void 0),Me(this,"onLocalAudioTrackMute",()=>{z.info("ios15-interruption-start"),this.emit(ms.IOS_15_16_INTERRUPTION_START)}),Me(this,"onLocalAudioTrackUnmute",async()=>{z.info("ios15-interruption-end"),this.curState!=="running"||this.duringInterruption?z.info("ios15-interruption-end-canceled"):(no&&await no.suspend(),this.emit(ms.IOS_15_16_INTERRUPTION_END))})}get duringInterruption(){return this.prevState==="running"&&this.curState==="interrupted"}bindInterruptDetectorTrack(n){z.debug("webaudio bindInterruptDetectorTrack ".concat(n.getTrackId())),this.interruptDetectorTrack||(this.interruptDetectorTrack=n,this.interruptDetectorTrack._mediaStreamTrack.onmute=this.onLocalAudioTrackMute,this.interruptDetectorTrack._mediaStreamTrack.onunmute=this.onLocalAudioTrackUnmute)}unbindInterruptDetectorTrack(n){z.debug("webaudio unbindInterruptDetectorTrack ".concat(n.getTrackId())),this.interruptDetectorTrack&&this.interruptDetectorTrack===n&&(this.interruptDetectorTrack._mediaStreamTrack&&(this.interruptDetectorTrack._mediaStreamTrack.onmute=null,this.interruptDetectorTrack._mediaStreamTrack.onunmute=null),this.interruptDetectorTrack=void 0)}};function Tl(){if(!no){if(function(){if(!Qb)return void z.error("your browser is not support web audio");z.info("create audio context");let n=ui({},ge("WEBAUDIO_INIT_OPTIONS"));z.debug("audio context init option:",JSON.stringify(n)),no=new Qb(n),Tn.curState=no.state,no.onstatechange=()=>{Tn.prevState=Tn.curState,Tn.curState=no?no.state:void 0;let{prevState:i,curState:a}=Tn,c=a==="running",u=a==="interrupted",_=i==="running",S=i==="suspended",C=i==="interrupted",R=En().osVersion;(Ea()||Jd())&&_&&u&&(z.info("ios".concat(R,"-interruption-start")),Tn.emit(ms.IOS_INTERRUPTION_START)),(Ea()||Jd())&&(S||C)&&c&&(z.info("ios".concat(R,"-interruption-end")),Tn.emit(ms.IOS_INTERRUPTION_END)),i!==a&&Tn.emit(ms.STATE_CHANGE,a,i)},setInterval(()=>{var i;let a=(i=no)===null||i===void 0?void 0:i.currentTime;Tn.currentTime!==a?(Tn.currentTimeStuckAt&&(z.debug("AudioContext current time resume at ".concat(a)),Tn.currentTimeStuckAt=void 0),Tn.currentTime=a):(a!==Tn.currentTimeStuckAt&&(jt.reportApiInvoke(null,{name:"WEB_AUDIO_CURRENT_TIME_STUCK",options:{currentTime:a},tag:Li.TRACER}).onSuccess(),z.warning("AudioContext current time stuck at ".concat(a))),Tn.currentTimeStuckAt=a)},5e3),async function(i){let a=["click","contextmenu","auxclick","dblclick","mousedown","mouseup","touchend","keydown","keyup"],c,u=!1,_=!1,S=!1;function C(m){i.state==="running"?R(!1):Ea()||Jd()?i.state==="suspended"&&(R(!0),m&&i.resume().then(e,e)):i.state!=="closed"&&(R(!0),m&&i.resume().then(e,e))}function R(m){if(u!==m){u=m;for(let E=0,y=a;E<y.length;E+=1){let b=y[E];m?window.addEventListener(b,t,{capture:!0,passive:!0}):window.removeEventListener(b,t,{capture:!0,passive:!0})}}}function e(){C(!1)}function t(){C(!0)}function r(m){if(!S)if(c.paused)if(m){let E;s(!1),S=!0;try{E=c.play(),E?E.then(l,l):(c.addEventListener("playing",l),c.addEventListener("abort",l),c.addEventListener("error",l))}catch{l()}}else s(!0);else s(!1)}function s(m){if(_!==m){_=m;for(let E=0,y=a;E<y.length;E++){let b=y[E];m?window.addEventListener(b,f,{capture:!0,passive:!0}):window.removeEventListener(b,f,{capture:!0,passive:!0})}}}function l(){c.removeEventListener("playing",l),c.removeEventListener("abort",l),c.removeEventListener("error",l),S=!1,r(!1)}function f(){r(!0)}if(Ea()){let m=i.createMediaStreamDestination(),E=document.createElement("div");E.innerHTML="<audio x-webkit-airplay='deny'></audio>",c=E.children.item(0),c.controls=!1,c.disableRemotePlayback=!0,c.preload="auto",c.srcObject=m.stream,r(!0)}Tn.on(ms.STATE_CHANGE,function(){C(!0)}),C(!1)}(no)}(),!no)throw new Ye(oe.NOT_SUPPORTED,"can not create audio context");return no}return no}function kg(n){if(function(){if(Zb!==null)return Zb;let c=Tl(),u=c.createBufferSource(),_=c.createGain(),S=c.createGain();u.connect(_),u.connect(S),u.disconnect(_);let C=!1;try{u.disconnect(_)}catch{C=!0}return u.disconnect(),Zb=C,C}())return;let i=n.connect,a=n.disconnect;n.connect=(c,u,_)=>{var S;return n._inputNodes||(n._inputNodes=[]),ft(S=n._inputNodes).call(S,c)||(c instanceof AudioNode?(n._inputNodes.push(c),i.call(n,c,u,_)):i.call(n,c,u)),n},n.disconnect=(c,u,_)=>{a.call(n),c?iI(n._inputNodes,c):n._inputNodes=[];for(let S of n._inputNodes)i.call(n,S)}}let Zb=null;function jn(n,i){let a=!1,c=1/i;if(ge("DISABLE_WEBAUDIO")){let u=window.setInterval(()=>{a?window.clearInterval(u):n(performance.now()/1e3)},1e3*c)}else{let u=Tl(),_=u.createGain();_.gain.value=0,_.connect(u.destination);let S=()=>{if(a)return void(_=null);let C=u.createOscillator();C.onended=S,C.connect(_),C.start(0),C.stop(u.currentTime+c),n(u.currentTime)};S()}return()=>{a=!0}}class Pe{constructor(){Me(this,"context",void 0),Me(this,"analyserNode",void 0),Me(this,"sourceNode",void 0),this.context=Tl(),this.analyserNode=this.context.createAnalyser(),this.analyserNode.fftSize=2048,this.analyserNode.smoothingTimeConstant=.4}updateSource(i){if(i!==this.sourceNode){if(this.sourceNode)try{this.sourceNode.disconnect(this.analyserNode)}catch{}this.sourceNode=i,i==null||i.connect(this.analyserNode)}}getVolumeLevel(){if(!this.sourceNode||(!this.context||Ea()||Jd()||this.context.state!=="running"&&this.context.resume(),!this.analyserNode))return 0;let i=new Float32Array(this.analyserNode.fftSize);if(this.analyserNode.getFloatTimeDomainData)this.analyserNode.getFloatTimeDomainData(i);else{let c=new Uint8Array(this.analyserNode.fftSize);this.analyserNode.getByteTimeDomainData(c);for(let u=0;u<i.length;++u)i[u]=c[u]/128-1}let a=Ds(i).call(i,(c,u)=>c+u*u,0)/i.length;return Math.max(10*Math.log10(a)+100,0)/100}getAnalyserNode(){return this.analyserNode}rebuildAnalyser(){try{var i,a;(i=this.sourceNode)===null||i===void 0||i.disconnect(this.analyserNode),this.analyserNode=this.context.createAnalyser(),this.analyserNode.fftSize=2048,this.analyserNode.smoothingTimeConstant=.4,(a=this.sourceNode)===null||a===void 0||a.connect(this.analyserNode)}catch{z.warning("rebuild analyser node failed.")}}destroy(){this.updateSource(void 0)}}class kx extends li{get processSourceNode(){return this.sourceNode}set processedNode(i){var a;if(!this.isDestroyed&&this._processedNode!==i){try{var c;(c=this.sourceNode)===null||c===void 0||c.disconnect(this.outputNode)}catch{}(a=this._processedNode)===null||a===void 0||a.disconnect(),this._processedNode=i,this.connect()}}get processedNode(){return this._processedNode}constructor(){super(),Me(this,"outputNode",void 0),Me(this,"outputTrack",void 0),Me(this,"isPlayed",!1),Me(this,"sourceNode",void 0),Me(this,"context",void 0),Me(this,"audioBufferNode",void 0),Me(this,"destNode",void 0),Me(this,"audioOutputLevel",0),Me(this,"volumeLevelAnalyser",void 0),Me(this,"_processedNode",void 0),Me(this,"playNode",void 0),Me(this,"isDestroyed",!1),Me(this,"onNoAudioInput",void 0),Me(this,"isNoAudioInput",!1),Me(this,"_noAudioInputCount",0),this.context=Tl(),this.playNode=this.context.destination,this.outputNode=this.context.createGain(),kg(this.outputNode),this.volumeLevelAnalyser=new Pe}startGetAudioBuffer(i){this.audioBufferNode||(this.audioBufferNode=this.context.createScriptProcessor(i),this.outputNode.connect(this.audioBufferNode),this.audioBufferNode.connect(this.context.destination),this.audioBufferNode.onaudioprocess=a=>{this.emit(lc.ON_AUDIO_BUFFER,function(c){for(let u=0;u<c.outputBuffer.numberOfChannels;u+=1){let _=c.outputBuffer.getChannelData(u);for(let S=0;S<_.length;S+=1)_[S]=0}return c.inputBuffer}(a))})}stopGetAudioBuffer(){this.audioBufferNode&&(this.audioBufferNode.onaudioprocess=null,this.outputNode.disconnect(this.audioBufferNode),this.audioBufferNode=void 0)}createOutputTrack(){if(!Un().webAudioMediaStreamDest)throw new Ye(oe.NOT_SUPPORTED,"your browser is not support audio processor");return this.destNode&&this.outputTrack||(this.destNode=this.context.createMediaStreamDestination(),this.outputNode.connect(this.destNode),this.outputTrack=this.destNode.stream.getAudioTracks()[0]),this.outputTrack}play(i){this.context.state!=="running"&&In(()=>{Tn.emit("autoplay-failed")}),this.isPlayed=!0,this.playNode=i||this.context.destination,this.outputNode.connect(this.playNode)}stop(){if(this.isPlayed)try{this.outputNode.disconnect(this.playNode)}catch{}this.isPlayed=!1}getAccurateVolumeLevel(){return this.volumeLevelAnalyser.getVolumeLevel()}async checkHasAudioInput(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;if(i>5)return this.isNoAudioInput=!0,this.onNoAudioInput&&this.onNoAudioInput(),!1;Ea()||Jd()?this.context.state==="suspended"&&this.context.resume():this.context.state!=="running"&&this.context.resume();let a=this.volumeLevelAnalyser.getAnalyserNode(),c;a.getFloatTimeDomainData?(c=new Float32Array(a.fftSize),a.getFloatTimeDomainData(c)):(c=new Uint8Array(a.fftSize),a.getByteTimeDomainData(c));let u=!1;for(let _=0;_<c.length;_++)c[_]!==0&&(u=!0);return u?(this.isNoAudioInput=!1,!0):(await Mn(200),await this.checkHasAudioInput(i?i+1:1)&&u)}getAudioVolume(){return this.outputNode.gain.value}setVolume(i){this.outputNode.gain.setValueAtTime(i,this.context.currentTime)}destroy(){this.disconnect(),this.stop(),this.isDestroyed=!0,this.onNoAudioInput=void 0}disconnect(){var i,a;(i=this.processedNode)===null||i===void 0||i.disconnect(),(a=this.sourceNode)===null||a===void 0||a.disconnect(),this.outputNode&&this.outputNode.disconnect()}connect(){var i;this.processedNode?(i=this.processedNode)===null||i===void 0||i.connect(this.outputNode):this.sourceNode&&this.sourceNode.connect(this.outputNode),this.volumeLevelAnalyser.updateSource(this.outputNode)}}class fi extends kx{get isFreeze(){return!1}constructor(i,a,c){var u;if(super(),Me(this,"sourceNode",void 0),Me(this,"track",void 0),Me(this,"clonedTrack",void 0),Me(this,"audioElement",void 0),Me(this,"isCurrentTrackCloned",!1),Me(this,"isRemoteTrack",!1),Me(this,"originVolumeLevelAnalyser",void 0),Me(this,"rebuildWebAudio",async()=>{if(z.debug("ready to rebuild web audio, state:",this.context.state),this.isNoAudioInput&&await this.checkHasAudioInput(),!this.isNoAudioInput||this.isDestroyed)return document.body.removeEventListener("click",this.rebuildWebAudio,!0),void z.debug("rebuild web audio success, current volume status",this.getAccurateVolumeLevel());this.context.resume().then(()=>z.info("resume success")),z.debug("rebuild web audio because of ios 12 bugs"),this.disconnect();let C=this.track;this.track=this.track.clone(),this.isCurrentTrackCloned?C.stop():this.isCurrentTrackCloned=!0;let R=new MediaStream([this.track]);this.sourceNode=this.context.createMediaStreamSource(R),kg(this.sourceNode),this.volumeLevelAnalyser.rebuildAnalyser();let e=this.outputNode.gain.value;this.outputNode=this.context.createGain(),this.outputNode.gain.setValueAtTime(e,this.context.currentTime),kg(this.outputNode),this.emit(lc.UPDATE_SOURCE),this.connect(),this.audioElement.srcObject=R,this.isPlayed&&this.play(this.playNode),this.checkHasAudioInput()}),i.kind!=="audio")throw new Ye(oe.UNEXPECTED_ERROR);this.track=i;let _=new MediaStream([this.track]);if(this.isRemoteTrack=!!a,this.sourceNode=this.context.createMediaStreamSource(_),kg(this.sourceNode),c){let C=c.clone();C.enabled=!0,this.clonedTrack=C,z.debug("create an unmuted track ".concat(C.id," from the original track ").concat(c.id," to get the volume"));let R=this.context.createMediaStreamSource(new MediaStream([C]));kg(R),this.originVolumeLevelAnalyser=new Pe,this.originVolumeLevelAnalyser.updateSource(R)}this.connect(),this.audioElement=document.createElement("audio"),this.audioElement.srcObject=_;let S=En();a&&S.os===Ra.IOS&&Number((u=S.osVersion)===null||u===void 0?void 0:u.split(".")[0])<15&&(Tn.on(ms.STATE_CHANGE,()=>{this.context.state==="suspended"?document.body.addEventListener("click",this.rebuildWebAudio,!0):this.context.state==="running"&&this.rebuildWebAudio()}),this.checkHasAudioInput().then(C=>{C||document.body.addEventListener("click",this.rebuildWebAudio,!0)}))}updateTrack(i){this.sourceNode.disconnect(),this.track=i,this.isCurrentTrackCloned=!1;let a=new MediaStream([i]);this.sourceNode=this.context.createMediaStreamSource(a),kg(this.sourceNode),this.processedNode||this.sourceNode.connect(this.outputNode),this.emit(lc.UPDATE_SOURCE),this.audioElement.srcObject=a}destroy(){var i;this.audioElement.srcObject=null,this.audioElement.remove(),Tn.off("state-change",this.rebuildWebAudio),(i=this.originVolumeLevelAnalyser)===null||i===void 0||i.destroy(),this.clonedTrack=void 0,super.destroy()}createMediaStreamSourceNode(i){return this.context.createMediaStreamSource(new MediaStream([i]))}updateOriginTrack(i){let a=i.clone();a.enabled=!0,this.clonedTrack&&(this.clonedTrack.stop(),this.clonedTrack=a),z.debug("create an unmuted track ".concat(a.id," from the original track ").concat(i.id," to get the volume"));let c=this.context.createMediaStreamSource(new MediaStream([a]));kg(c),this.originVolumeLevelAnalyser&&this.originVolumeLevelAnalyser.updateSource(c)}getOriginVolumeLevel(){return this.originVolumeLevelAnalyser?this.originVolumeLevelAnalyser.getVolumeLevel():this.getAccurateVolumeLevel()}}async function xx(n,i,a){let c=(_,S)=>_?typeof _!="number"?_.max||_.exact||_.ideal||_.min||S:_:S,u={audio:!!a&&{mandatory:{chromeMediaSource:"desktop"}},video:{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:n,maxHeight:c(i.height,1080),maxWidth:c(i.width,1920)}}};return i.frameRate&&typeof i.frameRate!="number"?(u.video.mandatory.maxFrameRate=i.frameRate.max,u.video.mandatory.minFrameRate=i.frameRate.min):typeof i.frameRate=="number"&&(u.video.mandatory.maxFrameRate=i.frameRate),await navigator.mediaDevices.getUserMedia(u)}async function $b(n,i){let a=await Ux(n.mediaSource),{sourceId:c,audio:u}=await function(_){let S=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return new Et((C,R)=>{let e=document.createElement("div");e.innerText="share screen",e.setAttribute("style","text-align: center; height: 25px; line-height: 25px; border-radius: 4px 4px 0 0; background: #D4D2D4; border-bottom:  solid 1px #B9B8B9;");let t=document.createElement("div");t.setAttribute("style","width: 100%; height: 500px; padding: 15px 25px ; box-sizing: border-box;");let r=document.createElement("div");r.innerText="Agora Web Screensharing wants to share the contents of your screen with webdemo.agorabeckon.com. Choose what you'd like to share.",r.setAttribute("style","height: 12%;");let s=document.createElement("div");s.setAttribute("style","width: 100%; height: 80%; background: #FFF; border:  solid 1px #CBCBCB; display: flex; flex-wrap: wrap; justify-content: space-around; overflow-y: scroll; padding: 0 15px; box-sizing: border-box;");let l=document.createElement("div");l.setAttribute("style","display: flex; justify-content: space-between; padding: 16px 0;");let f=document.createElement("button");f.innerHTML="cancel",f.setAttribute("style","width: 85px;"),f.onclick=()=>{document.body.removeChild(y);let b=new Error("NotAllowedError");b.name="NotAllowedError",R(b)};let m=S,E=document.createElement("div");if(S){let b=document.createElement("input");b.setAttribute("type","checkbox");let A=document.createElement("span");b.setAttribute("style","margin-right: 6px;"),A.innerText="Share audio",b.checked=m,b.onchange=()=>{m=b.checked},E.appendChild(b),E.appendChild(A)}l.appendChild(E),l.appendChild(f),t.appendChild(r),t.appendChild(s),t.appendChild(l);let y=document.createElement("div");y.setAttribute("style","position: fixed; z-index: 99999999; top: 50%; left: 50%; width: 620px; height: 525px; background: #ECECEC; border-radius: 4px; -webkit-transform: translate(-50%,-50%); transform: translate(-50%,-50%);"),y.appendChild(e),y.appendChild(t),document.body.appendChild(y),_.map(b=>{if(b.id){let A=document.createElement("div");A.setAttribute("style","width: 30%; height: 160px; padding: 20px 0; text-align: center;box-sizing: content-box;");let O=b.thumbnail;try{let{width:D}=O.getSize();D>1920&&(O=O.resize({width:1920}))}catch(D){throw D&&D.message.startsWith("Illegal invocation")&&console.error("Operate thumbnail error, please try to set contextIsolation: false. (https://github.com/electron/electron/issues/34953)"),D}A.innerHTML='<div style="height: 120px; display: table-cell; vertical-align: middle;"><img style="width: 100%; background: #333333; box-shadow: 1px 1px 1px 1px rgba(0, 0, 0, 0.2);" src='+O.toDataURL()+' /></div><span style="	height: 40px; line-height: 40px; display: inline-block; width: 70%; word-break: keep-all; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">'+b.name.replace(/[\u00A0-\u9999<>\&]/g,function(D){return"&#"+D.charCodeAt(0)+";"})+"</span>",A.onclick=()=>{document.body.removeChild(y),C({sourceId:b.id,audio:m})},s.appendChild(A)}})})}(a,i);return await xx(c,n,u)}async function Ux(n){let i=["window","screen"];n!=="application"&&n!=="window"||(i=["window"]),n==="screen"&&(i=["screen"]);let a=Bp();if(!a)throw console.error("failed to fetch electron, please mount it to window"),new Ye(oe.ELECTRON_IS_NULL);let c=null;try{var u;c=((u=a.desktopCapturer)===null||u===void 0?void 0:u.getSources({types:i}))||a.ipcRenderer.invoke("DESKTOP_CAPTURER_GET_SOURCES",{types:i})}catch{c=null}c&&c.then||(c=new Et((_,S)=>{a.desktopCapturer.getSources({types:i},(C,R)=>{C?S(C):_(R)})}));try{return await c}catch(_){throw new Ye(oe.ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR,_.toString())}}let Bc=new Na("safari"),Rr=!1,RS=!1;async function ro(n,i){let a=0,c=null;for(;a<2;)try{c=await jx(n,i,a>0);break}catch(u){if(u instanceof Ye)throw z.error("[".concat(i,"] ").concat(u.toString())),u;let _=e1(u.name||u.code||u,u.message);if(_.code===oe.MEDIA_OPTION_INVALID){z.debug("[".concat(i,"] detect media option invalid, retry")),a+=1,await Mn(500);continue}throw z.error("[".concat(i,"] ").concat(_.toString())),_}if(!c)throw new Ye(oe.UNEXPECTED_ERROR,"can not find stream after getUserMedia");return c}async function jx(n,i,a){if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new Ye(oe.NOT_SUPPORTED,"can not find getUserMedia");a&&(n.video&&(delete n.video.width,delete n.video.height),n.screen&&(delete n.screen.width,delete n.screen.height));let c=Un(),u=new MediaStream;if(n.audioSource&&u.addTrack(n.audioSource),n.videoSource&&u.addTrack(n.videoSource),!n.audio&&!n.video&&!n.screen)return z.debug("Using Video Source/ Audio Source"),u;if(n.screen)if(Bp())n.screen.sourceId?IS(u,await xx(n.screen.sourceId,n.screen,!!n.screenAudio)):IS(u,await $b(n.screen,!!n.screenAudio));else if(Vo()&&n.screen.extensionId&&n.screen.mandatory){if(!c.getStreamFromExtension)throw new Ye(oe.NOT_SUPPORTED,"This browser does not support screen sharing");z.debug("[".concat(i,'] Screen access on chrome stable, looking for extension"'));let s=await(S=n.screen.extensionId,C=i,new Et((l,f)=>{try{chrome.runtime.sendMessage(S,{getStream:!0},m=>{if(!m||!m.streamId)return z.error("[".concat(C,"] No response from Chrome Plugin. Plugin not installed properly"),m),void f(new Ye(oe.CHROME_PLUGIN_NO_RESPONSE,"No response from Chrome Plugin. Plugin not installed properly"));l(m.streamId)})}catch(m){z.error("[".concat(C,"] AgoraRTC screensharing plugin is not accessible(").concat(S,")"),m.toString()),f(new Ye(oe.CHROME_PLUGIN_NOT_INSTALL))}}));n.screen.mandatory.chromeMediaSourceId=s,IS(u,await navigator.mediaDevices.getUserMedia({video:{mandatory:n.screen.mandatory}}))}else if(c.getDisplayMedia){var _;n.screen.mediaSource&&Jn(n.screen.mediaSource);let s={width:n.screen.width,height:n.screen.height,frameRate:n.screen.frameRate,displaySurface:(_=n.screen.displaySurface)!==null&&_!==void 0?_:n.screen.mediaSource==="screen"?"monitor":n.screen.mediaSource},{selfBrowserSurface:l,surfaceSwitching:f,systemAudio:m,preferCurrentTab:E}=n.screen,y={selfBrowserSurface:l,surfaceSwitching:f,systemAudio:m,preferCurrentTab:E};!l&&delete y.selfBrowserSurface,!f&&delete y.surfaceSwitching,!m&&delete y.systemAudio,!E&&delete y.preferCurrentTab,z.debug("[".concat(i,"] getDisplayMedia:"),JSON.stringify({video:s,audio:n.screenAudio,controls:y})),IS(u,await navigator.mediaDevices.getDisplayMedia(ui({video:s,audio:n.screenAudio},y)))}else{if(!Ni())throw z.error("[".concat(i,"] This browser does not support screenSharing")),new Ye(oe.NOT_SUPPORTED,"This browser does not support screen sharing");{n.screen.mediaSource&&Jn(n.screen.mediaSource);let s={video:{mediaSource:n.screen.mediaSource,width:n.screen.width,height:n.screen.height,frameRate:n.screen.frameRate}};z.debug("[".concat(i,"] getUserMedia: ").concat(JSON.stringify(s))),IS(u,await navigator.mediaDevices.getUserMedia(s))}}var S,C;if(!n.video&&!n.audio)return u;let R={video:n.video,audio:n.audio},e=ge("MEDIA_DEVICE_CONSTRAINTS");if(e)try{typeof e=="string"&&(e=JSON.parse(e)),R=_L(R,e)}catch{}z.debug("[".concat(i,"] GetUserMedia"),JSON.stringify(R)),En();let t,r=null;(mr()||Ea()||gS())&&(r=await Bc.lock());try{t=await navigator.mediaDevices.getUserMedia(R)}catch(s){throw r&&r(),s}return R.audio&&(Rr=!0),R.video&&(RS=!0),IS(u,t),r&&r(),u}function e1(n,i){switch(n){case"Starting video failed":case"OverconstrainedError":case"TrackStartError":return new Ye(oe.MEDIA_OPTION_INVALID,"".concat(n,": ").concat(i));case"NotFoundError":case"DevicesNotFoundError":return new Ye(oe.DEVICE_NOT_FOUND,"".concat(n,": ").concat(i));case"NotSupportedError":return new Ye(oe.NOT_SUPPORTED,"".concat(n,": ").concat(i));case"NotReadableError":return new Ye(oe.NOT_READABLE,"".concat(n,": ").concat(i));case"InvalidStateError":case"NotAllowedError":case"PERMISSION_DENIED":case"PermissionDeniedError":return new Ye(oe.PERMISSION_DENIED,"".concat(n,": ").concat(i));case"ConstraintNotSatisfiedError":return new Ye(oe.CONSTRAINT_NOT_SATISFIED,"".concat(n,": ").concat(i));default:return z.error("getUserMedia unexpected error",n),new Ye(oe.UNEXPECTED_ERROR,"".concat(n,": ").concat(i))}}function IS(n,i){let a=n.getVideoTracks()[0],c=n.getAudioTracks()[0],u=i.getVideoTracks()[0],_=i.getAudioTracks()[0];_&&(c&&n.removeTrack(c),n.addTrack(_)),u&&(a&&n.removeTrack(a),n.addTrack(u))}let bl=new class extends li{get state(){return this._state}set state(n){n!==this._state&&(this.emit(Zu.STATE_CHANGE,n),this._state=n)}constructor(){super(),Me(this,"_state",Eh.IDLE),Me(this,"isAccessMicrophonePermission",!1),Me(this,"isAccessCameraPermission",!1),Me(this,"lastAccessMicrophonePermission",!1),Me(this,"lastAccessCameraPermission",!1),Me(this,"checkdeviceMatched",!1),Me(this,"deviceInfoMap",new Map),this.init().then(()=>{navigator.mediaDevices.addEventListener&&navigator.mediaDevices.addEventListener("devicechange",this.updateDevicesInfo.bind(this)),window.setInterval(()=>{(ge("ENUMERATE_DEVICES_INTERVAL")||(nI()||N_()===Ra.HARMONY_OS)&&jp())&&this.updateDevicesInfo()},ge("ENUMERATE_DEVICES_INTERVAL_TIME"))}).catch(n=>z.error(n.toString()))}async enumerateDevices(n,i){let a=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(!navigator.mediaDevices||!navigator.mediaDevices.enumerateDevices)return new Ye(oe.NOT_SUPPORTED,"enumerateDevices() not supported.").throw();let c=await navigator.mediaDevices.enumerateDevices(),u=this.checkMediaDeviceInfoIsOk(c),_=!this.isAccessMicrophonePermission&&n,S=!this.isAccessCameraPermission&&i;u.audio&&(_=!1),u.video&&(S=!1);let C=null,R=null,e=null;if(!a&&(_||S)){if(Bc.isLocked&&(z.debug("[device manager] wait GUM lock"),(await Bc.lock())(),z.debug("[device manager] GUM unlock")),Rr&&(_=!1,this.isAccessMicrophonePermission=!0),RS&&(S=!1,this.isAccessCameraPermission=!0),z.debug("[device manager] check media device permissions",n,i,_,S),_&&S){try{e=await navigator.mediaDevices.getUserMedia({audio:!0,video:!0})}catch(t){let r=e1(t.name||t.code||t,t.message);if(r.code===oe.PERMISSION_DENIED)throw r;z.warning("getUserMedia failed in getDevices",r)}this.isAccessCameraPermission=!0,this.isAccessMicrophonePermission=!0}else if(_){try{C=await navigator.mediaDevices.getUserMedia({audio:n})}catch(t){let r=e1(t.name||t.code||t,t.message);if(r.code===oe.PERMISSION_DENIED)throw r;z.warning("getUserMedia failed in getDevices",r)}this.isAccessMicrophonePermission=!0}else if(S){try{R=await navigator.mediaDevices.getUserMedia({video:i})}catch(t){let r=e1(t.name||t.code||t,t.message);if(r.code===oe.PERMISSION_DENIED)throw r;z.warning("getUserMedia failed in getDevices",r)}this.isAccessCameraPermission=!0}z.debug("[device manager] mic permission",n,"cam permission",i)}try{let t=await navigator.mediaDevices.enumerateDevices();return C&&C.getTracks().forEach(r=>r.stop()),R&&R.getTracks().forEach(r=>r.stop()),e&&e.getTracks().forEach(r=>r.stop()),C=null,R=null,e=null,t}catch(t){return C&&C.getTracks().forEach(r=>r.stop()),R&&R.getTracks().forEach(r=>r.stop()),e&&e.getTracks().forEach(r=>r.stop()),C=null,R=null,e=null,new Ye(oe.ENUMERATE_DEVICES_FAILED,t.toString()).throw()}}async getRecordingDevices(){let n=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return(await this.enumerateDevices(!0,!1,n)).filter(i=>i.kind==="audioinput")}async getCamerasDevices(){let n=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return(await this.enumerateDevices(!1,!0,n)).filter(i=>i.kind==="videoinput")}async getSpeakers(){let n=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return(await this.enumerateDevices(!0,!1,n)).filter(i=>i.kind==="audiooutput")}searchDeviceIdByName(n){let i=null;return this.deviceInfoMap.forEach(a=>{a.device.label===n&&(i=a.device.deviceId)}),i}async getDeviceById(n){let i=(await this.enumerateDevices(!0,!0,!0)).find(a=>a.deviceId===n);if(!i)throw new Ye(oe.DEVICE_NOT_FOUND,"deviceId: ".concat(n));return i}async init(){this.state=Eh.INITING;try{await this.updateDevicesInfo(),this.state=Eh.INITEND}catch(n){throw z.warning("Device Detection functionality cannot start properly.",n.toString()),this.state=Eh.IDLE,(typeof isSecureContext=="boolean"?isSecureContext:location.protocol==="https:"||location.protocol==="file:"||location.hostname==="localhost"||location.hostname==="127.0.0.1"||location.hostname==="::1")||new Ye(oe.WEB_SECURITY_RESTRICT,"Your context is limited by web security, please try using https protocol or localhost.").throw(),n}}async updateDevicesInfo(){let n=await this.enumerateDevices(!0,!0,!0),i=Date.now(),a=[];if(n[0]&&n[0].label&&this.checkdeviceMatched===!1){this.checkdeviceMatched=!0;let u=n.find(S=>S.kind==="audioinput"&&S.deviceId==="default"),_=n.find(S=>S.kind==="audiooutput"&&S.deviceId==="default");u&&_?_.groupId===u.groupId?z.debug("[device-check] default input ".concat(u.label," and output ").concat(_.label," is the same group")):z.debug("[device-check] default input ".concat(u.label," and output ").concat(_.label," is not the same group")):z.debug("[device-check] default input or output not found")}let c=this.checkMediaDeviceInfoIsOk(n);if(n.forEach(u=>{if(!u.deviceId)return;let _=this.deviceInfoMap.get("".concat(u.kind,"_").concat(u.deviceId));if((_?_.state:"INACTIVE")!=="ACTIVE"){let S={initAt:i,updateAt:i,device:u,state:"ACTIVE"};this.deviceInfoMap.set("".concat(u.kind,"_").concat(u.deviceId),S),a.push(S)}_&&(_.updateAt=i)}),this.deviceInfoMap.forEach((u,_)=>{u.state==="ACTIVE"&&u.updateAt!==i&&(u.state="INACTIVE",a.push(u))}),this.state!==Eh.INITEND)return c.audio&&(this.lastAccessMicrophonePermission=!0,this.isAccessMicrophonePermission=!0),void(c.video&&(this.lastAccessCameraPermission=!0,this.isAccessCameraPermission=!0));a.forEach(u=>{switch(u.device.kind){case"audioinput":this.lastAccessMicrophonePermission&&this.isAccessMicrophonePermission&&this.emit(Zu.RECORDING_DEVICE_CHANGED,u);break;case"videoinput":this.lastAccessCameraPermission&&this.isAccessCameraPermission&&this.emit(Zu.CAMERA_DEVICE_CHANGED,u);break;case"audiooutput":this.lastAccessMicrophonePermission&&this.isAccessMicrophonePermission&&this.emit(Zu.PLAYOUT_DEVICE_CHANGED,u)}}),c.audio&&(this.lastAccessMicrophonePermission=!0,this.isAccessMicrophonePermission=!0),c.video&&(this.lastAccessCameraPermission=!0,this.isAccessCameraPermission=!0)}checkMediaDeviceInfoIsOk(n){let i=n.filter(u=>u.kind==="audioinput"),a=n.filter(u=>u.kind==="videoinput"),c={audio:!1,video:!1};for(let u of i)if(u.label&&u.deviceId){c.audio=!0;break}for(let u of a)if(u.label&&u.deviceId){c.video=!0;break}return c}},LL=!1,Cl=new class extends li{constructor(){super(...arguments),Me(this,"onAutoplayFailed",void 0),Me(this,"onAudioAutoplayFailed",void 0)}};function v8(){if(En(),!LL){let n=i=>{i.preventDefault(),LL=!1,ES()?document.body.removeEventListener("click",n,!0):(document.body.removeEventListener("touchstart",n,!0),document.body.removeEventListener("mousedown",n,!0))};LL=!0,ES()?document.body.addEventListener("click",n,!0):(document.body.addEventListener("touchstart",n,!0),document.body.addEventListener("mousedown",n,!0)),z.info("detect media autoplay failed, document: https://docs.agora.io/cn/Voice/autoplay_policy_web_ng?platform=Web"),Cl.onAutoplayFailed?Cl.onAutoplayFailed():Cl.onAudioAutoplayFailed?z.warning(`AgoraRTC.onAudioAutoplayFailed has been deprecated in favor of AgoraRTC.onAutoplayFailed.

  Please refer to the Agora document to migrate the newer API, https://docs.agora.io/en/Voice/autoplay_policy_web_ng?platform=Web .`):z.warning(`We have detected a media autoplay failed event, and found out that you haven't implemented AgoraRTC.onAutoplayFailed callback yet.

  It will cause audio/video element not playing automatically on some browsers without user interaction, possibly hurting user experiences.

  Please refer to the Agora document to properly handle autoplay failed event, https://docs.agora.io/en/Voice/autoplay_policy_web_ng?platform=Web .`),Cl.emit("autoplay-failed")}}function Vx(n,i,a,c){if(!n)return;let u=jt.getBaseInfoBySessionId(n);if(!u)return;let _=u.info,S=Date.now(),C=ui(ui({},_),{},{vid:_.vid===void 0?0:Number(_.vid),lts:S,elapse:S-u.startTime,cbRegistered:Cl.onAutoplayFailed||Cl.onAudioAutoplayFailed?1:-1,errorMsg:a,mediaType:i,trackId:c,extend:void 0});jt.send({type:di.AUTOPLAY_FAILED,data:C},!0)}let Bx=["play","playing","loadeddata","canplay","pause","stalled","suspend","waiting","abort","emptied","ended","error"],Go=new class{constructor(){Me(this,"onAutoplayFailed",void 0),Me(this,"elementMap",new Map),Me(this,"elementStateMap",new Map),Me(this,"elementsNeedToResume",[]),Me(this,"sinkIdMap",new Map),Me(this,"autoResumeAfterInterruption",n=>{Array.from(this.elementMap.entries()).forEach(i=>{let[a,c]=i,u=this.elementStateMap.get(a),_=c.srcObject.getAudioTracks()[0],S=_&&_.readyState;if(z.debug("resume after interrupted, ele: ".concat(u," audio: ").concat(S," ").concat(n)),S==="live"){if(n)return c.pause(),void c.play();if(Tn.curState==="running")return ei()?(c.pause(),void c.play()):void(u&&u==="paused"&&c.play())}})}),Me(this,"autoResumeAfterInterruptionOnIOS15_16",()=>{Array.from(this.elementMap.entries()).forEach(n=>{let[i,a]=n,c=a.srcObject.getAudioTracks()[0];c&&c.readyState==="live"&&(z.debug("auto resume after interruption inside autoResumeAfterInterruptionOnIOS15"),a.pause(),a.play())})}),this.autoResumeAudioElement(),Tn.on(ms.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),Tn.on(ms.IOS_15_16_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15_16),Tn.on(ms.STATE_CHANGE,()=>{Ea()&&Tn.prevState==="suspended"&&Tn.curState==="running"&&this.autoResumeAfterInterruption()})}async setSinkID(n,i){let a=this.elementMap.get(n);if(this.sinkIdMap.set(n,i),a)try{await a.setSinkId(i)}catch(c){throw new Ye(oe.PERMISSION_DENIED,"can not set sink id: "+c.toString())}}play(n,i,a,c){if(this.elementMap.has(i))return;let u=document.createElement("audio");u.autoplay=!0,u.srcObject=new MediaStream([n]),this.bindAudioElementEvents(i,u),this.elementMap.set(i,u),this.elementStateMap.set(i,is.INIT),this.setVolume(i,a);let _=this.sinkIdMap.get(i);if(_)try{u.setSinkId(_).catch(C=>{z.warning("[".concat(i,"] set sink id failed"),C.toString())})}catch(C){z.warning("[".concat(i,"] set sink id failed"),C.toString())}let S=u.play();S&&S.then&&S.catch(C=>{c&&Vx(c,"audio",C.message,i),z.warning("audio element play warning",C.toString()),this.elementMap.has(i)&&C.name==="NotAllowedError"&&(z.warning("detected audio element autoplay failed"),this.elementsNeedToResume.push(u),In(()=>{this.onAutoplayFailed&&this.onAutoplayFailed(),v8()}))})}updateTrack(n,i){let a=this.elementMap.get(n);a&&(a.srcObject=new MediaStream([i]))}isPlaying(n){return this.elementMap.has(n)&&this.elementStateMap.get(n)==="playing"}setVolume(n,i){let a=this.elementMap.get(n);a&&(i=Math.max(0,Math.min(100,i)),a.volume=i/100)}stop(n){let i=this.elementMap.get(n);if(this.sinkIdMap.delete(n),!i)return;let a=this.elementsNeedToResume.indexOf(i);this.elementsNeedToResume.splice(a,1),i.srcObject=null,i.remove(),this.elementMap.delete(n),this.elementStateMap.delete(n)}bindAudioElementEvents(n,i){Bx.forEach(a=>{i.addEventListener(a,c=>{let u=this.elementStateMap.get(n),_=c.type==="pause"?"paused":c.type;if(z.debug("[".concat(n,"] audio-element-status change ").concat(u," => ").concat(_)),c.type==="error"){let S=i==null?void 0:i.error;S&&z.error("[".concat(n,"] media error, code: ").concat(S.code,", message: ").concat(S.message))}this.elementStateMap.set(n,_)})})}getPlayerState(n){return this.elementStateMap.get(n)||"uninit"}autoResumeAudioElement(){let n=()=>{this.elementsNeedToResume.forEach(i=>{i.play().then(a=>{z.debug("Auto resume audio element success")}).catch(a=>{z.warning("Auto resume audio element failed!",a)})}),this.elementsNeedToResume=[]};new Et(i=>{document.body?i():window.addEventListener("load",()=>i())}).then(()=>{ES()?document.body.addEventListener("click",n,!0):(document.body.addEventListener("touchstart",n,!0),document.body.addEventListener("mousedown",n,!0))})}};function Xi(){return function(n,i,a){let c=a.value;return typeof c=="function"&&(a.value=function(){this._isClosed&&new Ye(oe.INVALID_OPERATION,"[".concat(this.getTrackId(),"] cannot operate a closed track")).print("warning",z);for(var u=arguments.length,_=new Array(u),S=0;S<u;S++)_[S]=arguments[S];let C=c.apply(this,_);return C instanceof Et?new Et((R,e)=>{C.then(R).catch(e)}):C}),a}}class wl extends li{constructor(i){super(),Me(this,"name","VideoProcessorDestination"),Me(this,"ID","0"),Me(this,"_source",void 0),Me(this,"videoContext",void 0),Me(this,"inputTrack",void 0),this.videoContext=i}get kind(){return"video"}get enabled(){return!0}pipe(){throw new Ye(oe.NOT_SUPPORTED,"VideoProcessor cannot pipe to any other Processor")}unpipe(){throw new Ye(oe.NOT_SUPPORTED,"VideoProcessor cannot unpipe to any other Processor")}enable(){}disable(){}updateInput(i){if(i.context!==this.videoContext)throw new Error(`ProcessorContext passed to VideoTrack.processorDestination doesn't match it's belonging VideoTrack's context.
Probably you are making pipeline like this:
videoTrack1.pipe(processor).pipe(videoTrack2.processorDestination).`);i.track&&i.track!==this.inputTrack&&(this.videoContext.chained=!0,this.inputTrack=i.track,this.emit(Fo.ON_TRACK,i.track))}reset(){this.inputTrack=void 0,this.videoContext.chained=!1,this.emit(Fo.ON_TRACK,void 0)}}class S8 extends li{set chained(i){this._chained=i}get chained(){return this._chained}constructor(i,a){super(),Me(this,"constraintsMap",new Map),Me(this,"statsRegistry",[]),Me(this,"usageRegistry",[]),Me(this,"trackId",void 0),Me(this,"direction",void 0),Me(this,"_chained",!1),this.trackId=i,this.direction=a}async getConstraints(){return await Bn(this,nd.REQUEST_CONSTRAINTS)}async requestApplyConstraints(i,a){var c;return z.info("processor ".concat(a.name," requestApplyConstraints for ").concat(this.trackId)),i&&this.constraintsMap.set(a,i),Vr(this,nd.REQUEST_UPDATE_CONSTRAINTS,Array.from(Pc(c=this.constraintsMap).call(c)))}async requestRevertConstraints(i){var a;if(this.constraintsMap.has(i))return z.info("processor ".concat(i.name," requestRevertConstraints for ").concat(this.trackId)),this.constraintsMap.delete(i),Vr(this,nd.REQUEST_UPDATE_CONSTRAINTS,Array.from(Pc(a=this.constraintsMap).call(a)))}registerStats(i,a,c){this.statsRegistry.find(u=>u.processorID===i.ID&&u.processorName===i.name&&u.type===a)||this.statsRegistry.push({processorName:i.name,processorID:i.ID,type:a,cb:c})}unregisterStats(i,a){let c=this.statsRegistry.findIndex(u=>u.processorID===i.ID&&u.processorName===i.name&&u.type===a);c!==-1&&this.statsRegistry.splice(c,1)}gatherStats(){let i=[];for(let{processorID:a,processorName:c,type:u,cb:_}of this.statsRegistry)try{let S=_();i.push({processorID:a,processorName:c,type:u,stats:S})}catch(S){z.error(new Ye(oe.UNEXPECTED_ERROR,S.message))}return i}registerUsage(i,a){this.usageRegistry.find(c=>c.processorID===i.ID&&c.processorName===i.name)||this.usageRegistry.push({processorID:i.ID,processorName:i.name,cb:a})}unregisterUsage(i){let a=this.usageRegistry.findIndex(c=>c.processorID===i.ID&&c.processorName===i.name);a!==-1&&this.usageRegistry.splice(a,1)}async gatherUsage(){let i=[];if(!this.chained)return[];for(let{cb:a}of this.usageRegistry)try{let c=a();c instanceof Et&&(c=await c),i.push(ui(ui({},c),{},{direction:this.direction}))}catch(c){z.error("gather extension usage error",c)}return i}getDirection(){return this.direction}}class fI extends li{constructor(i){super(),Me(this,"name","AudioProcessorDestination"),Me(this,"ID","0"),Me(this,"inputTrack",void 0),Me(this,"inputNode",void 0),Me(this,"audioProcessorContext",void 0),Me(this,"_source",void 0),this.audioProcessorContext=i}get kind(){return"audio"}get enabled(){return!0}pipe(){throw new Ye(oe.NOT_SUPPORTED,"AudioProcessorDestination cannot pipe to any other Processor")}unpipe(){throw new Ye(oe.NOT_SUPPORTED,"AudioProcessor cannot unpipe to any other Processor")}enable(){}disable(){}reset(){this.inputTrack=void 0,this.inputNode=void 0,this.audioProcessorContext.chained=!1,this.emit(Fo.ON_TRACK,void 0),this.emit(Fo.ON_NODE,void 0)}updateInput(i){if(i.context!==this.audioProcessorContext)throw new Error(`ProcessorContext passed to AudioTrack.processorDestination doesn't match it's belonging AudioTrack's context.
        Probably you are making pipeline like this: audioTrack1.pipe(processor).pipe(audioTrack2.processorDestination).`);i.track&&this.inputTrack!==i.track&&(this.audioProcessorContext.chained=!0,this.inputTrack=i.track,this.emit(Fo.ON_TRACK,this.inputTrack)),i.node&&this.inputNode!==i.node&&(this.audioProcessorContext.chained=!0,this.inputNode=i.node,this.emit(Fo.ON_NODE,this.inputNode))}}class AS extends li{set chained(i){this._chained=i}get chained(){return this._chained}constructor(i,a,c){super(),Me(this,"constraintsMap",new Map),Me(this,"statsRegistry",[]),Me(this,"audioContext",void 0),Me(this,"trackId",void 0),Me(this,"direction",void 0),Me(this,"usageRegistry",[]),Me(this,"_chained",!1),this.audioContext=i,this.trackId=a,this.direction=c}async getConstraints(){return Bn(this,nd.REQUEST_CONSTRAINTS)}getAudioContext(){return this.audioContext}async requestApplyConstraints(i,a){var c;return z.info("processor ".concat(a.name," requestApplyConstraints for ").concat(this.trackId)),i&&this.constraintsMap.set(a,i),Vr(this,nd.REQUEST_UPDATE_CONSTRAINTS,Array.from(Pc(c=this.constraintsMap).call(c)))}async requestRevertConstraints(i){var a;if(this.constraintsMap.has(i))return this.constraintsMap.delete(i),Vr(this,nd.REQUEST_UPDATE_CONSTRAINTS,Array.from(Pc(a=this.constraintsMap).call(a)))}registerStats(i,a,c){this.statsRegistry.find(u=>u.processorID===i.ID&&u.processorName===i.name&&u.type===a)||this.statsRegistry.push({processorName:i.name,processorID:i.ID,type:a,cb:c})}unregisterStats(i,a){let c=this.statsRegistry.findIndex(u=>u.processorID===i.ID&&u.processorName===i.name&&u.type===a);c!==-1&&this.statsRegistry.splice(c,1)}gatherStats(){let i=[];for(let{processorID:a,processorName:c,type:u,cb:_}of this.statsRegistry)try{let S=_();i.push({processorID:a,processorName:c,type:u,stats:S})}catch(S){z.error(new Ye(oe.UNEXPECTED_ERROR,S.message))}return i}registerUsage(i,a){this.usageRegistry.find(c=>c.processorID===i.ID&&c.processorName===i.name)||this.usageRegistry.push({processorID:i.ID,processorName:i.name,cb:a})}unregisterUsage(i){let a=this.usageRegistry.findIndex(c=>c.processorID===i.ID&&c.processorName===i.name);a!==-1&&this.usageRegistry.splice(a,1)}async gatherUsage(){let i=[];if(!this.chained)return[];for(let{cb:a}of this.usageRegistry)try{let c=a();c instanceof Et&&(c=await c),i.push(ui(ui({},c),{},{direction:this.direction}))}catch(c){z.error("gather extension usage error",c)}return i}getDirection(){return this.direction}}class Fc extends li{get isPlayed(){return!0}get isFreeze(){return!1}constructor(){super(),Me(this,"context",void 0),Me(this,"processSourceNode",void 0),Me(this,"outputTrack",void 0),Me(this,"processedNode",void 0),Me(this,"clonedTrack",void 0),Me(this,"outputNode",void 0),this.outputNode=new Fx}setVolume(){}createOutputTrack(){throw new Ye(oe.NOT_SUPPORTED,"can not create output MediaStreamTrack when WebAudio disabled")}getOriginVolumeLevel(){return 0}getAccurateVolumeLevel(){return 0}stopGetAudioBuffer(){}startGetAudioBuffer(){}play(){}stop(){}destroy(){}updateTrack(){}updateOriginTrack(){}createMediaStreamSourceNode(){}}class Fx{disconnect(){}connect(){}}function Rl(n){return new Et((i,a)=>{let c=!1,u=document.createElement("video");u.setAttribute("autoplay",""),u.setAttribute("muted",""),u.muted=!0,u.autoplay=!0,u.setAttribute("playsinline",""),u.setAttribute("style","position: fixed; top: 0; left: 0; width: 1px; height: 1px"),document.body.appendChild(u);let _=Ea()?"canplay":"playing";u.addEventListener(_,()=>{let S=u.videoWidth,C=u.videoHeight;!S&&Ni()||(c=!0,u.srcObject=null,u.remove(),i([S,C]))}),u.srcObject=new MediaStream([n]),u.play().catch(ph),setTimeout(()=>{c||(u.srcObject=null,u.remove(),i([u.videoWidth,u.videoHeight]))},4e3)})}function hI(n){let i={};n.facingMode&&(i.facingMode=n.facingMode),n.cameraId&&(i.deviceId={exact:n.cameraId});let a=zi(n.encoderConfig);return a.width!=null&&(i.width=a.width),a.height!=null&&(i.height=a.height),!pL()&&a.frameRate&&(i.frameRate=a.frameRate),sr()&&typeof i.frameRate=="object"&&(i.frameRate.max=60),Ni()&&(i.frameRate={ideal:30,max:30}),i}function Gx(n){let i={};return pL()||(n.AGC!==void 0&&(i.autoGainControl=n.AGC),n.AEC!==void 0&&(i.echoCancellation=n.AEC),n.ANS!==void 0&&(i.noiseSuppression=n.ANS,Vo()&&n.ANS&&(i.googHighpassFilter=n.ANS))),i}function y8(n){let i=Gx(n);if(n.encoderConfig){let a=xa(n.encoderConfig);i.channelCount=a.stereo?2:1,i.sampleRate=a.sampleRate,i.sampleSize=a.sampleSize}return n.microphoneId&&(i.deviceId={exact:n.microphoneId}),nI()&&(i.sampleRate=void 0),i}let dc=n=>{let i=n._encoderConfig;if(!i)return;let{frameRate:a,width:c,height:u}=n.getMediaStreamTrackSettings(),{frameRate:_=a,width:S=c,height:C=u}=i;if(!_||!S||!C)return;S=EL(S),C=EL(C),_=EL(_);let{max:R,min:e}=function(l,f,m){let E=200*Math.pow(m/15,.6)*Math.pow(l*f/640/360,.75);return{min:Math.floor(E),max:Math.floor(4*E)}}(S,C,_),{bitrateMax:t,bitrateMin:r}=i||{};t||z.debug("calculate bitrate: [w: ".concat(S,", h: ").concat(C,", fps: ").concat(_,"] => [brMax: ").concat(t,", brMin: ").concat(r,"]"));let{maxFramerate:s}=ge("ENCODER_CONFIG_LIMIT");return s&&typeof s=="number"&&(_=Math.min(_,s)),{frameRate:_,bitrateMax:t||R,bitrateMin:r||e,scaleResolutionDownBy:1,scale:0}},Hi=async(n,i,a)=>await(async(c,u,_)=>{let S=function(e){let t=[];for(let r=0;r<e.length;r+=2)t.push(parseInt(e.slice(r,r+2),16));return Uint8Array.from(t)}(d8(""+u+_)).slice(0,16),C=S.slice(0,12),R=await window.crypto.subtle.importKey("raw",S,"AES-GCM",!0,["encrypt"]);return new Uint8Array(await window.crypto.subtle.encrypt({name:"AES-GCM",iv:C},R,c))})(n.buffer,i,a),DL=n=>{let i=document.createElement("canvas");return i.width=2,i.height=2,new Et((a,c)=>{i.toBlob(async u=>{if(i.remove(),u){let _=await zx(u);a({buffer:_,width:i.width,height:i.height})}else c(new Ye(oe.CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED))},n,1)})},zx=async n=>{let i=await n.arrayBuffer();return new Uint8Array(i)};var Hx,Wx,PL,T8,Yx,pI,Kx,qx,b8,Jx,ML,Xx,Qx,Zx,$x,e3,t3,n3,yi,r3,i3,a3,s3,o3,c3,vh,l3,d3,u3,f3,Ti,h3,p3,m3,g3,_3,E3,Sh,v3,gs;let Ui=(Hx=$t({argsMap:(n,i)=>[n.getTrackId(),i],throttleTime:300}),Wx=$t({argsMap:(n,i)=>[n.getTrackId(),i]}),PL=Xi(),T8=Dg("LocalAudioTrack","_enabledMutex"),Yx=$t({argsMap:(n,i)=>[n.getTrackId(),i]}),pI=Xi(),Kx=Dg("LocalAudioTrack","_enabledMutex"),qx=$t({argsMap:(n,i)=>[n.getTrackId(),i]}),b8=Xi(),Jx=Xi(),ML=Xi(),Xx=$t({argsMap:n=>[n.getTrackId()]}),Qx=Xi(),Zx=$t({argsMap:n=>[n.getTrackId()]}),$x=Xi(),e3=$t({argsMap:n=>[n.getTrackId()]}),t3=$t({argsMap:(n,i)=>[n.getTrackId(),i.name]}),n3=$t({argsMap:n=>[n.getTrackId()]}),Xn((yi=class extends yo{get _source(){return this.initWebAudio()}set _source(n){this._trackSource=n}get processorContext(){return this._processorContext||(this._processorContext=this.initProcessor().processorContext),this._processorContext}get processorDestination(){return this._processorDestination||(this._processorDestination=this.initProcessor().processorDestination),this._processorDestination}get isPlaying(){return this._useAudioElement?Go.isPlaying(this.getTrackId()):this._source.isPlayed}get __className__(){return"LocalAudioTrack"}constructor(n,i,a,c){super(n,a),Me(this,"trackMediaType",Jb.AUDIO),Me(this,"_encoderConfig",void 0),Me(this,"_trackSource",void 0),Me(this,"metadata",[]),Me(this,"_enabled",!0),Me(this,"_volume",100),Me(this,"_useAudioElement",!0),Me(this,"_bypassWebAudio",!1),Me(this,"processor",void 0),Me(this,"_processorContext",void 0),Me(this,"_processorDestination",void 0),Me(this,"_getOriginVolumeLevel",void 0),this._encoderConfig=i,this._getOriginVolumeLevel=!!c,this._trackSource=new Fc,ge("DISABLE_WEBAUDIO")&&(this._bypassWebAudio=!0),ge("LOCAL_AUDIO_TRACK_USES_WEB_AUDIO")&&(this._useAudioElement=!1),mr()&&!no?setTimeout(()=>this.initWebAudio()):this.initWebAudio()}setVolume(n){Cr(n,"volume",0,1e3),this._volume=n,this._source.setVolume(n/100),this._useAudioElement&&Go.setVolume(this.getTrackId(),n);try{if(this._bypassWebAudio)return void z.debug("[".concat(this.getTrackId(),"] setVolume returned because no pass through WebAudio."));let i=this._source.createOutputTrack();this._mediaStreamTrack!==i&&(this._mediaStreamTrack=i,Vr(this,bt.NEED_REPLACE_TRACK,this).then(()=>{z.debug("[".concat(this.getTrackId(),"] replace web audio track success"))}).catch(a=>{z.warning("[".concat(this.getTrackId(),"] replace web audio track failed"),a)}))}catch{}}getVolumeLevel(){return this._muted&&this.enabled&&this._getOriginVolumeLevel?this._source.getOriginVolumeLevel():this._source.getAccurateVolumeLevel()}async setPlaybackDevice(n){if(!this._useAudioElement||!G())throw new Ye(oe.NOT_SUPPORTED,"your browser does not support setting the audio output device");await Go.setSinkID(this.getTrackId(),n)}async setEnabled(n,i,a){return this._setEnabled(n,i,a)}async _setEnabled(n,i,a){if(!a){if(n===this._enabled)return;this.stateCheck("enabled",n)}if(z.info("[".concat(this.getTrackId(),"] start setEnabled"),n),n){this._originMediaStreamTrack.enabled=!0;try{a||(this._enabled=!0),await Vr(this,bt.NEED_ENABLE_TRACK,this),z.info("[".concat(this.getTrackId(),"] setEnabled to ").concat(n," success"))}catch(c){throw a||(this._enabled=!1),z.error("[".concat(this.getTrackId(),"] setEnabled to true error"),c.toString()),c}}else{this._originMediaStreamTrack.enabled=!1,a||(this._enabled=!1);try{await Vr(this,bt.NEED_DISABLE_TRACK,this)}catch(c){throw a||(this._enabled=!0),z.error("[".concat(this.getTrackId(),"] setEnabled to false error"),c.toString()),c}}}async setMuted(n){n!==this._muted&&(this.stateCheck("muted",n),this._muted=n,this._originMediaStreamTrack.enabled=!n,z.debug("[".concat(this.getTrackId(),"] start set muted: ").concat(n)),n?await Vr(this,bt.NEED_MUTE_TRACK,this):await Vr(this,bt.NEED_UNMUTE_TRACK,this))}getStats(){return la(()=>{z.warning("[deprecated] LocalAudioTrack.getStats will be removed in the future, use AgoraRTCClient.getLocalAudioStats instead")},"localAudioTrackGetStatsWarning"),ed(this,bt.GET_STATS)||ui({},U_)}setAudioFrameCallback(n){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4096;if(!n)return this._source.removeAllListeners(lc.ON_AUDIO_BUFFER),void this._source.stopGetAudioBuffer();this._source.startGetAudioBuffer(i),this._source.removeAllListeners(lc.ON_AUDIO_BUFFER),this._source.on(lc.ON_AUDIO_BUFFER,a=>n(a))}play(){z.debug("[".concat(this.getTrackId(),"] start audio playback")),this._useAudioElement?(z.debug("[".concat(this.getTrackId(),"] start audio playback in element")),Go.play(this._mediaStreamTrack,this.getTrackId(),this._volume)):this._source.play()}stop(){z.debug("[".concat(this.getTrackId(),"] stop audio playback")),this._useAudioElement?Go.stop(this.getTrackId()):this._source.stop()}close(){super.close(),this._processorDestination&&this.unbindProcessorDestinationEvents(this._processorDestination),this._processorContext&&this.unbindProcessorContextEvents(this._processorContext),this.unpipe(),this._processorDestination&&this._processorDestination._source&&this._processorDestination._source.unpipe(),this._source.destroy()}_updatePlayerSource(){let n=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];z.debug("[".concat(this.getTrackId(),"] update player source track")),n&&this._source.updateTrack(this._mediaStreamTrack),this._useAudioElement&&Go.updateTrack(this.getTrackId(),this._mediaStreamTrack)}async _updateOriginMediaStreamTrack(n,i){this._originMediaStreamTrack!==n&&(this._originMediaStreamTrack&&(this._originMediaStreamTrack.removeEventListener("ended",this._handleTrackEnded),i&&this._originMediaStreamTrack.stop()),n.addEventListener("ended",this._handleTrackEnded),this._originMediaStreamTrack=n,this._muted&&(this._originMediaStreamTrack.enabled=!1),this.processor&&this._processorContext&&this.processor.updateInput({track:n,context:this._processorContext}),this._mediaStreamTrack!==this._source.outputTrack?(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await Vr(this,bt.NEED_REPLACE_TRACK,this)):this._source.updateTrack(this._originMediaStreamTrack),this._getOriginVolumeLevel&&this._source.updateOriginTrack(n))}renewMediaStreamTrack(n){return Et.resolve(void 0)}pipe(n){if(this._bypassWebAudio)throw new Ye(oe.INVALID_OPERATION,"Can not process AudioTrack when bypassWebAudio set to true.");if(this.processor===n)return n;if(n._source)throw new Ye(oe.INVALID_OPERATION,"Processor ".concat(n.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=n,this.processor._source=this,n.updateInput({track:this._originMediaStreamTrack,node:this._source.processSourceNode,context:this.processorContext}),n}unpipe(){var n;if(!this.processor)return;let i=this.processor;(n=this._source.processSourceNode)===null||n===void 0||n.disconnect(),this.processor._source=!1,this.processor=void 0,i.reset()}bindProcessorDestinationEvents(n){n.on(Fo.ON_TRACK,async i=>{i?i!==this._mediaStreamTrack&&(this._mediaStreamTrack=i,this._updatePlayerSource(!1),this._source.processedNode=this._source.createMediaStreamSourceNode(i),await Vr(this,bt.NEED_REPLACE_TRACK,this)):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await Vr(this,bt.NEED_REPLACE_TRACK,this))}),n.on(Fo.ON_NODE,i=>{this._source.processedNode=i})}unbindProcessorDestinationEvents(n){n.removeAllListeners(Fo.ON_TRACK),n.removeAllListeners(Fo.ON_NODE)}bindProcessorContextEvents(n){n.on(nd.REQUEST_CONSTRAINTS,async i=>{i(this._originMediaStreamTrack.getSettings())})}unbindProcessorContextEvents(n){n.removeAllListeners(nd.REQUEST_CONSTRAINTS)}initWebAudio(){return this._trackSource instanceof Fc&&(this._trackSource=new fi(this._mediaStreamTrack,!1,this._getOriginVolumeLevel?this._mediaStreamTrack:void 0)),this._trackSource}initProcessor(){let n=new AS(this._source.context,this.getTrackId(),"local"),i=new fI(n);return this._processorContext=n,this._processorDestination=i,this.bindProcessorContextEvents(n),this.bindProcessorDestinationEvents(i),this._source.on(lc.UPDATE_SOURCE,()=>{this.processor&&this.processor.updateInput({node:this._source.processSourceNode,context:n})}),this._useAudioElement&&(this._useAudioElement=!1,this.isPlaying&&(Go.stop(this.getTrackId()),this._source.play()),Vr(this,bt.NEED_REPLACE_MIXING_TRACK,this).then(()=>{z.debug("[".concat(this.getTrackId(),"] replace from origin track to web audio track success"))}).catch(a=>{z.warning("[".concat(this.getTrackId(),"] replace from origin track to web audio track failed"),a)})),{processorContext:n,processorDestination:i}}}).prototype,"setVolume",[Hx],Object.getOwnPropertyDescriptor(yi.prototype,"setVolume"),yi.prototype),Xn(yi.prototype,"setPlaybackDevice",[Wx,PL],Object.getOwnPropertyDescriptor(yi.prototype,"setPlaybackDevice"),yi.prototype),Xn(yi.prototype,"setEnabled",[T8,Yx,pI],Object.getOwnPropertyDescriptor(yi.prototype,"setEnabled"),yi.prototype),Xn(yi.prototype,"setMuted",[Kx,qx,b8],Object.getOwnPropertyDescriptor(yi.prototype,"setMuted"),yi.prototype),Xn(yi.prototype,"getStats",[Jx],Object.getOwnPropertyDescriptor(yi.prototype,"getStats"),yi.prototype),Xn(yi.prototype,"setAudioFrameCallback",[ML],Object.getOwnPropertyDescriptor(yi.prototype,"setAudioFrameCallback"),yi.prototype),Xn(yi.prototype,"play",[Xx,Qx],Object.getOwnPropertyDescriptor(yi.prototype,"play"),yi.prototype),Xn(yi.prototype,"stop",[Zx,$x],Object.getOwnPropertyDescriptor(yi.prototype,"stop"),yi.prototype),Xn(yi.prototype,"close",[e3],Object.getOwnPropertyDescriptor(yi.prototype,"close"),yi.prototype),Xn(yi.prototype,"pipe",[t3],Object.getOwnPropertyDescriptor(yi.prototype,"pipe"),yi.prototype),Xn(yi.prototype,"unpipe",[n3],Object.getOwnPropertyDescriptor(yi.prototype,"unpipe"),yi.prototype),yi),mI=(r3=$t({argsMap:(n,i)=>[n.getTrackId(),i]}),i3=Xi(),a3=Dg("MicrophoneAudioTrack","_enabledMutex"),s3=$t({argsMap:(n,i,a)=>[n.getTrackId(),i,a]}),o3=Xi(),c3=$t({argsMap:n=>[n.getTrackId()]}),Xn((vh=class extends Ui{get __className__(){return"MicrophoneAudioTrack"}constructor(n,i,a,c){super(n,i.encoderConfig?xa(i.encoderConfig):{},c,ge("GET_VOLUME_OF_MUTED_AUDIO_TRACK")),Me(this,"_config",void 0),Me(this,"_deviceName","default"),Me(this,"_constraints",void 0),Me(this,"_originalConstraints",void 0),Me(this,"_enabled",!0),this._config=i,this._constraints=a,this._originalConstraints=a,this._deviceName=n.label,typeof i.bypassWebAudio=="boolean"&&(this._bypassWebAudio=i.bypassWebAudio),(ei()||to())&&Tn.bindInterruptDetectorTrack(this)}async setDevice(n){if(z.info("[".concat(this.getTrackId(),"] start set device to ").concat(n)),this._enabled)try{let i=await bl.getDeviceById(n),a={};a.audio=ui({},this._constraints),a.audio.deviceId={exact:n},this._originMediaStreamTrack.stop();let c=null;try{c=await ro(a,this.getTrackId())}catch(u){throw z.error("[".concat(this.getTrackId(),"] setDevice failed"),u.toString()),c=await ro({audio:this._constraints},this.getTrackId()),await this._updateOriginMediaStreamTrack(c.getAudioTracks()[0],!1),u}await this._updateOriginMediaStreamTrack(c.getAudioTracks()[0],!1),this._deviceName=i.label,this._config.microphoneId=n,this._constraints.deviceId={exact:n}}catch(i){throw z.error("[".concat(this.getTrackId(),"] setDevice error"),i.toString()),i}else try{let i=await bl.getDeviceById(n);this._deviceName=i.label,this._config.microphoneId=n,this._constraints.deviceId={exact:n}}catch(i){throw z.error("[".concat(this.getTrackId(),"] setDevice error"),i.toString()),i}z.info("[".concat(this.getTrackId(),"] set device to ").concat(n," success"))}async setEnabled(n,i,a){if(i)return z.debug("[".concat(this.getTrackId(),"] setEnabled false (do not close microphone)")),await super._setEnabled(n);if(!a){if(n===this._enabled)return;this.stateCheck("enabled",n)}if(z.info("[".concat(this.getTrackId(),"] start setEnabled"),n),ge("AUTO_RESET_AUDIO_ROUTE")&&(Ea()||Jd())){let S=navigator.audioSession;S&&(n||(S.type="playback"),S.type="auto")}if(!n){var c;this._originMediaStreamTrack.onended=null,this._originMediaStreamTrack.stop(),(c=this._source.clonedTrack)===null||c===void 0||c.stop(),a||(this._enabled=!1);try{await Vr(this,bt.NEED_DISABLE_TRACK,this)}catch(S){throw z.error("[".concat(this.getTrackId(),"] setEnabled false failed"),S.toString()),S}return}let u=ui({},this._constraints),_=bl.searchDeviceIdByName(this._deviceName);_&&!u.deviceId&&(u.deviceId=_);try{a||(this._enabled=!0);let S=await ro({audio:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(S.getAudioTracks()[0],!1),await Vr(this,bt.NEED_ENABLE_TRACK,this)}catch(S){throw a||(this._enabled=!1),z.error("[".concat(this.getTrackId(),"] setEnabled true failed"),S.toString()),S}z.info("[".concat(this.getTrackId(),"] setEnabled success"))}close(){super.close(),(ei()||to())&&Tn.unbindInterruptDetectorTrack(this)}onTrackEnded(){if((Ea()||Jd())&&this._enabled&&!this._isClosed&&Tn.duringInterruption){let n=async()=>{Tn.off(ms.IOS_INTERRUPTION_END,n),this._enabled&&!this._isClosed&&(z.debug("[".concat(this.getTrackId(),"] try capture microphone media device for interrupted iOS device.")),await this.setEnabled(!1),await this.setEnabled(!0))};Tn.on(ms.IOS_INTERRUPTION_END,n)}else z.debug("[".concat(this.getTrackId(),"] track ended")),this.safeEmit(x_.TRACK_ENDED)}async renewMediaStreamTrack(n){let i=n||this._constraints,a=bl.searchDeviceIdByName(this._deviceName);if(a&&!i.deviceId&&(i.deviceId=a),this._constraints=i,this._enabled){this._originMediaStreamTrack.stop();let c=await ro({audio:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(c.getAudioTracks()[0],!0)}}bindProcessorContextEvents(n){super.bindProcessorContextEvents(n),n.on(nd.REQUEST_UPDATE_CONSTRAINTS,async(i,a,c)=>{try{let u=Object.assign({},this._originalConstraints,...i);await this.renewMediaStreamTrack(u),a()}catch(u){c(u)}})}unbindProcessorContextEvents(n){super.unbindProcessorContextEvents(n),n.removeAllListeners(nd.REQUEST_UPDATE_CONSTRAINTS)}}).prototype,"setDevice",[r3,i3],Object.getOwnPropertyDescriptor(vh.prototype,"setDevice"),vh.prototype),Xn(vh.prototype,"setEnabled",[a3,s3,o3],Object.getOwnPropertyDescriptor(vh.prototype,"setEnabled"),vh.prototype),Xn(vh.prototype,"close",[c3],Object.getOwnPropertyDescriptor(vh.prototype,"close"),vh.prototype),vh),C8=(l3=$t({argsMap:(n,i)=>[n.getTrackId(),i,n.duration]}),d3=Xi(),u3=$t({argsMap:n=>[n.getTrackId()]}),f3=Xi(),Ti=$t({argsMap:n=>[n.getTrackId()]}),h3=Xi(),p3=$t({argsMap:n=>[n.getTrackId()]}),m3=Xi(),g3=$t({argsMap:n=>[n.getTrackId()]}),_3=Xi(),E3=$t({argsMap:n=>[n.getTrackId()]}),Sh=$t({argsMap:n=>[n.getTrackId()]}),v3=Xi(),Xn((gs=class extends Ui{get __className__(){return"BufferSourceAudioTrack"}constructor(n,i,a,c){super(i.createOutputTrack(),a,c),Me(this,"source",void 0),Me(this,"_bufferSource",void 0),this._useAudioElement=!1,this.source=n,this._bufferSource=i,this._bufferSource.on(lc.AUDIO_SOURCE_STATE_CHANGE,u=>{this.safeEmit(x_.SOURCE_STATE_CHANGE,u)});try{this._mediaStreamTrack=this._source.createOutputTrack()}catch{}}get currentState(){return this._bufferSource.currentState}get duration(){return this._bufferSource.duration}get playbackSpeed(){return this._bufferSource.playbackSpeed}getCurrentTime(){return this._bufferSource.currentTime}startProcessAudioBuffer(n){n&&this._bufferSource.updateOptions(n),this._bufferSource.startProcessAudioBuffer()}pauseProcessAudioBuffer(){this._bufferSource.pauseProcessAudioBuffer()}seekAudioBuffer(n){this._bufferSource.seekAudioBuffer(n)}resumeProcessAudioBuffer(){this._bufferSource.resumeProcessAudioBuffer()}stopProcessAudioBuffer(){this._bufferSource.stopProcessAudioBuffer()}close(){this.source=null,this._bufferSource.destroy(),super.close()}setAudioBufferPlaybackSpeed(n){Cr(n,"speed",0),this._bufferSource.setAudioBufferPlaybackSpeed(n)}}).prototype,"startProcessAudioBuffer",[l3,d3],Object.getOwnPropertyDescriptor(gs.prototype,"startProcessAudioBuffer"),gs.prototype),Xn(gs.prototype,"pauseProcessAudioBuffer",[u3,f3],Object.getOwnPropertyDescriptor(gs.prototype,"pauseProcessAudioBuffer"),gs.prototype),Xn(gs.prototype,"seekAudioBuffer",[Ti,h3],Object.getOwnPropertyDescriptor(gs.prototype,"seekAudioBuffer"),gs.prototype),Xn(gs.prototype,"resumeProcessAudioBuffer",[p3,m3],Object.getOwnPropertyDescriptor(gs.prototype,"resumeProcessAudioBuffer"),gs.prototype),Xn(gs.prototype,"stopProcessAudioBuffer",[g3,_3],Object.getOwnPropertyDescriptor(gs.prototype,"stopProcessAudioBuffer"),gs.prototype),Xn(gs.prototype,"close",[E3],Object.getOwnPropertyDescriptor(gs.prototype,"close"),gs.prototype),Xn(gs.prototype,"setAudioBufferPlaybackSpeed",[Sh,v3],Object.getOwnPropertyDescriptor(gs.prototype,"setAudioBufferPlaybackSpeed"),gs.prototype),gs);class va extends Ui{get __className__(){return"MixingAudioTrack"}get isActive(){for(let i of this.trackList)if(i._enabled&&!i._isClosed&&!i.muted)return!0;return!1}constructor(){let i=Tl().createMediaStreamDestination();super(i.stream.getAudioTracks()[0],void 0,gr(8,"track-mix-")),Me(this,"trackList",void 0),Me(this,"destNode",void 0),this._useAudioElement=!1;try{this._mediaStreamTrack=this._source.createOutputTrack()}catch{}this.destNode=i,this.trackList=[]}hasAudioTrack(i){return this.trackList.indexOf(i)!==-1}addAudioTrack(i){this.trackList.indexOf(i)===-1?(z.debug("add ".concat(i.getTrackId()," to mixing track")),i._source.outputNode.connect(this.destNode),this.trackList.push(i),this.updateEncoderConfig()):z.debug("track ".concat(i.getTrackId()," is already added"))}removeAudioTrack(i){if(this.trackList.indexOf(i)!==-1){z.debug("remove ".concat(i.getTrackId()," from mixing track"));try{i._source.outputNode.disconnect(this.destNode)}catch{}iI(this.trackList,i),this.updateEncoderConfig()}}updateEncoderConfig(){let i={};this.trackList.forEach(a=>{a._encoderConfig&&((a._encoderConfig.bitrate||0)>(i.bitrate||0)&&(i.bitrate=a._encoderConfig.bitrate),(a._encoderConfig.sampleRate||0)>(i.sampleRate||0)&&(i.sampleRate=a._encoderConfig.sampleRate),(a._encoderConfig.sampleSize||0)>(i.sampleSize||0)&&(i.sampleSize=a._encoderConfig.sampleSize),a._encoderConfig.stereo&&(i.stereo=!0))}),this._encoderConfig=i}_updateRtpTransceiver(i){this._rtpTransceiver!==i&&(this._rtpTransceiver=i,this.trackList.forEach(a=>{a instanceof va?a.emit(Bo.TRANSCEIVER_UPDATED,i):a._updateRtpTransceiver(i)}))}}class w8 extends kx{set currentState(i){i!==this._currentState&&(this._currentState=i,this.safeEmit(lc.AUDIO_SOURCE_STATE_CHANGE,this._currentState))}get currentState(){return this._currentState}constructor(i){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Me(this,"audioBuffer",void 0),Me(this,"sourceNode",void 0),Me(this,"startPlayTime",0),Me(this,"startPlayOffset",0),Me(this,"pausePlayTime",0),Me(this,"options",void 0),Me(this,"currentLoopCount",0),Me(this,"currentPlaybackSpeed",100),Me(this,"_currentState","stopped"),this.audioBuffer=i,this.options=a,this.startPlayOffset=this.options.startPlayTime||0}createWebAudioDiagram(){return this.context.createGain()}get duration(){return this.audioBuffer?this.audioBuffer.duration:0}get playbackSpeed(){return this.currentPlaybackSpeed}get currentTime(){return this.audioBuffer?this.currentState==="stopped"?0:this.currentState==="paused"?this.pausePlayTime:((this.context.currentTime-this.startPlayTime)*(this.playbackSpeed/100)+this.startPlayOffset)%this.audioBuffer.duration:0}updateOptions(i){this.currentState==="stopped"?(this.options=i,this.startPlayOffset=this.options.startPlayTime||0):z.warning("can not set audio source options")}startProcessAudioBuffer(){this.sourceNode&&this.stopProcessAudioBuffer(),this.sourceNode=this.createSourceNode(),this.startSourceNode(),this.currentState="playing"}pauseProcessAudioBuffer(){this.sourceNode&&this.currentState==="playing"&&(this.pausePlayTime=this.currentTime,this.sourceNode.onended=null,this.sourceNode.stop(),this.sourceNode.buffer=null,this.sourceNode=this.createSourceNode(),this.currentState="paused")}seekAudioBuffer(i){this.sourceNode&&(this.sourceNode.onended=null,this.currentState==="playing"&&this.sourceNode.stop(),this.sourceNode=this.createSourceNode(),this.currentState==="playing"?(this.startPlayOffset=i,this.startSourceNode()):this.currentState==="paused"&&(this.pausePlayTime=i))}resumeProcessAudioBuffer(){this.currentState==="paused"&&this.sourceNode&&(this.startPlayOffset=this.pausePlayTime,this.pausePlayTime=0,this.startSourceNode(),this.currentState="playing")}stopProcessAudioBuffer(){if(this.sourceNode){this.sourceNode.onended=null;try{this.sourceNode.stop()}catch{}this.reset()}}destroy(){this.audioBuffer=null,super.destroy()}setAudioBufferPlaybackSpeed(i){this.sourceNode&&(this.currentState==="playing"&&(this.startPlayOffset=this.currentTime,this.startPlayTime=this.context.currentTime),this.sourceNode.playbackRate.value=i/100),this.currentPlaybackSpeed=i}startSourceNode(){this.sourceNode&&this.sourceNode.buffer&&(this.sourceNode.start(0,this.startPlayOffset),this.startPlayTime=this.context.currentTime,this.sourceNode.onended=this.handleSourceNodeEnded.bind(this))}createSourceNode(){let i=this.context.createBufferSource();return i.buffer=this.audioBuffer,i.loop=!!this.options.loop,i.connect(this.outputNode),i.playbackRate.value=this.currentPlaybackSpeed/100,i}handleSourceNodeEnded(){if(this.currentLoopCount+=1,this.options.cycle&&this.options.cycle>this.currentLoopCount)return this.startPlayOffset=0,this.sourceNode=void 0,void this.startProcessAudioBuffer();this.reset()}reset(){this.startPlayOffset=this.options.startPlayTime||0,this.currentState="stopped",this.sourceNode&&(this.sourceNode.disconnect(),this.sourceNode=void 0),this.currentLoopCount=0}}let S3=new Map;class kL{get rendFrameRate(){if(this.renderStats&&this.renderStats.curTs!==this.renderStats.lastTs){let i=this.renderStats.curTs-this.renderStats.lastTs,a=(this.renderStats.renderNum-this.renderStats.lastRenderNum)/i;return this.renderStats.lastRenderNum=this.renderStats.renderNum,this.renderStats.lastTs=this.renderStats.curTs,a}return 0}get videoElementStatus(){return this._videoElementStatus}set videoElementStatus(i){i!==this._videoElementStatus&&(z.debug("[".concat(this.trackId,"] video-element-status change ").concat(this._videoElementStatus," => ").concat(i)),this._videoElementStatus=i)}get videoState(){return this._videoState}set videoState(i){var a;i!==this._videoState&&(this._videoState=i,(a=this.onVideoStateChanged)===null||a===void 0||a.call(this,this.videoState))}constructor(i){Me(this,"trackId",void 0),Me(this,"config",void 0),Me(this,"onFirstVideoFrameDecoded",void 0),Me(this,"onVideoStateChanged",void 0),Me(this,"freezeTimeCounterList",[]),Me(this,"renderFreezeAccTime",0),Me(this,"isKeepLastFrame",!1),Me(this,"timeUpdatedCount",0),Me(this,"freezeTime",0),Me(this,"playbackTime",0),Me(this,"lastTimeUpdatedTime",0),Me(this,"autoplayFailed",!1),Me(this,"videoTrack",void 0),Me(this,"videoElement",void 0),Me(this,"cacheVideoElement",void 0),Me(this,"renderStats",void 0),Me(this,"_videoState",yl.VideoStateStopped),Me(this,"videoElementCheckInterval",void 0),Me(this,"videoElementFreezeTimeout",void 0),Me(this,"_videoElementStatus",is.NONE),Me(this,"isGettingVideoDimensions",!1),Me(this,"startGetVideoDimensions",()=>{let a=()=>{if(this.isGettingVideoDimensions=!0,this.videoElement.videoWidth*this.videoElement.videoHeight>4)return z.debug("[".concat(this.trackId,"] current video dimensions:"),this.videoElement.videoWidth,this.videoElement.videoHeight),void(this.isGettingVideoDimensions=!1);setTimeout(a,500)};!this.isGettingVideoDimensions&&a()}),Me(this,"autoResumeAfterInterruption",()=>{this.videoTrack&&this.videoTrack.readyState==="live"&&Tn.curState==="running"&&(z.debug("[track-".concat(this.trackId,"] video element paused, auto resume for ").concat(eI())),Vb()?(this.videoElement.srcObject=null,this.videoElement.srcObject=new MediaStream([this.videoTrack]),this.videoElement.play()):(this.videoElement.pause(),this.videoElement.play()))}),Me(this,"handleVideoEvents",a=>{switch(a.type){case"play":case"playing":this.startGetVideoDimensions(),this.videoElementStatus=is.PLAYING;break;case"loadeddata":if(this.videoState=yl.VideoStateStarting,this.onFirstVideoFrameDecoded&&this.onFirstVideoFrameDecoded(),this.cacheVideoElement){try{this.cacheVideoElement.srcObject=null,this.cacheVideoElement.remove()}catch{}this.cacheVideoElement=void 0}break;case"canplay":this.videoElementStatus=is.CANPLAY;break;case"stalled":this.videoElementStatus=is.STALLED;break;case"suspend":this.videoElementStatus=is.SUSPEND;break;case"pause":this.videoElementStatus=is.PAUSED,Ea()||Jd()||mr()&&this.autoplayFailed||!this.videoTrack||this.videoTrack.readyState!=="live"||(z.debug("[track-".concat(this.trackId,"] video element paused, auto resume")),this.videoElement.play());break;case"waiting":this.videoElementStatus=is.WAITING;break;case"abort":this.videoElementStatus=is.ABORT;break;case"ended":this.videoElementStatus=is.ENDED;break;case"emptied":this.videoElementStatus=is.EMPTIED;break;case"error":{let c=this.videoElement.error;c&&(this.videoElementStatus=is.ERROR,z.error("[".concat(this.trackId,"] media error: ").concat(c.message," (").concat(c.code,")")));break}case"timeupdate":{let c=performance.now();if(this.timeUpdatedCount+=1,this.timeUpdatedCount<10)return void(this.lastTimeUpdatedTime=c);let u=c-this.lastTimeUpdatedTime,_=this.lastTimeUpdatedTime;if(this.lastTimeUpdatedTime=c,zp.lastVisibleTime<zp.lastHiddenTime||_<zp.lastHiddenTime||_<zp.lastVisibleTime)return;for(u>ge("VIDEO_FREEZE_DURATION")&&(this.freezeTime+=u),this.playbackTime+=u;this.playbackTime>=6e3;){this.playbackTime-=6e3;let S=Math.min(6e3,this.freezeTime);this.freezeTimeCounterList.push(S),this.freezeTime=Math.max(0,this.freezeTime-6e3)}break}}}),Me(this,"autoResumeAfterInterruptionOnIOS15_16",()=>{this.videoTrack&&this.videoTrack.readyState==="live"&&(z.debug("[track-".concat(this.trackId,"] video element paused, auto resume for ").concat(eI())),Vb()?(this.videoElement.srcObject=null,this.videoElement.srcObject=new MediaStream([this.videoTrack]),this.videoElement.play()):(this.videoElement.pause(),this.videoElement.play()))}),this.trackId=i.trackId,this.config=i,i.element instanceof HTMLVideoElement?this.videoElement=i.element:this.videoElement=document.createElement("video"),Tn.on(ms.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),Tn.on(ms.IOS_15_16_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15_16)}getVideoElement(){return this.videoElement}getContainerElement(){var i;return(i=this.videoElement.parentElement)!==null&&i!==void 0?i:void 0}updateConfig(i){this.config=i,this.trackId=i.trackId,i.element!==this.videoElement&&(this.destroy(),this.videoElement=i.element),this.videoTrack&&this.initVideoElement()}updateVideoTrack(i){this.videoTrack!==i&&(this.videoTrack=i,this.initVideoElement())}play(i){let a=this.videoElement.play();a&&a.catch&&a.catch(u=>{i&&Vx(i,"video",u.message,this.trackId),u.name==="NotAllowedError"?(z.warning("detected video element autoplay failed",u),this.autoplayFailed=!0,this.handleAutoPlayFailed()):z.warning("[".concat(this.trackId,"] play warning: "),u)});let c=En();if((c.name==="Safari"&&Number(c.version)===15||ei())&&a&&a.then){let u=()=>{this.config.mirror&&(this.videoElement.style.transform="rotateY(180deg)")};a.then(u).catch(u)}}getCurrentFrame(){let i=document.createElement("canvas");i.width=this.videoElement.videoWidth,i.height=this.videoElement.videoHeight;let a=i.getContext("2d");if(!a)return z.error("create canvas context failed!"),new ImageData(2,2);a.drawImage(this.videoElement,0,0,i.width,i.height);let c=a.getImageData(0,0,i.width,i.height);return i.remove(),c}async getCurrentFrameToUint8Array(i){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,c=document.createElement("canvas");c.width=this.videoElement.videoWidth,c.height=this.videoElement.videoHeight;let u=c.getContext("2d");return u?(u.drawImage(this.videoElement,0,0,c.width,c.height),new Et((_,S)=>{c.toBlob(async C=>{if(c.remove(),C){let R=await zx(C);_({buffer:R,width:c.width,height:c.height})}else S(new Ye(oe.CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED))},i,a<0?.1:a>1?1:a)})):await DL(i)}destroy(){this.renderStats=void 0,Tn.off(ms.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),Tn.off(ms.IOS_15_16_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15_16),this.videoElement.srcObject=null,this.resetVideoElement(),this.freezeTimeCounterList=[],this.videoState=yl.VideoStateStopped}initVideoElement(){if(this.videoElementStatus=is.INIT,!this.videoElementCheckInterval&&(y3.forEach(_=>{this.videoElement.addEventListener(_,this.handleVideoEvents)}),this.videoElementCheckInterval=window.setInterval(()=>{(function(_){return _!==document.body&&document.body.contains(_)})(this.videoElement)||(this.videoElementStatus=is.DESTROYED)},1e3),ge("ENABLE_VIDEO_FRAME_CALLBACK"))){var i,a;let _,S=()=>{document.visibilityState==="visible"&&(document.removeEventListener("visibilitychange",S),this.videoElementFreezeTimeout=window.setTimeout(C,ge("VIDEO_FREEZE_DURATION")))},C=()=>{this.videoElementFreezeTimeout=void 0,this.videoState===yl.VideoStateDecoding&&(document.visibilityState==="visible"?this.videoState=yl.VideoStateFrozen:document.addEventListener("visibilitychange",S))},R=(e,t)=>{if(this.videoElementStatus===is.PLAYING){if(this.renderStats?(this.renderStats.renderNum++,this.renderStats.curTs=t.mediaTime):this.renderStats={lastTs:t.mediaTime,curTs:t.mediaTime,lastRenderNum:0,renderNum:0},_){let l=t.presentationTime-_.presentationTime;this.videoState===yl.VideoStateStarting&&(this.videoState=yl.VideoStateDecoding),this.videoState===yl.VideoStateDecoding&&this.onVideoStateChanged&&(this.videoElementFreezeTimeout&&window.clearTimeout(this.videoElementFreezeTimeout),this.videoElementFreezeTimeout=window.setTimeout(C,ge("VIDEO_FREEZE_DURATION"))),l<ge("VIDEO_FREEZE_DURATION")&&this.videoState===yl.VideoStateFrozen&&(this.videoState=yl.VideoStateDecoding),l>ge("VIDEO_FREEZE_DURATION")&&zp.lastVisibleTime>=zp.lastHiddenTime&&_.timestamp>zp.lastVisibleTime&&_.timestamp>zp.lastHiddenTime&&(this.renderFreezeAccTime+=l)}_=ui(ui({},t),{},{timestamp:e})}var r,s;ge("ENABLE_VIDEO_FRAME_CALLBACK")&&((r=(s=this.videoElement).requestVideoFrameCallback)===null||r===void 0||r.call(s,R))};(i=(a=this.videoElement).requestVideoFrameCallback)===null||i===void 0||i.call(a,R)}this.videoElement.controls=!1,this.videoElement.setAttribute("playsinline",""),nI()&&!ge("HIDE_NO_POSTER")&&(this.videoElement.poster="noposter");let c=En();c.name==="Safari"&&Number(c.version)===15||ei()||!this.config.mirror||(this.videoElement.style.transform="rotateY(180deg)"),this.config.fit?this.videoElement.style.objectFit=this.config.fit:this.videoElement.style.objectFit="cover",this.videoElement.setAttribute("muted",""),this.videoElement.muted=!0,this.videoElement.srcObject&&this.videoElement.srcObject instanceof MediaStream?this.videoElement.srcObject.getVideoTracks()[0]!==this.videoTrack&&(this.videoElement.srcObject=this.videoTrack?new MediaStream([this.videoTrack]):null,Ni()&&this.videoElement.load()):(this.videoElement.srcObject=this.videoTrack?new MediaStream([this.videoTrack]):null,Ni()&&this.videoElement.load());let u=this.videoElement.play();u!==void 0&&u.catch(_=>{z.debug("[".concat(this.trackId,"] playback interrupted"),_.toString())})}resetVideoElement(){y3.forEach(i=>{this.videoElement&&this.videoElement.removeEventListener(i,this.handleVideoEvents)}),this.videoElementCheckInterval&&(window.clearInterval(this.videoElementCheckInterval),this.videoElementCheckInterval=void 0),this.videoElementStatus=is.NONE}handleAutoPlayFailed(){let i=a=>{a.preventDefault(),this.videoElement.play().then(()=>{z.debug("[".concat(this.trackId,"] Video element for trackId:").concat(this.trackId," autoplay resumed."))}).catch(c=>{z.error(c)}),this.autoplayFailed=!1,ES()?document.body.removeEventListener("click",i,!0):(document.body.removeEventListener("touchstart",i,!0),document.body.removeEventListener("mousedown",i,!0))};ES()?document.body.addEventListener("click",i,!0):(document.body.addEventListener("touchstart",i,!0),document.body.addEventListener("mousedown",i,!0)),v8()}}let y3=["play","playing","loadeddata","canplay","pause","stalled","suspend","waiting","abort","emptied","ended","timeupdate","error"];class T3 extends kL{constructor(i){super(i),Me(this,"container",void 0),Me(this,"slot",void 0),this.slot=i.element,this.updateConfig(i)}updateConfig(i){this.config=i,this.trackId=i.trackId;let a=i.element;a!==this.slot&&(this.destroy(),this.slot=a),this.createElements()}updateVideoTrack(i){this.videoTrack!==i&&(this.videoTrack=i,this.createElements())}play(i){var a;(a=this.container)!==null&&a!==void 0&&a.contains(this.videoElement)&&super.play(i)}getCurrentFrame(){var i;return(i=this.container)!==null&&i!==void 0&&i.contains(this.videoElement)?super.getCurrentFrame():new ImageData(2,2)}async getCurrentFrameToUint8Array(i){var a;let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;return(a=this.container)!==null&&a!==void 0&&a.contains(this.videoElement)?await super.getCurrentFrameToUint8Array(i,c):await DL(i)}destroy(){if(super.destroy(),this.videoElement.remove(),this.videoElement=document.createElement("video"),this.container){try{this.container.remove(),this.slot.removeChild(this.container)}catch{}this.container=void 0}}createElements(){this.container||(this.container=document.createElement("div")),this.container.id="agora-video-player-".concat(this.trackId),this.container.style.width="100%",this.container.style.height="100%",this.container.style.position="relative",this.container.style.overflow="hidden",this.videoTrack?(this.container.style.backgroundColor="black",ge("KEEP_LAST_FRAME")&&this.isKeepLastFrame&&this.videoElement.paused&&this.resetVideoElement(),this.mountedVideoElement()):this.unmountedVideoElement(),this.slot.appendChild(this.container)}mountedVideoElement(){var i;!this.container||(i=this.container)!==null&&i!==void 0&&i.contains(this.videoElement)||this.container.appendChild(this.videoElement),super.initVideoElement(),this.videoElement.id="video_".concat(this.trackId),this.videoElement.className="agora_video_player",this.videoElement.style.width="100%",this.videoElement.style.height="100%",this.videoElement.style.position="absolute",this.videoElement.style.left="0",this.videoElement.style.top="0"}unmountedVideoElement(){var i;if((i=this.container)!==null&&i!==void 0&&i.contains(this.videoElement)){super.resetVideoElement();try{this.container&&this.container.removeChild(this.videoElement)}catch{}this.videoElement=document.createElement("video")}}resetVideoElement(){var i;(i=this.container)!==null&&i!==void 0&&i.contains(this.videoElement)&&(super.resetVideoElement(),this.cacheVideoElement=this.videoElement,this.videoElement=document.createElement("video"))}getContainerElement(){return this.container}}var b3,C3,_s,ji,t1,R8,Sa,I8,w3,R3,xL,I3,A3,O3,N3,L3,D3,P3,M3,k3,x3,U3,j3,V3,Hn,B3,F3,G3,z3,H3,W3,Y3,K3,Il;let ni=(b3=$t({argsMap:(n,i,a)=>[n.getTrackId(),typeof i=="string"?i:i instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement",a]}),C3=Xi(),_s=$t({argsMap:n=>[n.getTrackId()]}),ji=Dg("LocalVideoTrack","_enabledMutex"),t1=$t({argsMap:(n,i)=>[n.getTrackId(),i]}),R8=Xi(),Sa=Dg("LocalVideoTrack","_enabledMutex"),I8=$t({argsMap:(n,i)=>[n.getTrackId(),i]}),w3=Xi(),R3=$t({argsMap:(n,i)=>[n.getTrackId(),i]}),xL=Xi(),I3=Xi(),A3=$t({argsMap:(n,i,a)=>[n.getTrackId(),i,a]}),O3=Xi(),N3=Xi(),L3=Xi(),D3=Xi(),P3=Xi(),M3=Xi(),k3=Xi(),x3=$t({argsMap:(n,i)=>[n.getTrackId(),i.name]}),U3=$t({argsMap:n=>[n.getTrackId()]}),j3=$t({argsMap:n=>[n.getTrackId()]}),V3=$t({argsMap:(n,i,a)=>[n.getTrackId(),i.label,a]}),Hn=class ide extends yo{get videoHeight(){if(mr()){let{height:i}=this._mediaStreamTrack.getSettings();return this._videoHeight=i,this._videoHeight}return this._videoHeight}get videoWidth(){if(mr()){let{width:i}=this._mediaStreamTrack.getSettings();return this._videoWidth=i,this._videoWidth}return this._videoWidth}get isPlaying(){return!(!this._player||this._player.videoElementStatus!==is.PLAYING)}get processorDestination(){return this._processorDestination}get processorContext(){return this._processorContext}set processorContext(i){this._processorContext=i}get __className__(){return"LocalVideoTrack"}constructor(i,a,c,u,_,S){if(super(i,_),Me(this,"trackMediaType",Jb.VIDEO),Me(this,"_player",void 0),Me(this,"isUseScaleResolutionDownBy",!1),Me(this,"_videoVisibleTimer",null),Me(this,"_previousVideoVisibleStatus",void 0),Me(this,"_clearPreviousVideoVisibleStatus",()=>this._previousVideoVisibleStatus=void 0),Me(this,"_encoderConfig",void 0),Me(this,"_scalabilityMode",{numSpatialLayers:1,numTemporalLayers:1}),Me(this,"_optimizationMode",void 0),Me(this,"_videoHeight",void 0),Me(this,"_videoWidth",void 0),Me(this,"_forceBitrateLimit",void 0),Me(this,"_enabled",!0),Me(this,"_processorDestination",void 0),Me(this,"_processorContext",void 0),mr()){let{width:C,height:R}=i.getSettings();this._videoWidth=C,this._videoHeight=R}else this.updateMediaStreamTrackResolution();if(this._encoderConfig=a,this._scalabilityMode=c,this._optimizationMode=u,this._hints=S||[],this._hints.indexOf(kr.SCREEN_TRACK)===-1)this.updateBitrateFromProfile();else if(fL(cr.CHROME,115)&&N_().indexOf("Windows")!==-1){let C=function(R,e){if("VideoFrame"in window&&"TransformStream"in window&&Un().supportWebRTCInsertableStream){let t=new MediaStreamTrackProcessor(R),r=new MediaStreamTrackGenerator({kind:"video"}),s,l,f=Date.now(),m=()=>{E&&(clearInterval(E),E=void 0),s&&(s.close(),s=void 0),R.stop(),l=void 0,r.removeEventListener("ended",m)},E=window.setInterval(()=>{if(l&&s&&Date.now()-f>1e3)try{r.readyState==="live"?l.enqueue(s.clone()):m()}catch{m()}},1e3),y=new TransformStream({transform:(b,A)=>{r.readyState==="live"?(l=A,f=Date.now(),s===void 0?(s=b,A.enqueue(b.clone())):(A.enqueue(s),s=b)):b.close()}});return r.addEventListener("ended",m),t.readable.pipeThrough(y).pipeTo(r.writable),r}}(i);C&&(z.info("local screen video track begin to inject frame"),this._mediaStreamTrack=C)}a&&this._hints.indexOf(kr.CUSTOM_TRACK)!==-1&&this.setEncoderConfiguration(a),this._processorContext=new S8(this.getTrackId(),"local"),this._processorDestination=new wl(this.processorContext),this.bindProcessorDestinationEvents()}play(i){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(typeof i=="string"){let u=document.getElementById(i);u?i=u:(z.warning("[".concat(this.getTrackId(),'] can not find "#').concat(i,'" element, use document.body')),i=document.body)}z.debug("[".concat(this.getTrackId(),"] start video playback in ").concat(i instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement"),JSON.stringify(a));let c=ui(ui(ui({},this._getDefaultPlayerConfig()),a),{},{trackId:this.getTrackId(),element:i});this._player?this._player.updateConfig(c):(i instanceof HTMLVideoElement?this._player=new kL(c):this._player=new T3(c),this._player.updateVideoTrack(this._mediaStreamTrack)),this._player.play(),this._videoVisibleTimer&&window.clearInterval(this._videoVisibleTimer),this._clearPreviousVideoVisibleStatus(),this._videoVisibleTimer=window.setInterval(()=>{try{let u=this.getVideoElementVisibleStatus();this.safeEmit(x_.VIDEO_ELEMENT_VISIBLE_STATUS,u)}catch{}},ge("CHECK_VIDEO_VISIBLE_INTERVAL"))}stop(){this._player&&(this._videoVisibleTimer&&(window.clearInterval(this._videoVisibleTimer),this._videoVisibleTimer=null),this._clearPreviousVideoVisibleStatus(),this._player.destroy(),this._player=void 0,z.debug("[".concat(this.getTrackId(),"] stop video playback")))}async setEnabled(i,a){if(!a){if(i===this._enabled)return;this.stateCheck("enabled",i)}if(z.info("[".concat(this.getTrackId(),"] start setEnabled"),i),!i){this._originMediaStreamTrack.enabled=!1;try{await Vr(this,bt.NEED_DISABLE_TRACK,this)}catch(c){throw z.error("[".concat(this.getTrackId(),"] setEnabled to false error"),c.toString()),c}return a||(this._enabled=!1),void z.info("[".concat(this.getTrackId(),"] setEnabled to false success"))}this._originMediaStreamTrack.enabled=!0;try{await Vr(this,bt.NEED_ENABLE_TRACK,this)}catch(c){throw z.error("[".concat(this.getTrackId(),"] setEnabled to true error"),c.toString()),c}z.info("[".concat(this.getTrackId(),"] setEnabled to true success")),a||(this._enabled=!0)}async setMuted(i){i!==this._muted&&(this.stateCheck("muted",i),this._muted=i,this._originMediaStreamTrack.enabled=!i,z.debug("[".concat(this.getTrackId(),"] start set muted: ").concat(i)),i?await Vr(this,bt.NEED_MUTE_TRACK,this):await Vr(this,bt.NEED_UNMUTE_TRACK,this))}async setEncoderConfiguration(i,a){if(!this._enabled)throw new Ye(oe.TRACK_IS_DISABLED,"can not set encoder configuration when track is disabled");if(i=zi(i),this._forceBitrateLimit&&(i.bitrateMax=this._forceBitrateLimit.max_bitrate?this._forceBitrateLimit.max_bitrate:i.bitrateMax,i.bitrateMin=this._forceBitrateLimit.min_bitrate?this._forceBitrateLimit.min_bitrate:i.bitrateMin),i.width||i.height||i.frameRate){let c=hI({encoderConfig:i});(mr()||Ea()||Jd())&&(c.deviceId=void 0),z.debug("[".concat(this.getTrackId(),"] setEncoderConfiguration applyConstraints"),JSON.stringify(i),JSON.stringify(c));try{await this._originMediaStreamTrack.applyConstraints(c),this.updateMediaStreamTrackResolution()}catch(u){let _=new Ye(oe.UNEXPECTED_ERROR,u.toString());throw z.error("[".concat(this.getTrackId(),"] applyConstraints error"),_.toString()),_}}this._encoderConfig=i,this._hints.indexOf(kr.SCREEN_TRACK)===-1&&this.updateBitrateFromProfile();try{await Vr(this,bt.NEED_UPDATE_VIDEO_ENCODER,this)}catch(c){return c.throw(z)}}getStats(){return la(()=>{z.warning("[deprecated] LocalVideoTrack.getStats will be removed in the future, use AgoraRTCClient.getLocalVideoStats instead")},"localVideoTrackGetStatsWarning"),ed(this,bt.GET_STATS)||ui({},OL)}async setBeautyEffect(i){z.error("LocalVideoTrack.setBeautyEffect was deprecated, please migrate to agora-extension-beauty-effect")}getCurrentFrameData(){return this._player?this._player.getCurrentFrame():new ImageData(2,2)}async getCurrentFrameImage(i){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;return this._player?this._player.getCurrentFrameToUint8Array(i,a):await DL(i)}async setBitrateLimit(i){z.debug("[".concat(this.getTrackId(),"] set bitrate limit, ").concat(JSON.stringify(i))),i&&(this._forceBitrateLimit=i,this._encoderConfig&&(this._encoderConfig.bitrateMax?this._encoderConfig.bitrateMax=this._encoderConfig.bitrateMax<i.max_bitrate?this._encoderConfig.bitrateMax:i.max_bitrate:this._encoderConfig.bitrateMax=i.max_bitrate,this._encoderConfig.bitrateMin,this._encoderConfig.bitrateMin=i.min_bitrate))}async setOptimizationMode(i){if(i!=="motion"&&i!=="detail"&&i!=="balanced")return void z.error(oe.INVALID_PARAMS,"optimization mode must be motion, detail or balanced");let a=this._optimizationMode;try{this._optimizationMode=i,await Vr(this,bt.NEED_UPDATE_VIDEO_SEND_PARAMETERS,this)}catch(c){throw this._optimizationMode=a,z.error("[".concat(this.getTrackId(),"] set optimization mode failed"),c.toString()),c}z.info("[".concat(this.getTrackId(),"] set optimization mode success (").concat(i,")"))}setScalabiltyMode(i){if(i.numSpatialLayers===1&&i.numTemporalLayers!==1)return z.error(oe.INVALID_PARAMS,"scalability mode currently not supported, no SVC."),void(this._scalabilityMode={numSpatialLayers:1,numTemporalLayers:1});this._scalabilityMode=i,z.info("[".concat(this.getTrackId(),"] set scalability mode success (").concat(i,")"))}updateMediaStreamTrackResolution(){Rl(this._originMediaStreamTrack).then(i=>{let[a,c]=i;this._videoHeight=c,this._videoWidth=a}).catch(ph)}_updatePlayerSource(){this._player&&this._player.updateVideoTrack(this._mediaStreamTrack)}_getDefaultPlayerConfig(){return{fit:"contain"}}async setSenderConfiguration(i){if(!this._enabled)throw new Ye(oe.TRACK_IS_DISABLED,"can not set encoder configuration when track is disabled");z.debug("[".concat(this.getTrackId(),"] setSenderConfiguration applyConstraints"),JSON.stringify(i)),i=zi(i),this._forceBitrateLimit&&(i.bitrateMax=this._forceBitrateLimit.max_bitrate?this._forceBitrateLimit.max_bitrate:i.bitrateMax,i.bitrateMin=this._forceBitrateLimit.min_bitrate?this._forceBitrateLimit.min_bitrate:i.bitrateMin),this._encoderConfig=i,this._hints.indexOf(kr.SCREEN_TRACK)===-1&&this.updateBitrateFromProfile();try{await Vr(this,bt.NEED_UPDATE_VIDEO_ENCODER,this)}catch(a){return a.throw(z)}}updateBitrateFromProfile(){if(!this._encoderConfig)return;let{width:i,height:a,frameRate:c}=this.getMediaStreamTrackSettings();if(!i||!a||!c)return;let{bitrateMax:u,bitrateMin:_}=this._encoderConfig;if(_==null||u==null){let{max:S,min:C}=function(R,e,t,r,s){let l=ge("BITRATE_ADAPTER_TYPE");if(l==="DEFAULT_BITRATE")return{min:r,max:s};if(s===void 0){var f;let E=Math.floor(200*Math.pow(t/15,.6)*Math.pow(R*e/640/360,.75));s=l==="STANDARD_BITRATE"?4*E:2*E,r=(f=r)!==null&&f!==void 0?f:E}else{var m;r=(m=r)!==null&&m!==void 0?m:Math.floor(s/10)}return{min:r,max:s}}(i,a,c,_,u);this._encoderConfig.bitrateMin=C,this._encoderConfig.bitrateMax=S,z.debug("[".concat(this.getTrackId(),"] update bitrate from profile, [w: ").concat(i,", h: ").concat(a,", fps: ").concat(c,"] => [brMax: ").concat(S,", brMin: ").concat(C,"]"))}}getVideoElementVisibleStatus(){try{var i,a;let c=this==null||(i=this._player)===null||i===void 0?void 0:i.getContainerElement(),u={track:this,element:this==null||(a=this._player)===null||a===void 0?void 0:a.getVideoElement(),slot:c==null?void 0:c.parentElement},{element:_,slot:S}=u;if(this.isPlaying&&_ instanceof HTMLVideoElement&&S instanceof HTMLElement){let C=Ke.checkOneElementVisible(_),R=Object.assign({},C);if(R.visible!==this._previousVideoVisibleStatus){this._previousVideoVisibleStatus=R.visible;let e=jt.reportApiInvoke(null,{tag:Li.TRACER,name:bn.LOCAL_VIDEO_TRACK_GET_VIDEO_VISIBLE,options:[this.getTrackId()]});R.visible?e.onSuccess("Video is visible"):e.onSuccess("Invisible because of ".concat(R.reason))}return R}return}catch(c){throw new Ye(oe.GET_VIDEO_ELEMENT_VISIBLE_ERROR,c.message)}}async renewMediaStreamTrack(i){}pipe(i){if(this.processor===i)return i;if(i._source)throw new Ye(oe.INVALID_OPERATION,"Processor ".concat(i.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=i,this.processor._source=this,i.updateInput({track:this._originMediaStreamTrack,context:this.processorContext}),i}unpipe(){if(!this.processor)return;let i=this.processor;this.processor._source=void 0,this.processor=void 0,i.reset()}close(){super.close(),this.unbindProcessorDestinationEvents(),this.unbindProcessorContextEvents(),this.unpipe(),this.processorDestination._source&&this.processorDestination._source.unpipe()}clone(i){let a=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],c=this._encoderConfig;i&&(c=ui(ui({},c),zi(i))),c=Fs(c);let u=gr(8,"track-video-cloned-"),_=new ide(a?this._mediaStreamTrack.clone():this._mediaStreamTrack,c,Fs(this._scalabilityMode),this._optimizationMode,u,Fs(this._hints));return i&&c&&_.setEncoderConfiguration(c),z.debug("clone video track from ".concat(this.getTrackId()," to ").concat(u,", clone ").concat(a)),_}async replaceTrack(i,a){if(!(i instanceof MediaStreamTrack))throw new Ye(oe.INVALID_PARAMS,"track should be an instance of MediaStreamTrack");if(i.kind!=="video")throw new Ye(oe.INVALID_PARAMS,"track should be a video MediaStreamTrack");await this._updateOriginMediaStreamTrack(i,a,!0),this.updateMediaStreamTrackResolution()}sendSeiData(i){if(la(()=>{jt.reportApiInvoke(null,{name:bn.LOCAL_VIDEO_SEND_SEI_DATA,options:[],tag:Li.TRACER}).onSuccess("")},this._mediaStreamTrack.id||this.getTrackId()),!ge("ENABLE_VIDEO_SEI")||!ge("ENABLE_ENCODED_TRANSFORM"))return void z.warning('To send/receive SEI, please call AgoraRTC.setParameter("ENABLE_VIDEO_SEI", true) before instantiate IAgoraRtcClient');if(i instanceof Uint8Array==0)return new Ye(oe.INVALID_PARAMS,"Invalid argument type, ILocalVideoTrack.sendSeiData() only accept Uint8Array argument.").throw();let a=this.getRTCRtpTransceiver();if(!a)return void z.warning("Video track is not published, SEI can not be send");let c=a.sender.getParameters();if(c.codecs.length===0)return;let u=c.codecs[0].mimeType.toLocaleLowerCase();u==="video/h264"?this.safeEmit("sei-to-send",i):z.warning("SEI is not supported by ".concat(u))}bindProcessorDestinationEvents(){this.processorDestination.on(Fo.ON_TRACK,async i=>{i?i!==this._mediaStreamTrack&&(this._mediaStreamTrack=i,this._updatePlayerSource(),await Vr(this,bt.NEED_REPLACE_TRACK,this)):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await Vr(this,bt.NEED_REPLACE_TRACK,this))})}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(Fo.ON_TRACK)}unbindProcessorContextEvents(){this.processorContext.removeAllListeners(nd.REQUEST_UPDATE_CONSTRAINTS),this.processorContext.removeAllListeners(nd.REQUEST_CONSTRAINTS)}},Xn(Hn.prototype,"play",[b3,C3],Object.getOwnPropertyDescriptor(Hn.prototype,"play"),Hn.prototype),Xn(Hn.prototype,"stop",[_s],Object.getOwnPropertyDescriptor(Hn.prototype,"stop"),Hn.prototype),Xn(Hn.prototype,"setEnabled",[ji,t1,R8],Object.getOwnPropertyDescriptor(Hn.prototype,"setEnabled"),Hn.prototype),Xn(Hn.prototype,"setMuted",[Sa,I8,w3],Object.getOwnPropertyDescriptor(Hn.prototype,"setMuted"),Hn.prototype),Xn(Hn.prototype,"setEncoderConfiguration",[R3,xL],Object.getOwnPropertyDescriptor(Hn.prototype,"setEncoderConfiguration"),Hn.prototype),Xn(Hn.prototype,"getStats",[I3],Object.getOwnPropertyDescriptor(Hn.prototype,"getStats"),Hn.prototype),Xn(Hn.prototype,"setBeautyEffect",[A3,O3],Object.getOwnPropertyDescriptor(Hn.prototype,"setBeautyEffect"),Hn.prototype),Xn(Hn.prototype,"getCurrentFrameData",[N3],Object.getOwnPropertyDescriptor(Hn.prototype,"getCurrentFrameData"),Hn.prototype),Xn(Hn.prototype,"getCurrentFrameImage",[L3],Object.getOwnPropertyDescriptor(Hn.prototype,"getCurrentFrameImage"),Hn.prototype),Xn(Hn.prototype,"setBitrateLimit",[D3],Object.getOwnPropertyDescriptor(Hn.prototype,"setBitrateLimit"),Hn.prototype),Xn(Hn.prototype,"setOptimizationMode",[P3],Object.getOwnPropertyDescriptor(Hn.prototype,"setOptimizationMode"),Hn.prototype),Xn(Hn.prototype,"setScalabiltyMode",[M3],Object.getOwnPropertyDescriptor(Hn.prototype,"setScalabiltyMode"),Hn.prototype),Xn(Hn.prototype,"updateMediaStreamTrackResolution",[k3],Object.getOwnPropertyDescriptor(Hn.prototype,"updateMediaStreamTrackResolution"),Hn.prototype),Xn(Hn.prototype,"pipe",[x3],Object.getOwnPropertyDescriptor(Hn.prototype,"pipe"),Hn.prototype),Xn(Hn.prototype,"unpipe",[U3],Object.getOwnPropertyDescriptor(Hn.prototype,"unpipe"),Hn.prototype),Xn(Hn.prototype,"close",[j3],Object.getOwnPropertyDescriptor(Hn.prototype,"close"),Hn.prototype),Xn(Hn.prototype,"replaceTrack",[V3],Object.getOwnPropertyDescriptor(Hn.prototype,"replaceTrack"),Hn.prototype),Hn),UL=(B3=$t({argsMap:(n,i)=>[n.getTrackId(),i]}),F3=Xi(),G3=Dg("CameraVideoTrack","_enabledMutex"),z3=$t({argsMap:(n,i)=>[n.getTrackId(),i]}),H3=Xi(),W3=$t({argsMap:(n,i)=>[n.getTrackId(),i]}),Y3=Xi(),K3=$t({argsMap:n=>[n.getTrackId()]}),Il=class ade extends ni{get __className__(){return"CameraVideoTrack"}constructor(i,a,c,u,_,S){super(i,zi(a.encoderConfig),u,_,S),Me(this,"_config",void 0),Me(this,"_originalConstraints",void 0),Me(this,"_constraints",void 0),Me(this,"_enabled",!0),Me(this,"_deviceName","default"),Me(this,"tryResumeVideoForIOS15_16WeChat",async()=>{(ei()||to())&&!function(){let C=En();if(C.os!==Ra.IOS||!C.osVersion)return!1;let R=C.osVersion.split(".");return Number(R[0])===15&&Number(R[1])>=2}()&&hL()&&this._enabled&&!this._isClosed&&(z.debug("[".concat(this.getTrackId(),"] try capture camera media device for interrupted iOS 15 device on WeChat.")),await this.renewMediaStreamTrack())}),this._config=a,this._originalConstraints=c,this._constraints=c,this._deviceName=i.label,this._encoderConfig=zi(this._config.encoderConfig),Tn.on(ms.IOS_15_16_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat),Tn.on(ms.IOS_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat),this.bindProcessorContextEvents()}async setDevice(i){return typeof i=="string"?this._setDeviceById(i):i.deviceId?this._setDeviceById(i.deviceId):i.facingMode?this._setDeviceByFacingModel(i.facingMode):void 0}async _setDeviceById(i){if(z.info("[".concat(this.getTrackId(),"] set device to ").concat(i)),this._enabled)try{let a=await bl.getDeviceById(i),c={};c.video=ui({},this._constraints),c.video.deviceId={exact:i},c.video.facingMode=void 0,this._originMediaStreamTrack.stop();let u=null;try{u=await ro(c,this.getTrackId())}catch(_){throw z.error("[".concat(this.getTrackId(),"] setDevice failed"),_.toString()),u=await ro({video:this._constraints},this.getTrackId()),await this._updateOriginMediaStreamTrack(u.getVideoTracks()[0],!1),_}await this._updateOriginMediaStreamTrack(u.getVideoTracks()[0],!1),this.updateMediaStreamTrackResolution(),this._deviceName=a.label,this._config.cameraId=i,this._constraints.deviceId={exact:i}}catch(a){throw z.error("[".concat(this.getTrackId(),"] setDevice error"),a.toString()),a}else try{let a=await bl.getDeviceById(i);this._deviceName=a.label,this._config.cameraId=i,this._constraints.deviceId={exact:i}}catch(a){throw z.error("[".concat(this.getTrackId(),"] setDevice error"),a.toString()),a}z.info("[".concat(this.getTrackId(),"] setDevice success"))}async _setDeviceByFacingModel(i){z.info("[".concat(this.getTrackId(),"] set facingMode ").concat(i));let a={video:ui(ui({},this._constraints),{},{deviceId:void 0,facingMode:{exact:i}})};if(this._enabled){this._originMediaStreamTrack.stop();let c=null;try{c=await ro(a,this.getTrackId())}catch(u){throw z.error("[".concat(this.getTrackId(),"] setDeviceByFacingModel failed"),u.toString()),c=await ro({video:this._constraints},this.getTrackId()),await this._updateOriginMediaStreamTrack(c.getVideoTracks()[0],!1),u}await this._updateOriginMediaStreamTrack(c.getVideoTracks()[0],!1),this.updateMediaStreamTrackResolution()}this._deviceName="",this._config.facingMode=i,this._config.cameraId=void 0,this._constraints=ui({},a.video),z.info("[".concat(this.getTrackId(),"] setDeviceByFacingModel success"))}async setEnabled(i,a){if(!a){if(i===this._enabled)return;this.stateCheck("enabled",i)}if(z.info("[".concat(this.getTrackId(),"] start setEnabled"),i),i){try{if(this.isExternalTrack)this._originMediaStreamTrack.enabled=!0;else{let c=await ro({video:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(c.getVideoTracks()[0],!1)}await Vr(this,bt.NEED_ENABLE_TRACK,this)}catch(c){throw z.error("[".concat(this.getTrackId(),"] setEnabled true error"),c.toString()),c}this.updateMediaStreamTrackResolution(),z.info("[".concat(this.getTrackId(),"] setEnabled to true success")),a||(this._enabled=!0)}else{this.isExternalTrack?this._originMediaStreamTrack.enabled=!1:(this._originMediaStreamTrack.onended=null,this._originMediaStreamTrack.stop()),a||(this._enabled=!1);try{await Vr(this,bt.NEED_DISABLE_TRACK,this)}catch(c){throw z.error("[".concat(this.getTrackId(),"] setEnabled to false error"),c.toString()),c}z.info("[".concat(this.getTrackId(),"] setEnabled to false success"))}}async setEncoderConfiguration(i,a){if(!this._enabled)throw new Ye(oe.TRACK_IS_DISABLED,"can not set encoder configuration when track is disabled");i=zi(i),this._forceBitrateLimit&&(i.bitrateMax=this._forceBitrateLimit.max_bitrate||i.bitrateMax,i.bitrateMin=this._forceBitrateLimit.min_bitrate||i.bitrateMin);let c=Fn(this._config);c.encoderConfig=i;let u=hI(c);(mr()||Ea()||Jd())&&(u.deviceId=void 0),z.debug("[".concat(this.getTrackId(),"] setEncoderConfiguration applyConstraints"),JSON.stringify(i),JSON.stringify(u));try{await this._originMediaStreamTrack.applyConstraints(u),this.updateMediaStreamTrackResolution()}catch(_){let S=new Ye(oe.UNEXPECTED_ERROR,_.toString());throw z.error("[".concat(this.getTrackId(),"] applyConstraints error"),S.toString()),S}this._config=c,this._constraints=u,this._originalConstraints=u,this._encoderConfig=i,this._hints.indexOf(kr.SCREEN_TRACK)===-1&&this.updateBitrateFromProfile();try{await Vr(this,bt.NEED_UPDATE_VIDEO_ENCODER,this)}catch(_){return _.throw(z)}}_getDefaultPlayerConfig(){return{mirror:!0,fit:"cover"}}onTrackEnded(){if((Ea()||Jd())&&this._enabled&&!this._isClosed&&Tn.duringInterruption){let i=async()=>{Tn.off(ms.IOS_INTERRUPTION_END,i),this._enabled&&!this._isClosed&&(z.debug("[".concat(this.getTrackId(),"] try capture camera media device for interrupted iOS device.")),await this.setEnabled(!1),await this.setEnabled(!0))};Tn.on(ms.IOS_INTERRUPTION_END,i)}else z.debug("[".concat(this.getTrackId(),"] track ended")),this.safeEmit(x_.TRACK_ENDED)}async renewMediaStreamTrack(i){let a=i||this._constraints,c=bl.searchDeviceIdByName(this._deviceName);if(c&&!a.deviceId&&(a.deviceId={exact:c}),this._enabled){let u=await ro({video:a},this.getTrackId());this._constraints=a,await this._updateOriginMediaStreamTrack(u.getVideoTracks()[0],!0),this.updateMediaStreamTrackResolution()}}close(){super.close(),Tn.off(ms.IOS_15_16_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat),Tn.off(ms.IOS_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat)}clone(i){let a=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],c=this._encoderConfig;i&&(c=ui(ui({},c),zi(i))),c=Fs(c);let u=gr(8,"track-cam-cloned-"),_=new ade(a?this._mediaStreamTrack.clone():this._mediaStreamTrack,Fs(ui(ui({},this._config),{},{encoderConfig:c})),Fs(this._constraints),Fs(this._scalabilityMode),this._optimizationMode,u);return i&&c&&_.setEncoderConfiguration(c),z.debug("clone track from ".concat(this.getTrackId()," to ").concat(u,", clone ").concat(a)),_}bindProcessorContextEvents(){this.processorContext.on(nd.REQUEST_UPDATE_CONSTRAINTS,async(i,a,c)=>{try{let u=Object.assign({},this._originalConstraints,...i);await this.renewMediaStreamTrack(u),a()}catch(u){c(u)}}),this.processorContext.on(nd.REQUEST_CONSTRAINTS,async i=>{i(this._originMediaStreamTrack.getSettings())})}},Xn(Il.prototype,"setDevice",[B3,F3],Object.getOwnPropertyDescriptor(Il.prototype,"setDevice"),Il.prototype),Xn(Il.prototype,"setEnabled",[G3,z3,H3],Object.getOwnPropertyDescriptor(Il.prototype,"setEnabled"),Il.prototype),Xn(Il.prototype,"setEncoderConfiguration",[W3,Y3],Object.getOwnPropertyDescriptor(Il.prototype,"setEncoderConfiguration"),Il.prototype),Xn(Il.prototype,"close",[K3],Object.getOwnPropertyDescriptor(Il.prototype,"close"),Il.prototype),Il);function jL(n,i,a,c){a.optimizationMode&&(c&&c.width&&c.height?(a.encoderConfig=ui(ui({},c),{},{bitrateMin:c.bitrateMin,bitrateMax:c.bitrateMax}),a.optimizationMode!=="motion"&&a.optimizationMode!=="detail"||(i.contentHint=a.optimizationMode,i.contentHint===a.optimizationMode?z.debug("[".concat(n,"] set content hint to"),a.optimizationMode):z.debug("[".concat(n,"] set content hint failed")))):z.warning("[".concat(n,"] can not apply optimization mode bitrate config, no encoderConfig")))}var q3,J3,Pn,X3,rd,Q3,Z3,$3,eU,tU,nU,Wi;class Kr extends So{getUserId(){return this._userId}constructor(i,a,c,u){super(i,"track-".concat(i.kind,"-").concat(a,"-").concat(u.clientId,"_").concat(gr(5,""))),Me(this,"_userId",void 0),Me(this,"_uintId",void 0),Me(this,"_isDestroyed",!1),Me(this,"store",void 0),Me(this,"processor",void 0),Me(this,"processorContext",void 0),this._userId=a,this._uintId=c,this.store=u}_updateOriginMediaStreamTrack(i){this._originMediaStreamTrack=i,this._mediaStreamTrack=i,this._updatePlayerSource(),this.processor&&this.processor.updateInput({track:this._originMediaStreamTrack,context:this.processorContext})}_destroy(){this._isDestroyed=!0,z.info("[".concat(this.getTrackId(),"] is destroyed")),this.stop(),super.close()}getProcessorStats(){return this.processorContext.gatherStats()}getProcessorUsage(){return this.processorContext.gatherUsage()}}let j_=(q3=$t({argsMap:(n,i,a)=>[n.getTrackId(),typeof i=="string"?i:i instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement",a]}),J3=$t({argsMap:n=>[n.getTrackId()]}),Pn=$t({argsMap:(n,i)=>[n.getTrackId(),i.name]}),X3=$t({argsMap:n=>[n.getTrackId()]}),Xn((rd=class extends Kr{get isPlaying(){return!(!this._player||this._player.videoElementStatus!==is.PLAYING)}get __className__(){return"RemoteVideoTrack"}constructor(n,i,a,c){super(n,i,a,c),Me(this,"_videoVisibleTimer",null),Me(this,"_previousVideoVisibleStatus",void 0),Me(this,"_clearPreviousVideoVisibleStatus",()=>this._previousVideoVisibleStatus=void 0),Me(this,"trackMediaType",Jb.VIDEO),Me(this,"_videoWidth",void 0),Me(this,"_videoHeight",void 0),Me(this,"_player",void 0),Me(this,"processorDestination",void 0),Me(this,"processorContext",void 0),this.updateMediaStreamTrackResolution(),this.processorContext=new S8(this.getTrackId(),"remote"),this.processorDestination=new wl(this.processorContext),this.bindProcessorDestinationEvents()}getStats(){return la(()=>{z.warning("[deprecated] RemoteVideoTrack.getStats will be removed in the future, use AgoraRTCClient.getRemoteVideoStats instead")},"remoteVideoTrackGetStatsWarning"),ed(this,bt.GET_STATS)||ui({},wS)}play(n){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(typeof n=="string"){let c=document.getElementById(n);c?n=c:(z.warning("[".concat(this.getTrackId(),'] can not find "#').concat(n,'" element, use document.body')),n=document.body)}z.debug("[".concat(this.getTrackId(),"] start video playback in ").concat(n instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement"),JSON.stringify(i));let a=ui(ui({fit:"cover"},i),{},{trackId:this.getTrackId(),element:n});this._player?this._player.updateConfig(a):(n instanceof HTMLVideoElement?this._player=new kL(a):this._player=new T3(a),this._player.updateVideoTrack(this._mediaStreamTrack),this._player.onFirstVideoFrameDecoded=()=>{this.store.subscribe(this.getUserId(),"video",void 0,void 0,Date.now()),this.safeEmit(Mg.FIRST_FRAME_DECODED)},this._player.onVideoStateChanged=c=>{this.safeEmit(Mg.VIDEO_STATE_CHANGED,c)}),this._player.play(this.store.sessionId||void 0),this._videoVisibleTimer&&window.clearInterval(this._videoVisibleTimer),this._clearPreviousVideoVisibleStatus(),this._videoVisibleTimer=window.setInterval(()=>{try{let c=this.getVideoElementVisibleStatus();this.safeEmit(Mg.VIDEO_ELEMENT_VISIBLE_STATUS,c)}catch{}},ge("CHECK_VIDEO_VISIBLE_INTERVAL"))}stop(){this._player&&(this._videoVisibleTimer&&(window.clearInterval(this._videoVisibleTimer),this._videoVisibleTimer=null),this._clearPreviousVideoVisibleStatus(),this._player.destroy(),this._player=void 0,z.debug("[".concat(this.getTrackId(),"] stop video playback")))}getCurrentFrameData(){return this._player?this._player.getCurrentFrame():new ImageData(2,2)}updateMediaStreamTrackResolution(){Rl(this._originMediaStreamTrack).then(n=>{let[i,a]=n;this._videoHeight=a,this._videoWidth=i}).catch(ph)}_updatePlayerSource(){z.debug("[".concat(this.getTrackId(),"] update player source track")),this._player&&this._player.updateVideoTrack(this._mediaStreamTrack)}getVideoElementVisibleStatus(){try{var n,i;let a=this==null||(n=this._player)===null||n===void 0?void 0:n.getContainerElement(),c={track:this,element:this==null||(i=this._player)===null||i===void 0?void 0:i.getVideoElement(),slot:a==null?void 0:a.parentElement},{element:u,slot:_}=c;if(this.isPlaying&&u instanceof HTMLVideoElement&&_ instanceof HTMLElement){let S=Ke.checkOneElementVisible(u),C=Object.assign({},S);if(C.visible!==this._previousVideoVisibleStatus){this._previousVideoVisibleStatus=C.visible;let R=jt.reportApiInvoke(null,{tag:Li.TRACER,name:bn.REMOTE_VIDEO_TRACK_GET_VIDEO_VISIBLE,options:[this.getTrackId()]});C.visible?R.onSuccess("Video is visible"):R.onSuccess("Invisible because of ".concat(C.reason))}return C}return}catch(a){throw new Ye(oe.GET_VIDEO_ELEMENT_VISIBLE_ERROR,a.message)}}pipe(n){if(this.processor===n)return n;if(n._source)throw new Ye(oe.INVALID_OPERATION,"Processor ".concat(n.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=n,this.processor._source=this,n.updateInput({track:this._originMediaStreamTrack,context:this.processorContext}),n}unpipe(){if(!this.processor)return;let n=this.processor;this.processor._source=void 0,this.processor=void 0,n.reset()}bindProcessorDestinationEvents(){this.processorDestination.on(Fo.ON_TRACK,async n=>{n?n!==this._mediaStreamTrack&&(this._mediaStreamTrack=n,this._updatePlayerSource()):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource())})}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(Fo.ON_TRACK)}_destroy(){super._destroy(),this.unbindProcessorDestinationEvents()}_onSei(n){this.emit(Bo.SEI_RECEIVED,n)}}).prototype,"play",[q3],Object.getOwnPropertyDescriptor(rd.prototype,"play"),rd.prototype),Xn(rd.prototype,"stop",[J3],Object.getOwnPropertyDescriptor(rd.prototype,"stop"),rd.prototype),Xn(rd.prototype,"pipe",[Pn],Object.getOwnPropertyDescriptor(rd.prototype,"pipe"),rd.prototype),Xn(rd.prototype,"unpipe",[X3],Object.getOwnPropertyDescriptor(rd.prototype,"unpipe"),rd.prototype),rd),V_=(Q3=$t({argsMap:(n,i)=>[n.getTrackId(),i],throttleTime:300}),Z3=$t({argsMap:(n,i)=>[n.getTrackId(),i]}),$3=$t({argsMap:n=>[n.getTrackId()]}),eU=$t({argsMap:n=>[n.getTrackId()]}),tU=$t({argsMap:(n,i)=>[n.getTrackId(),i.name]}),nU=$t({argsMap:n=>[n.getTrackId()]}),Xn((Wi=class extends Kr{get isPlaying(){return this._useAudioElement?Go.isPlaying(this.getTrackId()):this._source.isPlayed}get __className__(){return"RemoteAudioTrack"}constructor(n,i,a,c){super(n,i,a,c),Me(this,"trackMediaType",Jb.AUDIO),Me(this,"_source",void 0),Me(this,"_useAudioElement",!0),Me(this,"_volume",100),Me(this,"processorContext",void 0),Me(this,"processorDestination",void 0),Me(this,"_played",!1),Me(this,"_bypassWebAudio",!1),ge("DISABLE_WEBAUDIO")?(this._source=new Fc,this._bypassWebAudio=!0,this._useAudioElement=!0):(this._source=new fi(n,!0),ge("REMOTE_AUDIO_TRACK_USES_WEB_AUDIO")&&(this._useAudioElement=!1)),this._source.once(lc.RECEIVE_TRACK_BUFFER,()=>{this.safeEmit(Mg.FIRST_FRAME_DECODED)}),this.processorContext=new AS(this._source.context,this.getTrackId(),"remote"),this.processorDestination=new fI(this.processorContext),this.bindProcessorDestinationEvents(),this._source.on(lc.UPDATE_SOURCE,()=>{this.processor&&this.processor.updateInput({node:this._source.processSourceNode,context:this.processorContext})})}setAudioFrameCallback(n){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4096;if(!n)return this._source.removeAllListeners(lc.ON_AUDIO_BUFFER),void this._source.stopGetAudioBuffer();this._source.startGetAudioBuffer(i),this._source.removeAllListeners(lc.ON_AUDIO_BUFFER),this._source.on(lc.ON_AUDIO_BUFFER,a=>n(a))}setVolume(n){this._volume=n,this._useAudioElement?Go.setVolume(this.getTrackId(),n):this._source.setVolume(n/100)}async setPlaybackDevice(n){if(!this._useAudioElement||!G())throw new Ye(oe.NOT_SUPPORTED,"your browser does not support setting the audio output device");await Go.setSinkID(this.getTrackId(),n)}getVolumeLevel(){return this._source.getAccurateVolumeLevel()}getStats(){return la(()=>{z.warning("[deprecated] RemoteAudioTrack.getStats will be removed in the future, use AgoraRTCClient.getRemoteAudioStats instead")},"remoteAudioTrackGetStatsWarning"),ed(this,bt.GET_STATS)||ui({},Dt)}play(){z.debug("[".concat(this.getTrackId(),"] start audio playback")),this._played=!0,this._useAudioElement?(z.debug("[".concat(this.getTrackId(),"] use audio element to play")),Go.play(this._mediaStreamTrack,this.getTrackId(),this._volume,this.store.sessionId||void 0)):this._source.play()}stop(){z.debug("[".concat(this.getTrackId(),"] stop audio playback")),this._played=!1,this._useAudioElement?Go.stop(this.getTrackId()):this._source.stop()}_destroy(){super._destroy(),this._played=!1,this.unbindProcessorDestinationEvents(),this._source.destroy()}_isFreeze(){return this._source.isFreeze}_updatePlayerSource(){let n=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];z.debug("[".concat(this.getTrackId(),"] update player source track")),n&&this._source.updateTrack(this._mediaStreamTrack),this._useAudioElement&&Go.updateTrack(this.getTrackId(),this._mediaStreamTrack)}pipe(n){if(this._bypassWebAudio)throw new Ye(oe.NOT_SUPPORTED,"can not pipe extension when WebAudio disabled");if(this.processor===n)return n;if(n._source)throw new Ye(oe.INVALID_OPERATION,"Processor ".concat(n.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=n,this.processor._source=this,n.updateInput({track:this._originMediaStreamTrack,node:this._source.processSourceNode,context:this.processorContext}),n}unpipe(){var n;if(this._bypassWebAudio)throw new Ye(oe.NOT_SUPPORTED,"can not unpipe extension when WebAudio disabled");if(!this.processor)return;let i=this.processor;(n=this._source.processSourceNode)===null||n===void 0||n.disconnect(),this.processor._source=!1,this.processor=void 0,i.reset()}bindProcessorDestinationEvents(){this.processorDestination.on(Fo.ON_TRACK,async n=>{n?n!==this._mediaStreamTrack&&(this._mediaStreamTrack=n,this._updatePlayerSource(!1),this._source.processedNode=this._source.createMediaStreamSourceNode(n)):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource())}),this.processorDestination.on(Fo.ON_NODE,n=>{this._source.processedNode=n;let i=!n;this._useAudioElement!==i&&(this._played?(this.stop(),this._useAudioElement=i,this.play()):this._useAudioElement=i)})}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(Fo.ON_TRACK),this.processorDestination.removeAllListeners(Fo.ON_NODE)}}).prototype,"setVolume",[Q3],Object.getOwnPropertyDescriptor(Wi.prototype,"setVolume"),Wi.prototype),Xn(Wi.prototype,"setPlaybackDevice",[Z3],Object.getOwnPropertyDescriptor(Wi.prototype,"setPlaybackDevice"),Wi.prototype),Xn(Wi.prototype,"play",[$3],Object.getOwnPropertyDescriptor(Wi.prototype,"play"),Wi.prototype),Xn(Wi.prototype,"stop",[eU],Object.getOwnPropertyDescriptor(Wi.prototype,"stop"),Wi.prototype),Xn(Wi.prototype,"pipe",[tU],Object.getOwnPropertyDescriptor(Wi.prototype,"pipe"),Wi.prototype),Xn(Wi.prototype,"unpipe",[nU],Object.getOwnPropertyDescriptor(Wi.prototype,"unpipe"),Wi.prototype),Wi),zp=new class extends li{get visibility(){return document.visibilityState}get lastHiddenTime(){return this._lastHiddenTime}get lastVisibleTime(){return this._lastVisibleTime}constructor(){super(),Me(this,"_lastHiddenTime",0),Me(this,"_lastVisibleTime",0),document.addEventListener("visibilitychange",()=>{document.visibilityState==="hidden"?this._lastHiddenTime=performance.now():this._lastVisibleTime=performance.now(),z.debug("current web page is ".concat(document.visibilityState)),this.emit("VISIBILITY_CHANGE",document.visibilityState)})}};class rU extends li{constructor(i,a){super(),Me(this,"trackMediaType",Jb.DATA),Me(this,"_version",1),Me(this,"_type",3),Me(this,"_config",void 0),Me(this,"_originDataChannel",void 0),Me(this,"_dataStreamPacketHeader",new ArrayBuffer(4)),Me(this,"_dataStreamPacketHandler",{serialize:c=>c,deserialize:c=>c}),Me(this,"_datachannelEventMap",new Map),this._config=i,a&&(this._originDataChannel=a,this._bandDataChannelEvents(a)),this._initPacketHeader()}useDataStream(i){this._dataStreamPacketHandler=i}get id(){return this._config.id}get ordered(){return this._config.ordered}get maxRetransmits(){return ge("DATASTREAM_MAX_RETRANSMITS")}get metadata(){return this._config.metadata}get readyState(){var i,a;return(i=(a=this._originDataChannel)===null||a===void 0?void 0:a.readyState)!==null&&i!==void 0?i:"connecting"}get _originDataChannelId(){var i,a;return(i=(a=this._originDataChannel)===null||a===void 0?void 0:a.id)!==null&&i!==void 0?i:null}getChannelId(){return this.id}getConfig(){return this._config}_close(){this._originDataChannel&&(this._unbindDataChannelEvents(this._originDataChannel),this._originDataChannel=void 0)}async _waitTillOpen(){return new Et((i,a)=>{if(this._originDataChannel){this._originDataChannel.readyState==="open"&&i();let c=setTimeout(()=>{var u;a(new Ye(oe.DATACHANNEL_CONNECTION_TIMEOUT,"Cannot create datachannel, id: ".concat((u=this._originDataChannel)===null||u===void 0?void 0:u.id)))},1e4);this._originDataChannel.onopen=()=>{clearTimeout(c),this._originDataChannel&&this._bandDataChannelEvents(this._originDataChannel),i()},this._originDataChannel.onerror=()=>{throw clearTimeout(c),new Ye(oe.DATACHANNEL_CONNECTION_TIMEOUT)}}else a(new Ye(oe.DATACHANNEL_CONNECTION_TIMEOUT,"cannot find dataChannel"))})}_updateOriginDataChannel(i){this._originDataChannel=i,this._bandDataChannelEvents(i)}_initPacketHeader(){let i=new DataView(this._dataStreamPacketHeader);i.setUint16(0,this._version),i.setUint8(2,this._type),i.setUint8(3,this._config.id)}_bandDataChannelEvents(i){this._unbindDataChannelEvents(i),[Xb.OPEN,Xb.CLOSE,Xb.ERROR].forEach(a=>{let c=()=>{this.emit(a)};this._datachannelEventMap.set(a,c),i.addEventListener(a,c)})}_unbindDataChannelEvents(i){Array.from(this._datachannelEventMap.entries()).forEach(a=>{let[c,u]=a;i.removeEventListener(c,u)}),this._datachannelEventMap.clear()}}class A8 extends rU{constructor(i){super(i),Me(this,"_messageListener",void 0),this._messageListener=a=>{if(a.data.byteLength<this._dataStreamPacketHeader.byteLength)throw Error("invalid byteLength: the byte length must exceed "+this._dataStreamPacketHeader.byteLength);let c=a.data.slice(0,this._dataStreamPacketHeader.byteLength),u=new DataView(c).getUint8(3);if(u!==this.id)return void(ge("SHOW_DATASTREAM2_LOG")&&z.debug("invalid datachannel id: ".concat(u," !== ").concat(this.id)));let _=a.data.slice(this._dataStreamPacketHeader.byteLength);_=this._dataStreamPacketHandler.deserialize(_),this.emit(Xb.MESSAGE,_)}}_updateOriginDataChannel(i){super._updateOriginDataChannel(i),this._bandRemoteDataChannelEvents()}_close(){this._originDataChannel&&(this._originDataChannel.removeEventListener("message",this._messageListener),super._close())}_bandRemoteDataChannelEvents(){this._originDataChannel&&this._originDataChannel.addEventListener("message",this._messageListener)}}class O8 extends rU{send(i){if(this._originDataChannel){let a=i;a=this._dataStreamPacketHandler.serialize(i);let c=new Uint8Array(this._dataStreamPacketHeader.byteLength+a.byteLength);c.set(new Uint8Array(this._dataStreamPacketHeader),0),c.set(new Uint8Array(a),this._dataStreamPacketHeader.byteLength),this._originDataChannel.send(c.buffer)}}}function Gc(){let n=new Blob([atob("ZnVuY3Rpb24gdCh0LGUsbil7bGV0IGE9bmV3IFVpbnQ4QXJyYXkodCxlLG4pLG89W10scj0wO2Zvcig7by5sZW5ndGg8bjspciszPG4mJjA9PT1hW3JdJiYwPT09YVtyKzFdJiYzPT09YVtyKzJdJiYoMD09PWFbciszXXx8MT09PWFbciszXXx8Mj09PWFbciszXXx8Mz09PWFbciszXSk/KG8ucHVzaChhW3JdLGFbcisxXSxhW3IrM10pLHIrPTQpOihvLnB1c2goYVtyXSkscisrKTtyZXR1cm4gbmV3IFVpbnQ4QXJyYXkobyl9ZnVuY3Rpb24gZSh0LGUpe2NvbnN0IG49ZnVuY3Rpb24odCl7Y29uc3QgZT10Lmxlbmd0aDtsZXQgbj1bXSxhPTA7Zm9yKDthPGU7KWErMjxlJiYwPT09dFthXSYmMD09PXRbYSsxXSYmKDA9PT10W2ErMl18fDE9PT10W2ErMl18fDI9PT10W2ErMl18fDM9PT10W2ErMl0pPyhuLnB1c2godFthXSx0W2ErMV0sMyx0W2ErMl0pLGErPTMpOihuLnB1c2godFthXSksYSsrKTtyZXR1cm4gbmV3IFVpbnQ4QXJyYXkobil9KGUpLGE9bi5sZW5ndGgsbz1NYXRoLmZsb29yKGEvMjU1KSxyPWElMjU1LHM9bmV3IFVpbnQ4QXJyYXkoNitvKzErYSt0LmJ5dGVMZW5ndGgpO3NbMF09MCxzWzFdPTAsc1syXT0wLHNbM109MSxzWzRdPTYsc1s1XT0xMDE7bGV0IGk9MDtmb3IoO2k8bzspc1s2K2ldPTI1NSxpKys7cmV0dXJuIHNbNitpXT1yLGkrKyxzLnNldChuLDYraSkscy5zZXQobmV3IFVpbnQ4QXJyYXkodCksNitpK2EpLHMuYnVmZmVyfWNvbnN0IG49NzEsYT0xLG89MixyPTEscz0yO3ZhciBpOyFmdW5jdGlvbih0KXt0W3QuQVVESU9fTEVWRUw9MV09IkFVRElPX0xFVkVMIix0W3QuTUVUQURBVEE9Ml09Ik1FVEFEQVRBIix0W3QuQVVESU9fNjRfQklUX1BUUz0zXT0iQVVESU9fNjRfQklUX1BUUyJ9KGl8fChpPXt9KSk7bmF2aWdhdG9yLnVzZXJBZ2VudC5pbmRleE9mKCJTYWZhcmkiKT4tMSYmLTE9PT1uYXZpZ2F0b3IudXNlckFnZW50LmluZGV4T2YoIkNocm9tZSIpJiYoc2VsZi5vbnJ0Y3RyYW5zZm9ybT1mPT57Y29uc3QgdT1mLnRyYW5zZm9ybWVyO2xldCBkPVtdLGw9W107dS5vcHRpb25zLnBvcnQub25tZXNzYWdlPXQ9Pnt0LmRhdGEuc2VpJiZkLnB1c2godC5kYXRhLnNlaSksdC5kYXRhLm1ldGFkYXRhJiZsLnB1c2godC5kYXRhLm1ldGFkYXRhKX0sc2VsZi5wb3N0TWVzc2FnZSgic3RhcnRlZCIpO2NvbnN0IGc9dS5yZWFkYWJsZS5nZXRSZWFkZXIoKSxjPXUud3JpdGFibGUuZ2V0V3JpdGVyKCk7InNlaS1yeCI9PT11Lm9wdGlvbnMubmFtZT9mdW5jdGlvbiBlKG4pe2cucmVhZCgpLnRoZW4oKGE9PntpZighYS5kb25lKXtpZihhLnZhbHVlIGluc3RhbmNlb2YgUlRDRW5jb2RlZFZpZGVvRnJhbWUpe2NvbnN0IGU9ZnVuY3Rpb24oZSl7Y29uc3Qgbj1uZXcgRGF0YVZpZXcoZS5kYXRhKTtsZXQgYT0wO2Zvcig7YSs0PGUuZGF0YS5ieXRlTGVuZ3RoOyl7aWYoMD09PW4uZ2V0VWludDgoYSswKSYmMD09PW4uZ2V0VWludDgoYSsxKSYmMD09PW4uZ2V0VWludDgoYSsyKSYmMT09PW4uZ2V0VWludDgoYSszKSYmNj09PW4uZ2V0VWludDgoYSs0KSl7bGV0IG89YSs2LHI9MCxzPTA7Zm9yKDsyNTU9PT0ocz1uLmdldFVpbnQ4KG8rKykpOylyKz0yNTU7cis9cztjb25zdCBpPXQoZS5kYXRhLG8scik7cmV0dXJuIG5ldyBVaW50OEFycmF5KGkpfWErK31yZXR1cm4gbnVsbH0oYS52YWx1ZSk7ZSYmbi5vcHRpb25zLnBvcnQucG9zdE1lc3NhZ2Uoe3NlaTplfSl9Yy53cml0ZShhLnZhbHVlKSxuLm9wdGlvbnMucG9ydC5wb3N0TWVzc2FnZSh7dHJhbnNmb3JtZWQ6ITB9KSxlKG4pfX0pKX0odSk6InNlaS10eCI9PT11Lm9wdGlvbnMubmFtZT9mdW5jdGlvbiB0KG4pe2cucmVhZCgpLnRoZW4oKGE9PntpZighYS5kb25lKXtpZihhLnZhbHVlIGluc3RhbmNlb2YgUlRDRW5jb2RlZFZpZGVvRnJhbWUpe2NvbnN0IHQ9ZC5zaGlmdCgpO3QmJihhLnZhbHVlLmRhdGE9ZShhLnZhbHVlLmRhdGEsdCkpfWMud3JpdGUoYS52YWx1ZSksbi5vcHRpb25zLnBvcnQucG9zdE1lc3NhZ2Uoe3RyYW5zZm9ybWVkOiEwfSksdChuKX19KSl9KHUpOiJhdWRpby1tZXRhZGF0YS1yeCI9PT11Lm9wdGlvbnMubmFtZT9mdW5jdGlvbiB0KGUpe2cucmVhZCgpLnRoZW4oKGY9PntpZighZi5kb25lKXtpZihmLnZhbHVlIGluc3RhbmNlb2YgUlRDRW5jb2RlZEF1ZGlvRnJhbWUpe2NvbnN0IHQ9ZnVuY3Rpb24odCxlPSExKXtjb25zdCBmPXQuZ2V0VWludDgoMCk7aWYoZiE9PW4pcmV0dXJuO2NvbnN0IHU9dC5nZXRVaW50MTYoMSksZD1hK28rdSxsPW5ldyBVaW50OEFycmF5KHQuYnl0ZUxlbmd0aC1kKTtsLnNldChuZXcgVWludDhBcnJheSh0LmJ1ZmZlcixkLHQuYnl0ZUxlbmd0aC1kKSk7Y29uc3QgZz17bTpmLHRsdkxlbjp1LHRsdjpbXSxmcmFtZTpsfTtsZXQgYz1hK287Zm9yKDtjPGQ7KXtjb25zdCBuPXQuZ2V0VWludDgoYyksYT10LmdldFVpbnQxNihjK3IpLG89citzO2lmKG49PT1pLkFVRElPX0xFVkVMKXtsZXQgcj10LmdldFVpbnQ4KGMrbyk7Zm9yKGxldCBlPTE7ZTxhO2UrKylyPXI8PDh8dC5nZXRVaW50OChjK28rZSk7Zy50bHYucHVzaCh7dGFnOm4sbGVuZ3RoOmEsdmFsdWU6ZT8xMjdecj4+MToxMjcmcn0pfWVsc2UgaWYobj09PWkuTUVUQURBVEF8fG49PT1pLkFVRElPXzY0X0JJVF9QVFMpe2NvbnN0IGU9bmV3IFVpbnQ4QXJyYXkoYSk7Zm9yKGxldCBuPTA7bjxhO24rKyllW25dPXQuZ2V0VWludDgoYytvK24pO2cudGx2LnB1c2goe3RhZzpuLGxlbmd0aDphLHZhbHVlOmV9KX1jKz1vK2F9cmV0dXJuIGd9KG5ldyBEYXRhVmlldyhmLnZhbHVlLmRhdGEpKTtpZih0KXtjb25zdCBuPXQudGx2LmZpbmQoKHQ9PnQudGFnPT09aS5NRVRBREFUQXx8dC50YWc9PT1pLkFVRElPXzY0X0JJVF9QVFMpKTtuJiZuLnZhbHVlIGluc3RhbmNlb2YgVWludDhBcnJheSYmZS5vcHRpb25zLnBvcnQucG9zdE1lc3NhZ2Uoe21ldGFkYXRhOm4udmFsdWV9KSxmLnZhbHVlLmRhdGE9dC5mcmFtZS5idWZmZXJ9fWMud3JpdGUoZi52YWx1ZSksZS5vcHRpb25zLnBvcnQucG9zdE1lc3NhZ2Uoe3RyYW5zZm9ybWVkOiEwfSksdChlKX19KSl9KHUpOiJhdWRpby1tZXRhZGF0YS10eCI9PT11Lm9wdGlvbnMubmFtZSYmZnVuY3Rpb24gdChlKXtnLnJlYWQoKS50aGVuKChmPT57aWYoIWYuZG9uZSl7aWYoZS5vcHRpb25zLnBvcnQucG9zdE1lc3NhZ2Uoe2dldE1ldGFkYXRhOiEwfSksZi52YWx1ZSBpbnN0YW5jZW9mIFJUQ0VuY29kZWRBdWRpb0ZyYW1lKXtjb25zdCB0PWwuc2hpZnQoKTt0JiYoZi52YWx1ZS5kYXRhPWZ1bmN0aW9uKHQsZSxpKXtjb25zdCBmPWkuYnl0ZUxlbmd0aCx1PWYrcitzLGQ9YStvK3UsbD1uZXcgQXJyYXlCdWZmZXIodC5ieXRlTGVuZ3RoK2QpLGc9bmV3IERhdGFWaWV3KGwpO2cuc2V0VWludDgoMCxuKSxnLnNldFVpbnQxNigxLHUpLGcuc2V0VWludDgoMyxlKSxnLnNldFVpbnQxNig0LGYpO2ZvcihsZXQgdD0wO3Q8Zjt0KyspZy5zZXRVaW50OCg2K3QsaVt0XSk7Y29uc3QgYz1uZXcgVWludDhBcnJheShnLmJ1ZmZlcik7cmV0dXJuIGMuc2V0KG5ldyBVaW50OEFycmF5KHQpLGQpLGMuYnVmZmVyfShmLnZhbHVlLmRhdGEsaS5BVURJT182NF9CSVRfUFRTLHQpKX1jLndyaXRlKGYudmFsdWUpLGUub3B0aW9ucy5wb3J0LnBvc3RNZXNzYWdlKHt0cmFuc2Zvcm1lZDohMH0pLHQoZSl9fSkpfSh1KX0sc2VsZi5wb3N0TWVzc2FnZSgicmVnaXN0ZXJlZCIpKTsK")],{type:"text/javascript"});return setTimeout(()=>XO.revokeObjectURL(n),0),new Worker(XO.createObjectURL(n))}let iU=71,VL=1,BL=2,FL=1,aU=2;var Hp=function(n){return n[n.AUDIO_LEVEL=1]="AUDIO_LEVEL",n[n.METADATA=2]="METADATA",n[n.AUDIO_64_BIT_PTS=3]="AUDIO_64_BIT_PTS",n}(Hp||{});function io(n){let i=arguments.length>1&&arguments[1]!==void 0&&arguments[1],a=n.getUint8(0);if(a!==iU)return;let c=n.getUint16(1),u=VL+BL+c,_=new Uint8Array(n.byteLength-u);_.set(new Uint8Array(n.buffer,u,n.byteLength-u));let S={m:a,tlvLen:c,tlv:[],frame:_},C=VL+BL;for(;C<u;){let R=n.getUint8(C),e=n.getUint16(C+FL),t=FL+aU;if(R===Hp.AUDIO_LEVEL){let r=n.getUint8(C+t);for(let s=1;s<e;s++)r=r<<8|n.getUint8(C+t+s);S.tlv.push({tag:R,length:e,value:i?127^r>>1:127&r})}else if(R===Hp.METADATA||R===Hp.AUDIO_64_BIT_PTS){let r=new Uint8Array(e);for(let s=0;s<e;s++)r[s]=n.getUint8(C+t+s);S.tlv.push({tag:R,length:e,value:r})}C+=t+e}return S}let gI=new Map,xg=127,$u=1e-10,ef=139/13,_I=new Map;function sU(n,i,a){let c="".concat(n,"-").concat(i,"-").concat(a),u=0;return _I.has(c)?u=_I.get(c):(u=Math.log(function(_,S){let C=_-S;S<C&&(S=C);let R=1;for(let e=_,t=1;e>S;e--,t++)R=R*e/t;return R}(i,n))+n*Math.log(.5)+(i-n)*Math.log(1-.5)-Math.log(a)+a*n,_I.set(c,u)),u<$u&&(u=$u),u}function N8(n,i,a){let c=i.length,u=n.length/c,_=!1;for(let S=0,C=0;S<c;S++){let R=0;for(let e=C+u;C<e;C++)n[C]>a&&R++;i[S]!==R&&(i[S]=R,_=!0)}return _}window.cache=_I;let GL=0;class oU{constructor(i){Me(this,"id",void 0),Me(this,"immediates",[]),Me(this,"lastNonSilence",-1),Me(this,"immediateSpeechActivityScore",$u),Me(this,"lastLevelChangedTime",Date.now()),Me(this,"levels",[]),Me(this,"longs",[]),Me(this,"longSpeechActivityScore",$u),Me(this,"mediums",[]),Me(this,"mediumSpeechActivityScore",$u),Me(this,"minLevel",0),Me(this,"nextMinLevel",0),Me(this,"nextMinLevelWindowLength",0),Me(this,"energyScore",0),this.id=i||"".concat(GL++),this.immediates.length=50,this.mediums.length=10,this.longs.length=1,this.levels.length=this.immediates.length}computeImmediates(){let i=this.immediates,a=this.levels,c=this.minLevel+ef,u=!1;for(let _=0;_<i.length;++_){let S=a[_];S<c&&(S=0);let C=Math.floor(S/ef);i[_]!==C&&(i[_]=C,u=!0)}return u}computeLongs(){return N8(this.mediums,this.longs,4)}computeMediums(){return N8(this.immediates,this.mediums,7)}evaluateImmediateSpeechActivityScore(){this.immediateSpeechActivityScore=sU(this.immediates[0],13,.78)}evaluateLongSpeechActivityScore(i){this.longSpeechActivityScore=sU(this.longs[0],10,47),this.longSpeechActivityScore>$u&&(this.lastNonSilence=i)}evaluateMediumSpeechActivityScore(){this.mediumSpeechActivityScore=sU(this.mediums[0],5,24)}evaluateSpeechActivityScores(i){this.computeImmediates()&&(this.evaluateImmediateSpeechActivityScore(),this.computeMediums()&&(this.evaluateMediumSpeechActivityScore(),this.computeLongs()&&this.evaluateLongSpeechActivityScore(i)))}getLastLevelChangedTime(){return this.lastLevelChangedTime}getLevels(){var i;return"[".concat(HE(i=[...this.levels]).call(i).join(),"]")}getSpeechActivityScore(i){switch(i){case 0:return this.immediateSpeechActivityScore;case 1:return this.mediumSpeechActivityScore;case 2:return this.longSpeechActivityScore;default:throw new Error("interval "+i)}}levelChanged(i,a){if(this.lastLevelChangedTime<=a){this.lastLevelChangedTime=a;let c=i;return i<0&&(c=0),i>xg&&(c=xg),this.levels.unshift(c),this.levels.length>this.immediates.length&&this.levels.pop(),this.updateMinLevel(c),c>=this.minLevel+ef?c:c/2}return-1}levelTimedOut(){this.levelChanged(0,this.lastLevelChangedTime)}updateMinLevel(i){if(i!==0){if(this.minLevel===0||this.minLevel>i)return this.minLevel=i,this.nextMinLevel=0,void(this.nextMinLevelWindowLength=0);if(this.nextMinLevel===0)return this.nextMinLevel=i,void(this.nextMinLevelWindowLength=1);if(this.nextMinLevel>i&&(this.nextMinLevel=i),this.nextMinLevelWindowLength++,this.nextMinLevelWindowLength>=750){let a=Math.sqrt(this.minLevel*this.nextMinLevel);a<0?a=0:a>xg&&(a=xg),this.minLevel=a,this.nextMinLevel=0,this.nextMinLevelWindowLength=0}}}}class cU{constructor(i){Me(this,"algorithm",void 0),this.algorithm=i}execute(){let i=!this.algorithm;if(!i)try{let a=this.algorithm.runInDecisionMaker(this);a<=0?i=!0:setTimeout(this.execute.bind(this),a)}catch{i=!0}i&&this.algorithm&&this.algorithm.decisionMakerExited(this)}}class EI{constructor(i,a,c){Me(this,"isDominant",void 0),Me(this,"energyRanking",void 0),Me(this,"energyScore",void 0),this.isDominant=i,this.energyRanking=a,this.energyScore=c}}class lU extends li{constructor(i){super(),Me(this,"dominantId",null),Me(this,"lastDecisionTime",0),Me(this,"lastLevelChangedTime",0),Me(this,"lastLevelIdleTime",0),Me(this,"relativeSpeechActivities",[]),Me(this,"speakers",new Map),Me(this,"enableSilence",!1),Me(this,"timeoutToSilenceInterval",0),Me(this,"decisionMaker",null),Me(this,"loudest",[]),Me(this,"numLoudestToTrack",3),Me(this,"energyExpireTimeMs",250),Me(this,"energyAlphaPct",50),this.timeoutToSilenceInterval=i,this.enableSilence=i>0,this.relativeSpeechActivities.length=3}setLoudestConfig(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:3,a=arguments.length>1?arguments[1]:void 0,c=arguments.length>2?arguments[2]:void 0;this.numLoudestToTrack=i,a!=null&&(this.energyExpireTimeMs=a),c!=null&&(this.energyAlphaPct=c),this.loudest.length>i&&this.loudest.splice(i)}getDominantSpeaker(){return this.dominantId}isAmongLoudest(i){return this.loudest.some(a=>a.id===i)}levelChanged(i,a){let c=Date.now(),u=this.getOrCreateSpeaker(i);this.lastLevelChangedTime<c&&(this.lastLevelChangedTime=c,this.maybeStartDecisionMaker());let _=u.levelChanged(a,c);return this.updateLoudestList(u,_,c)}runInDecisionMaker(i){return this.decisionMaker!==i||this.lastDecisionTime>0&&this.lastDecisionTime-this.lastLevelChangedTime>=15e3?-1:this._runInDecisionMaker()}decisionMakerExited(i){this.decisionMaker===i&&(this.decisionMaker=null)}destroy(){this.decisionMaker=null,this.loudest.length=0,this.speakers.clear(),this.removeAllListeners()}addSpeakers(i){i.forEach(a=>{this.speakers.has(a.id)||this.speakers.set(a.id,a)})}removeSpeakers(i){i.forEach(a=>{this.speakers.delete(a.id)})}getOrCreateSpeaker(i){let a=this.speakers.get(i);return a||(a=new oU(i),this.speakers.set(i,a),this.maybeStartDecisionMaker()),a}updateLoudestList(i,a,c){let u=i.id===this.dominantId;if(a<0){let R=0;for(;R<this.loudest.length&&this.loudest[R]!==i;)++R;return new EI(u,R,i.energyScore)}if(i.energyScore=Math.floor((this.energyAlphaPct*a+(100-this.energyAlphaPct)*i.energyScore+50)/100),this.numLoudestToTrack===0)return new EI(u,0,i.energyScore);let _=c-this.energyExpireTimeMs,S=0;for(;S<this.loudest.length;){let R=this.loudest[S];if(R.getLastLevelChangedTime()<_&&this.loudest.length>=this.numLoudestToTrack)this.loudest.splice(S,1);else if(R.id!==i.id)++S;else if(this.loudest.splice(S,1),this.loudest.length<this.numLoudestToTrack)break}let C=0;for(;C<this.loudest.length&&!(this.loudest[C].energyScore<i.energyScore);)++C;return C<this.numLoudestToTrack&&(this.loudest.splice(C,0,i),this.loudest.length>this.numLoudestToTrack&&this.loudest.splice(this.numLoudestToTrack,1)),new EI(u,C,i.energyScore)}maybeStartDecisionMaker(){!this.decisionMaker&&this.speakers.size>0&&(this.decisionMaker=new cU(this),this.decisionMaker.execute())}makeDecision(i){let a=null,c=null,u=this.speakers.size,_=null;if(u===0)_=null;else if(u===1){var S;let C=Pc(S=this.speakers).call(S).next().value;this.enableSilence&&C&&(_=C.id,C.evaluateSpeechActivityScores(i),i-C.lastNonSilence>this.timeoutToSilenceInterval&&(_=null))}else{let C=this.dominantId==null?null:this.speakers.get(this.dominantId);if(C==null){let t=this.speakers.entries().next();t.value&&(_=t.value[0],C=t.value[1])}else _=C.id;C==null||C.evaluateSpeechActivityScores(i);let R=this.relativeSpeechActivities,e=2;for(let t of this.speakers.entries()){let[r,s]=t;if(s===C)continue;s.evaluateSpeechActivityScores(i);for(let E=0;E<R.length;++E){let y=C==null?$u:C.getSpeechActivityScore(E);R[E]=Math.log(s.getSpeechActivityScore(E)/y)}let l=R[0],f=R[1],m=R[2];l>3&&f>2&&m>0&&f>e&&(e=f,_=r)}this.enableSilence&&C!=null&&_===C.id&&i-C.lastNonSilence>this.timeoutToSilenceInterval&&(_=null)}_==null&&!this.enableSilence||_===this.dominantId||(a=this.dominantId,this.dominantId=_,c=this.dominantId),c==null&&!this.enableSilence||c===a||this.emit("ActiveSpeakerChanged",c)}_runInDecisionMaker(){let i=Date.now(),a=300-(i-this.lastLevelIdleTime),c=0;a<=0?(this.lastLevelIdleTime!==0&&this.timeoutIdleLevels(i),this.lastLevelIdleTime=i):c=a;let u=300-(i-this.lastDecisionTime);return u<=0&&(this.lastDecisionTime=i,this.makeDecision(i),u=300-(Date.now()-i)),u>0&&c>u&&(c=u),c}timeoutIdleLevels(i){let a=[];for(let u of Pc(c=this.speakers).call(c)){var c;let _=i-u.getLastLevelChangedTime();36e5<_&&(this.dominantId==null||u.id!==this.dominantId)?a.push(u.id):300<_&&u.levelTimedOut()}a.forEach(u=>this.speakers.delete(u))}}let OS=new Map,To=null,vI=null,SI=3,Wp=[],uc=new Map,n1=new Map;class zL{get samples(){return this.actives+this.inactives}get activeRate(){return this.actives/this.samples}constructor(i,a){Me(this,"id",void 0),Me(this,"track",void 0),Me(this,"score",0),Me(this,"active",!0),Me(this,"muted",!1),Me(this,"timer",0),Me(this,"actives",0),Me(this,"inactives",0),this.id=i,this.track=a,this.setActive(uc.size<3)}autoCheckActive(){this.autoSetActive(),this.autoAdjustActive(),this.resetTimer(),this.actives=0,this.inactives=0}autoSetActive(){let i=this.active;this.active=this.activeRate>=.8;let{actives:a,inactives:c}=function(){let u=[],_=[];return Array.from(Pc(uc).call(uc)).forEach(S=>{S.active?u.push(S):_.push(S)}),{actives:u,inactives:_}}();if(a.length>3){let u;a.forEach(_=>{(!u||u.score>_.score)&&(u=_)}),u&&u.setActive(!1)}if(a.length<3&&c.length>0){let u;c.forEach(_=>{(!u||u.score<_.score)&&_.id!==this.id&&(u=_)}),u&&i&&!this.active&&(u.samples>40&&u.activeRate-this.activeRate>.4?u.setActive(!0):this.active=!0)}this.setMuted(!this.active)}setActive(i){this.active=i,this.resetTimer(),this.setMuted(!i)}autoAdjustActive(){this.active?this.autoSwitchToInactive():this.autoSwitchToActive()}autoSwitchToActive(){let i=function(a){let c;return Array.from(Pc(uc).call(uc)).forEach(u=>{!u.active||u.id===a||u.samples<40||(!c||u.score<c.score)&&(c=u)}),c}(this.id);i&&this.activeRate-i.activeRate>.4&&(i.setActive(!1),this.setActive(!0))}autoSwitchToInactive(){let i=function(a){let c;return Array.from(Pc(uc).call(uc)).forEach(u=>{u.active||u.id===a||u.samples<40||(!c||u.score>c.score)&&(c=u)}),c}(this.id);i&&i.activeRate-this.activeRate>.4&&(i.setActive(!0),this.setActive(!1))}addSample(i){i?this.actives+=1:this.inactives+=1,this.samples>66.66666666666667&&this.autoCheckActive()}setMuted(i){this.track&&(this.track.enabled=!i,this.muted=i)}resetTimer(){this.clearTimer(),this.timer=window.setTimeout(()=>{if(this.samples!==0)return this.samples<50?this.resetTimer():void this.autoCheckActive()},1e3)}clearTimer(){this.timer&&(clearTimeout(this.timer),this.timer=0)}}let r1;function dU(n){let i=uc.get(n);i&&(uc.delete(n),i.clearTimer())}let HL=new Map,L8=new Map;function hY(n,i,a){let c=new Uint8Array(n,i,a),u=[],_=0;for(;u.length<a;)_+3<a&&c[_]===0&&c[_+1]===0&&c[_+2]===3&&(c[_+3]===0||c[_+3]===1||c[_+3]===2||c[_+3]===3)?(u.push(c[_],c[_+1],c[_+3]),_+=4):(u.push(c[_]),_++);return new Uint8Array(u)}let i1=new Map,yI=new Map;(function(){let n=En();ka.getDisplayMedia=!(!navigator.mediaDevices||!navigator.mediaDevices.getDisplayMedia),ka.getStreamFromExtension=n.name===cr.CHROME&&Number(n.version)>34,ka.supportUnifiedPlan=function(){if(!window.RTCRtpTransceiver||!("currentDirection"in RTCRtpTransceiver.prototype))return!1;let i=new RTCPeerConnection,a=!1;try{i.addTransceiver("audio"),a=!0}catch{}return i.close(),a}(),ka.supportMinBitrate=n.name===cr.CHROME||n.name===cr.EDGE,ka.supportSetRtpSenderParameters=function(){let i=En();return!!(window.RTCRtpSender&&window.RTCRtpSender.prototype.setParameters&&window.RTCRtpSender.prototype.getParameters)&&(!!jp()||!(!mr()&&!gS())||i.name===cr.FIREFOX&&Number(i.version)>=64)}(),n.name===cr.SAFARI&&(Number(n.version)>=14?ka.supportDualStream=!0:ka.supportDualStream=!1),ka.webAudioMediaStreamDest=function(){let i=En();return!(i.name===cr.SAFARI&&Number(i.version)<12)}(),ka.supportReplaceTrack=!!window.RTCRtpSender&&typeof RTCRtpSender.prototype.replaceTrack=="function",ka.supportWebGL=typeof WebGLRenderingContext<"u",ka.supportRequestFrame=!!window.CanvasCaptureMediaStreamTrack,jp()||(ka.webAudioWithAEC=!0),ka.supportShareAudio=function(){let i=En();return(i.os===Ra.WIN_10||i.os===Ra.WIN_81||i.os===Ra.WIN_7||i.os===Ra.LINUX||i.os===Ra.MAC_OS||i.os===Ra.CHROMIUM_OS)&&i.name===cr.CHROME&&Number(i.version)>=74}(),ka.supportDataChannel=!!(_S(76)||function(i){let a=En();return!(a.name!==cr.FIREFOX||!a.osVersion)&&Number(a.version)>=i}(68)||_x(14)),ka.supportPCSetConfiguration=function(){let i=window.RTCPeerConnection;return!Ni()&&!!i&&i.prototype.setConfiguration instanceof Function}(),ka.supportWebRTCEncodedTransform=function(){let i=En();return i.name==="Chrome"&&Number(i.version)>=87||i.name==="Safari"&&Number(i.version)>=15}(),ka.supportWebRTCInsertableStream=function(){let i=En();return(i.name===cr.CHROME||i.name===cr.EDGE)&&Number(i.version)>=94&&"MediaStreamTrackGenerator"in window&&"MediaStreamTrackProcessor"in window}(),ka.supportRequestVideoFrameCallback="requestVideoFrameCallback"in HTMLVideoElement.prototype,ka.supportWebCrypto=typeof window<"u"&&window.crypto!==void 0&&window.crypto.subtle!==void 0,In(()=>{ka.supportDualStreamEncoding=function(){let i=En();return!!ge("DISABLE_WEBAUDIO")||i.name==="Safari"&&Number(i.version)>=14||!!(i.name==="Chrome"&&/Windows/i.test(i.os||"")&&Number(i.version)>=100&&ge("CHROME_DUAL_STREAM_USE_ENCODING"))}(),z.debug("browser ua: ",navigator.userAgent),z.info("browser info: ",n),z.info("browser compatibility: ",ka)})})();let a1=["CHINA","GLOBAL"],tf=[[0,1,2,3,4,5,5],[0,2,2,3,4,5,5],[0,3,3,3,4,5,5],[0,4,4,4,4,5,5],[0,5,5,5,5,5,5]],Yp=[],NS=[];function eu(n,i){return!!i&&Yp.some(a=>a.uid===n&&a.channelName===i)}function tu(){return NS.length>0}var WL=ts.forEach,D8=rc("forEach")?[].forEach:function(n){return WL(this,n,arguments.length>1?arguments[1]:void 0)};br({target:"Array",proto:!0,forced:[].forEach!=D8},{forEach:D8});var YL=tc("Array").forEach,P8=Cd,KL=ls,pY=Q,mY=YL,s1=Array.prototype,TI={DOMTokenList:!0,NodeList:!0},gY=function(n){var i=n.forEach;return n===s1||pY(s1,n)&&i===s1.forEach||KL(TI,P8(n))?mY:i},M8=T(gY),LS=Tu,DS=qE;br({target:"Object",stat:!0,forced:I(function(){DS(1)})},{keys:function(n){return DS(LS(n))}});var B_=T(Sn.Object.keys),uU=T(Mm),_Y=T(zE),k8=br,x8=go,EY=gp,vY=ar,U8=ky,SY=Df,fU=dr,yY=Fd,TY=Ai,bY=_p,CY=c4("slice"),j8=TY("species"),hU=Array,wY=Math.max;k8({target:"Array",proto:!0,forced:!CY},{slice:function(n,i){var a,c,u,_=fU(this),S=SY(_),C=U8(n,S),R=U8(i===void 0?S:i,S);if(x8(_)&&(a=_.constructor,(EY(a)&&(a===hU||x8(a.prototype))||vY(a)&&(a=a[j8])===null)&&(a=void 0),a===hU||a===void 0))return bY(_,C,R);for(c=new(a===void 0?hU:a)(wY(R-C,0)),u=0;C<R;C++,u++)C in _&&yY(c,u,_[C]);return c.length=u,c}});var RY=tc("Array").slice,IY=Q,V8=RY,pU=Array.prototype,AY=function(n){var i=n.slice;return n===pU||IY(pU,n)&&i===pU.slice?V8:i},B8=T(AY);function Ut(n,i,a,c,u){var _,S,C,R={};return M8(_=B_(c)).call(_,function(e){R[e]=c[e]}),R.enumerable=!!R.enumerable,R.configurable=!!R.configurable,("value"in R||R.initializer)&&(R.writable=!0),R=uU(S=_Y(C=B8(a).call(a)).call(C)).call(S,function(e,t){return t(n,i,e)||e},R),u&&R.initializer!==void 0&&(R.value=R.initializer?R.initializer.call(u):void 0,R.initializer=void 0),R.initializer===void 0&&(AN(n,i,R),R=null),R}let qL=function(n){return n[n.ACCESS_POINT=101]="ACCESS_POINT",n[n.UNILBS=201]="UNILBS",n[n.STRING_UID_ALLOCATOR=901]="STRING_UID_ALLOCATOR",n}({}),mU=function(n){return n[n.IIIEGAL_APPID=1]="IIIEGAL_APPID",n[n.IIIEGAL_UID=2]="IIIEGAL_UID",n[n.INTERNAL_ERROR=3]="INTERNAL_ERROR",n}({}),nf=function(n){return n[n.INVALID_VENDOR_KEY=5]="INVALID_VENDOR_KEY",n[n.INVALID_CHANNEL_NAME=7]="INVALID_CHANNEL_NAME",n[n.INTERNAL_ERROR=8]="INTERNAL_ERROR",n[n.NO_AUTHORIZED=9]="NO_AUTHORIZED",n[n.DYNAMIC_KEY_TIMEOUT=10]="DYNAMIC_KEY_TIMEOUT",n[n.NO_ACTIVE_STATUS=11]="NO_ACTIVE_STATUS",n[n.DYNAMIC_KEY_EXPIRED=13]="DYNAMIC_KEY_EXPIRED",n[n.STATIC_USE_DYNAMIC_KEY=14]="STATIC_USE_DYNAMIC_KEY",n[n.DYNAMIC_USE_STATIC_KEY=15]="DYNAMIC_USE_STATIC_KEY",n[n.USER_OVERLOAD=16]="USER_OVERLOAD",n[n.FORBIDDEN_REGION=18]="FORBIDDEN_REGION",n[n.CANNOT_MEET_AREA_DEMAND=19]="CANNOT_MEET_AREA_DEMAND",n}({}),zo=function(n){return n[n.NO_FLAG_SET=100]="NO_FLAG_SET",n[n.FLAG_SET_BUT_EMPTY=101]="FLAG_SET_BUT_EMPTY",n[n.INVALID_FALG_SET=102]="INVALID_FALG_SET",n[n.FLAG_SET_BUT_NO_RE=103]="FLAG_SET_BUT_NO_RE",n[n.INVALID_SERVICE_ID=104]="INVALID_SERVICE_ID",n[n.NO_SERVICE_AVAILABLE=200]="NO_SERVICE_AVAILABLE",n[n.NO_SERVICE_AVAILABLE_P2P=201]="NO_SERVICE_AVAILABLE_P2P",n[n.NO_SERVICE_AVAILABLE_VOICE=202]="NO_SERVICE_AVAILABLE_VOICE",n[n.NO_SERVICE_AVAILABLE_WEBRTC=203]="NO_SERVICE_AVAILABLE_WEBRTC",n[n.NO_SERVICE_AVAILABLE_CDS=204]="NO_SERVICE_AVAILABLE_CDS",n[n.NO_SERVICE_AVAILABLE_CDN=205]="NO_SERVICE_AVAILABLE_CDN",n[n.NO_SERVICE_AVAILABLE_TDS=206]="NO_SERVICE_AVAILABLE_TDS",n[n.NO_SERVICE_AVAILABLE_REPORT=207]="NO_SERVICE_AVAILABLE_REPORT",n[n.NO_SERVICE_AVAILABLE_APP_CENTER=208]="NO_SERVICE_AVAILABLE_APP_CENTER",n[n.NO_SERVICE_AVAILABLE_ENV0=209]="NO_SERVICE_AVAILABLE_ENV0",n[n.NO_SERVICE_AVAILABLE_VOET=210]="NO_SERVICE_AVAILABLE_VOET",n[n.NO_SERVICE_AVAILABLE_STRING_UID=211]="NO_SERVICE_AVAILABLE_STRING_UID",n[n.NO_SERVICE_AVAILABLE_WEBRTC_UNILBS=212]="NO_SERVICE_AVAILABLE_WEBRTC_UNILBS",n[n.NO_SERVICE_AVAILABLE_UNILBS_FLV=213]="NO_SERVICE_AVAILABLE_UNILBS_FLV",n}({}),Zt=function(n){return n[n.K_TIMESTAMP_EXPIRED=2]="K_TIMESTAMP_EXPIRED",n[n.K_CHANNEL_PERMISSION_INVALID=3]="K_CHANNEL_PERMISSION_INVALID",n[n.K_CERTIFICATE_INVALID=4]="K_CERTIFICATE_INVALID",n[n.K_CHANNEL_NAME_EMPTY=5]="K_CHANNEL_NAME_EMPTY",n[n.K_CHANNEL_NOT_FOUND=6]="K_CHANNEL_NOT_FOUND",n[n.K_TICKET_INVALID=7]="K_TICKET_INVALID",n[n.K_CHANNEL_CONFLICTED=8]="K_CHANNEL_CONFLICTED",n[n.K_SERVICE_NOT_READY=9]="K_SERVICE_NOT_READY",n[n.K_SERVICE_TOO_HEAVY=10]="K_SERVICE_TOO_HEAVY",n[n.K_UID_BANNED=14]="K_UID_BANNED",n[n.K_IP_BANNED=15]="K_IP_BANNED",n[n.K_CHANNEL_BANNED=16]="K_CHANNEL_BANNED",n[n.DATASTREAM2_NOT_AVAILABLE=27]="DATASTREAM2_NOT_AVAILABLE",n[n.K_AUTO_REBALANCE=28]="K_AUTO_REBALANCE",n[n.WARN_NO_AVAILABLE_CHANNEL=103]="WARN_NO_AVAILABLE_CHANNEL",n[n.WARN_LOOKUP_CHANNEL_TIMEOUT=104]="WARN_LOOKUP_CHANNEL_TIMEOUT",n[n.WARN_LOOKUP_CHANNEL_REJECTED=105]="WARN_LOOKUP_CHANNEL_REJECTED",n[n.WARN_OPEN_CHANNEL_TIMEOUT=106]="WARN_OPEN_CHANNEL_TIMEOUT",n[n.WARN_OPEN_CHANNEL_REJECTED=107]="WARN_OPEN_CHANNEL_REJECTED",n[n.WARN_REQUEST_DEFERRED=108]="WARN_REQUEST_DEFERRED",n[n.ERR_DYNAMIC_KEY_TIMEOUT=109]="ERR_DYNAMIC_KEY_TIMEOUT",n[n.ERR_NO_AUTHORIZED=110]="ERR_NO_AUTHORIZED",n[n.ERR_VOM_SERVICE_UNAVAILABLE=111]="ERR_VOM_SERVICE_UNAVAILABLE",n[n.ERR_NO_CHANNEL_AVAILABLE_CODE=112]="ERR_NO_CHANNEL_AVAILABLE_CODE",n[n.ERR_MASTER_VOCS_UNAVAILABLE=114]="ERR_MASTER_VOCS_UNAVAILABLE",n[n.ERR_INTERNAL_ERROR=115]="ERR_INTERNAL_ERROR",n[n.ERR_NO_ACTIVE_STATUS=116]="ERR_NO_ACTIVE_STATUS",n[n.ERR_INVALID_UID=117]="ERR_INVALID_UID",n[n.ERR_DYNAMIC_KEY_EXPIRED=118]="ERR_DYNAMIC_KEY_EXPIRED",n[n.ERR_STATIC_USE_DYANMIC_KE=119]="ERR_STATIC_USE_DYANMIC_KE",n[n.ERR_DYNAMIC_USE_STATIC_KE=120]="ERR_DYNAMIC_USE_STATIC_KE",n[n.ERR_NO_VOCS_AVAILABLE=2e3]="ERR_NO_VOCS_AVAILABLE",n[n.ERR_NO_VOS_AVAILABLE=2001]="ERR_NO_VOS_AVAILABLE",n[n.ERR_JOIN_CHANNEL_TIMEOUT=2002]="ERR_JOIN_CHANNEL_TIMEOUT",n[n.ERR_REPEAT_JOIN_CHANNEL=2003]="ERR_REPEAT_JOIN_CHANNEL",n[n.ERR_JOIN_BY_MULTI_IP=2004]="ERR_JOIN_BY_MULTI_IP",n[n.ERR_NOT_JOINED=2011]="ERR_NOT_JOINED",n[n.ERR_REPEAT_JOIN_REQUEST=2012]="ERR_REPEAT_JOIN_REQUEST",n[n.ERR_INVALID_VENDOR_KEY=2013]="ERR_INVALID_VENDOR_KEY",n[n.ERR_INVALID_CHANNEL_NAME=2014]="ERR_INVALID_CHANNEL_NAME",n[n.ERR_INVALID_STRINGUID=2015]="ERR_INVALID_STRINGUID",n[n.ERR_TOO_MANY_USERS=2016]="ERR_TOO_MANY_USERS",n[n.ERR_SET_CLIENT_ROLE_TIMEOUT=2017]="ERR_SET_CLIENT_ROLE_TIMEOUT",n[n.ERR_SET_CLIENT_ROLE_NO_PERMISSION=2018]="ERR_SET_CLIENT_ROLE_NO_PERMISSION",n[n.ERR_SET_CLIENT_ROLE_ALREADY_IN_USE=2019]="ERR_SET_CLIENT_ROLE_ALREADY_IN_USE",n[n.ERR_PUBLISH_REQUEST_INVALID=2020]="ERR_PUBLISH_REQUEST_INVALID",n[n.ERR_SUBSCRIBE_REQUEST_INVALID=2021]="ERR_SUBSCRIBE_REQUEST_INVALID",n[n.ERR_NOT_SUPPORTED_MESSAGE=2022]="ERR_NOT_SUPPORTED_MESSAGE",n[n.ERR_ILLEAGAL_PLUGIN=2023]="ERR_ILLEAGAL_PLUGIN",n[n.ERR_REJOIN_TOKEN_INVALID=2024]="ERR_REJOIN_TOKEN_INVALID",n[n.ERR_REJOIN_USER_NOT_JOINED=2025]="ERR_REJOIN_USER_NOT_JOINED",n[n.ERR_INVALID_OPTIONAL_INFO=2027]="ERR_INVALID_OPTIONAL_INFO",n[n.ILLEGAL_AES_PASSWORD=2028]="ILLEGAL_AES_PASSWORD",n[n.ILLEGAL_CLIENT_ROLE_LEVEL=2029]="ILLEGAL_CLIENT_ROLE_LEVEL",n[n.ERR_TOO_MANY_BROADCASTERS=2031]="ERR_TOO_MANY_BROADCASTERS",n[n.ERR_TOO_MANY_SUBSCRIBERS=2032]="ERR_TOO_MANY_SUBSCRIBERS",n[n.ERR_LICENSE_MISSING=32769]="ERR_LICENSE_MISSING",n[n.ERR_LICENSE_EXPIRED=32771]="ERR_LICENSE_EXPIRED",n[n.ERR_LICENSE_MINUTES_EXCEEDED=32773]="ERR_LICENSE_MINUTES_EXCEEDED",n[n.ERR_LICENSE_PERIOD_INVALID=32774]="ERR_LICENSE_PERIOD_INVALID",n[n.ERR_LICENSE_MULTIPLE_SDK_SERVICE=32778]="ERR_LICENSE_MULTIPLE_SDK_SERVICE",n[n.ERR_LICENSE_ILLEGAL=32783]="ERR_LICENSE_ILLEGAL",n[n.ERR_TEST_RECOVER=9e3]="ERR_TEST_RECOVER",n[n.ERR_TEST_TRYNEXT=9001]="ERR_TEST_TRYNEXT",n[n.ERR_TEST_RETRY=9002]="ERR_TEST_RETRY",n}({}),qr=function(n){return n.CONNECTING="connecting",n.CONNECTED="connected",n.RECONNECTING="reconnecting",n.CLOSED="closed",n}({}),dn=function(n){return n.WS_CONNECTED="ws_connected",n.WS_RECONNECTING="ws_reconnecting",n.WS_CLOSED="ws_closed",n.WS_RECONNECT_CREATE_CONNECTION="ws_reconnect_create_connection",n.ON_BINARY_DATA="on_binary_data",n.REQUEST_RECOVER="request_recover",n.REQUEST_JOIN_INFO="request_join_info",n.REQUEST_REJOIN_INFO="req_rejoin_info",n.IS_P2P_DISCONNECTED="is_p2p_dis",n.DISCONNECT_P2P="dis_p2p",n.ABORT_P2P_EXECUTION="abort_p2p_execution",n.NEED_RENEW_SESSION="need-sid",n.REPORT_JOIN_GATEWAY="report_join_gateway",n.REQUEST_TIMEOUT="request_timeout",n.REQUEST_SUCCESS="request_success",n.JOIN_RESPONSE="join_response",n.PRE_CONNECT_PC="pre_connect_pc",n.P2P_CONNECTION="p2p_connection",n.P2P_REMOTE_CANDIDATE_UPDATE="p2p_remote_candidate_update",n.P2P_SUBSCRIBE="p2p_subscribe",n.P2P_UNSUBSCRIBE="p2p_unsubscribe",n.P2P_EXCHANGE_SDP="p2p_exchange_sdp",n.P2P_ON_ADD_VIDEO_STREAM="p2p_on_add_video_stream",n.P2P_ON_ADD_AUDIO_STREAM="p2p_on_add_audio_stream",n.RECOVER_NOTIFICATION="recover_notification",n}({}),ln=function(n){return n.PING="ping",n.PING_BACK="ping_back",n.JOIN="join_v3",n.REJOIN="rejoin_v3",n.LEAVE="leave",n.SET_CLIENT_ROLE="set_client_role",n.PUBLISH="publish",n.PUBLISH_DATASTREAM="publish_datastream",n.UNPUBLISH="unpublish",n.UNPUBLISH_DATASTREAM="unpublish_datastream",n.SUBSCRIBE="subscribe",n.PRE_SUBSCRIBE="pre_subscribe",n.SUBSCRIBE_DATASTREAM="subscribe_datastream",n.SUBSCRIBE_STREAMS="subscribe_streams",n.UNSUBSCRIBE="unsubscribe",n.UNSUBSCRIBE_DATASTREAM="unsubscribe_datastream",n.UNSUBSCRIBE_STREAMS="unsubscribe_streams",n.SUBSCRIBE_CHANGE="subscribe_change",n.TRAFFIC_STATS="traffic_stats",n.RENEW_TOKEN="renew_token",n.SWITCH_VIDEO_STREAM="switch_video_stream",n.DEFAULT_VIDEO_STREAM="default_video_stream",n.SET_FALLBACK_OPTION="set_fallback_option",n.GATEWAY_INFO="gateway_info",n.CONTROL="control",n.SEND_METADATA="send_metadata",n.DATA_STREAM="data_stream",n.PICK_SVC_LAYER="pick_svc_layer",n.RESTART_ICE="restart_ice",n.CONNECT_PC="connect_pc",n.SET_VIDEO_PROFILE="set_video_profile",n.SET_PARAMETER="set_parameter",n.SET_RTM2_FLAG="set_rtm2_flag",n}({}),bI=function(n){return n.WRTC_STATS="wrtc_stats",n.WS_INFLATE_DATA_LENGTH="ws_inflate_data_length",n.DENOISER_STATS="denoiser_stats",n.EXTENSION_USAGE_STATS="extension_usage_stats",n}({}),kn=function(n){return n.ON_USER_ONLINE="on_user_online",n.ON_USER_OFFLINE="on_user_offline",n.ON_STREAM_FALLBACK_UPDATE="on_stream_fallback_update",n.ON_PUBLISH_STREAM="on_publish_stream",n.ON_UPLINK_STATS="on_uplink_stats",n.ON_P2P_LOST="on_p2p_lost",n.ON_REMOVE_STREAM="on_remove_stream",n.ON_ADD_AUDIO_STREAM="on_add_audio_stream",n.ON_ADD_VIDEO_STREAM="on_add_video_stream",n.ON_TOKEN_PRIVILEGE_WILL_EXPIRE="on_token_privilege_will_expire",n.ON_TOKEN_PRIVILEGE_DID_EXPIRE="on_token_privilege_did_expire",n.ON_USER_BANNED="on_user_banned",n.ON_USER_LICENSE_BANNED="on_user_license_banned",n.ON_NOTIFICATION="on_notification",n.ON_CRYPT_ERROR="on_crypt_error",n.MUTE_AUDIO="mute_audio",n.MUTE_VIDEO="mute_video",n.UNMUTE_AUDIO="unmute_audio",n.UNMUTE_VIDEO="unmute_video",n.ON_P2P_OK="on_p2p_ok",n.RECEIVE_METADATA="receive_metadata",n.ON_DATA_STREAM="on_data_stream",n.ON_RTP_CAPABILITY_CHANGE="on_rtp_capability_change",n.ON_REMOTE_DATASTREAM_UPDATE="on_remote_datastream_update",n.ON_REMOTE_FULL_DATASTREAM_INFO="on_remote_full_datastream_info",n.ENABLE_LOCAL_VIDEO="enable_local_video",n.DISABLE_LOCAL_VIDEO="disable_local_video",n.ENABLE_LOCAL_AUDIO="enable_local_audio",n.DISABLE_LOCAL_AUDIO="disable_local_audio",n.ON_PUBLISHED_USER_LIST="on_published_user_list",n}({}),Ho=function(n){return n.SEND_ONLY="SEND_ONLY",n.RECEIVE_ONLY="RECEIVE_ONLY",n}({}),mn=function(n){return n.CONNECTED="websocket:connected",n.RECONNECTING="websocket:reconnecting",n.WILL_RECONNECT="websocket:will_reconnect",n.CLOSED="websocket:closed",n.FAILED="websocket:failed",n.ON_MESSAGE="websocket:on_message",n.REQUEST_NEW_URLS="websocket:request_new_urls",n.RECONNECT_CREATE_CONNECTION="websocket:reconnect_create_connection",n.ON_TOKEN_PRIVILEGE_DID_EXPIRE="websocket:on_token_privilege_did_expire",n}({});function JL(n){if(typeof n!="string"||!/^[a-zA-Z0-9 \!\#\$\%\&\(\)\+\-\:\;\<\=\.\>\?\@\[\]\^\_\{\}\|\~\,]{1,64}$/.test(n))throw z.error("Invalid Channel Name ".concat(n)),new De(oe.INVALID_PARAMS,"The length must be within 64 bytes. The supported characters: a-z,A-Z,0-9,space,!, #, $, %, &, (, ), +, -, :, ;, <, =, ., >, ?, @, [, ], ^, _,  {, }, |, ~, ,")}function XL(n){if(i=n,!(typeof i=="number"&&Math.floor(i)===i&&0<=i&&i<=4294967295||Sx(n,1,255)))throw new De(oe.INVALID_PARAMS,"[String uid] Length of the string: [1,255]. ASCII characters only. [Number uid] The value range is [0,10000]");var i;typeof n=="string"&&z.warn("You input a string as the user ID, to ensure better end-user experience, Agora highly suggests not using a string as the user ID.")}let Ot=function(n){return n.TRANSCODE="mix_streaming",n.RAW="raw_streaming",n}({}),QL={alpha:1,height:640,width:360,x:0,y:0,zOrder:0,audioChannel:0},CI={x:0,y:0,width:160,height:160,zOrder:255,alpha:1};function id(n,i){Pa(n.url,"".concat(i,".url"),1,1e3,!1),Bt(n.x)||Cr(n.x,"".concat(i,".x"),0,1e4),Bt(n.y)||Cr(n.y,"".concat(i,".y"),0,1e4),Bt(n.width)||Cr(n.width,"".concat(i,".width"),0,1e4),Bt(n.height)||Cr(n.height,"".concat(i,".height"),0,1e4),Bt(n.zOrder)||Cr(n.zOrder,"".concat(i,".zOrder"),0,255),Bt(n.alpha)||Cr(n.alpha,"".concat(i,".alpha"),0,1,!1)}let Wo={audioBitrate:48,audioChannels:1,audioSampleRate:48e3,backgroundColor:0,height:360,lowLatency:!1,videoBitrate:400,videoCodecProfile:100,videoCodecType:1,videoFrameRate:15,videoGop:30,width:640,images:[],userConfigs:[],userConfigExtraInfo:""},Wt=function(n){return n.WARNING="@live_uap-warning",n.ERROR="@line_uap-error",n.PUBLISH_STREAM_STATUS="@live_uap-publish-status",n.WORKER_STATUS="@live_uap-worker-status",n.REQUEST_NEW_ADDRESS="@live_uap-request-address",n}({}),Fr=function(n){return n.REQUEST_WORKER_MANAGER_LIST="@live_req_worker_manager",n}({}),Ft=function(n){return n[n.LIVE_STREAM_RESPONSE_SUCCEED=200]="LIVE_STREAM_RESPONSE_SUCCEED",n[n.LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM=454]="LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM",n[n.LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR=450]="LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR",n[n.LIVE_STREAM_RESPONSE_BAD_STREAM=451]="LIVE_STREAM_RESPONSE_BAD_STREAM",n[n.LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR=400]="LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR",n[n.LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST=404]="LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST",n[n.LIVE_STREAM_RESPONSE_NOT_AUTHORIZED=456]="LIVE_STREAM_RESPONSE_NOT_AUTHORIZED",n[n.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE=457]="LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE",n[n.LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN=429]="LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN",n[n.LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH=452]="LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH",n[n.LIVE_STREAM_RESPONSE_NOT_SUPPORTED=453]="LIVE_STREAM_RESPONSE_NOT_SUPPORTED",n[n.LIVE_STREAM_RESPONSE_MAX_STREAM_NUM=455]="LIVE_STREAM_RESPONSE_MAX_STREAM_NUM",n[n.LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR=500]="LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR",n[n.LIVE_STREAM_RESPONSE_WORKER_LOST=501]="LIVE_STREAM_RESPONSE_WORKER_LOST",n[n.LIVE_STREAM_RESPONSE_RESOURCE_LIMIT=502]="LIVE_STREAM_RESPONSE_RESOURCE_LIMIT",n[n.LIVE_STREAM_RESPONSE_WORKER_QUIT=503]="LIVE_STREAM_RESPONSE_WORKER_QUIT",n[n.ERROR_FAIL_SEND_MESSAGE=504]="ERROR_FAIL_SEND_MESSAGE",n[n.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE=30]="PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE",n[n.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT=31]="PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT",n[n.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH=32]="PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH",n[n.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN=33]="PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN",n}({});function cn(n){if(!n.channelName)throw new De(oe.INVALID_PARAMS,"invalid channelName in info");if(typeof n.uid!="number")throw new De(oe.INVALID_PARAMS,"invalid uid in info, uid must be a number");return n.token&&Pa(n.token,"info.token",1,2047),XL(n.uid),JL(n.channelName),!0}let bs=function(n){return n[n.SetSdkProfile=0]="SetSdkProfile",n[n.SetSourceChannel=1]="SetSourceChannel",n[n.SetSourceUserId=2]="SetSourceUserId",n[n.SetDestChannel=3]="SetDestChannel",n[n.StartPacketTransfer=4]="StartPacketTransfer",n[n.StopPacketTransfer=5]="StopPacketTransfer",n[n.UpdateDestChannel=6]="UpdateDestChannel",n[n.Reconnect=7]="Reconnect",n[n.SetVideoProfile=8]="SetVideoProfile",n}({}),yn=function(n){return n.NETWORK_DISCONNECTED="NETWORK_DISCONNECTED",n.NETWORK_CONNECTED="NETWORK_CONNECTED",n.PACKET_JOINED_SRC_CHANNEL="PACKET_JOINED_SRC_CHANNEL",n.PACKET_JOINED_DEST_CHANNEL="PACKET_JOINED_DEST_CHANNEL",n.PACKET_SENT_TO_DEST_CHANNEL="PACKET_SENT_TO_DEST_CHANNEL",n.PACKET_RECEIVED_VIDEO_FROM_SRC="PACKET_RECEIVED_VIDEO_FROM_SRC",n.PACKET_RECEIVED_AUDIO_FROM_SRC="PACKET_RECEIVED_AUDIO_FROM_SRC",n.PACKET_UPDATE_DEST_CHANNEL="PACKET_UPDATE_DEST_CHANNEL",n.PACKET_UPDATE_DEST_CHANNEL_REFUSED="PACKET_UPDATE_DEST_CHANNEL_REFUSED",n.PACKET_UPDATE_DEST_CHANNEL_NOT_CHANGE="PACKET_UPDATE_DEST_CHANNEL_NOT_CHANGE",n}({}),Vi=function(n){return n.RELAY_STATE_IDLE="RELAY_STATE_IDLE",n.RELAY_STATE_CONNECTING="RELAY_STATE_CONNECTING",n.RELAY_STATE_RUNNING="RELAY_STATE_RUNNING",n.RELAY_STATE_FAILURE="RELAY_STATE_FAILURE",n}({}),hn=function(n){return n.RELAY_OK="RELAY_OK",n.SERVER_CONNECTION_LOST="SERVER_CONNECTION_LOST",n.SRC_TOKEN_EXPIRED="SRC_TOKEN_EXPIRED",n.DEST_TOKEN_EXPIRED="DEST_TOKEN_EXPIRED",n}({}),lr=function(n){return n.High="high",n.Low="low",n.Audio="audio",n.Screen="screen",n.ScreenLow="screen_low",n}({}),La=function(n){return n.DISCONNECT="disconnect",n.CONNECTION_STATE_CHANGE="connection-state-change",n.NETWORK_QUALITY="network-quality",n.STREAM_TYPE_CHANGE="stream-type-change",n.IS_P2P_DISCONNECTED="is-p2p-dis",n.DISCONNECT_P2P="dis-p2p",n.REQUEST_NEW_GATEWAY_LIST="req-gate-url",n.NEED_RENEW_SESSION="need-sid",n.REQUEST_P2P_CONNECTION_PARAMS="request-p2p-connection-params",n.JOIN_RESPONSE="join-response",n.RESET_CONNECTION_EVENTS="reset-connection-events",n.PRE_CONNECT_PC="pre-connect_pc",n.UPDATE_GATEWAY_CONFIG="update-gateway-config",n}({}),rf=function(n){return n.P2P_DISCONNECTED="P2P_DISCONNECTED",n.A_ROUND_WS_FAILED="A_ROUND_WS_FAILED",n.TIMEOUT="TIMEOUT",n.UNKNOWN_REASON="UNKNOWN_REASON",n}({}),Wa=function(n){return n[n.Nothing=0]="Nothing",n[n.Audio=1]="Audio",n[n.LwoVideo=2]="LwoVideo",n[n.Video=4]="Video",n[n.Data=8]="Data",n[n.DataStream0=256]="DataStream0",n[n.DataStream1=512]="DataStream1",n[n.DataStream2=1024]="DataStream2",n[n.DataStream3=2048]="DataStream3",n[n.DataStream4=4096]="DataStream4",n[n.DataStream5=8192]="DataStream5",n[n.DataStream6=16384]="DataStream6",n[n.DataStream7=32768]="DataStream7",n}({}),rr=function(n){return n.CHINA="CHINA",n.ASIA="ASIA",n.NORTH_AMERICA="NORTH_AMERICA",n.EUROPE="EUROPE",n.JAPAN="JAPAN",n.INDIA="INDIA",n.KOREA="KOREA",n.HKMC="HKMC",n.US="US",n.OCEANIA="OCEANIA",n.SOUTH_AMERICA="SOUTH_AMERICA",n.AFRICA="AFRICA",n.OVERSEA="OVERSEA",n.GLOBAL="GLOBAL",n.EXTENSIONS="EXTENSIONS",n}({}),ZL=[rr.AFRICA,rr.ASIA,rr.CHINA,rr.EUROPE,rr.GLOBAL,rr.INDIA,rr.JAPAN,rr.NORTH_AMERICA,rr.OCEANIA,rr.OVERSEA,rr.SOUTH_AMERICA],zs=function(n){return n.CHINA="CN",n.ASIA="AS",n.NORTH_AMERICA="NA",n.EUROPE="EU",n.JAPAN="JP",n.INDIA="IN",n.KOREA="KR",n.HKMC="HK",n.US="US",n.OCEANIA="OC",n.SOUTH_AMERICA="SA",n.AFRICA="AF",n.OVERSEA="OVERSEA",n.GLOBAL="GLOBAL",n.EXTENSIONS="GLOBAL",n}({}),yh={CHINA:{},ASIA:{CODE:zs.ASIA,WEBCS_DOMAIN:["ap-web-1-asia.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-asia.agora.io"],PROXY_CS:["proxy-ap-web-asia.agora.io"],CDS_AP:["cds-ap-web-asia.agora.io","cds-ap-web-asia2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-asia.agora.io","sua-ap-web-asia2.agora.io"],UAP_AP:["uap-ap-web-asia.agora.io","uap-ap-web-asia2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-asia.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-asia.agora.io"],LOG_UPLOAD_SERVER:["logservice-asia.agora.io"],PROXY_SERVER_TYPE3:["southeast-asia.webrtc-cloud-proxy.sd-rtn.com"]},NORTH_AMERICA:{CODE:zs.NORTH_AMERICA,WEBCS_DOMAIN:["ap-web-1-north-america.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-north-america.agora.io"],PROXY_CS:["proxy-ap-web-america.agora.io"],CDS_AP:["cds-ap-web-america.agora.io","cds-ap-web-america2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-america.agora.io","sua-ap-web-america2.agora.io"],UAP_AP:["uap-ap-web-america.agora.io","uap-ap-web-america2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-north-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-north-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-north-america.agora.io"],PROXY_SERVER_TYPE3:["east-usa.webrtc-cloud-proxy.sd-rtn.com"]},EUROPE:{CODE:zs.EUROPE,WEBCS_DOMAIN:["ap-web-1-europe.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-europe.agora.io"],PROXY_CS:["proxy-ap-web-europe.agora.io"],CDS_AP:["cds-ap-web-europe.agora.io","cds-ap-web-europe2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-europe.agora.io","sua-ap-web-europe.agora.io"],UAP_AP:["uap-ap-web-europe.agora.io","uap-ap-web-europe2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-europe.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-europe.agora.io"],LOG_UPLOAD_SERVER:["logservice-europe.agora.io"],PROXY_SERVER_TYPE3:["europe.webrtc-cloud-proxy.sd-rtn.com"]},JAPAN:{CODE:zs.JAPAN,WEBCS_DOMAIN:["ap-web-1-japan.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-japan.agora.io"],PROXY_CS:["proxy-ap-web-japan.agora.io"],CDS_AP:["cds-ap-web-japan.agora.io","cds-ap-web-japan2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-japan.agora.io","sua-ap-web-japan2.agora.io"],UAP_AP:["uap-ap-web-japan.agora.io","uap-ap-web-japan2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-japan.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-japan.agora.io"],LOG_UPLOAD_SERVER:["logservice-japan.agora.io"],PROXY_SERVER_TYPE3:["japan.webrtc-cloud-proxy.sd-rtn.com"]},INDIA:{CODE:zs.INDIA,WEBCS_DOMAIN:["ap-web-1-india.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-india.agora.io"],PROXY_CS:["proxy-ap-web-india.agora.io"],CDS_AP:["cds-ap-web-india.agora.io","cds-ap-web-india2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-india.agora.io","sua-ap-web-india2.agora.io"],UAP_AP:["uap-ap-web-india.agora.io","uap-ap-web-india2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-india.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-india.agora.io"],LOG_UPLOAD_SERVER:["logservice-india.agora.io"],PROXY_SERVER_TYPE3:["india.webrtc-cloud-proxy.sd-rtn.com"]},KOREA:{CODE:zs.KOREA,WEBCS_DOMAIN:["ap-web-1-korea.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-korea.agora.io"],PROXY_CS:["proxy-ap-web-korea.agora.io"],CDS_AP:["cds-ap-web-korea.agora.io","cds-ap-web-korea2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-korea.agora.io","sua-ap-web-korea2.agora.io"],UAP_AP:["uap-ap-web-korea.agora.io","uap-ap-web-korea2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-korea.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-korea.agora.io"],LOG_UPLOAD_SERVER:["logservice-korea.agora.io"],PROXY_SERVER_TYPE3:["korea.webrtc-cloud-proxy.sd-rtn.com"]},HKMC:{CODE:zs.HKMC,WEBCS_DOMAIN:["ap-web-1-hkmc.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-hkmc.agora.io"],PROXY_CS:["proxy-ap-web-hkmc.agora.io"],CDS_AP:["cds-ap-web-hkmc.agora.io","cds-ap-web-hkmc2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-hkmc.agora.io","sua-ap-web-hkmc2.agora.io"],UAP_AP:["uap-ap-web-hkmc.agora.io","uap-ap-web-hkmc2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-hkmc.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-hkmc.agora.io"],LOG_UPLOAD_SERVER:["logservice-hkmc.agora.io"],PROXY_SERVER_TYPE3:["hkmc.webrtc-cloud-proxy.sd-rtn.com"]},US:{CODE:zs.US,WEBCS_DOMAIN:["ap-web-1-us.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-us.agora.io"],PROXY_CS:["proxy-ap-web-us.agora.io"],CDS_AP:["cds-ap-web-us.agora.io","cds-ap-web-us2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-us.agora.io","sua-ap-web-us2.agora.io"],UAP_AP:["uap-ap-web-us.agora.io","uap-ap-web-us2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-us.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-us.agora.io"],LOG_UPLOAD_SERVER:["logservice-us.agora.io"],PROXY_SERVER_TYPE3:["us.webrtc-cloud-proxy.sd-rtn.com"]},OVERSEA:{CODE:zs.OVERSEA,WEBCS_DOMAIN:["ap-web-1-oversea.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-oversea.agora.io"],PROXY_CS:["proxy-ap-web-oversea.agora.io"],CDS_AP:["cds-ap-web-oversea.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-oversea.agora.io"],UAP_AP:["uap-ap-web-oversea.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oversea.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oversea.agora.io"],LOG_UPLOAD_SERVER:["logservice-oversea.agora.io"],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.agora.io"]},GLOBAL:{CODE:zs.GLOBAL,WEBCS_DOMAIN:["webrtc2-ap-web-1.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-ap-web-3.agora.io"],PROXY_CS:["ap-proxy-1.agora.io","ap-proxy-2.agora.io"],CDS_AP:["cds-ap-web-1.agora.io","cds-ap-web-3.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-1.agora.io","sua-ap-web-3.agora.io"],UAP_AP:["uap-ap-web-1.agora.io","uap-ap-web-3.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2.agora.io"],LOG_UPLOAD_SERVER:["logservice.agora.io"],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.sd-rtn.com"]},OCEANIA:{CODE:zs.OCEANIA,WEBCS_DOMAIN:["ap-web-1-oceania.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-oceania.agora.io"],PROXY_CS:["proxy-ap-web-oceania.agora.io"],CDS_AP:["cds-ap-web-oceania.agora.io","cds-ap-web-oceania2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-oceania.agora.io","sua-ap-web-oceania2.agora.io"],UAP_AP:["uap-ap-web-oceania.agora.io","uap-ap-web-oceania2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oceania.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oceania.agora.io"],LOG_UPLOAD_SERVER:["logservice-oceania.agora.io"],PROXY_SERVER_TYPE3:["oceania.webrtc-cloud-proxy.sd-rtn.com"]},SOUTH_AMERICA:{CODE:zs.SOUTH_AMERICA,WEBCS_DOMAIN:["ap-web-1-south-america.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-south-america.agora.io"],PROXY_CS:["proxy-ap-web-south-america.agora.io"],CDS_AP:["cds-ap-web-south-america.agora.io","cds-ap-web-south-america2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-south-america.agora.io","sua-ap-web-south-america2.agora.io"],UAP_AP:["uap-ap-web-south-america.agora.io","uap-ap-web-south-america2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-south-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-south-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-america.agora.io"],PROXY_SERVER_TYPE3:["south-america.webrtc-cloud-proxy.sd-rtn.com"]},AFRICA:{CODE:zs.AFRICA,WEBCS_DOMAIN:["ap-web-1-africa.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-africa.agora.io"],PROXY_CS:["proxy-ap-web-africa.agora.io"],CDS_AP:["cds-ap-web-africa.agora.io","cds-ap-web-africa2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-africa.agora.io","sua-ap-web-africa2.agora.io"],UAP_AP:["uap-ap-web-africa.agora.io","uap-ap-web-africa2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-africa.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-africa.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-africa.agora.io"],PROXY_SERVER_TYPE3:["africa.webrtc-cloud-proxy.sd-rtn.com"]},EXTENSIONS:{}};bS&&(yh.CHINA={CODE:zs.CHINA,WEBCS_DOMAIN:["webrtc2-2.ap.sd-rtn.com"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-4.ap.sd-rtn.com"],PROXY_CS:["proxy-web.ap.sd-rtn.com"],CDS_AP:["cds-web-2.ap.sd-rtn.com","cds-web-4.ap.sd-rtn.com"],ACCOUNT_REGISTER:["sua-web-2.ap.sd-rtn.com","sua-web-4.ap.sd-rtn.com"],UAP_AP:["uap-web-2.ap.sd-rtn.com","uap-web-4.ap.sd-rtn.com"],EVENT_REPORT_DOMAIN:["web-3.statscollector.sd-rtn.com"],EVENT_REPORT_BACKUP_DOMAIN:["web-4.statscollector.sd-rtn.com"],LOG_UPLOAD_SERVER:["logservice-china.agora.io"],PROXY_SERVER_TYPE3:["east-cn.webrtc-cloud-proxy.sd-rtn.com"]});let PS=function(n){return n.UPDATE_BITRATE_LIMIT="update_bitrate_limit",n.UPDATE_CLIENT_ROLE_OPTIONS="update_client_role_options",n}({});function ya(n){return!!n&&!(!n.uplink||!n.id)&&n.uplink.max_bitrate!==void 0&&n.uplink.min_bitrate!==void 0}class gU extends li{constructor(i,a){super(),re(this,"onICEConnectionStateChange",void 0),re(this,"onConnectionStateChange",void 0),re(this,"onDTLSTransportStateChange",void 0),re(this,"onDTLSTransportError",void 0),re(this,"onICETransportStateChange",void 0),re(this,"onFirstAudioReceived",void 0),re(this,"onFirstVideoReceived",void 0),re(this,"onFirstAudioDecoded",void 0),re(this,"onFirstVideoDecoded",void 0),re(this,"onFirstVideoDecodedTimeout",void 0),re(this,"onSelectedLocalCandidateChanged",void 0),re(this,"onSelectedRemoteCandidateChanged",void 0),re(this,"onICECandidateError",void 0),re(this,"getLocalVideoStats",void 0)}}class bo extends gU{constructor(i,a){super(i,a),re(this,"establishPromise",void 0)}}let Tt=function(n){return n.VIDEO="video",n.AUDIO="audio",n}({}),hi=function(n){return n.UDP_RELAY="udp_relay",n.UDP_TCP_RELAY="udp_tcp_relay",n.TCP_RELAY="tcp_relay",n.RELAY="relay",n}({}),ad=function(n){return n[n.FIRST_CONNECTION=0]="FIRST_CONNECTION",n[n.UDP_TCP_RESTART=1]="UDP_TCP_RESTART",n[n.RELAY_RESTART=2]="RELAY_RESTART",n[n.TCP_RESTART=3]="TCP_RESTART",n[n.OLD_FIRST_CONNECTION=10]="OLD_FIRST_CONNECTION",n[n.OLD_RESTART=11]="OLD_RESTART",n[n.DISCONNECTED_OR_FAILED=20]="DISCONNECTED_OR_FAILED",n}({}),Er=["disconnected","failed"],Qe=function(n){return n.LocalVideoTrack="videoTrack",n.LocalAudioTrack="audioTrack",n.LocalVideoLowTrack="videoLowTrack",n}({}),or=function(n){return n.New="new",n.Connected="connected",n.Reconnecting="reconnecting",n.Disconnected="disconnected",n}({}),Mt=function(n){return n.AudioMetadata="audioMetadata",n.StateChange="stateChange",n.IceConnectionStateChange="iceConnectionStateChange",n.RequestMuteLocal="requestMuteLocal",n.RequestUnmuteLocal="requestUnmuteLocal",n.RequestRePublish="requestRePublish",n.RequestRePublishDataChannel="requestRePublishDataChannel",n.RequestReSubscribe="requestReSubscribe",n.RequestUploadStats="requestUploadStats",n.RequestUpload="requestUpload",n.MediaReconnectStart="MediaReconnectStart",n.MediaReconnectEnd="MediaReconnectEnd",n.NeedSignalRTT="NeedSignalRTT",n.RequestRestartICE="RequestRestartIce",n.PeerConnectionStateChange="PeerConnectionStateChange",n.RequestReconnect="RequestReconnect",n.RequestReconnectPC="RequestReconnectPC",n.RequestUnpublishForReconnectPC="RequestUnpublishForReconnectPC",n.P2PLost="P2PLost",n.UpdateVideoEncoder="UpdateVideoEncoder",n.ConnectionTypeChange="ConnectionTypeChange",n.RequestLowStreamParameter="RequestLowStreamParameter",n.QueryClientConnectionState="QueryClientConnectionState",n.LocalCandidate="LocalCandidate",n.RequestP2PMuteLocal="requestP2PMuteLocal",n.RequestP2PUnPublish="RequestP2PUnPublish",n.RequestP2PUnmuteRemote="RequestP2PUnmuteRemote",n.RequestP2PMuteRemote="RequestP2PMuteRemote",n.RequestP2PRestartICE="RequestP2PRestartICE",n}({}),An=function(n){return n.CONNECTING="CONNECTING",n.RECONNECTING="RECONNECTING",n.CONNECTED="CONNECTED",n.CLOSED="CLOSED",n}({}),nu=function(n){return n[n.CONNECT_AP=0]="CONNECT_AP",n[n.AP_CONNECTED=1]="AP_CONNECTED",n[n.CONNECT_WORKER_MANAGER=2]="CONNECT_WORKER_MANAGER",n[n.WORKER_MANAGER_CONNECTED=3]="WORKER_MANAGER_CONNECTED",n[n.GET_WORKER_MANAGER_RESPONSE=4]="GET_WORKER_MANAGER_RESPONSE",n[n.CONNECT_WORKER=5]="CONNECT_WORKER",n[n.WORKER_CONNECTED=6]="WORKER_CONNECTED",n[n.CLOSED=7]="CLOSED",n}({}),Ir=function(n){return n.CONNECTION_STATE_CHANGE="connection-state-change",n.STATE_CHANGE="state-change",n.INSPECT_RESULT="inspect-result",n.CLIENT_LOCAL_VIDEO_TRACK="client-local-video-track",n.REQUEST_NEW_WORKER_URL="request-new-worker-url",n}({}),wI=function(n){return n.CONNECTED="transmitter:connected",n.RECONNECTING="transmitter:reconnecting",n.WILL_RECONNECT="transmitter:will_reconnect",n.CLOSED="transmitter:closed",n.FAILED="transmitter:failed",n.ON_MESSAGE="transmitter:on_message",n.REQUEST_NEW_URLS="transmitter:request_new_urls",n.RECONNECT_CREATE_CONNECTION="transmitter:reconnect_create_connection",n.ON_TOKEN_PRIVILEGE_DID_EXPIRE="transmitter:on_token_privilege_did_expire",n.TO_CONNECT_DATACHANNEL="transmitter:to_connect_datachannel",n.FAILBACK="transmitter:failback",n.PRE_CONNECT_PC="transmitter:pre_connect_pc",n}({}),sd=function(n){return n.CAMERA_CHANGED="camera-changed",n.MICROPHONE_CHANGED="microphone-changed",n.PLAYBACK_DEVICE_CHANGED="playback-device-changed",n.AUDIO_AUTOPLAY_FAILED="audio-autoplay-failed",n.AUTOPLAY_FAILED="autoplay-failed",n.AUDIO_CONTEXT_STATE_CHANGED="audio-context-state-changed",n.SECURITY_POLICY_VIOLATION="security-policy-violation",n}({}),od=function(n){return n.CONNECTING="CONNECTING",n.RECONNECTING="RECONNECTING",n.CONNECTED="CONNECTED",n.CLOSED="CLOSED",n}({}),af=function(n){return n.CONNECTION_STATE_CHANGE="connection-state-change",n.STATE_CHANGE="state-change",n.INSPECT_RESULT="inspect-result",n.CLIENT_LOCAL_VIDEO_TRACK="client-local-video-track",n.REQUEST_NEW_WORKER_URL="request-new-worker-url",n}({}),MS=function(n){return n[n.CONNECT_AP=0]="CONNECT_AP",n[n.AP_CONNECTED=1]="AP_CONNECTED",n[n.CONNECT_WORKER_MANAGER=2]="CONNECT_WORKER_MANAGER",n[n.WORKER_MANAGER_CONNECTED=3]="WORKER_MANAGER_CONNECTED",n[n.GET_WORKER_MANAGER_RESPONSE=4]="GET_WORKER_MANAGER_RESPONSE",n[n.CONNECT_WORKER=5]="CONNECT_WORKER",n[n.WORKER_CONNECTED=6]="WORKER_CONNECTED",n[n.CLOSED=7]="CLOSED",n}({}),ut=function(n){return n.CALL="call",n.CANDIDATE="candidate",n.PUBLISH="publish",n.UNPUBLISH="unpublish",n.CONTROL="control",n.RESTART_ICE="restart_ice",n.ACK="ack",n.RESPONSE="response",n.JOIN="join",n.CHECK="check",n}({}),Ua=function(n){return n.ABORT="abort",n}({}),zc=function(n){return n.MUTE_LOCAL_AUDIO="mute_local_audio",n.MUTE_LOCAL_VIDEO="mute_local_video",n.UNMUTE_LOCAL_AUDIO="unmute_local_audio",n.UNMUTE_LOCAL_VIDEO="unmute_local_video",n}({}),F8=function(n){return n.P2P_TOKEN_TIMEOUT="p2p_token_timeout",n.P2P_TOKEN_CHANGED="p2p_token_changed",n}({}),at={[qL.ACCESS_POINT]:{[zo.NO_FLAG_SET]:{desc:"flag is zero",retry:!1},[zo.FLAG_SET_BUT_EMPTY]:{desc:"flag is empty",retry:!1},[zo.INVALID_FALG_SET]:{desc:"invalid flag",retry:!1},[zo.FLAG_SET_BUT_NO_RE]:{desc:"flag set unilbs but no request",retry:!1},[zo.INVALID_SERVICE_ID]:{desc:"invalid service id",retry:!1},[zo.NO_SERVICE_AVAILABLE]:{desc:"no service available",retry:!0},[zo.NO_SERVICE_AVAILABLE_P2P]:{desc:"no unilbs p2p service available",retry:!0},[zo.NO_SERVICE_AVAILABLE_VOICE]:{desc:"no unilbs voice service available",retry:!0},[zo.NO_SERVICE_AVAILABLE_WEBRTC]:{desc:"no unilbs webrtc service available",retry:!0},[zo.NO_SERVICE_AVAILABLE_CDS]:{desc:"no cds service available",retry:!0},[zo.NO_SERVICE_AVAILABLE_CDN]:{desc:"no cdn dispatcher service available",retry:!0},[zo.NO_SERVICE_AVAILABLE_TDS]:{desc:"no tds service available",retry:!0},[zo.NO_SERVICE_AVAILABLE_REPORT]:{desc:"no unilbs report service available",retry:!0},[zo.NO_SERVICE_AVAILABLE_APP_CENTER]:{desc:"no app center service available",retry:!0},[zo.NO_SERVICE_AVAILABLE_ENV0]:{desc:"no unilbs sig env0 service available",retry:!0},[zo.NO_SERVICE_AVAILABLE_VOET]:{desc:"no unilbs voet service available",retry:!0},[zo.NO_SERVICE_AVAILABLE_STRING_UID]:{desc:"no string uid service available",retry:!0},[zo.NO_SERVICE_AVAILABLE_WEBRTC_UNILBS]:{desc:"no webrtc unilbs service available",retry:!0}},[qL.UNILBS]:{[nf.INVALID_VENDOR_KEY]:{desc:"invalid vendor key, can not find appid",retry:!1},[nf.INVALID_CHANNEL_NAME]:{desc:"invalid channel name",retry:!1},[nf.INTERNAL_ERROR]:{desc:"unilbs internal error",retry:!1},[nf.NO_AUTHORIZED]:{desc:"invalid token, authorized failed",retry:!1},[nf.DYNAMIC_KEY_TIMEOUT]:{desc:"dynamic key or token timeout",retry:!1},[nf.NO_ACTIVE_STATUS]:{desc:"no active status",retry:!1},[nf.DYNAMIC_KEY_EXPIRED]:{desc:"dynamic key expired",retry:!1},[nf.STATIC_USE_DYNAMIC_KEY]:{desc:"static use dynamic key",retry:!1},[nf.DYNAMIC_USE_STATIC_KEY]:{desc:"dynamic use static key",retry:!1},[nf.USER_OVERLOAD]:{desc:"amount of users over load",retry:!1},[nf.FORBIDDEN_REGION]:{desc:"the request is forbidden in this area",retry:!1},[nf.CANNOT_MEET_AREA_DEMAND]:{desc:"unable to allocate services in this area",retry:!1}},[qL.STRING_UID_ALLOCATOR]:{[mU.IIIEGAL_APPID]:{desc:"invalid appid",retry:!1},[mU.IIIEGAL_UID]:{desc:"invalid string uid",retry:!1},[mU.INTERNAL_ERROR]:{desc:"string uid allocator internal error",retry:!0}}};function Qn(n){let i=at[Math.floor(n/1e4)];if(!i)return{desc:"unknown error",retry:!1};let a=i[n%1e4];if(!a){if(Math.floor(n/1e4)===qL.ACCESS_POINT){let c=n%1e4;if(c.toString()[0]==="1")return{desc:n.toString(),retry:!1};if(c.toString()[0]==="2")return{desc:n.toString(),retry:!0}}return{desc:"unknown error",retry:!1}}return a}let Yt={[Zt.K_TIMESTAMP_EXPIRED]:{desc:"K_TIMESTAMP_EXPIRED",action:"failed"},[Zt.K_CHANNEL_PERMISSION_INVALID]:{desc:"K_CHANNEL_PERMISSION_INVALID",action:"failed"},[Zt.K_CERTIFICATE_INVALID]:{desc:"K_CERTIFICATE_INVALID",action:"failed"},[Zt.K_CHANNEL_NAME_EMPTY]:{desc:"K_CHANNEL_NAME_EMPTY",action:"failed"},[Zt.K_CHANNEL_NOT_FOUND]:{desc:"K_CHANNEL_NOT_FOUND",action:"failed"},[Zt.K_TICKET_INVALID]:{desc:"K_TICKET_INVALID",action:"failed"},[Zt.K_CHANNEL_CONFLICTED]:{desc:"K_CHANNEL_CONFLICTED",action:"failed"},[Zt.K_SERVICE_NOT_READY]:{desc:"K_SERVICE_NOT_READY",action:"tryNext"},[Zt.K_SERVICE_TOO_HEAVY]:{desc:"K_SERVICE_TOO_HEAVY",action:"tryNext"},[Zt.K_UID_BANNED]:{desc:"K_UID_BANNED",action:"failed"},[Zt.K_IP_BANNED]:{desc:"K_IP_BANNED",action:"failed"},[Zt.DATASTREAM2_NOT_AVAILABLE]:{desc:"DATASTREAM2_NOT_AVAILABLE",action:"quit"},[Zt.K_AUTO_REBALANCE]:{desc:"k_AUTO_REBALANCE",action:"recover"},[Zt.ERR_INVALID_VENDOR_KEY]:{desc:"ERR_INVALID_VENDOR_KEY",action:"failed"},[Zt.ERR_INVALID_CHANNEL_NAME]:{desc:"ERR_INVALID_CHANNEL_NAME",action:"failed"},[Zt.WARN_NO_AVAILABLE_CHANNEL]:{desc:"WARN_NO_AVAILABLE_CHANNEL",action:"failed"},[Zt.WARN_LOOKUP_CHANNEL_TIMEOUT]:{desc:"WARN_LOOKUP_CHANNEL_TIMEOUT",action:"tryNext"},[Zt.WARN_LOOKUP_CHANNEL_REJECTED]:{desc:"WARN_LOOKUP_CHANNEL_REJECTED",action:"failed"},[Zt.WARN_OPEN_CHANNEL_TIMEOUT]:{desc:"WARN_OPEN_CHANNEL_TIMEOUT",action:"tryNext"},[Zt.WARN_OPEN_CHANNEL_REJECTED]:{desc:"WARN_OPEN_CHANNEL_REJECTED",action:"failed"},[Zt.WARN_REQUEST_DEFERRED]:{desc:"WARN_REQUEST_DEFERRED",action:"failed"},[Zt.ERR_DYNAMIC_KEY_TIMEOUT]:{desc:"ERR_DYNAMIC_KEY_TIMEOUT",action:"failed"},[Zt.ERR_NO_AUTHORIZED]:{desc:"ERR_NO_AUTHORIZED",action:"failed"},[Zt.ERR_VOM_SERVICE_UNAVAILABLE]:{desc:"ERR_VOM_SERVICE_UNAVAILABLE",action:"tryNext"},[Zt.ERR_NO_CHANNEL_AVAILABLE_CODE]:{desc:"ERR_NO_CHANNEL_AVAILABLE_CODE",action:"failed"},[Zt.ERR_MASTER_VOCS_UNAVAILABLE]:{desc:"ERR_MASTER_VOCS_UNAVAILABLE",action:"tryNext"},[Zt.ERR_INTERNAL_ERROR]:{desc:"ERR_INTERNAL_ERROR",action:"tryNext"},[Zt.ERR_NO_ACTIVE_STATUS]:{desc:"ERR_NO_ACTIVE_STATUS",action:"failed"},[Zt.ERR_INVALID_UID]:{desc:"ERR_INVALID_UID",action:"failed"},[Zt.ERR_DYNAMIC_KEY_EXPIRED]:{desc:"ERR_DYNAMIC_KEY_EXPIRED",action:"failed"},[Zt.ERR_STATIC_USE_DYANMIC_KE]:{desc:"ERR_STATIC_USE_DYANMIC_KE",action:"failed"},[Zt.ERR_DYNAMIC_USE_STATIC_KE]:{desc:"ERR_DYNAMIC_USE_STATIC_KE",action:"failed"},[Zt.ERR_NO_VOCS_AVAILABLE]:{desc:"ERR_NO_VOCS_AVAILABLE",action:"tryNext"},[Zt.ERR_NO_VOS_AVAILABLE]:{desc:"ERR_NO_VOS_AVAILABLE",action:"tryNext"},[Zt.ERR_JOIN_CHANNEL_TIMEOUT]:{desc:"ERR_JOIN_CHANNEL_TIMEOUT",action:"tryNext"},[Zt.ERR_JOIN_BY_MULTI_IP]:{desc:"ERR_JOIN_BY_MULTI_IP",action:"recover"},[Zt.ERR_NOT_JOINED]:{desc:"ERR_NOT_JOINED",action:"failed"},[Zt.ERR_REPEAT_JOIN_REQUEST]:{desc:"ERR_REPEAT_JOIN_REQUEST",action:"quit"},[Zt.ERR_REPEAT_JOIN_CHANNEL]:{desc:"ERR_REPEAT_JOIN_CHANNEL",action:"quit"},[Zt.ERR_INVALID_STRINGUID]:{desc:"ERR_INVALID_STRINGUID",action:"failed"},[Zt.ERR_TOO_MANY_USERS]:{desc:"ERR_TOO_MANY_USERS",action:"tryNext"},[Zt.ERR_SET_CLIENT_ROLE_TIMEOUT]:{desc:"ERR_SET_CLIENT_ROLE_TIMEOUT",action:"failed"},[Zt.ERR_SET_CLIENT_ROLE_NO_PERMISSION]:{desc:"ERR_SET_CLIENT_ROLE_TIMEOUT",action:"failed"},[Zt.ERR_SET_CLIENT_ROLE_ALREADY_IN_USE]:{desc:"ERR_SET_CLIENT_ROLE_ALREADY_IN_USE",action:"success"},[Zt.ERR_PUBLISH_REQUEST_INVALID]:{desc:"ERR_PUBLISH_REQUEST_INVALID",action:"failed"},[Zt.ERR_SUBSCRIBE_REQUEST_INVALID]:{desc:"ERR_SUBSCRIBE_REQUEST_INVALID",action:"failed"},[Zt.ERR_NOT_SUPPORTED_MESSAGE]:{desc:"ERR_NOT_SUPPORTED_MESSAGE",action:"failed"},[Zt.ERR_ILLEAGAL_PLUGIN]:{desc:"ERR_ILLEAGAL_PLUGIN",action:"failed"},[Zt.ILLEGAL_CLIENT_ROLE_LEVEL]:{desc:"ILLEGAL_CLIENT_ROLE_LEVEL",action:"failed"},[Zt.ERR_REJOIN_TOKEN_INVALID]:{desc:"ERR_REJOIN_TOKEN_INVALID",action:"failed"},[Zt.ERR_REJOIN_USER_NOT_JOINED]:{desc:"ERR_REJOIN_NOT_JOINED",action:"failed"},[Zt.ERR_INVALID_OPTIONAL_INFO]:{desc:"ERR_INVALID_OPTIONAL_INFO",action:"quit"},[Zt.ERR_TEST_RECOVER]:{desc:"ERR_TEST_RECOVER",action:"recover"},[Zt.ERR_TEST_TRYNEXT]:{desc:"ERR_TEST_TRYNEXT",action:"recover"},[Zt.ERR_TEST_RETRY]:{desc:"ERR_TEST_RETRY",action:"recover"},[Zt.ILLEGAL_AES_PASSWORD]:{desc:"ERR_TEST_RETRY",action:"failed"},[Zt.ERR_TOO_MANY_BROADCASTERS]:{desc:"ERR_TOO_MANY_BROADCASTERS",action:"failed"},[Zt.ERR_TOO_MANY_SUBSCRIBERS]:{desc:"ERR_TOO_MANY_SUBSCRIBERS",action:"failed"},[Zt.ERR_LICENSE_ILLEGAL]:{desc:"ERR_LICENSE_ILLEGAL",action:"quit"},[Zt.ERR_LICENSE_MISSING]:{desc:"ERR_LICENSE_MISSING",action:"quit"},[Zt.ERR_LICENSE_EXPIRED]:{desc:"ERR_LICENSE_EXPIRED",action:"quit"},[Zt.ERR_LICENSE_MINUTES_EXCEEDED]:{desc:"ERR_LICENSE_MINUTES_EXCEEDED",action:"quit"},[Zt.ERR_LICENSE_PERIOD_INVALID]:{desc:"ERR_LICENSE_PERIOD_INVALID",action:"quit"},[Zt.ERR_LICENSE_MULTIPLE_SDK_SERVICE]:{desc:"ERR_LICENSE_MULTIPLE_SDK_SERVICE",action:"quit"}};function Hc(n){return Yt[n]||{desc:"UNKNOWN_ERROR_".concat(n),action:"failed"}}function ru(n,i){var a=Object.keys(n);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(n);i&&(c=c.filter(function(u){return Object.getOwnPropertyDescriptor(n,u).enumerable})),a.push.apply(a,c)}return a}function ja(n){for(var i=1;i<arguments.length;i++){var a=arguments[i]!=null?arguments[i]:{};i%2?ru(Object(a),!0).forEach(function(c){re(n,c,a[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(a)):ru(Object(a)).forEach(function(c){Object.defineProperty(n,c,Object.getOwnPropertyDescriptor(a,c))})}return n}function _U(n,i){if(typeof n=="string")return n;let{proxy:a,host:c,port:u}=n;if(i){let _=ge("JOIN_GATEWAY_FALLBACK_PORT")||443;return _===443?"wss://".concat(c,"/ws/?p=").concat(Number(u)+150):"wss://".concat(c,":").concat(_,"/ws/?p=").concat(Number(u)+150)}return a?"wss://".concat(a,"/ws/?h=").concat(c,"&p=").concat(u):"wss://".concat(c,":").concat(u)}let Kp=/wss:\/\/(.+)\/ws\/\?h=(.+)&p=([0-9]+)\/?/,iu=/wss:\/\/(.+)\/ws\/\?p=([0-9]+)\/?/,Th=/wss:\/\/(.+):([0-9]+)\/?/,o1=/wss:\/\/(.[^\/]+)\/?/,ia=0;class c1{constructor(i,a){re(this,"id",0),re(this,"store",void 0),re(this,"recordIndex",void 0),re(this,"websockets",[]),re(this,"try443PortDuration",2e3),re(this,"forceCloseWSDuration",5e3),re(this,"try443PortTimeout",null),re(this,"forceCloseTimeout",null),re(this,"isTry443PortFailed",!1),re(this,"isNormalPortFailed",!1),re(this,"useDoubleDomain",!1),re(this,"useProxy",!1),re(this,"startTime",Date.now()),this.id=++ia,this.try443PortDuration=ge("JOIN_GATEWAY_TRY_443PORT_DURATION")||2e3,this.forceCloseWSDuration=i||5e3,this.store=a}closeAllWebsockets(){this.websockets.forEach(i=>{i.onopen=null,i.onclose=null,i.onmessage=null,i.close()}),this.websockets.length=0}clearTimeout(){this.forceCloseTimeout&&clearTimeout(this.forceCloseTimeout),this.try443PortTimeout&&clearTimeout(this.try443PortTimeout),this.forceCloseTimeout=null,this.try443PortTimeout=null}logger(){var i;let a=Date.now()-this.startTime;for(var c=arguments.length,u=new Array(c),_=0;_<c;_++)u[_]=arguments[_];z.debug("[choose-best-ws ".concat((i=this.store)===null||i===void 0?void 0:i.clientId," ").concat(this.id,"] ").concat(a,"ms:"),...u)}createWebSocket(i,a,c){this.logger("createWebSocket:",i,{isTry443Port:a,hasTimeoutDetection:c});let u=ge("GATEWAY_DOMAINS"),_=Date.now(),S=[],C=u.find(s=>{var l;return ft(l=i.host).call(l,s)});C||(this.useDoubleDomain=!1);let R=[];if(this.useDoubleDomain)u.forEach(s=>{R.push(_U(ja(ja({},i),{},{host:i.host.replace(C,s)}),a))});else{let s=ja({},i);if(a&&C){let l=u.find(f=>f!==C);l&&(s.host=s.host.replace(C,l))}R.push(_U(s,a))}try{R.forEach(s=>{let l=new WebSocket(s);l.binaryType="arraybuffer",S.push(l),this.logger("ws is connecting:",l.url)})}catch(s){if(this.logger("ws create failed"),S.forEach(l=>l.close()),S.length=0,this.useDoubleDomain)return this.useDoubleDomain=!1,this.createWebSocket(i,a,c);if(!a&&Number(i.port)!==443)return this.createWebSocket(i,!0,c);throw new De(oe.WS_ERR,"init websocket failed! Error: ".concat(s.toString()))}let e=O_();this.store&&this.store.recordJoinChannelService({urls:S.map(s=>s.url),service:"gateway"},this.recordIndex),S.forEach(s=>{s.onopen=()=>{this.logger("onopen: ws ".concat(s.url," open cost ").concat(Date.now()-_,"ms")),this.websockets.forEach(l=>{l!==s&&(l.onopen=null,l.onclose=null,l.onmessage=null,l.close(),this.logger("close backup websocket: ".concat(l.url)))}),this.websockets.length=0,e.resolve(s)},s.onclose=l=>{this.logger("onclose: ws ".concat(s.url," closed cost ").concat(Date.now()-_,"ms state: ").concat(s.readyState));let f=S.every(m=>m.readyState===WebSocket.CLOSED||m.readyState===WebSocket.CLOSING);this.logger("".concat(a?"443":"47xx"," websocket closed, all failed: ").concat(f)),f&&(a||this.isTry443PortFailed||this.useProxy)?(this.logger("onclose: all websocket is closed, ".concat(l.reason)),e.reject({code:l.code,reason:rf.A_ROUND_WS_FAILED})):!a&&f&&!this.isNormalPortFailed&&this.try443PortTimeout&&(this.logger("all 47xx websocket is closed, try 443 port"),this.clearTimeout(),r()),a?this.isTry443PortFailed=f:this.isNormalPortFailed=f},s.onmessage=l=>this.logger("".concat(s.url," onmessage: ").concat(l.data))}),this.websockets.push(...S);let t=()=>{this.websockets.forEach(s=>s.readyState!==WebSocket.OPEN&&s.close())},r=()=>{if(e.isResolved)return t();En().os===Ra.MAC_OS&&Ni()&&t(),this.createWebSocket(i,!0,!0).then(s=>{e.resolve(s)}).catch(s=>{this.isNormalPortFailed&&e.reject(s),this.logger("try 443 port to create ws failed")}),this.forceCloseTimeout=window.setTimeout(()=>{this.logger("5s timeout close un-opens, isWebsocket created: ",e.isResolved),this.forceCloseTimeout=null,t()},this.forceCloseWSDuration)};return c||(()=>{if(a||this.useProxy)return this.logger("add 5s timeout at ".concat(a?"try-443":"proxy"," condition")),this.forceCloseTimeout=window.setTimeout(()=>{this.forceCloseTimeout=null,t()},this.forceCloseWSDuration);this.try443PortTimeout=window.setTimeout(()=>{this.logger("2s timeout, isWebsocket created: ",e.isResolved),this.try443PortTimeout=null,r()},this.try443PortDuration)})(),e.promise}chooseBestWebsocket(i,a,c,u){return this.useDoubleDomain=!!a,typeof i=="string"&&(i=function(_){let S,C,R;return[,S,C,R]=_.match(Kp)||[],S||([,C,R]=_.match(iu)||[]),C&&R||([,C,R]=_.match(Th)||[]),C&&R||([,C]=_.match(o1)||[]),C||z.warning("un-destructible url: ",_),{proxy:S,host:C,port:R||"443"}}(i)),this.recordIndex=u,this.useProxy=!!i.proxy,c&&this.useProxy&&(z.warn("cannot use 443 only when use proxy"),c=!1),this.createWebSocket(i,!!c,!1).finally(()=>this.clearTimeout())}}function Ug(n,i){var a=Object.keys(n);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(n);i&&(c=c.filter(function(u){return Object.getOwnPropertyDescriptor(n,u).enumerable})),a.push.apply(a,c)}return a}class G8 extends li{get url(){return this.websocket&&this.websocket.url||null}get reconnectMode(){return this._reconnectMode}set reconnectMode(i){var a;ft(a=["tryNext","recover"]).call(a,i)&&this.resetReconnectCount(i),this._reconnectMode=i}get state(){return this._state}set state(i){i!==this._state&&(this._state=i,this._state==="reconnecting"?this.emit(mn.RECONNECTING,this.reconnectReason):this._state==="connected"?this.emit(mn.CONNECTED):this._state==="closed"?this.emit(mn.CLOSED):this._state==="failed"&&this.emit(mn.FAILED))}resetReconnectCount(i){z.debug("websocket reset reconnect count, reason: "+i),this.reconnectCount=0}constructor(i,a){let c=arguments.length>2&&arguments[2]!==void 0&&arguments[2],u=arguments.length>3&&arguments[3]!==void 0&&arguments[3],_=arguments.length>4&&arguments[4]!==void 0&&arguments[4],S=arguments.length>5?arguments[5]:void 0;super(),re(this,"connectionID",0),re(this,"currentURLIndex",0),re(this,"urls",[]),re(this,"_reconnectMode","tryNext"),re(this,"reconnectReason",void 0),re(this,"_initMutex",void 0),re(this,"name",void 0),re(this,"_state","closed"),re(this,"reconnectInterrupter",void 0),re(this,"websocket",void 0),re(this,"retryConfig",void 0),re(this,"reconnectCount",0),re(this,"forceCloseTimeout",5e3),re(this,"onlineReconnectListener",void 0),re(this,"useCompress",void 0),re(this,"tryDoubleDomain",!1),re(this,"use443PortOnly",!1),re(this,"wsInflateLength",0),re(this,"wsDeflateLength",0),re(this,"closeEstablishingWs",()=>{}),re(this,"store",void 0),re(this,"joinGatewayRecordIndex",void 0),this.store=S,this.name=i,this.retryConfig=function(r){for(var s=1;s<arguments.length;s++){var l=arguments[s]!=null?arguments[s]:{};s%2?Ug(Object(l),!0).forEach(function(f){re(r,f,l[f])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(l)):Ug(Object(l)).forEach(function(f){Object.defineProperty(r,f,Object.getOwnPropertyDescriptor(l,f))})}return r}({},a),this.useCompress=c,this.tryDoubleDomain=u,this.use443PortOnly=_,this._initMutex=new Na("websocket",S?S.clientId:void 0);let{timeout:C,timeoutFactor:R}=a,e=Math.max(300,Math.floor(3*C/5)),t=Math.max(1.2,Math.floor(8*R)/10);Uc.ONLINE&&(this.retryConfig.timeout=e,this.retryConfig.timeoutFactor=t),ki.on(Di.NETWORK_STATE_CHANGE,(r,s)=>{r!==s&&(this.resetReconnectCount("network state change: ".concat(s," -> ").concat(r)),r===Uc.ONLINE?(this.retryConfig.timeout=e,this.retryConfig.timeoutFactor=t):(this.retryConfig.timeout=C,this.retryConfig.timeoutFactor=R))})}getConnection(){return this.websocket||void 0}async init(i){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5e3,c=await this._initMutex.lock();this._reconnectMode="tryNext",this.forceCloseTimeout=a,this.urls=i,this.state="connecting";try{let u=O_(),_=this.urls[this.currentURLIndex];ge("ENABLE_PREALLOC_PC")&&this.emit(wI.PRE_CONNECT_PC),this.createWebSocketConnection(_).then(u.resolve).catch(u.reject),this.once(mn.CLOSED,()=>{u.reject(new Ye(oe.WS_DISCONNECT))}),this.once(mn.CONNECTED,u.resolve),await u.promise}catch{}finally{c()}}close(i,a){if(this.currentURLIndex=0,this.resetReconnectCount("close"),this.reconnectInterrupter&&this.reconnectInterrupter(),this.websocket){this.websocket.onclose=null,this.websocket.onopen=null,this.websocket.onmessage=null;let c=this.websocket;a?setTimeout(()=>c.close(),500):c.close(),this.websocket=void 0}this.state=i?"failed":"closed",this.closeEstablishingWs&&this.closeEstablishingWs()}reconnect(i,a){if(!this.websocket)return void z.warning("[".concat(this.name,"] can not reconnect, no websocket"));i!==void 0&&(this.reconnectMode=i),z.debug("[".concat(this.name,"] reconnect is triggered initiative")),typeof this.joinGatewayRecordIndex=="number"&&this.store&&this.store.recordJoinChannelService({status:"error",errors:[new Error(a)]},this.joinGatewayRecordIndex);let c=this.websocket.onclose;this.websocket.onclose=null,this.websocket.close(),c&&c.bind(this.websocket)({code:9999,reason:a})}sendMessage(i){let a=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(!this.websocket||this.websocket.readyState!==WebSocket.OPEN)throw new Ye(oe.WS_ABORT,"websocket is not ready");try{a||(i=JSON.stringify(i)),this.websocket.send(i)}catch(c){throw new Ye(oe.WS_ERR,"send websocket message error"+c.toString())}}setWsInflateData(i){this.wsDeflateLength=this.wsDeflateLength+i.originLength,this.wsInflateLength=this.wsInflateLength+i.compressedLength}getWsInflateData(){let i=this.wsInflateLength,a=this.wsDeflateLength;return this.clearWsInflateData(),{wsInflateLength:i,wsDeflateLength:a}}clearWsInflateData(){this.wsInflateLength=0,this.wsDeflateLength=0}async createWebSocketConnection(i){var a;let c=O_();this.connectionID+=1,this.joinGatewayRecordIndex=void 0;let u=t=>{var r;(r=this.store)===null||r===void 0||r.signalChannelOpen(),z.debug("[".concat(this.name,"] websocket opened:"),t),this.reconnectMode="retry",this.state="connected",this.resetReconnectCount("opened"),c.resolve()},_=async t=>{var r;if(z.debug("[".concat(this.name,"] websocket close ").concat((r=this.websocket)===null||r===void 0?void 0:r.url,", code: ").concat(t.code,", reason: ").concat(t.reason,", current mode: ").concat(this.reconnectMode)),this.reconnectCount>=this.retryConfig.maxRetryCount)c.reject(new Ye(oe.WS_DISCONNECT,"websocket close: ".concat(t.code))),this.close();else{this.state==="connected"&&(this.reconnectReason=t.reason,this.state="reconnecting");let s=ed(this,mn.WILL_RECONNECT,this.reconnectMode,t.reason)||this.reconnectMode,l=await this.reconnectWithAction(s);if(this.state==="closed")return void z.debug("[".concat(this.connectionID,"] ws is closed, no need to reconnect"));if(!l)return c.reject(new Ye(oe.WS_DISCONNECT,"websocket reconnect failed: ".concat(t.code))),this.close(!0);c.resolve()}},S=t=>{this.emit(mn.ON_MESSAGE,t)},C=t=>{z.warn("[".concat(this.connectionID,"] ws open error ").concat(t))};this.websocket&&(this.websocket.onclose=null,this.websocket.close()),ge("GATEWAY_WSS_ADDRESS")&&this.name.startsWith("gateway")&&(i=ge("GATEWAY_WSS_ADDRESS")),z.debug("[".concat(this.name,"] start connect, url:"),i);let R=(a=this.store)===null||a===void 0?void 0:a.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"gateway"});try{var e;let t=await this.chooseBestWebsocketConnection(i);this.websocket=t,u&&u(this.websocket.url),this.websocket.onclose=_,this.websocket.onmessage=S,this.websocket.onerror=C,(e=this.store)===null||e===void 0||e.recordJoinChannelService({endTs:Date.now(),status:"success"},R),this.joinGatewayRecordIndex=R}catch(t){let r=this.state==="closed",s=t instanceof Ye,l=s&&t.code===oe.WS_ABORT,f=s&&t.code===oe.WS_ERR,m=s?t.message:t&&(t.reason||t.toString());z.warning("[choose-best-ws] chooseBestWebsocket error: ".concat(m)),this.store&&this.store.recordJoinChannelService({endTs:Date.now(),status:l?"aborted":"error",errors:[t]},R),r||f?(c.reject(r?new Ye(oe.WS_DISCONNECT,"websocket is closed: ".concat(m)):new Ye(oe.WS_ERR,"init websocket failed: ".concat(m))),f&&z.error("[".concat(this.name,"] init websocket failed: ").concat(m))):_&&_(t)}return c.promise}async reconnectWithAction(i){let a=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(this.reconnectCount>=this.retryConfig.maxRetryCount||this.urls.length===0||this.state==="closed")return!1;z.warning("[choose-best-ws] action: =>",i),this.onlineReconnectListener||ki.isOnline||!ki.onlineWaiter||(this.onlineReconnectListener=ki.onlineWaiter.then(()=>{this.onlineReconnectListener=void 0}));let c=!0;if(this.reconnectInterrupter=()=>c=!1,a){let S=vL(this.reconnectCount,this.retryConfig);z.debug("[".concat(this.name,"] wait ").concat(S,"ms to reconnect websocket, mode: ").concat(i)),await Et.race([Mn(S),this.onlineReconnectListener||new Et(()=>{})])}if(this._state==="closed"||!c)return!1;this.reconnectCount+=1;let u=async(S,C)=>{this.emit(mn.RECONNECT_CREATE_CONNECTION,C),await this.createWebSocketConnection(S)};try{if(i==="retry")await u(this.urls[this.currentURLIndex],i);else if(i==="tryNext"){if(this.currentURLIndex+=1,this.currentURLIndex>=this.urls.length)return this.reconnectWithAction("recover",!1);z.debug("[".concat(this.name,"] websocket url length: ").concat(this.urls.length," current index: ").concat(this.currentURLIndex)),await u(this.urls[this.currentURLIndex],i)}else i==="recover"&&(z.debug("[".concat(this.name,"] request new urls")),this.resetReconnectCount("recover mode"),this.urls=await Bn(this,mn.REQUEST_NEW_URLS),this.currentURLIndex=0,await u(this.urls[this.currentURLIndex],i))}catch(S){var _;z.error("[".concat(this.name,"] reconnect failed ").concat(S&&S.toString()));let C=S==null||(_=S.data)===null||_===void 0?void 0:_.desc;return Array.isArray(C)&&ft(C).call(C,"dynamic key expired")?(this.emit(mn.ON_TOKEN_PRIVILEGE_DID_EXPIRE),!1):this.reconnectWithAction(i,a)}return!0}}class EU extends G8{constructor(i,a){super(i,a,arguments.length>2&&arguments[2]!==void 0&&arguments[2],arguments.length>3&&arguments[3]!==void 0&&arguments[3],arguments.length>4&&arguments[4]!==void 0&&arguments[4],arguments.length>5?arguments[5]:void 0)}async chooseBestWebsocketConnection(i,a){let c=O_(),u=function(S,C){return new c1(S,C)}(this.forceCloseTimeout,this.store);this.closeEstablishingWs=()=>{z.debug("[choose-best-ws] close establishing websockets"),u.closeAllWebsockets(),c.reject(new Ye(oe.WS_ABORT,"choose best websocket aborted"))};let _=ge("GATEWAY_DOMAINS");return z.debug("[choose-best-ws] currentDomain: ",i,", domains: ",_,"total: ".concat(this.urls.length),"current: ".concat(this.currentURLIndex+1)),u.chooseBestWebsocket(i,this.tryDoubleDomain,this.use443PortOnly,a).then(c.resolve).catch(c.reject),c.promise.finally(()=>{this.closeEstablishingWs=void 0})}}class qp extends G8{constructor(i,a){super(i,a,arguments.length>2&&arguments[2]!==void 0&&arguments[2],arguments.length>3&&arguments[3]!==void 0&&arguments[3],arguments.length>4&&arguments[4]!==void 0&&arguments[4],arguments.length>5?arguments[5]:void 0)}async chooseBestWebsocketConnection(i,a){return new Et((c,u)=>{let _=!1,S=[];this.closeEstablishingWs=()=>{z.debug("[choose-best-ws] close establishing websockets"),S.forEach(f=>{f.onclose=null,f.onopen=null,f.onmessage=null,f.close()}),u(new Ye(oe.WS_ABORT,"choose best websocket aborted"))};let C=ge("GATEWAY_DOMAINS"),R,e=i.indexOf("?h="),t=C.find(f=>e!==-1?ft(i).call(i,f,e):ft(i).call(i,f));z.debug("[choose-best-ws] currentDomain: ",t,", domains: ",C);let r=!this.tryDoubleDomain||!t;if(!r&&t){var s;let f=Date.now();try{C.forEach(m=>{let E=e===-1?i.replace(t,m):i.substr(0,e)+i.substr(e).replace(t,m),y=new WebSocket(E);y.binaryType="arraybuffer",S.push(y),z.debug("[choose-best-ws] ws is connecting:",y.url)})}catch{for(z.debug("[choose-best-ws] ws create failed, fallback to single url"),S.forEach(m=>m.close());S.length;)S.pop();r=!0}(s=this.store)===null||s===void 0||s.recordJoinChannelService({urls:S.map(m=>m.url),service:"gateway"},a),S.forEach(m=>{m.onopen=()=>{if(_)return;let E=Date.now()-f;z.debug("[choose-best-ws] ws open cost ".concat(E,"ms")),S.filter(y=>y!==m).forEach(y=>{z.debug("[choose-best-ws]close backup websocket: ".concat(y.url)),y.close()}),_=!0,c(m)},m.onclose=E=>{R=E,!_&&(S.find(y=>!(y.readyState===WebSocket.CLOSED||y.readyState===WebSocket.CLOSING))||(z.debug("[choose-best-ws] all websocket is closed"),_=!0,u(R)))},m.onmessage=E=>{z.debug("[choose-best-ws]".concat(m.url," onmessage: ").concat(E.data))}}),Mn(this.forceCloseTimeout).then(()=>{S.forEach(m=>{m.readyState!==WebSocket.OPEN&&m.close()})})}if(r){var l;let f;z.debug("[choose-best-ws] use single url: ",i),(l=this.store)===null||l===void 0||l.recordJoinChannelService({urls:[i],service:"gateway"},a);try{f=new WebSocket(i),S.push(f),f.binaryType="arraybuffer"}catch(m){let E=new Ye(oe.WS_ERR,"init websocket failed! Error: ".concat(m.toString()));return z.error("[".concat(this.name,"]").concat(E)),void u(E)}f.onopen=()=>{c(f)},f.onclose=m=>{u(m)},f.onmessage=m=>{z.debug("[choose-best-ws]".concat(f.url," onmessage: ").concat(m.data))},Mn(this.forceCloseTimeout).then(()=>{f&&f.readyState!==WebSocket.OPEN&&f.close()})}}).then(c=>(this.closeEstablishingWs=void 0,c)).catch(c=>{throw this.closeEstablishingWs=void 0,c})}}class OY extends li{get connectionState(){return this._connectionState}set connectionState(i){i!==this._connectionState&&(this._connectionState=i,i===qr.CONNECTED?this.emit(dn.WS_CONNECTED):i===qr.RECONNECTING?this.emit(dn.WS_RECONNECTING,this._websocketReconnectReason):i===qr.CLOSED&&this.emit(dn.WS_CLOSED,this._disconnectedReason))}get currentURLIndex(){return this.websocket.currentURLIndex}get url(){return this.websocket&&this.websocket.url||null}get rtt(){return this.rttRolling.mean()}constructor(i,a){super(),re(this,"_disconnectedReason",void 0),re(this,"_websocketReconnectReason",void 0),re(this,"_connectionState",qr.CLOSED),re(this,"reconnectToken",void 0),re(this,"websocket",void 0),re(this,"openConnectionTime",void 0),re(this,"clientId",void 0),re(this,"lastMsgTime",Date.now()),re(this,"uploadCache",[]),re(this,"uploadCacheInterval",void 0),re(this,"rttRolling",new Cx(5)),re(this,"pingpongTimer",void 0),re(this,"wsInflateDataTimer",void 0),re(this,"pingpongTimeoutCount",0),re(this,"joinResponse",void 0),re(this,"multiIpOption",void 0),re(this,"initError",void 0),re(this,"spec",void 0),re(this,"store",void 0),re(this,"onWebsocketMessage",c=>{if(c.data instanceof ArrayBuffer)return void this.emit(dn.ON_BINARY_DATA,c.data);let u=JSON.parse(c.data);if(this.lastMsgTime=Date.now(),Object.prototype.hasOwnProperty.call(u,"_id")){let _="res-@".concat(u._id);this.emit(_,u._result,u._message)}else if(Object.prototype.hasOwnProperty.call(u,"_type")){if(this.emit(u._type,u._message),u._type===kn.ON_NOTIFICATION&&this.handleNotification(u._message),u._type===kn.ON_USER_BANNED)switch(u._message.error_code){case 14:this.close(ur.UID_BANNED);break;case 15:this.close(ur.IP_BANNED);break;case 16:this.close(ur.CHANNEL_BANNED)}if(u._type===kn.ON_USER_LICENSE_BANNED)switch(u._message.error_code){case Zt.ERR_LICENSE_MISSING:this.close(ur.LICENSE_MISSING);break;case Zt.ERR_LICENSE_EXPIRED:this.close(ur.LICENSE_EXPIRED);break;case Zt.ERR_LICENSE_MINUTES_EXCEEDED:this.close(ur.LICENSE_MINUTES_EXCEEDED);break;case Zt.ERR_LICENSE_PERIOD_INVALID:this.close(ur.LICENSE_PERIOD_INVALID);break;case Zt.ERR_LICENSE_MULTIPLE_SDK_SERVICE:this.close(ur.LICENSE_MULTIPLE_SDK_SERVICE);break;case Zt.ERR_LICENSE_ILLEGAL:this.close(ur.LICENSE_ILLEGAL);break;default:this.close()}}}),this.clientId=i.clientId,this.spec=i,this.store=a,this.websocket=new EU("gateway-".concat(this.clientId),this.spec.retryConfig,!0,ge("JOIN_GATEWAY_USE_DUAL_DOMAIN"),ge("JOIN_GATEWAY_USE_443PORT_ONLY"),a),this.handleWebsocketEvents(),window.addEventListener("offline",()=>{this.connectionState===qr.CONNECTED&&this.reconnect("retry",Ma.OFFLINE)})}async request(i,a,c,u){let _=gr(6,""),S={_id:_,_type:i,_message:a},C=this.websocket.connectionID,R=()=>new Et((f,m)=>{if(this.connectionState===qr.CONNECTED)return f();let E=()=>{this.off(dn.WS_CLOSED,y),f()},y=()=>{this.off(dn.WS_CONNECTED,E),m(new De(oe.WS_ABORT))};this.once(dn.WS_CONNECTED,E),this.once(dn.WS_CLOSED,y),i!==ln.PUBLISH&&i!==ln.PUBLISH_DATASTREAM&&i!==ln.SUBSCRIBE&&i!==ln.SUBSCRIBE_DATASTREAM&&i!==ln.UNSUBSCRIBE&&i!==ln.UNSUBSCRIBE_DATASTREAM&&i!==ln.UNPUBLISH&&i!==ln.UNPUBLISH_DATASTREAM&&i!==ln.CONTROL&&i!==ln.RESTART_ICE||this.once(dn.DISCONNECT_P2P,()=>{m(new De(oe.DISCONNECT_P2P))}),i!==ln.PUBLISH&&i!==ln.RESTART_ICE||this.once(dn.ABORT_P2P_EXECUTION,()=>{m(new De(oe.DISCONNECT_P2P))})});if(this.connectionState!==qr.CONNECTING&&this.connectionState!==qr.RECONNECTING||i===ln.JOIN||i===ln.REJOIN||await R(),this.websocket.sendMessage(S,!0),u)return;let e=new Et((f,m)=>{let E=!1,y=(A,O)=>{E=!0,f({isSuccess:A==="success",message:O||{}}),this.off(dn.WS_CLOSED,b),this.off(dn.WS_RECONNECTING,b),this.emit(dn.REQUEST_SUCCESS,i,a)};this.once("res-@".concat(_),y);let b=()=>{m(new De(oe.WS_ABORT,"type: ".concat(i))),this.off(dn.WS_CLOSED,b),this.off(dn.WS_RECONNECTING,b),this.off("res-@".concat(_),y)};this.once(dn.WS_CLOSED,b),this.once(dn.WS_RECONNECTING,b),Mn(ge("SIGNAL_REQUEST_TIMEOUT")).then(()=>{this.websocket.connectionID!==C||E||(z.warning("[".concat(this.clientId,"] ws request timeout, type: ").concat(i)),this.emit(dn.REQUEST_TIMEOUT,i,a))})}),t=null;try{t=await e}catch(f){if(this.connectionState===qr.CLOSED||i===ln.LEAVE)throw new De(oe.WS_ABORT);return!this.spec.forceWaitGatewayResponse||c?f.throw():i===ln.JOIN||i===ln.REJOIN?null:(await R(),await this.request(i,a))}if(t.isSuccess)return t.message;let r=Number(t.message.error_code||t.message.code),s=Hc(r),l=new De(oe.UNEXPECTED_RESPONSE,"".concat(s.desc,": ").concat(t.message.error_str),{code:r,data:t.message,desc:s.desc});return s.action==="success"?t.message:(z.warning("[".concat(this.clientId,"] [").concat(this.websocket.connectionID,"] unexpected response from type ").concat(i,", error_code: ").concat(r,", message: ").concat(s.desc,", action: ").concat(s.action)),r===Zt.ERR_TOO_MANY_BROADCASTERS?((i===ln.JOIN||i===ln.REJOIN)&&(this.initError=l,this.close()),l.throw()):s.action==="failed"?l.throw():s.action==="quit"?(this.initError=l,this.close(),l.throw()):(r===Zt.ERR_JOIN_BY_MULTI_IP?(this.multiIpOption=t.message.option,z.warning("[".concat(this.clientId,"] detect multi ip, recover")),this.reconnect("recover",Ma.MULTI_IP)):this.reconnect(s.action,Ma.SERVER_ERROR),i===ln.JOIN||i===ln.REJOIN?null:await this.request(i,a)))}waitMessage(i,a){return new Et(c=>{let u=_=>{(!a||a(_))&&(this.off(i,u),c(_))};this.on(i,u)})}uploadWRTCStats(i){if(!this.store.sessionId)return void z.warn("[".concat(this.clientId,"] no session id when upload wrtc stats"));let a={lts:Date.now(),sid:this.store.sessionId,uid:this.store.intUid,stats:i};this.upload(bI.WRTC_STATS,a)}upload(i,a){let c={_type:i,_message:a};try{this.websocket.sendMessage(c)}catch{let u=ge("MAX_UPLOAD_CACHE")||50;this.uploadCache.push(c),this.uploadCache.length>u&&this.uploadCache.splice(0,1),this.uploadCache.length>0&&!this.uploadCacheInterval&&(this.uploadCacheInterval=window.setInterval(()=>{if(this.connectionState!==qr.CONNECTED)return;let _=this.uploadCache.splice(0,1)[0];this.uploadCache.length===0&&(window.clearInterval(this.uploadCacheInterval),this.uploadCacheInterval=void 0),this.upload(_._type,_._message)},ge("UPLOAD_CACHE_INTERVAL")||2e3))}}send(i,a){let c={_type:i,_message:a};this.websocket.sendMessage(c)}init(i){return this.initError=void 0,this.multiIpOption=void 0,this.joinResponse=void 0,this.reconnectToken=void 0,this.openConnectionTime=void 0,new Et((a,c)=>{this.once(dn.WS_CONNECTED,()=>a(this.joinResponse)),this.once(dn.WS_CLOSED,u=>c(this.initError||new De(oe.WS_ABORT,u))),this.connectionState=qr.CONNECTING,this.websocket.init(i).catch(c),this.wsInflateDataTimer&&window.clearInterval(this.wsInflateDataTimer),this.wsInflateDataTimer=window.setInterval(()=>{this.handleWsInflateData()},2e4)})}close(i){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.wsInflateDataTimer&&(this.handleWsInflateData(),window.clearInterval(this.wsInflateDataTimer),this.wsInflateDataTimer=void 0),this.reconnectToken=void 0,this.joinResponse=void 0,this._disconnectedReason=i||ur.LEAVE,this.connectionState=qr.CLOSED,z.debug("[".concat(this.clientId,"] ")+"will close websocket in signal"),this.websocket.close()}async join(){if(!this.joinResponse){this.emit(dn.ABORT_P2P_EXECUTION);let i=await Bn(this,dn.REQUEST_JOIN_INFO),a=await this.request(ln.JOIN,i);if(!a)return this.emit(dn.REPORT_JOIN_GATEWAY,rf.TIMEOUT,this.url||""),!1;this.joinResponse=a,this.emit(dn.JOIN_RESPONSE,this.joinResponse),this.reconnectToken=this.joinResponse.rejoin_token}return this.connectionState=qr.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),!0}async rejoin(){if(!this.reconnectToken)throw new De(oe.UNEXPECTED_ERROR,"can not rejoin, no rejoin token");let i=nr(this,dn.REQUEST_REJOIN_INFO);i.token=this.reconnectToken;let a=await this.request(ln.REJOIN,i);return!!a&&(this.connectionState=qr.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),a.peers&&a.peers.forEach(c=>{this.emit(kn.ON_USER_ONLINE,{uid:c.uid}),c.audio&&this.emit(kn.ON_ADD_AUDIO_STREAM,{uid:c.uid,uint_id:c.uint_id,audio:!0,ssrcId:c.audio_ssrc}),c.video&&this.emit(kn.ON_ADD_VIDEO_STREAM,{uid:c.uid,uint_id:c.uint_id,video:!0,ssrcId:c.video_ssrc}),c.audio_mute?this.emit(kn.MUTE_AUDIO,{uid:c.uid}):this.emit(kn.UNMUTE_AUDIO,{uid:c.uid}),c.video_mute?this.emit(kn.MUTE_VIDEO,{uid:c.uid}):this.emit(kn.UNMUTE_VIDEO,{uid:c.uid}),c.audio_enable_local?this.emit(kn.ENABLE_LOCAL_AUDIO,{uid:c.uid}):this.emit(kn.DISABLE_LOCAL_AUDIO,{uid:c.uid}),c.video_enable_local?this.emit(kn.ENABLE_LOCAL_VIDEO,{uid:c.uid}):this.emit(kn.DISABLE_LOCAL_VIDEO,{uid:c.uid}),c.audio||c.video||this.emit(kn.ON_REMOVE_STREAM,{uid:c.uid,uint_id:c.uint_id})}),!0)}reconnect(i,a){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.websocket.reconnect(i,a)}handleNotification(i){z.debug("[".concat(this.clientId,"] receive notification: "),i);let a=Hc(i.code);if(i.code===28&&"detail"in i&&(z.info("[".concat(this.clientId,"] receive recover notification: "),i.detail),this.emit(dn.RECOVER_NOTIFICATION,i.detail)),a.action!=="success"){if(a.action!=="failed")return a.action==="quit"?(a.desc==="ERR_REPEAT_JOIN_CHANNEL"&&this.close(ur.UID_BANNED),void this.close()):void this.reconnect(a.action,Ma.SERVER_ERROR);z.error("[".concat(this.clientId,"] ignore error: "),a.desc)}}handlePingPong(){if(!this.websocket||this.websocket.state!=="connected")return;this.pingpongTimeoutCount>0&&this.rttRolling.add(3e3),this.pingpongTimeoutCount+=1;let i=ge("PING_PONG_TIME_OUT"),a=Date.now();this.pingpongTimeoutCount>=i&&(z.warning("[".concat(this.clientId,"] PING-PONG Timeout. Last Socket Message: ").concat(a-this.lastMsgTime,"ms")),a-this.lastMsgTime>ge("WEBSOCKET_TIMEOUT_MIN"))?this.reconnect("retry",Ma.TIMEOUT):this.request(ln.PING,void 0,!0).then(()=>{this.pingpongTimeoutCount=0;let c=Date.now()-a;this.rttRolling.add(c),ge("REPORT_STATS")&&this.send(ln.PING_BACK,{pingpongElapse:c})}).catch(c=>{})}handleWsInflateData(){let{wsInflateLength:i,wsDeflateLength:a}=this.websocket.getWsInflateData();i!==0&&a!==0&&this.upload(bI.WS_INFLATE_DATA_LENGTH,{ws_deflate_length:a,ws_inflate_length:i})}handleWebsocketEvents(){this.websocket.on(mn.RECONNECT_CREATE_CONNECTION,i=>{this.emit(dn.WS_RECONNECT_CREATE_CONNECTION,i)}),this.websocket.on(mn.ON_MESSAGE,this.onWebsocketMessage),this.websocket.on(mn.CLOSED,()=>{this.connectionState=qr.CLOSED}),this.websocket.on(mn.FAILED,()=>{this._disconnectedReason=ur.NETWORK_ERROR,this.connectionState=qr.CLOSED}),this.websocket.on(mn.RECONNECTING,i=>{this._websocketReconnectReason=i,this.joinResponse=void 0,this.connectionState===qr.CONNECTED?this.connectionState=qr.RECONNECTING:this.connectionState=qr.CONNECTING}),this.websocket.on(mn.WILL_RECONNECT,(i,a,c)=>{let u=nr(this,dn.IS_P2P_DISCONNECTED),_=u||i!=="retry";u&&i==="retry"&&(z.debug("".concat(this.clientId," reconnect mode is retry, but p2p lost, change to tryNext")),i="tryNext",a=rf.P2P_DISCONNECTED),_&&(z.debug("".concat(this.clientId," will renewSession, reconnect mode: ").concat(i)),this.emit(dn.REPORT_JOIN_GATEWAY,a||rf.UNKNOWN_REASON,this.url||""),this.reconnectToken=void 0,this.emit(dn.DISCONNECT_P2P)),c(i)}),this.websocket.on(mn.CONNECTED,()=>{this.openConnectionTime=Date.now(),this.reconnectToken?this.rejoin().catch(i=>{z.warning("[".concat(this.clientId,"] rejoin failed ").concat(i)),this.reconnect("tryNext",Ma.SERVER_ERROR)}):this.join().catch(i=>{if(this.emit(dn.REPORT_JOIN_GATEWAY,i,this.url||""),i instanceof De){if(i.code===oe.UNEXPECTED_RESPONSE&&i.data.code===Zt.ERR_NO_AUTHORIZED)return this.initError=new De(oe.TOKEN_EXPIRE,"dynamic key expired"),void this.close(ur.TOKEN_EXPIRE);z.error("[".concat(this.clientId,"] join gateway request failed"),i.toString()),this.spec.forceWaitGatewayResponse?this.reconnect("tryNext",Ma.SERVER_ERROR):(this.initError=i,this.close())}})}),this.websocket.on(mn.REQUEST_NEW_URLS,(i,a)=>{Bn(this,dn.REQUEST_RECOVER,this.multiIpOption).then(i).catch(a)}),this.websocket.on(mn.ON_TOKEN_PRIVILEGE_DID_EXPIRE,()=>{this.emit(kn.ON_TOKEN_PRIVILEGE_DID_EXPIRE)}),this.websocket.on(wI.PRE_CONNECT_PC,()=>{this.emit(dn.PRE_CONNECT_PC)})}}let RI=function(n){return n.NATIVE_RTC="native_rtc",n.NATIVE_RTM="native_rtm",n.WEB_RTC="web_rtc",n.WEB_RTM="web_rtm",n}({}),aa=function(n){return n[n.CHOOSE_SERVER=11]="CHOOSE_SERVER",n[n.CLOUD_PROXY=18]="CLOUD_PROXY",n[n.CLOUD_PROXY_5=20]="CLOUD_PROXY_5",n[n.CLOUD_PROXY_FALLBACK=26]="CLOUD_PROXY_FALLBACK",n}({});function $L(n,i){var a=Object.keys(n);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(n);i&&(c=c.filter(function(u){return Object.getOwnPropertyDescriptor(n,u).enumerable})),a.push.apply(a,c)}return a}function l1(n){for(var i=1;i<arguments.length;i++){var a=arguments[i]!=null?arguments[i]:{};i%2?$L(Object(a),!0).forEach(function(c){re(n,c,a[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(a)):$L(Object(a)).forEach(function(c){Object.defineProperty(n,c,Object.getOwnPropertyDescriptor(a,c))})}return n}function F_(n){return n.match(/^[\.\:\d]+$/)?"".concat(n.replace(/[^\d]/g,"-"),".").concat(ge("TURN_DOMAIN")):(z.debug("Cannot recognized as ip address: ".concat(n,", use as host")),n)}function vU(n,i){n.addresses||(n.addresses=[]);let a=function(C,R){if(ge("CONNECT_GATEWAY_WITHOUT_DOMAIN"))return C.map(r=>{let{ip:s,port:l}=r;return{address:"".concat(s,":").concat(l)}});let e=ge("GATEWAY_DOMAINS"),t=e[1]&&ft(R).call(R,e[1])?1:0;return C.map(r=>{let{domain_prefix:s,port:l,ip:f}=r;if(s)return{address:"".concat(s,".").concat(e[t++%e.length],":").concat(l)};let m=/^[\.\:\d]+$/.test(f),E=m?"".concat(f.replace(/[^\d]/g,"-"),".").concat(e[t++%e.length],":").concat(l):"".concat(f,":").concat(l);return m||z.debug("Cannot recognized as ip address: ".concat(f,", use as host")),{ip:f,port:l,address:E}})}(n.addresses,i),c=Array.isArray(n.detail)&&n.detail[18];if(c&&typeof c=="string"){let C=c.split(";");for(let R=0;R<C.length;R++){var u;let e=js(u=C[R]).call(u);a[R]&&e&&(a[R].ip6=e)}}let _=n.detail&&n.detail.candidate,S;if(_){let[C,R]=_.split(":");C&&R&&(S={port:Number(R),ip:C,address:"".concat(C,":").concat(R)})}return{gatewayAddrs:a,apGatewayAddress:S,uid:n.uid,cid:n.cid,cert:n.cert,vid:n.detail&&n.detail[8],uni_lbs_ip:n.detail&&n.detail[1],res:n,csIp:n.detail&&n.detail[502]}}function Al(n){return typeof n=="number"?n:n.exact||n.ideal||n.max||n.min||0}function z8(n){let i=n._encoderConfig;if(!i)return{};let a={resolution:i.width&&i.height?"".concat(Al(i.width),"x").concat(Al(i.height)):void 0,maxVideoBW:i.bitrateMax,minVideoBW:i.bitrateMin};return typeof i.frameRate=="number"?(a.maxFrameRate=i.frameRate,a.minFrameRate=i.frameRate):i.frameRate&&(a.maxFrameRate=i.frameRate.max||i.frameRate.ideal||i.frameRate.exact||i.frameRate.min,a.minFrameRate=i.frameRate.min||i.frameRate.ideal||i.frameRate.exact||i.frameRate.max),a}function H8(n){return n>=0&&n<.17?1:n>=.17&&n<.36?2:n>=.36&&n<.59?3:n>=.59&&n<=1?4:n>1?5:0}function II(n,i){let a,c,u;switch(i){case aa.CHOOSE_SERVER:c=4096,u="choose server";break;case aa.CLOUD_PROXY:c=1048576,u="proxy";break;case aa.CLOUD_PROXY_5:c=4194304,u="proxy5";break;case aa.CLOUD_PROXY_FALLBACK:c=4194310,u="proxy fallback";break;default:throw new De(oe.UNEXPECTED_ERROR,"multi unlibs response transformer get unknown service id",{csIp:n.detail&&n.detail[502],retry:!1})}if(n.response_body.forEach(_=>{_.buffer&&_.buffer.flag===c&&(a={code:_.buffer.code,addresses:(_.buffer.edges_services||[]).map(S=>l1(l1({},S),{},{ticket:_.buffer.cert})),server_ts:n.enter_ts,uid:_.buffer.uid,cid:_.buffer.cid,cname:_.buffer.cname,detail:l1(l1({},_.buffer.detail),n.detail),flag:_.buffer.flag,opid:n.opid,cert:_.buffer.cert})}),!a)throw new De(oe.MULTI_UNILBS_RESPONSE_ERROR,"cannot parse response ".concat(u," from multi unilbs response"),{csIp:n.detail&&n.detail[502]});return a}async function SU(n,i){return await Et.all(n.addresses.map(async a=>({address:ge("USE_TURN_IP")?a.ip:F_(a.ip),tcpport:a.port,udpport:a.port,username:i&&ge("ENCRYPT_PROXY_USERNAME_AND_PSW")&&window.isSecureContext?i.toString():rs.username,password:i&&ge("ENCRYPT_PROXY_USERNAME_AND_PSW")&&window.isSecureContext?await wr(i.toString()):rs.password})))}function eD(n,i){let a=i.getMediaStreamTrack(!0).getSettings(),c=i.videoHeight||a.height,u=i.videoWidth||a.width;return c&&u?Math.max(Math.min(c,u)/Math.min(Al(n.height),Al(n.width)),1):(z.warning("can't get ori-track's height, default scale down 4 times for low stream"),4)}function Jp(n){let{candidateType:i,relayProtocol:a,type:c,address:u,port:_,protocol:S}=n,C={candidateType:i,relayProtocol:a,protocol:S};if(c!=="local-candidate"){let R=u.split(".");R.length>=4&&(R[1]="*",R[2]="*"),C.address=R.join("."),C.port=_}return C}function G_(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ge("SVC_MODE");if(ge("ENABLE_SVC"))return function(i){return i in El}(n)?n:El.L1T3}let W8={[Tt.VIDEO]:[{key:"abs-send-time",extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"},{key:"video-orientation",extensionName:"urn:3gpp:video-orientation"},{key:"draft-holmer-rmcat-transport-wide-cc-extensions-01",extensionName:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"},{key:"playout-delay",extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/playout-delay"},{key:"video-content-type",extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/video-content-type"},{key:"color-space",extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/color-space"},{key:"video-timing",extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/video-timing"}],[Tt.AUDIO]:[{key:"ssrc-audio-level",extensionName:"urn:ietf:params:rtp-hdrext:ssrc-audio-level"},{key:"draft-holmer-rmcat-transport-wide-cc-extensions-01",extensionName:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"},{key:"abs-send-time",extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"}]};function tD(n,i,a){i.forEach(c=>{var u;let _=W8[n].find(C=>{var R;let{key:e}=C;return ft(R=c.extensionName).call(R,e)});if(!_)return;let S=a.find(C=>{let{extensionName:R}=C;return ft(R).call(R,_.key)});S&&ft(u=S.extensionName).call(u,"gdpr_forbidden")&&(c.extensionName=S.extensionName)})}function Pi(n,i){i.forEach(a=>{var c;let u=W8[n].find(_=>{var S;let{key:C}=_;return ft(S=a.extensionName).call(S,C)});ft(c=a.extensionName).call(c,"gdpr_forbidden")&&u&&(a.extensionName=u.extensionName)})}function yU(n){return n==="http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"||ft(n).call(n,"abs-send-time")}function kS(n){return n==="http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"||ft(n).call(n,"draft-holmer-rmcat-transport-wide-cc-extensions-01")}function jg(n,i){var a=Object.keys(n);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(n);i&&(c=c.filter(function(u){return Object.getOwnPropertyDescriptor(n,u).enumerable})),a.push.apply(a,c)}return a}function nD(n){for(var i=1;i<arguments.length;i++){var a=arguments[i]!=null?arguments[i]:{};i%2?jg(Object(a),!0).forEach(function(c){re(n,c,a[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(a)):jg(Object(a)).forEach(function(c){Object.defineProperty(n,c,Object.getOwnPropertyDescriptor(a,c))})}return n}function Co(n){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},c=arguments.length>3?arguments[3]:void 0,{filterRTX:u,filterVideoFec:_,filterAudioFec:S,filterAudioCodec:C,filterVideoCodec:R}=i,{useXR:e}=a,t=[],r=[],s=[],l=[],f=!1,m=!1;if(Dn(n).mediaDescriptions.forEach(y=>{c&&c!==y.attributes.direction||(y.media.mediaType!=="video"||f||(r=y.attributes.payloads,l=y.attributes.extmaps,f=!0),y.media.mediaType!=="audio"||m||(t=y.attributes.payloads,s=y.attributes.extmaps,m=!0))}),!l||r.length===0)throw new Error("Cannot get video capabilities from SDP.");if(!s||t.length===0)throw new Error("Cannot get audio capabilities from SDP.");if(r.forEach(y=>{var b;(b=y.rtpMap)!==null&&b!==void 0&&b.clockRate&&(y.rtpMap.clockRate=parseInt(y.rtpMap.clockRate)),e&&y.rtcpFeedbacks.push({type:"rrtr"})}),t.forEach(y=>{var b;(b=y.rtpMap)!==null&&b!==void 0&&b.clockRate&&(y.rtpMap.clockRate=parseInt(y.rtpMap.clockRate)),e&&y.rtcpFeedbacks.push({type:"rrtr"})}),u&&(t=t.filter(y=>{var b;return((b=y.rtpMap)===null||b===void 0?void 0:b.encodingName.toLowerCase())!=="rtx"}),r=r.filter(y=>{var b;return((b=y.rtpMap)===null||b===void 0?void 0:b.encodingName.toLowerCase())!=="rtx"})),_&&(r=r.filter(y=>{var b;return!/(red)|(ulpfec)|(flexfec)/i.test(((b=y.rtpMap)===null||b===void 0?void 0:b.encodingName)||"")})),S&&(t=t.filter(y=>{var b;return!/(red)|(ulpfec)|(flexfec)/i.test(((b=y.rtpMap)===null||b===void 0?void 0:b.encodingName)||"")})),C&&(C==null?void 0:C.length)>0&&(t=t.filter(y=>{var b;return ft(C).call(C,((b=y.rtpMap)===null||b===void 0?void 0:b.encodingName.toLowerCase())||"")})),R&&(R==null?void 0:R.length)>0){let y=r.filter(b=>{var A;return ft(R).call(R,((A=b.rtpMap)===null||A===void 0?void 0:A.encodingName.toLowerCase())||"")});r=y.concat(u?[]:iD(y,r))}let E=ge("UNSUPPORTED_VIDEO_CODEC");return E&&E.length>0&&(r=r.filter(y=>!(y.rtpMap&&ft(E).call(E,y.rtpMap.encodingName.toLowerCase())))),{audioCodecs:t,videoCodecs:r,audioExtensions:s,videoExtensions:l}}function Vg(n){let i=Dn(n),a,c;for(let u of i.mediaDescriptions){if(!a){let _=u.attributes.iceUfrag,S=u.attributes.icePwd;if(!_||!S)throw new Error("Cannot get iceUfrag or icePwd from SDP.");a={iceUfrag:_,icePwd:S}}if(!c){let _=u.attributes.fingerprints;_.length>0&&(c={fingerprints:_})}}if(!c&&i.attributes.fingerprints.length>0&&(c={fingerprints:i.attributes.fingerprints}),!c||!a)throw new Error("Cannot get iceParameters or dtlsParameters from SDP.");return{iceParameters:a,dtlsParameters:c}}function TU(n,i){let a=[],c=n.attributes.ssrcGroups.filter(S=>S.semantic==="FID"),u=n.attributes.ssrcGroups.find(S=>S.semantic==="SIM"),_=n.attributes.ssrcs;if(u)u.ssrcIds.forEach(S=>{var C;let R=(C=c.find(e=>e.ssrcIds[0]===S))===null||C===void 0?void 0:C.ssrcIds[1];a.push({ssrcId:S,rtx:i?R:void 0})});else if(c.length>0){let S=c[0].ssrcIds[0],C=c[0].ssrcIds[1];a.push({ssrcId:S,rtx:i?C:void 0})}else{if(_.length===0)throw new Error("No ssrcs found on local media description.");a.push({ssrcId:_[0].ssrcId})}return a}function d1(n,i,a){let{cname:c}=n,u=[];i&&(u=bU(i)),u.length===0&&(u=n.iceParameters.candidates.map(t=>({foundation:t.foundation,componentId:"1",transport:t.protocol,priority:t.priority.toString(),connectionAddress:t.ip,port:t.port.toString(),type:t.type,extension:{}})),z.debug("Using candidates from gateway."));let _={fingerprints:n.dtlsParameters.fingerprints.map(t=>({hashFunction:t.algorithm,fingerprint:t.fingerprint}))},S={iceUfrag:n.iceParameters.iceUfrag,icePwd:n.iceParameters.icePwd},C;switch(n.dtlsParameters.role){case"server":C="passive";break;case"client":C="active";break;case"auto":C="actpass"}let R=z_(n.rtpCapabilities),e=[];return Array.isArray(a)&&a.length>0&&a.forEach(t=>{e.push({kind:Tt.VIDEO,ssrcId:t.v,rtx:t.v_rtx,mslabel:"".concat(t.v,"_").concat(t.a)},{kind:Tt.AUDIO,ssrcId:t.a,mslabel:"".concat(t.v,"_").concat(t.a)})}),{dtlsParameters:_,iceParameters:S,candidates:u,rtpCapabilities:R,setup:C,cname:c,preSSRCs:e}}function bU(n){let i=[];return n.ip&&typeof n.port=="number"&&(i=[{foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:n.ip,port:n.port.toString(),type:"host",extension:{}}],z.debug("Using remote candidate from AP ".concat(n.ip,":").concat(n.port)),n.ip6&&(i.push({foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:n.ip6,port:n.port.toString(),type:"host",extension:{}}),z.debug("Using IPV6 remote candidate from AP ".concat(n.ip6,":").concat(n.port)))),i}function Bg(n,i,a){let c=[],u=[];return n.forEach(_=>{let{ssrcId:S,rtx:C}=_,R=gr(8,"track-"),e={ssrcId:S,attributes:nD({label:R,mslabel:a=a||gr(10,""),msid:"".concat(a," ").concat(R)},i&&{cname:i})};if(c.push(e),C!==void 0){let t={ssrcId:C,attributes:nD({label:R,mslabel:a,msid:"".concat(a," ").concat(R)},i&&{cname:i})};c.push(t),u.push({semantic:"FID",ssrcIds:[S,C]})}}),n.length>1&&u.push({semantic:"SIM",ssrcIds:n.map(_=>{let{ssrcId:S}=_;return S})}),{ssrcs:c,ssrcGroups:u}}function au(n,i){i instanceof Ui&&n.attributes.payloads.forEach(a=>{var c;let u=(c=a.rtpMap)===null||c===void 0?void 0:c.encodingName.toLowerCase();if(!u||["opus","pcmu","pcma","g722"].indexOf(u)===-1)return;a.fmtp||(a.fmtp={parameters:{}}),a.fmtp.parameters.minptime="10",a.fmtp.parameters.useinbandfec="1";let _=i._encoderConfig;_&&u!=="pcmu"&&u!=="pcma"&&u!=="g722"&&(_.bitrate&&!Ni()&&(a.fmtp.parameters.maxaveragebitrate="".concat(Math.floor(1e3*_.bitrate))),_.sampleRate&&(a.fmtp.parameters.maxplaybackrate="".concat(_.sampleRate),a.fmtp.parameters["sprop-maxcapturerate"]="".concat(_.sampleRate)),_.stereo&&(a.fmtp.parameters.stereo="1",a.fmtp.parameters["sprop-stereo"]="1"))})}function u1(n){let i=n.attributes.unrecognized.findIndex(a=>a.attField==="x-google-flag"&&a.attValue==="conference");i!==-1&&n.attributes.unrecognized.splice(i,1)}function rD(n,i){var a;if(!(i instanceof ni&&i._encoderConfig&&i._hints.indexOf(kr.SCREEN_TRACK)===-1))return;let c=i._encoderConfig;Un().supportMinBitrate&&c.bitrateMin&&n.attributes.payloads.forEach(u=>{var _,S;ft(_=["h264","h265","vp8","vp9","av1"]).call(_,((S=u.rtpMap)===null||S===void 0?void 0:S.encodingName.toLowerCase())||"")&&(u.fmtp||(u.fmtp={parameters:{}}),u.fmtp.parameters["x-google-min-bitrate"]="".concat(c.bitrateMin))}),Un().supportMinBitrate&&!ft(a=i._hints).call(a,kr.LOW_STREAM)&&c.bitrateMax&&n.attributes.payloads.forEach(u=>{var _,S;ft(_=["h264","h265","vp8","vp9","av1"]).call(_,((S=u.rtpMap)===null||S===void 0?void 0:S.encodingName.toLowerCase())||"")&&(u.fmtp||(u.fmtp={parameters:{}}),u.fmtp.parameters["x-google-start-bitrate"]="".concat(ge("X_GOOGLE_START_BITRATE")||Math.floor(c.bitrateMax)))})}function AI(n){if(n.media.mediaType!=="video")return;let i=En();if(i.name!==cr.SAFARI&&i.os!==Ra.IOS)return;let a=n.attributes.extmaps.findIndex(c=>/video-orientation/g.test(c.extensionName));a!==-1&&n.attributes.extmaps.splice(a,1)}function Fg(n,i,a){if(!i)return;let c,u;if(n.media.mediaType==="video"?(c=a.videoExtensions,u=a.videoCodecs):(c=a.audioExtensions,u=a.audioCodecs),i.twcc===!0){let _=c.find(S=>kS(S.extensionName));if(_){let S=_.extensionName;n.attributes.extmaps.find(C=>kS(C.extensionName))||n.attributes.extmaps.push({entry:_.entry,extensionName:S}),function(C,R){return R.filter(e=>!!C.find(t=>t.payloadType===e.payloadType&&!!t.rtcpFeedbacks.find(r=>r.type==="transport-cc")))}(u,n.attributes.payloads).forEach(C=>{C.rtcpFeedbacks.find(R=>R.type==="transport-cc")||C.rtcpFeedbacks.push({type:"transport-cc"})})}}else if(i.twcc===!1){let _=n.attributes.extmaps.findIndex(S=>kS(S.extensionName));_!==-1&&n.attributes.extmaps.splice(_,1),n.attributes.payloads.forEach(S=>{let C=S.rtcpFeedbacks.findIndex(R=>R.type==="transport-cc");C!==-1&&S.rtcpFeedbacks.splice(C,1)})}if(i.remb===!0){let _=c.find(S=>yU(S.extensionName));if(_){let S=_.extensionName;n.attributes.extmaps.find(C=>C.extensionName===S)||n.attributes.extmaps.push({entry:_.entry,extensionName:S}),function(C,R){return R.filter(e=>!!C.find(t=>t.payloadType===e.payloadType&&!!t.rtcpFeedbacks.find(r=>r.type==="goog-remb")))}(u,n.attributes.payloads).forEach(C=>{C.rtcpFeedbacks.find(R=>R.type==="goog-remb")||C.rtcpFeedbacks.push({type:"goog-remb"})})}}else if(i.remb===!1){let _=n.attributes.extmaps.findIndex(S=>yU(S.extensionName));_!==-1&&n.attributes.extmaps.splice(_,1),n.attributes.payloads.forEach(S=>{let C=S.rtcpFeedbacks.findIndex(R=>R.type==="goog-remb");C!==-1&&S.rtcpFeedbacks.splice(C,1)})}}function CU(n,i,a){if(Ni()||n.media.mediaType!=="video"||!(i instanceof ni)||a!=="vp9"&&a!=="vp8"||a==="vp8"&&!ge("SIMULCAST")||a==="vp9"&&ge("ENABLE_SVC")||i._scalabilityMode===void 0||i._scalabilityMode.numSpatialLayers<=1)return;let c=a==="vp8"?2:i._scalabilityMode.numSpatialLayers,u=n.attributes.ssrcs[0],_=n.attributes.ssrcGroups.find(C=>C.semantic==="FID"&&C.ssrcIds[0]===u.ssrcId),S={semantic:"SIM",ssrcIds:[u.ssrcId]};for(let C=1;C<c;C++)n.attributes.ssrcs.push({ssrcId:u.ssrcId+C,attributes:Fn(u.attributes)}),S.ssrcIds.push(u.ssrcId+C),_&&(n.attributes.ssrcs.push({ssrcId:_.ssrcIds[1]+C,attributes:Fn(u.attributes)}),n.attributes.ssrcGroups.push({semantic:"FID",ssrcIds:[u.ssrcId+C,_.ssrcIds[1]+C]}));n.attributes.ssrcGroups.unshift(S)}async function OI(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=new RTCPeerConnection;a.addTransceiver("video",{direction:"sendonly"}),a.addTransceiver("audio",{direction:"sendonly"}),a.addTransceiver("video",{direction:"recvonly"}),a.addTransceiver("audio",{direction:"recvonly"});let c=(await a.createOffer()).sdp,{send:u,recv:_,sendrecv:S}=function(){let C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},e=arguments.length>2?arguments[2]:void 0,t=Co(e,C,R,"sendonly"),r=Co(e,C,R,"recvonly"),s={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},l={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},f={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]};if(su(t,r,"videoExtensions",s,l,f),su(t,r,"videoCodecs",s,l,f),su(t,r,"audioExtensions",s,l,f),su(t,r,"audioCodecs",s,l,f),ge("RAISE_H264_BASELINE_PRIORITY")){let m=[],E=[];f.videoCodecs.forEach((y,b)=>{var A;if(((A=y.rtpMap)===null||A===void 0?void 0:A.encodingName.toLocaleLowerCase())==="h264"){var O,D;let P=f.videoCodecs[b+1],F=P&&sD(y,P),B=(O=y.fmtp)===null||O===void 0?void 0:O.parameters["profile-level-id"],Y=(D=y.fmtp)===null||D===void 0?void 0:D.parameters["packetization-mode"];!B||B!==ge("FIRST_H264_PROFILE_LEVEL_ID")||ge("FIRST_PACKETIZATION_MODE")&&Y!==ge("FIRST_PACKETIZATION_MODE")?F?E.push([y,P]):E.push([y]):F?m.push([y,P]):m.push([y])}}),m.length>0&&E.length>0&&(z.debug("raising H264 baseline profile priority"),f.videoCodecs.forEach((y,b)=>{var A;if(((A=y.rtpMap)===null||A===void 0?void 0:A.encodingName.toLocaleLowerCase())==="h264"){let O=sD(y,f.videoCodecs[b+1]),D=m.shift()||E.shift()||[];D.length>0&&(O?f.videoCodecs.splice(b,2,...D):f.videoCodecs.splice(b,1,...D))}}),l.videoCodecs=l.videoCodecs.filter(y=>{var b,A;return!(((b=y.rtpMap)===null||b===void 0?void 0:b.encodingName.toLocaleLowerCase())==="h264"&&((A=y.fmtp)===null||A===void 0?void 0:A.parameters["profile-level-id"])!==ge("FIRST_H264_PROFILE_LEVEL_ID"))}),ge("FILTER_SEND_H264_BASELINE")&&(s.videoCodecs=s.videoCodecs.filter(y=>{var b,A;return!(((b=y.rtpMap)===null||b===void 0?void 0:b.encodingName.toLocaleLowerCase())==="h264"&&((A=y.fmtp)===null||A===void 0?void 0:A.parameters["profile-level-id"])!==ge("FIRST_H264_PROFILE_LEVEL_ID"))})))}return{send:s,recv:l,sendrecv:f}}(n,i,c);try{a.close()}catch{}return{send:u,recv:_,sendrecv:S}}function wU(){let n={audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]},i=Co(arguments.length>2?arguments[2]:void 0,arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},"recvonly"),a={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},c={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},u={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]};if(su(n,i,"videoExtensions",a,c,u),su(n,i,"videoCodecs",a,c,u),su(n,i,"audioExtensions",a,c,u),su(n,i,"audioCodecs",a,c,u),ge("RAISE_H264_BASELINE_PRIORITY")){let _=u.videoCodecs.findIndex(S=>S.rtpMap&&S.rtpMap.encodingName.toLocaleLowerCase()==="h264"&&S.fmtp&&S.fmtp.parameters["profile-level-id"]==="42001f");if(_!==-1){let S=u.videoCodecs.findIndex(C=>C.rtpMap&&C.rtpMap.encodingName.toLocaleLowerCase()==="h264");if(S<_){z.debug("raising H264 baseline profile priority");let C=u.videoCodecs[_];u.videoCodecs.splice(_,1),u.videoCodecs.splice(S,0,C)}S!==-1&&(c.videoCodecs=c.videoCodecs.filter(C=>!(C.rtpMap&&C.rtpMap.encodingName.toLocaleLowerCase()==="h264"&&C.fmtp&&C.fmtp.parameters["profile-level-id"]!=="42001f")))}}return{send:a,recv:c,sendrecv:u}}function su(n,i,a,c,u,_){if(a==="videoExtensions"||a==="audioExtensions"){let S=[];return n[a].forEach(C=>{i[a].some((R,e)=>{if(C.entry===R.entry&&C.extensionName===R.extensionName)return S.push(e),!0})?_[a].push(C):c[a].push(C)}),void i[a].forEach((C,R)=>{S.indexOf(R)===-1&&u[a].push(C)})}if(a==="videoCodecs"||a==="audioCodecs"){let S=[];return n[a].forEach(C=>{i[a].some((R,e)=>{if(C.payloadType===R.payloadType&&JSON.stringify(C)===JSON.stringify(R))return S.push(e),!0})?_[a].push(C):c[a].push(C)}),void i[a].forEach((C,R)=>{S.indexOf(R)===-1&&u[a].push(C)})}}function z_(n){let{send:i,recv:a,sendrecv:c}=n;if(!c){if(!i||!a)throw new Error("cannot merge rtp capabilities because one of send or recv is empty!");return{send:i,recv:a}}let u,_;return i?(u={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},u.audioCodecs=[...i.audioCodecs,...c.audioCodecs],u.videoCodecs=[...i.videoCodecs,...c.videoCodecs],u.audioExtensions=[...i.audioExtensions,...c.audioExtensions],u.videoExtensions=[...i.videoExtensions,...c.videoExtensions]):u=c,a?(_={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},_.audioCodecs=[...a.audioCodecs,...c.audioCodecs],_.videoCodecs=[...a.videoCodecs,...c.videoCodecs],_.audioExtensions=[...a.audioExtensions,...c.audioExtensions],_.videoExtensions=[...a.videoExtensions,...c.videoExtensions]):_=c,{send:u,recv:_}}function ou(n){n.media.mediaType==="audio"&&n.attributes.payloads.filter(i=>{var a;return((a=i.rtpMap)===null||a===void 0?void 0:a.encodingName.toLowerCase())==="opus"}).forEach(i=>{i.fmtp||(i.fmtp={parameters:{}}),i.fmtp.parameters.stereo="1",i.fmtp.parameters["sprop-stereo"]="1"})}function f1(n,i,a,c){let u=[];if(n===Tt.VIDEO){if(ge("H264_PROFILE_LEVEL_ID")&&c==="h264"&&(u=i.videoCodecs.filter(_=>{var S;return ft(S=_.rtpMap&&_.rtpMap.encodingName.toLowerCase()||"").call(S,c)&&_&&_.fmtp&&_.fmtp.parameters["profile-level-id"]===ge("H264_PROFILE_LEVEL_ID")})),!Array.isArray(u)||u.length===0){let _=[],S=[],C=[],R=[];if(a.videoCodecs.forEach(e=>{let t=e.rtpMap&&e.rtpMap.encodingName.toLowerCase()||"";ft(t).call(t,c)?_.push(e):ft(t).call(t,"vp9")?S.push(e):ft(t).call(t,"vp8")?C.push(e):ft(t).call(t,"h264")&&R.push(e)}),_.length===0){let e="";S.length!==0?(_=S,e="vp9"):C.length!==0?(_=C,e="vp8"):R.length!==0&&(_=R,e="h264"),z.warning("codec ".concat(c," not included in rtpCapabilities, fallback to default payloads: ").concat(e))}_.length!==0&&(u=i.videoCodecs.filter(e=>_.some(t=>t.payloadType===e.payloadType)))}if(u.length===0&&(z.warning("codec ".concat(c," not included in rtpCapabilities, fallback to default payloads: ").concat(i.videoCodecs[0].rtpMap&&i.videoCodecs[0].rtpMap.encodingName)),u=i.videoCodecs),ge("USE_PUB_RTX")||ge("USE_SUB_RTX")){let _=iD(u,i.videoCodecs);u=[...u,..._]}}else u=i.audioCodecs.filter(_=>{var S;return ft(S=_.rtpMap&&_.rtpMap.encodingName.toLowerCase()||"").call(S,c)}),u.length===0&&(z.warning("codec ".concat(c," not included in rtpCapabilities, fallback to opus")),u=i.audioCodecs.filter(_=>{var S;return ft(S=_.rtpMap&&_.rtpMap.encodingName.toLowerCase()||"").call(S,"opus")}));return u}function iD(n,i){let a=n.map(c=>c.payloadType.toString());return i.filter(c=>c.rtpMap&&c.rtpMap.encodingName==="rtx"&&c.fmtp&&c.fmtp.parameters.apt&&ft(a).call(a,c.fmtp&&c.fmtp.parameters.apt))}async function h1(n,i,a){let c=i.toString(),u=xS(c,"offer","remote","exchangeSDP");await n.setRemoteDescription({type:"offer",sdp:c});let _=await n.createAnswer();if(!_.sdp)throw new Error("cannot get answer sdp");let S=_.sdp;S=H_(S,a||{}),u==null||u(S||""),await n.setLocalDescription({type:"answer",sdp:S})}function H_(n,i,a){let c=Dn(n),{useXR:u}=i;return c.mediaDescriptions.forEach(_=>{var S;_.attributes.mid&&(Array.isArray(a)&&!ft(a).call(a,_.attributes.mid)||(_.media.mediaType==="audio"&&ou(_),u&&ft(S=["audio","video"]).call(S,_.media.mediaType)&&_.attributes.payloads.forEach(C=>{C.rtcpFeedbacks.findIndex(R=>R.type==="rrtr")===-1&&C.rtcpFeedbacks.push({type:"rrtr"})})))}),me(c)}function xS(n,i,a,c){if(ge("SDP_LOGGING"))return z.upload("exchanging ".concat(a," ").concat(i," SDP during P2PConnection.").concat(c,`
`),n),i==="offer"?u=>{xS(u,"answer",a==="local"?"remote":"local",c)}:void 0}function aD(n){let i=ge("COMPATIBLE_SDP_EXTENSION");return!!(Array.isArray(i)&&i.length>0)&&i.some(a=>ft(n).call(n,a))}function sD(n,i){try{var a;return((a=n.fmtp)===null||a===void 0?void 0:a.parameters.apt)===i.payloadType.toString()}catch{return!1}}function RU(n,i){var a=Object.keys(n);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(n);i&&(c=c.filter(function(u){return Object.getOwnPropertyDescriptor(n,u).enumerable})),a.push.apply(a,c)}return a}function Wc(n,i){return typeof ge(n)===i?ge(n):void 0}function Y8(){try{let n=ge("EXPERIMENTS")||{};return typeof n=="string"||Array.isArray(n)?{}:function(i){for(var a=1;a<arguments.length;a++){var c=arguments[a]!=null?arguments[a]:{};a%2?RU(Object(c),!0).forEach(function(u){re(i,u,c[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(c)):RU(Object(c)).forEach(function(u){Object.defineProperty(i,u,Object.getOwnPropertyDescriptor(c,u))})}return i}({},n)}catch(n){return z.debug("handle gateway attributes failed: ",n),{}}}let IU={};function Gg(n){(!(arguments.length>1&&arguments[1]!==void 0)||arguments[1])&&z.debug("install service ".concat(n.name)),IU[n.name]=n}function ao(n){let i=IU[n];if(!i)throw new Ye(oe.INVALID_OPERATION,"".concat(n," not found, please use AgoraRTC.use(").concat(n,"Service) to load it first"));return i}function NI(n,i){return ao("DataStream").create(n,i)}function zg(){return ao("InterceptFrame").create()}function p1(n,i){var a=Object.keys(n);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(n);i&&(c=c.filter(function(u){return Object.getOwnPropertyDescriptor(n,u).enumerable})),a.push.apply(a,c)}return a}function bh(n){for(var i=1;i<arguments.length;i++){var a=arguments[i]!=null?arguments[i]:{};i%2?p1(Object(a),!0).forEach(function(c){re(n,c,a[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(a)):p1(Object(a)).forEach(function(c){Object.defineProperty(n,c,Object.getOwnPropertyDescriptor(a,c))})}return n}let US=new Map;class K8 extends li{get state(){return this._state}set state(i){if(i===this._state)return;let a=this._state;this._state=i,i==="DISCONNECTED"&&this._disconnectedReason?this.emit(La.CONNECTION_STATE_CHANGE,i,a,this._disconnectedReason):this.emit(La.CONNECTION_STATE_CHANGE,i,a)}get joinGatewayStartTime(){return this._joinGatewayStartTime}set joinGatewayStartTime(i){z.debug("[".concat(this.store.clientId,"] set joinGatewayStartTime at ").concat(i)),this._joinGatewayStartTime=i}constructor(i,a){var c,u,_;super(),re(this,"store",void 0),re(this,"joinInfo",void 0),re(this,"key",void 0),re(this,"ntpOffset",0),re(this,"signal",void 0),re(this,"role",void 0),re(this,"inChannelInfo",{joinAt:null,duration:0}),re(this,"spec",void 0),re(this,"_state","DISCONNECTED"),re(this,"_statsCollector",void 0),re(this,"_disconnectedReason",void 0),re(this,"isSignalRecover",!1),re(this,"hasChangeBGPAddress",!1),re(this,"trafficStatsInterval",void 0),re(this,"networkQualityInterval",void 0),re(this,"_joinGatewayStartTime",0),re(this,"_signalTimeout",!1),re(this,"_clientRoleOptions",void 0),re(this,"_isProactiveJoin",!1),this.store=i,this.spec=a,this.signal=this.store.useP2P?(c={spec:bh(bh({},a),{},{retryConfig:a.websocketRetryConfig}),store:i},(u=(_=ao("P2PChannel")).createSubmodule)===null||u===void 0?void 0:u.call(_,c)):new OY(bh(bh({},a),{},{retryConfig:a.websocketRetryConfig}),i),this._statsCollector=a.statsCollector,this.role=a.role||"audience",this._clientRoleOptions=a.clientRoleOptions,this.handleSignalEvents()}async join(i,a,c){this.store.joinGatewayStart(),i.cloudProxyServer!=="disabled"&&(this.hasChangeBGPAddress=!0);let u=Date.now(),_=US.get(i.cname);if(_||(_=new Map,US.set(i.cname,_)),this._isProactiveJoin=!0,_.has(i.uid)){let e=new De(oe.UID_CONFLICT);throw jt.joinGateway(i.sid,{lts:u,succ:!1,ec:e.code,addr:null,uid:i.uid,cid:i.cid,firstSuccess:this._isProactiveJoin,avoidJoinStartTime:this.store.avoidJoinStart,isProxy:!!i.proxyServer,signalChannel:"0",preload:i.preload}),e}_.set(i.uid,!0),this.joinInfo=i,this.key=a;let S=0;this.joinGatewayStartTime=u;let C=i.proxyServer;try{z.debug("[".concat(this.store.clientId,"] use websocket join uid ").concat(S));let e=i.gatewayAddrs.map(t=>{let{address:r}=t,[s,l]=r.split(":"),f={host:s,port:l};return i.proxyServer&&(f.proxy=i.proxyServer),f});S=(await this.signal.init(e)).uid,z.debug("[".concat(this.store.clientId,"] websocket join uid ").concat(S," cost ").concat(Date.now()-this.joinGatewayStartTime))}catch(e){var R;throw z.error("[".concat(this.store.clientId,"] User join failed"),e.toString()),jt.joinGateway(i.sid,{lts:u,succ:!1,ec:((R=e.data)===null||R===void 0?void 0:R.desc)||e.code,errorMsg:e.message,addr:this.signal.url,uid:i.uid,cid:i.cid,firstSuccess:this._isProactiveJoin,avoidJoinStartTime:this.store.avoidJoinStart,isProxy:!!C,signalChannel:"0",preload:i.preload}),_.delete(i.uid),this.signal.close(),e}return this.state="CONNECTED",this.inChannelInfo.joinAt=Date.now(),z.debug("[".concat(this.store.clientId,"] Connected to gateway server")),this.trafficStatsInterval=window.setInterval(()=>{this.updateTrafficStats().catch(e=>{z.warning("[".concat(this.store.clientId,"] get traffic stats error"),e.toString())})},3e3),this.networkQualityInterval=window.setInterval(()=>{navigator&&navigator.onLine!==void 0&&!navigator.onLine?this.emit(La.NETWORK_QUALITY,{downlinkNetworkQuality:6,uplinkNetworkQuality:6}):this._signalTimeout?this.emit(La.NETWORK_QUALITY,{downlinkNetworkQuality:5,uplinkNetworkQuality:5}):this.state==="CONNECTED"&&this._statsCollector.trafficStats?this.emit(La.NETWORK_QUALITY,{uplinkNetworkQuality:H8(this._statsCollector.trafficStats.B_unq),downlinkNetworkQuality:H8(this._statsCollector.trafficStats.B_dnq)}):this.emit(La.NETWORK_QUALITY,{uplinkNetworkQuality:0,downlinkNetworkQuality:0})},2e3),this.store.joinGatewayEnd(),S}async leave(){let i=arguments.length>0&&arguments[0]!==void 0&&arguments[0],a=arguments.length>1?arguments[1]:void 0;if(this.state!=="DISCONNECTED"){a!==ur.FALLBACK&&(this.state="DISCONNECTING");try{i||this.signal.connectionState!==qr.CONNECTED||await function(c,u){return u===1/0?c:Et.race([c,gL(u)])}(this.signal.request(ln.LEAVE,void 0,!0),3e3)}catch(c){z.warning("[".concat(this.store.clientId,"] leave request failed, ignore"),c)}this.signal.close(a),a!==ur.FALLBACK&&(this.state="DISCONNECTED"),this.reset()}}async publish(i,a,c){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new De(oe.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));let u={state:"offer",p2p_id:this.store.p2pId,ortc:a,mode:this.spec.mode,extend:ge("PUB_EXTEND"),twcc:!!ge("PUBLISH_TWCC"),rtx:!!ge("USE_PUB_RTX")};try{return(await this.signal.request(ln.PUBLISH,u,!0))._message}catch(_){if(c&&_.data&&_.data.code===Zt.ERR_PUBLISH_REQUEST_INVALID)return z.warning("[".concat(this.store.clientId,"] receive publish error code, retry"),_.toString()),await this.tryUnpubBeforeRepub(i,a),this.publish(i,a,!1);throw _}}async publishDataChannel(i,a,c){var u;if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new De(oe.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));let _={stream_id:a.streamId,ordered:a.ordered?1:0,max_retrans_times:(u=a.maxRetransmits)!==null&&u!==void 0?u:10,channel_id:a.channelId,metadata:a.metadata};try{await this.signal.request(ln.PUBLISH_DATASTREAM,_,!0)}catch(S){if(c&&S.data&&S.data.code===Zt.ERR_PUBLISH_REQUEST_INVALID)return z.warning("[".concat(this.store.clientId,"] receive publish datachannels error code, retry"),S.toString()),await this.tryUnpubDataChannelBeforeRepub(i,a),this.publishDataChannel(i,a,!1);throw S}}async unpublish(i,a){try{if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new De(oe.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));await this.signal.request(ln.UNPUBLISH,{stream_id:a,ortc:i},!0)}catch(c){z.warning("[".concat(this.store.clientId,"] unpublish warning: "),c)}}async unpublishDataChannel(i){try{if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new De(oe.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));await Et.all(i.map(a=>this.signal.request(ln.UNPUBLISH_DATASTREAM,{channel_id:a},!0)))}catch(a){z.warning("unpublish datachannels warning: ",a)}}async presubscribe(i,a,c){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new De(oe.INVALID_OPERATION,"can not presubscribe when connection state is ".concat(this.state));let u={stream_id:i,stream_type:a,mode:this.spec.mode,codec:this.spec.codec,p2p_id:this.store.p2pId,twcc:!!ge("SUBSCRIBE_TWCC"),rtx:!!ge("USE_SUB_RTX")||void 0,extend:ge("SUB_EXTEND"),svc:Array.isArray(ge("SVC"))&&ge("SVC").length!==0?ge("SVC"):void 0};try{return await this.signal.request(ln.PRE_SUBSCRIBE,u,!0)}catch(_){if(c&&_.data&&_.data.code===Zt.ERR_SUBSCRIBE_REQUEST_INVALID)return z.warning("[".concat(this.store.clientId,"] pre-subscribe error, retry"),_.toString()),this.presubscribe(i,a,!1);throw _}}async subscribe(i,a,c){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new De(oe.INVALID_OPERATION,"can not subscribe when connection state is ".concat(this.state));let u={stream_id:i,stream_type:a.stream_type,mode:this.spec.mode,codec:this.spec.codec,p2p_id:this.store.p2pId,twcc:!!ge("SUBSCRIBE_TWCC"),rtx:!!ge("USE_SUB_RTX"),extend:ge("SUB_EXTEND"),ssrcId:a.ssrcId,svc:Array.isArray(ge("SVC"))&&ge("SVC").length!==0?ge("SVC"):void 0};try{return(await this.signal.request(ln.SUBSCRIBE,u,!0))._message}catch(_){if(c&&_.data&&_.data.code===Zt.ERR_SUBSCRIBE_REQUEST_INVALID)return z.warning("[".concat(this.store.clientId,"] receiver subscribe error code, retry"),_.toString()),await this.tryUnsubBeforeResub(i,a),await this.subscribe(i,a,!1);throw _}}async subscribeDataChannel(i,a,c){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new De(oe.INVALID_OPERATION,"can not subscribe datachannel when connection state is ".concat(this.state));let u={uid:i,stream_id:a.id,channel_id:a.datachannelId};try{return void await this.signal.request(ln.SUBSCRIBE_DATASTREAM,u,!0)}catch(_){if(c&&_.data&&_.data.code===Zt.ERR_SUBSCRIBE_REQUEST_INVALID)return z.warning("[".concat(this.store.clientId,"] receiver subscribe datachannel error code, retry"),_.toString()),await this.tryUnsubDataChannelBeforeResub(i,a),await this.subscribeDataChannel(i,a,!1);throw _}}async subscribeAll(i,a){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new De(oe.INVALID_OPERATION,"can not massSubscribe when connection state is ".concat(this.state));let c={p2p_id:this.store.p2pId,users:i,dtx:!1,rtx:!!ge("USE_SUB_RTX"),twcc:!!ge("SUBSCRIBE_TWCC"),svc:Array.isArray(ge("SVC"))&&ge("SVC").length!==0?ge("SVC"):void 0};try{return await this.signal.request(ln.SUBSCRIBE_STREAMS,c,!0)}catch(u){if(a&&u.data&&u.data.code===Zt.ERR_SUBSCRIBE_REQUEST_INVALID)return z.warning("[".concat(this.store.clientId,"] receiver massSubscribe error code, retry"),u.toString()),await this.tryMassUnsubBeforeResub(i),await this.subscribeAll(i,!1);throw u}}async setVideoProfile(i){let a=function(c){if(!(c.bitrateMax&&c.bitrateMin&&c.frameRate&&c.height&&c.width))return;let u=c.frameRate,_=c.width,S=c.height,C=!0;return typeof u!="number"&&(u=u.exact||u.ideal||u.max||u.min||0,u||(C=!1)),typeof _!="number"&&(_=_.exact||_.ideal||_.max||_.min||0,_||(C=!1)),typeof S!="number"&&(S=S.exact||S.ideal||S.max||S.min||0,u||(C=!1)),C?{stream_type:0,width:_,height:S,fps:u,start_bps:1e3*c.bitrateMax,min_bps:1e3*c.bitrateMin,target_bps:1e3*c.bitrateMax}:void 0}(i);if(a)return this.signal.request(ln.SET_VIDEO_PROFILE,a);z.debug("[".concat(this.store.clientId,"] encoder config is not complete, do not report to gateway"))}async unsubscribe(i,a){try{await this.signal.request(ln.UNSUBSCRIBE,{p2p_id:this.store.p2pId,ortc:i,stream_id:a},!0)}catch(c){z.warning("[".concat(this.store.clientId,"] unsubscribe warning: "),c)}}async unsubscribeDataChannel(i,a){try{if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new De(oe.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));await Et.all(i.map(c=>this.signal.request(ln.UNSUBSCRIBE_DATASTREAM,{stream_id:c,uid:a},!0)))}catch(c){z.warning("unsubscribeDataChannel warning: ",c)}}async massUnsubscribe(i){try{await this.signal.request(ln.UNSUBSCRIBE_STREAMS,i,!0)}catch(a){z.warning("[".concat(this.store.clientId,"] massUnsubscribeAll warning: "),a)}}async reconnectPC(i){let{iceParameters:a,dtlsParameters:c,rtpCapabilities:u}=i;return{gatewayEstablishParams:await this.signal.request(ln.CONNECT_PC,{p2p_id:this.store.p2pId,stream_id:this.store.uid,ortc:{iceParameters:a,dtlsParameters:c,rtpCapabilities:u}},!0),gatewayAddress:this.getCurrentGatewayAddress()}}getGatewayInfo(){return this.signal.request(ln.GATEWAY_INFO)}async renewToken(i){await this.signal.request(ln.RENEW_TOKEN,i),this.key=i.token}updateClientRole(i,a){a&&(this._clientRoleOptions=Object.assign({},a)),ge("CLIENT_ROLE_OPTIONS")&&(z.debug("[".concat(this.store.clientId,"] Set roleOptions for ").concat(JSON.stringify(ge("CLIENT_ROLE_OPTIONS"))," instead of ").concat(JSON.stringify(this._clientRoleOptions)," ")),this._clientRoleOptions=Object.assign({},ge("CLIENT_ROLE_OPTIONS"))),this.role=i}async setClientRole(i,a){if(a&&(this._clientRoleOptions=Object.assign({},a)),ge("CLIENT_ROLE_OPTIONS")&&(this._clientRoleOptions=Object.assign({},ge("CLIENT_ROLE_OPTIONS")),z.debug("[".concat(this.store.clientId,"] Set roleOptions for ").concat(JSON.stringify(ge("CLIENT_ROLE_OPTIONS"))," instead of ").concat(JSON.stringify(this._clientRoleOptions)," "))),this.state!=="CONNECTED")return void(this.role=i);let c,u=0;i==="audience"?this._clientRoleOptions&&this._clientRoleOptions.delay?(c=this._clientRoleOptions.delay,u=1):u=this._clientRoleOptions&&this._clientRoleOptions.level?this._clientRoleOptions.level:2:u=0,await this.signal.request(ln.SET_CLIENT_ROLE,{role:i,level:u,delay:c,client_ts:Date.now()}),this.role=i}async setRemoteVideoStreamType(i,a){await this.signal.request(ln.SWITCH_VIDEO_STREAM,{stream_id:i,stream_type:a})}async setDefaultRemoteVideoStreamType(i){await this.signal.request(ln.DEFAULT_VIDEO_STREAM,{stream_type:i})}async setStreamFallbackOption(i,a){await this.signal.request(ln.SET_FALLBACK_OPTION,{stream_id:i,fallback_type:a})}async pickSVCLayer(i,a){await this.signal.request(ln.PICK_SVC_LAYER,{stream_id:i,spatial_layer:a.spatialLayer,temporal_layer:a.temporalLayer})}async setRTM2Flag(i){await this.signal.request(ln.SET_RTM2_FLAG,{rtm2_flag:i})}async sendExtensionMessage(i,a,c){if(this.store.useP2P)return this.signal.sendExtensionMessage(i,a,c)}getInChannelInfo(){return this.inChannelInfo.joinAt&&(this.inChannelInfo.duration=Date.now()-this.inChannelInfo.joinAt),bh({},this.inChannelInfo)}async getGatewayVersion(){return(await this.signal.request(ln.GATEWAY_INFO)).version}reset(){if(this.inChannelInfo.joinAt&&(this.inChannelInfo.duration=Date.now()-this.inChannelInfo.joinAt,this.inChannelInfo.joinAt=null),this.trafficStatsInterval&&(window.clearInterval(this.trafficStatsInterval),this.trafficStatsInterval=void 0),this.joinInfo){let i=US.get(this.joinInfo.cname);i&&i.delete(this.joinInfo.uid)}this.joinInfo=void 0,this.key=void 0,this.networkQualityInterval&&(window.clearInterval(this.networkQualityInterval),this.networkQualityInterval=void 0)}updateTurnConfigFromSignal(){if(!this.joinInfo)return;let i=function(a){let c;return c=a.startsWith("dc")?a.match(/(dc\:\/\/)?([^:]+):(\d+)/):a.match(/(wss\:\/\/)?([^:]+):(\d+)/),c?{username:rs.username,password:rs.password,turnServerURL:c[2],tcpport:parseInt(c[3])+30,udpport:parseInt(c[3])+30,forceturn:!1}:null}((this.joinInfo.cloudProxyServer==="disabled"?this.signal.url:this.joinInfo.gatewayAddrs[this.signal.currentURLIndex].address)||"");this.joinInfo.turnServer.serversFromGateway=[],i&&this.joinInfo.turnServer.mode!=="off"&&this.joinInfo.cloudProxyServer==="disabled"&&this.joinInfo.turnServer.serversFromGateway.push(bh(bh({},rs),{},{turnServerURL:i.turnServerURL,tcpport:i.tcpport,udpport:i.udpport,username:this.joinInfo.uid.toString(),password:this.joinInfo.token}))}async updateTrafficStats(){if(this.state!=="CONNECTED")return;let i=await this.signal.request(ln.TRAFFIC_STATS,void 0,!0);i.timestamp=Date.now(),i.ntp_offset!=null&&(this.ntpOffset=i.ntp_offset),i.peer_delay.forEach(a=>{let c=this._statsCollector.trafficStats&&this._statsCollector.trafficStats.peer_delay.find(u=>u.peer_uid===a.peer_uid);c&&c.B_st!==a.B_st&&In(()=>{this.emit(La.STREAM_TYPE_CHANGE,a.peer_uid,a.B_st)})}),this._statsCollector.updateTrafficStats(i)}getJoinMessage(i){if(!this.joinInfo||!this.key)throw new De(oe.UNEXPECTED_ERROR,"can not generate join message, no join info");let a=Object.assign({},this.joinInfo.apResponse),c=ge("REPORT_APP_SCENARIO");if(typeof c!="string")try{c=JSON.stringify(c)}catch{c=void 0}var u;c&&c.length>128&&(c=void 0),this.store.hasStartJoinChannel=!0,this.store.isABTestSuccess||this.emit(La.UPDATE_GATEWAY_CONFIG),u=this.store.clientId,ft(NS).call(NS,u)||NS.push(u);let _=!(Ni()||qn(87)||Px())&&typeof ge("ENABLE_PRE_SUB")=="boolean"&&ge("ENABLE_PRE_SUB"),S=!Px()&&Wc("ENABLE_PREALLOC_PC","boolean"),C=Y8(),R=_S(87)||function(){let t=En();if(t.name!==cr.SAFARI||!t.browserVersion)return!1;let r=t.browserVersion.split(".");return Number(r[0])>15||Number(r[0])===15&&Number(r[1])>=4}(),e=bh({license:this.joinInfo.license,p2p_id:this.store.p2pId,session_id:this.joinInfo.sid,app_id:this.joinInfo.appId,channel_key:this.key,channel_name:this.joinInfo.cname,sdk_version:Zd,browser:navigator.userAgent,process_id:ge("PROCESS_ID"),mode:this.store.useP2P?"p2p":this.spec.mode,codec:this.spec.codec,role:this.role,has_changed_gateway:this.hasChangeBGPAddress,ap_response:a,extend:ge("JOIN_EXTEND"),details:{6:this.joinInfo.stringUid,cservice_map:this.joinInfo.cloudProxyServer==="proxy3"?"1":this.joinInfo.cloudProxyServer==="proxy5"?"2":void 0},features:{rejoin:!0},optionalInfo:this.joinInfo.optionalInfo,appScenario:c,attributes:{userAttributes:bh({enableEncodedTransform:!!ge("ENABLE_AUDIO_METADATA")&&R||!!ge("ENABLE_AUDIO_TOPN")&&fL(cr.CHROME,87,116)||void 0,enableAudioMetadata:!!ge("ENABLE_AUDIO_METADATA")&&R,enableAudioPts:!!ge("ENABLE_AUDIO_PTS_METADATA")&&R,topnSmoothLevel:ge("TOPN_SMOOTH_LEVEL"),topnNewSpeakerDelay:ge("TOPN_NEW_SPEAKER_DELAY"),topnSwitchHoldMs:ge("TOPN_SWITCH_HOLD_MS"),topnAudioGain:ge("TOPN_AUDIO_GAIN"),enablePublishedUserList:ge("ENABLE_PUBLISHED_USER_LIST"),maxSubscription:ge("MAX_SUBSCRIPTION"),subscribeAudioFilterTopN:Wc("SUBSCRIBE_AUDIO_FILTER_TOPN","number"),enablePublishAudioFilter:Wc("ENABLE_PUBLISH_AUDIO_FILTER","boolean"),enableUserLicenseCheck:Wc("ENABLE_USER_LICENSE_CHECK","boolean"),enableRTX:ge("USE_PUB_RTX")===!0||ge("USE_SUB_RTX")===!0||void 0,disableFEC:ge("DISABLE_FEC"),enableNTPReport:!!ge("ENABLE_NTP_REPORT")||void 0,enableInstantVideo:!!ge("ENABLE_INSTANT_VIDEO")||void 0,enableFulllinkAvSync:!!ge("ENABLE_FULL_LINK_AV_SYNC")||void 0,enableDataStream2:Wc("ENABLE_DATASTREAM_2","boolean"),enableAutFeedback:!!ge("ENABLE_AUT_FEEDBACK")||void 0,rtm2Flag:typeof this.joinInfo.rtmFlag=="number"?this.joinInfo.rtmFlag:void 0,enableUserAutoRebalanceCheck:!!ge("ENABLE_USER_AUTO_REBALANCE_CHECK"),enableXR:Wc("USE_XR","boolean"),enableLossbasedBwe:Wc("ENABLE_LOSSBASED_BWE","boolean"),enableAutCC:!!ge("ENABLE_AUT_CC")||void 0,enableCCFallback:Wc("ENABLE_CC_FALLBACK","boolean"),enablePreallocPC:S,preSubNum:_?Wc("PRE_SUB_NUM","number"):void 0,enablePubTWCC:Wc("PUBLISH_TWCC","boolean"),enableSubTWCC:Wc("SUBSCRIBE_TWCC","boolean"),enablePubRTX:Wc("USE_PUB_RTX","boolean"),enableSubRTX:Wc("USE_SUB_RTX","boolean"),enableSubSVC:ge("ENABLE_SVC")?ge("ENABLE_SVC_DEFAULT_CODECS"):Array.isArray(ge("SVC"))&&ge("SVC").length!==0?ge("SVC"):void 0,enableSvcExtended:ge("ENABLE_SVC")&&Array.isArray(ge("SVC_EXTENDED"))&&ge("SVC_EXTENDED").length!==0?ge("SVC_EXTENDED"):void 0},C)},join_ts:this.joinGatewayStartTime},i);return this.joinInfo.stringUid&&(e.string_uid=this.joinInfo.stringUid),this.joinInfo.aesmode&&this.joinInfo.aespassword&&(e.aes_mode=this.joinInfo.aesmode,ge("ENCRYPT_AES")?(e.aes_secret=this.joinInfo.aespassword,e.aes_encrypt=!0):e.aes_secret=this.joinInfo.aespassword,this.joinInfo.aessalt&&(e.aes_salt=this.joinInfo.aessalt)),a.addresses[this.signal.websocket.currentURLIndex]&&(e.ap_response.ticket=a.addresses[this.signal.websocket.currentURLIndex].ticket,delete a.addresses),this.joinInfo.defaultVideoStream!==void 0&&(e.default_video_stream=this.joinInfo.defaultVideoStream),e}getRejoinMessage(){if(!this.joinInfo)throw new De(oe.UNEXPECTED_ERROR,"can not generate rejoin message, no join info");return{session_id:this.joinInfo.sid,channel_name:this.joinInfo.cname,cid:this.joinInfo.cid,uid:this.joinInfo.uid,vid:Number(this.joinInfo.vid)}}handleSignalEvents(){this.signal.on(dn.WS_RECONNECT_CREATE_CONNECTION,i=>{this.joinGatewayStartTime=Date.now()}),this.signal.on(dn.WS_RECONNECTING,i=>{this.joinInfo&&jt.WebSocketQuit(this.joinInfo.sid,{lts:Date.now(),succ:-1,cname:this.joinInfo.cname,uid:this.joinInfo.uid,cid:this.joinInfo.cid,errorCode:i||Ma.NETWORK_ERROR}),this.joinInfo&&(this.state="RECONNECTING",jt.sessionInit(this.joinInfo.sid,{lts:new Date().getTime(),extend:this.isSignalRecover?{recover:!0}:{rejoin:!0},cname:this.joinInfo.cname,appid:this.joinInfo.appId,mode:this.spec.mode,stringUid:this.joinInfo.stringUid,channelProfile:this.spec.mode==="live"?1:0,channelMode:0,lsid:this.joinInfo.sid,clientRole:this.role==="audience"?2:1,buildFormat:1}),this.isSignalRecover=!1,this.joinGatewayStartTime=Date.now())}),this.signal.on(dn.WS_CLOSED,i=>{let a;switch(i){case ur.LEAVE:a=Ma.LEAVE;break;case ur.UID_BANNED:case ur.IP_BANNED:case ur.CHANNEL_BANNED:case ur.SERVER_ERROR:a=Ma.SERVER_ERROR;break;case ur.FALLBACK:a=Ma.FALLBACK;break;case ur.LICENSE_MISSING:case ur.LICENSE_EXPIRED:case ur.LICENSE_MINUTES_EXCEEDED:case ur.LICENSE_PERIOD_INVALID:case ur.LICENSE_MULTIPLE_SDK_SERVICE:case ur.LICENSE_ILLEGAL:case ur.TOKEN_EXPIRE:a=i;break;default:a=Ma.NETWORK_ERROR}z.debug("[".concat(this.store.clientId,"] [signal] websocket closed, reason: ").concat(a||"undefined -> "+Ma.NETWORK_ERROR)),this.joinInfo&&jt.WebSocketQuit(this.joinInfo.sid,{lts:Date.now(),succ:i===ur.LEAVE?1:-1,cname:this.joinInfo.cname,uid:this.joinInfo.uid,cid:this.joinInfo.cid,errorCode:a}),this._disconnectedReason=i,i!==ur.FALLBACK&&(this.state="DISCONNECTED"),this.reset()}),this.signal.on(dn.WS_CONNECTED,()=>{if(this.updateTurnConfigFromSignal(),this.state="CONNECTED",this.joinInfo){if(this.role==="audience"){let i=ge("CLIENT_ROLE_OPTIONS")||this._clientRoleOptions;i&&(i.level||i.delay)&&(z.debug("[".concat(this.store.clientId,"] patch to send set client role, role: ").concat(this.role,", mode: ").concat(this.spec.mode,", level: ").concat(i.level,", delay: ").concat(i.delay)),this.setClientRole(this.role,i))}if(jt.joinGateway(this.joinInfo.sid,{lts:this.joinGatewayStartTime,succ:!0,ec:null,vid:this.joinInfo.vid,addr:this.signal.url,uid:this.joinInfo.uid,cid:this.joinInfo.cid,firstSuccess:this._isProactiveJoin,avoidJoinStartTime:this.store.avoidJoinStart,isProxy:!!this.joinInfo.proxyServer,signalChannel:"0",preload:this.joinInfo.preload,isABTestSuccess:this.store.isABTestSuccess}),this._isProactiveJoin=!1,this.joinInfo.useLocalAccessPoint&&this.joinInfo.setLocalAPVersion===1){let i=this.signal.url&&this.signal.url.match(/wss\:\/\/([^:]+):(\d+)/);if(!i)return void z.error("[".concat(this.store.clientId,"] set local access point after joined failed: ").concat(i));Sr("EVENT_REPORT_DOMAIN",i[1]),Sr("EVENT_REPORT_BACKUP_DOMAIN",i[1]),Sr("LOG_UPLOAD_SERVER","".concat(i[1],":6444"))}}}),this.signal.on(kn.ON_UPLINK_STATS,i=>{this._statsCollector.updateUplinkStats(i)}),this.signal.on(dn.REQUEST_RECOVER,(i,a,c)=>{if(!this.joinInfo)return c(new De(oe.UNEXPECTED_ERROR,"gateway: can not recover, no join info"));i&&(this.joinInfo.multiIP=i,this.hasChangeBGPAddress=!0),this.isSignalRecover=!0,Bn(this,La.REQUEST_NEW_GATEWAY_LIST).then(a).catch(c)}),this.signal.on(dn.REQUEST_JOIN_INFO,async(i,a,c)=>{var u;if(this.updateTurnConfigFromSignal(),this.store.useP2P)return void i(this.getJoinMessage({ortc:{}}));let _=Fn((u=this.joinInfo)===null||u===void 0?void 0:u.turnServer);if(ge("NEW_TURN_MODE")&&_){let e=_.servers,t=_.serversFromGateway,r=this.signal.currentURLIndex;e.length>0&&(e=[e[r%e.length]],_.servers=e),Array.isArray(t)&&t.length>0&&(t=[t[0]],_.serversFromGateway=t),z.debug("[".concat(this.store.clientId,"] use single turn, use turn server index: ").concat(r))}let{iceParameters:S,dtlsParameters:C,rtpCapabilities:R}=await Bn(this,La.REQUEST_P2P_CONNECTION_PARAMS,{turnServer:_});try{i(this.getJoinMessage({ortc:{iceParameters:S,dtlsParameters:C,rtpCapabilities:R,version:"2"}}))}catch(e){a(e)}}),this.signal.on(dn.REQUEST_REJOIN_INFO,i=>{i(this.getRejoinMessage())}),this.signal.on(dn.REPORT_JOIN_GATEWAY,(i,a)=>{if(!this.joinInfo)return;let c,u="";var _;i instanceof De?(c=((_=i.data)===null||_===void 0?void 0:_.desc)||i.code,u=i.message):c=i,jt.joinGateway(this.joinInfo.sid,{lts:this.joinGatewayStartTime,succ:!1,ec:c,errorMsg:u,addr:a,uid:this.joinInfo.uid,cid:this.joinInfo.cid,firstSuccess:this._isProactiveJoin,avoidJoinStartTime:this.store.avoidJoinStart,isProxy:!!this.joinInfo.proxyServer,signalChannel:"0",preload:this.joinInfo.preload})}),this.signal.on(dn.IS_P2P_DISCONNECTED,i=>{i(nr(this,La.IS_P2P_DISCONNECTED))}),this.signal.on(dn.DISCONNECT_P2P,()=>{this.emit(La.DISCONNECT_P2P)}),this.signal.on(dn.REQUEST_SUCCESS,()=>{this._signalTimeout=!1}),this.signal.on(dn.REQUEST_TIMEOUT,()=>{this._signalTimeout=!0}),this.signal.on(dn.JOIN_RESPONSE,i=>{let a=this.getCurrentGatewayAddress();this.emit(La.JOIN_RESPONSE,i,a)}),this.signal.on(dn.PRE_CONNECT_PC,async()=>{if(this.joinInfo){this.updateTurnConfigFromSignal();let i=this.getCurrentGatewayAddress(),a=ge("FINGERPRINT")||this.joinInfo.apResponse.addresses[this.signal.currentURLIndex].fingerprint;if(i&&a){let c=bU(i);this.emit(La.PRE_CONNECT_PC,{candidates:c,fingerprint:a})}}}),this.signal.on(dn.RECOVER_NOTIFICATION,i=>{this.joinInfo&&typeof ge("AP_REQUEST_DETAIL")=="string"&&(this.joinInfo.apRequestDetail="".concat(ge("AP_REQUEST_DETAIL"),";").concat(i))})}async tryUnsubBeforeResub(i,a){try{await this.signal.request(ln.UNSUBSCRIBE,{p2p_id:this.store.p2pId,stream_id:i,ortc:[a]},!0)}catch(c){throw z.warning("[".concat(this.store.clientId,"] tryUnsubBeforeResub warning"),c),c}}async tryUnsubDataChannelBeforeResub(i,a){try{await this.signal.request(ln.UNSUBSCRIBE,{stream_id:a.id},!0)}catch(c){throw z.warning("unsubscribe datachannel warning",c),c}}async tryUnpubBeforeRepub(i,a){try{await this.signal.request(ln.UNPUBLISH,{stream_id:i,ortc:a},!0)}catch(c){throw z.warning("[".concat(this.store.clientId,"] tryUnpubBeforeRepub warning: "),c),c}}async tryUnpubDataChannelBeforeRepub(i,a){try{await this.signal.request(ln.UNPUBLISH_DATASTREAM,{channnel_id:a.channelId},!0)}catch(c){throw z.warning("unpublish datastream warning: ",c),c}}async tryMassUnsubBeforeResub(i){let a={users:i.map(c=>({stream_id:c.stream_id,stream_type:c.stream_type}))};try{await this.signal.request(ln.UNSUBSCRIBE_STREAMS,a,!0)}catch(c){throw z.warning("[".concat(this.store.clientId,"] tryMassUnsubBeforeResub warning"),c),c}}async muteLocal(i,a){let c={action:i.find(u=>u.stream_type===lr.Audio)?"mute_local_audio":"mute_local_video",p2p_id:this.store.p2pId,ortc:i,stream_id:a};try{await this.signal.request(ln.CONTROL,c,!0,!0)}catch(u){throw z.warning("[".concat(this.store.clientId,"] gateway muteLocal warning: "),u),u}}async unmuteLocal(i,a){let c={action:i.find(u=>u.stream_type===lr.Audio)?"unmute_local_audio":"unmute_local_video",p2p_id:this.store.p2pId,ortc:i,stream_id:a};try{await this.signal.request(ln.CONTROL,c,!0,!0)}catch(u){throw z.warning("[".concat(this.store.clientId,"] gateway unmuteLocal warning: "),u),u}}async muteRemote(i,a){let c={action:i===Tt.AUDIO?"mute_remote_audio":"mute_remote_video",p2p_id:this.store.p2pId,stream_id:a};try{await this.signal.request(ln.CONTROL,c,!0,!0)}catch(u){throw z.warning("[".concat(this.store.clientId,"] gateway muteRemote warning: "),u),u}}async unmuteRemote(i,a){let c={action:i===Tt.AUDIO?"unmute_remote_audio":"unmute_remote_video",p2p_id:this.store.p2pId,stream_id:a};try{await this.signal.request(ln.CONTROL,c,!0,!0)}catch(u){throw z.warning("[".concat(this.store.clientId,"] gateway unmuteRemote warning: "),u),u}}uploadWRTCStats(i){this.signal.uploadWRTCStats(i)}upload(i,a){this.signal.upload(i,a)}getSignalRTT(){return this.signal.rtt}async restartICE(i){let a={p2p_id:this.store.p2pId,stream_id:this.store.uid,ortc:i};try{return await this.signal.request(ln.RESTART_ICE,a,!0)}catch(c){throw z.warning("[".concat(this.store.clientId,"] P2PChannel.restartICE warning: "),c),c}}reconnect(i,a){this.state==="CONNECTED"&&this.signal.reconnect(i||void 0,a||Ma.P2P_FAILED)}getCurrentGatewayAddress(){var i,a;if(!ge("GATEWAY_WSS_ADDRESS"))return ge("USE_CANDIDATE_FROM_AP_DETAIL")&&(i=this.joinInfo)!==null&&i!==void 0&&i.apGatewayAddress?(z.debug("[".concat(this.store.clientId,"] use candidate from ap detail, ").concat(JSON.stringify(this.joinInfo.apGatewayAddress))),this.joinInfo.apGatewayAddress):(a=this.joinInfo)!==null&&a!==void 0&&a.gatewayAddrs?this.joinInfo.gatewayAddrs[this.signal.currentURLIndex]:void 0}async setPublishAudioFilterEnabled(i){await this.signal.request(ln.SET_PARAMETER,{enablePublishAudioFilter:i})}}let LI=0,oD=0;function sf(n,i,a,c){return new Et((u,_)=>{i.timeout=i.timeout||ge("HTTP_CONNECT_TIMEOUT"),i.responseType=i.responseType||"json",i.data&&!a?(i.data=JSON.stringify(i.data),LI+=Qd(i.data)):a&&(i.data.size?LI+=i.data.size:i.data instanceof FormData?LI+=yS(i.data):LI+=Qd(JSON.stringify(i.data))),i.headers=i.headers||{},i.headers["Content-Type"]=i.headers["Content-Type"]||"application/json",i.method="POST",i.url=n,eo.request(i).then(S=>{typeof S.data=="string"?oD+=Qd(S.data):S.data instanceof ArrayBuffer||S.data instanceof Uint8Array?oD+=S.data.byteLength:oD+=Qd(JSON.stringify(S.data)),c&&u({data:S.data,headers:S.headers}),u(S.data)}).catch(S=>{eo.isCancel(S)?_(new De(oe.OPERATION_ABORTED,"cancel token canceled")):S.code==="ECONNABORTED"?_(new De(oe.NETWORK_TIMEOUT,S.message)):S.response?_(new De(oe.NETWORK_RESPONSE_ERROR,S.response.status)):_(new De(oe.NETWORK_ERROR,S.message))})})}(function(){var n;function i(ve){var Ne=0;return function(){return Ne<ve.length?{done:!1,value:ve[Ne++]}:{done:!0}}}var a=typeof Object.defineProperties=="function"?Object.defineProperty:function(ve,Ne,Ve){return ve==Array.prototype||ve==Object.prototype||(ve[Ne]=Ve.value),ve},c,u=function(ve){ve=[typeof globalThis=="object"&&globalThis,ve,typeof window=="object"&&window,typeof self=="object"&&self,typeof g=="object"&&g];for(var Ne=0;Ne<ve.length;++Ne){var Ve=ve[Ne];if(Ve&&Ve.Math==Math)return Ve}throw Error("Cannot find global object")}(this);function _(ve,Ne){if(Ne)e:{var Ve=u;ve=ve.split(".");for(var Be=0;Be<ve.length-1;Be++){var W=ve[Be];if(!(W in Ve))break e;Ve=Ve[W]}(Ne=Ne(Be=Ve[ve=ve[ve.length-1]]))!=Be&&Ne!=null&&a(Ve,ve,{configurable:!0,writable:!0,value:Ne})}}function S(ve){return(ve={next:ve})[Symbol.iterator]=function(){return this},ve}function C(ve){var Ne=typeof Symbol<"u"&&Symbol.iterator&&ve[Symbol.iterator];return Ne?Ne.call(ve):{next:i(ve)}}if(_("Symbol",function(ve){function Ne(W,ce){this.A=W,a(this,"description",{configurable:!0,writable:!0,value:ce})}if(ve)return ve;Ne.prototype.toString=function(){return this.A};var Ve="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",Be=0;return function W(ce){if(this instanceof W)throw new TypeError("Symbol is not a constructor");return new Ne(Ve+(ce||"")+"_"+Be++,ce)}}),_("Symbol.iterator",function(ve){if(ve)return ve;ve=Symbol("Symbol.iterator");for(var Ne="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),Ve=0;Ve<Ne.length;Ve++){var Be=u[Ne[Ve]];typeof Be=="function"&&typeof Be.prototype[ve]!="function"&&a(Be.prototype,ve,{configurable:!0,writable:!0,value:function(){return S(i(this))}})}return ve}),typeof Object.setPrototypeOf=="function")c=Object.setPrototypeOf;else{var R;e:{var e={};try{e.__proto__={a:!0},R=e.a;break e}catch{}R=!1}c=R?function(ve,Ne){if(ve.__proto__=Ne,ve.__proto__!==Ne)throw new TypeError(ve+" is not extensible");return ve}:null}var t=c;function r(){this.m=!1,this.j=null,this.v=void 0,this.h=1,this.u=this.C=0,this.l=null}function s(ve){if(ve.m)throw new TypeError("Generator is already running");ve.m=!0}function l(ve,Ne){return ve.h=3,{value:Ne}}function f(ve){this.g=new r,this.G=ve}function m(ve,Ne,Ve,Be){try{var W=Ne.call(ve.g.j,Ve);if(!(W instanceof Object))throw new TypeError("Iterator result "+W+" is not an object");if(!W.done)return ve.g.m=!1,W;var ce=W.value}catch(Se){return ve.g.j=null,ve.g.s(Se),E(ve)}return ve.g.j=null,Be.call(ve.g,ce),E(ve)}function E(ve){for(;ve.g.h;)try{var Ne=ve.G(ve.g);if(Ne)return ve.g.m=!1,{value:Ne.value,done:!1}}catch(Ve){ve.g.v=void 0,ve.g.s(Ve)}if(ve.g.m=!1,ve.g.l){if(Ne=ve.g.l,ve.g.l=null,Ne.F)throw Ne.D;return{value:Ne.return,done:!0}}return{value:void 0,done:!0}}function y(ve){this.next=function(Ne){return ve.o(Ne)},this.throw=function(Ne){return ve.s(Ne)},this.return=function(Ne){return function(Ve,Be){s(Ve.g);var W=Ve.g.j;return W?m(Ve,"return"in W?W.return:function(ce){return{value:ce,done:!0}},Be,Ve.g.return):(Ve.g.return(Be),E(Ve))}(ve,Ne)},this[Symbol.iterator]=function(){return this}}function b(ve,Ne){return Ne=new y(new f(Ne)),t&&ve.prototype&&t(Ne,ve.prototype),Ne}if(r.prototype.o=function(ve){this.v=ve},r.prototype.s=function(ve){this.l={D:ve,F:!0},this.h=this.C||this.u},r.prototype.return=function(ve){this.l={return:ve},this.h=this.u},f.prototype.o=function(ve){return s(this.g),this.g.j?m(this,this.g.j.next,ve,this.g.o):(this.g.o(ve),E(this))},f.prototype.s=function(ve){return s(this.g),this.g.j?m(this,this.g.j.throw,ve,this.g.o):(this.g.s(ve),E(this))},_("Array.prototype.entries",function(ve){return ve||function(){return function(Ne,Ve){Ne instanceof String&&(Ne+="");var Be=0,W=!1,ce={next:function(){if(!W&&Be<Ne.length){var Se=Be++;return{value:Ve(Se,Ne[Se]),done:!1}}return W=!0,{done:!0,value:void 0}}};return ce[Symbol.iterator]=function(){return ce},ce}(this,function(Ne,Ve){return[Ne,Ve]})}}),typeof Blob<"u"&&(typeof FormData>"u"||!FormData.prototype.keys)){var A=function(ve,Ne){for(var Ve=0;Ve<ve.length;Ve++)Ne(ve[Ve])},O=function(ve){return ve.replace(/\r?\n|\r/g,`\r
`)},D=function(ve,Ne,Ve){return Ne instanceof Blob?(Ve=Ve!==void 0?Ve+"":typeof Ne.name=="string"?Ne.name:"blob",Ne.name===Ve&&Object.prototype.toString.call(Ne)!=="[object Blob]"||(Ne=new File([Ne],Ve)),[String(ve),Ne]):[String(ve),String(Ne)]},P=function(ve,Ne){if(ve.length<Ne)throw new TypeError(Ne+" argument required, but only "+ve.length+" present.")},F=typeof globalThis=="object"?globalThis:typeof window=="object"?window:typeof self=="object"?self:this,B=F.FormData,Y=F.XMLHttpRequest&&F.XMLHttpRequest.prototype.send,$=F.Request&&F.fetch,ee=F.navigator&&F.navigator.sendBeacon,Ee=F.Element&&F.Element.prototype,Re=F.Symbol&&Symbol.toStringTag;Re&&(Blob.prototype[Re]||(Blob.prototype[Re]="Blob"),"File"in F&&!File.prototype[Re]&&(File.prototype[Re]="File"));try{new File([],"")}catch{F.File=function(ve,Ne,Ve){return ve=new Blob(ve,Ve||{}),Object.defineProperties(ve,{name:{value:Ne},lastModified:{value:+(Ve&&Ve.lastModified!==void 0?new Date(Ve.lastModified):new Date)},toString:{value:function(){return"[object File]"}}}),Re&&Object.defineProperty(ve,Re,{value:"File"}),ve}}var Ie=function(ve){return ve.replace(/\n/g,"%0A").replace(/\r/g,"%0D").replace(/"/g,"%22")},we=function(ve){this.i=[];var Ne=this;ve&&A(ve.elements,function(Ve){if(Ve.name&&!Ve.disabled&&Ve.type!=="submit"&&Ve.type!=="button"&&!Ve.matches("form fieldset[disabled] *"))if(Ve.type==="file"){var Be=Ve.files&&Ve.files.length?Ve.files:[new File([],"",{type:"application/octet-stream"})];A(Be,function(W){Ne.append(Ve.name,W)})}else Ve.type==="select-multiple"||Ve.type==="select-one"?A(Ve.options,function(W){!W.disabled&&W.selected&&Ne.append(Ve.name,W.value)}):Ve.type==="checkbox"||Ve.type==="radio"?Ve.checked&&Ne.append(Ve.name,Ve.value):(Be=Ve.type==="textarea"?O(Ve.value):Ve.value,Ne.append(Ve.name,Be))})};if((n=we.prototype).append=function(ve,Ne,Ve){P(arguments,2),this.i.push(D(ve,Ne,Ve))},n.delete=function(ve){P(arguments,1);var Ne=[];ve=String(ve),A(this.i,function(Ve){Ve[0]!==ve&&Ne.push(Ve)}),this.i=Ne},n.entries=function ve(){var Ne,Ve=this;return b(ve,function(Be){if(Be.h==1&&(Ne=0),Be.h!=3)return Ne<Ve.i.length?Be=l(Be,Ve.i[Ne]):(Be.h=0,Be=void 0),Be;Ne++,Be.h=2})},n.forEach=function(ve,Ne){P(arguments,1);for(var Ve=C(this),Be=Ve.next();!Be.done;Be=Ve.next()){var W=C(Be.value);Be=W.next().value,W=W.next().value,ve.call(Ne,W,Be,this)}},n.get=function(ve){P(arguments,1);var Ne=this.i;ve=String(ve);for(var Ve=0;Ve<Ne.length;Ve++)if(Ne[Ve][0]===ve)return Ne[Ve][1];return null},n.getAll=function(ve){P(arguments,1);var Ne=[];return ve=String(ve),A(this.i,function(Ve){Ve[0]===ve&&Ne.push(Ve[1])}),Ne},n.has=function(ve){P(arguments,1),ve=String(ve);for(var Ne=0;Ne<this.i.length;Ne++)if(this.i[Ne][0]===ve)return!0;return!1},n.keys=function ve(){var Ne,Ve,Be,W,ce=this;return b(ve,function(Se){if(Se.h==1&&(Ne=C(ce),Ve=Ne.next()),Se.h!=3)return Ve.done?void(Se.h=0):(Be=Ve.value,W=C(Be),l(Se,W.next().value));Ve=Ne.next(),Se.h=2})},n.set=function(ve,Ne,Ve){P(arguments,2),ve=String(ve);var Be=[],W=D(ve,Ne,Ve),ce=!0;A(this.i,function(Se){Se[0]===ve?ce&&(ce=!Be.push(W)):Be.push(Se)}),ce&&Be.push(W),this.i=Be},n.values=function ve(){var Ne,Ve,Be,W,ce=this;return b(ve,function(Se){if(Se.h==1&&(Ne=C(ce),Ve=Ne.next()),Se.h!=3)return Ve.done?void(Se.h=0):(Be=Ve.value,(W=C(Be)).next(),l(Se,W.next().value));Ve=Ne.next(),Se.h=2})},we.prototype._asNative=function(){for(var ve=new B,Ne=C(this),Ve=Ne.next();!Ve.done;Ve=Ne.next()){var Be=C(Ve.value);Ve=Be.next().value,Be=Be.next().value,ve.append(Ve,Be)}return ve},we.prototype._blob=function(){var ve="----formdata-polyfill-"+Math.random(),Ne=[],Ve="--"+ve+`\r
Content-Disposition: form-data; name="`;return this.forEach(function(Be,W){return typeof Be=="string"?Ne.push(Ve+Ie(O(W))+`"\r
\r
`+O(Be)+`\r
`):Ne.push(Ve+Ie(O(W))+'"; filename="'+Ie(Be.name)+`"\r
Content-Type: `+(Be.type||"application/octet-stream")+`\r
\r
`,Be,`\r
`)}),Ne.push("--"+ve+"--"),new Blob(Ne,{type:"multipart/form-data; boundary="+ve})},we.prototype[Symbol.iterator]=function(){return this.entries()},we.prototype.toString=function(){return"[object FormData]"},Ee&&!Ee.matches&&(Ee.matches=Ee.matchesSelector||Ee.mozMatchesSelector||Ee.msMatchesSelector||Ee.oMatchesSelector||Ee.webkitMatchesSelector||function(ve){for(var Ne=(ve=(this.document||this.ownerDocument).querySelectorAll(ve)).length;0<=--Ne&&ve.item(Ne)!==this;);return-1<Ne}),Re&&(we.prototype[Re]="FormData"),Y){var Ue=F.XMLHttpRequest.prototype.setRequestHeader;F.XMLHttpRequest.prototype.setRequestHeader=function(ve,Ne){Ue.call(this,ve,Ne),ve.toLowerCase()==="content-type"&&(this.B=!0)},F.XMLHttpRequest.prototype.send=function(ve){ve instanceof we?(ve=ve._blob(),this.B||this.setRequestHeader("Content-Type",ve.type),Y.call(this,ve)):Y.call(this,ve)}}$&&(F.fetch=function(ve,Ne){return Ne&&Ne.body&&Ne.body instanceof we&&(Ne.body=Ne.body._blob()),$.call(this,ve,Ne)}),ee&&(F.navigator.sendBeacon=function(ve,Ne){return Ne instanceof we&&(Ne=Ne._asNative()),ee.call(this,ve,Ne)}),F.FormData=we}})();let m1=()=>{let n=ge("AREAS");return n.length===0&&n.push(rr.GLOBAL),Ds(n).call(n,(i,a,c)=>{let u=Yc(a);return u?c===0?u:"".concat(i,",").concat(u):i},"")},Yc=n=>n===rr.OVERSEA?"".concat(zs.ASIA,",").concat(zs.EUROPE,",").concat(zs.AFRICA,",").concat(zs.NORTH_AMERICA,",").concat(zs.SOUTH_AMERICA,",").concat(zs.OCEANIA):zs[n],NY=n=>{let i={CODE:"",WEBCS_DOMAIN:[],WEBCS_DOMAIN_BACKUP_LIST:[],PROXY_CS:[],CDS_AP:[],ACCOUNT_REGISTER:[],UAP_AP:[],EVENT_REPORT_DOMAIN:[],EVENT_REPORT_BACKUP_DOMAIN:[],LOG_UPLOAD_SERVER:[],PROXY_SERVER_TYPE3:[]};return n.map(a=>{let c=yh[a],u=Object.keys(c);u&&u.map(_=>{_!=="CODE"&&(i[_]=i[_].concat(c[_]))})}),i},DI={GLOBAL:{ASIA:[rr.CHINA,rr.JAPAN,rr.INDIA,rr.KOREA,rr.HKMC],EUROPE:[],NORTH_AMERICA:[rr.US],SOUTH_AMERICA:[],OCEANIA:[],AFRICA:[]}},Ch=Object.keys(DI[rr.GLOBAL]),wh=[rr.CHINA,rr.NORTH_AMERICA,rr.EUROPE,rr.ASIA,rr.JAPAN,rr.INDIA,rr.OCEANIA,rr.SOUTH_AMERICA,rr.AFRICA,rr.KOREA,rr.HKMC,rr.US],q8=function(n,i){let a=[];if(ft(n).call(n,rr.GLOBAL)){let _=[rr.GLOBAL,rr.OVERSEA],S=Object.keys(yh);if(i===rr.GLOBAL)throw new De(oe.INVALID_PARAMS,"GLOBAL is an invalid excludedArea value");if(i===rr.CHINA)a=[rr.OVERSEA];else if(u=i,ft(Ch).call(Ch,u)){let C=(c=i,DI[rr.GLOBAL][c]||[]),R=[..._,i,...C];a=S.filter(e=>!ft(R).call(R,e))}else if(function(C){let R=!1;return Ch.forEach(e=>{var t;ft(t=DI[rr.GLOBAL][e]).call(t,C)&&(R=!0)}),R}(i)){let C=function(e){let t;return Ch.forEach(r=>{var s;ft(s=DI[rr.GLOBAL][r]).call(s,e)&&(t=r)}),t}(i),R=[..._,C,i];a=S.filter(e=>!ft(R).call(R,e))}else a=n;a=function(C){let R=[];return wh.forEach(e=>{ft(C).call(C,e)&&R.push(e)}),R.concat(C.filter(e=>!ft(wh).call(wh,e)))}(a)}else a=n;var c,u;return a};function PI(n){var i,a;if(!n&&ft(i=ge("AREAS")).call(i,rr.EXTENSIONS))return z.debug("update area from ap : reset"),void cD(a1,!0);if(!ft(a=ge("AREAS")).call(a,rr.GLOBAL)||!n)return;let c=yh.EXTENSIONS;c&&(c={CODE:Yc(rr.EXTENSIONS),WEBCS_DOMAIN:["ap-web-1-".concat(n,".agora.io")],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-".concat(n,".ap.sd-rtn.com")],PROXY_CS:["proxy-ap-web-".concat(n,".agora.io")],CDS_AP:["cds-ap-web-1-".concat(n,".agora.io"),"cds-ap-web-2-".concat(n,".ap.sd-rtn.com")],ACCOUNT_REGISTER:["sua-ap-web-1-".concat(n,".agora.io"),"sua-ap-web-2-".concat(n,".ap.sd-rtn.com")],UAP_AP:["uap-ap-web-1-".concat(n,".agora.io"),"uap-ap-web-2-".concat(n,".ap.sd-rtn.com")],EVENT_REPORT_DOMAIN:["statscollector-1-".concat(n,".agora.io")],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-".concat(n,".agora.io")],LOG_UPLOAD_SERVER:["logservice-".concat(n,".agora.io")],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy-".concat(n,".agora.io")]},z.debug("update area from ap success: ".concat(n,",config is "),c),Sr("AREAS",[rr.EXTENSIONS],!0),Object.keys(c).map(u=>{u==="LOG_UPLOAD_SERVER"||u==="EVENT_REPORT_DOMAIN"||u==="EVENT_REPORT_BACKUP_DOMAIN"||u==="PROXY_SERVER_TYPE3"?Sr(u,c[u][0]):Sr(u,c[u])}))}function cD(n){let i=arguments.length>1&&arguments[1]!==void 0&&arguments[1],a=jt.reportApiInvoke(null,{name:bn.SET_AREA,options:n,tag:Li.TRACER});try{let c=[];if(typeof n=="string"&&(c=[n]),Array.isArray(n)&&(n.forEach(_=>{if(!ft(ZL).call(ZL,_))throw new De(oe.INVALID_PARAMS,"invalid area code")}),c=n),Object.prototype.toString.call(n)==="[object Object]"){let{areaCode:_,excludedArea:S}=n;if(!_)throw new De(oe.INVALID_PARAMS,"area code is needed");let C=_;typeof _=="string"&&(C=[_]),c=S?q8(C,S):C}if(!i){if(hs.AREAS){let _=new De(oe.PROHIBITED_OPERATION,"setArea is prohibited because of config-distribute");return a.onError(_),void z.warning("setArea is prohibited because of config-distribute")}if(ft(c).call(c,rr.GLOBAL)&&ge("AREAS")===rr.EXTENSIONS){let _=new De(oe.PROHIBITED_OPERATION,"setArea is prohibited because of ap extensions");return a.onError(_),void z.warning("setArea is prohibited because of ap extensions")}}Sr("AREAS",c,i);let u=NY(c);Object.keys(u).map(_=>{_==="LOG_UPLOAD_SERVER"||_==="EVENT_REPORT_DOMAIN"||_==="EVENT_REPORT_BACKUP_DOMAIN"||_==="PROXY_SERVER_TYPE3"?Sr(_,u[_][0]):Sr(_,u[_])}),z.debug("set area success:",c.join(","))}catch(c){throw a.onError(c),c}a.onSuccess()}function Rh(n,i){var a=Object.keys(n);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(n);i&&(c=c.filter(function(u){return Object.getOwnPropertyDescriptor(n,u).enumerable})),a.push.apply(a,c)}return a}function of(n){for(var i=1;i<arguments.length;i++){var a=arguments[i]!=null?arguments[i]:{};i%2?Rh(Object(a),!0).forEach(function(c){re(n,c,a[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(a)):Rh(Object(a)).forEach(function(c){Object.defineProperty(n,c,Object.getOwnPropertyDescriptor(a,c))})}return n}let AU=1;function lD(n,i,a,c,u){AU+=1;let _={sid:a.sid,command:"convergeAllocateEdge",uid:"666",appId:a.appId,ts:Math.floor(Date.now()/1e3),seq:AU,requestId:AU,version:Zd,cname:a.cname},S={service_name:i,json_body:JSON.stringify(_)},C,R,e=n[0];return Xu(async()=>{C=Date.now();let t=await sf(e,{data:S,cancelToken:c,headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"61"}});if(R=Date.now()-C,t.code!==0){let l=new De(oe.UNEXPECTED_RESPONSE,"live streaming ap error, code"+t.code,{retry:!0,responseTime:R});throw z.error(l.toString()),l}let r=JSON.parse(t.json_body);if(r.code!==200){let l=new De(oe.UNEXPECTED_RESPONSE,"live streaming app center error, code: ".concat(r.code,", reason: ").concat(r.reason),{code:r.code,responseTime:R});throw z.error(l.toString()),l}if(!r.servers||r.servers.length===0){let l=new De(oe.UNEXPECTED_RESPONSE,"live streaming app center empty server",{code:r.code,responseTime:R});throw z.error(l.toString()),l}let s=function(l,f){return{addressList:l.servers.map(m=>"wss://".concat(m.address.replace(/\./g,"-"),".").concat(ge("WORKER_DOMAIN"),":").concat(m.wss,"?serviceName=").concat(encodeURIComponent(f))),workerToken:l.workerToken,vid:l.vid}}(r,i);return ge("LIVE_STREAMING_ADDRESS")&&(s.addressList=ge("LIVE_STREAMING_ADDRESS")instanceof Array?ge("LIVE_STREAMING_ADDRESS"):[ge("LIVE_STREAMING_ADDRESS")]),of(of({},s),{},{responseTime:R})},(t,r)=>(jt.apworkerEvent(a.sid,{success:!0,sc:200,serviceName:i,responseDetail:JSON.stringify(t.addressList),firstSuccess:r===0,responseTime:R,serverIp:n[r%n.length]}),!1),(t,r)=>(jt.apworkerEvent(a.sid,{success:!1,sc:t.data&&t.data.code||200,serviceName:i,responseTime:R,serverIp:n[r%n.length]}),!!(t.code!==oe.OPERATION_ABORTED&&t.code!==oe.UNEXPECTED_RESPONSE||t.data&&t.data.retry)&&(e=n[(r+1)%n.length],!0)),u)}let MI=1;function cf(n,i,a,c){let{url:u,areaCode:_}=n,{clientId:S,sid:C}=i,R=Date.now(),e,t=i.role,[r,s]=_1(i,_,[aa.CHOOSE_SERVER]),l=ki.networkState;return Xu(async()=>{l&&ki.networkState===Uc.OFFLINE&&ki.onlineWaiter&&await Et.race([ki.onlineWaiter,Mn(c&&c.maxRetryTimeout||da.maxRetryTimeout)]),l=ki.networkState;let{data:f,headers:m}=await sf(u,{data:r,cancelToken:a,headers:{"Content-Type":"multipart/form-data;"}},!0,!0);e=m.http3==="1"?1:-1,jt.reportResourceTiming(u,C),OU(f,u,i,R,[aa.CHOOSE_SERVER],e);let E=II(f,aa.CHOOSE_SERVER);return NU(E),vU(E,u)},f=>(f&&jt.joinChooseServer(C,{role:t,lts:R,succ:!0,csAddr:u,opid:s,serverList:f.gatewayAddrs.map(m=>m.address),ec:null,cid:f.cid.toString(),uid:f.uid.toString(),csIp:f.csIp,unilbsServerIds:[aa.CHOOSE_SERVER].toString(),isHttp3:e,corssRegionTagReq:i.apRequestDetail,corssRegionTagRes:f.res.detail&&f.res.detail[38]}),!1),f=>f.code!==oe.OPERATION_ABORTED&&(f.code===oe.CAN_NOT_GET_GATEWAY_SERVER?f.data.retry:(jt.joinChooseServer(C,{role:t,lts:R,succ:!1,csAddr:u,serverList:null,opid:s,ec:f.code,csIp:f.data&&f.data.csIp,unilbsServerIds:[aa.CHOOSE_SERVER].toString(),extend:JSON.stringify({networkState:l}),isHttp3:e,corssRegionTagReq:i.apRequestDetail}),z.warning("[".concat(S||"sid-".concat(C.slice(0,6)),"] Choose server network error, retry"),f),!0)),c)}function g1(n,i,a,c){let u,{url:_,areaCode:S,serviceIds:C}=n,R=Date.now(),e=i.role,[t,r]=_1(i,S,C),s;return Xu(async()=>{s&&ki.networkState===Uc.OFFLINE&&ki.onlineWaiter&&await Et.race([ki.onlineWaiter,Mn(c&&c.maxRetryTimeout||da.maxRetryTimeout)]),s=ki.networkState;let{data:l,headers:f}=await sf(_,{data:t,cancelToken:a,headers:{"Content-Type":"multipart/form-data;"}},!0,!0);u=f.http3==="1"?1:-1,jt.reportResourceTiming(_,i.sid),OU(l,_,i,R,C,u);let m=II(l,aa.CHOOSE_SERVER),E=II(l,i.cloudProxyServer==="proxy5"?aa.CLOUD_PROXY_5:i.cloudProxyServer==="proxy3"||i.cloudProxyServer==="proxy4"?aa.CLOUD_PROXY:aa.CLOUD_PROXY_FALLBACK);return NU(m),{gatewayInfo:vU(m,_),proxyInfo:E,url:_}},l=>(l.gatewayInfo&&jt.joinChooseServer(i.sid,{role:e,lts:R,succ:!0,csAddr:_,serverList:l.gatewayInfo.gatewayAddrs.map(f=>f.address),ec:null,opid:r,cid:l.gatewayInfo.cid.toString(),uid:l.gatewayInfo.uid.toString(),csIp:l.gatewayInfo.csIp,unilbsServerIds:C.toString(),isHttp3:u,corssRegionTagReq:i.apRequestDetail,corssRegionTagRes:l.gatewayInfo.res.detail&&l.gatewayInfo.res.detail[38]}),l.proxyInfo&&jt.joinWebProxyAP(i.sid,{lts:R,sucess:1,apServerAddr:_,turnServerAddrList:l.proxyInfo.addresses.map(f=>f.ip).join(","),errorCode:null,eventType:i.cloudProxyServer,unilbsServerIds:C.toString()}),!1),l=>l.code!==oe.OPERATION_ABORTED&&(l.code===oe.CAN_NOT_GET_GATEWAY_SERVER?l.data.retry:(jt.joinWebProxyAP(i.sid,{lts:R,sucess:0,apServerAddr:_,turnServerAddrList:null,errorCode:l.code,eventType:i.cloudProxyServer,unilbsServerIds:C.toString(),extend:JSON.stringify({networkState:s})}),z.warning("[".concat(i.clientId,"] multi unilbs network error, retry"),l),!0)),c)}let OU=(n,i,a,c,u,_)=>{let{sid:S,clientId:C,cloudProxyServer:R}=a,e=[],t=r=>{r.flag===4096?jt.joinChooseServer(S,{role:a.role,lts:c,succ:!1,csAddr:i,opid:n.opid,serverList:null,ec:r.error.message,csIp:r.error.data&&r.error.data.csIp,unilbsServerIds:u.toString(),isHttp3:_,corssRegionTagReq:a.apRequestDetail}):r.flag!==1048576&&r.flag!==4194304&&r.flag!==4194310||jt.joinWebProxyAP(S,{lts:c,sucess:0,apServerAddr:i,turnServerAddrList:null,errorCode:r.error.code,eventType:R,unilbsServerIds:u.toString()})};if(n.response_body.forEach(r=>{let s=r.buffer.code;if(r.uri===23&&s===0&&!r.buffer.edges_services)if(r.buffer.flag===4194310)z.warning("no edge services in ap response of proxy fallback, will not set proxy in iceServers"),r.buffer.edges_services=[];else{let l={error:new De(oe.CAN_NOT_GET_GATEWAY_SERVER,"no edge services in ap response",{retry:!0,csIp:n.detail[502]}),flag:r.buffer.flag};e.push(l),t(l)}if(s!==0){let l=Qn(s),f={error:new De(oe.CAN_NOT_GET_GATEWAY_SERVER,l.desc,{desc:l.desc,retry:l.retry,csIp:n.detail[502]}),flag:r.buffer.flag};r.buffer.flag===4194310?z.warning(f.error.toString()):e.push(f),t(f)}}),e.length)throw z.warning("[".concat(C||"sid-".concat(S.slice(0,6)),"] multi unilbs ").concat(i," failed, ").concat(e.map(r=>"flag: ".concat(r.flag,", message: ").concat(r.error.message,", retry: ").concat(r.error.data.retry)).join(" | "))),new De(oe.CAN_NOT_GET_GATEWAY_SERVER,e.map(r=>"flag: ".concat(r.flag,", message: ").concat(r.error.message)).join(" | "),{retry:!!e.find(r=>r.error.data.retry),csIp:n.detail[502],desc:[...new Set(e.map(r=>{var s;return r==null||(s=r.error)===null||s===void 0||(s=s.data)===null||s===void 0?void 0:s.desc}).filter(r=>!!r))]})},NU=n=>{var i,a,c,u;if(n.addresses&&n.addresses.length===0&&n.code===0)throw new De(oe.CAN_NOT_GET_GATEWAY_SERVER,"void gateway address",{retry:!0,csIp:n.detail&&n.detail[502]});if(ge("AP_AREA")&&((c=n.detail)!==null&&c!==void 0&&c[23]&&typeof((u=n.detail)===null||u===void 0?void 0:u[23])=="string"?PI(n.detail[23].toLowerCase()):PI()),(i=n.detail)!==null&&i!==void 0&&i[19]&&typeof((a=n.detail)===null||a===void 0?void 0:a[19])=="string"){let S=n.detail[19],C=S==null?void 0:S.split(";");for(let R=0;R<C.length;R++){var _;let e=js(_=C[R]).call(_);n.addresses[R]&&C&&(n.addresses[R].fingerprint=e)}}if(ge("GATEWAY_ADDRESS")&&ge("GATEWAY_ADDRESS").length>0){z.debug("assign gateway address to",ge("GATEWAY_ADDRESS"));let S=ge("GATEWAY_ADDRESS").map(C=>{var R,e;let t=(R=(e=n.addresses.find(r=>r.ip===C.ip&&r.port===C.port))===null||e===void 0?void 0:e.fingerprint)!==null&&R!==void 0?R:"";return{ip:C.ip,port:C.port,ticket:n.addresses[0]&&n.addresses[0].ticket,fingerprint:t}});n.addresses=S}},dD=(n,i)=>{if(n.response_body&&n.response_body.length){let a=n.response_body[0];if(a.buffer.code!==0){let c=Qn(a.buffer.code);throw new De(oe.UPDATE_TICKET_FAILED,"[".concat(a.buffer.code,"]: ").concat(c.desc),{retry:c.retry})}return a.buffer.ticket}throw z.debug("update ticket request received ap response without response body:",i),new De(oe.UPDATE_TICKET_FAILED,"cannot find response body from ap response",{retry:!1})},_1=(n,i,a)=>{let c=Math.floor(Math.random()*1e12),u=n.role==="host"?"1":n.role==="audience"?"2":void 0,_={appid:n.appId,client_ts:Date.now(),opid:c,sid:n.sid,request_bodies:[{uri:22,buffer:{cname:n.cname,detail:of(of(of({6:n.stringUid,11:i,12:ge("USE_NEW_TOKEN")?"1":void 0},u?{17:u}:{}),{},{22:i},n.apRequestDetail?{33:n.apRequestDetail}:{}),n.apRTM?{26:"RTM2"}:{}),key:n.token,service_ids:a,uid:n.uid||0}}]};_.request_bodies.forEach(C=>{n.multiIP&&n.multiIP.gateway_ip&&(C.buffer.detail[5]=JSON.stringify({vocs_ip:[n.multiIP.uni_lbs_ip],vos_ip:[n.multiIP.gateway_ip]}))});let S=new FormData;return S.append("request",JSON.stringify(_)),[S,c]},LU=(n,i)=>{let a=Math.floor(Math.random()*1e12),c={appid:n.appId,client_ts:Date.now(),opid:a,sid:n.sid,request_bodies:[{uri:28,buffer:{cname:n.cname,detail:{1:"",6:n.stringUid,12:"1"},token:n.token,service_ids:i,uid:n.uid||0,edges_services:n.apResponse.addresses.map(_=>({ip:_.ip,port:_.port}))}}]},u=new FormData;return u.append("request",JSON.stringify(c)),[u,a]},E1=0;function jS(n){return Et.all(n.map(i=>i.then(a=>{throw a},a=>a))).then(i=>{throw i},i=>i)}let VS=async n=>{let{fragementLength:i,referenceList:a,asyncMapHandler:c,allFailedhandler:u,promisesCollector:_}=n,S=0,C=i,R,e=0,t=async()=>{let r=(()=>{let s=S*C,l=s+C;return a.slice(s,l).map(c)})();_&&_.push(...r);try{R=await jS(r)}catch(s){if(e+=C,S++,!(e>=a.length))return void await t();u(s)}r.forEach(s=>s.cancel())};return await t(),R},DU=async n=>{let{referenceList:i,asyncMapHandler:a,closeFn:c}=n,u=i.length,_=0,S=async()=>{let C=a(i.shift());try{return await C}catch(R){if(_++,_>=u||c!=null&&c(R))throw R;return S()}};return S()};async function lf(n,i,a,c){return{gatewayInfo:await async function(u,_,S,C){let R=null,e=[],t=async()=>{let s=ge("WEBCS_DOMAIN").slice(0,ge("AJAX_REQUEST_CONCURRENT")).map(m=>({url:u.proxyServer?"https://".concat(u.proxyServer,"/ap/?url=").concat(m+"/api/v2/transpond/webrtc?v=2"):"https://".concat(m,"/api/v2/transpond/webrtc?v=2"),areaCode:m1()})),l=C.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:s.map(m=>m.url)}),f=await VS({fragementLength:ge("FRAGEMENT_LENGTH"),referenceList:s,asyncMapHandler:m=>(z.debug("[".concat(u.clientId,"] Connect to choose_server:"),m.url),cf(m,u,_,S)),allFailedhandler:m=>{throw C.recordJoinChannelService({endTs:Date.now(),status:"error",errors:m},l),m[0]},promisesCollector:e});return C.recordJoinChannelService({endTs:Date.now(),status:"success"},l),f},r=async()=>{if(await Mn(1e3),R!==null)return R;let s=ge("WEBCS_DOMAIN_BACKUP_LIST").map(m=>({url:u.proxyServer?"https://".concat(u.proxyServer,"/ap/?url=").concat(m+"/api/v2/transpond/webrtc?v=2"):"https://".concat(m,"/api/v2/transpond/webrtc?v=2"),areaCode:m1()})),l=C.recordJoinChannelService({endTs:void 0,startTs:Date.now(),status:"pending",service:"chooseServer",urls:s.map(m=>m.url)}),f=await VS({fragementLength:ge("FRAGEMENT_LENGTH"),referenceList:s,asyncMapHandler:m=>(z.debug("[".concat(u.clientId,"] Connect to backup choose_server:"),m.url),cf(m,u,_,S)),allFailedhandler:m=>{throw C.recordJoinChannelService({endTs:Date.now(),status:"error",errors:m},l),m[0]},promisesCollector:e});return C.recordJoinChannelService({endTs:Date.now(),status:"success"},l),f};try{return R=await jS([t(),r()]),e.length&&e.forEach(s=>s.cancel&&typeof s.cancel=="function"&&s.cancel()),R}catch(s){throw s[0]}}(n,i,a,c)}}async function uD(n,i,a,c,u){let _=n.cloudProxyServer;if(_==="disabled"){if(n.useLocalAccessPoint)return await lf(n,i,a,u);if(ge("JOIN_WITH_FALLBACK_MEDIA_PROXY")){let{gatewayInfo:s,proxyInfo:l}=await kU(n,i,a,u);if(n.turnServer&&n.turnServer.mode!=="auto")return{gatewayInfo:s};let f=l.map(m=>({turnServerURL:m.address,tcpport:m.tcpport||rs.tcpport,udpport:m.udpport||rs.udpport,username:m.username||rs.username,password:m.password||rs.password,forceturn:!1,security:!0}));if(u.useP2P){var S;let m=(S=n.uid)!==null&&S!==void 0?S:s.uid,E="glb:".concat(m.toString()),y=await wr(E),b=l.map(A=>({turnServerURL:A.address,tcpport:A.tcpport||rs.tcpport,udpport:A.udpport||rs.udpport,username:E,password:y,forceturn:!1,security:!0}));f.push(...b)}return n.turnServer={mode:"manual",servers:f},{gatewayInfo:s}}return await lf(n,i,a,u)}let{proxyInfo:C,gatewayInfo:R}=await kU(n,i,a,u),e={gatewayInfo:R},t=C.map(s=>({turnServerURL:s.address,tcpport:_==="proxy3"?void 0:s.tcpport?s.tcpport:rs.tcpport,udpport:_==="proxy4"?void 0:s.udpport?s.udpport:rs.udpport,username:s.username||rs.username,password:s.password||rs.password,forceturn:_!=="proxy4",security:_==="proxy5"}));if(u.useP2P){var r;let s=(r=n.uid)!==null&&r!==void 0?r:R.uid,l="glb:".concat(s.toString()),f=await wr(l),m=C.map(E=>({turnServerURL:E.address,tcpport:_==="proxy3"?void 0:E.tcpport||rs.tcpport,udpport:_==="proxy4"?void 0:E.udpport||rs.udpport,username:l,password:f,forceturn:_!=="proxy4",security:_==="proxy5"}));t.push(...m)}return n.turnServer={mode:"manual",servers:t},z.debug("[".concat(n.clientId,"] set proxy server: ").concat(n.proxyServer,", mode: ").concat(_)),e}async function J8(n,i,a,c,u){let _=ge("ACCOUNT_REGISTER").slice(0,ge("AJAX_REQUEST_CONCURRENT")),S=[];S=i.proxyServer?_.map(R=>"https://".concat(i.proxyServer,"/ap/?url=").concat(R+"/api/v1")):_.map(R=>"https://".concat(R,"/api/v1"));let C=u==null?void 0:u.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"stringUID",urls:S});try{let R=await async function(e,t,r,s,l){let f=Date.now(),m={sid:r.sid,opid:10,appid:r.appId,string_uid:t},E=e[0],y=await Xu(()=>sf(E+"".concat(E.indexOf("?")===-1?"?":"&","action=stringuid"),{data:m,cancelToken:s,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":72}}),(b,A)=>{if(b.code===0){if(b.uid<=0||b.uid>=Math.pow(2,32))throw z.error("Invalid Uint Uid ".concat(t," => ").concat(b.uid),b),jt.reqUserAccount(m.sid,{lts:f,success:!1,serverAddr:E,stringUid:m.string_uid,uid:b.uid,errorCode:oe.INVALID_UINT_UID_FROM_STRING_UID,extend:m}),new De(oe.INVALID_UINT_UID_FROM_STRING_UID);return jt.reqUserAccount(m.sid,{lts:f,success:!0,serverAddr:E,stringUid:m.string_uid,uid:b.uid,errorCode:null,extend:m}),!1}let O=Qn(b.code);return O.retry&&(E=e[(A+1)%e.length]),jt.reqUserAccount(m.sid,{lts:f,success:!1,serverAddr:E,stringUid:m.string_uid,uid:b.uid,errorCode:O.desc,extend:m}),O.retry},(b,A)=>b.code!==oe.OPERATION_ABORTED&&(jt.reqUserAccount(m.sid,{lts:f,success:!1,serverAddr:E,stringUid:m.string_uid,uid:null,errorCode:b.code,extend:m}),E=e[(A+1)%e.length],!0),l);if(y.code!==0){let b=Qn(y.code);throw new De(oe.UNEXPECTED_RESPONSE,b.desc)}return y}(S,n,i,a,c);return u==null||u.recordJoinChannelService({status:"success",endTs:Date.now()},C),R.uid}catch(R){throw u==null||u.recordJoinChannelService({status:"error",endTs:Date.now(),errors:[R]},C),R}}async function PU(n,i,a){let c=ge("ACCOUNT_REGISTER"),u=[];u=i.proxyServer?c.map(_=>"https://".concat(i.proxyServer,"/ap/?url=").concat(_+"/api/v1")):c.map(_=>"https://".concat(_,"/api/v1"));try{return await DU({referenceList:u,asyncMapHandler:_=>async function(S,C,R,e){let t=Date.now(),r={sid:R.sid,opid:10,appid:R.appId,string_uid:C};try{let s=await sf(S+"".concat(S.indexOf("?")===-1?"?":"&","action=stringuid"),{data:r,cancelToken:e,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":72}});if(s.code!==0){let l=Qn(s.code);throw new De(oe.UNEXPECTED_RESPONSE,"preload sua error:".concat(l.desc),l)}if(s.uid<=0||s.uid>=Math.pow(2,32))throw new De(oe.INVALID_UINT_UID_FROM_STRING_UID);return{requestTime:t,url:S,req:r,uid:s.uid,elapse:Date.now()-t}}catch(s){throw s}}(_,n,i,a),closeFn:_=>_.code===oe.OPERATION_ABORTED||_.code===oe.UNEXPECTED_RESPONSE&&!_.data.retry})}catch(_){throw _}}async function X8(n,i,a){let c=ge("CDS_AP").slice(0,ge("AJAX_REQUEST_CONCURRENT")).map(R=>n.proxyServer?"https://".concat(n.proxyServer,"/ap/?url=").concat(R+"/api/v1"):"https://".concat(R,"/api/v1?action=config")),u=c.map(R=>function(e,t,r,s){let l=En(),f={flag:64,cipher_method:0,features:of(of(of(of(of({install_id:lI(),device:l.name,system:l.os,system_general:navigator.userAgent,vendor:t.appId,version:Zd,cname:t.cname,session_id:t.sid,proxyServer:t.proxyServer,sdk_type:RI.WEB_RTC,browser_name:l.name,browser_version:l.version,user_agent:navigator.userAgent,channel_name:t.cname},t.stringUid&&{string_uid:t.stringUid}),t.uid&&{uid:t.uid+""}),l.os&&{os_name:l.os}),l.osVersion&&{os_version:l.osVersion}),{},{detail:""})};return Xu(()=>sf(e,{data:f,timeout:1e3,cancelToken:r,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":54}}),void 0,m=>m.code!==oe.OPERATION_ABORTED,s)}(R,n,i,a)),_=null,S=null,C={};try{_=await jS(u)}catch(R){if(R.code===oe.OPERATION_ABORTED)throw R;S=R}if(u.forEach(R=>R.cancel()),jt.reportApiInvoke(n.sid,{name:bn.REQUEST_CONFIG_DISTRIBUTE,options:{error:S,res:_}}).onSuccess(),_&&_.test_tags)try{C=function(R){if(!R.test_tags)return{};let e=R.test_tags,t=Object.keys(e),r={};return t.forEach(s=>{var l;let f=js(l=s.slice(4)).call(l),m=JSON.parse(e[s]),E=m[1];r[f]={tag:m[0]||"",value:E}}),r}(_)}catch{}return C}async function MU(n,i){let a=ge("WEBCS_DOMAIN").concat(ge("WEBCS_DOMAIN_BACKUP_LIST")).map(c=>({url:"https://".concat(c,"/api/v2/transpond/webrtc?v=2"),areaCode:m1(),serviceIds:[aa.CHOOSE_SERVER,aa.CLOUD_PROXY_FALLBACK]}));try{return await DU({referenceList:a,asyncMapHandler:c=>async function(u,_,S){let C,{url:R,areaCode:e,serviceIds:t}=u,r=Date.now(),[s,l]=_1(_,e,t),f=ki.networkState;try{f&&ki.networkState===Uc.OFFLINE&&ki.onlineWaiter&&await Et.race([ki.onlineWaiter,Mn(da.maxRetryTimeout)]),f=ki.networkState;let{data:m,headers:E}=await sf(R,{data:s,cancelToken:S,headers:{"Content-Type":"multipart/form-data;"}},!0,!0);C=E.http3==="1"?1:-1,(A=>{let O=[];if(A.response_body.forEach(D=>{let P=D.buffer.code;if(D.uri===23&&P===0&&!D.buffer.edges_services)if(D.buffer.flag===4194310)D.buffer.edges_services=[];else{let F={error:new De(oe.CAN_NOT_GET_GATEWAY_SERVER,"no edge services in ap response",{retry:!0,csIp:A.detail[502]}),flag:D.buffer.flag};O.push(F)}if(P!==0){let F=Qn(P),B={error:new De(oe.CAN_NOT_GET_GATEWAY_SERVER,F.desc,{desc:F.desc,retry:F.retry,csIp:A.detail[502]}),flag:D.buffer.flag};D.buffer.flag===4194310?z.warning(B.error.toString()):O.push(B)}}),O.length)throw new De(oe.CAN_NOT_GET_GATEWAY_SERVER,O.map(D=>"flag: ".concat(D.flag,", message: ").concat(D.error.message)).join(" | "),{retry:!!O.find(D=>D.error.data.retry),csIp:A.detail[502],desc:[...new Set(O.map(D=>{var P;return D==null||(P=D.error)===null||P===void 0||(P=P.data)===null||P===void 0?void 0:P.desc}).filter(D=>!!D))]})})(m);let y=II(m,aa.CHOOSE_SERVER),b=II(m,aa.CLOUD_PROXY_FALLBACK);return NU(y),{gatewayInfo:vU(y,R),proxyInfo:b,opid:l,requestTime:r,url:R,isHttp3:C,elapse:Date.now()-r}}catch(m){throw m}}(c,n,i),closeFn:c=>c.code===oe.OPERATION_ABORTED||c.code===oe.CAN_NOT_GET_GATEWAY_SERVER&&!c.data.retry})}catch(c){throw c}}async function kU(n,i,a,c){let u=ge("PROXY_SERVER_TYPE3"),_=(l,f,m)=>{let E=m||u;return Array.isArray(E)&&(E=f%2==0?u[1]:u[0]),"https://".concat(E,"/ap/?url=").concat(l)},S=null,C=[],R=async()=>{let l=ge("WEBCS_DOMAIN").slice(0,ge("AJAX_REQUEST_CONCURRENT")).map((E,y)=>{let b;return b=n.cloudProxyServer==="disabled"&&n.proxyServer?_("".concat(E,"/api/v2/transpond/webrtc?v=2"),y,n.proxyServer):n.cloudProxyServer==="disabled"||n.cloudProxyServer==="fallback"?"https://".concat(E,"/api/v2/transpond/webrtc?v=2"):_("".concat(E,"/api/v2/transpond/webrtc?v=2"),y),{url:b,areaCode:m1(),serviceIds:[aa.CHOOSE_SERVER,n.cloudProxyServer==="proxy5"?aa.CLOUD_PROXY_5:n.cloudProxyServer==="proxy3"||n.cloudProxyServer==="proxy4"?aa.CLOUD_PROXY:aa.CLOUD_PROXY_FALLBACK]}}),f=c.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:l.map(E=>E.url)}),m=await VS({fragementLength:ge("FRAGEMENT_LENGTH"),referenceList:l,asyncMapHandler:E=>(z.debug("[".concat(n.clientId,"] Connect to choose_server:"),E.url),g1(E,n,i,a)),allFailedhandler:E=>{throw c.recordJoinChannelService({endTs:Date.now(),status:"error",errors:E},f),E[0]},promisesCollector:C});return c.recordJoinChannelService({endTs:Date.now(),status:"success"},f),m},e=async()=>{if(await Mn(1e3),S!==null)return S;let l=ge("WEBCS_DOMAIN_BACKUP_LIST").map((E,y)=>{let b;return b=n.cloudProxyServer==="disabled"&&n.proxyServer?_("".concat(E,"/api/v2/transpond/webrtc?v=2"),y,n.proxyServer):n.cloudProxyServer==="disabled"||n.cloudProxyServer==="fallback"?"https://".concat(E,"/api/v2/transpond/webrtc?v=2"):_("".concat(E,"/api/v2/transpond/webrtc?v=2"),y),{url:b,areaCode:m1(),serviceIds:[aa.CHOOSE_SERVER,n.cloudProxyServer==="proxy5"?aa.CLOUD_PROXY_5:n.cloudProxyServer==="proxy3"||n.cloudProxyServer==="proxy4"?aa.CLOUD_PROXY:aa.CLOUD_PROXY_FALLBACK]}}),f=c.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:l.map(E=>E.url)}),m=await VS({fragementLength:ge("FRAGEMENT_LENGTH"),referenceList:l,asyncMapHandler:E=>(z.debug("[".concat(n.clientId,"] Connect to backup choose_server:"),E.url),g1(E,n,i,a)),allFailedhandler:E=>{throw c.recordJoinChannelService({endTs:Date.now(),status:"error",errors:E},f),E[0]},promisesCollector:C});return c.recordJoinChannelService({endTs:Date.now(),status:"success"},f),m},t,r,s;try{({gatewayInfo:t,proxyInfo:r,url:s}=await jS([R(),e()]))}catch(l){throw l[0]}if(C.length&&C.forEach(l=>l.cancel&&typeof l.cancel=="function"&&l.cancel()),!t||!r)throw new De(oe.UNEXPECTED_ERROR,"missing gateway or proxy response").print();if(n.apUrl=s,n.cloudProxyServer!=="disabled"&&Array.isArray(u)&&s){let l=/^https?:\/\/(.+?)(\/.*)?$/.exec(s)[1];ft(u).call(u,l)&&(n.proxyServer=l,z.setProxyServer(l),jt.setProxyServer(l))}return S={gatewayInfo:t,proxyInfo:await SU(r,t.uid)},S}async function xU(n,i,a){let c=ge("UAP_AP").slice(0,ge("AJAX_REQUEST_CONCURRENT")).map(_=>n.proxyServer?"https://".concat(n.proxyServer,"/ap/?url=").concat(_+"/api/v1?action=uap"):"https://".concat(_,"/api/v1?action=uap")),u=c.map(_=>function(S,C,R,e){let t={command:"convergeAllocateEdge",sid:C.sid,appId:C.appId,token:C.token,ts:Date.now(),version:Zd,cname:C.cname,uid:C.uid.toString(),requestId:MI,seq:MI};MI+=1;let r={service_name:"tele_channel",json_body:JSON.stringify(t)};return Xu(async()=>{let s=await sf(S,{data:r,cancelToken:R,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":61}});if(s.code!==0){let f=new De(oe.UNEXPECTED_RESPONSE,"cross channel ap error, code"+s.code,{retry:!0});throw z.error(f.toString()),f}let l=JSON.parse(s.json_body);if(l.code!==200){let f=new De(oe.UNEXPECTED_RESPONSE,"cross channel app center error, code: ".concat(l.code,", reason: ").concat(l.reason));throw z.error(f.toString()),f}if(!l.servers||l.servers.length===0){let f=new De(oe.UNEXPECTED_RESPONSE,"cross channel app center empty server");throw z.error(f.toString()),f}return{vid:l.vid,workerToken:l.workerToken,addressList:(ge("CHANNEL_MEDIA_RELAY_SERVERS")||l.servers).map(f=>"wss://".concat(f.address.replace(/\./g,"-"),".").concat(ge("WORKER_DOMAIN"),":").concat(f.wss))}},void 0,s=>!!(s.code!==oe.OPERATION_ABORTED&&s.code!==oe.UNEXPECTED_RESPONSE||s.data&&s.data.retry),e)}(_,n,i,a));try{let _=await jS(u);return u.forEach(S=>S.cancel()),_}catch(_){throw _[0]}}async function LY(n,i,a){let c=null,u=[],_=async S=>{let C=ge(S?"WEBCS_DOMAIN_BACKUP_LIST":"WEBCS_DOMAIN").map(R=>n.proxyServer?"https://".concat(n.proxyServer,"/ap/?url=").concat(R+"/api/v2/transpond/webrtc?v=2"):"https://".concat(R,"/api/v2/transpond/webrtc?v=2"));return S&&(await Mn(1e3),c!==null)?c:await VS({fragementLength:ge("FRAGEMENT_LENGTH"),referenceList:C,asyncMapHandler:R=>(z.debug("[".concat(n.clientId,"] update ticket, Connect to ").concat(S?"backup":""," choose_server:"),R),function(e,t,r,s){let[l]=LU(t,[aa.CHOOSE_SERVER]),f=ki.networkState;return Xu(async()=>{f&&ki.networkState===Uc.OFFLINE&&ki.onlineWaiter&&await Et.race([ki.onlineWaiter,Mn(s&&s.maxRetryTimeout||da.maxRetryTimeout)]),f=ki.networkState;let m=await sf(e,{data:l,cancelToken:r,headers:{"Content-Type":"multipart/form-data;"}},!0);return dD(m,e)},()=>!1,m=>m.code!==oe.OPERATION_ABORTED&&(m.code===oe.UPDATE_TICKET_FAILED?m.data.retry:(z.warning("[".concat(t.clientId,"] update ticket network error, retry"),m),!0)),s)}(R,n,i,a)),allFailedhandler:R=>{throw R[0]},promisesCollector:u})};try{return c=await jS([_(!1),_(!0)]),u.length&&u.forEach(S=>S.cancel&&typeof S.cancel=="function"&&S.cancel()),c}catch(S){throw S[0]}}function fD(n,i){var a=Object.keys(n);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(n);i&&(c=c.filter(function(u){return Object.getOwnPropertyDescriptor(n,u).enumerable})),a.push.apply(a,c)}return a}function UU(n){for(var i=1;i<arguments.length;i++){var a=arguments[i]!=null?arguments[i]:{};i%2?fD(Object(a),!0).forEach(function(c){re(n,c,a[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(a)):fD(Object(a)).forEach(function(c){Object.defineProperty(n,c,Object.getOwnPropertyDescriptor(a,c))})}return n}class v1 extends li{get isSuccess(){return!!this.configs}constructor(i,a){super(),re(this,"configs",void 0),re(this,"store",void 0),re(this,"joinInfo",void 0),re(this,"cancelToken",void 0),re(this,"retryConfig",{timeout:3e3,timeoutFactor:1.5,maxRetryCount:1,maxRetryTimeout:1e4}),re(this,"interval",void 0),re(this,"mutex",void 0),re(this,"mutableParamsRead",!1),re(this,"configCache",{}),re(this,"limit_bitrate",void 0),this.mutex=new Na("config-distribute",i),this.store=a}startGetConfigDistribute(i,a){this.joinInfo=i,this.cancelToken=a,this.interval&&this.stopGetConfigDistribute(),ge("ENABLE_CONFIG_DISTRIBUTE")&&(this.updateConfigDistribute(),this.interval=window.setInterval(()=>{this.updateConfigDistribute()},ge("CONFIG_DISTRIBUTE_INTERVAL")))}stopGetConfigDistribute(){this.interval&&clearInterval(this.interval),this.interval=void 0,this.joinInfo=void 0,this.cancelToken=void 0,this.configs=void 0,this.limit_bitrate=void 0}async awaitConfigDistributeComplete(){this.mutex.isLocked&&(await this.mutex.lock())()}async updateConfigDistribute(){if(this.mutableParamsRead||(this.mutableParamsRead=!0,jt.reportApiInvoke(null,{options:void 0,name:bn.LOAD_CONFIG_FROM_LOCALSTORAGE,tag:Li.TRACER}).onSuccess(JSON.stringify(hs))),!this.joinInfo||!this.cancelToken||!this.retryConfig)return void z.debug("[config-distribute] get config distribute interrupted have no joininfo");let i,a=await this.mutex.lock();try{i=await X8(this.joinInfo,this.cancelToken,this.retryConfig),z.debug("[config-distribute] get config distribute",JSON.stringify(i));let c=function(u){var _;let S=CR(_=Object.keys(u).filter(e=>/^webrtc_ng_global_parameter/.test(e))).call(_);for(let e=0;e<S.length;e++)for(let t=S.length-1;t>e;t--){let r=S[t],s=u[r].value;if(typeof s.__priority=="number"){let l=s.__priority,f=S[t-1],m=u[f].value;if(typeof m.__priority=="number"){if(!(l>m.__priority))continue;{let E=r;S[t]=S[t-1],S[t-1]=E}}else{let E=r;S[t]=S[t-1],S[t-1]=E}}}let C=Date.now(),R={};return S.forEach(e=>{let t=u[e].value.__expires;t&&t<=C||(R[e]=u[e])}),R}(i);this.cacheGlobalParameterConfig(c),this.store.hasStartJoinChannel||(this.store.isABTestSuccess=!0),this.configs=c}catch(c){let u=new De(oe.NETWORK_RESPONSE_ERROR,c);z.warning("[config-distribute] ".concat(u.toString()))}finally{a()}}getBitrateLimit(){return this.limit_bitrate||void 0}handleBitrateLimit(i){ya(i)&&(this.limit_bitrate?this.limit_bitrate&&this.limit_bitrate.id!==i.id&&this.emit(PS.UPDATE_BITRATE_LIMIT,i):this.emit(PS.UPDATE_BITRATE_LIMIT,i))}getLowStreamConfigDistribute(){return this.limit_bitrate&&UU({},this.limit_bitrate.low_stream_uplink)}handleABTestConfigDistribute(i){try{let a={},c=Object.keys(i),u=[];c.forEach(_=>{let S=i[_].value;a[_]=S;let C=S.__id;if(C&&this.configCache[_]&&this.configCache[_].__id===C)return;let R=S.__type,e=i[_].value,t=i[_].tag,r=0;R?R===wL.REALTIME&&(r=1):Object.keys(e).some(s=>Object.prototype.hasOwnProperty.call(CL,s)||!tu()&&Object.prototype.hasOwnProperty.call(cc,s)?(r=1,!0):void 0),u.push({tag:t,isApplied:r,feature:_,params:JSON.stringify(S)})}),u.forEach(_=>{let{tag:S,feature:C,params:R,isApplied:e}=_;this.store.sessionId&&jt.abTest(this.store.sessionId,{intSucc:1,isApplied:e,tag:S,feature:C,params:R,cid:this.store.cid,uid:this.store.intUid})}),this.configCache=a}catch(a){z.debug("handleABTestConfigDistribute error",a)}}cacheGlobalParameterConfig(i){let a=function(u){let _={};return Object.keys(u).forEach(S=>{let C=u[S].value,R=C.__expires,e=C.__type;Object.keys(C).forEach(t=>{t==="__id"||t==="__type"||t==="__priority"||t==="__expires"||Object.prototype.hasOwnProperty.call(_,t)||(_[t]=UU(UU({value:C[t]},R&&{expires:R}),e&&{type:e}))})}),_}(i);try{var c;let u=(c=a.LIMIT_BITRATE)===null||c===void 0?void 0:c.value;delete a.LIMIT_BITRATE,u&&ya(u)&&this.handleBitrateLimit(u),this.limit_bitrate=u,this.handleGlobalParameterConfig(a),this.handleABTestConfigDistribute(i),function(C){try{let R=Date.now();Object.keys(C).forEach(e=>{let{value:t,type:r,expires:s}=C[e];s&&s<=R||((r===wL.REALTIME||Object.prototype.hasOwnProperty.call(CL,e))&&(hs[e]=t,ai[e]=t,z.debug("Update realtime parameters from config distribute",e,t)),r||tu()||!Object.prototype.hasOwnProperty.call(cc,e)||(hs[e]=t,ai[e]=t,z.debug("Update gateway parameters from config distribute",e,t)))})}catch(R){z.error("Error update config immediately: ".concat(C),R.message)}}(a);let _=JSON.stringify(a),S=window.btoa(_);window.localStorage.setItem("websdk_ng_global_parameter",S),z.debug("Caching global parameters ".concat(_))}catch(u){z.error("Error caching global parameters:",u.message)}}handleGlobalParameterConfig(i){try{let a=Date.now();Object.keys(i).forEach(c=>{if(c==="CLIENT_ROLE_OPTIONS"&&Object.prototype.hasOwnProperty.call(ai,c)){let{value:u,expires:_}=i[c];if(_&&_<=a)return;(function(S,C){try{return typeof S=="object"&&typeof C=="object"&&JSON.stringify(S)===JSON.stringify(C)}catch{return!1}})(ai[c],u)||(hs[c]=u,ai[c]=u,this.emit(PS.UPDATE_CLIENT_ROLE_OPTIONS,u),z.debug("Updating client role options: ".concat(JSON.stringify(u))))}})}catch(a){z.error("Error handling global parameter config:",a.message)}}}class S1 extends li{constructor(){super(...arguments),re(this,"resultStorage",new Map)}setLocalAudioStats(i,a,c){this.record("AUDIO_INPUT_LEVEL_TOO_LOW",i,this.checkAudioInputLevel(c,a)),this.record("SEND_AUDIO_BITRATE_TOO_LOW",i,this.checkSendAudioBitrate(c,a))}setLocalVideoStats(i,a,c){this.record("SEND_VIDEO_BITRATE_TOO_LOW",i,this.checkSendVideoBitrate(c,a)),this.record("FRAMERATE_INPUT_TOO_LOW",i,this.checkFramerateInput(c,a)),this.record("FRAMERATE_SENT_TOO_LOW",i,this.checkFramerateSent(c))}setRemoteAudioStats(i,a){let c=i.getUserId();this.record("AUDIO_OUTPUT_LEVEL_TOO_LOW",c,this.checkAudioOutputLevel(a))}setRemoteVideoStats(i,a){let c=i.getUserId();this.record("RECV_VIDEO_DECODE_FAILED",c,this.checkVideoDecode(a))}record(i,a,c){if(ge("STATS_UPDATE_INTERVAL")>500)return;this.resultStorage.has(i)||this.resultStorage.set(i,{result:[],isPrevNormal:!0});let u=this.resultStorage.get(i);if(u&&(u.result.push(c),u.result.length>=5)){var _;let S=ft(_=u.result).call(_,!0);u.isPrevNormal&&!S&&this.emit("exception",y1[i],i,a),!u.isPrevNormal&&S&&this.emit("exception",y1[i]+2e3,i+"_RECOVER",a),u.isPrevNormal=S,u.result=[]}}checkAudioOutputLevel(i){return!(i.receiveBitrate>0&&i.receiveLevel===0)}checkAudioInputLevel(i,a){return a instanceof va&&!a.isActive||!!a.muted||i.sendVolumeLevel!==0}checkFramerateInput(i,a){let c=null;a._encoderConfig&&a._encoderConfig.frameRate&&(c=Al(a._encoderConfig.frameRate));let u=i.captureFrameRate;return!c||!u||!(c>10&&u<5||c<10&&c>=5&&u<=1)}checkFramerateSent(i){return!(i.captureFrameRate&&i.sendFrameRate&&i.captureFrameRate>5&&i.sendFrameRate<=1)}checkSendVideoBitrate(i,a){return!!a.muted||i.sendBitrate!==0}checkSendAudioBitrate(i,a){return a instanceof va&&!a.isActive||!!a.muted||i.sendBitrate!==0}checkVideoDecode(i){return i.receiveBitrate===0||i.decodeFrameRate!==0}}let y1={FRAMERATE_INPUT_TOO_LOW:1001,FRAMERATE_SENT_TOO_LOW:1002,SEND_VIDEO_BITRATE_TOO_LOW:1003,RECV_VIDEO_DECODE_FAILED:1005,AUDIO_INPUT_LEVEL_TOO_LOW:2001,AUDIO_OUTPUT_LEVEL_TOO_LOW:2002,SEND_AUDIO_BITRATE_TOO_LOW:2003},Cs=new class{markSubscribeStart(n,i){performance.mark("agora-web-sdk/".concat(n,"/subscribe-").concat(i))}markPublishStart(n,i){performance.mark("agora-web-sdk/".concat(n,"/publish-").concat(i))}measureFromSubscribeStart(n,i){let a=performance.getEntriesByName("agora-web-sdk/".concat(n,"/subscribe-").concat(i));if(a.length>0){let c=a[a.length-1];return Math.round(performance.now()-c.startTime)}return 0}measureFromPublishStart(n,i){let a=performance.getEntriesByName("agora-web-sdk/".concat(n,"/publish-").concat(i));if(a.length>0){let c=a[a.length-1];return Math.round(performance.now()-c.startTime)}return 0}};function hD(n,i){var a=Object.keys(n);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(n);i&&(c=c.filter(function(u){return Object.getOwnPropertyDescriptor(n,u).enumerable})),a.push.apply(a,c)}return a}function W_(n){for(var i=1;i<arguments.length;i++){var a=arguments[i]!=null?arguments[i]:{};i%2?hD(Object(a),!0).forEach(function(c){re(n,c,a[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(a)):hD(Object(a)).forEach(function(c){Object.defineProperty(n,c,Object.getOwnPropertyDescriptor(a,c))})}return n}class T1{constructor(i){re(this,"store",void 0),re(this,"onStatsException",void 0),re(this,"onUploadPublishDuration",void 0),re(this,"onStatsChanged",void 0),re(this,"localStats",new Map),re(this,"remoteStats",new Map),re(this,"updateStatsInterval",void 0),re(this,"trafficStats",void 0),re(this,"trafficStatsPeerList",[]),re(this,"uplinkStats",void 0),re(this,"exceptionMonitor",void 0),re(this,"p2pChannel",void 0),re(this,"scalabilityMode",El.L1T1),re(this,"updateStats",()=>{this.p2pChannel&&(this.updateRemoteStats(this.p2pChannel),this.updateLocalStats(this.p2pChannel))}),this.store=i,this.exceptionMonitor=new S1,this.exceptionMonitor.on("exception",(a,c,u)=>{this.onStatsException&&this.onStatsException(a,c,u)})}startUpdateStats(){this.updateStatsInterval||(this.updateStatsInterval=window.setInterval(this.updateStats,1e3))}stopUpdateStats(){this.updateStatsInterval&&(window.clearInterval(this.updateStatsInterval),this.updateStatsInterval=void 0)}reset(){this.localStats=new Map,this.remoteStats=new Map,this.trafficStats=void 0,this.trafficStatsPeerList=[],this.uplinkStats=void 0}getLocalAudioTrackStats(){return this.localStats.get(Qe.LocalAudioTrack)||W_({},U_)}getLocalVideoTrackStats(){return this.localStats.get(Qe.LocalVideoTrack)||W_({},OL)}getRemoteAudioTrackStats(i){let a=(_,S)=>{if(!this.trafficStats)return S;let C=this.trafficStats.peer_delay.find(R=>R.peer_uid===_);return C&&(S.publishDuration=C.B_ppad+(Date.now()-this.trafficStats.timestamp)),S},c={};if(i){var u;let _=(u=this.remoteStats.get(i))===null||u===void 0?void 0:u.audioStats;_&&(c[i]=a(i,_))}else Array.from(this.remoteStats.entries()).forEach(_=>{let[S,{audioStats:C}]=_;C&&(c[S]=a(S,C))});return c}getRemoteNetworkQualityStats(i){let a={};if(i){var c;let u=(c=this.remoteStats.get(i))===null||c===void 0?void 0:c.networkStats;u&&(a[i]=u)}else Array.from(this.remoteStats.entries()).forEach(u=>{let[_,{networkStats:S}]=u;S&&(a[_]=S)});return a}getRemoteVideoTrackStats(i){let a=(_,S)=>{if(!this.trafficStats)return S;let C=this.trafficStats.peer_delay.find(R=>R.peer_uid===_);return C&&(S.publishDuration=C.B_ppvd+(Date.now()-this.trafficStats.timestamp)),S},c={};if(i){var u;let _=(u=this.remoteStats.get(i))===null||u===void 0?void 0:u.videoStats;_&&(c[i]=a(i,_))}else Array.from(this.remoteStats.entries()).forEach(_=>{let[S,{videoStats:C}]=_;C&&(c[S]=a(S,C))});return c}getRTCStats(){let i=0,a=0,c=0,u=0,_=this.localStats.get(Qe.LocalAudioTrack);_&&(i+=_.sendBytes,a+=_.sendBitrate);let S=this.localStats.get(Qe.LocalVideoTrack);S&&(i+=S.sendBytes,a+=S.sendBitrate);let C=this.localStats.get(Qe.LocalVideoLowTrack);C&&(i+=C.sendBytes,a+=C.sendBitrate),this.remoteStats.forEach(e=>{let{audioStats:t,videoStats:r}=e;t&&(c+=t.receiveBytes,u+=t.receiveBitrate),r&&(c+=r.receiveBytes,u+=r.receiveBitrate)});let R=1;return this.trafficStats&&(R+=this.trafficStats.peer_delay.length),{Duration:0,UserCount:R,SendBitrate:a,SendBytes:i,RecvBytes:c,RecvBitrate:u,OutgoingAvailableBandwidth:this.uplinkStats?this.uplinkStats.B_uab/1e3:0,RTT:this.trafficStats?2*this.trafficStats.B_acd:0}}addLocalStats(i){this.localStats.set(i,void 0)}removeLocalStats(i){i?this.localStats.delete(i):this.localStats.clear()}addRemoteStats(i){this.remoteStats.set(i,{})}removeRemoteStats(i){i?this.remoteStats.delete(i):this.remoteStats.clear()}addP2PChannel(i){this.p2pChannel=i}updateTrafficStats(i){i.peer_delay=i.peer_delay.filter(a=>a.B_ppad!==void 0||a.B_ppvd!==void 0),i.peer_delay.filter(a=>this.trafficStatsPeerList.indexOf(a.peer_uid)===-1).forEach(a=>{var c;let u=(c=this.p2pChannel)===null||c===void 0?void 0:c.getRemoteMedia(a.peer_uid),_=u!=null&&u.videoSSRC?Cs.measureFromSubscribeStart(this.store.clientId,u.videoSSRC):0,S=u!=null&&u.audioSSRC?Cs.measureFromSubscribeStart(this.store.clientId,u.audioSSRC):0;a.B_ppad!==void 0&&a.B_ppvd!==void 0&&(this.onUploadPublishDuration&&this.onUploadPublishDuration(a.peer_uid,a.B_ppad,a.B_ppvd,_>S?_:S),this.trafficStatsPeerList.push(a.peer_uid))}),this.trafficStats=i}updateUplinkStats(i){this.uplinkStats&&this.uplinkStats.B_fir!==i.B_fir&&z.debug("[".concat(this.store.clientId,"]: Period fir changes to ").concat(i.B_fir)),this.uplinkStats=i}static isRemoteVideoFreeze(i,a,c){if(!i)return!1;let u=!!c&&a.framesDecodeFreezeTime>c.framesDecodeFreezeTime,_=!c||a.framesDecodeCount>c.framesDecodeCount;return u||!_}static isRemoteAudioFreeze(i){return!!i&&i._isFreeze()}isLocalVideoFreeze(i){return!(!i.inputFrame||!i.sentFrame)&&i.inputFrame.frameRate>5&&i.sentFrame.frameRate<3}updateLocalStats(i){Array.from(this.localStats.entries()).forEach(a=>{let[c,u]=a;switch(c){case Qe.LocalVideoTrack:case Qe.LocalVideoLowTrack:{let S=u,C=W_({},OL),R=i.getStats(),e=i.getLocalMedia(c);if(R){let t=R.videoSend.find(r=>r.ssrc===(e==null?void 0:e.ssrcs[0].ssrcId));if(t){let r=i.getLocalVideoSize(),s=i.getEncoderConfig(Qe.LocalVideoTrack);t.codec!=="H264"&&t.codec!=="H265"&&t.codec!=="VP8"&&t.codec!=="VP9"&&t.codec!=="AV1X"&&t.codec!=="AV1"||(C.codecType=t.codec),C.sendBytes=t.bytes,C.sendBitrate=S?8*Math.max(0,C.sendBytes-S.sendBytes):0,t.inputFrame?(C.captureFrameRate=t.inputFrame.frameRate,C.captureResolutionHeight=t.inputFrame.height,C.captureResolutionWidth=t.inputFrame.width):r&&(C.captureResolutionWidth=r.width,C.captureResolutionHeight=r.height),t.sentFrame?(C.sendFrameRate=t.sentFrame.frameRate,C.sendResolutionHeight=t.sentFrame.height,C.sendResolutionWidth=t.sentFrame.width):r&&(C.sendResolutionWidth=r.width,C.sendResolutionHeight=r.height),t.avgEncodeMs&&(C.encodeDelay=t.avgEncodeMs),s&&s.bitrateMax&&(C.targetSendBitrate=1e3*s.bitrateMax),C.sendPackets=t.packets,C.sendPacketsLost=t.packetsLost,C.sendJitterMs=t.jitterMs,C.sendRttMs=t.rttMs,C.totalDuration=S?S.totalDuration+1:1,C.totalFreezeTime=S?S.totalFreezeTime:0,this.isLocalVideoFreeze(t)&&(C.totalFreezeTime+=1),t.scalabilityMode&&this.scalabilityMode!==t.scalabilityMode&&(z.debug("[".concat(this.store.clientId,"]: The scalabilityMode of the video sending stream is ").concat(t.scalabilityMode)),this.scalabilityMode=t.scalabilityMode)}this.trafficStats&&(C.currentPacketLossRate=(this.trafficStats.B_pvlr4||0)/100)}var _;this.localStats.set(c,C),((S==null?void 0:S.sendResolutionWidth)!==C.sendResolutionWidth||(S==null?void 0:S.sendResolutionHeight)!==C.sendResolutionHeight)&&((_=this.onStatsChanged)===null||_===void 0||_.call(this,"resolution",{width:C.sendResolutionWidth,height:C.sendResolutionHeight})),C&&e&&this.exceptionMonitor.setLocalVideoStats(this.store.uid,e.track,C);break}case Qe.LocalAudioTrack:{let S=u,C=W_({},U_),R=i.getStats(),e=i.getLocalMedia(c);if(R){let t=R.audioSend.find(r=>r.ssrc===(e==null?void 0:e.ssrcs[0].ssrcId));if(t){if(t.codec!=="opus"&&t.codec!=="aac"&&t.codec!=="PCMU"&&t.codec!=="PCMA"&&t.codec!=="G722"||(C.codecType=t.codec),t.inputLevel)C.sendVolumeLevel=Math.round(32767*t.inputLevel);else{let r=i.getLocalAudioVolume();r&&(C.sendVolumeLevel=Math.round(32767*r))}C.sendBytes=t.bytes,C.sendPackets=t.packets,C.sendPacketsLost=t.packetsLost,C.sendJitterMs=t.jitterMs,C.sendRttMs=t.rttMs,C.sendBitrate=S?8*Math.max(0,C.sendBytes-S.sendBytes):0}}this.trafficStats&&(C.currentPacketLossRate=(this.trafficStats.B_palr4||0)/100),this.localStats.set(Qe.LocalAudioTrack,C),C&&e&&this.exceptionMonitor.setLocalAudioStats(this.store.uid,e.track,C);break}}})}updateRemoteStats(i){Array.from(this.remoteStats.entries()).forEach(a=>{var c,u;let[_,{videoStats:S,audioStats:C,videoPcStats:R}]=a,e=C,t=S,r=R,s=W_({},Dt),l=W_({},wS),f=W_({},xr),{audioTrack:m,videoTrack:E,audioSSRC:y,videoSSRC:b}=i.getRemoteMedia(_),A;A=this.store.useP2P?i.getStats(!0):i.getStats();let O=(c=A)===null||c===void 0?void 0:c.audioRecv.find(B=>B.ssrc===y),D=(u=A)===null||u===void 0?void 0:u.videoRecv.find(B=>B.ssrc===b),P=this.trafficStats&&this.trafficStats.peer_delay.find(B=>B.peer_uid===_);if(O&&(O.codec!=="opus"&&O.codec!=="aac"&&O.codec!=="PCMU"&&O.codec!=="PCMA"&&O.codec!=="G722"||(s.codecType=O.codec),O.outputLevel?s.receiveLevel=Math.round(32767*O.outputLevel):m&&(s.receiveLevel=Math.round(32767*m.getVolumeLevel())),s.receiveBytes=O.bytes,s.receivePackets=O.packets,s.receivePacketsLost=O.packetsLost,s.receivePacketsDiscarded=O.packetsDiscarded,s.packetLossRate=s.receivePacketsLost/(s.receivePackets+s.receivePacketsLost),s.receiveBitrate=e?8*Math.max(0,s.receiveBytes-e.receiveBytes):0,s.totalDuration=e?e.totalDuration+1:1,s.totalFreezeTime=e?e.totalFreezeTime:0,s.freezeRate=s.totalFreezeTime/s.totalDuration,s.receiveDelay=O.jitterBufferMs,s.totalDuration>10&&T1.isRemoteAudioFreeze(m)&&(s.totalFreezeTime+=1)),D){var F;D.codec!=="H264"&&D.codec!=="H265"&&D.codec!=="VP8"&&D.codec!=="VP9"&&D.codec!=="AV1X"&&D.codec!=="AV1"||(l.codecType=D.codec),l.receiveBytes=D.bytes,l.receiveBitrate=t?8*Math.max(0,l.receiveBytes-t.receiveBytes):0,l.decodeFrameRate=D.decodeFrameRate<0?0:D.decodeFrameRate,l.renderFrameRate=D.decodeFrameRate<0?0:D.decodeFrameRate,D.outputFrame&&(l.renderFrameRate=D.outputFrame.frameRate),D.receivedFrame?(l.receiveFrameRate=D.receivedFrame.frameRate,l.receiveResolutionHeight=D.receivedFrame.height,l.receiveResolutionWidth=D.receivedFrame.width):E&&(l.receiveResolutionHeight=E._videoHeight||0,l.receiveResolutionWidth=E._videoWidth||0),D.framesRateFirefox!==void 0&&(l.receiveFrameRate=Math.round(D.framesRateFirefox)),l.receivePackets=D.packets,l.receivePacketsLost=D.packetsLost,l.packetLossRate=l.receivePacketsLost/(l.receivePackets+l.receivePacketsLost);let B=t?t.totalFreezeTime:0,Y=t?t.totalDuration:0;l.totalDuration=t?t.totalDuration+1:1,l.totalFreezeTime=(F=D.totalFreezesDuration)!==null&&F!==void 0?F:B||0,l.receiveDelay=D.jitterBufferMs||0;let $=!!b&&i.getRemoteVideoIsReady(b);D.totalFreezesDuration===void 0&&E&&$&&T1.isRemoteVideoFreeze(E,D,r)&&(l.totalFreezeTime+=1),l.freezeRate=Math.max(0,Math.min((l.totalFreezeTime-B)/(l.totalDuration-Y),1))}P&&(s.end2EndDelay=P.B_ad,l.end2EndDelay=P.B_vd,s.transportDelay=P.B_ed,l.transportDelay=P.B_ed,s.currentPacketLossRate=P.B_ealr4/100,l.currentPacketLossRate=P.B_evlr4/100,f.uplinkNetworkQuality=P.B_punq?P.B_punq:0,f.downlinkNetworkQuality=P.B_pdnq?P.B_pdnq:0),this.remoteStats.set(_,{audioStats:s,videoStats:l,videoPcStats:D,networkStats:f}),m&&this.exceptionMonitor.setRemoteAudioStats(m,s),E&&this.exceptionMonitor.setRemoteVideoStats(E,l)})}}class Q8{constructor(){re(this,"destChannelMediaInfos",new Map),re(this,"srcChannelMediaInfo",void 0)}setSrcChannelInfo(i){cn(i),this.srcChannelMediaInfo=i}addDestChannelInfo(i){cn(i),this.destChannelMediaInfos.set(i.channelName,i)}removeDestChannelInfo(i){JL(i),this.destChannelMediaInfos.delete(i)}getSrcChannelMediaInfo(){return this.srcChannelMediaInfo}getDestChannelMediaInfo(){return this.destChannelMediaInfos}}function Z8(n){if(!(n instanceof Q8))return new De(oe.INVALID_PARAMS,"Config should be instance of [ChannelMediaRelayConfiguration]").throw();let i=n.getSrcChannelMediaInfo(),a=n.getDestChannelMediaInfo();if(!i)return new De(oe.INVALID_PARAMS,"srcChannelMediaInfo should not be empty").throw();if(a.size===0)return new De(oe.INVALID_PARAMS,"destChannelMediaInfo should not be empty").throw()}class Hg{get hasVideo(){return this._video_enabled_&&!this._video_muted_&&this._video_added_}get hasAudio(){return this._audio_enabled_&&!this._audio_muted_&&this._audio_added_}get audioTrack(){if(this.hasAudio||this._audio_pre_subscribed)return this._audioTrack}get videoTrack(){if(this.hasVideo||this._video_pre_subscribed)return this._videoTrack}get dataChannels(){return this._dataChannels}constructor(i,a){re(this,"uid",void 0),re(this,"_uintid",void 0),re(this,"_trust_in_room_",!0),re(this,"_trust_audio_enabled_state_",!0),re(this,"_trust_video_enabled_state_",!0),re(this,"_trust_audio_mute_state_",!0),re(this,"_trust_video_mute_state_",!0),re(this,"_audio_muted_",!1),re(this,"_video_muted_",!1),re(this,"_audio_enabled_",!0),re(this,"_video_enabled_",!0),re(this,"_audio_added_",!1),re(this,"_video_added_",!1),re(this,"_is_pre_created",!1),re(this,"_video_pre_subscribed",!1),re(this,"_audio_pre_subscribed",!1),re(this,"_trust_video_stream_added_state_",!0),re(this,"_trust_audio_stream_added_state_",!0),re(this,"_audioTrack",void 0),re(this,"_videoTrack",void 0),re(this,"_dataChannels",[]),re(this,"_audioSSRC",void 0),re(this,"_videoSSRC",void 0),re(this,"_audioOrtc",void 0),re(this,"_videoOrtc",void 0),re(this,"_cname",void 0),re(this,"_rtxSsrcId",void 0),re(this,"_videoMid",void 0),re(this,"_audioMid",void 0),this.uid=i,this._uintid=a}}function jU(n,i){var a=Object.keys(n);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(n);i&&(c=c.filter(function(u){return Object.getOwnPropertyDescriptor(n,u).enumerable})),a.push.apply(a,c)}return a}function $8(n){for(var i=1;i<arguments.length;i++){var a=arguments[i]!=null?arguments[i]:{};i%2?jU(Object(a),!0).forEach(function(c){re(n,c,a[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(a)):jU(Object(a)).forEach(function(c){Object.defineProperty(n,c,Object.getOwnPropertyDescriptor(a,c))})}return n}let kI="9",VU=4e4;function pD(n,i){var a=Object.keys(n);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(n);i&&(c=c.filter(function(u){return Object.getOwnPropertyDescriptor(n,u).enumerable})),a.push.apply(a,c)}return a}function Wg(n){for(var i=1;i<arguments.length;i++){var a=arguments[i]!=null?arguments[i]:{};i%2?pD(Object(a),!0).forEach(function(c){re(n,c,a[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(a)):pD(Object(a)).forEach(function(c){Object.defineProperty(n,c,Object.getOwnPropertyDescriptor(a,c))})}return n}var b1=function(n){return n[n.DOWN=0]="DOWN",n[n.UP=1]="UP",n}(b1||{});let xI=new Map;function ws(n,i,a,c){let{scale:u}=n;if(u===0&&c===b1.UP||u>=i.length-1&&c===b1.DOWN)return n;let _=Wg(Wg({},n),{},{scale:c===b1.DOWN?++u:--u});switch(a){case"maintain-framerate":_=Wg(Wg({},_),i[u].motion);break;case"maintain-resolution":_=Wg(Wg({},_),i[u].detail);break;case"balanced":_=Wg(Wg({},_),i[u].balanced)}return _}function BU(n,i){if(i){let a={overUse:0,underUse:0,adaptationList:Y_(i)};xI.set(n,a)}else xI.delete(n)}function Y_(n){let i=Wg({},n),{bitrateMax:a,frameRate:c,scaleResolutionDownBy:u,bitrateMin:_}=i,{MIN_FRAME_RATE:S,MAX_THRESHOLD_FRAMERATE:C,MAX_SCALE:R,BITRATE_MIN_THRESHOLD:e,BITRATE_MAX_THRESHOLD:t,BWE_SCALE_UP_THRESHOLD:r,BWE_SCALE_DOWN_THRESHOLD:s,PERF_SCALE_DOWN_THRESHOLD:l,PERF_SCALE_UP_THRESHOLD:f,BALANCE_BITRATE_FACTOR:m,BALANCE_FRAMERATE_FACTOR:E,BALANCE_RESOLUTION_FACTOR:y,MOTION_RESOLUTION_FACTOR:b,MOTION_BITRATE_FACTOR:A,DETAIL_FRAMERATE_FACTOR:O,DETAIL_BITRATE_FACTOR:D}=M_,P=Math.min(i.frameRate,C),F=[{scale:0,threshold:{bwe_down:Math.round(Math.pow(s,1)*a),bwe_up:a,fps_down:Math.round(Math.pow(l,1)*P),fps_up:c},balanced:{scaleResolutionDownBy:1,frameRate:c,bitrateMax:a,bitrateMin:_},motion:{scaleResolutionDownBy:1,frameRate:c,bitrateMax:a,bitrateMin:_},detail:{scaleResolutionDownBy:1,frameRate:c,bitrateMax:a,bitrateMin:_}}];for(let B=1;B<=R;B++){let Y={bwe_up:Math.round(Math.pow(r,B)*a),bwe_down:Math.round(Math.pow(s,B+1)*a),fps_up:Math.round(Math.pow(f,B)*P),fps_down:Math.round(Math.pow(l,B+1)*P)},$={scaleResolutionDownBy:u/Math.pow(y,B),frameRate:Math.max(Math.round(Math.pow(E,B)*c),S),bitrateMax:Math.max(Math.round(Math.pow(m,B)*a),t),bitrateMin:Math.max(Math.round(Math.pow(m,B)*_),e)},ee={scaleResolutionDownBy:u/Math.pow(b,B),frameRate:c,bitrateMax:Math.max(Math.round(Math.pow(A,B)*a),t),bitrateMin:Math.max(Math.round(Math.pow(A,B)*_),e)},Ee={scaleResolutionDownBy:1,frameRate:Math.max(Math.round(Math.pow(O,B)*c),S),bitrateMax:Math.max(Math.round(Math.pow(D,B)*a),t),bitrateMin:Math.max(Math.round(Math.pow(D,B)*_),e)};F.push({scale:B,threshold:Y,balanced:$,motion:ee,detail:Ee})}return F}function UI(n,i,a,c,u,_){let S=xI.get(n)||{overUse:0,underUse:0,adaptationList:Y_(u)},{adaptationList:C}=S;xI.set(n,S);let{OVERUSE_TIMES_THRESHOLD:R,UNDERUSE_TIMES_THRESHOLD:e}=M_,{scale:t}=c,r,s;return typeof i=="number"&&i>0&&function(l,f,m,E){if(f>=m.length)return!1;let{threshold:{fps_down:y}}=m[f];return ge("FORCE_AG_HIGH_FRAMERATE")&&E==="maintain-framerate"&&(y=m[0].threshold.fps_down),l<y}(i,t,C,_)&&(S.overUse++,s=Hb.CPU,S.overUse>R)||typeof a=="number"&&a>0&&function(l,f,m){if(f>=m.length)return!1;let{threshold:{bwe_down:E}}=m[f];return l<E}(a,t,C)&&(S.overUse++,s=Hb.BANDWIDTH,S.overUse>R)?(S.overUse=0,S.underUse=0,r=ws(c,C,_,b1.DOWN),[r,s]):(typeof i=="number"&&i>0&&typeof a=="number"&&a>0&&function(l,f,m,E){if(f===0)return;let{threshold:{fps_up:y}}=m[f];return ge("FORCE_AG_HIGH_FRAMERATE")&&E==="maintain-framerate"&&(y=m[1].threshold.fps_up),l>y}(i,t,C,_)&&function(l,f,m){if(f===0)return;let{threshold:{bwe_up:E}}=m[f];return l>E}(a,t,C)&&(S.underUse++,S.underUse>e&&(S.overUse=0,S.underUse=0,r=ws(c,C,_,b1.UP),r.scale===0&&(s=Hb.NONE))),[r,s])}function FU(n,i){var a=Object.keys(n);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(n);i&&(c=c.filter(function(u){return Object.getOwnPropertyDescriptor(n,u).enumerable})),a.push.apply(a,c)}return a}function mD(n){for(var i=1;i<arguments.length;i++){var a=arguments[i]!=null?arguments[i]:{};i%2?FU(Object(a),!0).forEach(function(c){re(n,c,a[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(a)):FU(Object(a)).forEach(function(c){Object.defineProperty(n,c,Object.getOwnPropertyDescriptor(a,c))})}return n}function K_(n){var i;return!!ge("ENABLE_AG_ADAPTATION")&&!!(n instanceof UL||ft(i=n._hints).call(i,kr.CUSTOM_TRACK))&&(!!ge("FORCE_SUPPORT_AG_ADAPTATION")||!!(function(a){let c=En();if(c.os!==Ra.IOS||!c.osVersion)return!1;let u=c.osVersion.split(".");return Number(u[0])>=a}(14)&&tI(17,4)||_x(14)&&Up(17,4,!0)))}let jI=new Map;function VI(n,i){let a=jI.get(n);if(a){let{timer:c}=a;window.clearTimeout(c),jI.delete(n)}i.qualityLimitationReason=Hb.NONE,BU(n)}function BI(n,i){var a;let c;switch(i){case Qe.LocalAudioTrack:c=lr.Audio;break;case Qe.LocalVideoTrack:c=ft(a=n._hints).call(a,kr.SCREEN_TRACK)?lr.Screen:lr.High;break;case Qe.LocalVideoLowTrack:c=lr.Low}return c}function gD(n){let i=Un();if(n.some(a=>a._bypassWebAudio))throw new Ye(oe.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");if(!i.webAudioMediaStreamDest)throw new Ye(oe.NOT_SUPPORTED,"cannot publish multiple tracks because your browser does not support audio mixing")}function _D(n,i){gD(n);let a=new va;return n.forEach(c=>a.addAudioTrack(c)),a}let Yg=!Un().supportUnifiedPlan||ge("CHROME_FORCE_PLAN_B")&&jp();function Kg(n){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var a;return Yg?(a={spec:i,store:n},ao("PlanBConnection").create(a)):new Ah(i,n)}function C1(n){return n&&(n.iceConnectionState==="disconnected"||n.iceConnectionState==="checking"||n.iceConnectionState==="failed")}function GU(n){try{if(n.iceServers)return!1;if(n.turnServer&&n.turnServer.mode!=="off"){if(vS(n.turnServer.servers))return!1;if(ge("FORCE_TURN_TCP")||n.turnServer.servers.concat(n.turnServer.serversFromGateway||[]).some(i=>i.forceturn))return!0}return!1}catch{return!1}}var Wn;function zU(n,i){var a=Object.keys(n);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(n);i&&(c=c.filter(function(u){return Object.getOwnPropertyDescriptor(n,u).enumerable})),a.push.apply(a,c)}return a}function Ih(n){for(var i=1;i<arguments.length;i++){var a=arguments[i]!=null?arguments[i]:{};i%2?zU(Object(a),!0).forEach(function(c){re(n,c,a[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(a)):zU(Object(a)).forEach(function(c){Object.defineProperty(n,c,Object.getOwnPropertyDescriptor(a,c))})}return n}let Ah=(Wn=class AA extends bo{get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get dtlsTransportState(){var i,a;return(i=(a=this.peerConnection.getReceivers()[0])===null||a===void 0||(a=a.transport)===null||a===void 0?void 0:a.state)!==null&&i!==void 0?i:null}get localCodecs(){return[...new Set(this.localCapabilities&&this.localCapabilities.send.videoCodecs.map(i=>i.rtpMap&&i.rtpMap.encodingName.toLowerCase()||"").filter(i=>{var a;return ft(a=Object.keys(Gp)).call(a,i)}))]}constructor(i,a){super(i,a),re(this,"id",gr(5,"connection-")),re(this,"store",void 0),re(this,"peerConnection",void 0),re(this,"forceTurn",!1),re(this,"remoteSDP",void 0),re(this,"initialOffer",void 0),re(this,"transportEventReceiver",void 0),re(this,"statsFilter",void 0),re(this,"extension",{useXR:ge("USE_XR")}),re(this,"localCapabilities",void 0),re(this,"remoteCodecs",void 0),re(this,"localCandidateCount",0),re(this,"allCandidatesReceived",!1),re(this,"isPreallocation",!1),re(this,"preSSRCMap",new Map),re(this,"dataStreamChannelMap",new Map),re(this,"establishPromise",void 0),re(this,"recoveredDataChannelIds",[]),re(this,"currentDataChannelId",1),re(this,"supportAV1RtpSpec",!1),re(this,"mutex",void 0),re(this,"qualityLimitationReason",Hb.NONE),re(this,"isFirstConnected",!1),this.store=a,this.forceTurn=GU(i),this.mutex=new Na("P2PConnection-mutex",a.clientId),this.peerConnection=new RTCPeerConnection(AA.resolvePCConfiguration(i),{optional:[{googDscp:!0}]}),this.isFirstConnected=!1,this.statsFilter=bL(this.peerConnection,ge("STATS_UPDATE_INTERVAL"),void 0,Ni()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1,this.establishPromise=this.establish()}getPreMedia(i){let a=this.preSSRCMap.get(i);if(a!==void 0){let c=this.peerConnection.getTransceivers().find(u=>u.mid===a);if(c)return{transceiver:c,track:c.receiver.track,id:a}}}async updateRemoteRTPCapabilities(i,a){if(this.remoteCodecs=a,!this.remoteSDP)return void z.debug("[P2PConnection] cannot updateRemoteRTPCapabilities before remote SDP created, local codecs: ".concat(this.localCodecs,", codecs: ").concat(a));if(this.remoteSDP.updateRemoteCodec(i,a,this.store.codec)){let c=await this.peerConnection.createOffer(),u=this.logSDPExchange(c.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(c);let _=this.remoteSDP.toString();u==null||u(_),await this.peerConnection.setRemoteDescription({type:"answer",sdp:_})}else z.debug("[P2PConnection] updateRemoteRTPCapabilities no need to exchange SDP.")}async establish(){try{this.peerConnection.addTransceiver("video",{direction:"recvonly"}),this.peerConnection.addTransceiver("audio",{direction:"recvonly"});let c=await this.peerConnection.createOffer();if(!c.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");let u=Vg(c.sdp),_=await OI({filterRTX:!ge("USE_PUB_RTX")&&!ge("USE_SUB_RTX"),filterVideoFec:ge("FILTER_VIDEO_FEC"),filterAudioFec:ge("FILTER_AUDIO_FEC"),filterVideoCodec:ge("FILTER_VIDEO_CODEC")},this.extension);if(this.localCapabilities=z_(_),this.initialOffer=c,ge("ENABLE_SVC")&&this.store.codec=="av1"){let C=await async function(){try{let R=new RTCPeerConnection;R.addTransceiver("video",{direction:"sendonly",sendEncodings:[{scalabilityMode:El.L1T3}]});let e=await R.createOffer();if(!e.sdp)return void R.close();let t=Dn(e.sdp).mediaDescriptions[0];if(!t)return;let r=t.attributes.extmaps.find(s=>s.extensionName==="https://aomediacodec.github.io/av1-rtp-spec/#dependency-descriptor-rtp-header-extension");return R.close(),r}catch{return}}();var i;C&&(this.supportAV1RtpSpec=!0,(i=_.send)===null||i===void 0||i.videoExtensions.push(C))}let S;return c.sdp&&aD(c.sdp)&&(S=Fn(_),(a=S).send&&(Pi(Tt.VIDEO,a.send.videoExtensions),Pi(Tt.AUDIO,a.send.audioExtensions)),a.recv&&(Pi(Tt.VIDEO,a.recv.videoExtensions),Pi(Tt.AUDIO,a.recv.audioExtensions)),a.sendrecv&&(Pi(Tt.VIDEO,a.sendrecv.videoExtensions),Pi(Tt.AUDIO,a.sendrecv.audioExtensions))),Ih(Ih({},u),{},{rtpCapabilities:S||_,offerSDP:c.sdp})}catch(c){throw new Ye(oe.GET_LOCAL_CONNECTION_PARAMS_FAILED,c.toString())}var a}async connect(i){try{if(!this.initialOffer)throw new Error("Cannot establish P2PConnection without initial offer.");this.initialOffer.sdp&&aD(this.initialOffer.sdp)&&(a=i.rtpCapabilities,c=this.localCapabilities,a.send&&(tD(Tt.VIDEO,a.send.videoExtensions,c.send.videoExtensions),tD(Tt.AUDIO,a.send.audioExtensions,c.send.audioExtensions)),a.recv&&(tD(Tt.VIDEO,a.recv.videoExtensions,c.recv.videoExtensions),tD(Tt.AUDIO,a.recv.audioExtensions,c.recv.audioExtensions))),this.remoteSDP=new class{get localCapabilities(){return Fn(this._localCapabilities)}get rtpCapabilities(){return Fn(this._rtpCapabilities)}get candidates(){return Fn(this._candidates)}get iceParameters(){return Fn(this._iceParameters)}get dtlsParameters(){return Fn(this._dtlsParameters)}constructor(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];re(this,"sessionDesc",void 0),re(this,"_localCapabilities",void 0),re(this,"_rtpCapabilities",void 0),re(this,"_candidates",void 0),re(this,"_originCandidates",void 0),re(this,"_iceParameters",void 0),re(this,"_isUseExtmapAllowMixed",void 0),re(this,"_dtlsParameters",void 0),re(this,"setup",void 0),re(this,"currentMidIndex",void 0),re(this,"cname",void 0),re(this,"firefoxSsrcMidMap",new Map),this._isUseExtmapAllowMixed=t,e=Fn(e);let{iceParameters:r,dtlsParameters:s,candidates:l,rtpCapabilities:f,setup:m,localCapabilities:E,cname:y}=e;this._rtpCapabilities=f,this._candidates=l,this._originCandidates=Fn(l),this._iceParameters=r,this._dtlsParameters=s,this._localCapabilities=E,this.setup=m,this.cname=y,this.sessionDesc=this.updateRemoteRTPCapabilities(f),this.currentMidIndex=this.sessionDesc.mediaDescriptions.length-1}preloadRemoteMedia(e){let t=this.candidates,r=this.dtlsParameters,s=this.iceParameters,l=this.rtpCapabilities.send,f=this.sessionDesc.mediaDescriptions.length-1;for(let m=1;m<e;m++){let E=2*m+2e4,y=2*m+VU,{ssrcs:b,ssrcGroups:A}=Bg([{ssrcId:E}],this.cname),{ssrcs:O,ssrcGroups:D}=Bg([{ssrcId:y,rtx:ge("USE_SUB_RTX")?y+1:void 0}],this.cname);this.sessionDesc.mediaDescriptions.push({media:{mediaType:"video",port:kI,protos:["UDP","TLS","RTP","SAVPF"],fmts:l.videoCodecs.map(P=>P.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:s.iceUfrag,icePwd:s.icePwd,unrecognized:[],candidates:t,extmaps:l.videoExtensions,fingerprints:r.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:O,ssrcGroups:D,rtcpFeedbackWildcards:[],payloads:l.videoCodecs,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:"sendonly",rtcpMux:!0,rtcpRsize:!0,mid:"".concat(++f)}}),this.sessionDesc.mediaDescriptions.push({media:{mediaType:"audio",port:kI,protos:["UDP","TLS","RTP","SAVPF"],fmts:l.audioCodecs.map(P=>P.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:s.iceUfrag,icePwd:s.icePwd,unrecognized:[],candidates:t,extmaps:l.audioExtensions,fingerprints:r.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:b,ssrcGroups:A,rtcpFeedbackWildcards:[],payloads:l.audioCodecs,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:"sendonly",rtcpMux:!0,rtcpRsize:!0,mid:"".concat(++f)}}),this.currentMidIndex+=2}this.updateBundleMids()}toString(){return me(this.sessionDesc)}send(e,t,r,s){let{ssrcs:l,ssrcGroups:f}=Bg(t,this.cname,ge("SYNC_GROUP")?r:void 0),m=this.findPreloadMediaDesc(l);if(m){if(Ni()&&this.firefoxSsrcMidMap.set(l[0].ssrcId,m.attributes.mid),s&&(s.twcc||s.remb)){let E=this.sessionDesc.mediaDescriptions.indexOf(m);return this.sessionDesc.mediaDescriptions[E]=this.mungSendMediaDesc(m,s),{mid:m.attributes.mid,needExchangeSDP:!0}}return{mid:m.attributes.mid,needExchangeSDP:!1}}{let E=this.findAvailableMediaIndex(e,l),y;return E===-1||E===1&&(mr()||function(){let b=En();return!(b.name!==cr.CHROME||!b.osVersion)&&Number(b.version)<=90}()||ge("ENABLE_ENCODED_TRANSFORM")&&Vo())||E===0&&ge("USE_SUB_RTX")||Ex()?(y=this.createOrRecycleSendMedia(e,l,f,"sendonly",s),this.updateBundleMids()):(y=Fn(this.sessionDesc.mediaDescriptions[E]),y.attributes.direction="sendonly",y.attributes.ssrcs=l,y.attributes.ssrcGroups=f,this.sessionDesc.mediaDescriptions[E]=this.mungSendMediaDesc(y,s)),Ni()&&this.firefoxSsrcMidMap.set(l[0].ssrcId,y.attributes.mid),{mid:y.attributes.mid,needExchangeSDP:!0}}}sendDataChannel(){let{mediaDesc:e,needExchangeSDP:t}=this.createOrRecycleDataChannel();return this.updateBundleMids(),{mid:e.attributes.mid,needExchangeSDP:t}}batchSend(e){let t=e.map(l=>{let{kind:f,ssrcMsg:m,mslabel:E}=l;return this.send(f,m,E)}),r=[],s=!1;return t.forEach(l=>{let{mid:f,needExchangeSDP:m}=l;m&&(s=!0),r.push(f)}),{mids:r,needExchangeSDP:s}}stopSending(e){let t=this.sessionDesc.mediaDescriptions.filter(r=>r.attributes.mid&&e.indexOf(r.attributes.mid)!==-1);if(t.length!==e.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.stopSending.");t.forEach(r=>{r.attributes.mid==="0"||Ni()||Ex()?r.attributes.ssrcs=[]:(r.attributes.ssrcs=[],r.attributes.direction="inactive",r.media.port="0")}),this.updateBundleMids()}mute(e){let t=this.sessionDesc.mediaDescriptions.find(r=>r.attributes.mid===e);if(!t)throw new Error("mediaDescription not found with ".concat(e," in remote SDP when calling RemoteSDP.mute."));t.attributes.direction="inactive"}unmute(e){let t=this.sessionDesc.mediaDescriptions.find(r=>r.attributes.mid===e);if(!t)throw new Error("mediaDescription not found with ".concat(e," in remote SDP when calling RemoteSDP.unmute."));t.attributes.direction="sendonly"}muteRemote(e){let t=this.sessionDesc.mediaDescriptions.filter(r=>ft(e).call(e,r.attributes.mid||""));if(t.length!==e.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");t.forEach(r=>{r.attributes.direction="inactive"})}unmuteRemote(e){let t=this.sessionDesc.mediaDescriptions.filter(r=>ft(e).call(e,r.attributes.mid||""));if(t.length!==e.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");t.forEach(r=>{r.attributes.direction="recvonly"})}receive(e,t,r,s){e.forEach((l,f)=>{this.createOrRecycleRecvMedia(l,[],"recvonly",t,r,s[f])}),this.updateBundleMids()}stopReceiving(e){let t=this.sessionDesc.mediaDescriptions.filter(r=>e.indexOf(r.attributes.mid)!==-1);if(t.length!==e.length)throw new Error("MediaDescriptions' length doesn't match mids's length when calling RemoteSDP.receive.");t.forEach(r=>{r.media.port="0",r.attributes.direction="inactive"}),this.updateBundleMids()}updateRemoteRTPCapabilities(e){let t=this.sessionDesc||Dn((r=this._isUseExtmapAllowMixed,`v=0
o=- 0 0 IN IP4 127.0.0.1
s=AgoraGateway
t=0 0
a=group:BUNDLE 0 1
a=msid-semantic: WMS
a=ice-lite`.concat(r?`
a=extmap-allow-mixed`:"",`
m=video 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendonly
a=rtcp-mux
a=rtcp-rsize
a=mid:0
m=audio 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendonly
a=rtcp-mux
a=rtcp-rsize
a=mid:1
`)));var r;this._rtpCapabilities=e;let s=this.rtpCapabilities.send,l=this.localCapabilities.send;for(let f of t.mediaDescriptions){if(f.attributes.iceUfrag=this._iceParameters.iceUfrag,f.attributes.icePwd=this._iceParameters.icePwd,f.attributes.fingerprints=this._dtlsParameters.fingerprints,f.attributes.candidates=this._candidates,f.attributes.setup=this.setup,f.media.mediaType==="application"&&(f.attributes.sctpPort="5000"),f.media.mediaType==="video"){if(s.videoCodecs.length===0){let m=l.videoCodecs.filter(E=>{var y,b;return(y=E.rtpMap)===null||y===void 0?void 0:ft(b=y.encodingName.toLowerCase()).call(b,"vp8")})||[l.videoCodecs[0]];f.media.fmts=m.map(E=>E.payloadType.toString(10)),f.attributes.payloads=m,f.attributes.extmaps=[]}else if(f.media.fmts=s.videoCodecs.map(m=>m.payloadType.toString(10)),f.attributes.payloads=s.videoCodecs,f.attributes.extmaps=s.videoExtensions,ge("PRELOAD_MEDIA_COUNT")>0){let{ssrcs:m,ssrcGroups:E}=Bg([{ssrcId:VU,rtx:ge("USE_SUB_RTX")?40001:void 0}],this.cname);f.attributes.ssrcs=m,f.attributes.ssrcGroups=E}}if(f.media.mediaType==="audio"){if(s.audioCodecs.length===0){let m=l.audioCodecs.filter(E=>{var y,b;return(y=E.rtpMap)===null||y===void 0?void 0:ft(b=y.encodingName.toLowerCase()).call(b,"opus")})||[l.audioCodecs[0]];f.media.fmts=m.map(E=>E.payloadType.toString(10)),f.attributes.payloads=m,f.attributes.extmaps=[]}else if(f.media.fmts=s.audioCodecs.map(m=>m.payloadType.toString(10)),f.attributes.payloads=s.audioCodecs,f.attributes.extmaps=s.audioExtensions,ou(f),ge("PRELOAD_MEDIA_COUNT")>0){let{ssrcs:m,ssrcGroups:E}=Bg([{ssrcId:2e4}],this.cname);f.attributes.ssrcs=m,f.attributes.ssrcGroups=E}}}return this.sessionDesc=t,this.currentMidIndex=t.mediaDescriptions.length-1,this.sessionDesc}updateCandidates(e){let t=this._originCandidates.filter(s=>s.transport==="udp"),r=[];if(t.forEach(s=>{r.push($8($8({},s),{},{foundation:"tcpcandidate",priority:Number(s.priority)-1+"",transport:"tcp",port:Number(s.port)+90+""}))}),t.length!==0){switch(e){case hi.TCP_RELAY:this._candidates=r;break;case hi.UDP_TCP_RELAY:case hi.RELAY:this._candidates=[...t,...r];break;default:this._candidates=t}for(let s of this.sessionDesc.mediaDescriptions)s.attributes.candidates=this.candidates}}restartICE(e){e=Fn(e),this._iceParameters=e,this.sessionDesc.mediaDescriptions.forEach(t=>{t.attributes.iceUfrag=e.iceUfrag,t.attributes.icePwd=e.icePwd})}predictReceivingMids(e){let t=[];for(let r=0;r<e;r++)t.push((this.currentMidIndex+r+1).toString(10));return t}findAvailableMediaIndex(e,t){return this.sessionDesc.mediaDescriptions.findIndex(r=>{let s=r.media.mediaType===e&&r.media.port!=="0"&&(r.attributes.direction==="sendonly"||r.attributes.direction==="sendrecv")&&r.attributes.ssrcs.length===0;if(Ni()){if(s){let l=this.firefoxSsrcMidMap.get(t[0].ssrcId);return!(l||r.attributes.mid!=="0"&&r.attributes.mid!=="1")||!(!l||l!==r.attributes.mid)}return!1}return s})}createOrRecycleDataChannel(){for(let r of this.sessionDesc.mediaDescriptions)if(r.media.mediaType==="application")return{mediaDesc:r,needExchangeSDP:!1};this.currentMidIndex+=1;let e="".concat(this.currentMidIndex),t={media:{mediaType:"application",port:kI,protos:["UDP","DTLS","SCTP"],fmts:["webrtc-datachannel"]},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:[],fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:[],ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:[],rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,mid:"".concat(e),sctpPort:"5000"}};return this.sessionDesc.mediaDescriptions.push(t),{mediaDesc:t,needExchangeSDP:!0}}createOrRecycleRecvMedia(e,t,r,s,l,f){let m=e._mediaStreamTrack.kind,E=this.rtpCapabilities.recv,y=f1(m,E,this.localCapabilities.send,m===Tt.VIDEO?s:l),b=m===Tt.VIDEO?E.videoExtensions:E.audioExtensions;this.currentMidIndex+=1;let A="".concat(this.currentMidIndex),O={media:{mediaType:m,port:kI,protos:["UDP","TLS","RTP","SAVPF"],fmts:y.map(P=>P.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:b,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:t,ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:y,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:r,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(A)}};O=this.mungRecvMediaDsec(O,e,f);let D=this.findFirstClosedMedia(m);if(D){let P=this.sessionDesc.mediaDescriptions.indexOf(D);this.sessionDesc.mediaDescriptions[P]=O}else this.sessionDesc.mediaDescriptions.push(O);return O}updateRemoteCodec(e,t,r){let s=[...new Set(this._rtpCapabilities.recv.videoCodecs.map(O=>O.rtpMap&&O.rtpMap.encodingName.toLowerCase()||"").filter(O=>{var D;return ft(D=Object.keys(Gp)).call(D,O)}))],l=new Set(t);if(s.every(O=>l.has(O)))return z.debug("codecs has not changed, no need to updateRemoteCodec, codecs: ".concat(t)),!1;let f=this._rtpCapabilities.recv.videoCodecs.filter(O=>t.some(D=>{var P;return ft(P=O.rtpMap&&O.rtpMap.encodingName.toLowerCase()||"").call(P,D)}));if(f.length===0)return z.debug("updateRemoteCodec failed, because cannot find matched codec, remoteCapabilities codecs: ".concat(s," codecs: ").concat(t)),!1;let m=[...new Set(f.map(O=>O.rtpMap&&O.rtpMap.encodingName.toLowerCase()||""))],E;if(z.debug("updateRemoteCodec, from ".concat(s," to ").concat(m)),e.length===0)E=this.sessionDesc.mediaDescriptions.filter(O=>O.media.mediaType==="video"&&O.attributes.direction==="recvonly");else if(E=this.sessionDesc.mediaDescriptions.filter(O=>O.attributes.mid&&ft(e).call(e,O.attributes.mid)&&O.attributes.direction==="recvonly"),E.length!==e.length)return z.debug("updateRemoteCodec failed, because cannot find mids, mids: ".concat(e,", codecs: ").concat(t)),!1;if(ge("USE_PUB_RTX")||ge("USE_SUB_RTX")){let O=iD(f,this.rtpCapabilities.recv.videoCodecs);f.push(...O)}this._rtpCapabilities.recv.videoCodecs=f;let y=this.localCapabilities.send,b=this.rtpCapabilities.recv,A=f1(Tt.VIDEO,b,y,r);return E.forEach(O=>{let D=A.map(P=>P.payloadType.toString(10));z.debug("updateRemoteCodec mid: ".concat(O.attributes.mid,", from"),O.attributes.payloads,"to",A),O.attributes.payloads=A,O.media.fmts=D}),!0}createOrRecycleSendMedia(e,t,r,s,l){let f=this.rtpCapabilities.send,m=e===Tt.VIDEO?f.videoCodecs:f.audioCodecs,E=e===Tt.VIDEO?f.videoExtensions:f.audioExtensions;this.currentMidIndex+=1;let y="".concat(this.currentMidIndex),b={media:{mediaType:e,port:kI,protos:["UDP","TLS","RTP","SAVPF"],fmts:m.map(O=>O.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:E,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:t,ssrcGroups:r,rtcpFeedbackWildcards:[],payloads:m,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:s,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(y)}};b=this.mungSendMediaDesc(b,l);let A=this.findFirstClosedMedia(e);if(A){let O=this.sessionDesc.mediaDescriptions.indexOf(A);this.sessionDesc.mediaDescriptions[O]=b}else this.sessionDesc.mediaDescriptions.push(b);return b}updateBundleMids(){this.sessionDesc.attributes.groups[0].identificationTag=this.sessionDesc.mediaDescriptions.filter(e=>e.media.port!=="0").map(e=>e.attributes.mid)}mungRecvMediaDsec(e,t,r){let s=Fn(e);return u1(s),au(s,t),rD(s,t),AI(s),Fg(s,r,this.localCapabilities.send),s}mungSendMediaDesc(e,t){let r=Fn(e);return Fg(r,t,this.localCapabilities.recv),ou(r),r}updateRecvMedia(e,t){let r=this.sessionDesc.mediaDescriptions.findIndex(s=>s.attributes.mid===e);if(r!==-1){let s=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[r],t);this.sessionDesc.mediaDescriptions[r]=s}}bumpMid(e){this.currentMidIndex+=e}findFirstClosedMedia(e){return this.sessionDesc.mediaDescriptions.find(t=>Ni()?t.media.port==="0"&&t.media.mediaType===e:t.media.port==="0")}findPreloadMediaDesc(e){return this.sessionDesc.mediaDescriptions.find(t=>{var r;return((r=t.attributes)===null||r===void 0||(r=r.ssrcs[0])===null||r===void 0?void 0:r.ssrcId)===e[0].ssrcId})}getSSRC(e){var t;return(t=this.sessionDesc.mediaDescriptions.find(r=>r.attributes.mid===e))===null||t===void 0?void 0:t.attributes.ssrcs}}(Ih(Ih({},i),{},{localCapabilities:this.localCapabilities}),this.supportAV1RtpSpec),i.preallocation&&(this.isPreallocation=!0),Array.isArray(this.remoteCodecs)&&this.remoteCodecs.length>0&&this.remoteSDP.updateRemoteCodec([],this.remoteCodecs,this.store.codec);let u=this.remoteSDP.toString(),_=H_(this.initialOffer.sdp,this.extension),S=this.logSDPExchange(_||"","offer","local","connect");this.store.descriptionStart(),await this.peerConnection.setLocalDescription({type:"offer",sdp:_}),S==null||S(u),await this.peerConnection.setRemoteDescription({type:"answer",sdp:u});let C=this.peerConnection.getTransceivers()[0];if(C!=null&&C.receiver&&this.tryBindTransportEvents(C.receiver),ge("PRELOAD_MEDIA_COUNT")>0){this.remoteSDP.preloadRemoteMedia(ge("PRELOAD_MEDIA_COUNT"));let e=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:e});let t=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(t)}let{preSSRCs:R}=i;if(Array.isArray(R)&&R.length>0){let{mids:e}=this.remoteSDP.batchSend(R.map(t=>({kind:t.kind,ssrcMsg:[{ssrcId:t.ssrcId,rtx:t.rtx}],mslabel:t.mslabel})));e.forEach((t,r)=>{this.preSSRCMap.set(R[r].ssrcId,t)}),await h1(this.peerConnection,this.remoteSDP,this.extension),z.debug("[".concat(this.store.clientId,"] [P2PConnection] pre-batchReceive exchange SDP."))}}catch(u){throw new Ye(oe.EXCHANGE_SDP_FAILED,"P2PConnection.connect failed; ".concat(u.toString()))}var a,c}async updateRemoteConnect(i){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateRemoteConnect before remote SDP created");let{rtpCapabilities:a}=i;this.remoteSDP.updateRemoteRTPCapabilities(a),Array.isArray(this.remoteCodecs)&&this.remoteCodecs.length>0&&this.remoteSDP.updateRemoteCodec([],this.remoteCodecs,this.store.codec);let{preSSRCs:c}=i;if(Array.isArray(c)&&c.length>0){let{mids:u}=this.remoteSDP.batchSend(c.map(_=>Object.assign({},{kind:_.kind,ssrcMsg:[{ssrcId:_.ssrcId,rtx:_.rtx}],mslabel:_.mslabel})));u.forEach((_,S)=>{this.preSSRCMap.set(c[S].ssrcId,_)})}await h1(this.peerConnection,this.remoteSDP,this.extension),z.debug("[P2PConnection] updateRemoteRTPCapabilities by exchanging SDP.")}catch(a){throw new Ye(oe.EXCHANGE_SDP_FAILED,"P2PConnection.updateRemoteConnect failed; ".concat(a.toString()))}}send(i,a,c){var u=this;return Zl(function*(){let _=yield Kn(u.mutex.lock("From P2PConnection.send"));try{if(!u.remoteSDP)throw new Error("Cannot call P2PConnection.send before remote SDP created");let S=[],C=G_();i.forEach(E=>{let y=u.peerConnection.addTransceiver(E._mediaStreamTrack,Ih({direction:"sendonly"},E.trackMediaType==="video"&&u.supportAV1RtpSpec&&C?{sendEncodings:[{scalabilityMode:C}]}:{}));S.push(y),E._updateRtpTransceiver(y)}),Ni()&&ge("SIMULCAST")===!0&&(yield Kn(u.applySimulcastForFirefox(S,i)));let R=yield Kn(u.peerConnection.createOffer()),e=u.remoteSDP.predictReceivingMids(i.length),t=u.mungSendOfferSDP(R.sdp,i,e),r=Dn(t),s=e.map(E=>{let y=r.mediaDescriptions.find(b=>b.attributes.mid===E);if(!y)throw new Error("Cannot extract ssrc from mediaDescription.");return TU(y,ge("USE_PUB_RTX"))}),l;try{l=yield s}catch(E){l=[],u.remoteSDP.receive(i,a,c,l);let y=u.remoteSDP.toString();throw yield Kn(u.peerConnection.setLocalDescription({type:"offer",sdp:t})),yield Kn(u.peerConnection.setRemoteDescription({type:"answer",sdp:y})),yield Kn(u.stopSending(e,!0)),E}u.remoteSDP.receive(i,a,c,l);let f=u.remoteSDP.toString(),m=u.logSDPExchange(t,"offer","local","send");return yield Kn(u.peerConnection.setLocalDescription({type:"offer",sdp:t})),yield Kn(u.applySimulcastEncodings(S,i)),yield Kn(u.applySendEncodings(S,i)),m==null||m(f),yield Kn(u.peerConnection.setRemoteDescription({type:"answer",sdp:f})),S.map((E,y)=>{let b=e[y];return{localSSRC:s[y],id:b,transceiver:E}})}catch(S){throw S instanceof Ye?S:new Ye(oe.EXCHANGE_SDP_FAILED,"P2PConnection.send failed; ".concat(S.toString()))}finally{_()}})()}async createDataChannels(i,a){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.createDataChannels before remote SDP created");let c=this.dataStreamChannelMap.get(i);if(c&&c.readyState==="open")z.debug("[P2PConnection] Channels are already available and can be reused directly.");else{let _=this.currentDataChannelId<1023?this.currentDataChannelId++:this.recoveredDataChannelIds.shift();if(typeof _!="number")throw new Error("create DataChannel error, because cannot get dc id");c=this.peerConnection.createDataChannel("datastream-channel",{id:_,negotiated:!0,ordered:!1,maxRetransmits:ge("DATASTREAM_MAX_RETRANSMITS")}),c.binaryType="arraybuffer",this.dataStreamChannelMap.set(i,c)}a.forEach(_=>{_._updateOriginDataChannel(c)});let{needExchangeSDP:u}=this.remoteSDP.sendDataChannel();if(u){let _=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:_});let S=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(S),z.debug("[P2PConnection] createDataChannels by exchanging SDP.")}else z.debug("[P2PConnection] createDataChannels no need to exchange SDP.");return}catch(c){throw c instanceof Ye?c:new Ye(oe.EXCHANGE_SDP_FAILED,"P2PConnection.createDataChannels failed; ".concat(c.toString()))}}async stopDataChannels(i){try{let a=this.dataStreamChannelMap.get(i);return a&&(a.id&&this.recoveredDataChannelIds.push(a.id),a.close()),void this.dataStreamChannelMap.delete(i)}catch(a){throw a instanceof Ye?a:new Ye(oe.DATACHANNEL_FAILED,"P2PConnection.stopDataChannels failed; ".concat(a.toString()))}}async stopSending(i,a){let c=a?void 0:await this.mutex.lock("From P2PConnection.stopSending");try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopSending before remote SDP created");let u=this.peerConnection.getTransceivers().filter(R=>i.indexOf(R.mid)!==-1);if(u.length!==i.length)throw new Error("Transceivers' length doesn't match mids' length when trying to call P2PConnection.stopSending.");u.map(R=>{var e;VI(this.id+R.mid,this),R.direction="inactive",(e=R.stop)===null||e===void 0||e.call(R)});let _=await this.peerConnection.createOffer(),S=this.logSDPExchange(_.sdp||"","offer","local","stopSending");await this.peerConnection.setLocalDescription(_),this.remoteSDP.stopReceiving(i);let C=this.remoteSDP.toString();S==null||S(C),await this.peerConnection.setRemoteDescription({type:"answer",sdp:C})}catch(u){throw new Ye(oe.EXCHANGE_SDP_FAILED,"P2PConnection.stopSending failed; ".concat(u.toString()))}finally{c&&c()}}async receive(i,a,c,u){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(i," before remoteSDP created."));let{mid:_,needExchangeSDP:S}=this.remoteSDP.send(i,a,c,u);S&&(await h1(this.peerConnection,this.remoteSDP,this.extension),z.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(i," by exchanging SDP.")));let C=this.peerConnection.getTransceivers().find(R=>R.mid===_);if(!C)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:C.receiver.track,id:_,transceiver:C}}catch(_){throw new Ye(oe.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(_.toString()))}}async batchReceive(i){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.batchReceive before remoteSDP created.");let{mids:a,needExchangeSDP:c}=this.remoteSDP.batchSend(i);return c&&(await h1(this.peerConnection,this.remoteSDP,this.extension),z.debug("[".concat(this.store.clientId,"] [P2PConnection] batchReceive by exchanging SDP."))),a.map(u=>{let _=this.peerConnection.getTransceivers().find(S=>S.mid===u);if(!_)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:_.receiver.track,id:u,transceiver:_}})}catch(a){throw new Ye(oe.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(a.toString()))}}async stopReceiving(i){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");i.forEach(_=>{Array.from(this.preSSRCMap.entries()).some(S=>{let[C,R]=S;if(R===_)return this.preSSRCMap.delete(C),!0})}),this.remoteSDP.stopSending(i);let a=this.remoteSDP.toString(),c=this.logSDPExchange(a,"offer","remote","stopReceiving");await this.peerConnection.setRemoteDescription({type:"offer",sdp:a});let u=await this.peerConnection.createAnswer();c==null||c(u.sdp||""),await this.peerConnection.setLocalDescription(u)}catch(a){throw new Ye(oe.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(a.toString()))}}async muteRemote(i){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteRemote mid=".concat(i," before remote SDP created."));this.remoteSDP.mute(i);let a=this.remoteSDP.toString(),c=this.logSDPExchange(a,"offer","remote","muteRemote");await this.peerConnection.setRemoteDescription({type:"offer",sdp:a});let u=await this.peerConnection.createAnswer();c==null||c(u.sdp||""),await this.peerConnection.setLocalDescription(u)}catch(a){throw new Ye(oe.EXCHANGE_SDP_FAILED,"P2PConnection.muteRemote failed; ".concat(a.toString()))}}async unmuteRemote(i){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteRemote mid=".concat(i," before remote SDP created."));this.remoteSDP.unmute(i);let a=this.remoteSDP.toString(),c=this.logSDPExchange(a,"offer","remote","unmuteRemote");await this.peerConnection.setRemoteDescription({type:"offer",sdp:a});let u=await this.peerConnection.createAnswer();c==null||c(u.sdp||""),await this.peerConnection.setLocalDescription(u)}catch(a){throw new Ye(oe.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteRemote failed; ".concat(a.toString()))}}async muteLocal(i){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteLocal before remote SDP created.");let a=this.peerConnection.getTransceivers().filter(S=>S.mid&&i.indexOf(S.mid)!==-1);if(a.length!==i.length)throw new Error("Transceivers' length doesn't match mids' length.");a.map(S=>{S.direction="inactive"});let c=await this.peerConnection.createOffer(),u=this.logSDPExchange(c.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(c),this.remoteSDP.muteRemote(i);let _=this.remoteSDP.toString();u==null||u(_),await this.peerConnection.setRemoteDescription({type:"answer",sdp:_})}catch(a){throw new Ye(oe.EXCHANGE_SDP_FAILED,"P2PConnection.muteLocal failed; ".concat(a.toString()))}}async unmuteLocal(i){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteLocal before remote SDP created.");let a=this.peerConnection.getTransceivers().filter(S=>S.mid&&i.indexOf(S.mid)!==-1);if(a.length!==i.length)throw new Error("Transceivers' length doesn't match mids' length.");a.map(async(S,C)=>{S.direction="sendonly"});let c=await this.peerConnection.createOffer(),u=this.logSDPExchange(c.sdp||"","offer","local","unmuteLocal");await this.peerConnection.setLocalDescription(c),this.remoteSDP.unmuteRemote(i),Array.isArray(this.remoteCodecs)&&this.remoteCodecs.length>0&&this.remoteSDP.updateRemoteCodec(i,this.remoteCodecs,this.store.codec);let _=this.remoteSDP.toString();u==null||u(_),await this.peerConnection.setRemoteDescription({type:"answer",sdp:_})}catch(a){throw new Ye(oe.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteLocal failed; ".concat(a.toString()))}}restartICE(i){var a=this;return Zl(function*(){let c=yield Kn(a.mutex.lock("From P2PConnection.restartICE"));try{if(!a.remoteSDP)throw new Error("Cannot restartICE before remoteSDP created.");let u=Un().supportPCSetConfiguration,_=ge("FORCE_TURN_TCP")||a.forceTurn;if(i===hi.RELAY&&!u)return;if(u&&!_){let r=i===hi.RELAY?"relay":"all",s=a.peerConnection.getConfiguration();s.iceTransportPolicy!==r&&(z.debug("[".concat(a.store.clientId,"] restartICE change iceTransportPolicy from [").concat(s.iceTransportPolicy,"] to [").concat(r,"]")),s.iceTransportPolicy=r,a.peerConnection.setConfiguration(s))}a.remoteSDP.updateCandidates(i);let S=yield Kn(a.peerConnection.createOffer({iceRestart:!0}));if(!S.sdp)throw new Error("Cannot restartICE because restart offer SDP does not exist.");let C=Vg(S.sdp),{remoteIceParameters:R}=yield C.iceParameters;a.remoteSDP.restartICE(R);let e=a.remoteSDP.toString(),t=a.logSDPExchange(S.sdp||"","offer","local","restartICE");a.store.descriptionStart(),yield Kn(a.peerConnection.setLocalDescription(S)),t==null||t(e),yield Kn(a.peerConnection.setRemoteDescription({type:"answer",sdp:e}))}catch(u){z.warning("[".concat(a.store.clientId,"] restart ICE failed, abort operation"),u)}finally{c()}})()}async extendCandidate(){if(!this.remoteSDP||this.isFirstConnected)return;let i=await this.mutex.lock("From P2PConnection.extendCandidate");try{this.remoteSDP.updateCandidates(hi.TCP_RELAY),await h1(this.peerConnection,this.remoteSDP,this.extension)}catch(a){z.warning("[".concat(this.store.clientId,"] extend candidate failed, abort operation"),a)}finally{i()}}close(){var i;this.peerConnection.getTransceivers().forEach(a=>{VI(this.id+a.mid,this)}),this.preSSRCMap.clear(),this.peerConnection.close(),(i=this.onConnectionStateChange)===null||i===void 0||i.call(this,"closed"),this.tryUnbindTransportEvents(),this.unbindPCEvents(),this.unbindStatsEvents(),this.removeAllListeners(),this.transportEventReceiver=void 0,this.statsFilter.destroy(),this.dataStreamChannelMap.clear(),this.recoveredDataChannelIds=[],this.currentDataChannelId=1}getStats(){return Ih(Ih({},this.statsFilter.getStats()),{},{qualityLimitationReason:this.qualityLimitationReason})}getRemoteVideoIsReady(i){return this.statsFilter.getVideoIsReady(i)}async updateEncoderConfig(i,a){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateEncoderConfig before remote SDP created.");let c=await this.peerConnection.createOffer(),u=this.mungSendOfferSDP(c.sdp,[a],[i]);this.remoteSDP.updateRecvMedia(i,a);let _=this.remoteSDP.toString(),S=this.logSDPExchange(u,"offer","local","updateEncoderConfig");await this.peerConnection.setLocalDescription({type:"offer",sdp:u}),S==null||S(_),await this.peerConnection.setRemoteDescription({type:"answer",sdp:_})}catch(c){throw new Ye(oe.EXCHANGE_SDP_FAILED,c.toString())}}async updateSendParameters(i,a){let c=this.peerConnection.getTransceivers().filter(u=>u.mid===i);c.length===1&&(this.isVP8Simulcast(a)?Ni()||await this.applySimulcastEncodings(c,[a]):await this.applySendEncodings(c,[a]))}setStatsRemoteVideoIsReady(i,a){this.statsFilter.setVideoIsReady2(i,a)}async replaceTrack(i,a){let c=this.peerConnection.getTransceivers().find(u=>u.mid===a);c&&await c.sender.replaceTrack(i._mediaStreamTrack)}async getSelectedCandidatePair(){let i=this.peerConnection.getReceivers();if(i.length>0&&i[0].transport&&i[0].transport.iceTransport&&i[0].transport.iceTransport.getSelectedCandidatePair&&i[0].transport.iceTransport.getSelectedCandidatePair()){let a=i[0].transport.iceTransport,{local:c,remote:u}=a.getSelectedCandidatePair();return{local:Ih(Ih({},Qu),{},{candidateType:c.type,protocol:c.protocol,address:c.address,port:c.port}),remote:Ih(Ih({},Qu),{},{candidateType:u.type,protocol:u.protocol,address:u.address,port:u.port})}}return this.statsFilter.getSelectedCandidatePair()}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var i;(i=this.onICEConnectionStateChange)===null||i===void 0||i.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var i;this.peerConnection.connectionState==="connected"&&(this.isFirstConnected=!0),(i=this.onConnectionStateChange)===null||i===void 0||i.call(this,this.peerConnection.connectionState)},this.peerConnection.onicecandidateerror=i=>{if(i&&(i.errorCode||i.errorText)){var a;let c="code: ".concat(i.errorCode,", message: ").concat(i.errorText),u=i.port?"local: ".concat(i.port):"";z.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICECandidateError(").concat(c,"), url: ").concat(i.url||"",", host_candidate:").concat(u)),(a=this.onICECandidateError)===null||a===void 0||a.call(this,c)}},this.peerConnection.onicegatheringstatechange=i=>{i&&i.target&&"iceGatheringState"in i.target&&z.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] RTCPeerConnection.onicegatheringstatechange(").concat(i.target.iceGatheringState,")"))},this.peerConnection.onicecandidate=i=>{i.candidate?this.localCandidateCount+=1:(this.peerConnection.onicecandidate=null,this.allCandidatesReceived=!0,z.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount))},setTimeout(()=>{this.allCandidatesReceived||(this.allCandidatesReceived=!0,z.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] onicecandidate timeout, local candidate count"),this.localCandidateCount))},ge("CANDIDATE_TIMEOUT"))}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(i){let a={iceServers:[]};return i.iceServers?a.iceServers=i.iceServers:i.turnServer&&(vS(i.turnServer.servers)?a.iceServers=i.turnServer.servers:ge("NEW_TURN_MODE")&&a.iceServers?(ge("USE_TURN_SERVER_OF_GATEWAY")?i.turnServer.serversFromGateway&&a.iceServers.push(...AA.newTurnServerConfigToIceServers(i.turnServer.serversFromGateway)):a.iceServers.push(...AA.newTurnServerConfigToIceServers(i.turnServer.servers)),ge("NEW_FORCE_TURN")&&(a.iceTransportPolicy="relay")):i.turnServer.mode!=="off"&&(a.iceServers&&a.iceServers.push(...AA.turnServerConfigToIceServers(i.turnServer.servers)),ge("USE_TURN_SERVER_OF_GATEWAY")&&a.iceServers&&i.turnServer.serversFromGateway&&a.iceServers.push(...AA.turnServerConfigToIceServers(i.turnServer.serversFromGateway)),ge("FORCE_TURN_TCP")?a.iceTransportPolicy="relay":i.turnServer.servers.concat(i.turnServer.serversFromGateway||[]).forEach(c=>{c.forceturn&&(a.iceTransportPolicy="relay")}))),ge("ENABLE_ENCODED_TRANSFORM")&&Un().supportWebRTCEncodedTransform&&(a.encodedInsertableStreams=!0),a}static turnServerConfigToIceServers(i){let a=[];return i.forEach(c=>{c.security?c.tcpport&&a.push({username:c.username,credential:c.password,credentialType:"password",urls:"turns:".concat(F_(c.turnServerURL),":").concat(c.tcpport,"?transport=tcp")}):(c.udpport&&!ge("FORCE_TURN_TCP")&&a.push({username:c.username,credential:c.password,credentialType:"password",urls:"turn:".concat(c.turnServerURL,":").concat(c.udpport,"?transport=udp")}),c.tcpport&&a.push({username:c.username,credential:c.password,credentialType:"password",urls:"turn:".concat(c.turnServerURL,":").concat(c.tcpport,"?transport=tcp")}))}),a}static newTurnServerConfigToIceServers(i){let a=[];return i.forEach(c=>{let u=ge("NEW_TURN_MODE");u===1?a.push({username:c.username,credential:c.password,credentialType:"password",urls:"turn:".concat(c.turnServerURL,":3478?transport=udp")}):u===2?a.push({username:c.username,credential:c.password,credentialType:"password",urls:"turn:".concat(c.turnServerURL,":3478?transport=tcp")}):u===3?a.push({username:c.username,credential:c.password,credentialType:"password",urls:"turns:".concat(F_(c.turnServerURL),":443?transport=tcp")}):u===4&&(a.push({username:c.username,credential:c.password,credentialType:"password",urls:"turn:".concat(c.turnServerURL,":3478?transport=udp")}),a.push({username:c.username,credential:c.password,credentialType:"password",urls:"turn:".concat(c.turnServerURL,":3478?transport=tcp")}),a.push({username:c.username,credential:c.password,credentialType:"password",urls:"turns:".concat(F_(c.turnServerURL),":443?transport=tcp")}))}),a}tryBindTransportEvents(i){let a=i.transport;if(a){this.transportEventReceiver=i,a.onstatechange=()=>{var u;a!=null&&a.state&&((u=this.onDTLSTransportStateChange)===null||u===void 0||u.call(this,a.state))},a.onerror=u=>{var _;(_=this.onDTLSTransportError)===null||_===void 0||_.call(this,"error"in u?u.error:u)};let c=a.iceTransport;c&&(c.onstatechange=()=>{let u=a==null?void 0:a.iceTransport.state;var _;u&&((_=this.onICETransportStateChange)===null||_===void 0||_.call(this,u))},c.getSelectedCandidatePair&&(c.onselectedcandidatepairchange=()=>{if(c.getSelectedCandidatePair()){let{local:u,remote:_}=c.getSelectedCandidatePair();z.info("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] selectedcandidatepairchange: local ").concat(JSON.stringify({candidateType:u.type,protocol:u.protocol}),", remote ").concat(JSON.stringify({candidateType:_.type,protocol:_.protocol,address:_.address,port:_.port})," )"))}}))}}tryUnbindTransportEvents(){this.transportEventReceiver&&this.transportEventReceiver.transport&&(this.transportEventReceiver.transport.onstatechange=null,this.transportEventReceiver.transport.onerror=null,this.transportEventReceiver.transport.iceTransport&&(this.transportEventReceiver.transport.iceTransport.onstatechange=null))}async updateRtpSenderEncodings(i,a){var c,u;if(a||(a=this.peerConnection.getSenders().find(m=>m.track===i._mediaStreamTrack)),!a)return z.warn("[".concat(i.getTrackId(),"] no rtpSender found}"));if(this.isVP8Simulcast(i))return z.warn("[updateRtpSenderEncodings] Track is VP8 simulcast, please apply simulcast encodings");if(!Un().supportSetRtpSenderParameters)return z.warn("[updateRtpSenderEncodings] Browser not support set rtp-sender parameters");let _={},S={};switch(i._optimizationMode){case"motion":_.degradationPreference="maintain-framerate";break;case"detail":_.degradationPreference="maintain-resolution";break;case"balanced":_.degradationPreference="balanced"}let C=function(m,E){return m.getTransceivers().find(y=>y.sender.track===E||y.receiver.track===E)}(this.peerConnection,i._mediaStreamTrack),R=dc(i);if(K_(i)&&C&&a&&R&&this.getLocalVideoStats&&ft(c=["vp8","vp9"]).call(c,this.store.codec)){var e;let m=_.degradationPreference||(ft(e=i._hints).call(e,kr.CUSTOM_TRACK)?ge("CUSTOM_ADAPTATION_DEFAULT_MODE"):"maintain-framerate");(function(E,y,b,A,O,D){if(VI(E,b),O(y),A!=="balanced"&&A!=="maintain-framerate"&&A!=="maintain-resolution")return;let P=-1;BU(E,y);let F=window.setInterval(()=>{let Y=jI.get(E);if(!ge("ENABLE_AG_ADAPTATION")||!Y)return VI(E,b),void O(y);let $=D();if($.sendPackets>0&&$.OutgoingAvailableBandwidth>0){if(P===-1)return void(P=Date.now());if(Date.now()-P<1e3)return;let ee=$.sendFrameRate,Ee=$.OutgoingAvailableBandwidth,[Re,Ie]=UI(E,ee,Ee,Y.adaptationConfig,y,A);Ie&&(b.qualityLimitationReason=Ie),Re&&Y.adaptationConfig.scale!==Re.scale&&(z.debug("[".concat(E,"] applyAdaptation: ").concat(b.qualityLimitationReason,`
           sendFps `).concat(ee,", bwe ").concat(Ee,", switch from ").concat(Y.adaptationConfig.scale," to ").concat(Re.scale," ")),Y.adaptationConfig=mD(mD({},Y.adaptationConfig),Re),O(Re))}},ge("CHECK_LOCAL_STATS_INTERVAL")),B=mD({},y);jI.set(E,{timer:F,adaptationConfig:B,originConfig:y,adaptationFunc:O}),z.debug("[".concat(E,"] start adaptation, originConfig: ").concat(JSON.stringify(y),", degradationPreference: ").concat(A))})(this.id+C.mid,R,this,m,E=>{a&&this.updateAdaptation(a,E)},this.getLocalVideoStats.bind(this))}if(i._encoderConfig){var t;let{bitrateMax:m,frameRate:E,scaleResolutionDownBy:y}=i._encoderConfig;m&&(S.maxBitrate=1e3*m),(ft(t=i._hints).call(t,kr.LOW_STREAM)||i.isUseScaleResolutionDownBy)&&(E&&(S.maxFramerate=Al(E)),y&&y>=1&&(S.scaleResolutionDownBy=y))}let{maxFramerate:r}=ge("ENCODER_CONFIG_LIMIT");if(r&&typeof r=="number"&&(S.maxFramerate=S.maxFramerate?Math.min(S.maxFramerate,r):r),ge("DSCP_TYPE")&&jp()){var s;let m=ge("DSCP_TYPE");ft(s=["very-low","low","medium","high"]).call(s,m)&&(S.networkPriority=m)}let l=a.getParameters(),f=(u=l.encodings)===null||u===void 0?void 0:u[0];Ni()&&!f&&(_.encodings=[S]),f&&Object.assign(f,S),Object.assign(l,_),z.debug("[".concat(i.getTrackId(),"] updateRtpSenderEncodings: ").concat(JSON.stringify(l.encodings))),await a.setParameters(l),await async function(m,E,y){try{var b;if(!Un().supportSetRtpSenderParameters||!function(F){return F==="vp9"||F==="av1"}(m)||!ge("ENABLE_SVC"))return;let A={},O={},D=E.getParameters(),P=(b=D.encodings)===null||b===void 0?void 0:b[0];O.scalabilityMode=G_(y),P&&Object.assign(P,O),Object.assign(D,A),await E.setParameters(D),z.debug("[updateAdaptation] updateRtpSenderEncodings scalabilityMode success: ".concat(JSON.stringify(D.encodings)))}catch(A){z.debug("[updateAdaptation] updateRtpSenderEncodings scalabilityMode failed",A)}}(this.store.codec,a,ge("SVC_MODE"))}async updateAdaptation(i,a){var c,u;if(!i)return z.debug("[updateAdaptation] no rtpSender found");if(!Un().supportSetRtpSenderParameters)return z.debug("[updateAdaptation] Browser not support set rtp-sender parameters");let _={},{bitrateMax:S,frameRate:C,scaleResolutionDownBy:R}=a;S&&(_.maxBitrate=1e3*S),C&&(_.maxFramerate=Al(C)),R&&R>=1&&ft(c=["vp8","vp9"]).call(c,this.store.codec)&&(_.scaleResolutionDownBy=R);let e=i.getParameters(),t=(u=e.encodings)===null||u===void 0?void 0:u[0];t&&Object.assign(t,_),Object.assign(e,{});try{await i.setParameters(e),z.debug("[updateAdaptation] updateRtpSenderEncodings: ".concat(JSON.stringify(e.encodings)))}catch(r){!("transport"in i)||i.transport&&i.transport.state==="connected"?this.peerConnectionState!=="connected"?z.debug("[updateAdaptation] peerConnection not connected}"):z.debug("[updateAdaptation] updateRtpSenderEncodings failed",r):z.debug("[updateAdaptation] rtpSender transport not connected}")}}async applySendEncodings(i,a){try{if(!Un().supportSetRtpSenderParameters||i.length!==a.length)return;for(let c=0;c<i.length;c++){let u=i[c],_=a[c];_ instanceof ni&&!this.isVP8Simulcast(_)&&await this.updateRtpSenderEncodings(_,u.sender)}}catch{z.debug("[".concat(this.store.clientId,"] Apply RTPSendEncodings failed."))}}mungSendOfferSDP(i,a,c){let u=Dn(i);return a.forEach((_,S)=>{let C=c[S],R=u.mediaDescriptions.find(e=>e.attributes.mid===C);R&&(au(R,_),CU(R,_,this.store.codec))}),me(u)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=i=>{var a;(a=this.onFirstAudioReceived)===null||a===void 0||a.call(this,i)},this.statsFilter.onFirstVideoReceived=i=>{var a;(a=this.onFirstVideoReceived)===null||a===void 0||a.call(this,i)},this.statsFilter.onFirstAudioDecoded=i=>{var a;(a=this.onFirstAudioDecoded)===null||a===void 0||a.call(this,i)},this.statsFilter.onFirstVideoDecoded=(i,a,c)=>{var u;(u=this.onFirstVideoDecoded)===null||u===void 0||u.call(this,i,a,c)},this.statsFilter.onSelectedLocalCandidateChanged=(i,a)=>{var c;(c=this.onSelectedLocalCandidateChanged)===null||c===void 0||c.call(this,i,a)},this.statsFilter.onSelectedRemoteCandidateChanged=(i,a)=>{var c;(c=this.onSelectedRemoteCandidateChanged)===null||c===void 0||c.call(this,i,a)},this.statsFilter.onFirstVideoDecodedTimeout=i=>{var a;(a=this.onFirstVideoDecodedTimeout)===null||a===void 0||a.call(this,i)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0,this.statsFilter.onFirstVideoDecodedTimeout=void 0}async applySimulcastForFirefox(i,a){if(i.length===a.length)for(let R=0;R<i.length;R++){var c,u,_,S,C;let e=i[R],t=a[R];if(t instanceof ni&&!ft(c=t._hints).call(c,kr.LOW_STREAM)&&(u=t._encoderConfig)!==null&&u!==void 0&&u.bitrateMax&&((_=t._encoderConfig)===null||_===void 0?void 0:_.bitrateMax)>200&&(S=t._scalabilityMode)!==null&&S!==void 0&&S.numSpatialLayers&&((C=t._scalabilityMode)===null||C===void 0?void 0:C.numSpatialLayers)>1&&this.store.codec==="vp8"){let r={},s={high:1e3*(t._encoderConfig.bitrateMax-50),medium:5e4};r.encodings=[{rid:"m",active:!0,maxBitrate:s.medium,scaleResolutionDownBy:4},{rid:"h",active:!0,maxBitrate:s.high}];let l=e.sender.getParameters();await e.sender.setParameters(Object.assign(l,r))}}}async applySimulcastEncodings(i,a){if(!Ni()&&i.length===a.length)for(let c=0;c<i.length;c++){let u=a[c];if(u instanceof ni&&this.isVP8Simulcast(u)){let _=i[c],S={},C={high:1e3*(u._encoderConfig.bitrateMax-50),medium:5e4};S.encodings=[{active:!0,adaptivePtime:!1,networkPriority:"high",priority:"high",maxBitrate:C.high},{active:!0,adaptivePtime:!1,networkPriority:"low",priority:"low",maxBitrate:C.medium,scaleResolutionDownBy:4}];let R=_.sender.getParameters();await _.sender.setParameters(Object.assign(R,S))}}}isVP8Simulcast(i){var a,c,u,_,S;return!!(i instanceof ni&&ge("SIMULCAST")&&this.store.codec==="vp8"&&!ft(a=i._hints).call(a,kr.LOW_STREAM)&&(c=i._encoderConfig)!==null&&c!==void 0&&c.bitrateMax&&((u=i._encoderConfig)===null||u===void 0?void 0:u.bitrateMax)>200&&(_=i._scalabilityMode)!==null&&_!==void 0&&_.numSpatialLayers&&((S=i._scalabilityMode)===null||S===void 0?void 0:S.numSpatialLayers)>1)}logSDPExchange(i,a,c,u){if(ge("SDP_LOGGING"))return z.upload("[".concat(this.store.clientId,"] exchanging ").concat(c," ").concat(a," SDP during P2PConnection.").concat(u,`
`),i),a==="offer"?_=>{this.logSDPExchange(_,"answer",c==="local"?"remote":"local",u)}:void 0}async getRemoteSSRC(i){if(!this.remoteSDP)return;let a=this.remoteSDP.getSSRC(i);return a&&a.length!==0?a[0].ssrcId:void 0}setConfiguration(i){if(Un().supportPCSetConfiguration){let a=AA.resolvePCConfiguration(i);this.peerConnection.setConfiguration(a)}}},Ut(Wn.prototype,"updateRemoteRTPCapabilities",[wo],Object.getOwnPropertyDescriptor(Wn.prototype,"updateRemoteRTPCapabilities"),Wn.prototype),Ut(Wn.prototype,"connect",[wo],Object.getOwnPropertyDescriptor(Wn.prototype,"connect"),Wn.prototype),Ut(Wn.prototype,"updateRemoteConnect",[wo],Object.getOwnPropertyDescriptor(Wn.prototype,"updateRemoteConnect"),Wn.prototype),Ut(Wn.prototype,"createDataChannels",[wo],Object.getOwnPropertyDescriptor(Wn.prototype,"createDataChannels"),Wn.prototype),Ut(Wn.prototype,"receive",[wo],Object.getOwnPropertyDescriptor(Wn.prototype,"receive"),Wn.prototype),Ut(Wn.prototype,"batchReceive",[wo],Object.getOwnPropertyDescriptor(Wn.prototype,"batchReceive"),Wn.prototype),Ut(Wn.prototype,"stopReceiving",[wo],Object.getOwnPropertyDescriptor(Wn.prototype,"stopReceiving"),Wn.prototype),Ut(Wn.prototype,"muteRemote",[wo],Object.getOwnPropertyDescriptor(Wn.prototype,"muteRemote"),Wn.prototype),Ut(Wn.prototype,"unmuteRemote",[wo],Object.getOwnPropertyDescriptor(Wn.prototype,"unmuteRemote"),Wn.prototype),Ut(Wn.prototype,"muteLocal",[wo],Object.getOwnPropertyDescriptor(Wn.prototype,"muteLocal"),Wn.prototype),Ut(Wn.prototype,"unmuteLocal",[wo],Object.getOwnPropertyDescriptor(Wn.prototype,"unmuteLocal"),Wn.prototype),Ut(Wn.prototype,"close",[wo],Object.getOwnPropertyDescriptor(Wn.prototype,"close"),Wn.prototype),Ut(Wn.prototype,"updateEncoderConfig",[wo],Object.getOwnPropertyDescriptor(Wn.prototype,"updateEncoderConfig"),Wn.prototype),Ut(Wn.prototype,"updateSendParameters",[wo],Object.getOwnPropertyDescriptor(Wn.prototype,"updateSendParameters"),Wn.prototype),Ut(Wn.prototype,"replaceTrack",[wo],Object.getOwnPropertyDescriptor(Wn.prototype,"replaceTrack"),Wn.prototype),Ut(Wn.prototype,"updateAdaptation",[wo],Object.getOwnPropertyDescriptor(Wn.prototype,"updateAdaptation"),Wn.prototype),Ut(Wn.prototype,"getRemoteSSRC",[wo],Object.getOwnPropertyDescriptor(Wn.prototype,"getRemoteSSRC"),Wn.prototype),Wn);function wo(n,i,a){let c=n[i];if(typeof c!="function")throw new Error("Cannot use mutex on object property.");return a.value=async function(){let u=this.mutex,_=await u.lock("From P2PConnection.".concat(i));try{for(var S=arguments.length,C=new Array(S),R=0;R<S;R++)C[R]=arguments[R];return await c.apply(this,C)}finally{_()}},a}function HU(n,i){let a=document.createElement("video"),c=document.createElement("canvas");a.setAttribute("style","display:none"),c.setAttribute("style","display:none"),a.setAttribute("muted",""),a.muted=!0,a.setAttribute("autoplay",""),a.autoplay=!0,a.setAttribute("playsinline",""),c.width=Al(i.width),c.height=Al(i.height);let u=Al(i.framerate||15);document.body.append(a),document.body.append(c);let _=n._mediaStreamTrack;a.srcObject=new MediaStream([_]),a.play();let S=c.getContext("2d");if(!S)throw new De(oe.UNEXPECTED_ERROR,"can not get canvas context");let C=Un(),R=c.captureStream(C.supportRequestFrame?0:u).getVideoTracks()[0];R.canvas||(R.canvas=c),c.startCapture=()=>{if(!a)return c.stopCapture&&c.stopCapture();if(a.paused&&a.play(),a.videoHeight>2&&a.videoWidth>2){let t=a.videoWidth,r=a.videoHeight/t,s=c.width*r;Math.abs(s-c.height)>=2&&(z.debug("adjust low stream resolution","".concat(c.width,"x").concat(c.height," -> ").concat(c.width,"x").concat(s)),c.height=s)}S.drawImage(a,0,0,c.width,c.height),R.requestFrame&&R.requestFrame(),_!==n._mediaStreamTrack&&(_=n._mediaStreamTrack,a.srcObject=new MediaStream([_]))},c.stopCapture=jn(()=>c.startCapture&&c.startCapture(),u);let e=R.stop;return R.stop=()=>{e.call(R),a&&(a.remove(),a.srcObject=null,a=null),c&&(c.width=0,c.remove(),c.stopCapture&&c.stopCapture(),c.startCapture=void 0,c.stopCapture=void 0,c=null),z.debug("clean low stream renderer")},R}var BS=function(n){return n[n.HEIGHT=2033]="HEIGHT",n[n.FRAME_RATE=2034]="FRAME_RATE",n[n.WIDTH=2035]="WIDTH",n}(BS||{}),Yi=function(n){return n[n.FRAME_RATE=2002]="FRAME_RATE",n[n.WIDTH=2003]="WIDTH",n[n.HEIGHT=2004]="HEIGHT",n[n.PACKAGE_LOST=2005]="PACKAGE_LOST",n[n.AVG_ENCODE=2007]="AVG_ENCODE",n[n.NACKS=2009]="NACKS",n[n.PLIS=2010]="PLIS",n[n.FIRS=2011]="FIRS",n[n.BITRATE=2012]="BITRATE",n[n.PACKAGE_RATE=2031]="PACKAGE_RATE",n[n.ADAPTATION=2032]="ADAPTATION",n[n.ACTUAL_ENCODED=2060]="ACTUAL_ENCODED",n[n.BANDWIDTH=2061]="BANDWIDTH",n[n.RETRANSMIT=2062]="RETRANSMIT",n[n.TARGET_ENCODED=2064]="TARGET_ENCODED",n[n.TRANSMIT=2066]="TRANSMIT",n[n.FREEZE=2082]="FREEZE",n[n.DISABLED=2095]="DISABLED",n[n.PLAYER_STATUS=2128]="PLAYER_STATUS",n[n.QP_SUM=2143]="QP_SUM",n[n.BYTES_RETRANSMIT=2173]="BYTES_RETRANSMIT",n[n.PACKAGES_RETRANSMIT=2172]="PACKAGES_RETRANSMIT",n[n.HUGE_FRAME_SENT=2174]="HUGE_FRAME_SENT",n[n.KEY_FRAMES_ENCODED=2207]="KEY_FRAMES_ENCODED",n}(Yi||{}),FS=function(n){return n[n.BITRATE=2069]="BITRATE",n[n.PACKAGE_LOST=2070]="PACKAGE_LOST",n[n.PACKAGE_RATE=2071]="PACKAGE_RATE",n[n.HEIGHT=2073]="HEIGHT",n[n.FRAME_RATE=2075]="FRAME_RATE",n[n.WIDTH=2077]="WIDTH",n}(FS||{}),Qi=function(n){return n[n.JITTER=-1]="JITTER",n[n.PACKAGE_LOST=2014]="PACKAGE_LOST",n[n.WIDTH=2018]="WIDTH",n[n.HEIGHT=2019]="HEIGHT",n[n.FRAME_RATE=2020]="FRAME_RATE",n[n.JITTER_BUFFER=2023]="JITTER_BUFFER",n[n.CURRENT_DELAY=2024]="CURRENT_DELAY",n[n.NACKS=2026]="NACKS",n[n.PLIS=2027]="PLIS",n[n.FIRS=2028]="FIRS",n[n.BITRATE=2029]="BITRATE",n[n.PACKAGE_RATE=2078]="PACKAGE_RATE",n[n.FREEZE=2084]="FREEZE",n[n.DISABLED=2101]="DISABLED",n[n.PLAYER_STATUS=2129]="PLAYER_STATUS",n[n.QP_SUM=2144]="QP_SUM",n[n.I_FRAME_DELAY=2149]="I_FRAME_DELAY",n[n.FRAMES_DROPPED=2181]="FRAMES_DROPPED",n[n.BYTES_RETRANSMIT=2175]="BYTES_RETRANSMIT",n[n.PACKAGES_RETRANSMIT=2176]="PACKAGES_RETRANSMIT",n[n.PACKAGES_DISCARDED=2198]="PACKAGES_DISCARDED",n[n.AVG_DECODE=2200]="AVG_DECODE",n[n.AVG_PROCESSING_DELAY=2202]="AVG_PROCESSING_DELAY",n[n.AVG_ASSEMBLY_TIME=2203]="AVG_ASSEMBLY_TIME",n[n.AVG_INTER_FRAME_DELAY=2204]="AVG_INTER_FRAME_DELAY",n[n.KEY_FRAMES_DECODED=2206]="KEY_FRAMES_DECODED",n}(Qi||{}),qg=function(n){return n[n.FRAME_RATE_DECODE=2021]="FRAME_RATE_DECODE",n[n.FRAME_RATE_RENDER=2022]="FRAME_RATE_RENDER",n[n.FRAME_RATE_OUTPUT=2155]="FRAME_RATE_OUTPUT",n[n.FREEZE_TIME=2109]="FREEZE_TIME",n[n.FREEZE_TIME_RENDER=2147]="FREEZE_TIME_RENDER",n[n.FREEZE_DURATION=2156]="FREEZE_DURATION",n}(qg||{}),eF=function(n){return n[n.PCM_LEVEL=2104]="PCM_LEVEL",n}(eF||{}),cu=function(n){return n[n.PACKAGE_LOST=-1]="PACKAGE_LOST",n[n.LEVEL=2038]="LEVEL",n[n.BITRATE=2039]="BITRATE",n[n.PACKAGE_RATE=2040]="PACKAGE_RATE",n[n.AEC_RETURN_LOSS=2041]="AEC_RETURN_LOSS",n[n.AEC_RETURN_LOSS_ENH=2042]="AEC_RETURN_LOSS_ENH",n[n.FREEZE=2081]="FREEZE",n[n.DISABLED=2096]="DISABLED",n[n.BYTES_RETRANSMIT=2179]="BYTES_RETRANSMIT",n[n.PACKAGES_RETRANSMIT=2180]="PACKAGES_RETRANSMIT",n}(cu||{}),Ro=function(n){return n[n.BITRATE=2044]="BITRATE",n[n.PACKAGE_LOST=2045]="PACKAGE_LOST",n[n.PACKAGE_RATE=2046]="PACKAGE_RATE",n[n.CURRENT_DELAY=2047]="CURRENT_DELAY",n[n.JITTER_BUFFER=2054]="JITTER_BUFFER",n[n.JITTER=2055]="JITTER",n[n.FREEZE=2083]="FREEZE",n[n.DISABLED=2102]="DISABLED",n[n.PCM_LEVEL=2105]="PCM_LEVEL",n[n.PLAYER_STATUS=2130]="PLAYER_STATUS",n[n.CONCEALED_SAMPLES=2148]="CONCEALED_SAMPLES",n[n.BYTES_RETRANSMIT=2178]="BYTES_RETRANSMIT",n[n.PACKAGES_RETRANSMIT=2177]="PACKAGES_RETRANSMIT",n[n.PACKAGES_DISCARDED=2199]="PACKAGES_DISCARDED",n[n.AVG_PROCESSING_DELAY=2201]="AVG_PROCESSING_DELAY",n[n.TOTAL_SAMPLES_RECEIVED=2224]="TOTAL_SAMPLES_RECEIVED",n}(Ro||{}),WU=function(n){return n[n.FREEZE_TIME=-1]="FREEZE_TIME",n[n.LEVEL=2043]="LEVEL",n}(WU||{}),gn=function(n){return n[n.RTT=2006]="RTT",n[n.CONN_TYPE=801]="CONN_TYPE",n[n.STATS_UPDATE_INTERVAL=2205]="STATS_UPDATE_INTERVAL",n}(gn||{}),FI=function(n){return n[n.RTC_PEER_CONNECTION_STATE=2219]="RTC_PEER_CONNECTION_STATE",n}(FI||{});let fc=1e3,Kc=6,so=3,YU=Math.max(Kc,so);function Kt(n,i,a){a!=null&&Number.isFinite(a)&&(n[i]=Math.round(Math.max(0,a)))}function pn(n){let i={[gn.CONN_TYPE]:0,[gn.RTT]:n.rtt,[gn.STATS_UPDATE_INTERVAL]:n.updateInterval?Math.round(Math.max(0,n.updateInterval)):void 0};switch(n.selectedCandidatePair.localCandidate.candidateType){case"relay":{let a=n.selectedCandidatePair.localCandidate.relayProtocol;a==="udp"&&(i[gn.CONN_TYPE]=1),a==="tcp"&&(i[gn.CONN_TYPE]=3),a==="tls"&&(i[gn.CONN_TYPE]=4);break}case"srflx":i[gn.CONN_TYPE]=2;break;case"unknown":i[gn.CONN_TYPE]=5;break;default:i[gn.CONN_TYPE]=0}return i}function as(n){let i=0;switch(n){case"none":i=0;break;case"cpu":i=1;break;case"bandwidth":i=2;break;case"other":i=3}return i}class Yo extends li{constructor(i){super(),re(this,"store",void 0),re(this,"uploadWRTCStatsTimer",void 0),re(this,"uploadOutboundDenoiserStatsTimer",void 0),re(this,"uploadExtStatsTimer",void 0),re(this,"uploadExtUsageStatsTimer",void 0),re(this,"uploadInboundExtStatsTimer",void 0),re(this,"requestStats",void 0),re(this,"requestTransportStats",void 0),re(this,"requestLocalMedia",void 0),re(this,"requestRemoteMedia",void 0),re(this,"requestAllTracks",void 0),re(this,"requestVideoIsReady",void 0),re(this,"requestUploadStats",void 0),re(this,"requestUpload",void 0),re(this,"uploadOutboundStarted",!1),re(this,"uploadInboundStarted",!1),re(this,"uploadTransportStarted",!1),re(this,"uploadBaseStatsStarted",!1),re(this,"uploadExtensionUsageStarted",!1),re(this,"lastRecvStats",void 0),re(this,"lastSendStats",void 0),re(this,"lastRefRecvStats",void 0),re(this,"lastRefSendStats",void 0),re(this,"lastFullRecvStats",void 0),re(this,"lastFullSendStats",void 0),re(this,"needUploadRenderFreezeTime",!0),this.store=i}uploadWRTCStats(i){if(!this.requestStats||!this.requestUploadStats)return;let a=i%so==0,c=i%Kc==0,u,_;if(this.uploadTransportStarted&&(u=this.requestStats(),this.store.useP2P&&(_=this.requestStats(!0))),!u&&this.uploadOutboundStarted&&(u=this.requestStats()),!_&&this.uploadInboundStarted&&(_=this.requestStats(!0)),u||_){var S;let C={};if(this.uploadTransportStarted&&u){let e=this.getTransportStats(u,_,a);e&&(C.misc=[e])}if(this.uploadOutboundStarted&&u){let e=this.getOutboundStats(u,c?this.lastFullSendStats:a?this.lastRefSendStats:this.lastSendStats,a,c);e&&(C.outbound=[e])}if(this.uploadInboundStarted&&_){let e=this.getInboundStats(_,c?this.lastFullRecvStats:a?this.lastRefRecvStats:this.lastRecvStats,a,c);e&&(C.inbound=e)}let R=(S=this.requestTransportStats)===null||S===void 0?void 0:S.call(this).connectState;R&&(Array.isArray(C.misc)?C.misc[0]&&C.misc[0].addition&&(C.misc[0].addition[FI.RTC_PEER_CONNECTION_STATE]=TL[R]):C.misc=[{addition:{[FI.RTC_PEER_CONNECTION_STATE]:TL[R]}}]),this.requestUploadStats(C)}this.lastRecvStats=_,this.lastSendStats=u,c&&(this.lastFullRecvStats=_,this.lastFullSendStats=u),a&&(this.lastRefRecvStats=_,this.lastRefSendStats=u)}startUploadWRTCStats(){if(this.uploadWRTCStatsTimer)return;this.uploadBaseStatsStarted=!0;let i=1;this.uploadWRTCStatsTimer=window.setInterval(()=>{if(!this.uploadTransportStarted&&!this.uploadInboundStarted&&!this.uploadOutboundStarted){if(this.uploadBaseStatsStarted){var a,c;let u=(a=this.requestTransportStats)===null||a===void 0?void 0:a.call(this);return void(u&&((c=this.requestUploadStats)===null||c===void 0||c.call(this,{misc:[{addition:{[FI.RTC_PEER_CONNECTION_STATE]:TL[u.connectState]}}]})))}return this.stopUploadWRTCStats()}this.uploadWRTCStats(i),++i===YU+1&&(i=1)},fc)}stopUploadWRTCStats(){window.clearInterval(this.uploadWRTCStatsTimer),this.uploadWRTCStatsTimer=void 0,this.lastSendStats&&(this.lastSendStats.videoSend=[],this.lastSendStats.audioSend=[],this.lastSendStats=void 0),this.lastRecvStats&&(this.lastRecvStats.videoRecv=[],this.lastRecvStats.audioRecv=[],this.lastRecvStats=void 0)}getTransportStats(i,a,c){if(!this.requestStats)return;if(!c)return i.rtt==null?void 0:{addition:{[gn.RTT]:i.rtt,[gn.CONN_TYPE]:void 0,[gn.STATS_UPDATE_INTERVAL]:i.updateInterval||void 0}};let u=pn(i);if(this.store.useP2P){if(a){let _=pn(a);u[gn.CONN_TYPE]+=_[gn.CONN_TYPE]<<3}u[gn.CONN_TYPE]+=110}else u[gn.CONN_TYPE]+=100;return{addition:u}}getOutboundStats(i,a,c,u){if(!this.requestUploadStats||!this.requestLocalMedia)return;let _=this.requestLocalMedia();if(!_||_.length===0)return;let S,C,R;return _.forEach(e=>{let[t,{track:r,ssrcs:s}]=e;switch(t){case Qe.LocalVideoLowTrack:case Qe.LocalVideoTrack:if(t===Qe.LocalVideoTrack){let l=function(E,y,b,A,O,D){let P=y.videoSend.find($=>$.ssrc===E);if(!P)return;let F={},{sentFrame:B,inputFrame:Y}=P;if(D&&(Kt(F,Yi.QP_SUM,P.qpSumPerFrame),Y&&B)){let $=Y.frameRate,ee=B.frameRate;F[Yi.FREEZE]=function(Ee,Re){let Ie=!0;return Ie=!(Ee<=5)&&(Ee<=10?Re<3:Ee<=20?Re<4:Re<5),Ie}($,ee)?1:0}if(O){switch(B&&(Kt(F,Yi.HEIGHT,B.height),Kt(F,Yi.WIDTH,B.width),Kt(F,Yi.FRAME_RATE,B.frameRate)),F[Yi.DISABLED]=A._originMediaStreamTrack&&!A._originMediaStreamTrack.enabled||A._mediaStreamTrack&&!A._mediaStreamTrack.enabled?1:0,P.adaptionChangeReason){case"none":F[Yi.ADAPTATION]=0;break;case"cpu":F[Yi.ADAPTATION]=1;break;case"bandwidth":F[Yi.ADAPTATION]=2;break;case"other":F[Yi.ADAPTATION]=3}let $=0;P.adaptionChangeReason&&($+=as(P.adaptionChangeReason)),y.qualityLimitationReason&&($+=as(y.qualityLimitationReason)<<3),F[Yi.ADAPTATION]=$,F[Yi.PLAYER_STATUS]=Vc[A._player?A._player.videoElementStatus:"uninit"],Kt(F,Yi.NACKS,P.nacksCount),Kt(F,Yi.PLIS,P.plisCount),Kt(F,Yi.FIRS,P.firsCount),Kt(F,Yi.AVG_ENCODE,P.avgEncodeMs),Kt(F,Yi.HUGE_FRAME_SENT,P.hugeFramesSent),Kt(F,Yi.BYTES_RETRANSMIT,P.retransmittedBytesSent),Kt(F,Yi.PACKAGES_RETRANSMIT,P.retransmittedPacketsSent),Kt(F,Yi.KEY_FRAMES_ENCODED,P.keyFramesEncoded);let ee=b&&b.videoSend.find(Ee=>Ee.ssrc===E);if(ee){let Ee=O?fc:fc*Kc;ee.timestamp&&P.timestamp&&(Ee=P.timestamp-ee.timestamp),ee.packets!=null&&P.packets!=null&&Kt(F,Yi.PACKAGE_RATE,1e3*(P.packets-ee.packets)/Ee),P.packetsLost!=null&&ee.packetsLost!=null&&Kt(F,Yi.PACKAGE_LOST,P.packetsLost-ee.packetsLost),ee.bytes!=null&&P.bytes!=null&&Kt(F,Yi.BITRATE,8*(P.bytes-ee.bytes)/Ee)}}return F}(s[0].ssrcId,i,a,r,c,u),f=r&&function(E,y,b,A){let O=y.videoSend.find(P=>P.ssrc===E);if(!O)return null;let D={};if(A){let P=O.inputFrame,F=P&&P.height||b.videoHeight||0,B=P&&P.width||b.videoWidth||0,Y=P&&P.frameRate||0;Kt(D,BS.HEIGHT,F),Kt(D,BS.WIDTH,B),Kt(D,BS.FRAME_RATE,Y)}return D}(s[0].ssrcId,i,r,c),m=function(E,y){let b={};return y&&(Kt(b,Yi.RETRANSMIT,E.bitrate.retransmit),Kt(b,Yi.TARGET_ENCODED,E.bitrate.targetEncoded),Kt(b,Yi.ACTUAL_ENCODED,E.bitrate.actualEncoded),Kt(b,Yi.TRANSMIT,E.bitrate.transmit),Kt(b,Yi.BANDWIDTH,E.sendBandwidth)),b}(i,c);C=Object.assign({},l,f,m)}else R=function(l,f,m,E){let y=f.videoSend.find(A=>A.ssrc===l);if(!y)return;let b={};if(E){let A=y.sentFrame;if(A&&(Kt(b,FS.HEIGHT,A.height),Kt(b,FS.WIDTH,A.width),Kt(b,FS.FRAME_RATE,A.frameRate)),m){let O=m.videoSend.find(D=>D.ssrc===l);if(O){let D=fc*Kc;O.timestamp&&y.timestamp&&(D=y.timestamp-O.timestamp),O.packets!=null&&y.packets!=null&&Kt(b,FS.PACKAGE_RATE,1e3*(y.packets-O.packets)/D),y.packetsLost!=null&&O.packetsLost!=null&&Kt(b,FS.PACKAGE_LOST,y.packetsLost-O.packetsLost),O.bytes!=null&&y.bytes!=null&&Kt(b,FS.BITRATE,8*(y.bytes-O.bytes)/D)}}}return b}(s[0].ssrcId,i,a,c);break;case Qe.LocalAudioTrack:S=r&&function(l,f,m,E,y){let b=f.audioSend.find(O=>O.ssrc===l);if(!b)return;let A={};if(y){A[cu.DISABLED]=E._originMediaStreamTrack&&!E._originMediaStreamTrack.enabled||E._mediaStreamTrack&&!E._mediaStreamTrack.enabled?1:0;let O=100*E._source.getAccurateVolumeLevel(),D=b.inputLevel;if(D!=null){let F=Math.ceil(50*Math.log10(100*D+1));Kt(A,cu.LEVEL,F)}Kt(A,eF.PCM_LEVEL,O),Kt(A,cu.AEC_RETURN_LOSS,b.aecReturnLoss),Kt(A,cu.AEC_RETURN_LOSS_ENH,b.aecReturnLossEnhancement),Kt(A,cu.BYTES_RETRANSMIT,b.retransmittedBytesSent),Kt(A,cu.PACKAGES_RETRANSMIT,b.retransmittedPacketsSent),A[cu.FREEZE]=0;let P=m&&m.audioSend.find(F=>F.ssrc===l);if(P){let F=fc*Kc;P.timestamp&&b.timestamp&&(F=b.timestamp-P.timestamp),P.bytes!=null&&b.bytes!=null&&Kt(A,cu.BITRATE,8*(b.bytes-P.bytes)/F),P.packets!=null&&b.packets!=null&&Kt(A,cu.PACKAGE_RATE,1e3*(b.packets-P.packets)/F)}}return A}(s[0].ssrcId,i,a,r,c)}}),{high:C,low:R,audio:S}}getInboundStats(i,a,c,u){if(!this.requestRemoteMedia)return;let _=this.requestRemoteMedia()||[],S=[];return _.forEach(C=>{let[R,e]=C,t={peer:R.uid};if(e.has(Tt.VIDEO)&&R.videoTrack){let r=R._videoSSRC&&this.requestVideoIsReady&&this.requestVideoIsReady(R._videoSSRC)||!1,s=R.videoTrack?function(l,f,m,E,y,b,A,O){let D=f.videoRecv.find(Ee=>Ee.ssrc===l);if(!D)return;let P={},{receivedFrame:F,outputFrame:B,decodeFrameRate:Y}=D,$=m&&m.videoRecv.find(Ee=>Ee.ssrc===l);if(Kt(P,qg.FRAME_RATE_DECODE,Y),D.framesRateFirefox&&Kt(P,Qi.FRAME_RATE,D.framesRateFirefox),F&&Kt(P,Qi.FRAME_RATE,F.frameRate),Kt(P,Qi.FRAMES_DROPPED,D.framesDroppedCount),Kt(P,Qi.BYTES_RETRANSMIT,D.retransmittedBytesReceived),Kt(P,Qi.PACKAGES_RETRANSMIT,D.retransmittedPacketsReceived),Kt(P,Qi.PACKAGES_DISCARDED,D.packetsDiscarded),Kt(P,Qi.AVG_DECODE,D.avgDecodeMs),Kt(P,Qi.AVG_PROCESSING_DELAY,D.avgProcessingDelayMs),Kt(P,Qi.AVG_ASSEMBLY_TIME,D.avgFramesAssembledFromMultiplePacketsMs),Kt(P,Qi.AVG_INTER_FRAME_DELAY,D.avgInterFrameDelayMs),Kt(P,Qi.KEY_FRAMES_DECODED,D.keyFramesDecoded),$){let Ee=f.timestamp-m.timestamp||fc*(O?Kc:A?so:1);D.packetsLost!=null&&$.packetsLost!=null&&Kt(P,Qi.PACKAGE_LOST,D.packetsLost-$.packetsLost),$.bytes!=null&&D.bytes!=null&&Kt(P,Qi.BITRATE,8*(D.bytes-$.bytes)/Ee),$.packets!=null&&D.packets!=null&&Kt(P,Qi.PACKAGE_RATE,1e3*(D.packets-$.packets)/Ee)}if(O&&(Kt(P,Qi.QP_SUM,D.qpSumPerFrame),P[Qi.FREEZE]=y&&T1.isRemoteVideoFreeze(E,D,$)?1:0),A){var ee;F?(Kt(P,Qi.HEIGHT,F.height),Kt(P,Qi.WIDTH,F.width)):E&&(Kt(P,Qi.HEIGHT,E._videoHeight||0),Kt(P,Qi.WIDTH,E._videoWidth||0)),B&&Kt(P,qg.FRAME_RATE_OUTPUT,B.frameRate);let Ee=(ee=E._player)===null||ee===void 0?void 0:ee.rendFrameRate.toFixed(0);if(Ee&&Kt(P,qg.FRAME_RATE_RENDER,+Ee),Kt(P,Qi.JITTER_BUFFER,D.jitterBufferMs),Kt(P,Qi.CURRENT_DELAY,D.currentDelayMs),Kt(P,Qi.FIRS,D.firsCount),Kt(P,Qi.NACKS,D.nacksCount),Kt(P,Qi.PLIS,D.plisCount),E){P[Qi.DISABLED]=E._originMediaStreamTrack.enabled&&E._mediaStreamTrack.enabled?0:1;let Re=E._player;if(Re){let{freezeTimeCounterList:Ie,renderFreezeAccTime:we,videoElementStatus:Ue}=Re;if(Ie&&Ie.length>0&&Kt(P,qg.FREEZE_TIME,Ie.splice(0,1)[0]),b&&zp.visibility==="visible"&&Ue===is.PLAYING&&Un().supportRequestVideoFrameCallback){let ve=Math.min(6e3,we);Re.renderFreezeAccTime=Math.max(0,we-ve),Kt(P,qg.FREEZE_TIME_RENDER,ve)}if(typeof D.totalFreezesDuration=="number"){let ve=$&&$.totalFreezesDuration?D.totalFreezesDuration-$.totalFreezesDuration:D.totalFreezesDuration;Kt(P,qg.FREEZE_DURATION,1e3*ve)}}}if(P[Qi.PLAYER_STATUS]=Vc[E._player?E._player.videoElementStatus:"uninit"],$&&D.totalInterFrameDelay!==void 0&&D.totalSquaredInterFrameDelay!==void 0&&$.totalInterFrameDelay!==void 0&&$.totalSquaredInterFrameDelay!==void 0){let Re=D.totalInterFrameDelay-$.totalInterFrameDelay,Ie=D.totalSquaredInterFrameDelay-$.totalSquaredInterFrameDelay,we=D.framesDecodeCount-$.framesDecodeCount,Ue=Re/we*1e3,ve=Math.round(1e3*Math.sqrt((Ie-Math.pow(Re,2)/we)/we));!isNaN(ve)&&Ue+ve>Math.max(3*Ue,Ue+150)&&(P[Qi.I_FRAME_DELAY]=ve)}}return P}(R._videoSSRC,i,a,R.videoTrack,r===!0,this.needUploadRenderFreezeTime,c,u):void 0;s&&(t.video=s)}if(e.has(Tt.AUDIO)&&R.audioTrack){let r=R.audioTrack?function(s,l,f,m,E,y){let b=l.audioRecv.find(P=>P.ssrc===s);if(!b)return;let A={},O=f&&f.audioRecv.find(P=>P.ssrc===s);if(Kt(A,Ro.JITTER,b.jitterMs),Kt(A,Ro.BYTES_RETRANSMIT,b.retransmittedBytesReceived),Kt(A,Ro.PACKAGES_RETRANSMIT,b.retransmittedPacketsReceived),Kt(A,Ro.PACKAGES_DISCARDED,b.packetsDiscarded),Kt(A,Ro.AVG_PROCESSING_DELAY,b.avgProcessingDelayMs),O){let P=l.timestamp-f.timestamp||fc*(y?Kc:E?so:1);b.packets!=null&&O.packets!=null&&Kt(A,Ro.PACKAGE_RATE,1e3*(b.packets-O.packets)/P),E&&O.bytes!=null&&b.bytes!=null&&Kt(A,Ro.BITRATE,8*(b.bytes-O.bytes)/P),b.packetsLost!=null&&O.packetsLost!=null&&Kt(A,Ro.PACKAGE_LOST,b.packetsLost-O.packetsLost)}if(y){let{receivedFrames:P,droppedFrames:F}=b;P!=null&&F!=null&&(A[Ro.FREEZE]=(D=P)===0||100*F/D>20?1:0)}var D;if(E){let P=100*m._source.getAccurateVolumeLevel(),F=b.outputLevel;if(F!=null){let B=Math.ceil(50*Math.log10(100*F+1));Kt(A,WU.LEVEL,B)}if(Kt(A,Ro.PCM_LEVEL,P),m&&(A[Ro.DISABLED]=m._originMediaStreamTrack.enabled&&m._mediaStreamTrack.enabled?0:1),Kt(A,Ro.JITTER_BUFFER,b.jitterBufferMs),Kt(A,Ro.CURRENT_DELAY,b.jitterBufferMs),A[Ro.PLAYER_STATUS]=Vc[Go.getPlayerState(m.getTrackId())],O){let B=b.concealedSamples-O.concealedSamples;B>0&&Kt(A,Ro.CONCEALED_SAMPLES,B);let Y=b.totalSamplesReceived-O.totalSamplesReceived;Y>0&&Kt(A,Ro.TOTAL_SAMPLES_RECEIVED,Y)}}return A}(R._audioSSRC,i,a,R.audioTrack,c,u):void 0;r&&(t.audio=r)}(t.video||t.audio)&&S.push(t)}),this.needUploadRenderFreezeTime=!this.needUploadRenderFreezeTime,S}startUploadTransportStats(){this.uploadTransportStarted=!0,this.uploadWRTCStatsTimer||this.startUploadWRTCStats()}stopUploadTransportStats(){this.uploadTransportStarted=!1}startUploadOutboundStats(){this.uploadOutboundStarted||(this.uploadOutboundStarted=!0,this.uploadWRTCStatsTimer||this.startUploadWRTCStats(),this.uploadOutboundDenoiserStatsTimer&&window.clearInterval(this.uploadOutboundDenoiserStatsTimer),this.uploadOutboundDenoiserStatsTimer=window.setInterval(()=>{if(!this.requestAllTracks||!this.requestUpload)return;let i=(this.requestAllTracks()||[]).find(a=>a instanceof mI);if(i&&i._external.getDenoiserStats){let a=i._external.getDenoiserStats();a&&this.requestUpload(bI.DENOISER_STATS,a)}},2e3),this.uploadExtStatsTimer&&window.clearInterval(this.uploadExtStatsTimer),this.uploadExtStatsTimer=window.setInterval(()=>{!this.requestAllTracks||!this.requestUpload||this.requestAllTracks().forEach(i=>{i.getProcessorStats().forEach(a=>{this.requestUpload&&this.requestUpload(a.type,a.stats)})})},2e3))}stopUploadOutboundStats(){this.uploadOutboundStarted&&(this.uploadOutboundStarted=!1,this.lastSendStats&&(this.lastSendStats.videoSend=[],this.lastSendStats.audioSend=[],this.lastSendStats=void 0),this.uploadOutboundDenoiserStatsTimer&&window.clearInterval(this.uploadOutboundDenoiserStatsTimer),this.uploadOutboundDenoiserStatsTimer=void 0)}startUploadInboundStats(){this.uploadInboundStarted||(this.uploadInboundStarted=!0,this.uploadWRTCStatsTimer||this.startUploadWRTCStats(),this.uploadInboundExtStatsTimer&&window.clearInterval(this.uploadInboundExtStatsTimer),this.uploadInboundExtStatsTimer=window.setInterval(()=>{!this.requestUpload||!this.requestRemoteMedia||(this.requestRemoteMedia()||[]).forEach(i=>{let[a,c]=i;c.has(Tt.VIDEO)&&a.videoTrack&&a.videoTrack.getProcessorStats().forEach(u=>{this.requestUpload&&this.requestUpload(u.type,u.stats)}),c.has(Tt.AUDIO)&&a.audioTrack&&a.audioTrack.getProcessorStats().forEach(u=>{this.requestUpload&&this.requestUpload(u.type,u.stats)})})},2e3))}stopUploadInboundStats(){this.uploadInboundStarted&&(this.uploadInboundStarted=!1,this.lastRecvStats&&(this.lastRecvStats.videoRecv=[],this.lastRecvStats.audioRecv=[],this.lastRecvStats=void 0))}startUploadExtensionUsageStats(){if(this.uploadExtensionUsageStarted)return;this.uploadExtensionUsageStarted=!0,this.uploadExtUsageStatsTimer&&window.clearInterval(this.uploadExtUsageStatsTimer);let i=new Map;this.uploadExtUsageStatsTimer=window.setInterval(async()=>{let a=Date.now(),c={connectionInterval:ge("EXTENSION_USAGE_UPLOAD_INTERVAL")/1e3,details:[],lts:a},u=[],_=this.requestAllTracks&&this.requestAllTracks()||[];for(let e of _)!e.muted&&e.enabled&&(u=u.concat(await e.getProcessorUsage()));let S=this.requestRemoteMedia&&this.requestRemoteMedia()||[];for(let[e,t]of S)t.has(Tt.VIDEO)&&e.videoTrack&&(u=u.concat(await e.videoTrack.getProcessorUsage())),t.has(Tt.AUDIO)&&e.audioTrack&&(u=u.concat(await e.audioTrack.getProcessorUsage()));if(u.length===0)return;c.details=function(e,t){let r={};for(let{id:m,value:E,level:y,direction:b}of e){var s;let A=(s=t.get(m))!==null&&s!==void 0?s:0,O=E===2?A+ge("EXTENSION_USAGE_UPLOAD_INTERVAL")/1e3:A;var l,f;t.set(m,O),r[m]?(E===2&&(r[m].value=E),y>r[m].level&&(r[m].level=y),b==="remote"&&(r[m].remoteUidCount+=1),r[m].totalTs=(l=t.get(m))!==null&&l!==void 0?l:0):r[m]={value:E,level:y,remoteUidCount:b==="local"?0:1,totalTs:(f=t.get(m))!==null&&f!==void 0?f:0}}return Object.keys(r).map(m=>{let{level:E,value:y,totalTs:b}=r[m];return{id:m,level:E,value:y,totalTs:b}})}(u,i);let C=Date.now(),R=C>a?C:a+1;this.requestUpload&&this.requestUpload(bI.EXTENSION_USAGE_STATS,{usageStats:c,sendTs:R})},ge("EXTENSION_USAGE_UPLOAD_INTERVAL"))}stopUploadExtensionUsageStats(){this.uploadExtensionUsageStarted&&(this.uploadExtensionUsageStarted=!1,this.uploadExtUsageStatsTimer&&window.clearInterval(this.uploadExtUsageStatsTimer),this.uploadExtUsageStatsTimer=void 0)}stopUploadBaseStats(){this.uploadBaseStatsStarted=!1}}let ED=ge("ICE_RESTART_INTERVAL"),Xp=new Map,Jg=new Map,df=[hi.UDP_TCP_RELAY,hi.TCP_RELAY,hi.RELAY],KU=ge("JOIN_WITH_FALLBACK_MEDIA_PROXY_FORCE")&&Un().supportPCSetConfiguration;function Qt(n){let i=arguments.length>1&&arguments[1]!==void 0&&arguments[1],a=Xp.get(n.id);a&&(window.clearTimeout(a),Xp.delete(n.id));let c=Jg.get(n.id);i&&c&&c.index===df.length-1&&(z.debug("[".concat(n.id,"] reset ICE restart policy")),Jg.delete(n.id))}function qU(n,i,a){if(Xp.size===0&&Jg.size===0&&(Array.isArray(ge("RESTART_SEQUENCE"))&&ge("RESTART_SEQUENCE").length>0&&!function(C,R){if(C.length!==R.length)return!1;for(let e=0;e<C.length;e+=1){let t=C[e];if(C.filter(r=>r===t).length!==R.filter(r=>r===t).length)return!1}return!0}(df,ge("RESTART_SEQUENCE"))&&(df=ge("RESTART_SEQUENCE").filter(C=>{var R;if(ft(R=Object.values(hi)).call(R,C))return!0}),z.debug("use reconnection policy from config distribution, queues: ".concat(df.join(" => ")))),KU=ge("JOIN_WITH_FALLBACK_MEDIA_PROXY_FORCE")&&Un().supportPCSetConfiguration),df.length===0)return void a();let c,{index:u=0,type:_}=Jg.get(n.id)||{};if(KU&&_===hi.RELAY)return void a();let S=_&&u>=df.length-1;if(KU)_=hi.RELAY;else{if(S)return void a();_?(u++,_=df[u]):(_=df[0],u=0)}z.debug("[".concat(n.id,"] choose ICE restart policy: ").concat(_,", index: ").concat(u)),i(_),Jg.set(n.id,{index:u,type:_}),c=window.setTimeout(()=>qU(n,i,a),ED),Xp.set(n.id,c)}var Cn;function JU(n,i){var a=Object.keys(n);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(n);i&&(c=c.filter(function(u){return Object.getOwnPropertyDescriptor(n,u).enumerable})),a.push.apply(a,c)}return a}function Qp(n){for(var i=1;i<arguments.length;i++){var a=arguments[i]!=null?arguments[i]:{};i%2?JU(Object(a),!0).forEach(function(c){re(n,c,a[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(a)):JU(Object(a)).forEach(function(c){Object.defineProperty(n,c,Object.getOwnPropertyDescriptor(a,c))})}return n}function GI(n){var i,a,c,u=2;for(typeof Symbol<"u"&&(a=rL,c=Symbol.iterator);u--;){if(a&&(i=n[a])!=null)return i.call(n);if(c&&(i=n[c])!=null)return new Xg(i.call(n));a="@@asyncIterator",c="@@iterator"}throw new TypeError("Object is not async iterable")}function Xg(n){function i(a){if(Object(a)!==a)return Et.reject(new TypeError(a+" is not an object."));var c=a.done;return Et.resolve(a.value).then(function(u){return{value:u,done:c}})}return Xg=function(a){this.s=a,this.n=a.next},Xg.prototype={s:null,n:null,next:function(){return i(this.n.apply(this.s,arguments))},return:function(a){var c=this.s.return;return c===void 0?Et.resolve({value:a,done:!0}):i(c.apply(this.s,arguments))},throw:function(a){var c=this.s.return;return c===void 0?Et.reject(a):i(c.apply(this.s,arguments))}},new Xg(n)}let uf=(Cn=class extends li{get state(){return this._state}set state(n){let i=this._state;this._state=n,this.emit(Mt.StateChange,i,this._state)}constructor(n,i){super(),re(this,"isPlanB",void 0),re(this,"store",void 0),re(this,"statsUploader",void 0),re(this,"connection",void 0),re(this,"localTrackMap",new Map),re(this,"remoteUserMap",new Map),re(this,"localDataChannels",[]),re(this,"remoteDataChannelMap",new Map),re(this,"pendingLocalTracks",[]),re(this,"pendingRemoteTracks",[]),re(this,"pendingLocalDataChannels",[]),re(this,"pendingRemoteDataChannels",[]),re(this,"statsCollector",void 0),re(this,"shouldForwardP2PCreation",void 0),re(this,"iceFailedCount",0),re(this,"dtlsFailedCount",0),re(this,"mutex",void 0),re(this,"_state",or.Disconnected),re(this,"_pcStatsUploadType",ge("NEW_ICE_RESTART")?ad.FIRST_CONNECTION:ad.OLD_FIRST_CONNECTION),re(this,"_isStartRestartIce",!1),re(this,"_restartTimer",void 0),re(this,"_isTryConnecting",!1),re(this,"_iceError",null),re(this,"_forceTurn",!1),re(this,"_isWaitPcToRePub",!1),re(this,"handleMuteLocalTrack",async(a,c,u)=>{let _=await this.mutex.lock("Locking from P2PChannel.handleMuteLocalTrack");try{if(!this.connection||this.state!==or.Connected)return void u(new Ye(oe.INVALID_OPERATION,"Cannot call P2PChannel.handleMuteLocalTrack before connection established."));let S=this.filterTobeMutedTracks(a);if(S.length===0)return void c();let C=S.find(e=>e[0]==="videoLowTrack");C&&C[1].track._originMediaStreamTrack.stop(),await this.connection.muteLocal(S.map(e=>{let[,{id:t}]=e;return t}));let R=this.createMuteMessage(S);await Vr(this,Mt.RequestMuteLocal,R),c()}catch(S){u(S)}finally{_()}}),re(this,"handleUnmuteLocalTrack",async(a,c,u)=>{let _=await this.mutex.lock("Locking from P2PChannel.handleUnmuteLocalTrack");try{if(!this.connection||this.state!==or.Connected)return void u(new Ye(oe.INVALID_OPERATION,"Cannot call P2PChannel.handleUnmuteLocalTrack before connection established."));let S=this.filterTobeUnmutedTracks(a);if(S.length===0)return void c();let C=S.find(e=>e[0]==="videoLowTrack");if(C){let e=C[1];if(e.track._originMediaStreamTrack.stop(),!ge("DISABLE_DUAL_STREAM_USE_ENCODING")&&Un().supportDualStreamEncoding){let t=a._mediaStreamTrack.clone();e.track._mediaStreamTrack=t,e.track._originMediaStreamTrack=t}else{let t=HU(a,nr(this,Mt.RequestLowStreamParameter));e.track._mediaStreamTrack=t,e.track._originMediaStreamTrack=t}await new Et((t,r)=>{this.handleReplaceTrack(e.track,t,r,!0)})}await this.connection.unmuteLocal(S.map(e=>{let[,{id:t}]=e;return t}));let R=this.createUnmuteMessage(S);await Vr(this,Mt.RequestUnmuteLocal,R),c()}catch(S){u(S)}finally{_()}}),re(this,"handleUpdateVideoEncoder",async(a,c,u,_)=>{let S;_||(S=await this.mutex.lock("Locking from P2PChannel.handleUpdateVideoEncoder"));try{let R=this.localTrackMap.get(Qe.LocalVideoTrack);if(!this.connection||!R||R.track!==a||this.state!==or.Connected)return void c();let{id:e,track:t}=R;await this.connection.updateSendParameters(e,t),await this.connection.updateEncoderConfig(e,t),this.emit(Mt.UpdateVideoEncoder,t),c()}catch(R){u(R)}finally{var C;(C=S)===null||C===void 0||C()}}),re(this,"handleUpdateVideoSendParameters",async(a,c,u)=>{let _=await this.mutex.lock("Locking from P2PChannel.handleUpdateVideoSendParameters");try{let S=this.localTrackMap.get(Qe.LocalVideoTrack);if(!this.connection||!S||S.track!==a||this.state!==or.Connected)return void c();let{id:C,track:R}=S;await this.connection.updateSendParameters(C,R),c()}catch(S){u(S)}finally{_()}}),re(this,"handleReplaceMixingTrack",async(a,c,u,_)=>{if(!this.connection||this.state!==or.Connected)return void c();let S=_D([a]),C;z.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection will replace audioTrack [").concat(S.getTrackId(),"]")),typeof _=="boolean"&&_||(C=await this.mutex.lock("From P2PChannel.handleReplaceMixingTrack"));try{await this.replaceTrack(a,S),c()}catch(e){u(e)}finally{var R;(R=C)===null||R===void 0||R()}}),re(this,"handleReplaceTrack",async(a,c,u,_)=>{let S;z.debug("[".concat(this.store.clientId,"] P2PChannel handleReplaceTrack for [track-id-").concat(a.getTrackId(),"]")),typeof _=="boolean"&&_||(S=await this.mutex.lock("From P2PChannel.handleReplaceTrack"));try{var C;let e=Array.from(this.localTrackMap.entries()).find(t=>{let[,{track:r}]=t;return a===r});if(!this.connection||!e||this.state!==or.Connected)return void c();if(await((C=this.connection)===null||C===void 0?void 0:C.replaceTrack(a,e[1].id)),this.isPlanB){let t=e[1];t.id=a._mediaStreamTrack.id,this.localTrackMap.set(e[0],t)}if(e[0]===Qe.LocalVideoTrack&&!ge("DISABLE_DUAL_STREAM_USE_ENCODING")&&Un().supportDualStreamEncoding){let t=this.localTrackMap.get(Qe.LocalVideoLowTrack);if(t){let r=a._mediaStreamTrack.clone();t.track._originMediaStreamTrack.stop(),t.track._mediaStreamTrack=r,t.track._originMediaStreamTrack=r,await new Et((s,l)=>{this.handleReplaceTrack(t.track,s,l,!0)})}}c()}catch(e){u(e)}finally{var R;(R=S)===null||R===void 0||R()}}),re(this,"handleGetRTCStats",a=>{a(this.statsCollector.getRTCStats())}),re(this,"handleGetLocalVideoStats",a=>{a(this.statsCollector.getLocalVideoTrackStats())}),re(this,"handleGetLocalAudioStats",a=>{a(this.statsCollector.getLocalAudioTrackStats())}),re(this,"handleGetRemoteVideoStats",a=>this.statsCollector.getRemoteVideoTrackStats(a.uid)[a.uid]),re(this,"handleGetRemoteAudioStats",a=>this.statsCollector.getRemoteAudioTrackStats(a.uid)[a.uid]),this.store=n,this.statsCollector=i,this.statsCollector.addP2PChannel(this),this.statsUploader=new Yo(this.store),this.bindStatsUploaderEvents(),this.mutex=new Na("P2PChannel-mutex",this.store.clientId),this.isPlanB=!Un().supportUnifiedPlan||ge("CHROME_FORCE_PLAN_B")&&jp(),this.shouldForwardP2PCreation=ge("FORWARD_P2P_CREATION")&&Un().supportPCSetConfiguration&&mL(),this.shouldForwardP2PCreation&&(this.connection=Kg(this.store),this.emit(Mt.PeerConnectionStateChange,this.connection.peerConnectionState),this.bindConnectionEvents(this.connection))}async startP2PConnection(n){var i;this.state=or.New,this._forceTurn=GU(n),z.debug("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] forceTurn: ").concat(this._forceTurn));let a=this.shouldForwardP2PCreation&&((i=this.connection)===null||i===void 0?void 0:i.peerConnectionState)==="closed";if(this.shouldForwardP2PCreation&&!a||(a&&this.connection&&(z.warning("[".concat(this.store.clientId,"] P2PChannel.startP2PConnection ForwardP2P closed.")),this.resetConnection(this.connection)),this.connection=Kg(this.store,n),this.emit(Mt.PeerConnectionStateChange,this.connection.peerConnectionState),this.bindConnectionEvents(this.connection)),!this.connection)throw new Ye(oe.UNEXPECTED_ERROR,"Cannot P2PChannel.startConnection before P2PConnection initialization .");return this._pcStatsUploadType=ge("NEW_ICE_RESTART")?ad.FIRST_CONNECTION:ad.OLD_FIRST_CONNECTION,this._isTryConnecting=!0,this._isStartRestartIce=!1,this._iceError=null,this.connection.setConfiguration(n),this.connection.establishPromise}async connect(n){if(!this.connection)throw new Ye(oe.UNEXPECTED_ERROR,"Cannot P2PChannel.connect before P2PChannel.startP2PConnection .");ge("ENABLE_PREALLOC_PC")&&this.state===or.Connected?await this.connection.updateRemoteConnect(n):(this.store.peerConnectionStart(),await this.connection.connect(n),this.statsUploader.startUploadTransportStats(),this.statsUploader.startUploadExtensionUsageStats(),this.state=or.Connected)}updateRemoteRTPCapabilities(n){let i=Array.from(this.localTrackMap.entries()).filter(u=>{var _;let[S]=u;return ft(_=[Qe.LocalVideoLowTrack,Qe.LocalVideoTrack]).call(_,S)}),a=i.map(u=>{let[,{id:_}]=u;return _}),c=i.map(u=>{let[_]=u;return _});if(this.connection instanceof Ah){if(jt.updateRemoteRTPCapabilities(this.store.sessionId,{trackTypes:JSON.stringify(c),localCodecs:JSON.stringify(this.connection.localCodecs),remoteCodecs:JSON.stringify(n)}),!ft(n).call(n,this.store.codec)){let u=["vp9","vp8","h264"].find(_=>ft(n).call(n,_));u&&(this.store.codec=u,z.debug("[".concat(this.store.clientId,"] [").concat(this.store.p2pId," updateRemoteRTPCapabilities] default codec is not available, hence the fallback to ").concat(u,".")))}this.connection.updateRemoteRTPCapabilities(a,n)}}async getEstablishParams(){var n;if(this.connection instanceof Ah&&this.connection.peerConnectionState!=="closed"&&ft(n=[or.New,or.Connected]).call(n,this.state))return this.connection.establishPromise}async publishDataChannel(n){if(!this.connection||this.state!==or.Connected){if(this.state===or.Disconnected)throw new Ye(oe.UNEXPECTED_ERROR,"PeerConnection already disconnected.");return n.forEach(a=>{var c;ft(c=this.pendingLocalDataChannels).call(c,a)||this.pendingLocalDataChannels.push(a)}),[]}let i=this.filterTobePublishedDataChannels(n);return i.length===0?[]:(i.forEach(a=>{let c=Date.now();this.store.publish(a.id.toString(),"datachannel",c)}),await this.connection.createDataChannels(this.store.uid,i),i.forEach(a=>{this.localDataChannels.push(a);let c=Date.now();this.store.publish(a.id+"","datachannel",void 0,c)}),n.map(a=>({streamId:a.id,ordered:a.ordered,maxRetransmits:a.maxRetransmits,metadata:a.metadata,channelId:a._originDataChannelId})))}publish(n,i,a){var c=this;return Zl(function*(){let u=yield Kn(c.mutex.lock("From P2PChannel.publish"));try{var _;let S=c.connection&&ft(_=["disconnected","failed"]).call(_,c.connection.peerConnectionState);if(!c.connection||c.state!==or.Connected||S){if(c.state===or.Disconnected)throw new Ye(oe.UNEXPECTED_ERROR,"PeerConnection already disconnected.");c.throwIfTrackTypeNotMatch(n);let R=n.filter(e=>c.pendingLocalTracks.indexOf(e)===-1);return c.pendingLocalTracks=c.pendingLocalTracks.concat(R),void(S&&(c._isWaitPcToRePub=!0))}c.store.pubId=c.store.pubId+1,Cs.markPublishStart(c.store.clientId,c.store.pubId);let C=c.filterTobePublishedTracks(n,i,a);if(C.length===0)return void(yield Kn(c.tryToUnmuteAudio(n)));yield*kp(GI(c.doPublish(c.connection,C)))}finally{u()}})()}doPublish(n,i){var a=this;return Zl(function*(){i.forEach(s=>{let{track:l,type:f}=s,m=Date.now();a.store.publish(l.getTrackId(),f===Qe.LocalAudioTrack?"audio":"video",m)}),a.bindLocalTrackEvents(i);let c=i.map(s=>{let{track:l}=s;return l}),u=yield Kn(n.send(c,a.store.codec,a.store.audioCodec)),_=(yield Kn(u.next())).value,S=a.createGatewayPublishMessage(i,_),C;try{C=yield S}catch(s){throw u.throw(s),(s==null?void 0:s.code)===oe.WS_ABORT&&i.forEach(l=>{let{track:f}=l;a.pendingLocalTracks.indexOf(f)===-1&&a.pendingLocalTracks.push(f)}),a.unbindLocalTrackEvents(i),s}let R=a.mapPubResToRemoteConfig(S,C,c),e=(yield Kn(u.next(R))).value;if(a.state===or.Disconnected)throw new Ye(oe.UNEXPECTED_ERROR,"PeerConnection already disconnected.");ge("ENABLE_VIDEO_SEI");let t=ge("ENABLE_ENCODED_TRANSFORM"),r=ge("ENABLE_AUDIO_METADATA");c.forEach(async s=>{let l=s.getRTCRtpTransceiver();if(!l||!t)return;let{interceptLocalVideoFrame:f,interceptLocalAudioFrame:m}=zg();s.trackMediaType===Tt.VIDEO?await f(l.sender,s):s.trackMediaType===Tt.AUDIO&&await m(l.sender,{metadata:r?()=>{let E=s.metadata.shift();return E&&E.value}:void 0})}),i.forEach(s=>{let{type:l}=s;a.statsCollector.addLocalStats(l)}),a.assignLocalTracks(i,e),a.statsUploader.startUploadOutboundStats(),i.forEach(s=>{let{track:l,type:f}=s,m=Date.now();a.store.publish(l.getTrackId(),f===Qe.LocalAudioTrack?"audio":"video",void 0,m)})})()}async updateVideoStreamParameter(n,i){let a=this.localTrackMap.get(i);if(!a||!this.connection)return;if(!(a.track instanceof ni))return z.warn("[updateVideoStreamParameter]: track is not an instance of LocalVideoTrack");let{track:c}=a,u=function(_,S){let C={};return _.height&&_.width&&(C.scaleResolutionDownBy=eD(_,S)),C.maxFramerate=_.framerate?Al(_.framerate):void 0,C.maxBitrate=_.bitrate?1e3*_.bitrate:void 0,C}(n,c);if(c._encoderConfig||(c._encoderConfig={}),i!==Qe.LocalVideoLowTrack||!ge("DISABLE_DUAL_STREAM_USE_ENCODING")&&Un().supportDualStreamEncoding)u.scaleResolutionDownBy!=null&&(c._encoderConfig.scaleResolutionDownBy=u.scaleResolutionDownBy);else{let _=c._originMediaStreamTrack;if(!_.canvas)return z.warn("[".concat(c.getTrackId(),"] no canvas on track"));(function(S,C){let R=S.canvas;C.width&&(R.width=Al(C.width)),C.height&&(R.height=Al(C.height)),C.framerate&&(R.stopCapture&&R.stopCapture(),R.stopCapture=jn(()=>{!R.startCapture&&R.stopCapture&&R.stopCapture(),R.startCapture&&R.startCapture()},Al(C.framerate)))})(_,n)}u.maxBitrate!=null&&(c._encoderConfig.bitrateMax=u.maxBitrate/1e3),u.maxFramerate!=null&&(c._encoderConfig.frameRate&&typeof c._encoderConfig.frameRate=="object"?c._encoderConfig.frameRate.max=u.maxFramerate:c._encoderConfig.frameRate={max:u.maxFramerate}),z.debug("[".concat(c.getTrackId(),"] LowStreamEncoderConfig: , ").concat(JSON.stringify(c._encoderConfig))),await this.connection.updateRtpSenderEncodings(c)}publishLowStream(n){var i=this;return Zl(function*(){if(!i.connection||i.state!==or.Connected)return;let a=yield Kn(i.mutex.lock("Locking from P2PChannel.publishLowStream"));try{let u=i.localTrackMap.get(Qe.LocalVideoTrack);if(!u)throw new Ye(oe.UNEXPECTED_ERROR,"Could not find high stream");if(i.localTrackMap.has(Qe.LocalVideoLowTrack))throw new Ye(oe.UNEXPECTED_ERROR,"[".concat(i.store.clientId,"] Can't publish low stream when stream already publish"));let _=[{track:i.getLowVideoTrack(u.track,n),type:Qe.LocalVideoLowTrack}];if(yield*kp(GI(i.doPublish(i.connection,_))),u.track.muted||!u.track.enabled){var c;let S=(c=i.localTrackMap.get(Qe.LocalVideoLowTrack))===null||c===void 0?void 0:c.id;S!==void 0&&(yield Kn(i.connection.muteLocal([S])))}}finally{a()}})()}async republish(){this.pendingLocalTracks.length>0&&(z.debug("[".concat(this.store.clientId,"] Emit P2PChannelEvents.RequestRePublish to republish tracks.")),await Bn(this,Mt.RequestRePublish,this.pendingLocalTracks),this.emit(Mt.MediaReconnectEnd,this.store.uid),this.pendingLocalTracks=[]),this.pendingLocalDataChannels.length>0&&(z.debug("Emit P2PChannelEvents.RequestRePublishDataChannel to republish datachannels."),await Bn(this,Mt.RequestRePublishDataChannel,this.pendingLocalDataChannels),this.pendingLocalDataChannels=[]),this._isWaitPcToRePub=!1}async reSubscribe(n){for(let i=this.pendingRemoteTracks.length-1;i>=0;i--){let{user:a,kind:c}=this.pendingRemoteTracks[i];(c!==Tt.AUDIO||a._audio_added_&&a._audioSSRC)&&(c!==Tt.VIDEO||a._video_added_&&a._videoSSRC)||this.pendingRemoteTracks.splice(i,1)}if(n)await Bn(this,Mt.RequestReSubscribe,this.pendingRemoteTracks);else for(let{user:i,kind:a}of this.pendingRemoteTracks)await this.subscribe(i,a,a===Tt.VIDEO?i._videoSSRC:i._audioSSRC);this.pendingRemoteTracks.forEach(i=>{let{user:a}=i;this.emit(Mt.MediaReconnectEnd,a.uid)}),this.pendingRemoteTracks=[]}async unpublish(n){if(!this.connection||this.state!==or.Connected)return void n.forEach(c=>{let u=this.pendingLocalTracks.indexOf(c);u!==-1&&this.pendingLocalTracks.splice(u,1)});let i=this.filterTobeUnpublishedTracks(n);if(i.length===0)return;let a=i.find(c=>c[0]==="videoLowTrack");return a&&a[1].track.close(),this.doUnpublish(this.connection,i)}async unpublishDataChannel(n){if(!this.connection||this.state!==or.Connected)return void n.forEach(a=>{let c=this.pendingLocalDataChannels.indexOf(a);c!==-1&&this.pendingLocalDataChannels.splice(c,1)});let i=this.filterTobeUnpublishedDataChannels(n);return i.length!==0?(i.forEach(a=>{let c=this.localDataChannels.indexOf(a);c!==-1&&this.localDataChannels.splice(c,1)}),this.localDataChannels.length===0&&await this.connection.stopDataChannels(this.store.uid),i.map(a=>a.id)):void 0}async unpublishLowStream(){if(!this.connection||this.state!==or.Connected)return;let n=this.localTrackMap.get(Qe.LocalVideoLowTrack);if(!n)return;n.track.close();let i=[[Qe.LocalVideoLowTrack,n]];return this.doUnpublish(this.connection,i)}async doUnpublish(n,i){let a=this.createGatewayUnpublishMessage(i);return await n.stopSending(i.map(c=>{let[,{id:u}]=c;return u})),this.withdrawLocalTracks(i),this.unbindLocalTrackEvents(i.map(c=>{let[u,{track:_}]=c;return{type:u,track:_}})),i.forEach(c=>{let[u]=c;this.statsCollector.removeLocalStats(u)}),this.localTrackMap.size===0&&this.statsUploader.stopUploadOutboundStats(),a}async subscribeDataChannel(n,i){if(!this.connection||this.state!==or.Connected)throw new Ye(oe.INVALID_OPERATION,"Cannot subscribe remote user when peerConnection disconnected.");let a=i.filter(c=>{var u;return!((u=this.remoteDataChannelMap.get(n))!==null&&u!==void 0&&u.get(c.id))});if(a.length!==0)return await this.connection.createDataChannels(n.uid,a),a.forEach(c=>{var u;this.remoteDataChannelMap.has(n)?(u=this.remoteDataChannelMap.get(n))===null||u===void 0||u.set(c.id,c):this.remoteDataChannelMap.set(n,new Map([[c.id,c]]));let _=this.pendingRemoteDataChannels.findIndex(S=>{let{user:C,id:R}=S;return C.uid===n.uid&&R===c.id});_!==-1&&this.pendingRemoteDataChannels.splice(_,1)}),a.map(c=>c.id)}async subscribe(n,i,a,c,u){var _;if(!this.connection||this.state!==or.Connected)throw new Ye(oe.INVALID_OPERATION,"Cannot subscribe remote user when peerConnection disconnected.");if((_=this.remoteUserMap.get(n))!==null&&_!==void 0&&_.has(i))return;let S,C,R,e=this.connection.getPreMedia(a);if(e)z.debug("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] preSSRCMap has ssrcId: ").concat(a,", no need to send sub to gateway.")),R=e.transceiver,S=e.track,C=e.id;else if(u){let s=u.find(f=>{let{stream_type:m}=f;return m===i});if(!s)throw new Ye(oe.UNEXPECTED_ERROR,"Cannot subscribe to remote ".concat(i," for user: ").concat(n.uid," because subscribe answer from gateway does not contain stream_type: ").concat(i,"."));let l=await this.connection.receive(i,s.ssrcs,String(n._uintid),s.attributes);this.connection instanceof Ah&&(R=l.transceiver),S=l.track,C=l.id}else{let s=await this.connection.receive(i,[{ssrcId:a,rtx:c}],String(n._uintid),void 0);this.connection instanceof Ah&&(R=s.transceiver),S=s.track,C=s.id}if(i===Tt.AUDIO?(n._audioTrack?n._audioTrack._updateOriginMediaStreamTrack(S):(n._audioTrack=new V_(S,n.uid,n._uintid,this.store),z.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote audio track: ").concat(n._audioTrack.getTrackId()))),R&&n._audioTrack._updateRtpTransceiver(R),this.bindRemoteTrackEvents(n,n._audioTrack)):(n._videoTrack?n._videoTrack._updateOriginMediaStreamTrack(S):(n._videoTrack=new j_(S,n.uid,n._uintid,this.store),z.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote video track: ").concat(n._videoTrack.getTrackId()))),R&&n._videoTrack._updateRtpTransceiver(R),this.bindRemoteTrackEvents(n,n._videoTrack)),R&&ge("ENABLE_ENCODED_TRANSFORM")){let{interceptRemoteVideoFrame:s,interceptRemoteAudioFrame:l}=zg();i==Tt.VIDEO?await s(R.receiver,{onSei:ge("ENABLE_VIDEO_SEI")&&(f=>{var m;return(m=n._videoTrack)===null||m===void 0?void 0:m._onSei(f)})}):i==Tt.AUDIO&&await l(R.receiver,{enableTopn:!!ge("ENABLE_AUDIO_TOPN"),enableMetadata:!!ge("ENABLE_AUDIO_METADATA"),onMetadata:f=>{this.safeEmit(Mt.AudioMetadata,f)}})}let t=this.remoteUserMap.get(n);t?t.set(i,C):this.remoteUserMap.set(n,new Map([[i,C]])),this.statsCollector.addRemoteStats(n.uid),this.statsUploader.startUploadInboundStats();let r=this.pendingRemoteTracks.findIndex(s=>{let{user:l,kind:f}=s;return l.uid===n.uid&&i===f});r!==-1&&(this.pendingRemoteTracks.splice(r,1),this.emit(Mt.MediaReconnectEnd,n.uid))}async massSubscribe(n){return this.massSubscribeNoLock(n)}async massSubscribeNoLock(n){if(!this.connection||this.state!==or.Connected)throw new Ye(oe.INVALID_OPERATION,"Cannot subscribeAll remote users when peerConnection disconnected.");n=n.filter(u=>{var _;let{user:S,mediaType:C}=u;return!((_=this.remoteUserMap.get(S))!==null&&_!==void 0&&_.has(C))});let i=[],a=new Map;n.forEach(u=>{if(!this.connection)return;let _=this.connection.getPreMedia(u.ssrcId);_?a.set(u.ssrcId,_):i.push(u)});let c=await this.connection.batchReceive(i.map(u=>{let{user:_,mediaType:S,ssrcId:C,rtxSsrcId:R}=u;return{kind:S,ssrcMsg:[{ssrcId:C,rtx:R}],mslabel:String(_._uintid)}}));i.forEach((u,_)=>{a.set(u.ssrcId,c[_])});for(let{user:u,mediaType:_,ssrcId:S}of n){let C=a.get(S);if(!C)return void z.debug("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] cannot find ").concat(u.uid," subscribe data,").concat(_,", ").concat(S));let{track:R,id:e,transceiver:t}=C;if(t&&ge("ENABLE_ENCODED_TRANSFORM")){let{interceptRemoteVideoFrame:l,interceptRemoteAudioFrame:f}=zg();_==Tt.VIDEO?await l(t.receiver,{onSei:ge("ENABLE_VIDEO_SEI")&&(m=>{var E;return(E=u._videoTrack)===null||E===void 0?void 0:E._onSei(m)})}):_==Tt.AUDIO&&await f(t.receiver,{enableTopn:!!ge("ENABLE_AUDIO_TOPN"),enableMetadata:!!ge("ENABLE_AUDIO_METADATA"),onMetadata:m=>{this.safeEmit(Mt.AudioMetadata,m)}})}if(_===Tt.AUDIO?(u._audioTrack?u._audioTrack._updateOriginMediaStreamTrack(R):(u._audioTrack=new V_(R,u.uid,u._uintid,this.store),z.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote audio track: ").concat(u._audioTrack.getTrackId()))),t&&u._audioTrack._updateRtpTransceiver(t),this.bindRemoteTrackEvents(u,u._audioTrack)):(u._videoTrack?u._videoTrack._updateOriginMediaStreamTrack(R):(u._videoTrack=new j_(R,u.uid,u._uintid,this.store),z.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote video track: ").concat(u._videoTrack.getTrackId()))),t&&u._videoTrack._updateRtpTransceiver(t),this.bindRemoteTrackEvents(u,u._videoTrack)),ge("ENABLE_VIDEO_SEI")&&t){let{interceptRemoteVideoFrame:l,interceptRemoteAudioFrame:f}=zg();_==Tt.VIDEO?await l(t.receiver,{onSei:m=>{var E;(E=u._videoTrack)===null||E===void 0||E._onSei(m)}}):_==Tt.AUDIO&&await f(t.receiver)}let r=this.remoteUserMap.get(u);r?r.set(_,e):this.remoteUserMap.set(u,new Map([[_,e]])),this.statsCollector.addRemoteStats(u.uid),this.statsUploader.startUploadInboundStats();let s=this.pendingRemoteTracks.findIndex(l=>{let{user:f,kind:m}=l;return f.uid===u.uid&&_===m});s!==-1&&(this.pendingRemoteTracks.splice(s,1),this.emit(Mt.MediaReconnectEnd,u.uid))}}async unsubscribe(n,i,a){let c=this.pendingRemoteTracks.filter(S=>{let{user:C,kind:R}=S;return i!==void 0?C.uid===n.uid&&i===R:C.uid===n.uid});if(c.forEach(S=>{let C=this.pendingRemoteTracks.indexOf(S);this.pendingRemoteTracks.splice(C,1)}),this.connection&&this.state===or.Connected||a||c.forEach(S=>{let{kind:C}=S;var R;if(C===Tt.AUDIO)(R=n._audioTrack)===null||R===void 0||R._destroy(),n._audioTrack=void 0;else if(C===Tt.VIDEO){var e;(e=n._videoTrack)===null||e===void 0||e._destroy(),n._videoTrack=void 0}}),!this.connection||this.state!==or.Connected)return;let u=this.filterTobeUnSubscribedTracks(n,i);if(u.length===0)return;await this.connection.stopReceiving(u.map(S=>{let[,{id:C}]=S;return C}));let _=this.createUnsubscribeMessage(u);return this.withdrawRemoteTracks(u),this.remoteUserMap.size===0&&this.statsUploader.stopUploadInboundStats(),u.forEach(S=>{let[C,{kind:R}]=S;var e,t;if(R===Tt.VIDEO&&C._videoSSRC&&((e=this.connection)===null||e===void 0||e.setStatsRemoteVideoIsReady(C._videoSSRC,!1)),R===Tt.VIDEO)this.unbindRemoteTrackEvents(C._videoTrack),a||((t=C._videoTrack)===null||t===void 0||t._destroy(),C._videoTrack=void 0);else if(R===Tt.AUDIO){var r;this.unbindRemoteTrackEvents(C._audioTrack),!a&&((r=C._audioTrack)===null||r===void 0||r._destroy(),C._audioTrack=void 0)}}),_}async unsubscribeDataChannel(n,i){if(i.forEach(u=>{let _=this.pendingRemoteDataChannels.findIndex(S=>S.id===u.id);_!==-1&&this.pendingRemoteDataChannels.splice(_,1)}),!this.connection)return;let a=this.filterTobeUnSubscribedDataChannels(n,i);if(a.length===0)return;i.forEach(u=>{u._close()});let c=this.remoteDataChannelMap.get(n);return a.forEach(u=>{c&&c.delete(u.id)}),c&&c.size===0&&(this.remoteDataChannelMap.delete(n),await this.connection.stopDataChannels(n.uid)),a.map(u=>u.id)}async massUnsubscribe(n){return this.massUnsubscribeNoLock(n)}async massUnsubscribeNoLock(n){let i=[];for(let{user:u,mediaType:_}of n){let S=this.pendingRemoteTracks.filter(C=>{let{user:R,kind:e}=C;return _!==void 0?R.uid===u.uid&&_===e:R.uid===u.uid});S.forEach(C=>{let R=this.pendingRemoteTracks.indexOf(C);this.pendingRemoteTracks.splice(R,1)}),i=i.concat(S)}if(!this.connection||this.state!==or.Connected)return void i.forEach(u=>{let{user:_,kind:S}=u;var C;if(S===Tt.AUDIO)(C=_._audioTrack)===null||C===void 0||C._destroy(),_._audioTrack=void 0;else if(S===Tt.VIDEO){var R;(R=_._videoTrack)===null||R===void 0||R._destroy(),_._videoTrack=void 0}});let a=Ds(n).call(n,(u,_)=>{let{user:S,mediaType:C}=_,R=this.filterTobeUnSubscribedTracks(S,C);return u.concat(R)},[]);if(a.length===0)return;await this.connection.stopReceiving(a.map(u=>{let[,{id:_}]=u;return _}));let c=this.createUnsubscribeAllMessage(a);return this.withdrawRemoteTracks(a),this.remoteUserMap.size===0&&this.statsUploader.stopUploadInboundStats(),a.forEach(u=>{let[_,{kind:S}]=u;var C,R;if(S===Tt.VIDEO&&_._videoSSRC&&((C=this.connection)===null||C===void 0||C.setStatsRemoteVideoIsReady(_._videoSSRC,!1)),S===Tt.VIDEO)this.unbindRemoteTrackEvents(_._videoTrack),(R=_._videoTrack)===null||R===void 0||R._destroy(),_._videoTrack=void 0;else if(S===Tt.AUDIO){var e;this.unbindRemoteTrackEvents(_._audioTrack),(e=_._audioTrack)===null||e===void 0||e._destroy(),_._audioTrack=void 0}}),c}isPreSubScribe(n){return!this.connection||this.state!==or.Connected?!1:!!this.connection.getPreMedia(n)}async muteRemote(n,i){if(!this.connection)return;let a=this.remoteUserMap.get(n);if(!a)return void z.warning("[".concat(this.store.clientId,"] P2PChannel.muteRemote has no remote user ").concat(n.uid,"."));if(!a.get(i))return void z.warning("[".concat(this.store.clientId,"] P2PChannel.muteRemote has no remote user ").concat(n.uid," media type ").concat(i,"."));let c=i===Tt.VIDEO?n._videoSSRC:n._audioSSRC;c!==void 0&&this.connection.setStatsRemoteVideoIsReady(c,!1)}async unmuteRemote(n,i){return this.unmuteRemoteNoLock(n,i)}async unmuteRemoteNoLock(n,i){if(!this.connection)return;let a=this.remoteUserMap.get(n);if(!a)return void z.warning("[".concat(this.store.clientId,"] P2PChannel.unmuteRemote has no remote user ").concat(n.uid,"."));a.get(i)||z.warning("[".concat(this.store.clientId,"] P2PChannel.unmuteRemote has no remote user ").concat(n.uid," media type ").concat(i,"."))}addAudioMetadata(n){let i=this.localTrackMap.get(Qe.LocalAudioTrack),a=i&&i.track;a&&a.metadata.push(n)}getAllTracks(n){let i=this.localTrackMap.get(Qe.LocalAudioTrack);if((i==null?void 0:i.track)instanceof va){let a=i.track;return Array.from(this.localTrackMap.entries()).filter(c=>{let[u]=c;return u!==Qe.LocalAudioTrack}).filter(c=>{let[u]=c;return!(n&&u===Qe.LocalVideoLowTrack)}).map(c=>{let[,{track:u}]=c;return u}).concat(a.trackList)}return Array.from(this.localTrackMap.entries()).filter(a=>{let[c]=a;return!(n&&c===Qe.LocalVideoLowTrack)}).map(a=>{let[,{track:c}]=a;return c})}getAllDataChannels(){return this.localDataChannels}reportPublishEvent(n,i,a,c,u){if(n){let S=this.localTrackMap.get(Qe.LocalAudioTrack),C=c?this.localTrackMap.get(Qe.LocalVideoLowTrack):this.localTrackMap.get(Qe.LocalVideoTrack);jt.publish(this.store.sessionId,{eventElapse:Cs.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:n,ec:i,audioName:S==null?void 0:S.track.getTrackLabel(),videoName:C==null?void 0:C.track.getTrackLabel(),screenshare:(C==null?void 0:C.track._hints.indexOf(kr.SCREEN_TRACK))!==-1,audio:!!S,video:!!C,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:u})}else{var _;a||(a=[]);let S=a.find(R=>R instanceof Ui),C=c?(_=this.localTrackMap.get(Qe.LocalVideoTrack))===null||_===void 0?void 0:_.track:a.find(R=>R instanceof ni);jt.publish(this.store.sessionId,{eventElapse:Cs.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:n,ec:i,audioName:S==null?void 0:S.getTrackLabel(),videoName:C==null?void 0:C.getTrackLabel(),screenshare:(C==null?void 0:C._hints.indexOf(kr.SCREEN_TRACK))!==-1,audio:!!S,video:!!C,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:u})}}reportSubscribeEvent(n,i,a,c){let u=c===Tt.VIDEO?a._videoSSRC:a._audioSSRC;u&&jt.subscribe(this.store.sessionId,{succ:n,ec:i,video:c===Tt.VIDEO,audio:c===Tt.AUDIO,peerid:a.uid,subscribeRequestid:u,p2pid:this.store.p2pId,eventElapse:Cs.measureFromSubscribeStart(this.store.clientId,u),preSsrc:this.isPreSubScribe(u)})}reset(){z.debug("[".concat(this.store.clientId,"] P2PChannel.reset")),this.mutex=new Na("P2PChannel-mutex",this.store.clientId),this.connection&&(this.resetConnection(this.connection),this.connection=void 0),this.shouldForwardP2PCreation&&(this.connection=Kg(this.store),this.emit(Mt.PeerConnectionStateChange,this.connection.peerConnectionState),this.bindConnectionEvents(this.connection)),this.statsUploader.stopUploadOutboundStats(),this.statsUploader.stopUploadInboundStats(),this.statsUploader.stopUploadTransportStats(),this.statsUploader.stopUploadExtensionUsageStats(),this.statsUploader.stopUploadBaseStats(),this.unbindLocalTrackEvents(),this.unbindAllRemoteTrackEvents(),this.unbindRtpTransceiver();let n=this.localTrackMap.get(Qe.LocalAudioTrack);if((n==null?void 0:n.track)instanceof va){if(n.track.trackList.length>0){let i=n.track;n.track.trackList.forEach(a=>{i.removeAudioTrack(a)})}n.track.close()}this.localTrackMap.clear(),this.remoteUserMap.clear(),this.statsCollector.removeRemoteStats(),this.statsCollector.removeLocalStats(),this.iceFailedCount=0,this.dtlsFailedCount=0,this.pendingLocalTracks=[],this.pendingRemoteTracks=[],this.localDataChannels=[],this.remoteDataChannelMap.clear(),this.pendingLocalDataChannels=[],this.pendingRemoteDataChannels=[],this.state=or.Disconnected}getStats(){var n;return(n=this.connection)===null||n===void 0?void 0:n.getStats()}getRemoteVideoIsReady(n){var i;return((i=this.connection)===null||i===void 0?void 0:i.getRemoteVideoIsReady(n))||!1}getLocalAudioVolume(){let n=this.localTrackMap.get(Qe.LocalAudioTrack);if(n)return n.track.getVolumeLevel()}getLocalVideoSize(){let n=this.localTrackMap.get(Qe.LocalVideoTrack);if(n)return{width:n.track.videoWidth||0,height:n.track.videoHeight||0}}getEncoderConfig(n){let i=this.localTrackMap.get(n);return i&&i.track instanceof ni||i&&i.track instanceof Ui?i.track._encoderConfig:void 0}getLocalMedia(n){return this.localTrackMap.get(n)}hasLocalMedia(){return this.localTrackMap.size>0}hasRemoteMedia(n,i){if(!n)return this.remoteUserMap.size>0;let a=this.remoteUserMap.get(n);return!!a&&(!i||a.has(i))}async hasRemoteMediaWithLock(n,i){if(!n)return this.remoteUserMap.size>0;let a=this.remoteUserMap.get(n);return!!a&&(!i||a.has(i))}getRemoteMedia(n){var i;let a=Array.from(td(i=this.remoteUserMap).call(i)).find(c=>c.uid===n);return a?{audioTrack:a.audioTrack,audioSSRC:a._audioSSRC,videoTrack:a.videoTrack,videoSSRC:a._videoSSRC}:{}}getAudioLevels(){let n=Array.from(this.remoteUserMap.entries()).map(a=>{let[c]=a;return{uid:c.uid,level:c.audioTrack?100*c.audioTrack._source.getAccurateVolumeLevel():0}}),i=this.localTrackMap.get(Qe.LocalAudioTrack);return i&&n.push({level:100*i.track._source.getAccurateVolumeLevel(),uid:this.store.uid}),n=CR(n).call(n,(a,c)=>a.level-c.level),n}async disconnectForReconnect(){this.connection&&(z.debug("[".concat(this.store.clientId,"] P2PChannel.disconnectForReconnect closing P2PConnection")),this.state=or.Reconnecting,ge("KEEP_LAST_FRAME")&&this.remoteUserMap.size!==0&&Array.from(this.remoteUserMap.entries()).forEach(n=>{let[i]=n;var a;i._videoTrack&&i._videoTrack._player&&((a=i._videoTrack._player.getVideoElement())===null||a===void 0||a.pause(),i._videoTrack._player.isKeepLastFrame=!0,i._videoTrack._originMediaStreamTrack.stop())}),this.resetConnection(this.connection),this.connection=void 0,this.shouldForwardP2PCreation&&(this.connection=Kg(this.store),this.emit(Mt.PeerConnectionStateChange,this.connection.peerConnectionState),this.bindConnectionEvents(this.connection)),this.localTrackMap.size!==0&&(Array.from(this.localTrackMap.entries()).forEach(n=>{var i;let[a,{track:c}]=n;switch(a){case Qe.LocalVideoTrack:ft(i=c._hints).call(i,kr.LOW_STREAM)?c.close():this.pendingLocalTracks.push(c);break;case Qe.LocalAudioTrack:c instanceof va?this.pendingLocalTracks=this.pendingLocalTracks.concat(c.trackList):this.pendingLocalTracks.push(c);case Qe.LocalVideoLowTrack:}}),this.emit(Mt.MediaReconnectStart,this.store.uid)),this.unbindLocalTrackEvents(),this.localTrackMap.clear(),this.remoteUserMap.size!==0&&Array.from(this.remoteUserMap.entries()).forEach(n=>{let[i,a]=n;Array.from(td(a).call(a)).forEach(c=>{this.setPendingRemoteMedia(i,c)}),this.emit(Mt.MediaReconnectStart,i.uid)}),this.unbindAllRemoteTrackEvents(),this.remoteUserMap.clear(),this.localDataChannels.length!==0&&(this.localDataChannels.forEach(n=>{this.pendingLocalDataChannels.push(n)}),this.localDataChannels.length=0),this.remoteDataChannelMap.size!==0&&(Array.from(this.remoteDataChannelMap.entries()).forEach(n=>{let[i,a]=n;Array.from(td(a).call(a)).forEach(c=>{this.setPendingRemoteDataChannel(i,c)})}),this.remoteDataChannelMap.clear()),this.statsUploader.stopUploadOutboundStats(),this.statsUploader.stopUploadInboundStats(),this.statsUploader.stopUploadTransportStats(),z.debug("[".concat(this.store.clientId,"] P2PChannel disconnected, waiting to reconnect.")))}hasPendingRemoteDataChannel(n,i){for(let a of this.pendingRemoteDataChannels){let{user:c,id:u}=a;if((n instanceof Hg?n.uid:n)===c.uid&&u===i)return!0}return!1}setPendingRemoteDataChannel(n,i){this.hasPendingRemoteDataChannel(n,i)||this.pendingRemoteDataChannels.push({user:n,id:i})}hasPendingRemoteMedia(n,i){for(let a of this.pendingRemoteTracks){let{user:c,kind:u}=a;if((n instanceof Hg?n.uid:n)===c.uid&&i===u)return!0}return!1}setPendingRemoteMedia(n,i){this.hasPendingRemoteMedia(n,i)||this.pendingRemoteTracks.push({user:n,kind:i})}restartICE(n){var i=this;return Zl(function*(){if(!i.connection||i.state!==or.Connected)return;let a=yield Kn(i.mutex.lock("From P2PChannel.restartICE")),c;try{c=yield Kn(i.connection.restartICE(n));let _=yield Kn(c.next());if(_.done)return;let S=_.value,C=yield S;switch(C1(i.connection)&&i.reportPCStats(Date.now(),!1,i._pcStatsUploadType),n){case hi.UDP_TCP_RELAY:i._pcStatsUploadType=ad.UDP_TCP_RESTART;break;case hi.TCP_RELAY:i._pcStatsUploadType=ad.TCP_RESTART;break;case hi.RELAY:i._pcStatsUploadType=ad.RELAY_RESTART;break;default:i._pcStatsUploadType=ad.OLD_RESTART}i._isTryConnecting=!0,c.next(C)}catch(_){var u;(u=c)===null||u===void 0||u.throw(_)}finally{a()}})()}getUplinkNetworkQuality(){if(!this.connection)return 0;let n=this.connection.getStats(),i=this.localTrackMap.get(Qe.LocalVideoTrack),a=this.localTrackMap.get(Qe.LocalAudioTrack),c=n.videoSend.find(l=>l.ssrc===(i==null?void 0:i.ssrcs[0].ssrcId)),u=n.audioSend.find(l=>l.ssrc===(a==null?void 0:a.ssrcs[0].ssrcId));if(!c||!u)return 1;let _=ed(this,Mt.NeedSignalRTT),S=c?c.rttMs:void 0,C=u?u.rttMs:void 0,R=S&&C?(S+C)/2:S||C,e=(R&&_?(R+_)/2:R||_)||0,t=100*n.sendPacketLossRate*.7/50+.3*e/1500,r=t<.17?1:t<.36?2:t<.59?3:t<.1?4:5,s=i==null?void 0:i.track;if(s&&s._encoderConfig&&s._hints.indexOf(kr.SCREEN_TRACK)===-1){let l=s._encoderConfig.bitrateMax,f=n.bitrate.actualEncoded;if(l&&f){let m=(1e3*l-f)/(1e3*l);return tf[m<.15?0:m<.3?1:m<.45?2:m<.6?3:4][r]}}return r}getDownlinkNetworkQuality(){if(!this.connection)return 0;let n=this.connection.getStats(),i=0;return Array.from(this.remoteUserMap.entries()).forEach(a=>{let[c]=a,u=c._audioSSRC,_=c._videoSSRC,S=n.audioRecv.find(f=>f.ssrc===u),C=n.videoRecv.find(f=>f.ssrc===_);if(!S&&!C)return void(i+=1);let R=ed(this,Mt.NeedSignalRTT),e=n.rtt,t=(e&&R?(e+R)/2:e||R)||0,r=S?S.jitterMs:void 0,s=n.recvPacketLossRate,l=.7*s*100/50+.3*t/1500;r&&(l=.6*s*100/50+.2*t/1500+.2*r/400),i+=l<.1?1:l<.17?2:l<.36?3:l<.59?4:5}),this.remoteUserMap.size>0?Math.round(i/this.remoteUserMap.size):i}async muteLocalTrack(n){return new Et((i,a)=>{this.handleMuteLocalTrack(n,i,a)})}async replaceTrack(n,i){var a;if(z.debug("[".concat(this.store.clientId,"] P2PChannel replaceTrack from [").concat(n.getTrackId(),"] to [").concat(i.getTrackId(),"]")),!this.connection||this.state!==or.Connected)return;let c=Array.from(this.localTrackMap.entries()).find(_=>{let[,{track:S}]=_;return n===S});if(!c)return;let u=c[0];if(n!==i&&(this.unbindLocalTrackEvents([{track:n,type:u}]),this.bindLocalTrackEvents([{track:i,type:u}]),c[1].track=i),await((a=this.connection)===null||a===void 0?void 0:a.replaceTrack(i,c[1].id)),this.isPlanB){let _=c[1];_.id=i._mediaStreamTrack.id,this.localTrackMap.set(u,_)}if(u===Qe.LocalVideoTrack&&!ge("DISABLE_DUAL_STREAM_USE_ENCODING")&&Un().supportDualStreamEncoding){let _=this.localTrackMap.get(Qe.LocalVideoLowTrack);if(_){let S=n._mediaStreamTrack.clone();_.track._originMediaStreamTrack.stop(),_.track._mediaStreamTrack=S,_.track._originMediaStreamTrack=S,await new Et((C,R)=>{this.handleReplaceTrack(_.track,C,R,!0)})}}}filterTobePublishedTracks(n,i,a){let c=[],u=this.getAllTracks();n=L_(n=n.filter(R=>u.indexOf(R)===-1));let _,S=!1,C=this.localTrackMap.get(Qe.LocalAudioTrack);for(let R of n){if(R instanceof ni&&(this.localTrackMap.has(Qe.LocalVideoTrack)||S?new Ye(oe.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS).throw():(c.push({track:R,type:Qe.LocalVideoTrack}),S=!0),i)){let e=this.getLowVideoTrack(R,a);c.push({track:e,type:Qe.LocalVideoLowTrack})}if(R instanceof Ui)if(C){let e=C.track;if(e instanceof va)gD([R]),e.addAudioTrack(R),this.bindLocalAudioTrackEvents(R,!0);else{let t=_D([e,R]);z.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection will replace audioTrack [").concat(t.getTrackId(),"]")),this.replaceTrack(e,t)}}else _ instanceof va?(gD([R]),_.addAudioTrack(R)):_||!R._useAudioElement&&Un().webAudioMediaStreamDest&&!R._bypassWebAudio?_=_D(_?[R,_]:[R]):_=R}return _&&(z.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection will send audioTrack [").concat(_.getTrackId(),"]")),c.push({track:_,type:Qe.LocalAudioTrack})),c}filterTobeUnpublishedTracks(n){let i=[],a=this.getAllTracks();n=L_(n=n.filter(c=>a.indexOf(c)!==-1));for(let c of n){if(c instanceof Ui){let u=this.localTrackMap.get(Qe.LocalAudioTrack);if(!u)continue;u.track instanceof va?(u.track.removeAudioTrack(c),this.unbindLocalAudioTrackEvents(c),u.track.trackList.length===0&&(i.push([Qe.LocalAudioTrack,u]),u.track.close())):i.push([Qe.LocalAudioTrack,u])}if(c instanceof ni){let u=this.localTrackMap.get(Qe.LocalVideoTrack);if(!u)continue;i.push([Qe.LocalVideoTrack,u]);let _=this.localTrackMap.get(Qe.LocalVideoLowTrack);_&&i.push([Qe.LocalVideoLowTrack,_])}}return i}filterTobePublishedDataChannels(n){return n=(n=L_(n)).filter(i=>this.localDataChannels.findIndex(a=>a.id===i.id)===-1)}filterTobeUnpublishedDataChannels(n){return n=(n=(n=L_(n)).filter(i=>this.localDataChannels.indexOf(i)!==-1)).filter(i=>i._originDataChannel)}bindLocalTrackEvents(n){n.forEach(i=>{let{track:a,type:c}=i;switch(c){case Qe.LocalVideoTrack:a.addListener(bt.GET_STATS,this.handleGetLocalVideoStats),a.addListener(bt.GET_RTC_STATS,this.handleGetRTCStats),a.addListener(bt.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),a.addListener(bt.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),a.addListener(bt.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),a.addListener(bt.NEED_UPDATE_VIDEO_SEND_PARAMETERS,this.handleUpdateVideoSendParameters),a.addListener(bt.NEED_REPLACE_TRACK,this.handleReplaceTrack),a.addListener(bt.NEED_MUTE_TRACK,this.handleMuteLocalTrack),a.addListener(bt.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case Qe.LocalAudioTrack:this.bindLocalAudioTrackEvents(a);case Qe.LocalVideoLowTrack:}})}bindLocalAudioTrackEvents(n,i){n instanceof va?n.trackList.forEach(a=>{a.addListener(bt.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),a.addListener(bt.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),a.addListener(bt.GET_STATS,this.handleGetLocalAudioStats),a.addListener(bt.NEED_MUTE_TRACK,this.handleMuteLocalTrack),a.addListener(bt.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):(n.addListener(bt.GET_STATS,this.handleGetLocalAudioStats),n.addListener(bt.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),n.addListener(bt.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),n.addListener(bt.NEED_MUTE_TRACK,this.handleMuteLocalTrack),n.addListener(bt.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack),i||(n.addListener(bt.NEED_REPLACE_TRACK,this.handleReplaceTrack),n.addListener(bt.NEED_REPLACE_MIXING_TRACK,this.handleReplaceMixingTrack)))}unbindLocalTrackEvents(n){n||(n=Array.from(this.localTrackMap.entries()).map(i=>{let[a,{track:c}]=i;return{track:c,type:a}})),n.forEach(i=>{let{track:a,type:c}=i;switch(c){case Qe.LocalVideoTrack:a.off(bt.GET_STATS,this.handleGetLocalVideoStats),a.off(bt.GET_RTC_STATS,this.handleGetRTCStats),a.off(bt.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),a.off(bt.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),a.off(bt.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),a.off(bt.NEED_UPDATE_VIDEO_SEND_PARAMETERS,this.handleUpdateVideoSendParameters),a.off(bt.NEED_REPLACE_TRACK,this.handleReplaceTrack),a.off(bt.NEED_MUTE_TRACK,this.handleMuteLocalTrack),a.off(bt.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case Qe.LocalAudioTrack:this.unbindLocalAudioTrackEvents(a);case Qe.LocalVideoLowTrack:}})}unbindLocalAudioTrackEvents(n){n instanceof va?n.trackList.forEach(i=>{i.off(bt.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),i.off(bt.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),i.off(bt.GET_STATS,this.handleGetLocalAudioStats),i.off(bt.NEED_MUTE_TRACK,this.handleMuteLocalTrack),i.off(bt.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):(n.off(bt.GET_STATS,this.handleGetLocalAudioStats),n.off(bt.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),n.off(bt.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),n.off(bt.NEED_REPLACE_TRACK,this.handleReplaceTrack),n.off(bt.NEED_REPLACE_MIXING_TRACK,this.handleReplaceMixingTrack),n.off(bt.NEED_MUTE_TRACK,this.handleMuteLocalTrack),n.off(bt.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack))}bindRemoteTrackEvents(n,i){i instanceof j_&&i.addListener(bt.GET_STATS,a=>{a(this.handleGetRemoteVideoStats(n))}),i instanceof V_&&i.addListener(bt.GET_STATS,a=>{a(this.handleGetRemoteAudioStats(n))})}unbindRemoteTrackEvents(n){n&&n.removeAllListeners(bt.GET_STATS)}unbindAllRemoteTrackEvents(){Array.from(this.remoteUserMap.entries()).forEach(n=>{let[i,a]=n;a.has(Tt.AUDIO)&&this.unbindRemoteTrackEvents(i._audioTrack),a.has(Tt.VIDEO)&&this.unbindRemoteTrackEvents(i._videoTrack)})}createGatewayPublishMessage(n,i){return n.map((a,c)=>{var u;let _,S,{track:C,type:R}=a;switch(R){case Qe.LocalAudioTrack:_=lr.Audio,S={dtx:C instanceof mI&&C._config.DTX,hq:!1,lq:!1,stereo:!1,speech:!1};break;case Qe.LocalVideoTrack:_=ft(u=C._hints).call(u,kr.SCREEN_TRACK)?lr.Screen:lr.High,S=Qp(Qp({},z8(C)),{},{codec:this.store.codec,svc_mode:G_()});break;case Qe.LocalVideoLowTrack:_=lr.Low,S=Qp(Qp({},z8(C)),{},{codec:this.store.codec,svc_mode:G_()})}return{stream_type:_,attributes:S,ssrcs:i[c]}})}createGatewayUnpublishMessage(n){return n.map(i=>{var a;let c,[u,{track:_,ssrcs:S,id:C}]=i;switch(u){case Qe.LocalVideoTrack:c=ft(a=_._hints).call(a,kr.SCREEN_TRACK)?lr.Screen:lr.High;break;case Qe.LocalAudioTrack:c=lr.Audio;break;case Qe.LocalVideoLowTrack:c=lr.Low}return{stream_type:c,ssrcs:S,mid:C}})}assignLocalTracks(n,i){n.forEach((a,c)=>{let{track:u,type:_}=a;this.localTrackMap.set(_,{track:u,id:i[c].id,ssrcs:i[c].localSSRC})})}withdrawLocalTracks(n){n.forEach(i=>{let[a]=i;this.localTrackMap.delete(a)})}bindConnectionEvents(n){n.onConnectionStateChange=async i=>{if(z.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onConnectionStateChange(").concat(i,")")),this.emit(Mt.PeerConnectionStateChange,i),i==="connecting"&&n instanceof Ah&&!Ni()&&ge("FIRST_TCP_CANDIDATE")&&window.setTimeout(()=>{i==="connecting"&&n.extendCandidate()},ge("FIRST_TCP_CANDIDATE_INTERVAL")),i!=="connected"||this.store.keyMetrics.peerConnectionEnd||this.store.peerConnectionEnd(),i==="connected"&&(this._restartTimer&&(window.clearTimeout(this._restartTimer),this._restartTimer=void 0),n instanceof Ah&&Qt(n,!0),this._isTryConnecting&&this.reportPCStats(Date.now(),!0,this._pcStatsUploadType),this._isTryConnecting=!1,this._isStartRestartIce=!1,this._pcStatsUploadType=ad.DISCONNECTED_OR_FAILED,ed(this,Mt.QueryClientConnectionState)==="CONNECTED"&&this._isWaitPcToRePub)){let a=this.pendingLocalTracks.map(u=>u.getTrackId()),c=this.pendingLocalDataChannels.map(u=>"dc_".concat(u.id));jt.reportApiInvoke(this.store.sessionId,{name:bn.REPUB_AFTER_PC_CONNECTED,options:a.concat(c),tag:Li.TRACER}).onSuccess(),this.republish()}if(ge("NEW_ICE_RESTART")&&n instanceof Ah&&!Ni()&&!this._forceTurn){if(ft(Er).call(Er,i)){if(this._isStartRestartIce)return;this._isStartRestartIce=!0;let a=u=>{C1(n)&&(z.debug("[".concat(this.store.clientId,"] [P2PChannel] try to restartICE, type is ").concat(u)),ed(this,Mt.QueryClientConnectionState)==="CONNECTED"&&this.emit(Mt.RequestRestartICE,u))},c=()=>{C1(n)&&(this.reportPCStats(Date.now(),!1,this._pcStatsUploadType),z.debug("[".concat(this.store.clientId,"] P2PConnection disconnected timeout, force reconnect")),setTimeout(()=>this.emit(Mt.P2PLost),0),this.iceFailedCount+=1,this.requestReconnect())};return void(this._restartTimer=window.setTimeout(()=>{qU(n,a,c)},800))}}else{if(i==="disconnected"&&n.iceConnectionState==="disconnected")return setTimeout(()=>{n.iceConnectionState==="disconnected"&&ge("ICE_RESTART")&&ed(this,Mt.QueryClientConnectionState)==="CONNECTED"&&this.emit(Mt.RequestRestartICE)},800),void setTimeout(()=>{n.peerConnectionState==="disconnected"&&(z.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection disconnected timeout 4000ms, force reconnect")),this.reportPCStats(Date.now(),!1,this._pcStatsUploadType),this._isTryConnecting=!1,setTimeout(()=>this.emit(Mt.P2PLost),0),this.iceFailedCount+=1,this.requestReconnect())},4e3);i==="failed"&&(z.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection state failed, force reconnect")),this.reportPCStats(Date.now(),!1,this._pcStatsUploadType),setTimeout(()=>this.emit(Mt.P2PLost),0),this.iceFailedCount+=1,await this.requestReconnect())}},n.onICEConnectionStateChange=i=>{i!=="connected"||this.store.keyMetrics.iceConnectionEnd||this.store.iceConnectionEnd(),z.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICEConnectionStateChange(").concat(i,")")),jt.reportApiInvoke(this.store.sessionId,{name:"ICEConnectionStateChange",options:i,tag:Li.TRACER}).onSuccess(),this.emit(Mt.IceConnectionStateChange,i)},n.onICETransportStateChange=i=>{z.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICETransportStateChange(").concat(i,")"))},n.onDTLSTransportStateChange=i=>{z.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportStateChange(").concat(i,")"))},n.onDTLSTransportError=i=>{z.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportError(").concat(i,")"))},n.onFirstAudioDecoded=i=>{var a;let c=Array.from(td(a=this.remoteUserMap).call(a)).find(_=>_._audioSSRC===i);var u;c&&(this.store.subscribe(c.uid,"audio",void 0,void 0,void 0,Date.now()),(u=c.audioTrack)===null||u===void 0||u.emit(Mg.FIRST_FRAME_DECODED),jt.firstRemoteFrame(this.store.sessionId,qt.FIRST_AUDIO_DECODE,di.FIRST_AUDIO_DECODE,{peer:c._uintid,subscribeElapse:Cs.measureFromSubscribeStart(this.store.clientId,i),subscribeRequestid:i,p2pid:this.store.p2pId}))},n.onFirstAudioReceived=i=>{var a;let c=Array.from(td(a=this.remoteUserMap).call(a)).find(u=>u._audioSSRC===i);c&&jt.firstRemoteFrame(this.store.sessionId,qt.FIRST_AUDIO_RECEIVED,di.FIRST_AUDIO_RECEIVED,{peer:c._uintid,subscribeElapse:Cs.measureFromSubscribeStart(this.store.clientId,i),subscribeRequestid:i,p2pid:this.store.p2pId})},n.onFirstVideoDecoded=(i,a,c)=>{this.reportVideoFirstFrameDecoded(i,a,c)},n.onFirstVideoReceived=i=>{var a;let c=Array.from(td(a=this.remoteUserMap).call(a)).find(u=>u._videoSSRC===i);c&&jt.firstRemoteFrame(this.store.sessionId,qt.FIRST_VIDEO_RECEIVED,di.FIRST_VIDEO_RECEIVED,{peer:c._uintid,subscribeElapse:Cs.measureFromSubscribeStart(this.store.clientId,i),subscribeRequestid:i,p2pid:this.store.p2pId})},n.onSelectedLocalCandidateChanged=(i,a)=>{let c=i.candidateType==="relay",u=a.candidateType==="relay";a.candidateType!=="unknown"&&c===u||this.emit(Mt.ConnectionTypeChange,c),z.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedLocalCandidateChanged(").concat(JSON.stringify(Jp(a))," -> ").concat(JSON.stringify(Jp(i)),")"))},n.onSelectedRemoteCandidateChanged=(i,a)=>{z.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedRemoteCandidateChanged(").concat(JSON.stringify(Jp(a))," -> ").concat(JSON.stringify(Jp(i)),")"))},n.onFirstVideoDecodedTimeout=i=>{this.reportVideoFirstFrameDecoded(i,void 0,void 0,!0)},n.getLocalVideoStats=()=>{let i=this.statsCollector.getLocalVideoTrackStats(),a=this.statsCollector.getRTCStats();return Qp(Qp({},i),a)},n.onICECandidateError=i=>{this._iceError=i}}resetConnection(n){n instanceof Ah&&function(i){Jg.delete(i.id),Qt(i)}(n),n.close(),this.emit(Mt.PeerConnectionStateChange,"closed"),function(i){i.onConnectionStateChange=void 0,i.onICEConnectionStateChange=void 0,i.onICETransportStateChange=void 0,i.onDTLSTransportStateChange=void 0,i.onDTLSTransportError=void 0,i.onFirstAudioDecoded=void 0,i.onFirstAudioReceived=void 0,i.onFirstVideoDecoded=void 0,i.onFirstVideoReceived=void 0,i.onSelectedLocalCandidateChanged=void 0,i.onSelectedRemoteCandidateChanged=void 0,i.onFirstVideoDecodedTimeout=void 0,i.getLocalVideoStats=void 0}(n),this._isWaitPcToRePub=!1}filterTobeMutedTracks(n){let i=[];if(this.getAllTracks().indexOf(n)===-1)return i;let a=this.localTrackMap.get(Qe.LocalAudioTrack);if(n instanceof Ui&&(a==null?void 0:a.track)instanceof va)return a.track.isActive||i.push([Qe.LocalAudioTrack,a]),i;let c=Array.from(this.localTrackMap.entries()).find(u=>{let[,{track:_}]=u;return n===_});if(c&&(i.push(c),c[0]===Qe.LocalVideoTrack)){let u=this.localTrackMap.get(Qe.LocalVideoLowTrack);u&&i.push([Qe.LocalVideoLowTrack,u])}return i}filterTobeUnmutedTracks(n){let i=[],a=this.localTrackMap.get(Qe.LocalAudioTrack);if(n instanceof Ui&&(a==null?void 0:a.track)instanceof va)return a.track.isActive&&i.push([Qe.LocalAudioTrack,a]),i;let c=Array.from(this.localTrackMap.entries()).find(u=>{let[,{track:_}]=u;return n===_});if(c)if(c[0]===Qe.LocalVideoTrack){i.push(c);let u=this.localTrackMap.get(Qe.LocalVideoLowTrack);u&&i.push([Qe.LocalVideoLowTrack,u])}else i.push(c);return i}createMuteMessage(n){return n.map(i=>{var a;let c,[u,{track:_,ssrcs:S,id:C}]=i;switch(u){case Qe.LocalAudioTrack:c=lr.Audio;break;case Qe.LocalVideoTrack:c=ft(a=_._hints).call(a,kr.SCREEN_TRACK)?lr.Screen:lr.High;break;case Qe.LocalVideoLowTrack:c=lr.Low}return{stream_type:c,ssrcs:S,mid:C}})}createUnmuteMessage(n){return n.map(i=>{var a;let c,[u,{track:_,ssrcs:S,id:C}]=i;switch(u){case Qe.LocalAudioTrack:c=lr.Audio;break;case Qe.LocalVideoTrack:c=ft(a=_._hints).call(a,kr.SCREEN_TRACK)?lr.Screen:lr.High;break;case Qe.LocalVideoLowTrack:c=lr.Low}return{stream_type:c,ssrcs:S,mid:C}})}filterTobeUnSubscribedTracks(n,i){let a=[],c=this.remoteUserMap.get(n);if(!c)return a;if(i){let u=c.get(i);if(!u)return a;a.push([n,{kind:i,id:u}])}else Array.from(c.entries()).forEach(u=>{let[_,S]=u;a.push([n,{kind:_,id:S}])});return a}filterTobeUnSubscribedDataChannels(n,i){let a=[];return i.forEach(c=>{var u;(u=this.remoteDataChannelMap.get(n))!==null&&u!==void 0&&u.has(c.id)&&a.push(c)}),a}createUnsubscribeMessage(n){let i=[];return n.forEach(a=>{let[c,{kind:u,id:_}]=a;switch(u){case Tt.VIDEO:return void(c._videoSSRC&&i.push({stream_type:Tt.VIDEO,ssrcId:c._videoSSRC}));case Tt.AUDIO:return void(c._audioSSRC&&i.push({stream_type:Tt.AUDIO,ssrcId:c._audioSSRC}))}}),i}createUnsubscribeAllMessage(n){let i=new Map;return n.forEach(a=>{let[c,{kind:u}]=a;if(i.has(c)){let _=i.get(c);u===Tt.VIDEO?_|=Wa.Video:_|=Wa.Audio,i.set(c,_)}else u===Tt.VIDEO?i.set(c,Wa.Video):i.set(c,Wa.Audio)}),{users:Array.from(i.entries()).map(a=>{let[c,u]=a;return{stream_id:c.uid,stream_type:u}})}}withdrawRemoteTracks(n){n.forEach(i=>{let[a,{kind:c}]=i,u=this.remoteUserMap.get(a);u&&(u.delete(c),Array.from(u.entries()).length===0&&this.remoteUserMap.delete(a))})}async updateBitrateLimit(n){let i=this.localTrackMap.get(Qe.LocalVideoTrack),a=this.localTrackMap.get(Qe.LocalVideoLowTrack);i&&(await i.track.setBitrateLimit(n.uplink),await new Et((c,u)=>{this.handleUpdateVideoEncoder(i.track,c,u,!0)})),a&&n.low_stream_uplink&&(await a.track.setBitrateLimit({max_bitrate:n.low_stream_uplink.bitrate,min_bitrate:n.low_stream_uplink.bitrate||0}),await new Et((c,u)=>{this.handleUpdateVideoEncoder(a.track,c,u,!0)}))}isP2PDisconnected(){return this.connection?this.connection.peerConnectionState!=="connected":!0}mapPubResToRemoteConfig(n,i,a){return n.map((c,u)=>{var _;let{stream_type:S}=c,C=(_=i.find(R=>{let{stream_type:e}=R;return S===e}))===null||_===void 0?void 0:_.attributes;if(C&&ge("DISABLE_SCREEN_SHARE_REMB")){let R=a[u]._hints;(ft(R).call(R,kr.SCREEN_TRACK)||ft(R).call(R,kr.SCREEN_LOW_TRACK))&&(C.remb=!1,z.debug("disable remb for screen share, hints:",R))}return C})}async tryToUnmuteAudio(n){for(let a=0;a<n.length;a++)if(n[a]instanceof Ui){var i;let c=this.filterTobeUnmutedTracks(n[a]);if(c.length===0)continue;await((i=this.connection)===null||i===void 0?void 0:i.unmuteLocal(c.map(_=>{let[,{id:S}]=_;return S})));let u=this.createUnmuteMessage(c);return void await Vr(this,Mt.RequestUnmuteLocal,u)}}bindStatsUploaderEvents(){this.statsUploader.requestStats=()=>this.getStats(),this.statsUploader.requestLocalMedia=()=>Array.from(this.localTrackMap.entries()),this.statsUploader.requestRemoteMedia=()=>Array.from(this.remoteUserMap.entries()),this.statsUploader.requestVideoIsReady=n=>{var i;return!((i=this.connection)===null||i===void 0||!i.getRemoteVideoIsReady(n))},this.statsUploader.requestUpload=(n,i)=>this.emit(Mt.RequestUpload,n,i),this.statsUploader.requestUploadStats=n=>this.emit(Mt.RequestUploadStats,n),this.statsUploader.requestAllTracks=()=>this.getAllTracks(),this.statsUploader.requestTransportStats=()=>{var n;return{connectState:((n=this.connection)===null||n===void 0?void 0:n.peerConnectionState)||"closed"}}}unbindStatsUploaderEvents(){this.statsUploader.requestStats=void 0,this.statsUploader.requestLocalMedia=void 0,this.statsUploader.requestRemoteMedia=void 0,this.statsUploader.requestVideoIsReady=void 0}async requestReconnect(){this.dtlsFailedCount+=1,await Mn(vL(this.dtlsFailedCount,da)),this.emit(Mt.RequestReconnect)}async reconnectP2P(){let n=Array.from(this.localTrackMap.entries()),i=this.createGatewayUnpublishMessage(n);Array.from(this.remoteUserMap.entries()),i.length>0&&await Bn(this,Mt.RequestUnpublishForReconnectPC,i),this.disconnectForReconnect(),this.emit(Mt.RequestReconnectPC)}canPublishLowStream(){return this.localTrackMap.has(Qe.LocalVideoTrack)||this.pendingLocalTracks.some(n=>n instanceof ni)}throwIfTrackTypeNotMatch(n){if(n.filter(i=>i instanceof ni).length>1)throw new Ye(oe.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(n.filter(i=>i instanceof Ui).length>1&&(n.some(i=>i instanceof Ui&&i._bypassWebAudio)||!Un().webAudioMediaStreamDest))throw new Ye(oe.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode");for(let i of n){if(i instanceof ni&&this.pendingLocalTracks.some(a=>a instanceof ni))throw new Ye(oe.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(i instanceof Ui&&this.pendingLocalTracks.some(a=>a instanceof Ui)&&(!Un().webAudioMediaStreamDest||i._bypassWebAudio||this.pendingLocalTracks.some(a=>a instanceof Ui&&a._bypassWebAudio)))throw new Ye(oe.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode")}}getLowVideoTrack(n,i){var a;let c=!ge("DISABLE_DUAL_STREAM_USE_ENCODING")&&Un().supportDualStreamEncoding,u=Qp(Qp({},{width:160,height:120,framerate:15,bitrate:50}),i),_;_=c?n._mediaStreamTrack.clone():HU(n,u);let S=gr(8,"track-low-"),C=new ni(_,Qp(Qp({},c&&{scaleResolutionDownBy:eD(u,n)}),{},{frameRate:u.framerate,bitrateMax:u.bitrate,bitrateMin:u.bitrate}),void 0,void 0,S);return C.on(Bo.TRANSCEIVER_UPDATED,R=>{n._updateRtpTransceiver(R,qb.LOW_STREAM)}),C._hints.push(kr.LOW_STREAM),ft(a=n._hints).call(a,kr.SCREEN_TRACK)&&C._hints.push(kr.SCREEN_LOW_TRACK),n.on("sei-to-send",R=>{C.emit("sei-to-send",R)}),n.addListener(bt.NEED_CLOSE,()=>{C.close()}),C}async globalLock(){return this.mutex.lock("From P2PChannel.globalLock")}async reportPCStats(n,i,a){let c=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;if(this.connection&&this.connection instanceof Ah){var u,_,S,C;let R=this.store.keyMetrics.descriptionStart||0,{iceConnectionState:e,dtlsTransportState:t,peerConnectionState:r}=this.connection,{local:s,remote:l}=await this.connection.getSelectedCandidatePair();jt.pcStats(this.store.sessionId,{startTime:R,eventElapse:n-R||0,iceconnectionsate:e,dtlsstate:t,connectionstate:r,intSucc:i?1:2,error:this._iceError||c||"",selectedLocalCandidateProtocol:(u=s==null?void 0:s.protocol)!==null&&u!==void 0?u:"",selectedLocalCandidateType:(_=s.candidateType)!==null&&_!==void 0?_:"",selectedLocalCandidateAddress:"".concat(s.address,":").concat(s.port),selectedRemoteCandidateProtocol:(S=l.protocol)!==null&&S!==void 0?S:"",selectedRemoteCandidateType:(C=l.candidateType)!==null&&C!==void 0?C:"",selectedRemoteCandidateAddress:"".concat(l.address,":").concat(l.port),restartCnt:a,preallocation:this.connection.isPreallocation}),this._iceError=null}}reportVideoFirstFrameDecoded(n,i,a,c){var u;let _=Array.from(td(u=this.remoteUserMap).call(u)).find(S=>S._videoSSRC===n);if(_){c||this.store.subscribe(_.uid,"video",void 0,void 0,void 0,void 0,Date.now());let S=this.store.keyMetrics,C=S.subscribe.find(R=>R.userId===_.uid&&R.type==="video");jt.firstRemoteVideoDecode(this.store.sessionId,qt.FIRST_VIDEO_DECODE,di.FIRST_VIDEO_DECODE,{peer:_._uintid,videowidth:i,videoheight:a,subscribeElapse:Cs.measureFromSubscribeStart(this.store.clientId,n),subscribeRequestid:n,p2pid:this.store.p2pId,apEnd:S.requestAPEnd||0,apStart:S.requestAPStart||0,joinGwEnd:S.joinGatewayEnd||0,joinGwStart:S.joinGatewayStart||0,pcEnd:S.peerConnectionEnd||0,pcStart:S.peerConnectionStart||0,subscriberEnd:(C==null?void 0:C.subscribeEnd)||0,subscriberStart:(C==null?void 0:C.subscribeStart)||0,videoAddNotify:(C==null?void 0:C.streamAdded)||0,state:c?1:0,firstFrame:(C==null?void 0:C.firstFrame)||0})}}async remoteMediaSsrcChanged(n,i,a){if(!this.connection)return!1;let c=this.remoteUserMap.get(n);if(!c)return!1;let u=c.get(i);if(!u)return!1;let _=await this.connection.getRemoteSSRC(u);return _!==void 0&&_!==a}unbindRtpTransceiver(){this.localTrackMap.size!==0&&Array.from(this.localTrackMap.entries()).forEach(n=>{let[i,{track:a}]=n;i===Qe.LocalVideoLowTrack?a._updateRtpTransceiver(void 0,qb.LOW_STREAM):a._updateRtpTransceiver(void 0)})}},Ut(Cn.prototype,"startP2PConnection",[Hs],Object.getOwnPropertyDescriptor(Cn.prototype,"startP2PConnection"),Cn.prototype),Ut(Cn.prototype,"connect",[Hs],Object.getOwnPropertyDescriptor(Cn.prototype,"connect"),Cn.prototype),Ut(Cn.prototype,"updateRemoteRTPCapabilities",[Hs],Object.getOwnPropertyDescriptor(Cn.prototype,"updateRemoteRTPCapabilities"),Cn.prototype),Ut(Cn.prototype,"publishDataChannel",[Hs],Object.getOwnPropertyDescriptor(Cn.prototype,"publishDataChannel"),Cn.prototype),Ut(Cn.prototype,"unpublish",[Hs],Object.getOwnPropertyDescriptor(Cn.prototype,"unpublish"),Cn.prototype),Ut(Cn.prototype,"unpublishDataChannel",[Hs],Object.getOwnPropertyDescriptor(Cn.prototype,"unpublishDataChannel"),Cn.prototype),Ut(Cn.prototype,"unpublishLowStream",[Hs],Object.getOwnPropertyDescriptor(Cn.prototype,"unpublishLowStream"),Cn.prototype),Ut(Cn.prototype,"subscribeDataChannel",[Hs],Object.getOwnPropertyDescriptor(Cn.prototype,"subscribeDataChannel"),Cn.prototype),Ut(Cn.prototype,"subscribe",[Hs],Object.getOwnPropertyDescriptor(Cn.prototype,"subscribe"),Cn.prototype),Ut(Cn.prototype,"massSubscribe",[Hs],Object.getOwnPropertyDescriptor(Cn.prototype,"massSubscribe"),Cn.prototype),Ut(Cn.prototype,"unsubscribe",[Hs],Object.getOwnPropertyDescriptor(Cn.prototype,"unsubscribe"),Cn.prototype),Ut(Cn.prototype,"unsubscribeDataChannel",[Hs],Object.getOwnPropertyDescriptor(Cn.prototype,"unsubscribeDataChannel"),Cn.prototype),Ut(Cn.prototype,"massUnsubscribe",[Hs],Object.getOwnPropertyDescriptor(Cn.prototype,"massUnsubscribe"),Cn.prototype),Ut(Cn.prototype,"muteRemote",[Hs],Object.getOwnPropertyDescriptor(Cn.prototype,"muteRemote"),Cn.prototype),Ut(Cn.prototype,"unmuteRemote",[Hs],Object.getOwnPropertyDescriptor(Cn.prototype,"unmuteRemote"),Cn.prototype),Ut(Cn.prototype,"hasRemoteMediaWithLock",[Hs],Object.getOwnPropertyDescriptor(Cn.prototype,"hasRemoteMediaWithLock"),Cn.prototype),Ut(Cn.prototype,"disconnectForReconnect",[Hs],Object.getOwnPropertyDescriptor(Cn.prototype,"disconnectForReconnect"),Cn.prototype),Ut(Cn.prototype,"updateBitrateLimit",[Hs],Object.getOwnPropertyDescriptor(Cn.prototype,"updateBitrateLimit"),Cn.prototype),Ut(Cn.prototype,"remoteMediaSsrcChanged",[Hs],Object.getOwnPropertyDescriptor(Cn.prototype,"remoteMediaSsrcChanged"),Cn.prototype),Cn);function Hs(n,i,a){let c=n[i];if(typeof c!="function")throw new Error("Cannot use mutex on object property.");return a.value=async function(){let u=this.mutex,_=await u.lock("From P2PChannel.".concat(i));try{for(var S=arguments.length,C=new Array(S),R=0;R<S;R++)C[R]=arguments[R];return await c.apply(this,C)}finally{_()}},a}function XU(n,i){var a=Object.keys(n);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(n);i&&(c=c.filter(function(u){return Object.getOwnPropertyDescriptor(n,u).enumerable})),a.push.apply(a,c)}return a}function QU(n){for(var i=1;i<arguments.length;i++){var a=arguments[i]!=null?arguments[i]:{};i%2?XU(Object(a),!0).forEach(function(c){re(n,c,a[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(a)):XU(Object(a)).forEach(function(c){Object.defineProperty(n,c,Object.getOwnPropertyDescriptor(a,c))})}return n}let On=Date.now(),tF=20,ff=new Map,zI=new Map;async function HI(n){let i=ff.get(n),a=Array.isArray(i)&&i[i.length-1],c=zI.get(n);if(!a)return void(c.isSyncing=!1);let u={uid:a.uid,payload:a.payload};c.firstRecvTs===0&&(c.firstRecvTs=a.recvTs,c.firstSendTs=a.sendTs);let _=a.sendTs-c.firstSendTs,S=_-(Date.now()-c.firstRecvTs);S>0&&(c.firstRecvTs=Date.now()-_);let C=a.mediaDelay+S;C<=0?(i.pop(),w1(a.context,u),C=0):C=Math.min(C,tF),setTimeout(()=>i.length&&HI(n),C)}function w1(n,i){n.safeEmit(Xt.STREAM_MESSAGE,i.uid,i.payload),n.onStreamMessage&&n.onStreamMessage(i)}function Io(n){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=arguments.length>2?arguments[2]:void 0;if(!n.syncWithAudio)return w1(a,{uid:n.uid,payload:n.payload});let c="".concat(a.id,"-").concat(n.uid),u=ff.get(c)||[],_=u.findIndex(e=>n.sendTs>=e.sendTs),S=QU(QU({},n),{},{context:a,mediaDelay:i,recvTs:Date.now()});_===-1?u.push(S):u.splice(_,0,S),ff.set(c,u);let C=!1;var R;zI.has(c)?C=!((R=zI.get(c))===null||R===void 0||!R.isSyncing):zI.set(c,{isSyncing:C,firstRecvTs:0,firstSendTs:0}),C||HI(c)}let nF=En().name;function ZU(n,i){var a=Object.keys(n);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(n);i&&(c=c.filter(function(u){return Object.getOwnPropertyDescriptor(n,u).enumerable})),a.push.apply(a,c)}return a}function rF(n){for(var i=1;i<arguments.length;i++){var a=arguments[i]!=null?arguments[i]:{};i%2?ZU(Object(a),!0).forEach(function(c){re(n,c,a[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(a)):ZU(Object(a)).forEach(function(c){Object.defineProperty(n,c,Object.getOwnPropertyDescriptor(a,c))})}return n}let R1="websdk_ng_cache_parameter",$U=ge("MAX_PRELOAD_ASYNC_LENGTH"),vD=1e4,q_=new Map,J_=[],e6=null,t6=0,SD=0,WI=new Map,I1=function(n,i){let a=[],c=0,u=async()=>{let _=a.shift();_&&await _(),a.length>0&&c<i?u():c--};return async function(){for(var _=arguments.length,S=new Array(_),C=0;C<_;C++)S[C]=arguments[C];return new Et(async(R,e)=>{a.push(async()=>{try{let t=await n(...S);R(t)}catch(t){e(t)}}),c<i&&(c++,u())})}}(iF,$U),n6=eo.CancelToken.source();async function iF(n,i,a,c,u,_){try{if(!ge("ENABLE_PRELOAD"))return;if(!Un().supportWebCrypto)return void la(()=>{z.warn("Your browser does not support preloading, this feature  be run in a secure environment")},"preload_webcrypto_not_supported");if(!a&&a!==null)throw new Ye(oe.INVALID_PARAMS,"Invalid token: ".concat(a,". If you don not use token, set it to null"));a&&Pa(a,"token",1,2047),Pa(n,"appid",1,2047),JL(i),c&&XL(c);let S=D_();z.debug("preload channel ".concat(i,", uid is ").concat(c));let C={appId:n,cname:i,token:a||n,uid:typeof c!="string"?c:null,sid:S,proxyServer:u},R,e;typeof c=="string"?(C.stringUid=c,[e,R]=await Et.all([PU(c,{sid:S,appId:n},n6.token),MU(rF(rF({},C),{},{token:a||n,uid:0}),n6.token)]),C.uid=e.uid,R.gatewayInfo.uid=C.uid,R.gatewayInfo.res.uid=C.uid):(_&&(C.stringUid=_),R=await MU(C,n6.token));let t={sid:S,appId:n,cname:i,token:a||n,uid:C.stringUid||c,intUid:C.uid||R.gatewayInfo.uid,stringUid:C.stringUid,ts:Date.now(),sua:e,ap:R};await async function(r){let s;try{r.uid&&Q_({appId:r.appId,cname:r.cname,token:r.token,uid:r.uid,stringUid:r.stringUid});let l=CD(r),f=await async function(E,y){try{let b=await window.crypto.subtle.importKey("raw",Fb(y),"AES-GCM",!1,["encrypt"]),A=await window.crypto.subtle.encrypt({name:"AES-GCM",iv:new Uint8Array(1)},b,fr(window.btoa(JSON.stringify(E))));return Gs(new Uint8Array(A))}catch{return}}(r,r.token||r.appId);if(!f)return;s=KI(R1);let m=s?JSON.parse(s):[];m.push({[l]:f}),m.length>ge("AP_CACHE_NUM")&&m.shift(),bD(R1,JSON.stringify(m))}catch(l){z.warn("Error caching server parameters:",l.message),bD(R1,"")}}(t),t6++}catch(S){throw SD++,function(C){e6||(e6=window.setTimeout(()=>{let e="";WI.forEach((t,r)=>{e+="".concat(r,": ").concat(t," ;")}),jt.reportApiInvoke(null,{name:bn.PRELOAD,options:{success:t6,failed:SD,err:e}}).onError(C),t6=0,SD=0,WI.clear(),e6=null},vD));let R=WI.get(C.code)||0;WI.set(C.code,R+1)}(S),S}}async function X_(n){try{if(ge("AP_REQUEST_DETAIL")||ge("ENABLE_ROLE_SELECT_EDGE"))return;let i=Q_(n);if(!i||n.cloudProxyServer!=="disabled")return;let a=await async function(c,u){try{let _=await window.crypto.subtle.importKey("raw",Fb(u),"AES-GCM",!1,["decrypt"]),S=await window.crypto.subtle.decrypt({name:"AES-GCM",iv:new Uint8Array(1)},_,fr(c));return JSON.parse(window.atob(Gs(new Uint8Array(S))))}catch{return}}(i,n.token||n.appId);if(!a||!function(c,u){return c.cname===u.cname&&c.appId===u.appId&&c.token===u.token?u.stringUid?c.stringUid===u.stringUid:typeof u.uid=="number"?c.uid===u.uid:c.uid==u.uid:!1}(a,n))return;if(a&&Date.now()-a.ts<ge("AP_CACHE_LIFETIME"))return a}catch(i){z.warn("Error get preloadInfo",i.message)}}function Q_(n){let i;try{if(i=KI(R1),!i)return;let a=JSON.parse(i),c=CD(n),u=function(S,C){for(let R=S.length-1;R>=0;R--)if(C(S[R]))return R;return-1}(a,S=>c in S);if(u===-1)return;let _=a.splice(u,1)[0];return bD(R1,JSON.stringify(a)),_[c]}catch(a){z.warn("Error delete preload info: ".concat(i),a.message),bD(R1,"")}}function YI(n){if(n){let i=q_.get(n);i&&(window.clearTimeout(i),i=null,q_.delete(n)),ft(J_).call(J_,n)||n.cloudProxyServer!=="disabled"||J_.push(n)}if(q_.size<ge("AP_CACHE_NUM")&&J_.length>0){let i=J_.shift();q_.set(i,window.setTimeout(async()=>{let{appId:a,cname:c,token:u,stringUid:_,uid:S,proxyServer:C}=i;try{await I1(a,c,u,S,C,_),q_.has(i)&&YI(i)}catch(R){z.warn("update preload failed",R.message),yD(i)}},ge("AP_UPDATE_INTERVAL")))}}function yD(n){let i=J_.indexOf(n);i!==-1&&J_.splice(i,1);let a=q_.get(n);a&&(window.clearTimeout(a),a=null,q_.delete(n),YI())}function TD(n,i){let a=n.sua,c=n.ap;i&&a&&jt.reqUserAccount(n.sid,{lts:a.requestTime,elapse:a.elapse,success:!0,serverAddr:a.url,stringUid:i,uid:n.intUid,errorCode:null,extend:a.req}),jt.reportResourceTiming(n.ap.url,n.sid),jt.joinWebProxyAP(n.sid,{lts:c.requestTime,elapse:c.elapse,sucess:1,apServerAddr:c.url,turnServerAddrList:c.proxyInfo.addresses.map(u=>u.ip).join(","),eventType:"disabled",unilbsServerIds:[aa.CHOOSE_SERVER,aa.CLOUD_PROXY_FALLBACK].toString()}),jt.joinChooseServer(n.sid,{lts:c.requestTime,elapse:c.elapse,succ:!0,csAddr:c.url,opid:c.opid,serverList:c.gatewayInfo.gatewayAddrs.map(u=>u.address),ec:null,cid:c.gatewayInfo.cid.toString(),uid:c.gatewayInfo.uid.toString(),csIp:c.gatewayInfo.csIp,unilbsServerIds:[aa.CHOOSE_SERVER].toString(),isHttp3:c.isHttp3})}function KI(n){return window.atob(window.localStorage.getItem(n)||"")}function bD(n,i){window.localStorage.setItem(n,window.btoa(i))}function CD(n){let i="".concat(n.appId,"_").concat(n.cname);return typeof n.uid=="string"&&(i+="_s_".concat(n.uid)),typeof n.uid=="number"&&(i+="_".concat(n.uid)),n.token&&(i+="_".concat(n.token)),d8(i)}function aF(n){let i=function(){let a=cF.pop();return a?(a.offset=a.limit=0,a):{bytes:new Uint8Array(64),offset:0,limit:0}}();return function(a,c){let u=a.appId;u!==void 0&&(ua(c,10),$_(c,u));let _=a.cid;_!==void 0&&(ua(c,16),ua(c,_));let S=a.cname;S!==void 0&&(ua(c,26),$_(c,S));let C=a.deviceId;C!==void 0&&(ua(c,34),$_(c,C));let R=a.elapse;R!==void 0&&(ua(c,40),Qg(c,R));let e=a.fileSize;e!==void 0&&(ua(c,48),Qg(c,Z_(e)));let t=a.height;t!==void 0&&(ua(c,56),Qg(c,Z_(t)));let r=a.jpg;r!==void 0&&(ua(c,66),ua(c,r.length),dF(c,r));let s=a.networkType;s!==void 0&&(ua(c,72),Qg(c,Z_(s)));let l=a.osType;l!==void 0&&(ua(c,80),Qg(c,Z_(l)));let f=a.requestId;f!==void 0&&(ua(c,90),$_(c,f));let m=a.sdkVersion;m!==void 0&&(ua(c,98),$_(c,m));let E=a.sequence;E!==void 0&&(ua(c,104),Qg(c,Z_(E)));let y=a.sid;y!==void 0&&(ua(c,114),$_(c,y));let b=a.timestamp;b!==void 0&&(ua(c,120),Qg(c,b));let A=a.uid;A!==void 0&&(ua(c,128),ua(c,A));let O=a.vid;O!==void 0&&(ua(c,136),ua(c,O));let D=a.width;D!==void 0&&(ua(c,144),Qg(c,Z_(D)));let P=a.service;P!==void 0&&(ua(c,152),ua(c,P));let F=a.callbackData;F!==void 0&&(ua(c,162),ua(c,F.length),dF(c,F));let B=a.ticket;B!==void 0&&(ua(c,170),$_(c,B));let Y=a.vendorConfigs;Y!==void 0&&(ua(c,178),$_(c,Y))}(n,i),function(a){let c=a.bytes,u=a.limit;return c.length===u?c:c.subarray(0,u)}(i)}function sF(n){return function(a){let c={};e:for(;!lF(a);){let u=zS(a);switch(u>>>3){case 0:break e;case 1:c.code=zS(a);break;case 2:c.msg=uF(a,zS(a));break;case 3:c.requestId=uF(a,zS(a));break;case 4:c.timestamp=RD(a,!1);break;default:oF(a,7&u)}}return c}({bytes:i=n,offset:0,limit:i.length});var i}function oF(n,i){switch(i){case 0:for(;128&hc(n););break;case 2:wD(n,zS(n));break;case 5:wD(n,4);break;case 1:wD(n,8);break;default:throw new Error("Unimplemented type: "+i)}}function Z_(n){return{low:n|=0,high:n>>31,unsigned:n>=0}}let cF=[];function wD(n,i){if(n.offset+i>n.limit)throw new Error("Skip past limit");n.offset+=i}function lF(n){return n.offset>=n.limit}function GS(n,i){let a=n.bytes,c=n.offset,u=n.limit,_=c+i;if(_>a.length){let S=new Uint8Array(2*_);S.set(a),n.bytes=S}return n.offset=_,_>u&&(n.limit=_),c}function r6(n,i){let a=n.offset;if(a+i>n.limit)throw new Error("Read past limit");return n.offset+=i,a}function dF(n,i){let a=GS(n,i.length);n.bytes.set(i,a)}function uF(n,i){let a=r6(n,i),c=String.fromCharCode,u=n.bytes,_="",S="";for(let C=0;C<i;C++){let R,e,t,r,s=u[C+a];128&s?(224&s)==192?C+1>=i?S+=_:(R=u[C+a+1],(192&R)!=128?S+=_:(r=(31&s)<<6|63&R,r<128?S+=_:(S+=c(r),C++))):(240&s)==224?C+2>=i?S+=_:(R=u[C+a+1],e=u[C+a+2],(49344&(R|e<<8))!=32896?S+=_:(r=(15&s)<<12|(63&R)<<6|63&e,r<2048||r>=55296&&r<=57343?S+=_:(S+=c(r),C+=2))):(248&s)==240?C+3>=i?S+=_:(R=u[C+a+1],e=u[C+a+2],t=u[C+a+3],(12632256&(R|e<<8|t<<16))!=8421504?S+=_:(r=(7&s)<<18|(63&R)<<12|(63&e)<<6|63&t,r<65536||r>1114111?S+=_:(r-=65536,S+=c(55296+(r>>10),56320+(1023&r)),C+=3))):S+=_:S+=c(s)}return S}function $_(n,i){let a=i.length,c=0;for(let S=0;S<a;S++){let C=i.charCodeAt(S);C>=55296&&C<=56319&&S+1<a&&(C=(C<<10)+i.charCodeAt(++S)-56613888),c+=C<128?1:C<2048?2:C<65536?3:4}ua(n,c);let u=GS(n,c),_=n.bytes;for(let S=0;S<a;S++){let C=i.charCodeAt(S);C>=55296&&C<=56319&&S+1<a&&(C=(C<<10)+i.charCodeAt(++S)-56613888),C<128?_[u++]=C:(C<2048?_[u++]=C>>6&31|192:(C<65536?_[u++]=C>>12&15|224:(_[u++]=C>>18&7|240,_[u++]=C>>12&63|128),_[u++]=C>>6&63|128),_[u++]=63&C|128)}}function hc(n){return n.bytes[r6(n,1)]}function fF(n,i){let a=GS(n,1);n.bytes[a]=i}function zS(n){let i,a=0,c=0;do i=hc(n),a<32&&(c|=(127&i)<<a),a+=7;while(128&i);return c}function ua(n,i){for(i>>>=0;i>=128;)fF(n,127&i|128),i>>>=7;fF(n,i)}function RD(n,i){let a,c=0,u=0,_=0;return a=hc(n),c=127&a,128&a&&(a=hc(n),c|=(127&a)<<7,128&a&&(a=hc(n),c|=(127&a)<<14,128&a&&(a=hc(n),c|=(127&a)<<21,128&a&&(a=hc(n),u=127&a,128&a&&(a=hc(n),u|=(127&a)<<7,128&a&&(a=hc(n),u|=(127&a)<<14,128&a&&(a=hc(n),u|=(127&a)<<21,128&a&&(a=hc(n),_=127&a,128&a&&(a=hc(n),_|=(127&a)<<7))))))))),{low:c|u<<28,high:u>>>4|_<<24,unsigned:i}}function Qg(n,i){let a=i.low>>>0,c=(i.low>>>28|i.high<<4)>>>0,u=i.high>>>24,_=u===0?c===0?a<16384?a<128?1:2:a<1<<21?3:4:c<16384?c<128?5:6:c<1<<21?7:8:u<128?9:10,S=GS(n,_),C=n.bytes;switch(_){case 10:C[S+9]=u>>>7&1;case 9:C[S+8]=_!==9?128|u:127&u;case 8:C[S+7]=_!==8?c>>>21|128:c>>>21&127;case 7:C[S+6]=_!==7?c>>>14|128:c>>>14&127;case 6:C[S+5]=_!==6?c>>>7|128:c>>>7&127;case 5:C[S+4]=_!==5?128|c:127&c;case 4:C[S+3]=_!==4?a>>>21|128:a>>>21&127;case 3:C[S+2]=_!==3?a>>>14|128:a>>>14&127;case 2:C[S+1]=_!==2?a>>>7|128:a>>>7&127;case 1:C[S]=_!==1?128|a:127&a}}let i6={},a6={},Oh=4294967296,hf=Oh*Oh,hF=hf/2;Zg(0,!0);let A1=Zg(0),fa=O1(0,-2147483648,!1),DY=O1(-1,2147483647,!1);function Zg(n,i){let a,c,u;return i?(u=0<=(n>>>=0)&&n<256)&&(c=a6[n],c)?c:(a=O1(n,0,!0),u&&(a6[n]=a),a):(u=-128<=(n|=0)&&n<128)&&(c=i6[n],c)?c:(a=O1(n,n<0?-1:0,!1),u&&(i6[n]=a),a)}function O1(n,i,a){return{low:0|n,high:0|i,unsigned:!!a}}function s6(n,i){if(isNaN(n))return A1;{if(n<=-9223372036854776e3)return fa;if(n+1>=hF)return DY}return n<0?A1:O1(n%Oh|0,n/Oh|0,i)}function qI(n,i){var a=Object.keys(n);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(n);i&&(c=c.filter(function(u){return Object.getOwnPropertyDescriptor(n,u).enumerable})),a.push.apply(a,c)}return a}class o6 extends li{get connectionState(){return this._connectionState}set connectionState(i){if(this._connectionState===i)return;let a=this._connectionState;this._connectionState=i,this.emit(af.CONNECTION_STATE_CHANGE,i,a)}get quality(){return this._quality}set quality(i){this._quality=i>1?1:i<.1?.1:i,this._qualityTimer&&(window.clearTimeout(this._qualityTimer),this._qualityTimer=null),this._quality>=1||(this._qualityTimer=window.setTimeout(()=>{this.quality=this._quality/this._qualityRatio},6e4))}constructor(i){var a;super(),re(this,"name","AgoraRTCImageModeration"),re(this,"_connectionState",od.CONNECTING),re(this,"_sequence",0),re(this,"_moderationStartTime",void 0),re(this,"_workerConnection",void 0),re(this,"_workerMessageLengthLimit",void 0),re(this,"_qualityRatio",void 0),re(this,"_connectInfo",void 0),re(this,"_cancelTokenSource",eo.CancelToken.source()),re(this,"_retryConfig",void 0),re(this,"_moderationInterval",void 0),re(this,"_moderationTimer",null),re(this,"_moderationMode",1),re(this,"_quality",1),re(this,"_qualityTimer",null),re(this,"_ticket",void 0),re(this,"_moderationIntervalMinimum",void 0),re(this,"_uploadFailedNum",0),re(this,"_uploadNum",0),re(this,"_uploadTimer",null),re(this,"_extraInfo",void 0),re(this,"_vendor",""),re(this,"_encoder",new TextEncoder),re(this,"_moderationId",void 0),re(this,"inspectImage",()=>{if(this.connectionState!==od.CONNECTED)throw new De(oe.OPERATION_ABORTED,"image moderation service connection status is ".concat(this.connectionState));this._moderationTimer&&(window.clearInterval(this._moderationTimer),this._moderationTimer=null),this._moderationTimer=window.setInterval(()=>{this.connectionState===od.CONNECTED?this.requestToInspectImage():z.debug("[".concat(this._moderationId,"] Moderation State is not connected , "),this.connectionState)},this._moderationInterval<this._moderationIntervalMinimum?this._moderationIntervalMinimum:this._moderationInterval),this.requestToInspectImage()}),this._moderationId=gr(5,"image-moderation-"),this._workerMessageLengthLimit=ge("IMAGE_MODERATION_WORKER_MESSAGE_LENGTH_LIMIT"),this._moderationIntervalMinimum=ge("IMAGE_MODERATION_INTERVAL_MINIMUM"),this._moderationInterval=(a=i.interval)!==null&&a!==void 0?a:1e3,i.extraInfo&&(this._extraInfo=this._encoder.encode(i.extraInfo)),i.vendor&&(this._vendor=i.vendor),this._qualityRatio=ge("IMAGE_MODERATION_QUALITY_RATIO"),this._moderationStartTime=Number(Date.now()),this._workerConnection=new qp("worker-"+this._moderationId,da),this.on(af.STATE_CHANGE,(c,u)=>{z.debug("[".concat(this._moderationId,"] Moderation operation :").concat(MS[c]," ").concat(u||""))}),this.handleWorkerEvents()}async init(i,a){this.emit(af.STATE_CHANGE,MS.CONNECT_AP),this._connectInfo=i;let c=this._cancelTokenSource.token;return this._retryConfig=a,new Et((u,_)=>{this.on(af.CONNECTION_STATE_CHANGE,(S,C)=>{S===od.CONNECTED&&u()}),this.requestAP(i,c,a).then(S=>{this.connectWorker(S)}).catch(S=>{_(S)})})}updateConfig(i){var a;this._moderationInterval=(a=i.interval)!==null&&a!==void 0?a:1e3,i.extraInfo&&(this._extraInfo=this._encoder.encode(i.extraInfo)),i.vendor&&(this._vendor=i.vendor),z.debug("[".concat(this._moderationId,"] updateConfig: ").concat(JSON.stringify(i))),this.connectionState===od.CONNECTED&&this.inspectImage()}async requestAP(i,a,c){let u=ge("WEBCS_DOMAIN").map(R=>"https://".concat(R,"/api/v1")),_=await function(R,e,t,r){let{appId:s,areaCode:l,cname:f,sid:m,token:E,uid:y}=e;E1++;let b="moderation_plugin",A={service_name:b,json_body:JSON.stringify({appId:s,areaCode:l,cname:f,command:"allocateEdge",requestId:E1,seq:E1,sid:m,appToken:E,ts:Date.now(),uid:y+""})},O,D,P=R[0];return Xu(async()=>{O=Date.now();let F=await sf(P,{data:A,cancelToken:t,headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"61"},params:{action:"wrtc_gateway"}});if(D=Date.now()-O,F.code!==0){let $=new De(oe.UNEXPECTED_RESPONSE,"moderation plugin ap error, code"+F.code,{retry:!0,responseTime:D});throw z.error($.toString()),$}let B=JSON.parse(F.json_body);if(B.code!==200){let $=new De(oe.UNEXPECTED_RESPONSE,"moderation plugin ap error, code: ".concat(B.code,", reason: ").concat(B.reason),{code:B.code,responseTime:D});throw z.error($.toString()),$}if(!B.servers||!Array.isArray(B.servers)||B.servers.length===0){let $=new De(oe.UNEXPECTED_RESPONSE,"moderation plugin ap empty server",{code:B.code,responseTime:D});throw z.error($.toString()),$}if(!B.servers.some($=>!!$.wss)){let $=new De(oe.UNEXPECTED_RESPONSE,"moderation plugin ap empty port",{code:B.code,responseTime:D});throw z.error($.toString()),$}let Y=ge("IMAGE_MODERATION_WORKER_HOST");return{addressList:B.servers.map($=>{let{address:ee,wss:Ee}=$;if(ee&&Ee)return"wss://".concat(ee.replace(/\./g,"-"),".").concat(Y,":").concat(Ee,"/moderation")}).filter($=>!!$),workerToken:B.workerToken,vid:B.vid,ticket:B.appTicket,responseTime:D}},(F,B)=>(jt.apworkerEvent(m,{success:!0,sc:200,serviceName:b,responseDetail:JSON.stringify(F.addressList),firstSuccess:B===0,responseTime:D,serverIp:R[B%R.length]}),!1),(F,B)=>(jt.apworkerEvent(m,{success:!1,sc:F.data&&F.data.code||200,serviceName:b,responseTime:D,serverIp:R[B%R.length]}),!!(F.code!==oe.OPERATION_ABORTED&&F.code!==oe.UNEXPECTED_RESPONSE||F.data&&F.data.retry)&&(P=R[(B+1)%R.length],!0)),r)}(u,i,a,c);this.emit(af.STATE_CHANGE,MS.AP_CONNECTED);let{addressList:S,ticket:C}=_;return this._ticket=C,S}async connectWorker(i){this.emit(af.STATE_CHANGE,MS.CONNECT_WORKER),await this._workerConnection.init(i,1e4)}handleWorkerEvents(){this._workerConnection.on(mn.CONNECTED,async()=>{this.emit(af.STATE_CHANGE,MS.WORKER_CONNECTED,this._workerConnection.url),this.connectionState=od.CONNECTED}),this._workerConnection.on(mn.CLOSED,()=>{this.connectionState=od.CLOSED}),this._workerConnection.on(mn.FAILED,()=>{this.connectionState=od.CLOSED}),this._workerConnection.on(mn.RECONNECTING,()=>{this.connectionState=this.connectionState===od.CONNECTED?od.RECONNECTING:od.CONNECTING}),this._workerConnection.on(mn.ON_MESSAGE,async i=>{if(i.data instanceof ArrayBuffer){let a=sF(new Uint8Array(i.data));ge("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")&&z.debug("[".concat(this._moderationId,"] Response message for worker of image moderation "),JSON.stringify(a)),this._uploadNum++,a.code===void 0||a.code===0||(this._uploadFailedNum++,z.error("[".concat(this._moderationId,"] Error response from worke, code is ").concat(a.code,", msg is ").concat(a.msg)),this._uploadTimer||(this._uploadTimer=window.setTimeout(()=>{jt.reportApiInvoke(this._connectInfo.sid||null,{name:bn.IMAGE_MODERATION_UPLOAD,options:[this._uploadFailedNum,this._uploadNum,a.code],tag:Li.TRACER}).onError(new De(oe.IMAGE_MODERATION_UPLOAD_FAILED,a.msg)),this._uploadTimer=null},ge("IMAGE_MODERATION_UPLOAD_REPORT_INTERVAL"))))}else z.error("[".concat(this._moderationId,"] Unexpected message type from worker"))}),this._workerConnection.on(mn.WILL_RECONNECT,(i,a,c)=>{i==="recover"&&c(i),c("tryNext")}),this._workerConnection.on(mn.REQUEST_NEW_URLS,(i,a)=>{this.requestAP(this._connectInfo,this._cancelTokenSource.token,this._retryConfig).then(i).catch(a)})}static intToLong(i){return{low:i|=0,high:i>>31,unsigned:i>=0}}async requestToInspectImage(){let i=ed(this,af.CLIENT_LOCAL_VIDEO_TRACK),a={appId:this._connectInfo.appId,cname:this._connectInfo.cname,cid:this._connectInfo.cid,sid:this._connectInfo.sid,uid:this._connectInfo.uid,vid:this._connectInfo.vid};if(i){if(!i.isPlaying)return void(ge("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")&&z.debug("Only the track being played can be inspected"));this._sequence++;let c=await this.generateRequestData(i,a);this._workerConnection.sendMessage(c,!0,!0)}else ge("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")&&z.debug("Only the track being published can be inspected")}async generateRequestData(i,a){let{appId:c,cname:u,cid:_,vid:S,sid:C,uid:R}=a,e=Date.now(),t=await i.getCurrentFrameImage("image/jpeg",this.quality),r=await Hi(t,c,u),s=this._sequence+"-"+_+"-"+R+"-"+e+"-"+gr(12,""),l={appId:c,cid:_,cname:u,deviceId:"",elapse:o6.intToLong(Number(e-this._moderationStartTime)),fileSize:t.buffer.byteLength,height:t.height,width:t.width,jpg:r,networkType:6,osType:7,requestId:s,sdkVersion:"4.23.2",sequence:this._sequence,sid:C,timestamp:s6(e),uid:R,vid:S,service:this._moderationMode,ticket:this._ticket,callbackData:this._extraInfo,vendorConfigs:this._vendor};this._extraInfo===void 0&&delete l.callbackData;let f=aF(l);if(f.byteLength<this._workerMessageLengthLimit){if(ge("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")){let m=function(E){for(var y=1;y<arguments.length;y++){var b=arguments[y]!=null?arguments[y]:{};y%2?qI(Object(b),!0).forEach(function(A){re(E,A,b[A])}):Object.getOwnPropertyDescriptors?Object.defineProperties(E,Object.getOwnPropertyDescriptors(b)):qI(Object(b)).forEach(function(A){Object.defineProperty(E,A,Object.getOwnPropertyDescriptor(b,A))})}return E}({},l);delete m.jpg,z.debug("[".concat(this._moderationId,"] Request message for worker of image moderation service: "),JSON.stringify(m))}return f}{let m=this.quality*this._qualityRatio;return this.quality=m,await this.generateRequestData(i,{appId:c,cname:u,cid:_,vid:S,sid:C,uid:R})}}close(){this._cancelTokenSource.cancel(),this._cancelTokenSource=eo.CancelToken.source(),this._workerConnection&&this._workerConnection.close(),this._moderationTimer&&window.clearInterval(this._moderationTimer),this._moderationTimer=null,this._uploadTimer&&window.clearTimeout(this._uploadTimer),this._uploadTimer=null,this.connectionState=od.CLOSED,this.emit(af.STATE_CHANGE,MS.CLOSED)}}function c6(n){if(Cr(n.interval,"interval",1e3,1/0),n&&n.extraInfo&&n.extraInfo.length>1024)throw new De(oe.INVALID_PARAMS,"config.extraInfo length cannot exceed 1024 bytes");if(n&&n.vendor&&n.vendor.length>1024)throw new De(oe.INVALID_PARAMS,"config.vendor length cannot exceed 1024 bytes")}let pF={name:"ImageModeration",create:function(n){let{config:i}=n;return c6(i),new o6(i)}};var mF,gF,l6,N1,d6,u6,ID,f6,_F,h6,p6,m6,g6,_6,E6,v6,S6,y6,T6,b6,C6,w6,R6,I6,A6,O6,N6,L6,D6,P6,M6,k6,x6,U6,j6,V6,B6,F6,G6,z6,H6,wt;function W6(n,i){var a=Object.keys(n);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(n);i&&(c=c.filter(function(u){return Object.getOwnPropertyDescriptor(n,u).enumerable})),a.push.apply(a,c)}return a}function lu(n){for(var i=1;i<arguments.length;i++){var a=arguments[i]!=null?arguments[i]:{};i%2?W6(Object(a),!0).forEach(function(c){re(n,c,a[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(a)):W6(Object(a)).forEach(function(c){Object.defineProperty(n,c,Object.getOwnPropertyDescriptor(a,c))})}return n}Na.setLogger(z);let EF=(mF=$t(),gF=$t({argsMap:(n,i)=>{if(!Array.isArray(i)){if(!(i instanceof yo))return[i];i=[i]}return i.map(a=>a?Object(a).toString():"null")}}),l6=$t({argsMap:(n,i)=>(i||(i=[]),Array.isArray(i)||i.trackMediaType!==Jb.DATA?(Array.isArray(i)||(i=[i]),i.map(a=>a.getTrackId())):[i.getChannelId()])}),N1=$t({argsMap:(n,i,a,c)=>[typeof i=="object"?i.uid:i,a,c]}),d6=$t({argsMap:(n,i,a)=>[i,a]}),u6=$t({argsMap:(n,i)=>i.map(a=>{let{user:c,mediaType:u}=a;return[c==null?void 0:c.uid,u]})}),ID=$t({argsMap:(n,i,a,c)=>[typeof i=="object"?i.uid:i,a,c]}),f6=$t({argsMap:(n,i)=>i.map(a=>{let{user:c,mediaType:u}=a;return{uid:c==null?void 0:c.uid,mediaType:u}})}),_F=$t(),h6=$t(),p6=$t(),m6=$t(),g6=$t(),_6=$t(),E6=$t(),v6=$t(),S6=$t(),y6=$t(),T6=$t(),b6=$t(),C6=$t(),w6=$t(),R6=$t(),I6=$t({argsMap:(n,i)=>[i]}),A6=$t(),O6=$t(),N6=$t(),L6=$t(),D6=$t(),P6=$t(),M6=$t(),k6=$t(),x6=$t({argsMap:(n,i)=>(Array.isArray(i)||(i=[i]),[JSON.stringify(i)])}),U6=$t(),j6=$t(),V6=$t(),B6=$t(),F6=$t(),G6=$t(),z6=$t({reportResult:!0}),H6=$t(),wt=class extends li{get connectionState(){return this._gateway.state}get remoteUsers(){return this._users}get localTracks(){return this._p2pChannel.getAllTracks(!0)}get uid(){return this._uid}get channelName(){return this._channelName}get localDataChannels(){return this._p2pChannel.getAllDataChannels()}get mode(){return this._config.mode}get role(){var n;return((n=this._config)===null||n===void 0?void 0:n.role)||"audience"}get codec(){return this._config.codec}get audioCodec(){return this._config.audioCodec||"opus"}get isStringUID(){return!!this._joinInfo&&!!this._joinInfo.stringUid}get __className__(){return"Client"}constructor(n,i){let a;if(super(),re(this,"store",void 0),re(this,"_uid",void 0),re(this,"_channelName",void 0),re(this,"_uintUid",void 0),re(this,"_users",[]),re(this,"_config",void 0),re(this,"_clientId",void 0),re(this,"_appId",void 0),re(this,"_sessionId",null),re(this,"_key",void 0),re(this,"_rtmConfig",{}),re(this,"_joinInfo",void 0),re(this,"_gateway",void 0),re(this,"_statsCollector",void 0),re(this,"_configDistribute",void 0),re(this,"_leaveMutex",void 0),re(this,"_publishMutex",void 0),re(this,"_renewTokenMutex",void 0),re(this,"_subscribeMutex",void 0),re(this,"_encryptionMode","none"),re(this,"_encryptionSecret",null),re(this,"_encryptionSalt",null),re(this,"_encryptDataStream",!1),re(this,"_encryptDataStreamKey",null),re(this,"_encryptDataStreamIv",null),re(this,"_proxyServer",void 0),re(this,"_turnServer",{servers:[],mode:"auto"}),re(this,"_cloudProxyServerMode","disabled"),re(this,"_isDualStreamEnabled",!1),re(this,"_defaultStreamFallbackType",void 0),re(this,"_lowStreamParameter",void 0),re(this,"_streamFallbackTypeCacheMap",new Map),re(this,"_remoteStreamTypeCacheMap",new Map),re(this,"_axiosCancelSource",eo.CancelToken.source()),re(this,"_audioVolumeIndicationInterval",void 0),re(this,"_networkQualityInterval",void 0),re(this,"_userOfflineTimeout",void 0),re(this,"_streamRemovedTimeout",void 0),re(this,"_liveTranscodeStreamingClient",void 0),re(this,"_liveRawStreamingClient",void 0),re(this,"_channelMediaRelayClient",void 0),re(this,"_networkQualitySensitivity","normal"),re(this,"_p2pChannel",void 0),re(this,"_useLocalAccessPoint",!1),re(this,"_setLocalAPVersion",void 0),re(this,"_joinAndNotLeaveYet",!1),re(this,"_numberOfJoinCount",0),re(this,"_remoteDefaultVideoStreamType",void 0),re(this,"_inspect",void 0),re(this,"_moderation",void 0),re(this,"_license",void 0),re(this,"_pendingPublishedUsers",[]),re(this,"ntpAlignErrorCount",0),re(this,"remoteInboundOffset",0),re(this,"_peerConnectionState",void 0),re(this,"_handleLocalTrackEnable",(u,_,S)=>{this.publish(u,!1).then(_).catch(S)}),re(this,"_handleLocalTrackDisable",(u,_,S)=>{this.unpublish(u).then(_).catch(S)}),re(this,"_handleUserOnline",u=>{if(ge("BLOCK_LOCAL_CLIENT")&&eu(u.uid,this.channelName))return void z.debug("[".concat(u.uid,"] will be ignored in local"));this.isStringUID&&typeof u.uid!="string"&&z.error("[".concat(this._clientId,"] StringUID is Mixed with UintUID"));let _=this._users.find(S=>S.uid===u.uid);if(_)_._trust_in_room_=!0,_._is_pre_created&&(_._is_pre_created=!1,this.safeEmit(Xt.USER_JOINED,_));else{let S=new Hg(u.uid,u.uint_id||u.uid);this._users.push(S),z.debug("[".concat(this._clientId,"] user online"),u.uid),this.safeEmit(Xt.USER_JOINED,S)}}),re(this,"_handleUserOffline",u=>{if(ge("BLOCK_LOCAL_CLIENT")&&eu(u.uid,this.channelName))return;let _=this._users.find(S=>S.uid===u.uid);_&&(this._handleRemoveStream(u),this._handleRemoveDataChannels(u),_._audio_pre_subscribed||_._video_pre_subscribed?_._is_pre_created=!0:iI(this._users,_),this._remoteStreamTypeCacheMap.delete(_.uid),this._streamFallbackTypeCacheMap.delete(_.uid),z.debug("[".concat(this._clientId,"] user offline"),u.uid,"reason:",u.reason),this.safeEmit(Xt.USER_LEAVED,_,u.reason))}),re(this,"_handleAddAudioOrVideoStream",(u,_,S,C,R,e,t)=>{if(ge("BLOCK_LOCAL_CLIENT")&&eu(_,this.channelName))return;let r=this._users.find(l=>l.uid===_);if(!r)return void z.error("[".concat(this._clientId,"] can not find target user!(on_add_stream)"));z.debug("[".concat(this._clientId,"] stream added with uid ").concat(_,", type ").concat(u)),this.store.subscribe(r.uid,u,void 0,void 0,void 0,Date.now());let s=u==="audio"?r.hasAudio:r.hasVideo;r._uintid||(r._uintid=R||_),u==="audio"?r._trust_audio_stream_added_state_=!0:r._trust_video_stream_added_state_=!0,u==="audio"?(r._audio_added_=!0,S!==void 0&&(r._audioSSRC=S),C!==void 0&&(r._cname=C),e&&(r._audioOrtc=e)):(r._video_added_=!0,S!==void 0&&(r._videoSSRC=S),C!==void 0&&(r._cname=C),t!==void 0&&(r._rtxSsrcId=t),e&&(r._videoOrtc=e)),(u==="audio"?r.hasAudio:r.hasVideo)&&!s&&(z.info("[".concat(this._clientId,"] remote user ").concat(r.uid," published ").concat(u)),this.safeEmit(Xt.USER_PUBLISHED,r,u)),u==="video"?jt.onGatewayStream(this._sessionId,qt.ON_ADD_VIDEO_STREAM,di.ON_ADD_VIDEO_STREAM,{peer:R||_,ssrc:r._videoSSRC}):jt.onGatewayStream(this._sessionId,qt.ON_ADD_AUDIO_STREAM,di.ON_ADD_AUDIO_STREAM,{peer:R||_,ssrc:r._audioSSRC}),this._p2pChannel.remoteMediaSsrcChanged(r,u,S).then(l=>{if(l&&(z.debug("[".concat(this._clientId,"] resubscribe ").concat(u," for user ").concat(r.uid," after rejoin because SSRC id changed.")),this._p2pChannel instanceof uf))return this._p2pChannel.unsubscribe(r,u,!0).then(()=>this._subscribe(r,u,!0).catch(f=>{z.error("[".concat(this._clientId,"] resubscribe error"),f.toString())}))}),this._p2pChannel.hasPendingRemoteMedia(r,u)&&(z.debug("[".concat(this._clientId,"] resubscribe ").concat(u," for user ").concat(r.uid," after reconnect.")),this._subscribe(r,u,!0).catch(l=>{z.error("[".concat(this._clientId,"] resubscribe error"),l.toString())}))}),re(this,"_handleRemoveStream",u=>{if(ge("BLOCK_LOCAL_CLIENT")&&eu(u.uid,this.channelName))return;let _=this._users.find(C=>C.uid===u.uid);if(!_)return void z.warning("[".concat(this._clientId,"] can not find target user!(on_remove_stream)"));z.debug("[".concat(this._clientId,"] stream removed with uid ").concat(u.uid));let S=()=>{};_.hasAudio&&_.hasVideo?S=()=>{z.info("[".concat(this._clientId,"] remote user ").concat(_.uid," unpublished audio track")),this.safeEmit(Xt.USER_UNPUBLISHED,_,"audio"),z.info("[".concat(this._clientId,"] remote user ").concat(_.uid," unpublished video track")),this.safeEmit(Xt.USER_UNPUBLISHED,_,"video")}:_.hasVideo?S=()=>{z.info("[".concat(this._clientId,"] remote user ").concat(_.uid," unpublished video track")),this.safeEmit(Xt.USER_UNPUBLISHED,_,"video")}:_.hasAudio&&(S=()=>{z.info("[".concat(this._clientId,"] remote user ").concat(_.uid," unpublished audio track")),this.safeEmit(Xt.USER_UNPUBLISHED,_,"audio")}),_._video_pre_subscribed||_._audio_pre_subscribed||(_._trust_audio_stream_added_state_=!0,_._trust_video_stream_added_state_=!0,_._audio_added_=!1,_._video_added_=!1,this._p2pChannel instanceof uf&&this._p2pChannel.unsubscribe(_).then(C=>{if(C)return this._gateway.unsubscribe(C,_.uid)}),_._audioSSRC=void 0,_._videoSSRC=void 0,_._audioOrtc=void 0,_._videoOrtc=void 0,_._rtxSsrcId=void 0),jt.onGatewayStream(this._sessionId,qt.ON_REMOVE_STREAM,di.ON_REMOVE_STREAM,{peer:u.uint_id||u.uid}),S()}),re(this,"_handleSetStreamLocalEnable",(u,_,S)=>{if(ge("BLOCK_LOCAL_CLIENT")&&eu(_,this.channelName))return;let C=this._users.find(t=>t.uid===_);if(!C)return void z.error("[".concat(this._clientId,"] can not find target user!(disable_local)"));z.debug("[".concat(this._clientId,"] local ").concat(u," ").concat(S?"enabled":"disabled"," with uid ").concat(_));let R=u==="audio"?C.hasAudio:C.hasVideo;if(u==="audio"){C._trust_audio_enabled_state_=!0;let t=C._audio_enabled_;if(C._audio_enabled_=S,C._audio_enabled_===t)return;{let r=C._audio_enabled_?"enable-local-audio":"disable-local-audio";z.debug("[".concat(this._clientId,"] user-info-updated, uid: ").concat(_,", msg: ").concat(r)),this.safeEmit(Xt.USER_INFO_UPDATED,_,r)}}else{C._trust_video_enabled_state_=!0;let t=C._video_enabled_;if(C._video_enabled_=S,C._video_enabled_===t)return;{let r=C._video_enabled_?"enable-local-video":"disable-local-video";z.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(_,", msg: ").concat(r)),this.safeEmit(Xt.USER_INFO_UPDATED,_,r)}}let e=u==="audio"?C.hasAudio:C.hasVideo;return R!==e?!R&&e?(z.info("[".concat(this._clientId,"] remote user ").concat(_," published ").concat(u)),void this.safeEmit(Xt.USER_PUBLISHED,C,u)):(u==="video"&&C._videoTrack&&C._videoTrack._destroy(),u==="audio"&&C._audioTrack,this._p2pChannel.muteRemote(C,u),z.info("[".concat(this._clientId,"] remote user ").concat(_," unpublished ").concat(u)),void this.safeEmit(Xt.USER_UNPUBLISHED,C,u)):void 0}),re(this,"_handleMuteStream",(u,_,S)=>{if(ge("BLOCK_LOCAL_CLIENT")&&eu(u,this.channelName))return;z.debug("[".concat(this._clientId,"] receive mute message"),u,_,S);let C=this._users.find(t=>t.uid===u);if(!C)return void z.warning("[".concat(this._clientId,"] can not find remote user, ignore mute event, uid: ").concat(u));let R=_==="audio"?C.hasAudio:C.hasVideo;if(_==="audio"){C._trust_audio_mute_state_=!0;let t=C._audio_muted_;if(C._audio_muted_=S,C._audio_muted_===t)return;{let r=C._audio_muted_?"mute-audio":"unmute-audio";z.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(u,", msg: ").concat(r)),this.safeEmit(Xt.USER_INFO_UPDATED,u,r)}}else{C._trust_video_mute_state_=!0;let t=C._video_muted_;if(C._video_muted_=S,C._video_muted_===t)return;{let r=C._video_muted_?"mute-video":"unmute-video";z.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(u,", msg: ").concat(r)),this.safeEmit(Xt.USER_INFO_UPDATED,u,r)}}let e=_==="audio"?C.hasAudio:C.hasVideo;if(R!==e){if(!R&&e)return(_==="audio"?C._audioSSRC:C._videoSSRC)?(z.info("[".concat(this._clientId,"] remote user ").concat(u," published ").concat(_)),void this.safeEmit(Xt.USER_PUBLISHED,C,_)):void z.warning("[".concat(this._clientId,"] remote user ").concat(u," receive ").concat(_," unmute message  before add stream message, ").concat(_," SSRC doesn't exist yet."));_==="video"&&C._videoTrack&&!C._video_pre_subscribed&&C._videoTrack._destroy(),_==="audio"&&C._audioTrack,this._p2pChannel.muteRemote(C,_),z.info("[".concat(this._clientId,"] remote user ").concat(u," unpublished ").concat(_)),this.safeEmit(Xt.USER_UNPUBLISHED,C,_)}}),re(this,"_handleP2PLost",async u=>{z.debug("[".concat(this._clientId,"] receive p2p lost"),u),parseInt(u.p2pid,10)===this.store.p2pId?await this._p2pChannel.requestReconnect():z.warning("[".concat(this._clientId,"] P2PLost stream not found"),u)}),re(this,"_handleTokenWillExpire",()=>{z.debug("[".concat(this._clientId,"] received message onTokenPrivilegeWillExpire")),this.safeEmit(Xt.ON_TOKEN_PRIVILEGE_WILL_EXPIRE)}),re(this,"_handleBeforeUnload",u=>{u.type==="beforeunload"&&u.returnValue!==void 0&&u.returnValue!==""||(this.leave(),z.info("[".concat(this._clientId,"] auto leave onbeforeunload or pagehide")))}),re(this,"_handleUpdateNetworkQuality",()=>{if(this._networkQualitySensitivity==="normal")return;if(navigator&&navigator.onLine!==void 0&&!navigator.onLine)return void this.safeEmit(Xt.NETWORK_QUALITY,{downlinkNetworkQuality:6,uplinkNetworkQuality:6});let u={downlinkNetworkQuality:0,uplinkNetworkQuality:0};u.uplinkNetworkQuality=this._p2pChannel.getUplinkNetworkQuality(),u.downlinkNetworkQuality=this._p2pChannel.getDownlinkNetworkQuality(),this.safeEmit(Xt.NETWORK_QUALITY,u)}),re(this,"_handleP2PAddAudioOrVideoStream",(u,_,S,C)=>{let R=this._users.find(t=>t.uid===_);if(!R)return void z.error("[".concat(this._clientId,"] can not find target user!(on_add_stream)"));z.debug("[".concat(this._clientId,"] stream added with uid ").concat(_,", type ").concat(u)),this.store.subscribe(R.uid,u,void 0,void 0,void 0,Date.now());let e=u==="audio"?R.hasAudio:R.hasVideo;u==="audio"?R._trust_audio_stream_added_state_=!0:R._trust_video_stream_added_state_=!0,u==="audio"?(R._audio_added_=!0,S!==void 0&&(R._audioSSRC=S),C!==void 0&&(R._audioMid=C)):(R._video_added_=!0,S!==void 0&&(R._videoSSRC=S),C!==void 0&&(R._videoMid=C)),(u==="audio"?R.hasAudio:R.hasVideo)&&!e&&(z.info("[".concat(this._clientId,"] remote user ").concat(R.uid," published ").concat(u)),this.safeEmit(Xt.USER_PUBLISHED,R,u)),this._p2pChannel.hasPendingRemoteMedia(R,u)&&(z.debug("[".concat(this._clientId,"] resubscribe ").concat(u," for user ").concat(R.uid," after reconnect.")),this._subscribe(R,u,!0).catch(t=>{z.error("[".concat(this._clientId,"] resubscribe error"),t.toString())}))}),this._config=n,this._clientId=i||gr(5,"client-"),this.store=new class{constructor(u,_,S,C){un(this,"state",void 0),this.state={codec:u,audioCodec:_,mode:S,clientId:C,sessionId:null,p2pId:0,dcId:0,pubId:0,subId:0,avoidJoinStart:0,keyMetrics:{publish:[],subscribe:[]},joinChannelServiceRecords:[],cloudProxyServerMode:"disabled",useP2P:!1,p2pTransport:Fp.Default,hasStartJoinChannel:!1,isABTestSuccess:!1}}dispatch(u){this.state=function(_,S){switch(S.type){case Ln.SET_SESSION_ID:return Ct(Ct({},_),{},{sessionId:S.sessionId});case Ln.SET_P2P_ID:return Ct(Ct({},_),{},{p2pId:S.p2pId});case Ln.SET_UID:return Ct(Ct({},_),{},{uid:S.uid});case Ln.SET_INT_UID:return Ct(Ct({},_),{},{intUid:S.intUid});case Ln.SET_PUB_ID:return Ct(Ct({},_),{},{pubId:S.pubId});case Ln.KEY_METRIC_CLIENT_CREATED:return Ct(Ct({},_),{},{keyMetrics:Ct(Ct({},_.keyMetrics),{},{clientCreated:S.metric})});case Ln.KEY_METRIC_JOIN_START:return Ct(Ct({},_),{},{keyMetrics:Ct(Ct({},_.keyMetrics),{},{joinStart:S.metric})});case Ln.AVOID_JOIN_START:return Ct(Ct({},_),{},{avoidJoinStart:S.avoidJoinStart});case Ln.KEY_METRIC_JOIN_END:return Ct(Ct({},_),{},{keyMetrics:Ct(Ct({},_.keyMetrics),{},{joinEnd:S.metric})});case Ln.KEY_METRIC_REQUEST_AP_START:return Ct(Ct({},_),{},{keyMetrics:Ct(Ct({},_.keyMetrics),{},{requestAPStart:S.metric})});case Ln.KEY_METRIC_REQUEST_AP_END:return Ct(Ct({},_),{},{keyMetrics:Ct(Ct({},_.keyMetrics),{},{requestAPEnd:S.metric})});case Ln.KEY_METRIC_JOIN_GATEWAY_START:return Ct(Ct({},_),{},{keyMetrics:Ct(Ct({},_.keyMetrics),{},{joinGatewayStart:S.metric})});case Ln.KEY_METRIC_JOIN_GATEWAY_END:return Ct(Ct({},_),{},{keyMetrics:Ct(Ct({},_.keyMetrics),{},{joinGatewayEnd:S.metric})});case Ln.KEY_METRIC_PEER_CONNECTION_START:return Ct(Ct({},_),{},{keyMetrics:Ct(Ct({},_.keyMetrics),{},{peerConnectionStart:S.metric})});case Ln.KEY_METRIC_PEER_CONNECTION_END:return Ct(Ct({},_),{},{keyMetrics:Ct(Ct({},_.keyMetrics),{},{peerConnectionEnd:S.metric})});case Ln.KEY_METRIC_DESCRIPTION_START:return Ct(Ct({},_),{},{keyMetrics:Ct(Ct({},_.keyMetrics),{},{descriptionStart:S.metric})});case Ln.KEY_METRIC_SIGNAL_CHANNEL_OPEN:return Ct(Ct({},_),{},{keyMetrics:Ct(Ct({},_.keyMetrics),{},{signalChannelOpen:S.metric})});case Ln.KEY_METRIC_ICE_CONNECTION_END:return Ct(Ct({},_),{},{keyMetrics:Ct(Ct({},_.keyMetrics),{},{iceConnectionEnd:S.metric})});case Ln.KEY_METRIC_PUBLISH:{let C=_.keyMetrics.publish,R=C.findIndex(e=>e.trackId===S.metric.trackId);return R!==-1?(C[R]=Ct(Ct({},C[R]),S.metric),Ct(Ct({},_),{},{keyMetrics:Ct(Ct({},_.keyMetrics),{},{publish:[...C]})})):Ct(Ct({},_),{},{keyMetrics:Ct(Ct({},_.keyMetrics),{},{publish:[..._.keyMetrics.publish,S.metric]})})}case Ln.KEY_METRIC_SUBSCRIBE:{let C=_.keyMetrics.subscribe,R=C.findIndex(e=>e.userId===S.metric.userId&&e.type===S.metric.type);return R!==-1?(C[R]=Ct(Ct({},C[R]),S.metric),Ct(Ct({},_),{},{keyMetrics:Ct(Ct({},_.keyMetrics),{},{subscribe:[...C]})})):Ct(Ct({},_),{},{keyMetrics:Ct(Ct({},_.keyMetrics),{},{subscribe:[..._.keyMetrics.subscribe,S.metric]})})}case Ln.SET_CLOUD_PROXY_SERVER_MODE:return _.cloudProxyServerMode=S.mode,_;case Ln.RECORD_JOIN_CHANNEL_SERVICE:return typeof S.index!="number"?_.joinChannelServiceRecords=[..._.joinChannelServiceRecords,S.record]:(_.joinChannelServiceRecords[S.index]=Ct(Ct({},_.joinChannelServiceRecords[S.index]),S.record),_.joinChannelServiceRecords=[..._.joinChannelServiceRecords]),_;case Ln.RESET_JOIN_CHANNEL_SERVICE_RECORDS:return _.joinChannelServiceRecords=[],_;case Ln.RESET_KEY_METRICS:return _.keyMetrics={publish:[],subscribe:[]},_;case Ln.SET_USE_P2P:return Ct(Ct({},_),{},{useP2P:S.val});case Ln.SET_TRANSPORT_TYPE:return Ct(Ct({},_),{},{p2pTransport:S.val});default:return _}}(this.state,u)}set sessionId(u){this.dispatch({type:Ln.SET_SESSION_ID,sessionId:u})}get sessionId(){return this.state.sessionId}set cid(u){this.state.cid=u}get cid(){return this.state.cid}set codec(u){this.state.codec=u}get codec(){return this.state.codec}get mode(){return this.state.mode}get audioCodec(){return this.state.audioCodec}get clientId(){return this.state.clientId}set p2pId(u){this.dispatch({type:Ln.SET_P2P_ID,p2pId:u})}get p2pId(){return this.state.p2pId}set dcId(u){this.dispatch({type:Ln.SET_DC_ID,dcId:u})}get dcId(){return this.state.dcId}set uid(u){this.dispatch({type:Ln.SET_UID,uid:u})}get uid(){return this.state.uid}set intUid(u){this.dispatch({type:Ln.SET_INT_UID,intUid:u})}get intUid(){return this.state.intUid}set pubId(u){this.dispatch({type:Ln.SET_PUB_ID,pubId:u})}get pubId(){return this.state.pubId}set cloudProxyServerMode(u){this.dispatch({type:Ln.SET_CLOUD_PROXY_SERVER_MODE,mode:u})}get cloudProxyServerMode(){return this.state.cloudProxyServerMode}set useP2P(u){this.dispatch({type:Ln.SET_USE_P2P,val:u})}get useP2P(){return this.state.useP2P}set p2pTransport(u){this.dispatch({type:Ln.SET_TRANSPORT_TYPE,val:u})}get p2pTransport(){return this.state.p2pTransport}set hasStartJoinChannel(u){this.state.hasStartJoinChannel=u}get hasStartJoinChannel(){return this.state.hasStartJoinChannel}set isABTestSuccess(u){this.state.isABTestSuccess=u}get isABTestSuccess(){return this.state.isABTestSuccess}clientCreated(){this.dispatch({type:Ln.KEY_METRIC_CLIENT_CREATED,metric:Date.now()})}joinStart(){this.dispatch({type:Ln.KEY_METRIC_JOIN_START,metric:Date.now()})}joinEnd(){this.dispatch({type:Ln.KEY_METRIC_JOIN_END,metric:Date.now()})}requestAPStart(){this.dispatch({type:Ln.KEY_METRIC_REQUEST_AP_START,metric:Date.now()})}requestAPEnd(){this.dispatch({type:Ln.KEY_METRIC_REQUEST_AP_END,metric:Date.now()})}joinGatewayStart(){this.dispatch({type:Ln.KEY_METRIC_JOIN_GATEWAY_START,metric:Date.now()})}joinGatewayEnd(){this.dispatch({type:Ln.KEY_METRIC_JOIN_GATEWAY_END,metric:Date.now()})}peerConnectionStart(){this.dispatch({type:Ln.KEY_METRIC_PEER_CONNECTION_START,metric:Date.now()})}peerConnectionEnd(){this.dispatch({type:Ln.KEY_METRIC_PEER_CONNECTION_END,metric:Date.now()})}descriptionStart(){this.dispatch({type:Ln.KEY_METRIC_DESCRIPTION_START,metric:Date.now()})}signalChannelOpen(){this.dispatch({type:Ln.KEY_METRIC_SIGNAL_CHANNEL_OPEN,metric:Date.now()})}iceConnectionEnd(){this.dispatch({type:Ln.KEY_METRIC_ICE_CONNECTION_END,metric:Date.now()})}publish(u,_,S,C){this.dispatch({type:Ln.KEY_METRIC_PUBLISH,metric:Ct(Ct({trackId:u,type:_},S&&{publishStart:S}),C&&{publishEnd:C})})}subscribe(u,_,S,C,R,e,t){this.dispatch({type:Ln.KEY_METRIC_SUBSCRIBE,metric:Ct(Ct(Ct(Ct(Ct({userId:u,type:_},S&&{subscribeStart:S}),C&&{subscribeEnd:C}),R&&{firstFrame:R}),e&&{streamAdded:e}),t&&{firstDecoded:t})})}massSubscribe(u,_,S,C){u.forEach(R=>{this.dispatch({type:Ln.KEY_METRIC_SUBSCRIBE,metric:Ct(Ct(Ct({userId:R.userId,type:R.type},_&&{subscribeStart:_}),S&&{subscribeEnd:S}),C&&{firstFrame:C})})})}get keyMetrics(){return this.state.keyMetrics}recordJoinChannelService(u,_){u.service==="gateway"&&Array.isArray(u.urls)&&(u.urls=u.urls.map(S=>S.replace(/(\d+)-\d+-\d+-(\d+)/,"$1-*-*-$2")));try{return typeof _!="number"?(this.dispatch({type:Ln.RECORD_JOIN_CHANNEL_SERVICE,record:Ct(Ct({},u),{},{sessionId:this.sessionId,cloudProxyMode:this.cloudProxyServerMode,uid:this.uid})}),this.state.joinChannelServiceRecords.length-1):(_<0||_>=this.state.joinChannelServiceRecords.length||this.dispatch({type:Ln.RECORD_JOIN_CHANNEL_SERVICE,record:u,index:_}),_)}catch{return 0}}resetJoinChannelServiceRecords(){this.dispatch({type:Ln.RESET_JOIN_CHANNEL_SERVICE_RECORDS})}resetKeyMetrics(){this.dispatch({type:Ln.RESET_KEY_METRICS})}get joinChannelServiceRecords(){try{return this.state.joinChannelServiceRecords}catch{return[]}}get avoidJoinStart(){return this.state.avoidJoinStart}set avoidJoinStart(u){this.dispatch({type:Ln.AVOID_JOIN_START,avoidJoinStart:u})}}(n.codec,n.audioCodec,n.mode,this._clientId),this._leaveMutex=new Na("client-leave",this._clientId),this._publishMutex=new Na("client-publish",this._clientId),this._renewTokenMutex=new Na("client-renewtoken",this._clientId),this._subscribeMutex=new Na("client-subscribe",this._clientId),this.store.clientCreated(),n.proxyServer&&this.setProxyServer(n.proxyServer,!0),n.turnServer&&this.setTurnServer(n.turnServer,!0),z.info("[".concat(this._clientId,"] Initializing AgoraRTC client v").concat(Zd," build: ").concat(CS,", mode: ").concat(this.mode,", codec: ").concat(this.codec)),n.clientRoleOptions)try{rI(n.clientRoleOptions),a=Object.assign({},n.clientRoleOptions)}catch(u){z.warning("[".concat(this._clientId,"] ").concat(u.toString()))}var c;this._statsCollector=new T1(this.store),this._statsCollector.onStatsException=(u,_,S)=>{z.warn("[".concat(this._clientId,"] receive exception msg, code: ").concat(u,", msg: ").concat(_,", uid: ").concat(S)),this.safeEmit(Xt.EXCEPTION,{code:u,msg:_,uid:S})},this._statsCollector.onUploadPublishDuration=(u,_,S,C)=>{let R=this._users.find(e=>e.uid===u);R&&jt.peerPublishStatus(this._sessionId,{subscribeElapse:C,audioPublishDuration:_,videoPublishDuration:S,peer:R._uintid})},this.store.useP2P=n.mode==="p2p",this._gateway=new K8(this.store,{clientId:this._clientId,mode:this.mode,codec:this.codec,websocketRetryConfig:n.websocketRetryConfig||da,httpRetryConfig:n.httpRetryConfig||da,forceWaitGatewayResponse:n.forceWaitGatewayResponse===void 0||n.forceWaitGatewayResponse,statsCollector:this._statsCollector,role:n.role,clientRoleOptions:a}),this._configDistribute=new v1(this._clientId,this.store),this.store.useP2P?(this._p2pChannel=(c={store:this.store,statsCollector:this._statsCollector},ao("P2PChannel").create(c)),this._handleP2PEvents()):this._p2pChannel=new uf(this.store,this._statsCollector),this._handleP2PChannelEvents(),this._handleGatewayEvents(),this._handleGatewaySignalEvents()}async joinMeta(n,i,a,c,u){let _=!(arguments.length>5&&arguments[5]!==void 0)||arguments[5],S=arguments.length>6&&arguments[6]!==void 0&&arguments[6];Sr("JOIN_GATEWAY_USE_443PORT_ONLY",_),Sr("JOIN_GATEWAY_USE_DUAL_DOMAIN",S);let C=this._gateway.signal.websocket;return C instanceof EU&&(C.use443PortOnly=_,C.tryDoubleDomain=S),async function(R,e,t){Kd.get(R)||Kd.set(R,[]),mS.get(R)||mS.set(R,e),qd.get(R)||qd.set(R,0);let r=Kd.get(R),s=mS.get(R);if(!r||!s)throw new Error("concurrent: deferQueue or maxConcurrency is null");if(qd.get(R)===s){let y=O_();r.push(y),await y.promise}qd.set(R,qd.get(R)+1);for(var l=arguments.length,f=new Array(l>3?l-3:0),m=3;m<l;m++)f[m-3]=arguments[m];let E=await t(...f);return qd.set(R,qd.get(R)-1),qd.get(R)===s-1&&r.length>0&&(r[0].resolve(),r.shift()),qd.get(R)===0&&(Kd.set(R,[]),mS.set(R,0),qd.set(R,0)),E}("client.join",ge("JOIN_MAX_CONCURRENCY"),this.join.bind(this),n,i,a,c,u)}async join(n,i,a,c,u){let _=++this._numberOfJoinCount;this.store.joinStart(),c&&(this.store.uid=c);let S=(Gb||Gb||(Gb=(window.location.protocol.split(":")[0]||"").toUpperCase(),Gb))==="HTTPS",C=wx()?window.isSecureContext:"Browser Not Support";(!wx()&&!S||!window.isSecureContext)&&z.warning("The website must be running in a secure context (About secure context: https://developer.mozilla.org/en-US/docs/Web/Security/Secure_Contexts ), otherwise the media collection will be restricted by the browser"),this.connectionState==="DISCONNECTED"&&(this.store.avoidJoinStart=Math.round(Date.now()),z.debug("[".concat(this._clientId,"] set avoidJoinStart to ").concat(this.store.avoidJoinStart))),jt.setAppId(n);try{if(!a&&a!==null)throw new De(oe.INVALID_PARAMS,"Invalid token: ".concat(a,". If you don not use token, set it to null"));a&&Pa(a,"token",1,2047),Pa(n,"appid",1,2047),JL(i),c&&XL(c),u&&Pa(u,"optionalInfo",1,2047)}catch(m){throw jt.reportApiInvoke(D_(),{name:bn.JOIN,options:[n,i,a,c],states:{isHttps:S,isSecureContext:C},tag:Li.TRACER}).onError(m),m}if(this._leaveMutex.isLocked&&(z.debug("[".concat(this._clientId,"] join: waiting leave operation")),(await this._leaveMutex.lock())(),z.debug("[".concat(this._clientId,"] join: continue"))),this._joinAndNotLeaveYet=!0,this.connectionState!=="DISCONNECTED"){let m=new De(oe.INVALID_OPERATION,"[".concat(this._clientId,"] Client already in connecting/connected state"));throw jt.reportApiInvoke(D_(),{name:bn.JOIN,options:[n,i,a,c],states:{isHttps:S,isSecureContext:C},tag:Li.TRACER}).onError(m),m}this._gateway.state="CONNECTING";let R=await X_({appId:n,cname:i,uid:c,stringUid:typeof c=="string"?c:void 0,token:a||n,cloudProxyServer:this._cloudProxyServerMode});if(!this._joinAndNotLeaveYet)throw new De(oe.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"));let e=(R==null?void 0:R.sid)||D_();z.info("[".concat(this._clientId,"] start join channel ").concat(i,", join number: ").concat(_)),this._sessionId||(this._sessionId=e,this.store.sessionId=this._sessionId);let t=jt.reportApiInvoke(e,{id:this._clientId,name:bn.JOIN,options:[n,i,a,c],states:{isHttps:S,isSecureContext:C},tag:Li.TRACER}),r=lu(lu(lu({},this._rtmConfig),{},{role:this.role,clientId:this._clientId,appId:n,sid:this._sessionId,cname:i,uid:typeof c!="string"?c:null,turnServer:this._turnServer,proxyServer:this._proxyServer,token:a||n,cloudProxyServer:this._cloudProxyServerMode,optionalInfo:u,license:this._license,useLocalAccessPoint:this._useLocalAccessPoint,preload:!!R},this._remoteDefaultVideoStreamType!==void 0&&{defaultVideoStream:this._remoteDefaultVideoStreamType}),{},{apRequestDetail:ge("AP_REQUEST_DETAIL")||void 0});if(this._useLocalAccessPoint&&(r.setLocalAPVersion=this._setLocalAPVersion),typeof c=="string"&&(r.stringUid=c,this._uintUid?(r.uid=this._uintUid,this._uintUid=void 0):r.uid=0),this._encryptionMode!=="none"&&this._encryptionSecret){if(r.aesmode=this._encryptionMode,r.aespassword=await(async m=>{let E=function(O){let D=window.atob(`MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDCMnXAHkKIGAM+x4N22gCI+Wyu
STM9ztkT3uYslTT2PuKmZfPzhH6kVdO7PTjGCOZnAsyb3oTtWat0KcxQ4jxvqQV+
HvYl3iI1Yd4vl2c3qRMJPLtRDfNxa2Mcxgq7e9aEUibzdd0st+OJAy3tOj/Y0aVy
xQiYDz3vqa6bP29adwIDAQAB`),P=new Uint8Array(new ArrayBuffer(D.length));for(let F=0;F<D.length;F+=1)P[F]=D.charCodeAt(F);return P}(),y=await window.crypto.subtle.importKey("spki",E,{name:"RSA-OAEP",hash:"SHA-256"},!0,["encrypt"]),b=hh(m),A=await window.crypto.subtle.encrypt({name:"RSA-OAEP"},y,b);return function(O){let D="";for(let P=0;P<O.length;P+=1)D+=String.fromCharCode(O[P]);return window.btoa(D)}(new Uint8Array(A))})(this._encryptionSecret),!this._joinAndNotLeaveYet)throw new De(oe.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"));this._encryptionSalt&&(r.aessalt=this._encryptionSalt)}if(this._encryptDataStream&&(this._encryptionMode==="aes-128-gcm2"||this._encryptionMode==="aes-256-gcm2"))if(this._encryptionSalt&&this._encryptionSecret)if(window.crypto.subtle){let m=new TextEncoder,E=ge("USE_PURE_ENCRYPTION_MASTER_KEY")?m.encode(r.appId+this._encryptionSecret+this._encryptionSecret):m.encode(r.appId+r.cname+this._encryptionSecret);this._encryptDataStreamIv=await async function(y,b,A){let O=await window.crypto.subtle.importKey("raw",b,"PBKDF2",!1,["deriveBits","deriveKey"]),D=y==="aes-128-gcm2"?128:256,P=await window.crypto.subtle.deriveBits({name:"PBKDF2",iterations:IL,hash:"SHA-256",salt:A},O,D+RL);return new Uint8Array(P).subarray(D/8)}(this._encryptionMode,E,fr(this._encryptionSalt)),this._encryptDataStreamKey=await async function(y,b,A){let O=await window.crypto.subtle.importKey("raw",b,"PBKDF2",!1,["deriveBits","deriveKey"]),D=y==="aes-128-gcm2"?128:256;return await window.crypto.subtle.deriveKey({name:"PBKDF2",iterations:IL,hash:"SHA-256",salt:A},O,{name:"AES-GCM",length:D},!0,["encrypt","decrypt"])}(this._encryptionMode,E,fr(this._encryptionSalt))}else C?z.warning("[".concat(this._clientId,"] encrypt datastream must be running in a secure context, fallback to plain data stream")):z.warning("[".concat(this._clientId,"] current browser do not support WebCrypto ,fallback to plain data stream")),this._encryptDataStream=!1;else this._encryptDataStream=!1,z.debug("[".concat(this._clientId,"] no salt / secret, cannot support encrypt data stream, fallback to plain data stream"));this._startSession(this._sessionId,{channel:i,appId:n,stringUid:r.stringUid});let s=this._sessionId;setTimeout(()=>{this.connectionState==="CONNECTING"&&s===this._sessionId&&jt.joinChannelTimeout(this._sessionId,5)},5e3);try{var l;let m,E=r.cloudProxyServer;if(ft(l=["proxy3","proxy4","proxy5"]).call(l,E)){let D=ge("PROXY_SERVER_TYPE3");Array.isArray(D)?r.proxyServer=D[0]:r.proxyServer=D}if(jt.setProxyServer(r.proxyServer),z.setProxyServer(r.proxyServer),this.store.requestAPStart(),R){if(z.debug("[".concat(this._clientId,"] get serverInfo Success from Preload Cache ").concat(r.stringUid?", ".concat(r.stringUid," => ").concat(R.intUid):""," ")),r.stringUid&&!r.uid&&(r.uid=R.intUid),m={gatewayInfo:R.ap.gatewayInfo},ge("JOIN_WITH_FALLBACK_MEDIA_PROXY")&&r.turnServer.mode==="auto")if(R.ap.proxyInfo.addresses.length===0)z.warning("no edge services in ap response of proxy fallback, will not set proxy in iceServers");else{let D=(await SU(R.ap.proxyInfo,R.ap.gatewayInfo.uid)).map(P=>({turnServerURL:P.address,tcpport:P.tcpport||rs.tcpport,udpport:P.udpport||rs.udpport,username:P.username||rs.username,password:P.password||rs.password,forceturn:!1,security:!0}));r.turnServer={mode:"manual",servers:D}}TD(R,r.stringUid)}else{if(r.stringUid&&!r.uid){let D;[D,m]=await Et.all([J8(r.stringUid,r,this._axiosCancelSource.token,this._config.httpRetryConfig||da,this.store),uD(r,this._axiosCancelSource.token,this._config.httpRetryConfig||da,!0,this.store)]),z.debug("[".concat(this._clientId,"] getUserAccount Success ").concat(r.stringUid," => ").concat(D)),r.uid=D,m.gatewayInfo.uid=D,m.gatewayInfo.res.uid=D}else m=await uD(r,this._axiosCancelSource.token,this._config.httpRetryConfig||da,!0,this.store);if(!this._joinAndNotLeaveYet)throw new De(oe.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"))}this.store.requestAPEnd(),setTimeout(()=>{this._configDistribute.startGetConfigDistribute(r,this._axiosCancelSource.token),this._configDistribute.on(PS.UPDATE_BITRATE_LIMIT,D=>{this._p2pChannel.updateBitrateLimit(D)}),this._configDistribute.on(PS.UPDATE_CLIENT_ROLE_OPTIONS,D=>{this._setClientRoleOptions(D)})},0),this._key=a||n;let y=m.gatewayInfo,b=r.uid?r.uid:y.uid;this._joinInfo=lu(lu({},r),{},{cid:y.cid,uid:b,vid:y.vid,apResponse:y.res,apGatewayAddress:y.apGatewayAddress,uni_lbs_ip:y.uni_lbs_ip,gatewayAddrs:y.gatewayAddrs}),this.store.intUid=b,this.store.cid=y.cid;let A=await this._joinGateway();if(!this._joinAndNotLeaveYet)throw new De(oe.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"));t.onSuccess(A),this._appId=n,this._channelName=r.cname,this._uid=A,this.store.uid=A,setTimeout(()=>{this._networkQualityInterval&&window.clearInterval(this._networkQualityInterval),this._networkQualityInterval=window.setInterval(this._handleUpdateNetworkQuality,2e3),window.addEventListener(mr()?"beforeunload":"pagehide",this._handleBeforeUnload),this._statsCollector.startUpdateStats()},0);let O=r.stringUid?"string uid: ".concat(r.stringUid,",uid: ").concat(r.uid):"uid: ".concat(this._uid);return z.info("[".concat(this._clientId,"] Joining channel success: channel: ").concat(i,",").concat(O)),setTimeout(()=>{z.startUpload()},5e3),this.store.joinEnd(),f=this,ft(Yp).call(Yp,f)||Yp.push(f),this._cloudProxyServerMode==="disabled"&&Un().supportWebCrypto&&ge("ENABLE_PRELOAD")&&YI(this._joinInfo),A}catch(m){let E=Array.isArray(m)?m[0]:m;throw E&&E.code===oe.OPERATION_ABORTED?z.warning("[".concat(this._clientId,"] join number: ").concat(_,", Joining channel failed, rollback"),E):z.error("[".concat(this._clientId,"] join number: ").concat(_,", Joining channel failed, rollback"),E),E.code!==oe.OPERATION_ABORTED&&this._numberOfJoinCount===_&&(this._gateway.state="DISCONNECTED",this._reset()),t.onError(E),E}var f}_joinGateway(){if(!this._joinInfo||!this._key)throw new De(oe.INVALID_OPERATION);return this._gateway.join(this._joinInfo,this._key,!(this._joinInfo.cloudProxyServer!=="disabled"||this._joinInfo.proxyServer||!ge("JOIN_WITH_FALLBACK_SIGNAL_PROXY")))}async leave(){z.info("[".concat(this._clientId,"] Leaving channel")),window.removeEventListener(mr()?"beforeunload":"pagehide",this._handleBeforeUnload),this._reset(),function(i){let a=Yp.indexOf(i);a!==-1&&Yp.splice(a,1)}(this),this._statsCollector.stopUpdateStats();let n=await this._leaveMutex.lock();if(this.connectionState==="DISCONNECTED")return z.info("[".concat(this._clientId,"] Leaving channel repeated, success")),void n();await this._gateway.leave(this.connectionState!=="CONNECTED",ur.LEAVE),z.info("[".concat(this._clientId,"] Leaving channel success")),this._joinAndNotLeaveYet=!1,this.store.resetJoinChannelServiceRecords(),n()}async publish(n){let i=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(!Array.isArray(n)){if(!(n instanceof yo))return this._publishDataChannel(n);n=[n]}if(n.length===0)throw new De(oe.INVALID_PARAMS,"param list is empty");let a=n;if(this._gateway.role==="audience")throw new De(oe.INVALID_OPERATION,"audience can not publish stream");for(let u of a){if(!(u instanceof yo))throw new De(oe.INVALID_PARAMS,"parameter is not local track");if(!u._enabled&&i)throw new De(oe.TRACK_IS_DISABLED,"can not publish a disabled track: ".concat(u.getTrackId()))}z.info("[".concat(this._clientId,"] Publishing tracks, id ").concat(a.map(u=>"".concat(u.getTrackId()," "))));let c=await this._publishMutex.lock();await this._configDistribute.awaitConfigDistributeComplete(),i&&a.forEach(u=>{let _=this._configDistribute.getBitrateLimit();u instanceof ni&&_&&u.setBitrateLimit(_.uplink)});try{await this._publishHighStream(a),z.info("[".concat(this._clientId,"] Publish success, id ").concat(a.map(u=>"".concat(u.getTrackId()," "))))}catch(u){throw z.error("[".concat(this._clientId,"] publish error"),u.toString()),u}finally{c()}}async _publishDataChannel(n){Cr(n.id,"id",0,65535,!0),Vp(n.ordered,"ordered"),Pa(n.metadata,"metadata",0,512),z.info("[".concat(this._clientId,"] Publishing datachannels, id ").concat(n.id));let i=await this._publishMutex.lock();try{if(this._p2pChannel.getAllDataChannels().findIndex(u=>u.id===n.id)!==-1)throw new De(oe.INVALID_PARAMS,"Invalid id: ".concat(n.id,". If you want to republish the datachannel, unpublish first"));if(!this._joinInfo||this._uid===void 0)throw new De(oe.INVALID_OPERATION,"Can't publish datachannel, haven't joined yet!");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new De(oe.INVALID_OPERATION,"can not publish datachannel in ".concat(this.connectionState," state"));if(this._turnServer.mode==="auto"&&ge("FORCE_TURN")&&!ge("TURN_ENABLE_TCP")&&!ge("TURN_ENABLE_UDP"))throw new De(oe.UNEXPECTED_ERROR,"force TURN With No TURN Configuration");let a=function(u){return NI(u,!1)}(n),c=await this._p2pChannel.publishDataChannel([a]);if(c.length>0){if(typeof a._originDataChannelId!="number")throw z.error("[".concat(this._clientId,"] can not publish with mediaType datachannel, cannot get RTCDatachannel id")),new De(oe.CREATE_DATACHANNEL_ERROR);try{await Et.all(c.map(u=>this._uid&&this._gateway.publishDataChannel(this._uid,u,!0))),await a._waitTillOpen()}catch(u){if(u.code!==oe.DISCONNECT_P2P)throw u}}return z.info("[".concat(this._clientId,"] Publish dataChannels success, id ").concat(a.id)),a}catch(a){throw z.error("[".concat(this._clientId,"] publish datachannels error"),a.toString()),a}finally{i()}}async unpublish(n){if(!this._joinInfo||this._uid===void 0)throw new De(oe.INVALID_OPERATION,"Can't unpublish stream, haven't joined yet!");let i=[];if(n)if(Array.isArray(n))i=n;else{if(!(n instanceof yo))return this._unpublishDataChannel([n]);i=[n]}else this.store.useP2P||await this._unpublishDataChannel(),i=this._p2pChannel.getAllTracks(!0);z.info("[".concat(this._clientId,"] Unpublish tracks, tracks ").concat(i.map(c=>"".concat(c.getTrackId()," "))," "));let a=await this._publishMutex.lock();try{if(this.store.useP2P){let c=await this._p2pChannel.unpublish(i);c&&await this._gateway.sendExtensionMessage(ut.UNPUBLISH,{unpubMsg:c},!0)}else{let c=await this._p2pChannel.unpublish(i);c&&await this._gateway.unpublish(c,this._uid),z.info("[".concat(this._clientId,"] Unpublish success,tracks ").concat(i.map(u=>"".concat(u.getTrackId()))))}}catch(c){throw z.error("[".concat(this._clientId,"] unpublish error"),c.toString()),c}finally{a&&a()}}async _unpublishDataChannel(n){n!==void 0&&n.length!==0||(n=this._p2pChannel.getAllDataChannels()),z.info("[".concat(this._clientId,"] Unpublish datachannels, datachannels ").concat(n.map(a=>"".concat(a.id," "))," "));let i=await this._publishMutex.lock();try{let a=await this._p2pChannel.unpublishDataChannel(n);a&&await this._gateway.unpublishDataChannel(a),z.info("[".concat(this._clientId,"] Unpublish dataChannel success,dataChannel ").concat(n.map(c=>"".concat(c.id))))}catch(a){throw z.error("[".concat(this._clientId,"] unpublish dataChannel error"),a.toString()),a}finally{i&&i()}}async subscribe(n,i,a){if(!(n instanceof Hg)){let c=this.remoteUsers.find(u=>u.uid===n);if(!c)throw new De(oe.INVALID_REMOTE_USER,"user is not in the channel");n=c}return i==="datachannel"?this._subscribeDataChannel(n,a):this._subscribe(n,i)}async presubscribe(n,i){if(Ia(i,"mediaType",["audio","video"]),this.store.useP2P)throw new De(oe.INVALID_OPERATION,"can't presub at p2p mode");if(!this._joinInfo)throw new De(oe.INVALID_OPERATION,"can't presub when not join");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new De(oe.INVALID_OPERATION,"can't presub in ".concat(this.connectionState," state"));let a=i===Tt.AUDIO,c=i===Tt.VIDEO,u=await this._subscribeMutex.lock();try{let{ssrcId:_,ortc:S,rtxSsrcId:C,cname:R,uint_id:e}=await this._gateway.presubscribe(n,i,!0);if(_==null)throw new De(oe.UNEXPECTED_RESPONSE,"no ssrc id");let t=this._users.find(s=>s.uid===n);t||(t=new Hg(n,e||n),t._is_pre_created=!0,this._users.push(t)),R&&(t._cname=R),t._uintid||(t._uintid=e||n),a&&(t._audioSSRC=_,t._audio_pre_subscribed=!0,S&&(t._audioOrtc=S)),c&&(t._videoSSRC=_,t._video_pre_subscribed=!0,S&&(t._videoOrtc=S),C!=null&&(t._rtxSsrcId=C)),z.info("[".concat(this._clientId,"] presub succeed ssrc: ").concat(_)),await this._p2pChannel.subscribe(t,i,_,C,S);let r=a?t._audioTrack:t._videoTrack;if(!r)throw new De(oe.UNEXPECTED_ERROR,"can not find remote track in user");return a&&(t._trust_audio_stream_added_state_=!0,t._audio_added_=!0),c&&(t._trust_video_stream_added_state_=!0,t._video_added_=!0),r}catch(_){throw z.error("[".concat(this._clientId,"] presub user ").concat(n," error"),_),_}finally{u()}}async _subscribeDataChannel(n,i){var a;if(Cr(i,"channelId",0,65535,!0),!this._joinInfo)throw new De(oe.INVALID_OPERATION,"Can't subscribe datachannel, not joined");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new De(oe.INVALID_OPERATION,"Can't subscribe datachannel in ".concat(this.connectionState," state"));if(!this._users.find(S=>S===n))throw z.error("[".concat(this._clientId,"] can not subscribe ").concat(n.uid,", this user is not in the channel")),new De(oe.INVALID_REMOTE_USER,"user is not in the channel");if(!n.hasAudio&&!n.hasVideo&&n._dataChannels.length===0)throw z.error("[".concat(this._clientId,"] can not subscribe ").concat(n.uid,", user is not published")),new De(oe.INVALID_REMOTE_USER,"user is not published");let c=(a=n._dataChannels)===null||a===void 0?void 0:a.find(S=>S.id===i);if(!c)throw z.error("[".concat(this._clientId,"] can not subscribe ").concat(n.uid," with mediaType datachannel, remote datachannel is not published")),new De(oe.REMOTE_USER_IS_NOT_PUBLISHED);let u=await this._subscribeMutex.lock();z.info("[".concat(this._clientId,"] subscribe user ").concat(n.uid,", mediaType: datachannel"));try{let S=await this._p2pChannel.subscribeDataChannel(n,[c]);if(S&&ft(S).call(S,c.id))try{var _;if(typeof c._originDataChannelId!="number")throw z.error("[".concat(this._clientId,"] can not subscribe ").concat(n.uid," with mediaType datachannel, cannot get RTCDatachannel")),new De(oe.CREATE_DATACHANNEL_ERROR);let C={id:c.id,datachannelId:c._originDataChannelId,ordered:c.ordered,maxRetransmits:c.maxRetransmits,metadata:(_=c.metadata)!==null&&_!==void 0?_:""};await this._gateway.subscribeDataChannel(n.uid,C,!0),await c._waitTillOpen()}catch(C){if((C==null?void 0:C.code)!==oe.WS_ABORT)throw await this._p2pChannel.unsubscribeDataChannel(n,[c]),C;await this._p2pChannel.unsubscribeDataChannel(n,[c]),this._p2pChannel.setPendingRemoteDataChannel(n,c.id)}return z.info("[".concat(this._clientId,"] subscribe success user ").concat(n.uid,", mediaType: datachannel")),c}finally{u()}}async _p2pSubscribe(n,i,a){if(Ia(i,"mediaType",["audio","video"]),!this._joinInfo)throw new De(oe.INVALID_OPERATION,"Can't subscribe stream, not joined");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new De(oe.INVALID_OPERATION,"Can't subscribe stream in ".concat(this.connectionState," state"));if(!this._users.find(u=>u===n)){let u=new De(oe.INVALID_REMOTE_USER,"user is not in the channel");throw z.error("[".concat(this._clientId,"] can not subscribe ").concat(n.uid,", this user is not in the channel")),u}if(!n.hasAudio&&!n.hasVideo){let u=new De(oe.INVALID_REMOTE_USER,"user is not published");throw z.error("[".concat(this._clientId,"] can not subscribe ").concat(n.uid,", user is not published")),u}if(!a&&(i==="audio"&&!n.hasAudio||i==="video"&&!n.hasVideo)){let u=new De(oe.REMOTE_USER_IS_NOT_PUBLISHED);throw z.error("[".concat(this._clientId,"] can not subscribe ").concat(n.uid," with mediaType ").concat(i,", remote track is not published")),u}let c=await this._subscribeMutex.lock();z.info("[".concat(this._clientId,"] subscribe user ").concat(n.uid,", mediaType: ").concat(i));try{if(await this._p2pChannel.hasRemoteMediaWithLock(n,i))await this._p2pChannel.unmuteRemote(n,i);else try{let _=i==="audio"?n._audioSSRC:n._videoSSRC,S=i==="audio"?n._audioMid:n._videoMid;this.store.subscribe(n.uid,i,Date.now()),this.store.useP2P&&await this._p2pChannel.subscribe(n,i,_,S)}catch(_){throw _}z.info("[".concat(this._clientId,"] subscribe success user ").concat(n.uid,", mediaType: ").concat(i)),this._defaultStreamFallbackType&&this.setStreamFallbackOption(n.uid,this._defaultStreamFallbackType).catch(_=>{z.warning("[".concat(this._clientId,"] auto set fallback failed"),_)});let u=i==="audio"?n._audioTrack:n._videoTrack;if(!u)throw new De(oe.UNEXPECTED_ERROR,"can not find remote track in user object");return u}catch(u){throw z.error("[".concat(this._clientId,"] subscribe user ").concat(n.uid," error"),u),u}finally{c()}}async _subscribe(n,i,a){if(this.store.useP2P)return this._p2pSubscribe(n,i);if(Ia(i,"mediaType",["audio","video"]),!this._joinInfo)throw new De(oe.INVALID_OPERATION,"Can't subscribe stream, not joined");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new De(oe.INVALID_OPERATION,"Can't subscribe stream in ".concat(this.connectionState," state"));if(!this._users.find(R=>R===n)){let R=new De(oe.INVALID_REMOTE_USER,"user is not in the channel");throw z.error("[".concat(this._clientId,"] can not subscribe ").concat(n.uid,", this user is not in the channel")),R}if(!n.hasAudio&&!n.hasVideo){let R=new De(oe.INVALID_REMOTE_USER,"user is not published");throw z.error("[".concat(this._clientId,"] can not subscribe ").concat(n.uid,", user is not published")),R}if(!(a||(i!=="audio"||n.hasAudio&&n._audioSSRC!==void 0)&&(i!=="video"||n.hasVideo&&n._videoSSRC!==void 0))){let R=new De(oe.REMOTE_USER_IS_NOT_PUBLISHED);throw z.error("[".concat(this._clientId,"] can not subscribe ").concat(n.uid," with mediaType ").concat(i,", remote track is not published")),R}let c=i==="audio"?n._audioSSRC:n._videoSSRC,u=i==="audio"?n._audioOrtc:n._videoOrtc,_=i==="video"?n._rtxSsrcId:void 0,S={stream_type:i==="audio"?Tt.AUDIO:Tt.VIDEO,ssrcId:c},C=await this._subscribeMutex.lock();z.info("[".concat(this._clientId,"] subscribe user ").concat(n.uid,", mediaType: ").concat(i));try{if(await this._p2pChannel.hasRemoteMediaWithLock(n,i))await this._p2pChannel.unmuteRemote(n,i);else try{let e=i==="audio"?n._audioSSRC:n._videoSSRC;e!==void 0&&e!==c&&(c=e,u=i==="audio"?n._audioOrtc:n._videoOrtc,_=i==="video"?n._rtxSsrcId:void 0,S={stream_type:i==="audio"?Tt.AUDIO:Tt.VIDEO,ssrcId:c}),Cs.markSubscribeStart(this.store.clientId,c),this.store.subscribe(n.uid,i,Date.now()),await this._p2pChannel.subscribe(n,i,c,_,u);try{this._p2pChannel.isPreSubScribe(c)||await this._gateway.subscribe(n.uid,S,!0)}catch(t){if((t==null?void 0:t.code)!==oe.WS_ABORT)throw await this._p2pChannel.unsubscribe(n,i),t;await this._p2pChannel.unsubscribe(n,i,!0),this._p2pChannel.setPendingRemoteMedia(n,i)}this.store.subscribe(n.uid,i,void 0,Date.now()),this._p2pChannel.reportSubscribeEvent(!0,null,n,i)}catch(e){throw this._p2pChannel.reportSubscribeEvent(!1,e==null?void 0:e.code,n,i),e}z.info("[".concat(this._clientId,"] subscribe success user ").concat(n.uid,", mediaType: ").concat(i)),this._defaultStreamFallbackType&&this.setStreamFallbackOption(n.uid,this._defaultStreamFallbackType).catch(e=>{z.warning("[".concat(this._clientId,"] auto set fallback failed"),e)});let R=i==="audio"?n._audioTrack:n._videoTrack;if(!R)throw new De(oe.UNEXPECTED_ERROR,"can not find remote track in user object");return R}catch(R){throw z.error("[".concat(this._clientId,"] subscribe user ").concat(n.uid," error"),R),R}finally{C()}}async massSubscribe(n){if(Xd(n,"subscribeList"),!this._joinInfo)throw new De(oe.INVALID_OPERATION,"Can't subscribe stream, not joined");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new De(oe.INVALID_OPERATION,"Can't subscribe stream in ".concat(this.connectionState," state"));let i=Date.now(),a=new Map,c=await this._subscribeMutex.lock();z.info("[".concat(this._clientId,"]start massSubscribe user ").concat(n.map(C=>{let{user:R,mediaType:e}=C;return"user: ".concat(R==null?void 0:R.uid,", mediaType: ").concat(e)}).join("; ")));let u=(n=[...n]).map(C=>{let{user:R,mediaType:e}=C;return{user:R,mediaType:e}}),_=await this._p2pChannel.globalLock();try{var S;for(let R=n.length-1;R>=0;R--){let e=n[R],{user:t,mediaType:r}=e;if(Ia(r,"mediaType",["audio","video"]),!t){let f=new De(oe.INVALID_PARAMS,"user property does not exist in subscribeList item");throw z.error("[".concat(this._clientId,"] user property does not exist in subscribeList item")),f}if(!this._users.find(f=>f===t)){let f=new De(oe.INVALID_REMOTE_USER,"user is not in the channel");z.error("[".concat(this._clientId,"] can not massSubscribe ").concat(t.uid,", this user is not in the channel")),u[R].error=f,n.splice(R,1);continue}if(r==="audio"&&(!t.hasAudio||t._audioSSRC===void 0)||r==="video"&&(!t.hasVideo||t._videoSSRC===void 0)){let f=new De(oe.REMOTE_USER_IS_NOT_PUBLISHED);z.error("[".concat(this._clientId,"] can not subscribe ").concat(t.uid," with mediaType ").concat(r,", remote user is not published")),u[R].error=f,n.splice(R,1);continue}let s=Wa.Video|Wa.LwoVideo,l=a.get(t);if(l){if(r==="video"?l&s:l&Wa.Audio){n.splice(R,1),z.warning("[".concat(this._clientId,"] repeat massSubscribe user:").concat(t.uid,", mediaType:").concat(r," twice"));continue}a.set(t,l|(r==="video"?s:Wa.Audio))}else a.set(t,r==="video"?s:Wa.Audio)}for(let R=n.length-1;R>=0;R--){let e=n[R],{user:t,mediaType:r}=e,s=Wa.Video|Wa.LwoVideo;if(this._p2pChannel.hasRemoteMedia(t,r)){await this._p2pChannel.unmuteRemoteNoLock(t,r);let l=a.get(t);a.set(t,r==="video"?l^s:l^Wa.Audio),n.splice(R,1)}}this.store.massSubscribe(n.map(R=>({userId:R.user.uid,type:R.mediaType})),i);let C=Ds(S=Array.from(a.entries())).call(S,(R,e)=>{let[t,r]=e;if(r===0)return R;let s={stream_id:t.uid,stream_type:r};return r&Wa.Audio&&(s.audio_ssrc=t._audioSSRC),r&Wa.Video&&(s.video_ssrc=t._videoSSRC),R.push(s),R},[]);try{n.length>0&&await this._p2pChannel.massSubscribeNoLock(n.map(e=>{let{user:t,mediaType:r}=e;return{user:t,mediaType:r,ssrcId:r===Tt.VIDEO?t._videoSSRC:t._audioSSRC,rtxSsrcId:r===Tt.VIDEO?t._rtxSsrcId:void 0}}));let R=new Map;if(C=C.filter(e=>e.video_ssrc&&!this._p2pChannel.isPreSubScribe(e.video_ssrc)||e.audio_ssrc&&!this._p2pChannel.isPreSubScribe(e.audio_ssrc)||!e.video_ssrc&&!e.audio_ssrc),C.length>0){let e=await this._gateway.subscribeAll(C,!0);((e==null?void 0:e.users)||[]).forEach(t=>{let{stream_id:r,video_error_code:s,audio_error_code:l,error_code:f}=t;(s||l||f)&&R.set(r,{video_error_code:s,audio_error_code:l,error_code:f})})}if(Array.from(R.entries()).length>0){let e=[];Array.from(R.entries()).forEach(t=>{let[r,s]=t,l=this.remoteUsers.find(f=>f.uid===r);if(l){let f;s.error_code||s.video_error_code&&s.audio_error_code?f=void 0:s.video_error_code?f=Tt.VIDEO:s.audio_error_code&&(f=Tt.AUDIO),e.push({user:l,mediaType:f})}}),e.length>0&&await this._p2pChannel.massUnsubscribeNoLock(e)}for(let e of u){let t=R.get(e.user.uid);if(t){let r=t.error_code||e.mediaType==="audio"&&t.audio_error_code||e.mediaType==="video"&&t.video_error_code;if(r){let s=Hc(r);z.error("user:".concat(e.user.uid," mediaType:").concat(e.mediaType," has massSubscribe error ").concat(s.desc)),e.error=new De(oe.SUBSCRIBE_FAILED,"code ".concat(r,": ").concat(s.desc))}}e.error||(e.mediaType==="video"?e.track=e.user.videoTrack:e.track=e.user.audioTrack)}return this.store.massSubscribe(u.filter(e=>!e.error).map(e=>({userId:e.user.uid,type:e.mediaType})),void 0,Date.now()),u.forEach(e=>{var t;jt.subscribe(this.store.sessionId,{succ:!!e.error,ec:((t=e.error)===null||t===void 0?void 0:t.code)||null,video:e.mediaType===Tt.VIDEO,audio:e.mediaType===Tt.AUDIO,peerid:e.user.uid,subscribeRequestid:e.mediaType===Tt.VIDEO?e.user._videoSSRC:e.user._audioSSRC,p2pid:this.store.p2pId,eventElapse:Math.floor(performance.now()-i),preSsrc:this._p2pChannel.isPreSubScribe(e.user._videoSSRC)},!0)}),z.info("[".concat(this._clientId,"] massSubscribe success ").concat(n.map(e=>{let{user:t,mediaType:r}=e;return"user: ".concat(t==null?void 0:t.uid,", mediaType: ").concat(r)}).join("; "))),u}catch(R){throw await this._p2pChannel.massUnsubscribeNoLock(n),R}}finally{_(),c()}}async unsubscribe(n,i,a){if(!(n instanceof Hg)){let u=this.remoteUsers.find(_=>_.uid===n);if(!u)throw new De(oe.INVALID_REMOTE_USER,"user is not in the channel");n=u}if(i||this.store.useP2P){if(i==="datachannel")return this._unsubscribeDataChannel(n,a)}else await this._unsubscribeDataChannel(n,a);if(i&&Ia(i,"mediaType",["audio","video"]),!this._joinInfo)throw new De(oe.INVALID_OPERATION,"Can't unsubscribe stream, haven't joined yet!");if(!this._users.find(u=>u===n)){let u=new De(oe.INVALID_REMOTE_USER,"user is not in the channel");throw z.error("[".concat(this._clientId,"] can not unsubscribe ").concat(n.uid,", user is not in the channel")),u}z.info("[".concat(this._clientId,"] unsubscribe uid: ").concat(n.uid,", mediaType: ").concat(i));let c=await this._subscribeMutex.lock();try{if(this.store.useP2P)await this._p2pChannel.unsubscribe(n,i);else{let u=await this._p2pChannel.unsubscribe(n,i);u&&await this._gateway.unsubscribe(u,n.uid),i&&i!=="audio"||(n._audio_pre_subscribed=!1),i&&i!=="video"||(n._video_pre_subscribed=!1),n._is_pre_created&&iI(this._users,n),z.info("[".concat(this._clientId,"] unsubscribe success uid: ").concat(n.uid,", mediaType: ").concat(i))}}catch(u){if(u.code===oe.DISCONNECT_P2P)return void z.warning("disconnecting p2p, abort unsubscribe request.");throw z.error("[".concat(this._clientId,"] unsubscribe user ").concat(n.uid," error"),u.toString()),u}finally{c()}}async _unsubscribeDataChannel(n,i){if(i&&Cr(i,"id",0,65535,!0),!this._joinInfo)throw new De(oe.INVALID_OPERATION,"Can't unsubscribe datachannel, haven't joined yet!");if(!this._users.find(c=>c===n)){let c=new De(oe.INVALID_REMOTE_USER,"user is not in the channel");throw z.error("[".concat(this._clientId,"] can not unsubscribe ").concat(n.uid,", user is not in the channel")),c}let a;if(typeof i=="number"){let c=n._dataChannels.find(u=>u.id===i);c&&(a=[c])}else a=n._dataChannels;if(a===void 0){let c=new De(oe.REMOTE_USER_IS_NOT_PUBLISHED);throw z.error("[".concat(this._clientId,"] can not unsubscribe ").concat(n.uid," with channelId ").concat(i,", remote datachannel is not published")),c}z.info("[".concat(this._clientId,"] unsubscribe uid: ").concat(n.uid,", mediaType: datachannel, ids: ").concat(a.map(c=>c.id)));try{let c=await this._p2pChannel.unsubscribeDataChannel(n,a);c&&await this._gateway.unsubscribeDataChannel(c,n.uid),z.info("[".concat(this._clientId,"] unsubscribe datachannel success uid: ").concat(n.uid,", mediaType: datachannel, ids: ").concat(c))}catch(c){if(c.code===oe.DISCONNECT_P2P)return void z.warning("disconnecting p2p, abort unsubscribe request.");throw z.error("[".concat(this._clientId,"] unsubscribe user ").concat(n.uid," error"),c.toString()),c}}async massUnsubscribe(n){if(Xd(n,"unsubscribeList"),!this._joinInfo)throw new De(oe.INVALID_OPERATION,"Can't unsubscribeAll stream, haven't joined yet!");z.info("[".concat(this._clientId,"] start massUnsubscribe ").concat(n.map(a=>{let{user:c,mediaType:u}=a;return"user: ".concat(c==null?void 0:c.uid,", mediaType: ").concat(u,";")}).join())),n=[...n];let i=new Map;for(let a=n.length-1;a>=0;a--){let{user:c,mediaType:u}=n[a];if(!c){let S=new De(oe.INVALID_PARAMS,"user property does not exist in unsubscribeList item");throw z.error("[".concat(this._clientId,"] user property does not exist in unsubscribeList item")),S}if(Ia(u,"mediaType",["video","audio",void 0]),!this._users.find(S=>S===c)){z.warning("[".concat(this._clientId,"] can not unsubscribe ").concat(c.uid,", user is not in the channel")),n.splice(a,1);continue}let _=Wa.Video|Wa.LwoVideo;if(i.has(c)){let S=i.get(c),C;switch(u){case"video":C=S&_;break;case"audio":C=S&Wa.Audio;break;default:C=S&(Wa.Audio|_)}if(C){z.warning("[".concat(this._clientId,"] repeat massUnsubscribe user:").concat(c.uid,",mediaType:").concat(u," twice.")),n.splice(a,1);continue}u?u==="audio"?i.set(c,S|Wa.Audio):u==="video"&&i.set(c,S|_):i.set(c,S|Wa.Audio|_)}else u?u==="audio"?i.set(c,Wa.Audio):u==="video"&&i.set(c,_):i.set(c,Wa.Audio|_)}try{let a=await this._p2pChannel.massUnsubscribe(n);a&&await this._gateway.massUnsubscribe(a),z.info("[".concat(this._clientId,"] massUnsubscribe success ").concat(n.map(c=>{let{user:u,mediaType:_}=c;return"user: ".concat(u==null?void 0:u.uid,", mediaType: ").concat(_,";")}).join()))}catch(a){if(a.code===oe.DISCONNECT_P2P)return void z.warning("[".concat(this._clientId,"] disconnecting p2p, abort unsubscribe request."));throw z.error("[".concat(this._clientId,"] massUnsubscribe error"),a.toString()),a}}async setLowStreamParameter(n){(function(a){if(!a)throw new Ye(oe.INVALID_PARAMS);Bt(a.width)||fh(a.width,"streamParameter.width"),Bt(a.height)||fh(a.height,"streamParameter.height"),Bt(a.framerate)||fh(a.framerate,"streamParameter.framerate"),Bt(a.bitrate)||Cr(a.bitrate,"streamParameter.bitrate")})(n),(!n.width&&n.height||n.width&&!n.height)&&z.warning("[".concat(this._clientId,"] The width and height parameters take effect only when both are set")),z.info("[".concat(this._clientId,"] set low stream parameter to"),JSON.stringify(n));let i=this._configDistribute.getLowStreamConfigDistribute();if(i&&i.bitrate&&n.bitrate&&i.bitrate<n.bitrate&&(n.bitrate=i.bitrate),this._lowStreamParameter=n,this._isDualStreamEnabled)return this._p2pChannel.updateVideoStreamParameter(n,Qe.LocalVideoLowTrack)}async enableDualStream(){if(!Un().supportDualStream)throw jt.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!0,succ:!1}),new De(oe.NOT_SUPPORTED,"Your browser is not support dual stream");if(this._isDualStreamEnabled)throw new De(oe.INVALID_OPERATION,"Dual stream is already enabled");if(this._p2pChannel.canPublishLowStream())try{await this._publishLowStream()}catch(n){throw jt.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!0,succ:!1}),n}this._isDualStreamEnabled=!0,jt.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!0,succ:!0}),z.info("[".concat(this._clientId,"] enable dual stream"))}async disableDualStream(){if(this._isDualStreamEnabled){if(!this._joinInfo)throw new De(oe.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");if(this._p2pChannel.getLocalMedia(Qe.LocalVideoLowTrack))try{let n=await this._p2pChannel.unpublishLowStream();n&&await this._gateway.unpublish(n,this._joinInfo.stringUid||this._joinInfo.uid)}catch(n){throw jt.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!1,succ:!1}),n}this._isDualStreamEnabled=!1,jt.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!1,succ:!0}),z.info("[".concat(this._clientId,"] disable dual stream"))}}async setClientRole(n,i){if(function(c){Ia(c,"role",["audience","host"])}(n),i&&rI(i),this.mode==="rtc"||this.mode==="p2p")throw z.warning("[".concat(this._clientId,"]").concat(this.mode," mode can not use setClientRole")),new De(oe.INVALID_OPERATION,"".concat(this.mode," mode can not use setClientRole"));if(i&&i.level&&n==="host")throw new De(oe.INVALID_OPERATION,"host mode can not set audience latency level");if(n==="audience"&&this._p2pChannel.hasLocalMedia())throw new De(oe.INVALID_OPERATION,"can not set client role to audience when publishing stream");let a=this._config.role;this._joinInfo&&(this._joinInfo.role=n),n!==a&&ge("ENABLE_ROLE_SELECT_EDGE")?(this._gateway.updateClientRole(n,i),this._config.role=n,this._gateway.reconnect("recover",Ma.REGIONAL_DISTRIBUTION)):(await this._gateway.setClientRole(n,i),this._config.role=n),z.info("[".concat(this._clientId,"] set client role to ").concat(n,", level: ").concat(i&&i.level))}async _setClientRoleOptions(n){if(this.mode==="rtc"||this.mode==="p2p"||this._config.role!=="audience"||this._p2pChannel.hasLocalMedia())return;let i=!1;try{n&&rI(n),await this._gateway.setClientRole(this._config.role,n),i=!0}catch{}finally{z.info("[".concat(this._clientId,"] set client role options ").concat(i?"succeed":"failed",", options is ").concat(n))}}getRemoteInboundOffset(){var n;let i=(n=this._p2pChannel.getStats())===null||n===void 0?void 0:n.audioSend[0];if(!i||!i.timestamp)return 0;let a=i.timestamp-Date.now();return Math.abs(a)>1e3+i.rttMs+100?this.ntpAlignErrorCount+=1:this.ntpAlignErrorCount=0,this.ntpAlignErrorCount>=3?a:0}getNtpWallTimeInMs(){return document.visibilityState==="visible"&&(this.remoteInboundOffset=this.getRemoteInboundOffset()),this.remoteInboundOffset+Date.now()+this._gateway.ntpOffset}setProxyServer(n,i){if(Pa(n,"proxyServer"),!i){if(this.connectionState!=="DISCONNECTED")throw new De(oe.INVALID_OPERATION,"Set proxy server before join channel");if(this._cloudProxyServerMode!=="disabled"||this._useLocalAccessPoint)throw new De(oe.INVALID_OPERATION,"You have already set the proxy")}this._proxyServer=n,jt.setProxyServer(this._proxyServer),z.setProxyServer(this._proxyServer),z.info("[".concat(this._clientId,"] Set proxy server ").concat(i?"by initialize call":""," success."))}setTurnServer(n,i){if(Array.isArray(n)||(n=[n]),!i){if(this.connectionState!=="DISCONNECTED")throw new De(oe.INVALID_OPERATION,"Set turn server before join channel");if(this._cloudProxyServerMode!=="disabled"||this._useLocalAccessPoint)throw new De(oe.INVALID_OPERATION,"You have already set the proxy")}if(vS(n))return this._turnServer={servers:n,mode:"original-manual"},void z.info("[".concat(this._clientId,"] Set original turnserver ").concat(i?"by initialize call":""," success: ").concat(n.map(a=>a.urls).join(","),"."));n.forEach(a=>Tx(a)),this._turnServer={servers:n,mode:"manual"},z.info("[".concat(this._clientId,"] Set turnserver ").concat(i?"by initialize call":""," success."))}setLicense(n){if(this.connectionState!=="DISCONNECTED")throw new De(oe.INVALID_OPERATION,"you should set license before join channel");if(Pa(n,"license",32,32),!/^[A-Za-z\d]+$/.test(n))throw new De(oe.INVALID_PARAMS,"license should only contains characters from A-Z a-z 0-9");this._license=n,z.info("[".concat(this._clientId,"] set license success"),n)}startProxyServer(n){if(this.connectionState!=="DISCONNECTED")throw new De(oe.INVALID_OPERATION,"Start proxy server before join channel");if(this._proxyServer||this._turnServer.mode==="manual"||this._useLocalAccessPoint)throw new De(oe.INVALID_OPERATION,"You have already set the proxy");let i=[3,4,5],a;switch(n===void 0&&(n=3),n){case 1:case 2:throw new De(oe.NOT_SUPPORTED,"proxy mode 1/2 has been deprecated and not supported.");case 3:a="proxy3";break;case 4:a="proxy4";break;case 5:a="proxy5";break;default:throw new De(oe.INVALID_PARAMS,"proxy server mode must be ".concat(i.join("|")))}this._cloudProxyServerMode=a,this.store.cloudProxyServerMode=a,z.info("[".concat(this._clientId,"] set cloud proxy server mode to"),this._cloudProxyServerMode)}stopProxyServer(){if(this.connectionState!=="DISCONNECTED")throw new De(oe.INVALID_OPERATION,"Stop proxy server after leave channel");jt.setProxyServer(),z.setProxyServer(),this._cloudProxyServerMode="disabled",this.store.cloudProxyServerMode="disabled",z.info("[".concat(this._clientId,"] set cloud proxy server mode to"),this._cloudProxyServerMode),this._proxyServer=void 0,this._turnServer={mode:"auto",servers:[]}}setLocalAccessPointsV2(n){if(!n.accessPoints)throw new De(oe.INVALID_PARAMS,"accessPoints is required.");Xd(n.accessPoints.serverList,"accessPoints.serverList"),Pa(n.accessPoints.domain,"accessPoints.domain");let i=(s,l)=>{Cr(s,l,0,65535,!0)},a=443;if(n.accessPoints.port&&(i(n.accessPoints.port,"accessPoints.port"),a=n.accessPoints.port),this._proxyServer||this._cloudProxyServerMode!=="disabled")throw new De(oe.INVALID_OPERATION,"set local access point failed, You have already set the cloud proxy");ge("CLOSE_AFB_FOR_LOCAL_AP")&&(Sr("JOIN_WITH_FALLBACK_SIGNAL_PROXY",!1),Sr("JOIN_WITH_FALLBACK_MEDIA_PROXY",!1));let c=/^((\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.){3}(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/,u=n.accessPoints.domain,_=n.accessPoints.serverList.map(s=>c.test(s)?"".concat(s.replace(/\./g,"-"),".").concat(u):s),S=_.map(s=>"".concat(s,":").concat(a));this._useLocalAccessPoint=!0,this._setLocalAPVersion=2,Sr("WEBCS_DOMAIN",S),Sr("WEBCS_DOMAIN_BACKUP_LIST",S),Sr("GATEWAY_DOMAINS",[u]),n.report&&n.report.hostname&&Array.isArray(n.report.hostname)&&n.report.hostname.length?(Xd(n.report.hostname,"report.hostname"),Sr("EVENT_REPORT_DOMAIN",n.report.hostname[0]),Sr("EVENT_REPORT_BACKUP_DOMAIN",n.report.hostname[1]||n.report.hostname[0])):(Sr("EVENT_REPORT_DOMAIN",_[0]),Sr("EVENT_REPORT_BACKUP_DOMAIN",_[1]||_[0]));let C=6443;n.report&&n.report.port&&(i(n.report.port,"report.port"),C=n.report.port),Sr("STATS_COLLECTOR_PORT",C),n.report?Sr("ENABLE_EVENT_REPORT",!0):Sr("ENABLE_EVENT_REPORT",!1);let R="";n.log&&n.log.hostname&&Array.isArray(n.log.hostname)&&n.log.hostname.length?(Xd(n.log.hostname,"log.hostname"),R=n.log.hostname[0]):R=_[0];let e=6444;n.log&&n.log.port&&(i(n.log.port,"log.port"),e=n.log.port),Sr("LOG_UPLOAD_SERVER","".concat(R,":").concat(e));let t=[];n.cds&&n.cds.hostname&&Array.isArray(n.cds.hostname)&&n.cds.hostname.length?(Xd(n.cds.hostname,"cds.hostname"),t=n.cds.hostname):t=_;let r=443;n.cds&&n.cds.port&&(i(n.cds.port,"cds.port"),r=n.cds.port),Sr("CDS_AP",t.map(s=>"".concat(s,":").concat(r))),n.cds?Sr("ENABLE_CONFIG_DISTRIBUTE",!0):Sr("ENABLE_CONFIG_DISTRIBUTE",!1),z.info("set local access point v2 success")}setLocalAccessPoints(n,i){if(Xd(n,"serverList"),Pa(i,"domain"),this._proxyServer||this._cloudProxyServerMode!=="disabled")throw new De(oe.INVALID_OPERATION,"set local access point failed, You have already set the cloud proxy");let a=/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/;n=n.map(c=>a.test(c)?"".concat(c.replace(/\./g,"-"),".").concat(i):c),this._useLocalAccessPoint=!0,this._setLocalAPVersion=1,Sr("WEBCS_DOMAIN",n),Sr("WEBCS_DOMAIN_BACKUP_LIST",n),Sr("GATEWAY_DOMAINS",[i]),Sr("EVENT_REPORT_DOMAIN",n[0]),Sr("EVENT_REPORT_BACKUP_DOMAIN",n[1]||n[0]),Sr("LOG_UPLOAD_SERVER","".concat(n[0],":6444")),z.info("[".concat(this._clientId,"] set local access point success"))}async setRemoteDefaultVideoStreamType(n){if(Ia(n,"streamType",[0,1,4,5,6,7,8,9]),this._remoteDefaultVideoStreamType=n,this._joinInfo)try{await this._gateway.setDefaultRemoteVideoStreamType(n),this._joinInfo.defaultVideoStream=this._remoteDefaultVideoStreamType}catch(i){throw z.error("[".concat(this._clientId,"] set default remote video stream type error"),i.toString()),i}else z.debug("[".concat(this._clientId,"] haven't joined yet, cache remoteDefaultVideoStreamType ").concat(n))}async setRemoteVideoStreamType(n,i){Ia(i,"streamType",[0,1,4,5,6,7,8,9]);try{await this._gateway.setRemoteVideoStreamType(n,i),setTimeout(()=>{let a=this._users.find(c=>c.uid===n);a&&a.videoTrack&&a.videoTrack.updateMediaStreamTrackResolution()},2e3)}catch(a){throw z.error("[".concat(this._clientId,"] set remote video stream type error"),a.toString()),a}z.info("[".concat(this._clientId,"] set remote ").concat(n," video stream type to ").concat(i)),this._remoteStreamTypeCacheMap.set(n,i)}async setStreamFallbackOption(n,i){Ia(i,"fallbackType",[0,1,2,3,4,5,6,7,8]);try{await this._gateway.setStreamFallbackOption(n,i)}catch(a){throw z.error("[".concat(this._clientId,"] set stream fallback option"),a.toString()),a}z.info("[".concat(this._clientId,"] set remote ").concat(n," stream fallback type to ").concat(i)),this._streamFallbackTypeCacheMap.set(n,i)}setEncryptionConfig(n,i,a,c){(function(_){Ia(_,"encryptionMode",["aes-128-xts","aes-256-xts","aes-128-ecb","sm4-128-ecb","aes-128-gcm","aes-256-gcm","aes-128-gcm2","aes-256-gcm2","none"])})(n),Pa(i,"secret");let u=["aes-128-gcm2","aes-256-gcm2"];if(ft(u).call(u,n)){if(!a||!(a instanceof Uint8Array&&a.length===32))throw new De(oe.INVALID_PARAMS,"salt must be an Uint8Array and exactly equal to 32 bytes")}else if(a)throw new De(oe.INVALID_PARAMS,"current encrypt mode does not need salt");if(c){if(Vp(c,"encryptDataStream"),!ft(u).call(u,n))throw new De(oe.INVALID_PARAMS,"current encrypt mode does not support data stream");this._encryptDataStream=!0}new RegExp(`^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#$%^&*,.<>?/:;'"|{}\\[\\]])(?=.{8,})`).test(i)||z.warning(`The secret is not strong:
      The secret must contain at least 1 lowercase alphabetical character,
      The secret must contain at least 1 uppercase alphabetical character,
      The secret must contain at least 1 numeric character,
      The secret must contain at least one special character,
      The secret must be eight characters or longer.
      `),this._encryptionMode=n,this._encryptionSecret=i,a&&(this._encryptionSalt=Gs(a))}async renewToken(n){if(Pa(n,"token",1,2047),!this._key||!this._joinInfo)throw new De(oe.INVALID_OPERATION,"renewToken should not be called before user join");let i=this._key;this._key=n,this._joinInfo&&(this._joinInfo.token=n);let a=await this._renewTokenMutex.lock();try{if(ge("USE_NEW_TOKEN")){z.debug("[".concat(this._clientId,"] start renew token with ticket from unilbs"));let c=await LY(this._joinInfo,this._axiosCancelSource.token,this._config.httpRetryConfig||da);z.debug("[".concat(this._clientId,"] get ticket from unilbs success")),await this._gateway.renewToken({token:n,ticket:c})}else z.debug("[".concat(this._clientId,"] start renew token without ticket")),await this._gateway.renewToken({token:n});z.debug("[".concat(this._clientId,"] renewToken success"))}catch(c){throw this._key=i,this._joinInfo.token=i,z.error("[".concat(this._clientId,"] renewToken failed"),c.toString()),c}finally{a()}}enableAudioVolumeIndicator(){this._audioVolumeIndicationInterval?z.warning("you have already enabled audio volume indicator!"):this._audioVolumeIndicationInterval=window.setInterval(()=>{let n=this._p2pChannel.getAudioLevels();this.safeEmit(Xt.VOLUME_INDICATOR,n)},ge("AUDIO_VOLUME_INDICATION_INTERVAL")||2e3)}getRTCStats(){let n=this._statsCollector.getRTCStats(),i=this._gateway.getInChannelInfo();return n.Duration=Math.round(i.duration/1e3),n}async startLiveStreaming(n,i){if(!i){if(this.codec!=="h264")throw new De(oe.LIVE_STREAMING_INVALID_RAW_STREAM,"raw streaming is only support h264");if(!this._p2pChannel.hasLocalMedia())throw new De(oe.LIVE_STREAMING_INVALID_RAW_STREAM,"can not find stream to raw streaming")}if(this._liveRawStreamingClient&&this._liveRawStreamingClient.hasUrl(n)||this._liveTranscodeStreamingClient&&this._liveTranscodeStreamingClient.hasUrl(n))throw new De(oe.LIVE_STREAMING_TASK_CONFLICT);let a=i?Ot.TRANSCODE:Ot.RAW;return this._createLiveStreamingClient(a).startLiveStreamingTask(n,a)}setLiveTranscoding(n){return this._createLiveStreamingClient(Ot.TRANSCODE).setTranscodingConfig(n)}async stopLiveStreaming(n){let i=[this._liveRawStreamingClient,this._liveTranscodeStreamingClient].filter(a=>a&&a.hasUrl(n));if(!i.length)throw new De(oe.INVALID_PARAMS,"can not find live streaming url to stop");await Et.all(i.map(a=>a&&a.stopLiveStreamingTask(n)))}async startChannelMediaRelay(n){Z8(n),await this._createChannelMediaRelayClient().startChannelMediaRelay(n)}async updateChannelMediaRelay(n){Z8(n),await this._createChannelMediaRelayClient().updateChannelMediaRelay(n)}async stopChannelMediaRelay(){await this._createChannelMediaRelayClient().stopChannelMediaRelay(),this._statsCollector.onStatsChanged&&(this._statsCollector.onStatsChanged=void 0)}sendAudioMetadata(n){this._p2pChannel instanceof uf&&this._p2pChannel.addAudioMetadata(n)}async sendStreamMessage(n){var i;let a=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(!this._joinInfo)throw new De(oe.INVALID_OPERATION,"can not send data stream, not joined");if((typeof n=="string"||n instanceof Uint8Array)&&(n={payload:n}),typeof n.payload=="string"){let u=new TextEncoder;n.payload=u.encode(n.payload)}let c=!1;if(this._encryptDataStream&&this._encryptDataStreamIv&&this._encryptDataStreamKey&&window.crypto.subtle&&ft(i=["aes-128-gcm2","aes-256-gcm2"]).call(i,this._encryptionMode)&&(c=!0,n.payload=await async function(u,_,S){var C;let R=Ds(C=Array.from(S)).call(C,(m,E)=>m+E,0),e={serverTs:0,seq:Ox++,length:S.length,checkSum:R},t=new Uint8Array(mh(R,2)),r=new ArrayBuffer(k_),s=new DataView(r);s.setUint32(0,e.serverTs),s.setUint16(4,e.seq),s.setUint16(6,e.length),s.setUint16(8,e.checkSum);let l=16-S.length%16;S=na(S,new Uint8Array(l));let f=await window.crypto.subtle.encrypt({name:"AES-GCM",iv:u,tagLength:ps,additionalData:t},_,S);return na(new Uint8Array(r),new Uint8Array(f))}(this._encryptDataStreamIv,this._encryptDataStreamKey,n.payload)),new Blob([n.payload]).size>1024)throw new De(oe.INVALID_PARAMS,c?"encrypted stream message out of range.":"stream message out of range.");return this._gateway.signal.request(ln.DATA_STREAM,{payload:Gs(n.payload),syncWithAudio:n.syncWithAudio,sendTs:Date.now()-On},!a)}sendMetadata(n){if(!this._joinInfo)throw new De(oe.INVALID_OPERATION,"can not send metadata, not joined");if(new Blob([n]).size>1024)throw new De(oe.METADATA_OUT_OF_RANGE);return this._gateway.signal.request(ln.SEND_METADATA,{session_id:this._joinInfo.sid,metadata:Gs(n)})}async sendCustomReportMessage(n){if(Array.isArray(n)||(n=[n]),n.forEach(xi),!this._joinInfo)throw new De(oe.INVALID_OPERATION,"can not send custom report, not joined");await jt.sendCustomReportMessage(this._joinInfo.sid,n)}getLocalAudioStats(){return this._statsCollector.getLocalAudioTrackStats()}getRemoteAudioStats(){return this._statsCollector.getRemoteAudioTrackStats()}getLocalVideoStats(){return this._statsCollector.getLocalVideoTrackStats()}getRemoteVideoStats(){return this._statsCollector.getRemoteVideoTrackStats()}getRemoteNetworkQuality(){return this._statsCollector.getRemoteNetworkQualityStats()}async pickSVCLayer(n,i){Ia(i.spatialLayer,"spatialLayer",[0,1,2,3]),Ia(i.temporalLayer,"temporalLayer",[0,1,2,3]);try{await this._gateway.pickSVCLayer(n,i)}catch(a){throw z.error("[".concat(this._clientId,"] pick SVC layer failed"),a.toString()),a}}async setRTMConfig(n){let{apRTM:i=!1,rtmFlag:a}=n;if(Vp(i,"apRTM"),Cr(a,"rtmFlag",0),this._rtmConfig.apRTM=i,this._rtmConfig.rtmFlag=a,z.debug("[".concat(this._clientId,"] setRTMconfig ").concat(JSON.stringify(n)," in ").concat(this.connectionState," state")),(this.connectionState==="CONNECTED"||this.connectionState==="RECONNECTING")&&this._joinInfo)return this._joinInfo.apRTM=i,this._joinInfo.rtmFlag=a,this._gateway.setRTM2Flag(a)}_reset(){if(z.debug("[".concat(this._clientId,"] reset client")),function(n){let i=NS.indexOf(n);i!==-1&&NS.splice(i,1)}(this._clientId),this.store.hasStartJoinChannel=!1,this.store.isABTestSuccess=!1,this._axiosCancelSource.cancel(),this._axiosCancelSource=eo.CancelToken.source(),this._streamFallbackTypeCacheMap=new Map,this._remoteStreamTypeCacheMap=new Map,this._configDistribute.stopGetConfigDistribute(),this._joinInfo&&yD(this._joinInfo),this._joinInfo=void 0,this._proxyServer=void 0,this._defaultStreamFallbackType=void 0,this._sessionId&&jt.removeSid(this._sessionId),this._sessionId=null,this.store.sessionId=null,this._statsCollector.reset(),this._key=void 0,this._appId=void 0,this._uid=void 0,this.store.uid=void 0,this._channelName=void 0,this._encryptionMode="none",this._encryptionSecret=null,this._encryptionSalt=null,this._encryptDataStreamKey=null,this._encryptDataStreamIv=null,this._pendingPublishedUsers=[],this._users.forEach(n=>{n._audioTrack&&n._audioTrack._destroy(),n._videoTrack&&n._videoTrack._destroy(),n._dataChannels&&(n._dataChannels.forEach(i=>i._close()),n._dataChannels.length=0)}),this._users=[],this._audioVolumeIndicationInterval&&(window.clearInterval(this._audioVolumeIndicationInterval),this._audioVolumeIndicationInterval=void 0),this._cloudProxyServerMode==="fallback"&&(this._cloudProxyServerMode="disabled",this.store.cloudProxyServerMode="disabled"),this._p2pChannel.reset(),this._publishMutex=new Na("client-publish",this._clientId),this._subscribeMutex=new Na("client-subscribe",this._clientId),this._networkQualityInterval&&(window.clearInterval(this._networkQualityInterval),this._networkQualityInterval=void 0),this._liveRawStreamingClient&&(this._liveRawStreamingClient.terminate(),this._liveRawStreamingClient.removeAllListeners(),this._liveRawStreamingClient=void 0),this._liveTranscodeStreamingClient&&(this._liveTranscodeStreamingClient.terminate(),this._liveTranscodeStreamingClient.removeAllListeners(),this._liveTranscodeStreamingClient=void 0),this._channelMediaRelayClient&&(this._channelMediaRelayClient.dispose(),this._channelMediaRelayClient=void 0),this._inspect)try{this._inspect.close(),this._inspect=void 0}catch{}if(this._moderation)try{this.setImageModeration(!1)}catch{}}_startSession(n,i){var a;let c=n||D_();n?z.debug("[".concat(this._clientId,"] new Session ").concat(c)):z.debug("[".concat(this._clientId,"] renewSession ").concat(this._sessionId," => ").concat(c));let u=n?"":this._sessionId||"";this._sessionId=c,this.store.sessionId=c,jt.addSid(c);let _={lts:new Date().getTime(),mode:this.mode,buildFormat:1,stringUid:(i==null?void 0:i.stringUid)||((a=this._joinInfo)===null||a===void 0?void 0:a.stringUid),channelProfile:this.mode==="live"?1:0,channelMode:0,isABTestSuccess:Number(this._configDistribute.isSuccess),lsid:u,clientRole:this.role==="audience"?2:1};jt.sessionInit(this._sessionId,lu({cname:i.channel,appid:i.appId},_)),this._joinInfo&&(this._joinInfo.sid=c),this._gateway.joinInfo&&(this._gateway.joinInfo.sid=c)}async _publishHighStream(n){if(!this._joinInfo||this._uid===void 0)throw new De(oe.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new De(oe.INVALID_OPERATION,"can not publish stream in ".concat(this.connectionState," state"));if(this._turnServer.mode==="auto"&&ge("FORCE_TURN")&&!ge("TURN_ENABLE_TCP")&&!ge("TURN_ENABLE_UDP"))throw new De(oe.UNEXPECTED_ERROR,"force TURN With No TURN Configuration");z.debug("[".concat(this._clientId,"] publish high stream"));try{let a=await this._p2pChannel.publish(n,this._isDualStreamEnabled,this._lowStreamParameter);if(this.store.useP2P){let c=(await a.next()).value;if(c){try{await this._gateway.sendExtensionMessage(ut.PUBLISH,c,!0)}catch(u){throw a.throw(u),u}await a.next()}this._p2pChannel.reportPublishEvent(!0,null)}else{let c=(await a.next()).value;if(c){var i;let u;try{u=await this._gateway.publish(this._uid,c,!0)}catch(_){if(_.code!==oe.DISCONNECT_P2P)throw a.throw(_),_}await a.next(((i=u)===null||i===void 0?void 0:i.ortc)||[])}this._p2pChannel.reportPublishEvent(!0,null);for(let u of n)u instanceof ni&&u._encoderConfig&&this._gateway.setVideoProfile(u._encoderConfig).catch(_=>{z.debug("[".concat(this._clientId,"] stop setVideoProfile, because websocket is closed"))}),!u.muted&&u.enabled||await this._p2pChannel.muteLocalTrack(u)}}catch(a){if(this._p2pChannel.reportPublishEvent(!1,a==null?void 0:a.code,n),(a==null?void 0:a.code)===oe.WS_ABORT)return;throw a}}async _publishLowStream(){if(!this._joinInfo||this._uid===void 0)throw new De(oe.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new De(oe.INVALID_OPERATION,"can not publish stream in ".concat(this.connectionState," state"));z.debug("[".concat(this._clientId,"] publish low stream"));let n=this._configDistribute.getLowStreamConfigDistribute();n&&n.bitrate&&(this._lowStreamParameter||(this._lowStreamParameter={width:160,height:120,framerate:15,bitrate:50}),this._lowStreamParameter&&this._lowStreamParameter.bitrate&&n.bitrate<this._lowStreamParameter.bitrate&&(this._lowStreamParameter.bitrate=n.bitrate));try{let a=await this._p2pChannel.publishLowStream(this._lowStreamParameter),c=(await a.next()).value;if(c){var i;let u;try{u=await this._gateway.publish(this._uid,c,!0)}catch(_){if(_.code!==oe.DISCONNECT_P2P)throw a.throw(_),_}a.next(((i=u)===null||i===void 0?void 0:i.ortc)||[]),this._p2pChannel.reportPublishEvent(!0,null,void 0,!0)}}catch(a){if(this._p2pChannel.reportPublishEvent(!1,a==null?void 0:a.code,void 0,!0),(a==null?void 0:a.code)===oe.WS_ABORT)return;throw a}}_createLiveStreamingClient(n){let i=()=>{if(!this._joinInfo||!this._appId)return new De(oe.INVALID_OPERATION,"can not create live streaming client, please join channel first").throw();let a=(c={joinInfo:this._joinInfo,appId:this._appId,websocketRetryConfig:this._config.websocketRetryConfig,httpRetryConfig:this._config.httpRetryConfig},ao("LiveStreaming").create(c));var c;return a.onLiveStreamError=(u,_)=>{jt.reportApiInvoke(this._sessionId,{name:bn.ON_LIVE_STREAM_ERROR,options:[u,_],tag:Li.TRACER}).onSuccess(),this.safeEmit(Xt.LIVE_STREAMING_ERROR,u,_)},a.onLiveStreamWarning=(u,_)=>{jt.reportApiInvoke(this._sessionId,{name:bn.ON_LIVE_STREAM_WARNING,options:[u,_],tag:Li.TRACER}).onSuccess(),this.safeEmit(Xt.LIVE_STREAMING_WARNING,u,_)},a.on(Fr.REQUEST_WORKER_MANAGER_LIST,(u,_,S)=>{if(!this._joinInfo)return S(new De(oe.INVALID_OPERATION,"can not find join info to get worker manager"));(async function(C,R,e,t){let r=ge("UAP_AP").slice(0,ge("AJAX_REQUEST_CONCURRENT")).map(s=>R.proxyServer?"https://".concat(R.proxyServer,"/ap/?url=").concat(s+"/api/v1?action=uap"):"https://".concat(s,"/api/v1?action=uap"));return await lD(r,C,R,e,t)})(u,this._joinInfo,this._axiosCancelSource.token,da).then(_).catch(S)}),a};return n===Ot.RAW?(this._liveRawStreamingClient=this._liveRawStreamingClient||i(),this._liveRawStreamingClient):(this._liveTranscodeStreamingClient=this._liveTranscodeStreamingClient||i(),this._liveTranscodeStreamingClient)}_createChannelMediaRelayClient(){if(!this._joinInfo)return new De(oe.INVALID_OPERATION,"can not create channel media relay client, please join channel first").throw();if(!this._channelMediaRelayClient){let{sendResolutionWidth:i,sendResolutionHeight:a}=this.getLocalVideoStats(),c=(n={joinInfo:this._joinInfo,clientId:this._clientId,websocketRetryConfig:this._config.websocketRetryConfig,httpRetryConfig:this._config.httpRetryConfig,resolution:{width:i,height:a}},ao("ChannelMediaRelay").create(n));c.on("state",u=>{u===Vi.RELAY_STATE_FAILURE&&c&&c.dispose(),this.safeEmit(Xt.CHANNEL_MEDIA_RELAY_STATE,u)}),c.on("event",u=>{this.safeEmit(Xt.CHANNEL_MEDIA_RELAY_EVENT,u)}),this._channelMediaRelayClient=c,this._statsCollector.onStatsChanged=(u,_)=>{var S;u==="resolution"&&((S=this._channelMediaRelayClient)===null||S===void 0||S.setVideoProfile(_))}}var n;return this._channelMediaRelayClient}_handleUpdateDataChannel(n,i){let{added:a,deleted:c}=n,u=[];if(i){let _=[];this._users.forEach(S=>{S._dataChannels.forEach(C=>{a.every(R=>R.uid!==S._uintid||R.stream_id!==C.id)&&_.push({uid:S._uintid,stream_id:C.id,ordered:C.ordered,max_retrans_times:C.maxRetransmits,metadata:C.metadata})})}),_.length>0&&this._handleUpdateDataChannel({added:[],deleted:_})}Array.isArray(a)&&a.length>0&&a.forEach(_=>{let{uid:S,stream_id:C,ordered:R,max_retrans_times:e,metadata:t}=_,r=this._users.find(s=>s._uintid===S);if(!r)return void z.error("[".concat(this._clientId,"] can not find target user!(on_add_data_channel)"));if(z.debug("[".concat(this._clientId,"] data_channel added with uid ").concat(S)),ft(u).call(u,r)||u.push(r),r._uintid||(r._uintid=S),r._dataChannels.findIndex(s=>s.id===_.stream_id)===-1){let s={id:C,ordered:!!R,maxRetransmits:e,metadata:t},l=function(f){return NI(f,!0)}(s);r._dataChannels.push(l),z.info("[".concat(this._clientId,"] remote user ").concat(r.uid," published datachannel")),i||this.safeEmit(Xt.USER_PUBLISHED,r,"datachannel",s)}this._p2pChannel.hasPendingRemoteDataChannel(r,_.stream_id)&&(z.debug("[".concat(this._clientId,"] resubscribe datachannel for user ").concat(r.uid," after reconnect.")),this._subscribeDataChannel(r,_.stream_id).catch(s=>{z.error("[".concat(this._clientId,"] resubscribe datachannel error"),s.toString())}))}),i&&(this.safeEmit(Xt.PUBLISHED_USER_LIST,this._pendingPublishedUsers),this._pendingPublishedUsers=[]),Array.isArray(c)&&c.length>0&&c.forEach(_=>{let{uid:S,stream_id:C}=_,R=this._users.find(t=>t._uintid===S);if(!R)return void z.error("[".concat(this._clientId,"] can not find target user!(on_delete_data_channel)"));let e=R._dataChannels.find(t=>t.id===_.stream_id);e&&(z.debug("[".concat(this._clientId,"] data_stream delete with uid ").concat(S)),this._p2pChannel.unsubscribeDataChannel(R,[e]).then(t=>{if(R._dataChannels=R._dataChannels.filter(r=>r!==e),t)return this._gateway.unsubscribeDataChannel(t,R.uid)}),z.info("[".concat(this._clientId,"] remote user ").concat(S," unpublished datachannel ,id:").concat(e.id)),this.safeEmit(Xt.USER_UNPUBLISHED,R,"datachannel",e._config))})}_handleRemoveDataChannels(n){let i=this._users.find(a=>a.uid===n.uid);if(i){if(i._dataChannels!==void 0&&i._dataChannels.length>0){z.debug("[".concat(this._clientId,"] datachannel removed with uid ").concat(n.uid));let a=()=>{z.info("[".concat(this._clientId,"] remote user ").concat(i.uid," unpublished datachannel")),i._dataChannels.forEach(c=>{this.safeEmit(Xt.USER_UNPUBLISHED,i,"datachannel",c._config)})};this._p2pChannel.unsubscribeDataChannel(i,i._dataChannels).then(c=>{if(c)return this._gateway.unsubscribeDataChannel(c,i.uid)}),a()}}else z.warning("[".concat(this._clientId,"] can not find target user!(on_remove_datachannel)"))}_handleGatewayEvents(){this._gateway.on(La.UPDATE_GATEWAY_CONFIG,()=>{(function(){let n;try{n=window.localStorage.getItem("websdk_ng_global_parameter")}catch(i){return void z.error("Error loading sdk config",i.message)}if(n)try{let i=JSON.parse(window.atob(n)),a=Date.now();Object.keys(i).forEach(c=>{let{value:u,type:_,expires:S}=i[c];S&&S<=a||_||tu()||!Object.prototype.hasOwnProperty.call(cc,c)||(hs[c]=u,ai[c]=u,z.debug("Update gateway parameters from config distribute",c,u))})}catch(i){z.error("Error update config from local cache",i.message)}})()}),this._gateway.on(La.DISCONNECT_P2P,async()=>{await this._p2pChannel.disconnectForReconnect()}),this._gateway.on(La.CONNECTION_STATE_CHANGE,(n,i,a)=>{var c;if(a===ur.FALLBACK)return;let u=()=>{this.safeEmit(Xt.CONNECTION_STATE_CHANGE,n,i,a)};if(jt.reportApiInvoke(this._sessionId||((c=this._gateway.joinInfo)===null||c===void 0?void 0:c.sid)||null,{name:bn.CONNECTION_STATE_CHANGE,options:[n,i,a],tag:Li.TRACER}).onSuccess(JSON.stringify({cur:n,prev:i,reason:a})),z.info("[".concat(this._clientId,"] signal connection state change: ").concat(i," -> ").concat(n)),n==="DISCONNECTED")return this._reset(),void u();if(n==="RECONNECTING")this._users.forEach(S=>{S._trust_in_room_=!1,S._trust_audio_enabled_state_=!1,S._trust_video_enabled_state_=!1,S._trust_audio_mute_state_=!1,S._trust_video_mute_state_=!1,S._trust_audio_stream_added_state_=!1,S._trust_video_stream_added_state_=!1,S._is_pre_created||(S._audio_pre_subscribed||(S._audioSSRC=void 0,S._audioOrtc=void 0),S._video_pre_subscribed||(S._videoSSRC=void 0,S._videoOrtc=void 0,S._rtxSsrcId=void 0),S._cname=void 0)}),this._userOfflineTimeout&&window.clearTimeout(this._userOfflineTimeout),this._streamRemovedTimeout&&window.clearTimeout(this._streamRemovedTimeout),this._userOfflineTimeout=void 0,this._streamRemovedTimeout=void 0;else if(n==="CONNECTED"){var _;this._streamFallbackTypeCacheMap.forEach((S,C)=>{this._gateway.setStreamFallbackOption(C,S).catch(R=>{z.warning("[".concat(this._clientId,"] auto set stream fallback option failed"),R)})}),this._remoteStreamTypeCacheMap.forEach((S,C)=>{this._gateway.setRemoteVideoStreamType(C,S).catch(R=>{z.warning("[".concat(this._clientId,"] auto set remote stream type failed"),R)})}),this._remoteDefaultVideoStreamType!==void 0&&((_=this._joinInfo)===null||_===void 0?void 0:_.defaultVideoStream)===void 0&&this.setRemoteDefaultVideoStreamType(this._remoteDefaultVideoStreamType).then(()=>{z.debug("[".concat(this._clientId,"] setRemoteDefaultVideoStreamType after gateway connected"))}).catch(S=>{z.error("[".concat(this._clientId,"] setRemoteDefaultVideoStreamType after gateway failed, ").concat(S))}),this.store.useP2P||(this._p2pChannel.republish(),this._userOfflineTimeout=window.setTimeout(()=>{this.connectionState==="CONNECTED"&&(this._userOfflineTimeout=void 0,this._users.filter(S=>!S._trust_in_room_).forEach(S=>{z.debug("[".concat(this._clientId,"] user offline timeout, emit user offline ").concat(S.uid)),this._handleUserOffline({uid:S.uid})}))},3e3),this._streamRemovedTimeout=window.setTimeout(()=>{this.connectionState==="CONNECTED"&&(this._streamRemovedTimeout=void 0,this._users.forEach(S=>{S._trust_audio_mute_state_||(z.debug("[".concat(this._clientId,"] auto dispatch audio unmute event ").concat(S.uid)),this._handleMuteStream(S.uid,Tt.AUDIO,!1)),S._trust_video_mute_state_||(z.debug("[".concat(this._clientId,"] auto dispatch video unmute event ").concat(S.uid)),this._handleMuteStream(S.uid,Tt.VIDEO,!1)),S._trust_audio_enabled_state_||(z.debug("[".concat(this._clientId,"] auto dispatch enable local audio ").concat(S.uid)),this._handleSetStreamLocalEnable("audio",S.uid,!0)),S._trust_video_enabled_state_||(z.debug("[".concat(this._clientId,"] auto dispatch enable local video ").concat(S.uid)),this._handleSetStreamLocalEnable("video",S.uid,!0)),S._trust_video_stream_added_state_||(z.debug("[".concat(this._clientId,"] auto dispatch reset video stream added ").concat(S.uid)),this._handleResetAddStream(S,"video")),S._trust_audio_stream_added_state_||(z.debug("[".concat(this._clientId,"] auto dispatch reset audio stream added ").concat(S.uid)),this._handleResetAddStream(S,"audio")),S._video_added_||S._audio_added_||(z.debug("[".concat(this._clientId,"] auto dispatch stream remove ").concat(S.uid)),this._handleRemoveStream({uid:S.uid,uint_id:S._uintid}))}))},1e3))}u()}),this._gateway.on(La.REQUEST_NEW_GATEWAY_LIST,async(n,i)=>{if(!this._joinInfo)return i(new De(oe.UNEXPECTED_ERROR,"can not recover, no join info"));try{let a,c=await X_(lu(lu({},this._joinInfo),{},{uid:this._joinInfo.uid,stringUid:void 0}));c?(a=c.ap,TD(c),this._joinInfo.preload=!0):(a=await lf(this._joinInfo,this._axiosCancelSource.token,this._config.httpRetryConfig||da,this.store),this._joinInfo.preload=!1),this._joinInfo&&(this._joinInfo.apResponse=a.gatewayInfo.res,this._joinInfo.gatewayAddrs=a.gatewayInfo.gatewayAddrs,this._joinInfo.uni_lbs_ip=a.gatewayInfo.uni_lbs_ip);let u=[];a.gatewayInfo.gatewayAddrs.forEach(_=>{let{address:S}=_,[C,R]=S.split(":");this._joinInfo&&this._joinInfo.proxyServer?u.push({proxy:this._joinInfo.proxyServer,host:C,port:R}):u.push({host:C,port:R})}),n(u)}catch(a){i(a)}}),this._gateway.on(La.NETWORK_QUALITY,n=>{this._networkQualitySensitivity==="normal"&&this.safeEmit(Xt.NETWORK_QUALITY,n)}),this._gateway.on(La.STREAM_TYPE_CHANGE,(n,i)=>{this.safeEmit(Xt.STREAM_TYPE_CHANGED,n,i),jt.reportApiInvoke(this._sessionId,{name:bn.STREAM_TYPE_CHANGE,options:[n,i],tag:Li.TRACER}).onSuccess(JSON.stringify({uid:n,streamType:i}))}),this._gateway.on(La.IS_P2P_DISCONNECTED,n=>{this._p2pChannel.isP2PDisconnected()?n(!0):this._p2pChannel.hasLocalMedia()||this._p2pChannel.hasRemoteMedia()?n(!1):n(!0)}),this._gateway.on(La.REQUEST_P2P_CONNECTION_PARAMS,async(n,i,a)=>{try{let c=await this._p2pChannel.getEstablishParams();ge("ENABLE_PREALLOC_PC")&&c||(c=await this._p2pChannel.startP2PConnection(n)),i(c)}catch(c){a(c)}}),this._gateway.on(La.JOIN_RESPONSE,(n,i)=>{if(this.store.useP2P)return;let a;n.attributes?a=n.attributes.userAttributes.preSubSsrcs:z.debug("no attributes in joinResponse");let c=d1(n.ortc,i,a);this._p2pChannel.connect(c)}),this._gateway.on(La.PRE_CONNECT_PC,async n=>{let{candidates:i,fingerprint:a}=n;if(this._joinInfo&&i.length>0&&!this._p2pChannel.isPlanB){var c;await this._p2pChannel.startP2PConnection({turnServer:this._joinInfo.turnServer});let{cert:u,cid:_}=this._joinInfo.apResponse;await this._p2pChannel.connect({iceParameters:{iceUfrag:"".concat(_,"_").concat(u),icePwd:"".concat(_,"_").concat(u)},dtlsParameters:{fingerprints:[{hashFunction:"sha-256",fingerprint:(c=ge("FINGERPRINT"))!==null&&c!==void 0?c:a}]},candidates:i,rtpCapabilities:{send:{audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]},recv:{audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]}},setup:"active",cname:"o/i14u9pJrxRKAsu",preallocation:!0})}})}_handleGatewaySignalEvents(){this._gateway.signal.on(kn.ON_USER_ONLINE,this._handleUserOnline),this._gateway.signal.on(kn.ON_USER_OFFLINE,this._handleUserOffline),this._gateway.signal.on(kn.ON_ADD_AUDIO_STREAM,n=>this._handleAddAudioOrVideoStream("audio",n.uid,n.ssrcId,n.cname,n.uint_id,n.ortc)),this._gateway.signal.on(kn.ON_ADD_VIDEO_STREAM,n=>this._handleAddAudioOrVideoStream("video",n.uid,n.ssrcId,n.cname,n.uint_id,n.ortc,n.rtxSsrcId)),this._gateway.signal.on(kn.ON_REMOTE_DATASTREAM_UPDATE,n=>{this._handleUpdateDataChannel(n)}),this._gateway.signal.on(kn.ON_REMOTE_FULL_DATASTREAM_INFO,n=>{this._handleUpdateDataChannel({added:n.datastreams||[],deleted:[]},!0)}),this._gateway.signal.on(kn.ON_REMOVE_STREAM,this._handleRemoveStream),this._gateway.signal.on(kn.ON_P2P_LOST,this._handleP2PLost),this._gateway.signal.on(kn.MUTE_AUDIO,n=>this._handleMuteStream(n.uid,Tt.AUDIO,!0)),this._gateway.signal.on(kn.UNMUTE_AUDIO,n=>this._handleMuteStream(n.uid,Tt.AUDIO,!1)),this._gateway.signal.on(kn.MUTE_VIDEO,n=>this._handleMuteStream(n.uid,Tt.VIDEO,!0)),this._gateway.signal.on(kn.UNMUTE_VIDEO,n=>this._handleMuteStream(n.uid,Tt.VIDEO,!1)),this._gateway.signal.on(kn.RECEIVE_METADATA,n=>{let i=fr(n.metadata);this.safeEmit(Xt.RECEIVE_METADATA,n.uid,i)}),this._gateway.signal.on(kn.ON_DATA_STREAM,async n=>{var i;if(!n)return;let a=fr(n.payload);if(this._encryptDataStream&&this._encryptDataStreamIv&&this._encryptDataStreamKey&&window.crypto.subtle&&ft(i=["aes-128-gcm2","aes-256-gcm2"]).call(i,this._encryptionMode)){if(n.payload.length<k_)throw new De(oe.UNEXPECTED_RESPONSE,"payload length ".concat(n.payload.length," is less than header length ").concat(k_));a=await async function(u,_,S){let C=S.subarray(0,k_),R=C.slice(8,k_),e=(R[0]<<8)+R[1],t=(C[6]<<8)+C[7],r=await window.crypto.subtle.decrypt({name:"AES-GCM",iv:u,tagLength:ps,additionalData:new Uint8Array(mh(e,2))},_,S.subarray(k_));return new Uint8Array(r).subarray(0,t)}(this._encryptDataStreamIv,this._encryptDataStreamKey,a)}let c=0;if(n.ordered||n.syncWithAudio){let u=this._p2pChannel.getStats(),_=this.remoteUsers.find(C=>C.uid===n.uid),S=u==null?void 0:u.audioRecv.find(C=>C.ssrc===(_==null?void 0:_._audioSSRC));c=S==null?void 0:S.jitterBufferMs}(c==null||Number.isNaN(c))&&(c=0),Io(lu(lu({},n),{},{payload:a}),c,{id:this._clientId,onStreamMessage:typeof this.onStreamMessage=="function"?this.onStreamMessage.bind(this):void 0,safeEmit:this.safeEmit.bind(this)})}),this._gateway.signal.on(kn.ON_CRYPT_ERROR,()=>{la(()=>{z.warning("[".concat(this._clientId,"] on crypt error")),this.safeEmit(Xt.CRYPT_ERROR)},this._sessionId)}),this._gateway.signal.on(kn.ON_TOKEN_PRIVILEGE_WILL_EXPIRE,this._handleTokenWillExpire),this._gateway.signal.on(kn.ON_TOKEN_PRIVILEGE_DID_EXPIRE,()=>{z.warning("[".concat(this._clientId,"] received message onTokenPrivilegeDidExpire, please get new token and join again")),this._gateway.leave(!0,ur.TOKEN_EXPIRE),this.safeEmit(Xt.ON_TOKEN_PRIVILEGE_DID_EXPIRE),this._reset()}),this._gateway.signal.on(kn.ON_STREAM_FALLBACK_UPDATE,n=>{z.debug("[".concat(this._clientId,"] stream fallback peerId: ").concat(n.stream_id,", attr: ").concat(n.stream_type)),this.safeEmit(Xt.STREAM_FALLBACK,n.stream_id,n.stream_type===1?"fallback":"recover")}),this._gateway.signal.on(kn.ON_PUBLISH_STREAM,n=>{this.uid===this._uid&&(this._p2pChannel.reportPublishEvent(!0,null,void 0,!1,JSON.stringify({proxy:n.proxy})),z.info("[".concat(this._clientId,"] on publish stream, ").concat(JSON.stringify(n))))}),this._gateway.signal.on(kn.ENABLE_LOCAL_VIDEO,n=>{this._handleSetStreamLocalEnable("video",n.uid,!0)}),this._gateway.signal.on(kn.DISABLE_LOCAL_VIDEO,n=>{this._handleSetStreamLocalEnable("video",n.uid,!1)}),this._gateway.signal.on(dn.REQUEST_TIMEOUT,(n,i)=>{if(this._joinInfo)switch(n){case ln.PUBLISH:{if(!i)return;let u=i.ortc;if(u){var a,c;let _=u.some(R=>{let{stream_type:e}=R;return e===lr.Audio}),S=u.some(R=>{let{stream_type:e}=R;return e!==lr.Audio}),C=u.some(R=>{let{stream_type:e}=R;return e===lr.Screen||e===lr.ScreenLow});i.state==="offer"&&jt.publish(this._joinInfo.sid,{eventElapse:Cs.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:!1,ec:oe.TIMEOUT,audio:_,video:S,p2pid:i.p2p_id,publishRequestid:this.store.pubId,screenshare:C,audioName:_?(a=u.find(R=>{let{stream_type:e}=R;return e===lr.Audio}))===null||a===void 0||(a=a.ssrcs[0])===null||a===void 0?void 0:a.ssrcId.toString():void 0,videoName:S?(c=u.find(R=>{let{stream_type:e}=R;return e!==lr.Audio}))===null||c===void 0||(c=c.ssrcs[0])===null||c===void 0?void 0:c.ssrcId.toString():void 0})}break}case ln.SUBSCRIBE:i&&jt.subscribe(this._joinInfo.sid,{succ:!1,ec:oe.TIMEOUT,audio:i.stream_type===Tt.AUDIO,video:i.stream_type===Tt.VIDEO,peerid:i.stream_id,subscribeRequestid:i.ssrcId,p2pid:this.store.p2pId,eventElapse:Cs.measureFromSubscribeStart(this.store.clientId,i.ssrcId),preSsrc:this._p2pChannel.isPreSubScribe(i.ssrcId)})}}),this._gateway.signal.on(kn.ON_P2P_OK,n=>{this.uid,this._uid}),this._gateway.signal.on(kn.ON_PUBLISHED_USER_LIST,n=>{if(n==null||!n.users)return;ge("BLOCK_LOCAL_CLIENT")&&(n.users=n.users.filter(c=>!eu(c.string_id||c.stream_id,this.channelName)));let i=[],a=[];for(let c of n.users){let u=this._users.find(t=>t._uintid===c.stream_id);u?u._trust_in_room_=!0:(u=new Hg(c.string_id||c.stream_id,c.stream_id),this._users.push(u),this.getListeners(Xt.PUBLISHED_USER_LIST).length===0&&(z.debug("[".concat(this._clientId,"] user online"),c.stream_id),this.safeEmit(Xt.USER_JOINED,u)));let _=Wa.Audio&c.stream_type,S=(Wa.Video|Wa.LwoVideo)&c.stream_type,C=(65280&c.stream_type)!=0,R=_&&u.hasAudio,e=S&&u.hasVideo;S&&(u._trust_video_stream_added_state_=!0,u._video_added_=!0,u._videoSSRC=c.video_ssrc,u._rtxSsrcId=c.video_rtx),_&&(u._trust_audio_stream_added_state_=!0,u._audio_added_=!0,u._audioSSRC=c.audio_ssrc),_&&!R&&this.getListeners(Xt.PUBLISHED_USER_LIST).length===0&&(z.info("[".concat(this._clientId,"] remote user ").concat(u.uid," published audio")),this.safeEmit(Xt.USER_PUBLISHED,u,"audio")),S&&!e&&this.getListeners(Xt.PUBLISHED_USER_LIST).length===0&&(z.info("[".concat(this._clientId,"] remote user ").concat(u.uid," published video")),this.safeEmit(Xt.USER_PUBLISHED,u,"video")),(_&&!R||S&&!e||C)&&i.push(u),S&&this._p2pChannel.hasPendingRemoteMedia(u,"video")&&a.push({user:u,mediaType:"video"}),_&&this._p2pChannel.hasPendingRemoteMedia(u,"audio")&&a.push({user:u,mediaType:"audio"})}a.length>0&&(z.debug("[".concat(this._clientId,"] RE massSubscribe after reconnect ").concat(a.map(c=>"user: ".concat(c.user.uid,", mediaType: ").concat(c.mediaType)).join("; ")," ")),this.massSubscribe(a).catch(c=>{z.error("[".concat(this._clientId,"] mass resubscribe error"),c.toString())})),this.getListeners(Xt.PUBLISHED_USER_LIST).length>0?ge("ENABLE_DATASTREAM_2")?this._pendingPublishedUsers=i:(z.info("[".concat(this._clientId,"] client emit user-list event, users: ").concat(i.map(c=>c.uid).join(", "))),this.safeEmit(Xt.PUBLISHED_USER_LIST,i)):z.info("[".concat(this._clientId,"] client not emit user-list event case there is no user-list listener, users: ").concat(i.map(c=>c.uid).join(", ")))}),this._gateway.signal.on(kn.ON_RTP_CAPABILITY_CHANGE,n=>{let{video_codec:i}=n;this._p2pChannel instanceof uf&&this._p2pChannel.updateRemoteRTPCapabilities(i.map(a=>a.toLowerCase()).filter(a=>{var c;return ft(c=Object.keys(Gp)).call(c,a)}))})}_handleP2PEvents(){this._gateway.signal.on(kn.ON_USER_OFFLINE,()=>{this._p2pChannel.disconnectForReconnect()}),this._gateway.signal.on(ut.PUBLISH,(n,i,a)=>{let{uid:c}=n;n.forEach(u=>{let{kind:_,ssrcs:S,mid:C,isMuted:R}=u;this._handleP2PAddAudioOrVideoStream(_,c,S[0].ssrcId,C);let e=this._users.find(t=>t.uid===c);return e&&this.store.useP2P?this._p2pChannel.mockSubscribe(e,_,S[0].ssrcId,C).then(()=>{i()}).catch(a):i(),this._handleMuteStream(c,_,!!R)})}),this._gateway.signal.on(ut.CALL,async(n,i,a)=>{if(this.store.useP2P)try{var c;i(await this._p2pChannel.startP2P({turnServer:(c=this._joinInfo)===null||c===void 0?void 0:c.turnServer},n))}catch(u){a(u)}}),this._gateway.signal.on(dn.P2P_CONNECTION,async n=>{this.store.useP2P&&(await this._p2pChannel).p2pConnect(n)}),this._gateway.signal.on(ut.UNPUBLISH,async(n,i,a)=>{if(this.store.useP2P){let{unpubMsg:c,uid:u}=n,_=this._users.find(S=>S.uid===u);if(!_)return z.warning("[".concat(this._clientId,"] can not find remote user, ignore mute event, uid: ").concat(u)),void i();try{c.forEach(async S=>{let{stream_type:C}=S,R=C===lr.Audio?Tt.AUDIO:Tt.VIDEO;await this._p2pChannel.unsubscribe(_,R),this._handleMuteStream(u,R,!0)}),i()}catch(S){a(S)}}}),this._gateway.signal.on(ut.CONTROL,async(n,i)=>{let{action:a}=n;switch(a){case zc.MUTE_LOCAL_VIDEO:this._handleMuteStream(i,Tt.VIDEO,!0);break;case zc.MUTE_LOCAL_AUDIO:this._handleMuteStream(i,Tt.AUDIO,!0);break;case zc.UNMUTE_LOCAL_VIDEO:this._handleP2PAddAudioOrVideoStream("video",i),this._handleMuteStream(i,Tt.VIDEO,!1);break;case zc.UNMUTE_LOCAL_AUDIO:this._handleP2PAddAudioOrVideoStream("audio",i),this._handleMuteStream(i,Tt.AUDIO,!1)}}),this._gateway.signal.on(ut.RESTART_ICE,async(n,i,a)=>{if(this.store.useP2P)try{let{direction:c,iceParameter:u}=n;c!==Ho.SEND_ONLY||u?i(await this._p2pChannel.restartICE(c,u)):(this._p2pChannel.handleDisconnect(c),i())}catch(c){a(c)}}),this._gateway.signal.on(ut.CANDIDATE,n=>{if(this.store.useP2P){let{candidate:i,direction:a}=n;this._p2pChannel.addRemoteCandidate(i,a)}}),this._p2pChannel.on(Mt.RequestP2PRestartICE,async(n,i,a)=>{try{let{direction:c}=n;i(await this._gateway.sendExtensionMessage(ut.RESTART_ICE,n,c===Ho.SEND_ONLY))}catch(c){a(c)}}),this._p2pChannel.on(Mt.LocalCandidate,n=>{this._gateway.sendExtensionMessage(ut.CANDIDATE,JSON.stringify(n),!0)}),this._p2pChannel.on(Mt.RequestP2PMuteLocal,async(n,i,a)=>{try{await this._gateway.sendExtensionMessage(ut.CONTROL,n,!0),i()}catch(c){a(c)}}),this._p2pChannel.on(Mt.RequestP2PUnmuteRemote,async(n,i,a)=>{if(this._joinInfo)try{await this._gateway.unmuteRemote(n,this._joinInfo.stringUid||this._joinInfo.uid),i()}catch(c){c.code===oe.DISCONNECT_P2P?i():a(c)}else i()}),this._p2pChannel.on(Mt.RequestP2PMuteRemote,async(n,i,a)=>{if(this._joinInfo)try{await this._gateway.muteRemote(n,this._joinInfo.stringUid||this._joinInfo.uid),i()}catch(c){c.code===oe.DISCONNECT_P2P?i():a(c)}else i()}),this._p2pChannel.on(Mt.StateChange,(n,i)=>{i===or.Connected&&this._p2pChannel.republish()})}_handleP2PChannelEvents(){this._p2pChannel.on(Mt.PeerConnectionStateChange,n=>{let i=this._peerConnectionState;n!==i&&(this.safeEmit(Xt.PEERCONNECTION_STATE_CHANGE,n,i),this._peerConnectionState=n)}),this._p2pChannel.on(Mt.RequestMuteLocal,async(n,i,a)=>{if(this._joinInfo)try{await this._gateway.muteLocal(n,this._joinInfo.stringUid||this._joinInfo.uid),i()}catch(c){c.code===oe.DISCONNECT_P2P?i():a(c)}else i()}),this._p2pChannel.on(Mt.RequestUnmuteLocal,async(n,i,a)=>{if(this._joinInfo)try{await this._gateway.unmuteLocal(n,this._joinInfo.stringUid||this._joinInfo.uid),i()}catch(c){c.code===oe.DISCONNECT_P2P?i():a(c)}else i()}),this._p2pChannel.on(Mt.RequestRePublish,(n,i,a)=>{this.publish(n,!1).then(i).catch(a)}),this._p2pChannel.on(Mt.RequestRePublishDataChannel,(n,i,a)=>{Et.all(n.map(async c=>{let u=await this._p2pChannel.publishDataChannel([c]);try{u.forEach(_=>{this._uid&&this._gateway.publishDataChannel(this._uid,_,!0)})}catch(_){if(_.code!==oe.DISCONNECT_P2P)throw _}})).then(i).catch(a)}),this._p2pChannel.on(Mt.RequestReSubscribe,async(n,i,a)=>{try{for(let{user:c,kind:u}of n)u===Tt.VIDEO?await this.subscribe(c,"video"):await this.subscribe(c,"audio");i()}catch(c){a(c)}}),this._p2pChannel.on(Mt.RequestUpload,(n,i)=>{this._gateway.upload(n,i)}),this._p2pChannel.on(Mt.RequestUploadStats,n=>{this._gateway.uploadWRTCStats(n)}),this._p2pChannel.on(Mt.MediaReconnectStart,n=>{this.safeEmit(Xt.MEDIA_RECONNECT_START,n)}),this._p2pChannel.on(Mt.MediaReconnectEnd,n=>{this.safeEmit(Xt.MEDIA_RECONNECT_END,n)}),this._p2pChannel.on(Mt.NeedSignalRTT,n=>{n(this._gateway.getSignalRTT())}),this._p2pChannel.on(Mt.RequestRestartICE,async n=>{if(this.store.useP2P)return;let i=await this._p2pChannel.restartICE(n),a=await i.next();if(a.done)return;let c=a.value,u;try{u=await this._gateway.restartICE({iceParameters:c})}catch(S){return void i.throw(S)}let{iceParameters:_}=function(S){let C=S.iceParameters;return{iceParameters:{iceUfrag:C.iceUfrag,icePwd:C.icePwd}}}(u);await i.next({remoteIceParameters:_})}),this._p2pChannel.on(Mt.RequestReconnect,async()=>{this._gateway.reconnect()}),this._p2pChannel.on(Mt.RequestReconnectPC,async()=>{var n;let{iceParameters:i,dtlsParameters:a,rtpCapabilities:c}=await this._p2pChannel.startP2PConnection({turnServer:(n=this._joinInfo)===null||n===void 0?void 0:n.turnServer}),{gatewayEstablishParams:u,gatewayAddress:_}=await this._gateway.reconnectPC({iceParameters:i,dtlsParameters:a,rtpCapabilities:c}),S=d1(u,_);await this._p2pChannel.connect(S),await this._p2pChannel.republish(),await this._p2pChannel.reSubscribe()}),this._p2pChannel.on(Mt.RequestUnpublishForReconnectPC,async(n,i,a)=>{this._joinInfo&&this._uid!==void 0?(await this._gateway.unpublish(n,this._uid),i()):a()}),this._p2pChannel.on(Mt.P2PLost,()=>{this.safeEmit(Xt.P2P_LOST,this.store.uid)}),this._p2pChannel.on(Mt.UpdateVideoEncoder,n=>{n._encoderConfig&&this._gateway.setVideoProfile(n._encoderConfig)}),this._p2pChannel.on(Mt.ConnectionTypeChange,n=>{this.safeEmit(Xt.IS_USING_CLOUD_PROXY,n)}),this._p2pChannel.on(Mt.RequestLowStreamParameter,n=>{n(this._lowStreamParameter||{width:160,height:120,framerate:15,bitrate:50})}),this._p2pChannel.on(Mt.QueryClientConnectionState,n=>{n(this.connectionState)}),this._p2pChannel.on(Mt.AudioMetadata,n=>{this.safeEmit(Xt.AUDIO_METADATA,n)})}getKeyMetrics(){return this.store.keyMetrics}async enableContentInspect(n){if(!this._joinInfo||this.connectionState!=="CONNECTED")throw new De(oe.INVALID_OPERATION,"[".concat(this._clientId,"] can not create content inspect, please join channel first"));if(this._inspect)throw new De(oe.INVALID_OPERATION,"[".concat(this._clientId,"] Inspect content service already in connecting/connected state"));try{let a=(i={config:n},ao("ContentInspect").create(i));this._inspect=a,this.handleVideoInspectEvents(a);let{appId:c,cname:u,sid:_,token:S,uid:C,cid:R,vid:e}=this._joinInfo;await a.init({appId:c,areaCode:"",cname:u,sid:_,token:S,uid:C,cid:R,vid:e?Number(e):0},da)}catch(a){throw Array.isArray(a)?a[0]:a}var i}handleVideoInspectEvents(n){n.on(Ir.CONNECTION_STATE_CHANGE,(i,a)=>{if(this.safeEmit(Xt.CONTENT_INSPECT_CONNECTION_STATE_CHANGE,i,a),a===An.CONNECTED){if(this.connectionState!=="CONNECTED")return void this.safeEmit(Xt.CONTENT_INSPECT_ERROR,new De(oe.OPERATION_ABORTED,"Content inspect was cancelled because it left the channel"));n.inspectImage()}}),n.on(Ir.INSPECT_RESULT,(i,a)=>{var c;if((a==null?void 0:a.code)===oe.INVALID_OPERATION&&this.connectionState==="DISCONNECTED")return z.debug("Stop inspect content because that has left channel"),this==null||(c=this._inspect)===null||c===void 0||c.close(),void(this._inspect=void 0);this.safeEmit(Xt.CONTENT_INSPECT_RESULT,i,a)}),n.on(Ir.CLIENT_LOCAL_VIDEO_TRACK,i=>{i(this.localTracks.filter(a=>a.trackMediaType==="video")[0])})}async disableContentInspect(){if(!this._inspect)throw new De(oe.INVALID_OPERATION,"[".concat(this._clientId,"] inspectVideoContent not started"));try{this._inspect.close(),this._inspect=void 0}catch(n){throw Array.isArray(n)?n[0]:n}}async setImageModeration(n,i){if(Vp(n,"enabled"),n){if(!i)throw new De(oe.INVALID_PARAMS,"config is required");if(c6(i),!this._joinInfo)throw new De(oe.INVALID_OPERATION,"can not create image moderation, please join channel first");try{if(this._moderation)this._moderation.updateConfig(i);else{let c=(a={config:i},ao("ImageModeration").create(a));this._moderation=c,this.handleImageModerationEvents(c);let{appId:u,cname:_,sid:S,token:C,uid:R,cid:e,vid:t}=this._joinInfo;await c.init({appId:u,areaCode:"",cname:_,sid:S,token:C,uid:R,cid:e,vid:t?Number(t):0},da)}}catch(c){throw Array.isArray(c)?c[0]:c}}else{var a;if(!this._moderation)throw new De(oe.INVALID_OPERATION,"[".concat(this._clientId,"] image moderation not started"));try{this._moderation.close(),this._moderation.removeAllListeners(),this._moderation=void 0}catch(c){throw Array.isArray(c)?c[0]:c}}}handleImageModerationEvents(n){n.on(af.CONNECTION_STATE_CHANGE,(i,a)=>{if(this.safeEmit(Xt.IMAGE_MODERATION_CONNECTION_STATE_CHANGE,i,a),i===od.CONNECTED){if(this.connectionState!=="CONNECTED")throw this.setImageModeration(!1),new De(oe.OPERATION_ABORTED,"Image moderation was cancelled because it left the channel");n.inspectImage()}}),n.on(af.CLIENT_LOCAL_VIDEO_TRACK,i=>{i(this.localTracks.filter(a=>a.trackMediaType==="video")[0])})}setP2PTransport(n){if(function(i){Ia(i,"transport",["default","auto","relay","sd-rtn"])}(n),this.mode!=="p2p")throw new De(oe.INVALID_OPERATION,"only p2p mode can set p2pTransport");this.store.p2pTransport=n,z.info("[".concat(this._clientId,"] set client p2pTransport to ").concat(n))}getJoinChannelServiceRecords(){return z.debug("getJoinChannelServiceRecords"),this.store.joinChannelServiceRecords}async setPublishAudioFilterEnabled(n){Vp(n,"enabled"),Sr("ENABLE_PUBLISH_AUDIO_FILTER",n),this._joinInfo&&await this._gateway.setPublishAudioFilterEnabled(n)}_handleResetAddStream(n,i){switch(i){case"audio":n._audio_added_=!1,n._trust_audio_stream_added_state_=!0;break;case"video":n._video_added_=!1,n._trust_video_stream_added_state_=!0}}},Ut(wt.prototype,"leave",[mF],Object.getOwnPropertyDescriptor(wt.prototype,"leave"),wt.prototype),Ut(wt.prototype,"publish",[gF],Object.getOwnPropertyDescriptor(wt.prototype,"publish"),wt.prototype),Ut(wt.prototype,"unpublish",[l6],Object.getOwnPropertyDescriptor(wt.prototype,"unpublish"),wt.prototype),Ut(wt.prototype,"subscribe",[N1],Object.getOwnPropertyDescriptor(wt.prototype,"subscribe"),wt.prototype),Ut(wt.prototype,"presubscribe",[d6],Object.getOwnPropertyDescriptor(wt.prototype,"presubscribe"),wt.prototype),Ut(wt.prototype,"massSubscribe",[u6],Object.getOwnPropertyDescriptor(wt.prototype,"massSubscribe"),wt.prototype),Ut(wt.prototype,"unsubscribe",[ID],Object.getOwnPropertyDescriptor(wt.prototype,"unsubscribe"),wt.prototype),Ut(wt.prototype,"massUnsubscribe",[f6],Object.getOwnPropertyDescriptor(wt.prototype,"massUnsubscribe"),wt.prototype),Ut(wt.prototype,"setLowStreamParameter",[_F],Object.getOwnPropertyDescriptor(wt.prototype,"setLowStreamParameter"),wt.prototype),Ut(wt.prototype,"enableDualStream",[h6],Object.getOwnPropertyDescriptor(wt.prototype,"enableDualStream"),wt.prototype),Ut(wt.prototype,"disableDualStream",[p6],Object.getOwnPropertyDescriptor(wt.prototype,"disableDualStream"),wt.prototype),Ut(wt.prototype,"setClientRole",[m6],Object.getOwnPropertyDescriptor(wt.prototype,"setClientRole"),wt.prototype),Ut(wt.prototype,"_setClientRoleOptions",[g6],Object.getOwnPropertyDescriptor(wt.prototype,"_setClientRoleOptions"),wt.prototype),Ut(wt.prototype,"setProxyServer",[_6],Object.getOwnPropertyDescriptor(wt.prototype,"setProxyServer"),wt.prototype),Ut(wt.prototype,"setTurnServer",[E6],Object.getOwnPropertyDescriptor(wt.prototype,"setTurnServer"),wt.prototype),Ut(wt.prototype,"setLicense",[v6],Object.getOwnPropertyDescriptor(wt.prototype,"setLicense"),wt.prototype),Ut(wt.prototype,"startProxyServer",[S6],Object.getOwnPropertyDescriptor(wt.prototype,"startProxyServer"),wt.prototype),Ut(wt.prototype,"stopProxyServer",[y6],Object.getOwnPropertyDescriptor(wt.prototype,"stopProxyServer"),wt.prototype),Ut(wt.prototype,"setLocalAccessPointsV2",[T6],Object.getOwnPropertyDescriptor(wt.prototype,"setLocalAccessPointsV2"),wt.prototype),Ut(wt.prototype,"setLocalAccessPoints",[b6],Object.getOwnPropertyDescriptor(wt.prototype,"setLocalAccessPoints"),wt.prototype),Ut(wt.prototype,"setRemoteDefaultVideoStreamType",[C6],Object.getOwnPropertyDescriptor(wt.prototype,"setRemoteDefaultVideoStreamType"),wt.prototype),Ut(wt.prototype,"setRemoteVideoStreamType",[w6],Object.getOwnPropertyDescriptor(wt.prototype,"setRemoteVideoStreamType"),wt.prototype),Ut(wt.prototype,"setStreamFallbackOption",[R6],Object.getOwnPropertyDescriptor(wt.prototype,"setStreamFallbackOption"),wt.prototype),Ut(wt.prototype,"setEncryptionConfig",[I6],Object.getOwnPropertyDescriptor(wt.prototype,"setEncryptionConfig"),wt.prototype),Ut(wt.prototype,"renewToken",[A6],Object.getOwnPropertyDescriptor(wt.prototype,"renewToken"),wt.prototype),Ut(wt.prototype,"enableAudioVolumeIndicator",[O6],Object.getOwnPropertyDescriptor(wt.prototype,"enableAudioVolumeIndicator"),wt.prototype),Ut(wt.prototype,"startLiveStreaming",[N6],Object.getOwnPropertyDescriptor(wt.prototype,"startLiveStreaming"),wt.prototype),Ut(wt.prototype,"setLiveTranscoding",[L6],Object.getOwnPropertyDescriptor(wt.prototype,"setLiveTranscoding"),wt.prototype),Ut(wt.prototype,"stopLiveStreaming",[D6],Object.getOwnPropertyDescriptor(wt.prototype,"stopLiveStreaming"),wt.prototype),Ut(wt.prototype,"startChannelMediaRelay",[P6],Object.getOwnPropertyDescriptor(wt.prototype,"startChannelMediaRelay"),wt.prototype),Ut(wt.prototype,"updateChannelMediaRelay",[M6],Object.getOwnPropertyDescriptor(wt.prototype,"updateChannelMediaRelay"),wt.prototype),Ut(wt.prototype,"stopChannelMediaRelay",[k6],Object.getOwnPropertyDescriptor(wt.prototype,"stopChannelMediaRelay"),wt.prototype),Ut(wt.prototype,"sendCustomReportMessage",[x6],Object.getOwnPropertyDescriptor(wt.prototype,"sendCustomReportMessage"),wt.prototype),Ut(wt.prototype,"pickSVCLayer",[U6],Object.getOwnPropertyDescriptor(wt.prototype,"pickSVCLayer"),wt.prototype),Ut(wt.prototype,"setRTMConfig",[j6],Object.getOwnPropertyDescriptor(wt.prototype,"setRTMConfig"),wt.prototype),Ut(wt.prototype,"enableContentInspect",[V6],Object.getOwnPropertyDescriptor(wt.prototype,"enableContentInspect"),wt.prototype),Ut(wt.prototype,"disableContentInspect",[B6],Object.getOwnPropertyDescriptor(wt.prototype,"disableContentInspect"),wt.prototype),Ut(wt.prototype,"setImageModeration",[F6],Object.getOwnPropertyDescriptor(wt.prototype,"setImageModeration"),wt.prototype),Ut(wt.prototype,"setP2PTransport",[G6],Object.getOwnPropertyDescriptor(wt.prototype,"setP2PTransport"),wt.prototype),Ut(wt.prototype,"getJoinChannelServiceRecords",[z6],Object.getOwnPropertyDescriptor(wt.prototype,"getJoinChannelServiceRecords"),wt.prototype),Ut(wt.prototype,"setPublishAudioFilterEnabled",[H6],Object.getOwnPropertyDescriptor(wt.prototype,"setPublishAudioFilterEnabled"),wt.prototype),wt);class L1{constructor(i,a){re(this,"id",0),re(this,"element",void 0),re(this,"peerPair",void 0),re(this,"context",void 0),re(this,"audioPlayerElement",void 0),re(this,"audioTrack",void 0),L1.count+=1,this.id=L1.count,this.element=i,this.context=a}initPeers(){this.peerPair=[new RTCPeerConnection,new RTCPeerConnection],this.peerPair[1].ontrack=i=>{let a=document.createElement("audio");a.srcObject=new MediaStream([i.track]),a.play(),this.audioPlayerElement=a}}async switchSdp(){if(!this.peerPair)return;let i=async(c,u)=>{let _=u==="offer"?await c.createOffer():await c.createAnswer();return await c.setLocalDescription(_),c.iceGatheringState==="complete"?c.localDescription:new Et(S=>{c.onicegatheringstatechange=()=>{c.iceGatheringState==="complete"&&S(c.localDescription)}})},a=async(c,u)=>await c.setRemoteDescription(u);try{let c=await i(this.peerPair[0],"offer");await a(this.peerPair[1],c);let u=await i(this.peerPair[1],"answer");await a(this.peerPair[0],u)}catch(c){throw new De(oe.LOCAL_AEC_ERROR,c.toString()).print()}}async getTracksFromMediaElement(i){if(this.audioTrack)return this.audioTrack;let a;try{i instanceof HTMLVideoElement&&(i.captureStream?i.captureStream():i.mozCaptureStream()),a=this.context.createMediaStreamDestination(),this.context.createMediaElementSource(i).connect(a)}catch(u){throw new De(oe.LOCAL_AEC_ERROR,u.toString()).print()}if(!a)throw new De(oe.LOCAL_AEC_ERROR,"no dest node when local aec").print();let c=a.stream.getAudioTracks()[0];return this.audioTrack=c,c}getElement(){return this.element}async startEchoCancellation(){this.context.resume(),this.peerPair&&this.close(),this.initPeers();let i=this.element,a=await this.getTracksFromMediaElement(i);this.peerPair&&this.peerPair[0].addTrack(a),await this.switchSdp()}close(){z.debug("close echo cancellation unit, id is",this.id),this.audioPlayerElement&&this.audioPlayerElement.pause(),this.peerPair&&this.peerPair.forEach(i=>{i.close()}),this.peerPair=void 0,this.audioPlayerElement=void 0}}var Y6,JI;re(L1,"count",0);let vF=window.AudioContext||window.webkitAudioContext,SF=new(Y6=$t({report:jt}),Ut((JI=class{constructor(){re(this,"units",[]),re(this,"context",void 0)}processExternalMediaAEC(n){if(!this._doesEnvironmentNeedAEC())return z.debug("the system does not need to process local aec"),-1;this.context||(this.context=new vF);let i=this.units.find(a=>a&&a.getElement()===n);return i||(i=new L1(n,this.context),this.units.push(i)),i.startEchoCancellation(),z.debug("start processing local audio echo cancellation, id is",i.id),i.id}_doesEnvironmentNeedAEC(){return En().name!==cr.SAFARI}}).prototype,"processExternalMediaAEC",[Y6],Object.getOwnPropertyDescriptor(JI.prototype,"processExternalMediaAEC"),JI.prototype),JI);function Rt(n,i){var a=Object.keys(n);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(n);i&&(c=c.filter(function(u){return Object.getOwnPropertyDescriptor(n,u).enumerable})),a.push.apply(a,c)}return a}function K6(n){for(var i=1;i<arguments.length;i++){var a=arguments[i]!=null?arguments[i]:{};i%2?Rt(Object(a),!0).forEach(function(c){re(n,c,a[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(a)):Rt(Object(a)).forEach(function(c){Object.defineProperty(n,c,Object.getOwnPropertyDescriptor(a,c))})}return n}let cd=window||document;function yF(n){let i=arguments.length>1&&arguments[1]!==void 0&&arguments[1];if(!cd)return;let a=vn._cspEventHandlerPointer;if(a&&i)return void console.error(a,i);let c=u=>{if(!(u&&u.blockedURI&&(vn.onSecurityPolicyViolation||vn.getListeners(sd.SECURITY_POLICY_VIOLATION).length>0)))return;let _=u.blockedURI;ge("CSP_DETECTED_HOSTNAME_LIST").some(S=>ft(_).call(_,S))&&(vn.onSecurityPolicyViolation&&typeof vn.onSecurityPolicyViolation=="function"&&vn.onSecurityPolicyViolation(u),vn.getListeners(sd.SECURITY_POLICY_VIOLATION).length>0&&vn.safeEmit(sd.SECURITY_POLICY_VIOLATION,u))};a&&cd.removeEventListener("securitypolicyviolation",a),(i||n&&typeof n=="function"||vn.getListeners(sd.SECURITY_POLICY_VIOLATION).length>0)&&cd.addEventListener("securitypolicyviolation",c),vn._cspEventHandlerPointer=c}var XI=Q,TF=VB,QI=RegExp.prototype,PY=function(n){return n===QI||XI(QI,n)?TF(n):n.flags},Ao=T(PY);function HS(n){let i=n.length;for(;--i>=0;)n[i]=0}let AD=256,OD=286,D1=30,ZI=15,q6=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),$I=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),MY=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),oo=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),ld=new Array(576);HS(ld);let WS=new Array(60);HS(WS);let P1=new Array(512);HS(P1);let $g=new Array(256);HS($g);let YS=new Array(29);HS(YS);let M1=new Array(D1);function k1(n,i,a,c,u){this.static_tree=n,this.extra_bits=i,this.extra_base=a,this.elems=c,this.max_length=u,this.has_stree=n&&n.length}let bF,J6,Zp;function KS(n,i){this.dyn_tree=n,this.max_code=0,this.stat_desc=i}HS(M1);let x1=n=>n<256?P1[n]:P1[256+(n>>>7)],e0=(n,i)=>{n.pending_buf[n.pending++]=255&i,n.pending_buf[n.pending++]=i>>>8&255},qc=(n,i,a)=>{n.bi_valid>16-a?(n.bi_buf|=i<<n.bi_valid&65535,e0(n,n.bi_buf),n.bi_buf=i>>16-n.bi_valid,n.bi_valid+=a-16):(n.bi_buf|=i<<n.bi_valid&65535,n.bi_valid+=a)},du=(n,i,a)=>{qc(n,a[2*i],a[2*i+1])},ND=(n,i)=>{let a=0;do a|=1&n,n>>>=1,a<<=1;while(--i>0);return a>>>1},X6=(n,i,a)=>{let c=new Array(16),u,_,S=0;for(u=1;u<=ZI;u++)S=S+a[u-1]<<1,c[u]=S;for(_=0;_<=i;_++){let C=n[2*_+1];C!==0&&(n[2*_]=ND(c[C]++,C))}},Q6=n=>{let i;for(i=0;i<OD;i++)n.dyn_ltree[2*i]=0;for(i=0;i<D1;i++)n.dyn_dtree[2*i]=0;for(i=0;i<19;i++)n.bl_tree[2*i]=0;n.dyn_ltree[512]=1,n.opt_len=n.static_len=0,n.sym_next=n.matches=0},Z6=n=>{n.bi_valid>8?e0(n,n.bi_buf):n.bi_valid>0&&(n.pending_buf[n.pending++]=n.bi_buf),n.bi_buf=0,n.bi_valid=0},LD=(n,i,a,c)=>{let u=2*i,_=2*a;return n[u]<n[_]||n[u]===n[_]&&c[i]<=c[a]},DD=(n,i,a)=>{let c=n.heap[a],u=a<<1;for(;u<=n.heap_len&&(u<n.heap_len&&LD(i,n.heap[u+1],n.heap[u],n.depth)&&u++,!LD(i,c,n.heap[u],n.depth));)n.heap[a]=n.heap[u],a=u,u<<=1;n.heap[a]=c},U1=(n,i,a)=>{let c,u,_,S,C=0;if(n.sym_next!==0)do c=255&n.pending_buf[n.sym_buf+C++],c+=(255&n.pending_buf[n.sym_buf+C++])<<8,u=n.pending_buf[n.sym_buf+C++],c===0?du(n,u,i):(_=$g[u],du(n,_+AD+1,i),S=q6[_],S!==0&&(u-=YS[_],qc(n,u,S)),c--,_=x1(c),du(n,_,a),S=$I[_],S!==0&&(c-=M1[_],qc(n,c,S)));while(C<n.sym_next);du(n,256,i)},Jc=(n,i)=>{let a=i.dyn_tree,c=i.stat_desc.static_tree,u=i.stat_desc.has_stree,_=i.stat_desc.elems,S,C,R,e=-1;for(n.heap_len=0,n.heap_max=573,S=0;S<_;S++)a[2*S]!==0?(n.heap[++n.heap_len]=e=S,n.depth[S]=0):a[2*S+1]=0;for(;n.heap_len<2;)R=n.heap[++n.heap_len]=e<2?++e:0,a[2*R]=1,n.depth[R]=0,n.opt_len--,u&&(n.static_len-=c[2*R+1]);for(i.max_code=e,S=n.heap_len>>1;S>=1;S--)DD(n,a,S);R=_;do S=n.heap[1],n.heap[1]=n.heap[n.heap_len--],DD(n,a,1),C=n.heap[1],n.heap[--n.heap_max]=S,n.heap[--n.heap_max]=C,a[2*R]=a[2*S]+a[2*C],n.depth[R]=(n.depth[S]>=n.depth[C]?n.depth[S]:n.depth[C])+1,a[2*S+1]=a[2*C+1]=R,n.heap[1]=R++,DD(n,a,1);while(n.heap_len>=2);n.heap[--n.heap_max]=n.heap[1],((t,r)=>{let s=r.dyn_tree,l=r.max_code,f=r.stat_desc.static_tree,m=r.stat_desc.has_stree,E=r.stat_desc.extra_bits,y=r.stat_desc.extra_base,b=r.stat_desc.max_length,A,O,D,P,F,B,Y=0;for(P=0;P<=ZI;P++)t.bl_count[P]=0;for(s[2*t.heap[t.heap_max]+1]=0,A=t.heap_max+1;A<573;A++)O=t.heap[A],P=s[2*s[2*O+1]+1]+1,P>b&&(P=b,Y++),s[2*O+1]=P,O>l||(t.bl_count[P]++,F=0,O>=y&&(F=E[O-y]),B=s[2*O],t.opt_len+=B*(P+F),m&&(t.static_len+=B*(f[2*O+1]+F)));if(Y!==0){do{for(P=b-1;t.bl_count[P]===0;)P--;t.bl_count[P]--,t.bl_count[P+1]+=2,t.bl_count[b]--,Y-=2}while(Y>0);for(P=b;P!==0;P--)for(O=t.bl_count[P];O!==0;)D=t.heap[--A],D>l||(s[2*D+1]!==P&&(t.opt_len+=(P-s[2*D+1])*s[2*D],s[2*D+1]=P),O--)}})(n,i),X6(a,e,n.bl_count)},Nh=(n,i,a)=>{let c,u,_=-1,S=i[1],C=0,R=7,e=4;for(S===0&&(R=138,e=3),i[2*(a+1)+1]=65535,c=0;c<=a;c++)u=S,S=i[2*(c+1)+1],++C<R&&u===S||(C<e?n.bl_tree[2*u]+=C:u!==0?(u!==_&&n.bl_tree[2*u]++,n.bl_tree[32]++):C<=10?n.bl_tree[34]++:n.bl_tree[36]++,C=0,_=u,S===0?(R=138,e=3):u===S?(R=6,e=3):(R=7,e=4))},$6=(n,i,a)=>{let c,u,_=-1,S=i[1],C=0,R=7,e=4;for(S===0&&(R=138,e=3),c=0;c<=a;c++)if(u=S,S=i[2*(c+1)+1],!(++C<R&&u===S)){if(C<e)do du(n,u,n.bl_tree);while(--C!=0);else u!==0?(u!==_&&(du(n,u,n.bl_tree),C--),du(n,16,n.bl_tree),qc(n,C-3,2)):C<=10?(du(n,17,n.bl_tree),qc(n,C-3,3)):(du(n,18,n.bl_tree),qc(n,C-11,7));C=0,_=u,S===0?(R=138,e=3):u===S?(R=6,e=3):(R=7,e=4)}},ej=!1,tj=(n,i,a,c)=>{qc(n,0+(c?1:0),3),Z6(n),e0(n,a),e0(n,~a),a&&n.pending_buf.set(n.window.subarray(i,i+a),n.pending),n.pending+=a};var CF=n=>{ej||((()=>{let i,a,c,u,_,S=new Array(16);for(c=0,u=0;u<28;u++)for(YS[u]=c,i=0;i<1<<q6[u];i++)$g[c++]=u;for($g[c-1]=u,_=0,u=0;u<16;u++)for(M1[u]=_,i=0;i<1<<$I[u];i++)P1[_++]=u;for(_>>=7;u<D1;u++)for(M1[u]=_<<7,i=0;i<1<<$I[u]-7;i++)P1[256+_++]=u;for(a=0;a<=ZI;a++)S[a]=0;for(i=0;i<=143;)ld[2*i+1]=8,i++,S[8]++;for(;i<=255;)ld[2*i+1]=9,i++,S[9]++;for(;i<=279;)ld[2*i+1]=7,i++,S[7]++;for(;i<=287;)ld[2*i+1]=8,i++,S[8]++;for(X6(ld,287,S),i=0;i<D1;i++)WS[2*i+1]=5,WS[2*i]=ND(i,5);bF=new k1(ld,q6,257,OD,ZI),J6=new k1(WS,$I,0,D1,ZI),Zp=new k1(new Array(0),MY,0,19,7)})(),ej=!0),n.l_desc=new KS(n.dyn_ltree,bF),n.d_desc=new KS(n.dyn_dtree,J6),n.bl_desc=new KS(n.bl_tree,Zp),n.bi_buf=0,n.bi_valid=0,Q6(n)},wF=(n,i,a,c)=>{let u,_,S=0;n.level>0?(n.strm.data_type===2&&(n.strm.data_type=(C=>{let R,e=4093624447;for(R=0;R<=31;R++,e>>>=1)if(1&e&&C.dyn_ltree[2*R]!==0)return 0;if(C.dyn_ltree[18]!==0||C.dyn_ltree[20]!==0||C.dyn_ltree[26]!==0)return 1;for(R=32;R<AD;R++)if(C.dyn_ltree[2*R]!==0)return 1;return 0})(n)),Jc(n,n.l_desc),Jc(n,n.d_desc),S=(C=>{let R;for(Nh(C,C.dyn_ltree,C.l_desc.max_code),Nh(C,C.dyn_dtree,C.d_desc.max_code),Jc(C,C.bl_desc),R=18;R>=3&&C.bl_tree[2*oo[R]+1]===0;R--);return C.opt_len+=3*(R+1)+5+5+4,R})(n),u=n.opt_len+3+7>>>3,_=n.static_len+3+7>>>3,_<=u&&(u=_)):u=_=a+5,a+4<=u&&i!==-1?tj(n,i,a,c):n.strategy===4||_===u?(qc(n,2+(c?1:0),3),U1(n,ld,WS)):(qc(n,4+(c?1:0),3),((C,R,e,t)=>{let r;for(qc(C,R-257,5),qc(C,e-1,5),qc(C,t-4,4),r=0;r<t;r++)qc(C,C.bl_tree[2*oo[r]+1],3);$6(C,C.dyn_ltree,R-1),$6(C,C.dyn_dtree,e-1)})(n,n.l_desc.max_code+1,n.d_desc.max_code+1,S+1),U1(n,n.dyn_ltree,n.dyn_dtree)),Q6(n),c&&Z6(n)},nj=(n,i,a)=>(n.pending_buf[n.sym_buf+n.sym_next++]=i,n.pending_buf[n.sym_buf+n.sym_next++]=i>>8,n.pending_buf[n.sym_buf+n.sym_next++]=a,i===0?n.dyn_ltree[2*a]++:(n.matches++,i--,n.dyn_ltree[2*($g[a]+AD+1)]++,n.dyn_dtree[2*x1(i)]++),n.sym_next===n.sym_end),RF=n=>{qc(n,2,3),du(n,256,ld),(i=>{i.bi_valid===16?(e0(i,i.bi_buf),i.bi_buf=0,i.bi_valid=0):i.bi_valid>=8&&(i.pending_buf[i.pending++]=255&i.bi_buf,i.bi_buf>>=8,i.bi_valid-=8)})(n)},rj={_tr_init:CF,_tr_stored_block:tj,_tr_flush_block:wF,_tr_tally:nj,_tr_align:RF},j1=(n,i,a,c)=>{let u=65535&n|0,_=n>>>16&65535|0,S=0;for(;a!==0;){S=a>2e3?2e3:a,a-=S;do u=u+i[c++]|0,_=_+u|0;while(--S);u%=65521,_%=65521}return u|_<<16|0};let IF=new Uint32Array((()=>{let n,i=[];for(var a=0;a<256;a++){n=a;for(var c=0;c<8;c++)n=1&n?3988292384^n>>>1:n>>>1;i[a]=n}return i})());var Oo=(n,i,a,c)=>{let u=IF,_=c+a;n^=-1;for(let S=c;S<_;S++)n=n>>>8^u[255&(n^i[S])];return-1^n},eE={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},PD={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_UNKNOWN:2,Z_DEFLATED:8};let{_tr_init:kY,_tr_stored_block:ij,_tr_flush_block:xY,_tr_tally:tE,_tr_align:eA}=rj,{Z_NO_FLUSH:nE,Z_PARTIAL_FLUSH:Ko,Z_FULL_FLUSH:qS,Z_FINISH:Ol,Z_BLOCK:AF,Z_OK:No,Z_STREAM_END:OF,Z_STREAM_ERROR:pc,Z_DATA_ERROR:UY,Z_BUF_ERROR:$p,Z_DEFAULT_COMPRESSION:jY,Z_FILTERED:VY,Z_HUFFMAN_ONLY:Nl,Z_RLE:NF,Z_FIXED:mc,Z_DEFAULT_STRATEGY:LF,Z_UNKNOWN:em,Z_DEFLATED:MD}=PD,tA=286,BY=30,FY=19,kD=2*tA+1,GY=15,JS=258,tm=262,V1=42,nm=113,XS=666,QS=(n,i)=>(n.msg=eE[i],i),DF=n=>2*n-(n>4?9:0),rE=n=>{let i=n.length;for(;--i>=0;)n[i]=0},zY=n=>{let i,a,c,u=n.w_size;i=n.hash_size,c=i;do a=n.head[--c],n.head[c]=a>=u?a-u:0;while(--i);i=u,c=i;do a=n.prev[--c],n.prev[c]=a>=u?a-u:0;while(--i)},dd=(n,i,a)=>(i<<n.hash_shift^a)&n.hash_mask,Rs=n=>{let i=n.state,a=i.pending;a>n.avail_out&&(a=n.avail_out),a!==0&&(n.output.set(i.pending_buf.subarray(i.pending_out,i.pending_out+a),n.next_out),n.next_out+=a,i.pending_out+=a,n.total_out+=a,n.avail_out-=a,i.pending-=a,i.pending===0&&(i.pending_out=0))},qo=(n,i)=>{xY(n,n.block_start>=0?n.block_start:-1,n.strstart-n.block_start,i),n.block_start=n.strstart,Rs(n.strm)},si=(n,i)=>{n.pending_buf[n.pending++]=i},t0=(n,i)=>{n.pending_buf[n.pending++]=i>>>8&255,n.pending_buf[n.pending++]=255&i},n0=(n,i,a,c)=>{let u=n.avail_in;return u>c&&(u=c),u===0?0:(n.avail_in-=u,i.set(n.input.subarray(n.next_in,n.next_in+u),a),n.state.wrap===1?n.adler=j1(n.adler,i,u,a):n.state.wrap===2&&(n.adler=Oo(n.adler,i,u,a)),n.next_in+=u,n.total_in+=u,u)},aj=(n,i)=>{let a,c,u=n.max_chain_length,_=n.strstart,S=n.prev_length,C=n.nice_match,R=n.strstart>n.w_size-tm?n.strstart-(n.w_size-tm):0,e=n.window,t=n.w_mask,r=n.prev,s=n.strstart+JS,l=e[_+S-1],f=e[_+S];n.prev_length>=n.good_match&&(u>>=2),C>n.lookahead&&(C=n.lookahead);do if(a=i,e[a+S]===f&&e[a+S-1]===l&&e[a]===e[_]&&e[++a]===e[_+1]){_+=2,a++;do;while(e[++_]===e[++a]&&e[++_]===e[++a]&&e[++_]===e[++a]&&e[++_]===e[++a]&&e[++_]===e[++a]&&e[++_]===e[++a]&&e[++_]===e[++a]&&e[++_]===e[++a]&&_<s);if(c=JS-(s-_),_=s-JS,c>S){if(n.match_start=i,S=c,c>=C)break;l=e[_+S-1],f=e[_+S]}}while((i=r[i&t])>R&&--u!=0);return S<=n.lookahead?S:n.lookahead},uu=n=>{let i=n.w_size,a,c,u;do{if(c=n.window_size-n.lookahead-n.strstart,n.strstart>=i+(i-tm)&&(n.window.set(n.window.subarray(i,i+i-c),0),n.match_start-=i,n.strstart-=i,n.block_start-=i,n.insert>n.strstart&&(n.insert=n.strstart),zY(n),c+=i),n.strm.avail_in===0)break;if(a=n0(n.strm,n.window,n.strstart+n.lookahead,c),n.lookahead+=a,n.lookahead+n.insert>=3)for(u=n.strstart-n.insert,n.ins_h=n.window[u],n.ins_h=dd(n,n.ins_h,n.window[u+1]);n.insert&&(n.ins_h=dd(n,n.ins_h,n.window[u+3-1]),n.prev[u&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=u,u++,n.insert--,!(n.lookahead+n.insert<3)););}while(n.lookahead<tm&&n.strm.avail_in!==0)},PF=(n,i)=>{let a,c,u,_=n.pending_buf_size-5>n.w_size?n.w_size:n.pending_buf_size-5,S=0,C=n.strm.avail_in;do{if(a=65535,u=n.bi_valid+42>>3,n.strm.avail_out<u||(u=n.strm.avail_out-u,c=n.strstart-n.block_start,a>c+n.strm.avail_in&&(a=c+n.strm.avail_in),a>u&&(a=u),a<_&&(a===0&&i!==Ol||i===nE||a!==c+n.strm.avail_in)))break;S=i===Ol&&a===c+n.strm.avail_in?1:0,ij(n,0,0,S),n.pending_buf[n.pending-4]=a,n.pending_buf[n.pending-3]=a>>8,n.pending_buf[n.pending-2]=~a,n.pending_buf[n.pending-1]=~a>>8,Rs(n.strm),c&&(c>a&&(c=a),n.strm.output.set(n.window.subarray(n.block_start,n.block_start+c),n.strm.next_out),n.strm.next_out+=c,n.strm.avail_out-=c,n.strm.total_out+=c,n.block_start+=c,a-=c),a&&(n0(n.strm,n.strm.output,n.strm.next_out,a),n.strm.next_out+=a,n.strm.avail_out-=a,n.strm.total_out+=a)}while(S===0);return C-=n.strm.avail_in,C&&(C>=n.w_size?(n.matches=2,n.window.set(n.strm.input.subarray(n.strm.next_in-n.w_size,n.strm.next_in),0),n.strstart=n.w_size,n.insert=n.strstart):(n.window_size-n.strstart<=C&&(n.strstart-=n.w_size,n.window.set(n.window.subarray(n.w_size,n.w_size+n.strstart),0),n.matches<2&&n.matches++,n.insert>n.strstart&&(n.insert=n.strstart)),n.window.set(n.strm.input.subarray(n.strm.next_in-C,n.strm.next_in),n.strstart),n.strstart+=C,n.insert+=C>n.w_size-n.insert?n.w_size-n.insert:C),n.block_start=n.strstart),n.high_water<n.strstart&&(n.high_water=n.strstart),S?4:i!==nE&&i!==Ol&&n.strm.avail_in===0&&n.strstart===n.block_start?2:(u=n.window_size-n.strstart,n.strm.avail_in>u&&n.block_start>=n.w_size&&(n.block_start-=n.w_size,n.strstart-=n.w_size,n.window.set(n.window.subarray(n.w_size,n.w_size+n.strstart),0),n.matches<2&&n.matches++,u+=n.w_size,n.insert>n.strstart&&(n.insert=n.strstart)),u>n.strm.avail_in&&(u=n.strm.avail_in),u&&(n0(n.strm,n.window,n.strstart,u),n.strstart+=u,n.insert+=u>n.w_size-n.insert?n.w_size-n.insert:u),n.high_water<n.strstart&&(n.high_water=n.strstart),u=n.bi_valid+42>>3,u=n.pending_buf_size-u>65535?65535:n.pending_buf_size-u,_=u>n.w_size?n.w_size:u,c=n.strstart-n.block_start,(c>=_||(c||i===Ol)&&i!==nE&&n.strm.avail_in===0&&c<=u)&&(a=c>u?u:c,S=i===Ol&&n.strm.avail_in===0&&a===c?1:0,ij(n,n.block_start,a,S),n.block_start+=a,Rs(n.strm)),S?3:1)},rm=(n,i)=>{let a,c;for(;;){if(n.lookahead<tm){if(uu(n),n.lookahead<tm&&i===nE)return 1;if(n.lookahead===0)break}if(a=0,n.lookahead>=3&&(n.ins_h=dd(n,n.ins_h,n.window[n.strstart+3-1]),a=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart),a!==0&&n.strstart-a<=n.w_size-tm&&(n.match_length=aj(n,a)),n.match_length>=3)if(c=tE(n,n.strstart-n.match_start,n.match_length-3),n.lookahead-=n.match_length,n.match_length<=n.max_lazy_match&&n.lookahead>=3){n.match_length--;do n.strstart++,n.ins_h=dd(n,n.ins_h,n.window[n.strstart+3-1]),a=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart;while(--n.match_length!=0);n.strstart++}else n.strstart+=n.match_length,n.match_length=0,n.ins_h=n.window[n.strstart],n.ins_h=dd(n,n.ins_h,n.window[n.strstart+1]);else c=tE(n,0,n.window[n.strstart]),n.lookahead--,n.strstart++;if(c&&(qo(n,!1),n.strm.avail_out===0))return 1}return n.insert=n.strstart<2?n.strstart:2,i===Ol?(qo(n,!0),n.strm.avail_out===0?3:4):n.sym_next&&(qo(n,!1),n.strm.avail_out===0)?1:2},Jo=(n,i)=>{let a,c,u;for(;;){if(n.lookahead<tm){if(uu(n),n.lookahead<tm&&i===nE)return 1;if(n.lookahead===0)break}if(a=0,n.lookahead>=3&&(n.ins_h=dd(n,n.ins_h,n.window[n.strstart+3-1]),a=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart),n.prev_length=n.match_length,n.prev_match=n.match_start,n.match_length=2,a!==0&&n.prev_length<n.max_lazy_match&&n.strstart-a<=n.w_size-tm&&(n.match_length=aj(n,a),n.match_length<=5&&(n.strategy===VY||n.match_length===3&&n.strstart-n.match_start>4096)&&(n.match_length=2)),n.prev_length>=3&&n.match_length<=n.prev_length){u=n.strstart+n.lookahead-3,c=tE(n,n.strstart-1-n.prev_match,n.prev_length-3),n.lookahead-=n.prev_length-1,n.prev_length-=2;do++n.strstart<=u&&(n.ins_h=dd(n,n.ins_h,n.window[n.strstart+3-1]),a=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart);while(--n.prev_length!=0);if(n.match_available=0,n.match_length=2,n.strstart++,c&&(qo(n,!1),n.strm.avail_out===0))return 1}else if(n.match_available){if(c=tE(n,0,n.window[n.strstart-1]),c&&qo(n,!1),n.strstart++,n.lookahead--,n.strm.avail_out===0)return 1}else n.match_available=1,n.strstart++,n.lookahead--}return n.match_available&&(c=tE(n,0,n.window[n.strstart-1]),n.match_available=0),n.insert=n.strstart<2?n.strstart:2,i===Ol?(qo(n,!0),n.strm.avail_out===0?3:4):n.sym_next&&(qo(n,!1),n.strm.avail_out===0)?1:2};function Is(n,i,a,c,u){this.good_length=n,this.max_lazy=i,this.nice_length=a,this.max_chain=c,this.func=u}let bi=[new Is(0,0,0,0,PF),new Is(4,4,8,4,rm),new Is(4,5,16,8,rm),new Is(4,6,32,32,rm),new Is(4,4,16,16,Jo),new Is(8,16,32,32,Jo),new Is(8,16,128,128,Jo),new Is(8,32,128,256,Jo),new Is(32,128,258,1024,Jo),new Is(32,258,258,4096,Jo)];function nA(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=MD,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(2*kD),this.dyn_dtree=new Uint16Array(2*(2*BY+1)),this.bl_tree=new Uint16Array(2*(2*FY+1)),rE(this.dyn_ltree),rE(this.dyn_dtree),rE(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(GY+1),this.heap=new Uint16Array(2*tA+1),rE(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*tA+1),rE(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}let ZS=n=>{if(!n)return 1;let i=n.state;return!i||i.strm!==n||i.status!==V1&&i.status!==57&&i.status!==69&&i.status!==73&&i.status!==91&&i.status!==103&&i.status!==nm&&i.status!==XS?1:0},sj=n=>{if(ZS(n))return QS(n,pc);n.total_in=n.total_out=0,n.data_type=em;let i=n.state;return i.pending=0,i.pending_out=0,i.wrap<0&&(i.wrap=-i.wrap),i.status=i.wrap===2?57:i.wrap?V1:nm,n.adler=i.wrap===2?0:1,i.last_flush=-2,kY(i),No},$S=n=>{let i=sj(n);return i===No&&(a=>{a.window_size=2*a.w_size,rE(a.head),a.max_lazy_match=bi[a.level].max_lazy,a.good_match=bi[a.level].good_length,a.nice_match=bi[a.level].nice_length,a.max_chain_length=bi[a.level].max_chain,a.strstart=0,a.block_start=0,a.lookahead=0,a.insert=0,a.match_length=a.prev_length=2,a.match_available=0,a.ins_h=0})(n.state),i},oj=(n,i,a,c,u,_)=>{if(!n)return pc;let S=1;if(i===jY&&(i=6),c<0?(S=0,c=-c):c>15&&(S=2,c-=16),u<1||u>9||a!==MD||c<8||c>15||i<0||i>9||_<0||_>mc||c===8&&S!==1)return QS(n,pc);c===8&&(c=9);let C=new nA;return n.state=C,C.strm=n,C.status=V1,C.wrap=S,C.gzhead=null,C.w_bits=c,C.w_size=1<<C.w_bits,C.w_mask=C.w_size-1,C.hash_bits=u+7,C.hash_size=1<<C.hash_bits,C.hash_mask=C.hash_size-1,C.hash_shift=~~((C.hash_bits+3-1)/3),C.window=new Uint8Array(2*C.w_size),C.head=new Uint16Array(C.hash_size),C.prev=new Uint16Array(C.w_size),C.lit_bufsize=1<<u+6,C.pending_buf_size=4*C.lit_bufsize,C.pending_buf=new Uint8Array(C.pending_buf_size),C.sym_buf=C.lit_bufsize,C.sym_end=3*(C.lit_bufsize-1),C.level=i,C.strategy=_,C.method=a,$S(n)};var cj=(n,i)=>{if(ZS(n)||i>AF||i<0)return n?QS(n,pc):pc;let a=n.state;if(!n.output||n.avail_in!==0&&!n.input||a.status===XS&&i!==Ol)return QS(n,n.avail_out===0?$p:pc);let c=a.last_flush;if(a.last_flush=i,a.pending!==0){if(Rs(n),n.avail_out===0)return a.last_flush=-1,No}else if(n.avail_in===0&&DF(i)<=DF(c)&&i!==Ol)return QS(n,$p);if(a.status===XS&&n.avail_in!==0)return QS(n,$p);if(a.status===V1&&a.wrap===0&&(a.status=nm),a.status===V1){let u=MD+(a.w_bits-8<<4)<<8,_=-1;if(_=a.strategy>=Nl||a.level<2?0:a.level<6?1:a.level===6?2:3,u|=_<<6,a.strstart!==0&&(u|=32),u+=31-u%31,t0(a,u),a.strstart!==0&&(t0(a,n.adler>>>16),t0(a,65535&n.adler)),n.adler=1,a.status=nm,Rs(n),a.pending!==0)return a.last_flush=-1,No}if(a.status===57){if(n.adler=0,si(a,31),si(a,139),si(a,8),a.gzhead)si(a,(a.gzhead.text?1:0)+(a.gzhead.hcrc?2:0)+(a.gzhead.extra?4:0)+(a.gzhead.name?8:0)+(a.gzhead.comment?16:0)),si(a,255&a.gzhead.time),si(a,a.gzhead.time>>8&255),si(a,a.gzhead.time>>16&255),si(a,a.gzhead.time>>24&255),si(a,a.level===9?2:a.strategy>=Nl||a.level<2?4:0),si(a,255&a.gzhead.os),a.gzhead.extra&&a.gzhead.extra.length&&(si(a,255&a.gzhead.extra.length),si(a,a.gzhead.extra.length>>8&255)),a.gzhead.hcrc&&(n.adler=Oo(n.adler,a.pending_buf,a.pending,0)),a.gzindex=0,a.status=69;else if(si(a,0),si(a,0),si(a,0),si(a,0),si(a,0),si(a,a.level===9?2:a.strategy>=Nl||a.level<2?4:0),si(a,3),a.status=nm,Rs(n),a.pending!==0)return a.last_flush=-1,No}if(a.status===69){if(a.gzhead.extra){let u=a.pending,_=(65535&a.gzhead.extra.length)-a.gzindex;for(;a.pending+_>a.pending_buf_size;){let C=a.pending_buf_size-a.pending;if(a.pending_buf.set(a.gzhead.extra.subarray(a.gzindex,a.gzindex+C),a.pending),a.pending=a.pending_buf_size,a.gzhead.hcrc&&a.pending>u&&(n.adler=Oo(n.adler,a.pending_buf,a.pending-u,u)),a.gzindex+=C,Rs(n),a.pending!==0)return a.last_flush=-1,No;u=0,_-=C}let S=new Uint8Array(a.gzhead.extra);a.pending_buf.set(S.subarray(a.gzindex,a.gzindex+_),a.pending),a.pending+=_,a.gzhead.hcrc&&a.pending>u&&(n.adler=Oo(n.adler,a.pending_buf,a.pending-u,u)),a.gzindex=0}a.status=73}if(a.status===73){if(a.gzhead.name){let u,_=a.pending;do{if(a.pending===a.pending_buf_size){if(a.gzhead.hcrc&&a.pending>_&&(n.adler=Oo(n.adler,a.pending_buf,a.pending-_,_)),Rs(n),a.pending!==0)return a.last_flush=-1,No;_=0}u=a.gzindex<a.gzhead.name.length?255&a.gzhead.name.charCodeAt(a.gzindex++):0,si(a,u)}while(u!==0);a.gzhead.hcrc&&a.pending>_&&(n.adler=Oo(n.adler,a.pending_buf,a.pending-_,_)),a.gzindex=0}a.status=91}if(a.status===91){if(a.gzhead.comment){let u,_=a.pending;do{if(a.pending===a.pending_buf_size){if(a.gzhead.hcrc&&a.pending>_&&(n.adler=Oo(n.adler,a.pending_buf,a.pending-_,_)),Rs(n),a.pending!==0)return a.last_flush=-1,No;_=0}u=a.gzindex<a.gzhead.comment.length?255&a.gzhead.comment.charCodeAt(a.gzindex++):0,si(a,u)}while(u!==0);a.gzhead.hcrc&&a.pending>_&&(n.adler=Oo(n.adler,a.pending_buf,a.pending-_,_))}a.status=103}if(a.status===103){if(a.gzhead.hcrc){if(a.pending+2>a.pending_buf_size&&(Rs(n),a.pending!==0))return a.last_flush=-1,No;si(a,255&n.adler),si(a,n.adler>>8&255),n.adler=0}if(a.status=nm,Rs(n),a.pending!==0)return a.last_flush=-1,No}if(n.avail_in!==0||a.lookahead!==0||i!==nE&&a.status!==XS){let u=a.level===0?PF(a,i):a.strategy===Nl?((_,S)=>{let C;for(;;){if(_.lookahead===0&&(uu(_),_.lookahead===0)){if(S===nE)return 1;break}if(_.match_length=0,C=tE(_,0,_.window[_.strstart]),_.lookahead--,_.strstart++,C&&(qo(_,!1),_.strm.avail_out===0))return 1}return _.insert=0,S===Ol?(qo(_,!0),_.strm.avail_out===0?3:4):_.sym_next&&(qo(_,!1),_.strm.avail_out===0)?1:2})(a,i):a.strategy===NF?((_,S)=>{let C,R,e,t,r=_.window;for(;;){if(_.lookahead<=JS){if(uu(_),_.lookahead<=JS&&S===nE)return 1;if(_.lookahead===0)break}if(_.match_length=0,_.lookahead>=3&&_.strstart>0&&(e=_.strstart-1,R=r[e],R===r[++e]&&R===r[++e]&&R===r[++e])){t=_.strstart+JS;do;while(R===r[++e]&&R===r[++e]&&R===r[++e]&&R===r[++e]&&R===r[++e]&&R===r[++e]&&R===r[++e]&&R===r[++e]&&e<t);_.match_length=JS-(t-e),_.match_length>_.lookahead&&(_.match_length=_.lookahead)}if(_.match_length>=3?(C=tE(_,1,_.match_length-3),_.lookahead-=_.match_length,_.strstart+=_.match_length,_.match_length=0):(C=tE(_,0,_.window[_.strstart]),_.lookahead--,_.strstart++),C&&(qo(_,!1),_.strm.avail_out===0))return 1}return _.insert=0,S===Ol?(qo(_,!0),_.strm.avail_out===0?3:4):_.sym_next&&(qo(_,!1),_.strm.avail_out===0)?1:2})(a,i):bi[a.level].func(a,i);if(u!==3&&u!==4||(a.status=XS),u===1||u===3)return n.avail_out===0&&(a.last_flush=-1),No;if(u===2&&(i===Ko?eA(a):i!==AF&&(ij(a,0,0,!1),i===qS&&(rE(a.head),a.lookahead===0&&(a.strstart=0,a.block_start=0,a.insert=0))),Rs(n),n.avail_out===0))return a.last_flush=-1,No}return i!==Ol?No:a.wrap<=0?OF:(a.wrap===2?(si(a,255&n.adler),si(a,n.adler>>8&255),si(a,n.adler>>16&255),si(a,n.adler>>24&255),si(a,255&n.total_in),si(a,n.total_in>>8&255),si(a,n.total_in>>16&255),si(a,n.total_in>>24&255)):(t0(a,n.adler>>>16),t0(a,65535&n.adler)),Rs(n),a.wrap>0&&(a.wrap=-a.wrap),a.pending!==0?No:OF)},B1=(n,i)=>{let a=i.length;if(ZS(n))return pc;let c=n.state,u=c.wrap;if(u===2||u===1&&c.status!==V1||c.lookahead)return pc;if(u===1&&(n.adler=j1(n.adler,i,a,0)),c.wrap=0,a>=c.w_size){u===0&&(rE(c.head),c.strstart=0,c.block_start=0,c.insert=0);let R=new Uint8Array(c.w_size);R.set(i.subarray(a-c.w_size,a),0),i=R,a=c.w_size}let _=n.avail_in,S=n.next_in,C=n.input;for(n.avail_in=a,n.next_in=0,n.input=i,uu(c);c.lookahead>=3;){let R=c.strstart,e=c.lookahead-2;do c.ins_h=dd(c,c.ins_h,c.window[R+3-1]),c.prev[R&c.w_mask]=c.head[c.ins_h],c.head[c.ins_h]=R,R++;while(--e);c.strstart=R,c.lookahead=2,uu(c)}return c.strstart+=c.lookahead,c.block_start=c.strstart,c.insert=c.lookahead,c.lookahead=0,c.match_length=c.prev_length=2,c.match_available=0,n.next_in=S,n.input=C,n.avail_in=_,c.wrap=u,No},ud={deflateInit:(n,i)=>oj(n,i,MD,15,8,LF),deflateInit2:oj,deflateReset:$S,deflateResetKeep:sj,deflateSetHeader:(n,i)=>ZS(n)||n.state.wrap!==2?pc:(n.state.gzhead=i,No),deflate:cj,deflateEnd:n=>{if(ZS(n))return pc;let i=n.state.status;return n.state=null,i===nm?QS(n,UY):No},deflateSetDictionary:B1,deflateInfo:"pako deflate (from Nodeca project)"};let rA=(n,i)=>Object.prototype.hasOwnProperty.call(n,i);var xD={assign:function(n){let i=Array.prototype.slice.call(arguments,1);for(;i.length;){let a=i.shift();if(a){if(typeof a!="object")throw new TypeError(a+"must be non-object");for(let c in a)rA(a,c)&&(n[c]=a[c])}}return n},flattenChunks:n=>{let i=0;for(let c=0,u=n.length;c<u;c++)i+=n[c].length;let a=new Uint8Array(i);for(let c=0,u=0,_=n.length;c<_;c++){let S=n[c];a.set(S,u),u+=S.length}return a}};let F1=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{F1=!1}let G1=new Uint8Array(256);for(let n=0;n<256;n++)G1[n]=n>=252?6:n>=248?5:n>=240?4:n>=224?3:n>=192?2:1;G1[254]=G1[254]=1;var z1={string2buf:n=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(n);let i,a,c,u,_,S=n.length,C=0;for(u=0;u<S;u++)a=n.charCodeAt(u),(64512&a)==55296&&u+1<S&&(c=n.charCodeAt(u+1),(64512&c)==56320&&(a=65536+(a-55296<<10)+(c-56320),u++)),C+=a<128?1:a<2048?2:a<65536?3:4;for(i=new Uint8Array(C),_=0,u=0;_<C;u++)a=n.charCodeAt(u),(64512&a)==55296&&u+1<S&&(c=n.charCodeAt(u+1),(64512&c)==56320&&(a=65536+(a-55296<<10)+(c-56320),u++)),a<128?i[_++]=a:a<2048?(i[_++]=192|a>>>6,i[_++]=128|63&a):a<65536?(i[_++]=224|a>>>12,i[_++]=128|a>>>6&63,i[_++]=128|63&a):(i[_++]=240|a>>>18,i[_++]=128|a>>>12&63,i[_++]=128|a>>>6&63,i[_++]=128|63&a);return i},buf2string:(n,i)=>{let a=i||n.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(n.subarray(0,i));let c,u,_=new Array(2*a);for(u=0,c=0;c<a;){let S=n[c++];if(S<128){_[u++]=S;continue}let C=G1[S];if(C>4)_[u++]=65533,c+=C-1;else{for(S&=C===2?31:C===3?15:7;C>1&&c<a;)S=S<<6|63&n[c++],C--;C>1?_[u++]=65533:S<65536?_[u++]=S:(S-=65536,_[u++]=55296|S>>10&1023,_[u++]=56320|1023&S)}}return((S,C)=>{if(C<65534&&S.subarray&&F1)return String.fromCharCode.apply(null,S.length===C?S:S.subarray(0,C));let R="";for(let e=0;e<C;e++)R+=String.fromCharCode(S[e]);return R})(_,u)},utf8border:(n,i)=>{(i=i||n.length)>n.length&&(i=n.length);let a=i-1;for(;a>=0&&(192&n[a])==128;)a--;return a<0||a===0?i:a+G1[n[a]]>i?a:i}},lj=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};let MF=Object.prototype.toString,{Z_NO_FLUSH:HY,Z_SYNC_FLUSH:iA,Z_FULL_FLUSH:WY,Z_FINISH:UD,Z_OK:aA,Z_STREAM_END:sA,Z_DEFAULT_COMPRESSION:oA,Z_DEFAULT_STRATEGY:kF,Z_DEFLATED:xF}=PD;function jD(n){this.options=xD.assign({level:oA,method:xF,chunkSize:16384,windowBits:15,memLevel:8,strategy:kF},n||{});let i=this.options;i.raw&&i.windowBits>0?i.windowBits=-i.windowBits:i.gzip&&i.windowBits>0&&i.windowBits<16&&(i.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new lj,this.strm.avail_out=0;let a=ud.deflateInit2(this.strm,i.level,i.method,i.windowBits,i.memLevel,i.strategy);if(a!==aA)throw new Error(eE[a]);if(i.header&&ud.deflateSetHeader(this.strm,i.header),i.dictionary){let c;if(c=typeof i.dictionary=="string"?z1.string2buf(i.dictionary):MF.call(i.dictionary)==="[object ArrayBuffer]"?new Uint8Array(i.dictionary):i.dictionary,a=ud.deflateSetDictionary(this.strm,c),a!==aA)throw new Error(eE[a]);this._dict_set=!0}}function YY(n,i){let a=new jD(i);if(a.push(n,!0),a.err)throw a.msg||eE[a.err];return a.result}jD.prototype.push=function(n,i){let a=this.strm,c=this.options.chunkSize,u,_;if(this.ended)return!1;for(_=i===~~i?i:i===!0?UD:HY,typeof n=="string"?a.input=z1.string2buf(n):MF.call(n)==="[object ArrayBuffer]"?a.input=new Uint8Array(n):a.input=n,a.next_in=0,a.avail_in=a.input.length;;)if(a.avail_out===0&&(a.output=new Uint8Array(c),a.next_out=0,a.avail_out=c),(_===iA||_===WY)&&a.avail_out<=6)this.onData(a.output.subarray(0,a.next_out)),a.avail_out=0;else{if(u=ud.deflate(a,_),u===sA)return a.next_out>0&&this.onData(a.output.subarray(0,a.next_out)),u=ud.deflateEnd(this.strm),this.onEnd(u),this.ended=!0,u===aA;if(a.avail_out!==0){if(_>0&&a.next_out>0)this.onData(a.output.subarray(0,a.next_out)),a.avail_out=0;else if(a.avail_in===0)break}else this.onData(a.output)}return!0},jD.prototype.onData=function(n){this.chunks.push(n)},jD.prototype.onEnd=function(n){n===aA&&(this.result=xD.flattenChunks(this.chunks)),this.chunks=[],this.err=n,this.msg=this.strm.msg};var KY={deflate:YY};let VD=16209;var BD=function(n,i){let a,c,u,_,S,C,R,e,t,r,s,l,f,m,E,y,b,A,O,D,P,F,B,Y,$=n.state;a=n.next_in,B=n.input,c=a+(n.avail_in-5),u=n.next_out,Y=n.output,_=u-(i-n.avail_out),S=u+(n.avail_out-257),C=$.dmax,R=$.wsize,e=$.whave,t=$.wnext,r=$.window,s=$.hold,l=$.bits,f=$.lencode,m=$.distcode,E=(1<<$.lenbits)-1,y=(1<<$.distbits)-1;e:do{l<15&&(s+=B[a++]<<l,l+=8,s+=B[a++]<<l,l+=8),b=f[s&E];t:for(;;){if(A=b>>>24,s>>>=A,l-=A,A=b>>>16&255,A===0)Y[u++]=65535&b;else{if(!(16&A)){if(!(64&A)){b=f[(65535&b)+(s&(1<<A)-1)];continue t}if(32&A){$.mode=16191;break e}n.msg="invalid literal/length code",$.mode=VD;break e}O=65535&b,A&=15,A&&(l<A&&(s+=B[a++]<<l,l+=8),O+=s&(1<<A)-1,s>>>=A,l-=A),l<15&&(s+=B[a++]<<l,l+=8,s+=B[a++]<<l,l+=8),b=m[s&y];n:for(;;){if(A=b>>>24,s>>>=A,l-=A,A=b>>>16&255,!(16&A)){if(!(64&A)){b=m[(65535&b)+(s&(1<<A)-1)];continue n}n.msg="invalid distance code",$.mode=VD;break e}if(D=65535&b,A&=15,l<A&&(s+=B[a++]<<l,l+=8,l<A&&(s+=B[a++]<<l,l+=8)),D+=s&(1<<A)-1,D>C){n.msg="invalid distance too far back",$.mode=VD;break e}if(s>>>=A,l-=A,A=u-_,D>A){if(A=D-A,A>e&&$.sane){n.msg="invalid distance too far back",$.mode=VD;break e}if(P=0,F=r,t===0){if(P+=R-A,A<O){O-=A;do Y[u++]=r[P++];while(--A);P=u-D,F=Y}}else if(t<A){if(P+=R+t-A,A-=t,A<O){O-=A;do Y[u++]=r[P++];while(--A);if(P=0,t<O){A=t,O-=A;do Y[u++]=r[P++];while(--A);P=u-D,F=Y}}}else if(P+=t-A,A<O){O-=A;do Y[u++]=r[P++];while(--A);P=u-D,F=Y}for(;O>2;)Y[u++]=F[P++],Y[u++]=F[P++],Y[u++]=F[P++],O-=3;O&&(Y[u++]=F[P++],O>1&&(Y[u++]=F[P++]))}else{P=u-D;do Y[u++]=Y[P++],Y[u++]=Y[P++],Y[u++]=Y[P++],O-=3;while(O>2);O&&(Y[u++]=Y[P++],O>1&&(Y[u++]=Y[P++]))}break}}break}}while(a<c&&u<S);O=l>>3,a-=O,l-=O<<3,s&=(1<<l)-1,n.next_in=a,n.next_out=u,n.avail_in=a<c?c-a+5:5-(a-c),n.avail_out=u<S?S-u+257:257-(u-S),$.hold=s,$.bits=l};let FD=15,qY=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),JY=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),XY=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),GD=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var cA=(n,i,a,c,u,_,S,C)=>{let R=C.bits,e,t,r,s,l,f,m=0,E=0,y=0,b=0,A=0,O=0,D=0,P=0,F=0,B=0,Y=null,$=new Uint16Array(16),ee=new Uint16Array(16),Ee,Re,Ie,we=null;for(m=0;m<=FD;m++)$[m]=0;for(E=0;E<c;E++)$[i[a+E]]++;for(A=R,b=FD;b>=1&&$[b]===0;b--);if(A>b&&(A=b),b===0)return u[_++]=20971520,u[_++]=20971520,C.bits=1,0;for(y=1;y<b&&$[y]===0;y++);for(A<y&&(A=y),P=1,m=1;m<=FD;m++)if(P<<=1,P-=$[m],P<0)return-1;if(P>0&&(n===0||b!==1))return-1;for(ee[1]=0,m=1;m<FD;m++)ee[m+1]=ee[m]+$[m];for(E=0;E<c;E++)i[a+E]!==0&&(S[ee[i[a+E]]++]=E);if(n===0?(Y=we=S,f=20):n===1?(Y=qY,we=JY,f=257):(Y=XY,we=GD,f=0),B=0,E=0,m=y,l=_,O=A,D=0,r=-1,F=1<<A,s=F-1,n===1&&F>852||n===2&&F>592)return 1;for(;;){Ee=m-D,S[E]+1<f?(Re=0,Ie=S[E]):S[E]>=f?(Re=we[S[E]-f],Ie=Y[S[E]-f]):(Re=96,Ie=0),e=1<<m-D,t=1<<O,y=t;do t-=e,u[l+(B>>D)+t]=Ee<<24|Re<<16|Ie|0;while(t!==0);for(e=1<<m-1;B&e;)e>>=1;if(e!==0?(B&=e-1,B+=e):B=0,E++,--$[m]==0){if(m===b)break;m=i[a+S[E]]}if(m>A&&(B&s)!==r){for(D===0&&(D=A),l+=y,O=m-D,P=1<<O;O+D<b&&(P-=$[O+D],!(P<=0));)O++,P<<=1;if(F+=1<<O,n===1&&F>852||n===2&&F>592)return 1;r=B&s,u[r]=A<<24|O<<16|l-_|0}}return B!==0&&(u[l+B]=m-D<<24|64<<16|0),C.bits=A,0};let{Z_FINISH:UF,Z_BLOCK:zD,Z_TREES:HD,Z_OK:im,Z_STREAM_END:QY,Z_NEED_DICT:ZY,Z_STREAM_ERROR:pf,Z_DATA_ERROR:jF,Z_MEM_ERROR:H1,Z_BUF_ERROR:VF,Z_DEFLATED:BF}=PD,ey=16180,am=16190,r0=16191,dj=16192,fd=16194,lA=16199,dA=16200,uj=16206,Ya=16209,uA=n=>(n>>>24&255)+(n>>>8&65280)+((65280&n)<<8)+((255&n)<<24);function WD(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}let Ll=n=>{if(!n)return 1;let i=n.state;return!i||i.strm!==n||i.mode<ey||i.mode>16211?1:0},YD=n=>{if(Ll(n))return pf;let i=n.state;return n.total_in=n.total_out=i.total=0,n.msg="",i.wrap&&(n.adler=1&i.wrap),i.mode=ey,i.last=0,i.havedict=0,i.flags=-1,i.dmax=32768,i.head=null,i.hold=0,i.bits=0,i.lencode=i.lendyn=new Int32Array(852),i.distcode=i.distdyn=new Int32Array(592),i.sane=1,i.back=-1,im},KD=n=>{if(Ll(n))return pf;let i=n.state;return i.wsize=0,i.whave=0,i.wnext=0,YD(n)},fA=(n,i)=>{let a;if(Ll(n))return pf;let c=n.state;return i<0?(a=0,i=-i):(a=5+(i>>4),i<48&&(i&=15)),i&&(i<8||i>15)?pf:(c.window!==null&&c.wbits!==i&&(c.window=null),c.wrap=a,c.wbits=i,KD(n))},hA=(n,i)=>{if(!n)return pf;let a=new WD;n.state=a,a.strm=n,a.window=null,a.mode=ey;let c=fA(n,i);return c!==im&&(n.state=null),c},pA,Va,fj=!0,$Y=n=>{if(fj){pA=new Int32Array(512),Va=new Int32Array(32);let i=0;for(;i<144;)n.lens[i++]=8;for(;i<256;)n.lens[i++]=9;for(;i<280;)n.lens[i++]=7;for(;i<288;)n.lens[i++]=8;for(cA(1,n.lens,0,288,pA,0,n.work,{bits:9}),i=0;i<32;)n.lens[i++]=5;cA(2,n.lens,0,32,Va,0,n.work,{bits:5}),fj=!1}n.lencode=pA,n.lenbits=9,n.distcode=Va,n.distbits=5},iE=(n,i,a,c)=>{let u,_=n.state;return _.window===null&&(_.wsize=1<<_.wbits,_.wnext=0,_.whave=0,_.window=new Uint8Array(_.wsize)),c>=_.wsize?(_.window.set(i.subarray(a-_.wsize,a),0),_.wnext=0,_.whave=_.wsize):(u=_.wsize-_.wnext,u>c&&(u=c),_.window.set(i.subarray(a-c,a-c+u),_.wnext),(c-=u)?(_.window.set(i.subarray(a-c,a),0),_.wnext=c,_.whave=_.wsize):(_.wnext+=u,_.wnext===_.wsize&&(_.wnext=0),_.whave<_.wsize&&(_.whave+=u))),0};var FF=(n,i)=>{let a,c,u,_,S,C,R,e,t,r,s,l,f,m,E,y,b,A,O,D,P,F,B=0,Y=new Uint8Array(4),$,ee,Ee=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Ll(n)||!n.output||!n.input&&n.avail_in!==0)return pf;a=n.state,a.mode===r0&&(a.mode=dj),S=n.next_out,u=n.output,R=n.avail_out,_=n.next_in,c=n.input,C=n.avail_in,e=a.hold,t=a.bits,r=C,s=R,F=im;e:for(;;)switch(a.mode){case ey:if(a.wrap===0){a.mode=dj;break}for(;t<16;){if(C===0)break e;C--,e+=c[_++]<<t,t+=8}if(2&a.wrap&&e===35615){a.wbits===0&&(a.wbits=15),a.check=0,Y[0]=255&e,Y[1]=e>>>8&255,a.check=Oo(a.check,Y,2,0),e=0,t=0,a.mode=16181;break}if(a.head&&(a.head.done=!1),!(1&a.wrap)||(((255&e)<<8)+(e>>8))%31){n.msg="incorrect header check",a.mode=Ya;break}if((15&e)!==BF){n.msg="unknown compression method",a.mode=Ya;break}if(e>>>=4,t-=4,P=8+(15&e),a.wbits===0&&(a.wbits=P),P>15||P>a.wbits){n.msg="invalid window size",a.mode=Ya;break}a.dmax=1<<a.wbits,a.flags=0,n.adler=a.check=1,a.mode=512&e?16189:r0,e=0,t=0;break;case 16181:for(;t<16;){if(C===0)break e;C--,e+=c[_++]<<t,t+=8}if(a.flags=e,(255&Ao(a))!==BF){n.msg="unknown compression method",a.mode=Ya;break}if(57344&Ao(a)){n.msg="unknown header flags set",a.mode=Ya;break}a.head&&(a.head.text=e>>8&1),512&Ao(a)&&4&a.wrap&&(Y[0]=255&e,Y[1]=e>>>8&255,a.check=Oo(a.check,Y,2,0)),e=0,t=0,a.mode=16182;case 16182:for(;t<32;){if(C===0)break e;C--,e+=c[_++]<<t,t+=8}a.head&&(a.head.time=e),512&Ao(a)&&4&a.wrap&&(Y[0]=255&e,Y[1]=e>>>8&255,Y[2]=e>>>16&255,Y[3]=e>>>24&255,a.check=Oo(a.check,Y,4,0)),e=0,t=0,a.mode=16183;case 16183:for(;t<16;){if(C===0)break e;C--,e+=c[_++]<<t,t+=8}a.head&&(a.head.xflags=255&e,a.head.os=e>>8),512&Ao(a)&&4&a.wrap&&(Y[0]=255&e,Y[1]=e>>>8&255,a.check=Oo(a.check,Y,2,0)),e=0,t=0,a.mode=16184;case 16184:if(1024&Ao(a)){for(;t<16;){if(C===0)break e;C--,e+=c[_++]<<t,t+=8}a.length=e,a.head&&(a.head.extra_len=e),512&Ao(a)&&4&a.wrap&&(Y[0]=255&e,Y[1]=e>>>8&255,a.check=Oo(a.check,Y,2,0)),e=0,t=0}else a.head&&(a.head.extra=null);a.mode=16185;case 16185:if(1024&Ao(a)&&(l=a.length,l>C&&(l=C),l&&(a.head&&(P=a.head.extra_len-a.length,a.head.extra||(a.head.extra=new Uint8Array(a.head.extra_len)),a.head.extra.set(c.subarray(_,_+l),P)),512&Ao(a)&&4&a.wrap&&(a.check=Oo(a.check,c,l,_)),C-=l,_+=l,a.length-=l),a.length))break e;a.length=0,a.mode=16186;case 16186:if(2048&Ao(a)){if(C===0)break e;l=0;do P=c[_+l++],a.head&&P&&a.length<65536&&(a.head.name+=String.fromCharCode(P));while(P&&l<C);if(512&Ao(a)&&4&a.wrap&&(a.check=Oo(a.check,c,l,_)),C-=l,_+=l,P)break e}else a.head&&(a.head.name=null);a.length=0,a.mode=16187;case 16187:if(4096&Ao(a)){if(C===0)break e;l=0;do P=c[_+l++],a.head&&P&&a.length<65536&&(a.head.comment+=String.fromCharCode(P));while(P&&l<C);if(512&Ao(a)&&4&a.wrap&&(a.check=Oo(a.check,c,l,_)),C-=l,_+=l,P)break e}else a.head&&(a.head.comment=null);a.mode=16188;case 16188:if(512&Ao(a)){for(;t<16;){if(C===0)break e;C--,e+=c[_++]<<t,t+=8}if(4&a.wrap&&e!==(65535&a.check)){n.msg="header crc mismatch",a.mode=Ya;break}e=0,t=0}a.head&&(a.head.hcrc=Ao(a)>>9&1,a.head.done=!0),n.adler=a.check=0,a.mode=r0;break;case 16189:for(;t<32;){if(C===0)break e;C--,e+=c[_++]<<t,t+=8}n.adler=a.check=uA(e),e=0,t=0,a.mode=am;case am:if(a.havedict===0)return n.next_out=S,n.avail_out=R,n.next_in=_,n.avail_in=C,a.hold=e,a.bits=t,ZY;n.adler=a.check=1,a.mode=r0;case r0:if(i===zD||i===HD)break e;case dj:if(a.last){e>>>=7&t,t-=7&t,a.mode=uj;break}for(;t<3;){if(C===0)break e;C--,e+=c[_++]<<t,t+=8}switch(a.last=1&e,e>>>=1,t-=1,3&e){case 0:a.mode=16193;break;case 1:if($Y(a),a.mode=lA,i===HD){e>>>=2,t-=2;break e}break;case 2:a.mode=16196;break;case 3:n.msg="invalid block type",a.mode=Ya}e>>>=2,t-=2;break;case 16193:for(e>>>=7&t,t-=7&t;t<32;){if(C===0)break e;C--,e+=c[_++]<<t,t+=8}if((65535&e)!=(e>>>16^65535)){n.msg="invalid stored block lengths",a.mode=Ya;break}if(a.length=65535&e,e=0,t=0,a.mode=fd,i===HD)break e;case fd:a.mode=16195;case 16195:if(l=a.length,l){if(l>C&&(l=C),l>R&&(l=R),l===0)break e;u.set(c.subarray(_,_+l),S),C-=l,_+=l,R-=l,S+=l,a.length-=l;break}a.mode=r0;break;case 16196:for(;t<14;){if(C===0)break e;C--,e+=c[_++]<<t,t+=8}if(a.nlen=257+(31&e),e>>>=5,t-=5,a.ndist=1+(31&e),e>>>=5,t-=5,a.ncode=4+(15&e),e>>>=4,t-=4,a.nlen>286||a.ndist>30){n.msg="too many length or distance symbols",a.mode=Ya;break}a.have=0,a.mode=16197;case 16197:for(;a.have<a.ncode;){for(;t<3;){if(C===0)break e;C--,e+=c[_++]<<t,t+=8}a.lens[Ee[a.have++]]=7&e,e>>>=3,t-=3}for(;a.have<19;)a.lens[Ee[a.have++]]=0;if(a.lencode=a.lendyn,a.lenbits=7,$={bits:a.lenbits},F=cA(0,a.lens,0,19,a.lencode,0,a.work,$),a.lenbits=$.bits,F){n.msg="invalid code lengths set",a.mode=Ya;break}a.have=0,a.mode=16198;case 16198:for(;a.have<a.nlen+a.ndist;){for(;B=a.lencode[e&(1<<a.lenbits)-1],E=B>>>24,y=B>>>16&255,b=65535&B,!(E<=t);){if(C===0)break e;C--,e+=c[_++]<<t,t+=8}if(b<16)e>>>=E,t-=E,a.lens[a.have++]=b;else{if(b===16){for(ee=E+2;t<ee;){if(C===0)break e;C--,e+=c[_++]<<t,t+=8}if(e>>>=E,t-=E,a.have===0){n.msg="invalid bit length repeat",a.mode=Ya;break}P=a.lens[a.have-1],l=3+(3&e),e>>>=2,t-=2}else if(b===17){for(ee=E+3;t<ee;){if(C===0)break e;C--,e+=c[_++]<<t,t+=8}e>>>=E,t-=E,P=0,l=3+(7&e),e>>>=3,t-=3}else{for(ee=E+7;t<ee;){if(C===0)break e;C--,e+=c[_++]<<t,t+=8}e>>>=E,t-=E,P=0,l=11+(127&e),e>>>=7,t-=7}if(a.have+l>a.nlen+a.ndist){n.msg="invalid bit length repeat",a.mode=Ya;break}for(;l--;)a.lens[a.have++]=P}}if(a.mode===Ya)break;if(a.lens[256]===0){n.msg="invalid code -- missing end-of-block",a.mode=Ya;break}if(a.lenbits=9,$={bits:a.lenbits},F=cA(1,a.lens,0,a.nlen,a.lencode,0,a.work,$),a.lenbits=$.bits,F){n.msg="invalid literal/lengths set",a.mode=Ya;break}if(a.distbits=6,a.distcode=a.distdyn,$={bits:a.distbits},F=cA(2,a.lens,a.nlen,a.ndist,a.distcode,0,a.work,$),a.distbits=$.bits,F){n.msg="invalid distances set",a.mode=Ya;break}if(a.mode=lA,i===HD)break e;case lA:a.mode=dA;case dA:if(C>=6&&R>=258){n.next_out=S,n.avail_out=R,n.next_in=_,n.avail_in=C,a.hold=e,a.bits=t,BD(n,s),S=n.next_out,u=n.output,R=n.avail_out,_=n.next_in,c=n.input,C=n.avail_in,e=a.hold,t=a.bits,a.mode===r0&&(a.back=-1);break}for(a.back=0;B=a.lencode[e&(1<<a.lenbits)-1],E=B>>>24,y=B>>>16&255,b=65535&B,!(E<=t);){if(C===0)break e;C--,e+=c[_++]<<t,t+=8}if(y&&!(240&y)){for(A=E,O=y,D=b;B=a.lencode[D+((e&(1<<A+O)-1)>>A)],E=B>>>24,y=B>>>16&255,b=65535&B,!(A+E<=t);){if(C===0)break e;C--,e+=c[_++]<<t,t+=8}e>>>=A,t-=A,a.back+=A}if(e>>>=E,t-=E,a.back+=E,a.length=b,y===0){a.mode=16205;break}if(32&y){a.back=-1,a.mode=r0;break}if(64&y){n.msg="invalid literal/length code",a.mode=Ya;break}a.extra=15&y,a.mode=16201;case 16201:if(a.extra){for(ee=a.extra;t<ee;){if(C===0)break e;C--,e+=c[_++]<<t,t+=8}a.length+=e&(1<<a.extra)-1,e>>>=a.extra,t-=a.extra,a.back+=a.extra}a.was=a.length,a.mode=16202;case 16202:for(;B=a.distcode[e&(1<<a.distbits)-1],E=B>>>24,y=B>>>16&255,b=65535&B,!(E<=t);){if(C===0)break e;C--,e+=c[_++]<<t,t+=8}if(!(240&y)){for(A=E,O=y,D=b;B=a.distcode[D+((e&(1<<A+O)-1)>>A)],E=B>>>24,y=B>>>16&255,b=65535&B,!(A+E<=t);){if(C===0)break e;C--,e+=c[_++]<<t,t+=8}e>>>=A,t-=A,a.back+=A}if(e>>>=E,t-=E,a.back+=E,64&y){n.msg="invalid distance code",a.mode=Ya;break}a.offset=b,a.extra=15&y,a.mode=16203;case 16203:if(a.extra){for(ee=a.extra;t<ee;){if(C===0)break e;C--,e+=c[_++]<<t,t+=8}a.offset+=e&(1<<a.extra)-1,e>>>=a.extra,t-=a.extra,a.back+=a.extra}if(a.offset>a.dmax){n.msg="invalid distance too far back",a.mode=Ya;break}a.mode=16204;case 16204:if(R===0)break e;if(l=s-R,a.offset>l){if(l=a.offset-l,l>a.whave&&a.sane){n.msg="invalid distance too far back",a.mode=Ya;break}l>a.wnext?(l-=a.wnext,f=a.wsize-l):f=a.wnext-l,l>a.length&&(l=a.length),m=a.window}else m=u,f=S-a.offset,l=a.length;l>R&&(l=R),R-=l,a.length-=l;do u[S++]=m[f++];while(--l);a.length===0&&(a.mode=dA);break;case 16205:if(R===0)break e;u[S++]=a.length,R--,a.mode=dA;break;case uj:if(a.wrap){for(;t<32;){if(C===0)break e;C--,e|=c[_++]<<t,t+=8}if(s-=R,n.total_out+=s,a.total+=s,4&a.wrap&&s&&(n.adler=a.check=Ao(a)?Oo(a.check,u,s,S-s):j1(a.check,u,s,S-s)),s=R,4&a.wrap&&(Ao(a)?e:uA(e))!==a.check){n.msg="incorrect data check",a.mode=Ya;break}e=0,t=0}a.mode=16207;case 16207:if(a.wrap&&Ao(a)){for(;t<32;){if(C===0)break e;C--,e+=c[_++]<<t,t+=8}if(4&a.wrap&&e!==(4294967295&a.total)){n.msg="incorrect length check",a.mode=Ya;break}e=0,t=0}a.mode=16208;case 16208:F=QY;break e;case Ya:F=jF;break e;case 16210:return H1;default:return pf}return n.next_out=S,n.avail_out=R,n.next_in=_,n.avail_in=C,a.hold=e,a.bits=t,(a.wsize||s!==n.avail_out&&a.mode<Ya&&(a.mode<uj||i!==UF))&&iE(n,n.output,n.next_out,s-n.avail_out),r-=n.avail_in,s-=n.avail_out,n.total_in+=r,n.total_out+=s,a.total+=s,4&a.wrap&&s&&(n.adler=a.check=Ao(a)?Oo(a.check,u,s,n.next_out-s):j1(a.check,u,s,n.next_out-s)),n.data_type=a.bits+(a.last?64:0)+(a.mode===r0?128:0)+(a.mode===lA||a.mode===fd?256:0),(r===0&&s===0||i===UF)&&F===im&&(F=VF),F},sm={inflateReset:KD,inflateReset2:fA,inflateResetKeep:YD,inflateInit:n=>hA(n,15),inflateInit2:hA,inflate:FF,inflateEnd:n=>{if(Ll(n))return pf;let i=n.state;return i.window&&(i.window=null),n.state=null,im},inflateGetHeader:(n,i)=>{if(Ll(n))return pf;let a=n.state;return 2&a.wrap?(a.head=i,i.done=!1,im):pf},inflateSetDictionary:(n,i)=>{let a=i.length,c,u,_;return Ll(n)?pf:(c=n.state,c.wrap!==0&&c.mode!==am?pf:c.mode===am&&(u=1,u=j1(u,i,a,0),u!==c.check)?jF:(_=iE(n,i,a,a),_?(c.mode=16210,H1):(c.havedict=1,im)))},inflateInfo:"pako inflate (from Nodeca project)"},GF=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};let hj=Object.prototype.toString,{Z_NO_FLUSH:pj,Z_FINISH:mj,Z_OK:W1,Z_STREAM_END:gj,Z_NEED_DICT:qD,Z_STREAM_ERROR:eK,Z_DATA_ERROR:om,Z_MEM_ERROR:tK}=PD;function mA(n){this.options=xD.assign({chunkSize:65536,windowBits:15,to:""},n||{});let i=this.options;i.raw&&i.windowBits>=0&&i.windowBits<16&&(i.windowBits=-i.windowBits,i.windowBits===0&&(i.windowBits=-15)),!(i.windowBits>=0&&i.windowBits<16)||n&&n.windowBits||(i.windowBits+=32),i.windowBits>15&&i.windowBits<48&&!(15&i.windowBits)&&(i.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new lj,this.strm.avail_out=0;let a=sm.inflateInit2(this.strm,i.windowBits);if(a!==W1)throw new Error(eE[a]);if(this.header=new GF,sm.inflateGetHeader(this.strm,this.header),i.dictionary&&(typeof i.dictionary=="string"?i.dictionary=z1.string2buf(i.dictionary):hj.call(i.dictionary)==="[object ArrayBuffer]"&&(i.dictionary=new Uint8Array(i.dictionary)),i.raw&&(a=sm.inflateSetDictionary(this.strm,i.dictionary),a!==W1)))throw new Error(eE[a])}function nK(n,i){let a=new mA(i);if(a.push(n),a.err)throw a.msg||eE[a.err];return a.result}mA.prototype.push=function(n,i){let a=this.strm,c=this.options.chunkSize,u=this.options.dictionary,_,S,C;if(this.ended)return!1;for(S=i===~~i?i:i===!0?mj:pj,hj.call(n)==="[object ArrayBuffer]"?a.input=new Uint8Array(n):a.input=n,a.next_in=0,a.avail_in=a.input.length;;){for(a.avail_out===0&&(a.output=new Uint8Array(c),a.next_out=0,a.avail_out=c),_=sm.inflate(a,S),_===qD&&u&&(_=sm.inflateSetDictionary(a,u),_===W1?_=sm.inflate(a,S):_===om&&(_=qD));a.avail_in>0&&_===gj&&a.state.wrap>0&&n[a.next_in]!==0;)sm.inflateReset(a),_=sm.inflate(a,S);switch(_){case eK:case om:case qD:case tK:return this.onEnd(_),this.ended=!0,!1}if(C=a.avail_out,a.next_out&&(a.avail_out===0||_===gj))if(this.options.to==="string"){let R=z1.utf8border(a.output,a.next_out),e=a.next_out-R,t=z1.buf2string(a.output,R);a.next_out=e,a.avail_out=c-e,e&&a.output.set(a.output.subarray(R,R+e),0),this.onData(t)}else this.onData(a.output.length===a.next_out?a.output:a.output.subarray(0,a.next_out));if(_!==W1||C!==0){if(_===gj)return _=sm.inflateEnd(this.strm),this.onEnd(_),this.ended=!0,!0;if(a.avail_in===0)break}}return!0},mA.prototype.onData=function(n){this.chunks.push(n)},mA.prototype.onEnd=function(n){n===W1&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=xD.flattenChunks(this.chunks)),this.chunks=[],this.err=n,this.msg=this.strm.msg};var rK={inflate:nK};let{deflate:gA}=KY,{inflate:_j}=rK;var Ej=gA,iK=_j,vj=function(n){return n[n.ONE_BYTE=0]="ONE_BYTE",n[n.TWO_BYTE=1]="TWO_BYTE",n}(vj||{});class aK{constructor(){re(this,"_sequence",0),re(this,"_startTime",Date.now()),re(this,"isUseOneByte",!0)}get startTime(){let i=Date.now()-this._startTime;return i<Math.pow(2,16)?i:(this._startTime+=Math.pow(2,16),this.startTime)}get sequence(){return this._sequence<Math.pow(2,32)?this._sequence++:(this._sequence-=Math.pow(2,32),this.sequence)}serialize(i){let a={commonPacketHeader:{length:0,reserved:0,extension:0,sequence:this.sequence},commonStreamHeader:this.startTime,extension:void 0,payload:i};if(i.byteLength>128){let C=new Uint8Array(4);C.set([1,0,0,0]);let R={id:0,length:4,data:C.buffer},e={profile:this.isUseOneByte?0:1,length:this.isUseOneByte?5:6,datas:[R]};a.commonPacketHeader.extension=1,a.extension=e,a.payload=this.compress(i),a.commonPacketHeader.length=8+(a.extension.length+2)+a.payload.byteLength}else a.commonPacketHeader.length=8+a.payload.byteLength;ge("SHOW_DATASTREAM2_LOG")&&z.debug("send data header: ".concat(JSON.stringify(a.commonPacketHeader)));let c=new ArrayBuffer(a.commonPacketHeader.length),u=new Uint8Array(c),_=new DataView(c),S=0;if(_.setUint16(S,a.commonPacketHeader.extension<<15|a.commonPacketHeader.reserved<<14|a.commonPacketHeader.length,!0),S+=2,_.setUint32(S,a.commonPacketHeader.sequence,!0),S+=4,_.setUint16(S,a.commonStreamHeader,!0),S+=2,a.extension){let C=this.serializeExtension(a.extension);u.set(new Uint8Array(C),S),S+=C.byteLength}if(u.set(new Uint8Array(a.payload),S),S+=a.payload.byteLength,S!==a.commonPacketHeader.length)throw Error("serialize error!");return c}deserialize(i){if(i.byteLength<4)return new ArrayBuffer(0);let a=new DataView(i),c=0,u=a.getUint16(c,!0);c+=2;let _={length:16383&u,reserved:(16384&u)>>14,extension:(32768&u)>>15,sequence:a.getUint16(c+2,!0)<<16|a.getUint16(c,!0)},S,C;if(c+=4,ge("SHOW_DATASTREAM2_LOG")&&z.debug("receive data header: ".concat(JSON.stringify(_))),a.getUint16(c,!0),c+=2,_.extension){C=this.deserializeExtension(i.slice(c)),c+=2+C.length,S=i.slice(c);let R=!1;if(C.datas.length>0){let e=C.datas.find(t=>t.id===0);e&&(R=(1&new DataView(e.data).getUint32(0,!0))==1)}S=R?this.decompress(S):S}else S=i.slice(8);return S}serializeExtension(i){let{profile:a,length:c,datas:u}=i,_=new ArrayBuffer(c+2),S=new Uint8Array(_),C=new DataView(_),R=0;if(C.setUint8(R++,a),C.setUint8(R++,c),u.forEach(e=>{a?(C.setUint8(R++,e.id),C.setUint8(R++,e.length),S.set(new Uint8Array(e.data),R),R+=e.data.byteLength):(C.setUint8(R++,e.id|e.length<<4),S.set(new Uint8Array(e.data),R),R+=e.data.byteLength)}),R!==c+2)throw Error("serialize extension error, is ".concat(R,"!==").concat(c+2));return _}deserializeExtension(i){let a=new DataView(i),c=0,u=a.getUint8(c);c++;let _=a.getUint8(c);c++;let S=u===vj.TWO_BYTE,C=[],R=new DataView(i,2),e=0;for(;e<_;){let t=0,r=0,s=new ArrayBuffer(0);S?(t=R.getUint8(e),e++,r=R.getUint8(e),e++):(t=15&R.getUint8(e),r=R.getUint8(e)>>4,e++),r>0&&(s=R.buffer.slice(e+2,e+2+r),e+=s.byteLength),C.push({id:t,length:r,data:s})}if(e!==_)throw Error("parse error");return{profile:u,length:_,datas:C}}decompress(i){return iK(new Uint8Array(i))}compress(i){return Ej(new Uint8Array(i))}}let JD={name:"DataStream",create:(n,i)=>{let a=i?new A8(n):new O8(n);return a.useDataStream(new aK),a}};class sK extends li{constructor(i,a,c){super(),re(this,"ws",void 0),re(this,"requestId",1),re(this,"heartBeatTimer",void 0),re(this,"joinInfo",void 0),re(this,"clientId",void 0),re(this,"onOpen",()=>{this.emit("open"),this.startHeartBeatCheck()}),re(this,"onClose",u=>{this.emit("close"),this.dispose()}),re(this,"onMessage",u=>{let _=JSON.parse(u.data);if(!_||_.command!=="serverResponse"||!_.requestId)return _&&_.command==="serverStatus"&&_.serverStatus&&_.serverStatus.command?(this.emit("status",_.serverStatus),void this.emit(_.serverStatus.command,_.serverStatus)):void 0;this.emit("req_".concat(_.requestId),_)}),this.joinInfo=i,this.clientId=a,this.ws=new qp("cross-channel-".concat(this.clientId),c),this.ws.on(mn.RECONNECTING,()=>{this.ws.reconnectMode="retry",this.emit("reconnecting")}),this.ws.on(mn.CONNECTED,this.onOpen),this.ws.on(mn.ON_MESSAGE,this.onMessage),this.ws.on(mn.CLOSED,this.onClose)}isConnect(){return this.ws.state==="connected"}sendMessage(i){let a=this.requestId++;return i.requestId=a,i.seq=a,this.ws.sendMessage(i),a}waitStatus(i){return new Et((a,c)=>{let u=window.setTimeout(()=>{c(new De(oe.TIMEOUT,"wait status timeout, status: ".concat(i)))},5e3);this.once(i,_=>{window.clearTimeout(u),_.state&&_.state!==0?c(new De(oe.CROSS_CHANNEL_WAIT_STATUS_ERROR,"wait status error, status: ".concat(i))):a(void 0)}),this.once("dispose",()=>{window.clearTimeout(u),c(new De(oe.WS_ABORT))})})}async request(i){if(this.ws.state==="closed")throw new De(oe.WS_DISCONNECT);let a=()=>new Et((S,C)=>{this.ws.once(mn.CLOSED,()=>C(new De(oe.WS_ABORT))),this.ws.once(mn.CONNECTED,S)});this.ws.state!=="connected"&&await a();let c=this.sendMessage(i),u=new Et((S,C)=>{let R=()=>{C(new De(oe.WS_ABORT))};this.ws.once(mn.RECONNECTING,R),this.ws.once(mn.CLOSED,R),this.once("req_".concat(c),S),Mn(3e3).then(()=>{this.removeAllListeners("req_".concat(c)),this.ws.off(mn.RECONNECTING,R),this.ws.off(mn.CLOSED,R),C(new De(oe.TIMEOUT,"cross channel ws request timeout"))})}),_=await u;if(!_||_.code!==200)throw new De(oe.CROSS_CHANNEL_SERVER_ERROR_RESPONSE,"response: ".concat(JSON.stringify(_)));return _}async connect(i){this.ws.removeAllListeners(mn.REQUEST_NEW_URLS),this.ws.on(mn.REQUEST_NEW_URLS,a=>{a(i)}),await this.ws.init(i)}dispose(){this.clearHeartBeatCheck(),this.emit("dispose"),this.removeAllListeners(),this.ws.close()}sendPing(i){let a=this.requestId++;return i.requestId=a,this.ws.sendMessage(i),a}startHeartBeatCheck(){this.heartBeatTimer&&window.clearInterval(this.heartBeatTimer),this.heartBeatTimer=window.setInterval(()=>{this.sendPing({command:"ping",appId:this.joinInfo.appId,cname:this.joinInfo.cname,uid:this.joinInfo.uid.toString(),sid:this.joinInfo.sid,ts:+new Date,requestId:0})},3e3)}clearHeartBeatCheck(){window.clearInterval(this.heartBeatTimer),this.heartBeatTimer=void 0}}class oK extends li{set state(i){i!==this._state&&(i!==Vi.RELAY_STATE_FAILURE&&(this.errorCode=hn.RELAY_OK),this.emit("state",i,this.errorCode),this._state=i)}get state(){return this._state}constructor(i,a,c,u,_){super(),re(this,"joinInfo",void 0),re(this,"sid",void 0),re(this,"clientId",void 0),re(this,"cancelToken",eo.CancelToken.source()),re(this,"workerToken",void 0),re(this,"requestId",0),re(this,"signal",void 0),re(this,"prevChannelMediaConfig",void 0),re(this,"httpRetryConfig",void 0),re(this,"_resolution",void 0),re(this,"_state",Vi.RELAY_STATE_IDLE),re(this,"errorCode",hn.RELAY_OK),re(this,"onStatus",S=>{z.debug("[".concat(this.clientId,"] ChannelMediaStatus: ").concat(JSON.stringify(S))),S&&S.command&&(S.command==="onAudioPacketReceived"&&this.emit("event",yn.PACKET_RECEIVED_AUDIO_FROM_SRC),S.command==="onVideoPacketReceived"&&this.emit("event",yn.PACKET_RECEIVED_VIDEO_FROM_SRC),S.command==="onSrcTokenPrivilegeDidExpire"&&(this.errorCode=hn.SRC_TOKEN_EXPIRED,this.state=Vi.RELAY_STATE_FAILURE),S.command==="onDestTokenPrivilegeDidExpire"&&(this.errorCode=hn.DEST_TOKEN_EXPIRED,this.state=Vi.RELAY_STATE_FAILURE))}),re(this,"onReconnect",async()=>{z.debug("[".concat(this.clientId,"] ChannelMediaSocket disconnect, reconnecting")),this.emit("event",yn.NETWORK_DISCONNECTED),this.state=Vi.RELAY_STATE_IDLE,this.prevChannelMediaConfig&&this.sendStartRelayMessage(this.prevChannelMediaConfig).catch(S=>{this.state!==Vi.RELAY_STATE_IDLE&&(z.error("auto restart channel media relay failed",S.toString()),this.errorCode=hn.SERVER_CONNECTION_LOST,this.state=Vi.RELAY_STATE_FAILURE)})}),this.joinInfo=i,this.clientId=a,this.sid=D_(),this.signal=new sK(this.joinInfo,this.clientId,c),this.httpRetryConfig=u,this._resolution=_}async startChannelMediaRelay(i){if(this.state!==Vi.RELAY_STATE_IDLE)throw new De(oe.INVALID_OPERATION);this.state=Vi.RELAY_STATE_CONNECTING,await this.connect(),z.debug("[".concat(this.clientId,"] startChannelMediaRelay: connect success"));try{await this.sendStartRelayMessage(i)}catch(a){throw a.data&&a.data.serverResponse&&a.data.serverResponse.command==="SetSourceChannel"?new De(oe.CROSS_CHANNEL_FAILED_JOIN_SRC):a.data&&a.data.serverResponse&&a.serverResponse.command==="SetDestChannelStatus"?new De(oe.CROSS_CHANNEL_FAILED_JOIN_DEST):a.data&&a.data.serverResponse&&a.serverResponse.command==="StartPacketTransfer"?new De(oe.CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST):a}this.prevChannelMediaConfig=i}async updateChannelMediaRelay(i){if(this.state!==Vi.RELAY_STATE_RUNNING)throw new De(oe.INVALID_OPERATION);await this.sendUpdateMessage(i),this.prevChannelMediaConfig=i}async setVideoProfile(i){if(this._resolution=i,this.state!==Vi.RELAY_STATE_RUNNING)throw new De(oe.INVALID_OPERATION);let a=this.genMessage(bs.SetVideoProfile);await this.signal.request(a),z.debug("[".concat(this.clientId,"] startChannelMediaRelay: setVideoProfile success"))}async stopChannelMediaRelay(){await this.sendStopRelayMessage(),z.debug("[".concat(this.clientId,"] stopChannelMediaRelay: send stop message success")),this.state=Vi.RELAY_STATE_IDLE,this.dispose()}dispose(){z.debug("[".concat(this.clientId,"] disposeChannelMediaRelay")),this.cancelToken.cancel(),this.cancelToken=eo.CancelToken.source(),this.state=Vi.RELAY_STATE_IDLE,this.emit("dispose"),this.signal.dispose(),this.prevChannelMediaConfig=void 0}async connect(){let i=await xU(this.joinInfo,this.cancelToken.token,this.httpRetryConfig);this.workerToken=i.workerToken,await this.signal.connect(i.addressList),this.emit("event",yn.NETWORK_CONNECTED),this.signal.on("status",this.onStatus),this.signal.on("reconnecting",this.onReconnect)}async sendStartRelayMessage(i){let a=this.genMessage(bs.StopPacketTransfer);await this.signal.request(a),await this.signal.waitStatus("Normal Quit"),z.debug("[".concat(this.clientId,"] startChannelMediaRelay: StopPacketTransfer success"));let c=this.genMessage(bs.SetSdkProfile,i);await this.signal.request(c),z.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSdkProfile success"));let u=this.genMessage(bs.SetSourceChannel,i);await this.signal.request(u),await this.signal.waitStatus("SetSourceChannelStatus"),this.emit("event",yn.PACKET_JOINED_SRC_CHANNEL),z.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSourceChannel success"));let _=this.genMessage(bs.SetSourceUserId,i);await this.signal.request(_),z.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSourceUserId success"));let S=this.genMessage(bs.SetDestChannel,i);await this.signal.request(S),await this.signal.waitStatus("SetDestChannelStatus"),this.emit("event",yn.PACKET_JOINED_DEST_CHANNEL),z.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetDestChannel success"));let C=this.genMessage(bs.StartPacketTransfer,i);await this.signal.request(C),this.emit("event",yn.PACKET_SENT_TO_DEST_CHANNEL),this.state=Vi.RELAY_STATE_RUNNING,z.debug("[".concat(this.clientId,"] startChannelMediaRelay: StartPacketTransfer success")),this.setVideoProfile(this._resolution)}async sendUpdateMessage(i){let a=this.genMessage(bs.UpdateDestChannel,i);await this.signal.request(a),this.emit("event",yn.PACKET_UPDATE_DEST_CHANNEL),z.debug("[".concat(this.clientId,"] sendUpdateMessage: UpdateDestChannel success"))}async sendStopRelayMessage(){let i=this.genMessage(bs.StopPacketTransfer);await this.signal.request(i),z.debug("[".concat(this.clientId,"] sendStopRelayMessage: StopPacketTransfer success"))}genMessage(i,a){let c=[],u=[],_=[];this.requestId+=1;let S={appId:this.joinInfo.appId,cname:this.joinInfo.cname,uid:this.joinInfo.uid.toString(),sdkVersion:Zd,sid:this.sid,ts:Date.now(),requestId:this.requestId,seq:this.requestId,allocate:!0,clientRequest:{}};S.sdkVersion==="4.23.2"&&(S.sdkVersion="0.0.1");let C=null,R=null;switch(i){case bs.SetSdkProfile:return S.clientRequest={command:"SetSdkProfile",type:"multi_channel"},S;case bs.SetSourceChannel:if(R=a&&a.getSrcChannelMediaInfo(),!R)throw new De(oe.UNEXPECTED_ERROR,"can not find source config");return S.clientRequest={command:"SetSourceChannel",uid:"0",channelName:R.channelName,token:R.token||this.joinInfo.appId},S;case bs.SetSourceUserId:if(R=a&&a.getSrcChannelMediaInfo(),!R)throw new De(oe.UNEXPECTED_ERROR,"can not find source config");return S.clientRequest={command:"SetSourceUserId",uid:R.uid+""},S;case bs.SetDestChannel:if(C=a&&a.getDestChannelMediaInfo(),!C)throw new De(oe.UNEXPECTED_ERROR,"can not find dest config");return C.forEach(e=>{c.push(e.channelName),u.push(e.uid+""),_.push(e.token||this.joinInfo.appId)}),S.clientRequest={command:"SetDestChannel",channelName:c,uid:u,token:_},S;case bs.StartPacketTransfer:return S.clientRequest={command:"StartPacketTransfer"},S;case bs.Reconnect:return S.clientRequest={command:"Reconnect"},S;case bs.StopPacketTransfer:return S.clientRequest={command:"StopPacketTransfer"},S;case bs.UpdateDestChannel:if(C=a&&a.getDestChannelMediaInfo(),!C)throw new De(oe.UNEXPECTED_ERROR,"can not find dest config");return C.forEach(e=>{c.push(e.channelName),u.push(e.uid+""),_.push(e.token||this.joinInfo.appId)}),S.clientRequest={command:"UpdateDestChannel",channelName:c,uid:u,token:_},S;case bs.SetVideoProfile:S.clientRequest={command:"SetVideoProfile",width:this._resolution.width,height:this._resolution.height}}return S}}let cK={name:"ChannelMediaRelay",create:function(n){return new oK(n.joinInfo,n.clientId,n.websocketRetryConfig||da,n.httpRetryConfig||da,n.resolution)}};function zF(n,i){var a=Object.keys(n);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(n);i&&(c=c.filter(function(u){return Object.getOwnPropertyDescriptor(n,u).enumerable})),a.push.apply(a,c)}return a}function _A(n){for(var i=1;i<arguments.length;i++){var a=arguments[i]!=null?arguments[i]:{};i%2?zF(Object(a),!0).forEach(function(c){re(n,c,a[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(a)):zF(Object(a)).forEach(function(c){Object.defineProperty(n,c,Object.getOwnPropertyDescriptor(a,c))})}return n}class lK extends li{constructor(i,a,c,u){super(),re(this,"spec",void 0),re(this,"token",void 0),re(this,"websocket",void 0),re(this,"pingpongTimer",void 0),re(this,"reconnectMode","retry"),re(this,"serviceMode",void 0),re(this,"reqId",0),re(this,"commandReqId",0),re(this,"handleWebSocketOpen",()=>{this.reconnectMode="retry",this.startPingPong()}),re(this,"handleWebSocketMessage",_=>{if(!_.data)return;let S=JSON.parse(_.data);S.requestId?this.emit("@".concat(S.requestId,"-").concat(S.sid),S):(jt.workerEvent(this.spec.sid,{actionType:"status",serverCode:S.code,workerType:this.serviceMode===Ot.TRANSCODE?1:2}),this.emit(Wt.PUBLISH_STREAM_STATUS,S))}),this.spec=a,this.token=i,this.serviceMode=u,this.websocket=new qp("live-streaming",c),this.websocket.on(mn.CONNECTED,this.handleWebSocketOpen),this.websocket.on(mn.ON_MESSAGE,this.handleWebSocketMessage),this.websocket.on(mn.REQUEST_NEW_URLS,(_,S)=>{Bn(this,Wt.REQUEST_NEW_ADDRESS).then(_).catch(S)}),this.websocket.on(mn.RECONNECTING,()=>{this.websocket.reconnectMode=this.reconnectMode})}init(i){return this.websocket.init(i)}async request(i,a,c,u){this.reqId+=1,i==="request"&&(this.commandReqId+=1);let _=this.commandReqId,S=this.reqId;if(!S||!this.websocket)throw new De(oe.UNEXPECTED_ERROR);let C=_A({command:i,sdkVersion:Zd==="4.23.2"?"0.0.1":Zd,seq:S,requestId:S,allocate:c,cname:this.spec.cname,appId:this.spec.appId,sid:this.spec.sid,uid:this.spec.uid.toString(),ts:Math.floor(Date.now()/1e3)},a);if(this.websocket.state==="closed")throw new De(oe.WS_DISCONNECT);let R=()=>new Et((s,l)=>{this.websocket.once(mn.CLOSED,()=>l(new De(oe.WS_ABORT))),this.websocket.once(mn.CONNECTED,s)});this.websocket.state!=="connected"&&await R(),C.clientRequest&&(C.clientRequest.workerToken=this.token);let e=new Et((s,l)=>{let f=()=>{l(new De(oe.WS_ABORT))};this.websocket.once(mn.RECONNECTING,f),this.websocket.once(mn.CLOSED,f),this.once("@".concat(S,"-").concat(this.spec.sid),m=>{s(m)})});u&&jt.workerEvent(this.spec.sid,_A(_A({},u),{},{requestId:_,actionType:"request",payload:JSON.stringify(a.clientRequest),serverCode:0,code:0}));let t=Date.now();this.websocket.sendMessage(C);let r=null;try{r=await e}catch(s){if(this.websocket.state==="closed")throw s;return await R(),await this.request(i,a,c)}return u&&jt.workerEvent(this.spec.sid,_A(_A({},u),{},{requestId:_,actionType:"response",payload:JSON.stringify(r.serverResponse),serverCode:r.code,success:r.code===200,responseTime:Date.now()-t})),r.code!==200&&this.handleResponseError(r),r}tryNextAddress(){this.reconnectMode="tryNext",this.websocket.reconnect("tryNext")}close(){let i=Zd==="4.23.2"?"0.0.1":Zd;this.reqId+=1,this.websocket.state==="connected"?(this.websocket.sendMessage({command:"request",appId:this.spec.appId,cname:this.spec.cname,uid:this.spec.uid.toString(),sdkVersion:i,sid:this.spec.sid,seq:this.reqId,ts:Math.floor(Date.now()/1e3),requestId:this.reqId,clientRequest:{command:"DestroyWorker"}}),this.websocket.close(!1,!0)):this.websocket.close(!1),this.pingpongTimer&&(window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0)}handleResponseError(i){switch(i.code){case Ft.LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM:return void z.warning("live stream response already exists stream");case Ft.LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR:case Ft.LIVE_STREAM_RESPONSE_BAD_STREAM:case Ft.LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR:return new De(oe.LIVE_STREAMING_INVALID_ARGUMENT,"",{code:i.code}).throw();case Ft.LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST:if(i.serverResponse.command==="UnpublishStream")return;throw new De(oe.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream response wm worker not exist",{retry:!0});case Ft.LIVE_STREAM_RESPONSE_NOT_AUTHORIZED:return new De(oe.LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED,"",{code:i.code}).throw();case Ft.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE:{let a=new De(oe.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE);return this.emit(Wt.WARNING,a,i.serverResponse.url)}case Ft.LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN:{let a=new De(oe.LIVE_STREAMING_WARN_FREQUENT_REQUEST);return this.emit(Wt.WARNING,a,i.serverResponse.url)}case Ft.LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH:throw new De(oe.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream response wm worker not exist",{retry:!0});case Ft.LIVE_STREAM_RESPONSE_NOT_SUPPORTED:return new De(oe.LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED,"",{code:i.code}).throw();case Ft.LIVE_STREAM_RESPONSE_MAX_STREAM_NUM:{let a=new De(oe.LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT);return this.emit(Wt.WARNING,a,i.serverResponse.url)}case Ft.LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR:return new De(oe.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"",{code:i.code}).throw();case Ft.LIVE_STREAM_RESPONSE_RESOURCE_LIMIT:throw new De(oe.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream resource limit",{retry:!0,changeAddress:!0});case Ft.LIVE_STREAM_RESPONSE_WORKER_LOST:case Ft.LIVE_STREAM_RESPONSE_WORKER_QUIT:if(i.serverResponse.command==="UnpublishStream")return;throw new De(oe.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{retry:!0,changeAddress:!0});case Ft.ERROR_FAIL_SEND_MESSAGE:if(i.serverResponse.command==="UnpublishStream")return;if(i.serverResponse.command==="UpdateTranscoding"||i.serverResponse.command==="ControlStream")return new De(oe.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{code:i.code}).throw();throw new De(oe.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{retry:!0,changeAddress:!0});case Ft.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN:case Ft.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT:case Ft.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE:case Ft.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH:return new De(oe.LIVE_STREAMING_CDN_ERROR,"",{code:i.code}).throw()}}startPingPong(){this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(()=>{this.websocket.state==="connected"&&this.request("ping",{}).catch(ph)},6e3)}}function Sj(n,i){var a=Object.keys(n);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(n);i&&(c=c.filter(function(u){return Object.getOwnPropertyDescriptor(n,u).enumerable})),a.push.apply(a,c)}return a}function Xc(n){for(var i=1;i<arguments.length;i++){var a=arguments[i]!=null?arguments[i]:{};i%2?Sj(Object(a),!0).forEach(function(c){re(n,c,a[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(a)):Sj(Object(a)).forEach(function(c){Object.defineProperty(n,c,Object.getOwnPropertyDescriptor(a,c))})}return n}class dK extends li{constructor(i){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:da,c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:da;super(),re(this,"onLiveStreamWarning",void 0),re(this,"onLiveStreamError",void 0),re(this,"spec",void 0),re(this,"retryTimeout",1e4),re(this,"connection",void 0),re(this,"httpRetryConfig",void 0),re(this,"wsRetryConfig",void 0),re(this,"streamingTasks",new Map),re(this,"isStartingStreamingTask",!1),re(this,"taskMutex",new Na("live-streaming")),re(this,"cancelToken",eo.CancelToken.source()),re(this,"transcodingConfig",void 0),re(this,"uapResponse",void 0),re(this,"lastTaskId",1),re(this,"statusError",new Map),this.spec=i,this.httpRetryConfig=c,this.wsRetryConfig=a}async setTranscodingConfig(i){let a=Xc(Xc({},Wo),i);a.videoCodecProfile!==66&&a.videoCodecProfile!==77&&a.videoCodecProfile!==100&&(z.debug("[".concat(this.spec.clientId,"] set transcoding config, fix video codec profile: ").concat(a.videoCodecProfile," -> 100")),a.videoCodecProfile=100),a.transcodingUsers||(a.transcodingUsers=a.userConfigs),a.transcodingUsers&&(a.transcodingUsers=a.transcodingUsers.map(S=>Xc(Xc(Xc({},QL),S),{},{zOrder:S.zOrder?S.zOrder+1:1}))),function(S){Bt(S.width)||Cr(S.width,"config.width",0,1e4),Bt(S.height)||Cr(S.height,"config.height",0,1e4),Bt(S.videoBitrate)||Cr(S.videoBitrate,"config.videoBitrate",1,1e6),Bt(S.videoFrameRate)||Cr(S.videoFrameRate,"config.videoFrameRate"),Bt(S.lowLatency)||Vp(S.lowLatency,"config.lowLatency"),Bt(S.audioSampleRate)||Ia(S.audioSampleRate,"config.audioSampleRate",[32e3,44100,48e3]),Bt(S.audioBitrate)||Cr(S.audioBitrate,"config.audioBitrate",1,128),Bt(S.audioChannels)||Ia(S.audioChannels,"config.audioChannels",[1,2,3,4,5]),Bt(S.videoGop)||Cr(S.videoGop,"config.videoGop"),Bt(S.videoCodecProfile)||Ia(S.videoCodecProfile,"config.videoCodecProfile",[66,77,100]),Bt(S.userCount)||Cr(S.userCount,"config.userCount",0,17),Bt(S.backgroundColor)||Cr(S.backgroundColor,"config.backgroundColor",0,16777215),Bt(S.userConfigExtraInfo)||Pa(S.userConfigExtraInfo,"config.userConfigExtraInfo",0,4096,!1),S.transcodingUsers&&!Bt(S.transcodingUsers)&&(Xd(S.transcodingUsers,"config.transcodingUsers"),S.transcodingUsers.forEach((C,R)=>{XL(C.uid),Bt(C.x)||Cr(C.x,"transcodingUser[".concat(R,"].x"),0,1e4),Bt(C.y)||Cr(C.y,"transcodingUser[".concat(R,"].y"),0,1e4),Bt(C.width)||Cr(C.width,"transcodingUser[".concat(R,"].width"),0,1e4),Bt(C.height)||Cr(C.height,"transcodingUser[".concat(R,"].height"),0,1e4),Bt(C.zOrder)||Cr(C.zOrder-1,"transcodingUser[".concat(R,"].zOrder"),0,100),Bt(C.alpha)||Cr(C.alpha,"transcodingUser[".concat(R,"].alpha"),0,1,!1)})),Bt(S.watermark)||id(S.watermark,"watermark"),Bt(S.backgroundImage)||id(S.backgroundImage,"backgroundImage"),S.images&&!Bt(S.images)&&(Xd(S.images,"config.images"),S.images.forEach((C,R)=>{id(C,"images[".concat(R,"]"))}))}(a);let c=[];a.images&&c.push(...a.images.map(S=>Xc(Xc(Xc({},CI),S),{},{zOrder:255}))),a.backgroundImage&&(c.push(Xc(Xc(Xc({},CI),a.backgroundImage),{},{zOrder:0})),delete a.backgroundImage),a.watermark&&(c.push(Xc(Xc(Xc({},CI),a.watermark),{},{zOrder:255})),delete a.watermark),a.images=c,a.transcodingUsers&&(a.userConfigs=a.transcodingUsers.map(S=>Xc({},S)),a.userCount=a.transcodingUsers.length,delete a.transcodingUsers);let u=(a.userConfigs||[]).map(S=>typeof S.uid=="number"?Et.resolve(S.uid):J8(S.uid,this.spec,this.cancelToken.token,this.httpRetryConfig));if((await Et.all(u)).forEach((S,C)=>{a.userConfigs&&a.userConfigs[C]&&(a.userConfigs[C].uid=S)}),this.transcodingConfig=a,this.connection)try{var _;let S=await this.connection.request("request",{clientRequest:{command:"UpdateTranscoding",transcodingConfig:this.transcodingConfig}},!1,{command:"UpdateTranscoding",workerType:1,requestByUser:!0,tid:Array.from(Pc(_=this.streamingTasks).call(_)).map(C=>C.taskId).join("#")});z.debug("[".concat(this.spec.clientId,"] update live transcoding config success, code: ").concat(S.code,", config:"),JSON.stringify(this.transcodingConfig))}catch(S){if(!S.data||!S.data.retry)throw S;S.data.changeAddress&&this.connection.tryNextAddress(),this.streamingTasks.forEach(C=>{z.warning("[".concat(this.spec.clientId,"] live streaming receive error"),S.toString(),"try to republish",C.url),this.startLiveStreamingTask(C.url,C.mode,S).then(()=>{z.debug("[".concat(this.spec.clientId,"] live streaming republish ").concat(C.url," success"))}).catch(R=>{z.error("[".concat(this.spec.clientId,"] live streaming republish failed"),C.url,R.toString()),this.onLiveStreamError&&this.onLiveStreamError(C.url,R)})})}}async startLiveStreamingTask(i,a,c){if(!this.transcodingConfig&&a===Ot.TRANSCODE)throw new De(oe.INVALID_OPERATION,"[LiveStreaming] no transcoding config found, can not start transcoding streaming task");let u={command:"PublishStream",ts:Date.now(),url:i,uid:this.spec.uid.toString(),autoDestroyTime:100,acceptImageTimeout:!0};z.debug("[".concat(this.spec.clientId,"] start live streaming ").concat(i,", mode: ").concat(a));let _=await this.taskMutex.lock();if(!this.connection&&c)return void _();if(this.streamingTasks.get(i)&&!c)return _(),new De(oe.LIVE_STREAMING_TASK_CONFLICT).throw();try{this.connection||(this.connection=await this.connect(a))}catch(C){throw _(),C}switch(a){case Ot.TRANSCODE:u.transcodingConfig=Xc({},this.transcodingConfig)}this.uapResponse&&this.uapResponse.vid&&(u.vid=this.uapResponse.vid),this.isStartingStreamingTask=!0;let S=this.lastTaskId++;try{let C=new Et((e,t)=>{Mn(this.retryTimeout).then(()=>{if(c)return t(c);let r=this.statusError.get(i);return r?(this.statusError.delete(i),t(r)):void 0})}),R=await Et.race([this.connection.request("request",{clientRequest:u},!0,{url:i,command:"PublishStream",workerType:a===Ot.TRANSCODE?1:2,requestByUser:!c,tid:S.toString()}),C]);this.isStartingStreamingTask=!1,z.debug("[".concat(this.spec.clientId,"] live streaming started, code: ").concat(R.code)),this.streamingTasks.set(i,{clientRequest:u,mode:a,url:i,taskId:S}),_()}catch(C){if(_(),this.isStartingStreamingTask=!1,!C.data||!C.data.retry||c)throw C;return C.data.changeAddress?(this.connection.tryNextAddress(),await this.startLiveStreamingTask(i,a,C)):await this.startLiveStreamingTask(i,a,C)}}stopLiveStreamingTask(i){return new Et((a,c)=>{let u=this.streamingTasks.get(i);if(!u||!this.connection)return new De(oe.UNEXPECTED_ERROR,"can not find streaming task to stop").throw();let _=u.mode;u.abortTask=()=>{z.debug("[".concat(this.spec.clientId,"] stop live streaming success(worker exception)")),this.streamingTasks.delete(i),a()},this.connection.request("request",{clientRequest:{command:"UnpublishStream",url:u.url}},!1,{url:i,command:"UnPublishStream",workerType:_===Ot.TRANSCODE?1:2,requestByUser:!0,tid:(this.lastTaskId++).toString()}).then(S=>{z.debug("[".concat(this.spec.clientId,"] stop live streaming success, code: ").concat(S.code)),this.streamingTasks.delete(i),this.streamingTasks.size===0&&(this.connection&&this.connection.close(),this.connection=void 0),a()}).catch(c)})}resetAllTask(){var i;let a=Array.from(Pc(i=this.streamingTasks).call(i));this.terminate();for(let c of a)this.startLiveStreamingTask(c.url,c.mode).catch(u=>{this.onLiveStreamError&&this.onLiveStreamError(c.url,u)})}terminate(){this.cancelToken&&this.cancelToken.cancel(),this.streamingTasks=new Map,this.isStartingStreamingTask=!1,this.statusError=new Map,this.cancelToken=eo.CancelToken.source(),this.uapResponse=void 0,this.connection&&this.connection.close(),this.connection=void 0}async connect(i){if(this.connection)throw new De(oe.UNEXPECTED_ERROR,"live streaming connection has already connected");let a=await Bn(this,Fr.REQUEST_WORKER_MANAGER_LIST,i);return this.uapResponse=a,this.connection=new lK(a.workerToken,this.spec,this.wsRetryConfig,i),this.connection.on(Wt.WARNING,(c,u)=>this.onLiveStreamWarning&&this.onLiveStreamWarning(u,c)),this.connection.on(Wt.PUBLISH_STREAM_STATUS,c=>this.handlePublishStreamServer(c)),this.connection.on(Wt.REQUEST_NEW_ADDRESS,(c,u)=>{if(!this.connection)return u(new De(oe.UNEXPECTED_ERROR,"can not get new live streaming address list"));Bn(this,Fr.REQUEST_WORKER_MANAGER_LIST,i).then(_=>{this.uapResponse=_,c(_.addressList)}).catch(u)}),await this.connection.init(a.addressList),this.connection}handlePublishStreamServer(i){let a=i.serverStatus&&i.serverStatus.url||"empty_url",c=this.streamingTasks.get(a),u=i.reason;switch(i.code){case Ft.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN:case Ft.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT:case Ft.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE:case Ft.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH:{let S=new De(oe.LIVE_STREAMING_CDN_ERROR,"",{code:i.code});if(c)return z.error(S.toString()),this.onLiveStreamError&&this.onLiveStreamError(a,S);if(!this.isStartingStreamingTask)return;this.statusError.set(a,S)}case Ft.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE:{let S=new De(oe.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE,u);return this.onLiveStreamWarning&&this.onLiveStreamWarning(a,S)}case Ft.LIVE_STREAM_RESPONSE_WORKER_LOST:case Ft.LIVE_STREAM_RESPONSE_WORKER_QUIT:{var _;if(!this.connection)return;this.connection.tryNextAddress();let S=Array.from(Pc(_=this.streamingTasks).call(_));for(let C of S)C.abortTask?C.abortTask():(z.warning("[".concat(this.spec.clientId,"] publish stream status code"),i.code,"try to republish",C.url),this.startLiveStreamingTask(C.url,C.mode,new De(oe.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"",{code:i.code})).then(()=>{z.debug("[".concat(this.spec.clientId,"] republish live stream success"),C.url)}).catch(R=>{z.error(R.toString()),this.onLiveStreamError&&this.onLiveStreamError(C.url,R)}));return}}}hasUrl(i){return this.streamingTasks.has(i)}}let uK={name:"LiveStreaming",create:function(n){return new dK(n.joinInfo,n.websocketRetryConfig||da,n.httpRetryConfig||da)}};function fK(n){let i=YF();return function(a,c){let u=a.appId;u!==void 0&&(vr(c,10),Dl(c,u));let _=a.cid;_!==void 0&&(vr(c,16),vr(c,_));let S=a.cname;S!==void 0&&(vr(c,26),Dl(c,S));let C=a.deviceId;C!==void 0&&(vr(c,34),Dl(c,C));let R=a.elapse;R!==void 0&&(vr(c,40),i0(c,R));let e=a.fileSize;e!==void 0&&(vr(c,48),i0(c,Y1(e)));let t=a.height;t!==void 0&&(vr(c,56),i0(c,Y1(t)));let r=a.jpg;r!==void 0&&(vr(c,66),vr(c,r.length),function(Ue,ve){let Ne=K1(Ue,ve.length);Ue.bytes.set(ve,Ne)}(c,r));let s=a.networkType;s!==void 0&&(vr(c,72),i0(c,Y1(s)));let l=a.osType;l!==void 0&&(vr(c,80),i0(c,Y1(l)));let f=a.requestId;f!==void 0&&(vr(c,90),Dl(c,f));let m=a.sdkVersion;m!==void 0&&(vr(c,98),Dl(c,m));let E=a.sequence;E!==void 0&&(vr(c,104),i0(c,Y1(E)));let y=a.sid;y!==void 0&&(vr(c,114),Dl(c,y));let b=a.timestamp;b!==void 0&&(vr(c,120),i0(c,b));let A=a.uid;A!==void 0&&(vr(c,128),vr(c,A));let O=a.vid;O!==void 0&&(vr(c,136),vr(c,O));let D=a.width;D!==void 0&&(vr(c,144),i0(c,Y1(D)));let P=a.service;P!==void 0&&(vr(c,152),vr(c,P));let F=a.callbackData;F!==void 0&&(vr(c,162),Dl(c,F));let B=a.jpgEncryption;B!==void 0&&(vr(c,168),vr(c,B));let Y=a.requestType;Y!==void 0&&(vr(c,176),vr(c,Y));let $=a.scorePorn;$!==void 0&&(vr(c,185),XD(c,$));let ee=a.scoreSexy;ee!==void 0&&(vr(c,193),XD(c,ee));let Ee=a.scoreNeutral;Ee!==void 0&&(vr(c,201),XD(c,Ee));let Re=a.scene;Re!==void 0&&(vr(c,208),vr(c,Re));let Ie=a.ossFilePrefix;Ie!==void 0&&(vr(c,218),Dl(c,Ie));let we=a.serviceVendor;if(we!==void 0)for(let Ue of we){vr(c,226);let ve=YF();EA(Ue,ve),vr(c,ve.limit),KF(c,ve),mK(ve)}}(n,i),function(a){let c=a.bytes,u=a.limit;return c.length===u?c:c.subarray(0,u)}(i)}function hK(n){return function(a){let c={};e:for(;!Cj(a);){let u=Pl(a);switch(u>>>3){case 0:break e;case 1:c.code=Pl(a);break;case 2:c.msg=gc(a,Pl(a));break;case 3:{let _=pK(a);c.data=HF(a),a.limit=_;break}default:yj(a,7&u)}}return c}({bytes:i=n,offset:0,limit:i.length});var i}function HF(n){let i={};e:for(;!Cj(n);){let a=Pl(n);switch(a>>>3){case 0:break e;case 1:i.requestId=gc(n,Pl(n));break;case 2:i.requestType=Pl(n)>>>0;break;case 3:i.scorePorn=SA(n);break;case 4:i.scoreSexy=SA(n);break;case 5:i.scoreNeutral=SA(n);break;case 6:i.requestScene=Pl(n)>>>0;break;case 7:i.scene=Pl(n)>>>0;break;default:yj(n,7&a)}}return i}function EA(n,i){let a=n.service;a!==void 0&&(vr(i,8),vr(i,a));let c=n.vendor;c!==void 0&&(vr(i,16),vr(i,c));let u=n.token;u!==void 0&&(vr(i,26),Dl(i,u));let _=n.callbackUrl;_!==void 0&&(vr(i,34),Dl(i,_))}function pK(n){let i=Pl(n),a=n.limit;return n.limit=n.offset+i,a}function yj(n,i){switch(i){case 0:for(;128&wj(n););break;case 2:bj(n,Pl(n));break;case 5:bj(n,4);break;case 1:bj(n,8);break;default:throw new Error("Unimplemented type: "+i)}}let Qc=new Float32Array(1);new Uint8Array(Qc.buffer);let Tj=new Float64Array(1),Zc=new Uint8Array(Tj.buffer);function Y1(n){return{low:n|=0,high:n>>31,unsigned:n>=0}}let WF=[];function YF(){let n=WF.pop();return n?(n.offset=n.limit=0,n):{bytes:new Uint8Array(64),offset:0,limit:0}}function mK(n){WF.push(n)}function bj(n,i){if(n.offset+i>n.limit)throw new Error("Skip past limit");n.offset+=i}function Cj(n){return n.offset>=n.limit}function K1(n,i){let a=n.bytes,c=n.offset,u=n.limit,_=c+i;if(_>a.length){let S=new Uint8Array(2*_);S.set(a),n.bytes=S}return n.offset=_,_>u&&(n.limit=_),c}function vA(n,i){let a=n.offset;if(a+i>n.limit)throw new Error("Read past limit");return n.offset+=i,a}function gc(n,i){let a=vA(n,i),c=String.fromCharCode,u=n.bytes,_="",S="";for(let C=0;C<i;C++){let R,e,t,r,s=u[C+a];128&s?(224&s)==192?C+1>=i?S+=_:(R=u[C+a+1],(192&R)!=128?S+=_:(r=(31&s)<<6|63&R,r<128?S+=_:(S+=c(r),C++))):(240&s)==224?C+2>=i?S+=_:(R=u[C+a+1],e=u[C+a+2],(49344&(R|e<<8))!=32896?S+=_:(r=(15&s)<<12|(63&R)<<6|63&e,r<2048||r>=55296&&r<=57343?S+=_:(S+=c(r),C+=2))):(248&s)==240?C+3>=i?S+=_:(R=u[C+a+1],e=u[C+a+2],t=u[C+a+3],(12632256&(R|e<<8|t<<16))!=8421504?S+=_:(r=(7&s)<<18|(63&R)<<12|(63&e)<<6|63&t,r<65536||r>1114111?S+=_:(r-=65536,S+=c(55296+(r>>10),56320+(1023&r)),C+=3))):S+=_:S+=c(s)}return S}function Dl(n,i){let a=i.length,c=0;for(let S=0;S<a;S++){let C=i.charCodeAt(S);C>=55296&&C<=56319&&S+1<a&&(C=(C<<10)+i.charCodeAt(++S)-56613888),c+=C<128?1:C<2048?2:C<65536?3:4}vr(n,c);let u=K1(n,c),_=n.bytes;for(let S=0;S<a;S++){let C=i.charCodeAt(S);C>=55296&&C<=56319&&S+1<a&&(C=(C<<10)+i.charCodeAt(++S)-56613888),C<128?_[u++]=C:(C<2048?_[u++]=C>>6&31|192:(C<65536?_[u++]=C>>12&15|224:(_[u++]=C>>18&7|240,_[u++]=C>>12&63|128),_[u++]=C>>6&63|128),_[u++]=63&C|128)}}function KF(n,i){let a=K1(n,i.limit),c=n.bytes,u=i.bytes;for(let _=0,S=i.limit;_<S;_++)c[_+a]=u[_]}function wj(n){return n.bytes[vA(n,1)]}function qF(n,i){let a=K1(n,1);n.bytes[a]=i}function SA(n){let i=vA(n,8),a=n.bytes;return Zc[0]=a[i++],Zc[1]=a[i++],Zc[2]=a[i++],Zc[3]=a[i++],Zc[4]=a[i++],Zc[5]=a[i++],Zc[6]=a[i++],Zc[7]=a[i++],Tj[0]}function XD(n,i){let a=K1(n,8),c=n.bytes;Tj[0]=i,c[a++]=Zc[0],c[a++]=Zc[1],c[a++]=Zc[2],c[a++]=Zc[3],c[a++]=Zc[4],c[a++]=Zc[5],c[a++]=Zc[6],c[a++]=Zc[7]}function Pl(n){let i,a=0,c=0;do i=wj(n),a<32&&(c|=(127&i)<<a),a+=7;while(128&i);return c}function vr(n,i){for(i>>>=0;i>=128;)qF(n,127&i|128),i>>>=7;qF(n,i)}function i0(n,i){let a=i.low>>>0,c=(i.low>>>28|i.high<<4)>>>0,u=i.high>>>24,_=u===0?c===0?a<16384?a<128?1:2:a<1<<21?3:4:c<16384?c<128?5:6:c<1<<21?7:8:u<128?9:10,S=K1(n,_),C=n.bytes;switch(_){case 10:C[S+9]=u>>>7&1;case 9:C[S+8]=_!==9?128|u:127&u;case 8:C[S+7]=_!==8?c>>>21|128:c>>>21&127;case 7:C[S+6]=_!==7?c>>>14|128:c>>>14&127;case 6:C[S+5]=_!==6?c>>>7|128:c>>>7&127;case 5:C[S+4]=_!==5?128|c:127&c;case 4:C[S+3]=_!==4?a>>>21|128:a>>>21&127;case 3:C[S+2]=_!==3?a>>>14|128:a>>>14&127;case 2:C[S+1]=_!==2?a>>>7|128:a>>>7&127;case 1:C[S]=_!==1?128|a:127&a}}function Lh(n,i){var a=Object.keys(n);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(n);i&&(c=c.filter(function(u){return Object.getOwnPropertyDescriptor(n,u).enumerable})),a.push.apply(a,c)}return a}let gK=new Map([["moderation",1],["supervise",2]]);class JF extends li{get connectionState(){return this._connectionState}set connectionState(i){if(this._connectionState===i)return;let a=this._connectionState;this._connectionState=i,this.emit(Ir.CONNECTION_STATE_CHANGE,a,i)}get inspectType(){return this._inspectType}set inspectType(i){var a;this._inspectMode=Ds(a=i.map(c=>gK.get(c)||0)).call(a,(c,u)=>c+u),this._inspectType=i}get quality(){return this._quality}set quality(i){this._quality=i>1?1:i<.1?.1:i,this.qualityTimer&&(window.clearTimeout(this.qualityTimer),this.qualityTimer=null),this._quality>=1||(this.qualityTimer=window.setTimeout(()=>{this.quality=this._quality/this.qualityRatio},6e4))}constructor(i){super(),re(this,"name","AgoraRTCVideoContentInspect"),re(this,"_connectionState",An.CONNECTING),re(this,"_innerConnectionState",void 0),re(this,"sequence",0),re(this,"inspectStartTime",void 0),re(this,"workerManagerConnection",void 0),re(this,"workerConnection",void 0),re(this,"workerMessageLengthLimit",void 0),re(this,"inspectIntervalMinimum",void 0),re(this,"qualityRatio",void 0),re(this,"_connectInfo",void 0),re(this,"_cancelTokenSource",eo.CancelToken.source()),re(this,"_retryConfig",void 0),re(this,"wmSequence",0),re(this,"inspectInterval",void 0),re(this,"inspectTimer",null),re(this,"ossFilePrefix",void 0),re(this,"extraInfo",void 0),re(this,"_inspectType",void 0),re(this,"_inspectMode",void 0),re(this,"_quality",1),re(this,"qualityTimer",null),re(this,"_inspectId",void 0),re(this,"_needWorkUrlOnly",!1),re(this,"inspectImage",()=>{if(this.connectionState!==An.CONNECTED)throw new De(oe.OPERATION_ABORTED,"content inspect service connection status is ".concat(this.connectionState));this.inspectTimer&&(window.clearInterval(this.inspectTimer),this.inspectTimer=null),this.inspectTimer=window.setInterval(()=>{this.connectionState===An.CONNECTED?this.requestToInspectImage():z.debug("[".concat(this._inspectId,"] Inspect State is not connected , "),this.connectionState)},this.inspectInterval<this.inspectIntervalMinimum?this.inspectIntervalMinimum:this.inspectInterval),this.requestToInspectImage()}),this._inspectId=gr(5,"inspect-"),this.workerMessageLengthLimit=ge("VIDEO_INSPECT_WORKER_MESSAGE_LENGTH_LIMIT"),this.inspectIntervalMinimum=ge("VIDEO_INSPECT_INTERVAL_MINIMUM"),this.qualityRatio=ge("VIDEO_INSPECT_QUALITY_RATIO"),this.inspectInterval=i.interval,this.ossFilePrefix=i.ossFilePrefix,this.extraInfo=i.extraInfo,this.inspectType=i.inspectType,this.inspectStartTime=Number(Date.now()),this.workerManagerConnection=new qp("worker-manager-"+this._inspectId,da),this.on(Ir.STATE_CHANGE,(a,c)=>{this._innerConnectionState=a,z.debug("[".concat(this._inspectId,"] Inspect operation :").concat(nu[a]," ").concat(c||""))}),this.handleWorkerManagerEvents(),this.workerConnection=new qp("worker-"+this._inspectId,da),this.handleWorkerEvents()}async init(i,a){this.emit(Ir.STATE_CHANGE,nu.CONNECT_AP),this._connectInfo=i;let c=this._cancelTokenSource.token;return this._retryConfig=a,new Et((u,_)=>{this.on(Ir.CONNECTION_STATE_CHANGE,(S,C)=>{C===An.CONNECTED&&u()}),this.requestAP(i,c,a).then(S=>{this.connectWorkerManager(S)}).catch(S=>{_(S)})})}async requestAP(i,a,c){let u=ge("WEBCS_DOMAIN").map(C=>"https://".concat(C,"/api/v1")),_=await function(C,R,e,t){let{appId:r,areaCode:s,cname:l,sid:f,token:m,uid:E}=R;E1++;let y="image_moderation_api",b={service_name:y,json_body:JSON.stringify({appId:r,areaCode:s,cname:l,command:"allocateEdge",requestId:E1,seq:E1,sid:f,token:m,ts:Date.now(),uid:E+""})},A,O,D=C[0];return Xu(async()=>{A=Date.now();let P=await sf(D,{data:b,cancelToken:e,headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"61"},params:{action:"wrtc_gateway"}});if(O=Date.now()-A,P.code!==0){let $=new De(oe.UNEXPECTED_RESPONSE,"image inspect ap error, code"+P.code,{retry:!0,responseTime:O});throw z.error($.toString()),$}let F=JSON.parse(P.json_body);if(F.code!==200){let $=new De(oe.UNEXPECTED_RESPONSE,"image inspect ap error, code: ".concat(F.code,", reason: ").concat(F.reason),{code:F.code,responseTime:O});throw z.error($.toString()),$}if(!F.servers||!Array.isArray(F.servers)||F.servers.length===0){let $=new De(oe.UNEXPECTED_RESPONSE,"image inspect ap empty server",{code:F.code,responseTime:O});throw z.error($.toString()),$}let B=ge("VIDEO_INSPECT_WORKER_MANAGER_HOST"),Y=ge("VIDEO_INSPECT_WORKER_MANAGER_PORT");return{addressList:F.servers.map($=>{let{address:ee,wss:Ee}=$;if(ee&&Ee)return"wss://".concat(ee.replace(/\./g,"-"),".").concat(B,":").concat(Y||Ee)}).filter($=>!!$),workerToken:F.workerToken,vid:F.vid,responseTime:O}},(P,F)=>(jt.apworkerEvent(f,{success:!0,sc:200,serviceName:y,responseDetail:JSON.stringify(P.addressList),firstSuccess:F===0,responseTime:O,serverIp:C[F%C.length]}),!1),(P,F)=>(jt.apworkerEvent(f,{success:!1,sc:P.data&&P.data.code||200,serviceName:y,responseTime:O,serverIp:C[F%C.length]}),!!(P.code!==oe.OPERATION_ABORTED&&P.code!==oe.UNEXPECTED_RESPONSE||P.data&&P.data.retry)&&(D=C[(F+1)%C.length],!0)),t)}(u,i,a,c);this.emit(Ir.STATE_CHANGE,nu.AP_CONNECTED);let{addressList:S}=_;return this.wmSequence++,S}async connectWorkerManager(i){let a=arguments.length>1&&arguments[1]!==void 0&&arguments[1];this._needWorkUrlOnly=a,this.emit(Ir.STATE_CHANGE,nu.CONNECT_WORKER_MANAGER),await this.workerManagerConnection.init(i,1e4)}async connectWorker(i){await this.workerConnection.init([i])}handleWorkerManagerEvents(){this.workerManagerConnection.on(mn.CONNECTED,async()=>{this.emit(Ir.STATE_CHANGE,nu.WORKER_MANAGER_CONNECTED,this.workerManagerConnection.url),this.workerManagerConnection.sendMessage({appId:this._connectInfo.appId,cname:this._connectInfo.cname,uid:this._connectInfo.uid+"",sdkVersion:"4.23.2",sid:this._connectInfo.sid,seq:this.wmSequence,ts:Number(Date.now()),requestId:Math.floor(1e12*Math.random()),allocate:!0,clientRequest:{command:"join"}},!0)}),this.workerManagerConnection.on(mn.CLOSED,()=>{this._innerConnectionState<nu.GET_WORKER_MANAGER_RESPONSE&&z.debug("[".concat(this._inspectId,"] Inspect worker manager is closed before connecting worker"))}),this.workerManagerConnection.on(mn.FAILED,()=>{this._innerConnectionState<nu.GET_WORKER_MANAGER_RESPONSE&&z.debug("[".concat(this._inspectId,"] Connecting inspect worker manager is failed before connecting worker"))}),this.workerManagerConnection.on(mn.RECONNECTING,()=>{this._innerConnectionState<nu.GET_WORKER_MANAGER_RESPONSE&&z.debug("[".concat(this._inspectId,"] Inspect worker manager is reconnecting before connecting worker"))}),this.workerManagerConnection.on(mn.ON_MESSAGE,async i=>{this.emit(Ir.STATE_CHANGE,nu.GET_WORKER_MANAGER_RESPONSE);let a=this.workerManagerConnection.url;this.workerManagerConnection.close();let c=JSON.parse(i.data);if(c.code!==200)throw z.error("[".concat(this._inspectId,"] Unexpected code ").concat(c.code," from worker manager")),new De(oe.UNEXPECTED_RESPONSE,"response code of worker is unexpected",c);if(!(c.serverResponse&&c.serverResponse.portWss&&a))throw z.error("[".concat(this._inspectId,"] Unexpected content from worker manager : ").concat(JSON.stringify(c))),new De(oe.UNEXPECTED_RESPONSE,"response content of worker is unexpected",c);{let u=ge("VIDEO_INSPECT_WORKER_PORT")||c.serverResponse.portWss,_=a.replace(/:\d+\/?$/,":".concat(u));this.emit(Ir.STATE_CHANGE,nu.CONNECT_WORKER,_),this._needWorkUrlOnly?this.emit(Ir.REQUEST_NEW_WORKER_URL,_):await this.connectWorker(_)}}),this.workerManagerConnection.on(mn.WILL_RECONNECT,(i,a,c)=>{c(i)}),this.workerManagerConnection.on(mn.REQUEST_NEW_URLS,(i,a)=>{this.requestAP(this._connectInfo,this._cancelTokenSource.token,this._retryConfig).then(i).catch(a)})}handleWorkerEvents(){this.workerConnection.on(mn.CONNECTED,async()=>{this.emit(Ir.STATE_CHANGE,nu.WORKER_CONNECTED,this.workerConnection.url),this.connectionState=An.CONNECTED}),this.workerConnection.on(mn.ON_MESSAGE,async i=>{if(i.data instanceof ArrayBuffer){let c=hK(new Uint8Array(i.data));if(ge("SHOW_VIDEO_INSPECT_WORKER_MESSAGE")&&z.debug("[".concat(this._inspectId,"] Response message for worker of inspect content "),JSON.stringify(c)),c.code===200){if(Array.isArray(this.inspectType)&&this.inspectType.length===1&&this.inspectType[0]==="supervise")return void this.emit(Ir.INSPECT_RESULT,void 0,void 0);if(c.data&&c.data.scorePorn&&c.data.scoreSexy&&c.data.scoreNeutral){var a;let u={porn:c.data.scorePorn,sexy:c.data.scoreSexy,neutral:c.data.scoreNeutral},_=Ds(a=Object.keys(u)).call(a,(C,R)=>u[C]>u[R]?C:R,"porn"),S=Object.keys(u).find(C=>C===_);this.emit(Ir.INSPECT_RESULT,S)}else this.emit(Ir.INSPECT_RESULT,void 0,new De(oe.UNEXPECTED_RESPONSE,c.code+"","There is an unexpected data on message"))}else this.emit(Ir.INSPECT_RESULT,void 0,new De(oe.UNEXPECTED_RESPONSE,c.code+"",c.msg))}else z.error("[".concat(this._inspectId,"] Unexpected message type from worker")),this.emit(Ir.INSPECT_RESULT,void 0,new De(oe.UNEXPECTED_RESPONSE,"invalid worker message type"))}),this.workerConnection.on(mn.CLOSED,()=>{this.connectionState=An.CLOSED}),this.workerConnection.on(mn.FAILED,()=>{this.connectionState=An.CLOSED}),this.workerConnection.on(mn.RECONNECTING,()=>{this.connectionState=this.connectionState===An.CONNECTED?An.RECONNECTING:An.CONNECTING}),this.workerConnection.on(mn.WILL_RECONNECT,(i,a,c)=>{i==="recover"&&c(i),c("tryNext")}),this.workerConnection.on(mn.REQUEST_NEW_URLS,(i,a)=>{this.workerManagerConnection.close(),this.once(Ir.REQUEST_NEW_WORKER_URL,c=>{i([c])}),this.requestAP(this._connectInfo,this._cancelTokenSource.token,this._retryConfig).then(c=>{this.connectWorkerManager(c,!0)}).catch(c=>{a(c)})})}async requestToInspectImage(){this.sequence++;let i=ed(this,Ir.CLIENT_LOCAL_VIDEO_TRACK),a={appId:this._connectInfo.appId,cname:this._connectInfo.cname,cid:this._connectInfo.cid,sid:this._connectInfo.sid,uid:this._connectInfo.uid,vid:this._connectInfo.vid};if(i){if(!i.isPlaying)return void this.emit(Ir.INSPECT_RESULT,void 0,new De(oe.INVALID_OPERATION,"Only the track being played can be inspected"));let c=await this.generateRequestData(i,a);this.workerConnection.sendMessage(c,!0,!0)}else this.emit(Ir.INSPECT_RESULT,void 0,new De(oe.INVALID_OPERATION,"Only the track being published can be inspected"))}async generateRequestData(i,a){let{appId:c,cname:u,cid:_,vid:S,sid:C,uid:R}=a,e=Date.now(),t=await i.getCurrentFrameImage("image/jpeg",this.quality),r=await Hi(t,c,u),s=this.sequence+"-"+_+"-"+R+"-"+e+"-"+gr(12,""),l={appId:c,cid:_,cname:u,deviceId:"",elapse:(f=Number(e-this.inspectStartTime),{low:f|=0,high:f>>31,unsigned:f>=0}),fileSize:r.byteLength,jpgEncryption:2,height:t.height,width:t.width,jpg:r,networkType:6,osType:7,requestId:s,sdkVersion:"4.23.2",sequence:this.sequence,sid:C,timestamp:s6(e),uid:R,vid:S,service:this._inspectMode,callbackData:this.extraInfo,ossFilePrefix:this.ossFilePrefix};var f;this.extraInfo===void 0&&delete l.callbackData,this.ossFilePrefix===void 0&&delete l.ossFilePrefix;let m=fK(l);if(m.byteLength<this.workerMessageLengthLimit){if(ge("SHOW_VIDEO_INSPECT_WORKER_MESSAGE")){let E=function(y){for(var b=1;b<arguments.length;b++){var A=arguments[b]!=null?arguments[b]:{};b%2?Lh(Object(A),!0).forEach(function(O){re(y,O,A[O])}):Object.getOwnPropertyDescriptors?Object.defineProperties(y,Object.getOwnPropertyDescriptors(A)):Lh(Object(A)).forEach(function(O){Object.defineProperty(y,O,Object.getOwnPropertyDescriptor(A,O))})}return y}({},l);delete E.jpg,z.debug("[".concat(this._inspectId,"] Request message for worker of inspect content "),JSON.stringify(E))}return m}{let E=this.quality*this.qualityRatio;return this.quality=E,await this.generateRequestData(i,{appId:c,cname:u,cid:_,vid:S,sid:C,uid:R})}}close(){this._cancelTokenSource.cancel(),this._cancelTokenSource=eo.CancelToken.source(),this.workerManagerConnection&&this.workerManagerConnection.close(),this.workerConnection&&this.workerConnection.close(),this.inspectTimer&&window.clearInterval(this.inspectTimer),this.inspectTimer=null,this.connectionState=An.CLOSED,this.emit(Ir.STATE_CHANGE,nu.CLOSED)}}let XF={name:"ContentInspect",create:function(n){let{config:i}=n;return function(a){if(!a)throw new De(oe.INVALID_PARAMS,"inspectConfig is necessary.");if(!a.inspectType||!Array.isArray(a.inspectType))throw new De(oe.INVALID_PARAMS,"inspectConfig.inspectType is necessary and is an instance of Array.");{let c=[...new Set(a.inspectType)];c.forEach(u=>{var _;if(!ft(_=["supervise","moderation"]).call(_,u))throw new De(oe.INVALID_PARAMS,"".concat(u," is not a valid inspect type."))}),a.inspectType=c}if(a&&a.extraInfo&&a.extraInfo.length>1024)throw new De(oe.INVALID_PARAMS,"inspectConfig.extraInfo length cannot exceed 1024 bytes")}(i),new JF(i)}};var QD=T(Sn.Object.getOwnPropertySymbols),Rj=br,cm=Kh.indexOf,Ar=rc,lm=he([].indexOf),Ij=!!lm&&1/lm([1],1,-0)<0;Rj({target:"Array",proto:!0,forced:Ij||!Ar("indexOf")},{indexOf:function(n){var i=arguments.length>1?arguments[1]:void 0;return Ij?lm(this,n,i)||0:cm(this,n,i)}});var _K=tc("Array").indexOf,EK=Q,vK=_K,ZD=Array.prototype,SK=function(n){var i=n.indexOf;return n===ZD||EK(ZD,n)&&i===ZD.indexOf?vK:i},QF=T(SK);function yK(n,i){if(n==null)return{};var a,c,u=function(S,C){if(S==null)return{};var R,e,t={},r=B_(S);for(e=0;e<r.length;e++)R=r[e],QF(C).call(C,R)>=0||(t[R]=S[R]);return t}(n,i);if(QD){var _=QD(n);for(c=0;c<_.length;c++)a=_[c],QF(i).call(i,a)>=0||Object.prototype.propertyIsEnumerable.call(n,a)&&(u[a]=n[a])}return u}let $D=class{get localCapabilities(){return Fn(this._localCapabilities)}get rtpCapabilities(){return Fn(this._rtpCapabilities)}get candidates(){return Fn(this._candidates)}get iceParameters(){return Fn(this._iceParameters)}get dtlsParameters(){return Fn(this._dtlsParameters)}constructor(n){re(this,"sessionDesc",void 0),re(this,"_localCapabilities",void 0),re(this,"_rtpCapabilities",void 0),re(this,"_candidates",void 0),re(this,"_iceParameters",void 0),re(this,"_dtlsParameters",void 0),re(this,"setup",void 0),re(this,"currentMidIndex",void 0),re(this,"cname","o/i14u9pJrxRKAsu"),re(this,"firefoxSsrcMidMap",new Map),n=Fn(n);let{remoteIceParameters:i,remoteDtlsParameters:a,candidates:c,remoteRTPCapabilities:u,localCapabilities:_,direction:S,setup:C,videoCodec:R,audioCodec:e}=n,t;this.setup=C,t=S===Ho.RECEIVE_ONLY?Dn(`v=0
o=- 0 0 IN IP4 127.0.0.1
s=AgoraGateway
t=0 0
a=group:BUNDLE 0 1
a=msid-semantic: WMS
a=extmap-allow-mixed
m=video 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendonly
a=rtcp-mux
a=rtcp-rsize
a=mid:0
m=audio 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendonly
a=rtcp-mux
a=rtcp-rsize
a=mid:1
`):Dn(`v=0
o=- 0 0 IN IP4 127.0.0.1
s=AgoraGateway
t=0 0
a=group:BUNDLE 0 1
a=msid-semantic: WMS
a=extmap-allow-mixed
m=video 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=recvonly
a=rtcp-mux
a=rtcp-rsize
a=mid:0
m=audio 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=recvonly
a=rtcp-mux
a=rtcp-rsize
a=mid:1
`),this._rtpCapabilities=u,this._candidates=c,this._iceParameters=i,this._dtlsParameters=a,this._localCapabilities=_;let r=S===Ho.RECEIVE_ONLY?this.rtpCapabilities.send:this.rtpCapabilities.recv,s=S===Ho.RECEIVE_ONLY?this._localCapabilities.recv:this._localCapabilities.send,l=S===Ho.RECEIVE_ONLY?u.send.videoCodecs:f1(Tt.VIDEO,r,s,R),f=S===Ho.RECEIVE_ONLY?u.send.audioCodecs:f1(Tt.AUDIO,r,s,e);for(let m of t.mediaDescriptions)m.attributes.iceUfrag=i.iceUfrag,m.attributes.icePwd=i.icePwd,m.attributes.fingerprints=a.fingerprints,m.attributes.candidates=c,m.attributes.setup=this.setup,m.media.mediaType==="application"&&(m.attributes.sctpPort="5000"),m.media.mediaType==="video"&&(m.media.fmts=l.map(E=>E.payloadType.toString(10)),m.attributes.payloads=l,m.attributes.extmaps=r.videoExtensions),m.media.mediaType==="audio"&&(m.media.fmts=f.map(E=>E.payloadType.toString(10)),m.attributes.payloads=f,m.attributes.extmaps=r.audioExtensions,ou(m));this.sessionDesc=t,this.currentMidIndex=t.mediaDescriptions.length-1}toString(){return me(this.sessionDesc)}hasMid(n){return Array.isArray(n)?n.every(i=>this.hasMid(i)):this.sessionDesc.mediaDescriptions.some(i=>i.attributes.mid===n)}send(n,i,a,c,u){a=a.replace(/ /g,"-");let{ssrcs:_,ssrcGroups:S}=Bg(i,this.cname,ge("SYNC_GROUP")?a:void 0),C=this.findPreloadMediaDesc(_);if(C){if(Ni()&&this.firefoxSsrcMidMap.set(_[0].ssrcId,C.attributes.mid),u&&(u.twcc||u.remb)){let R=this.sessionDesc.mediaDescriptions.indexOf(C);return this.sessionDesc.mediaDescriptions[R]=this.mungSendMediaDesc(C,u),{mid:C.attributes.mid,needExchangeSDP:!0}}return{mid:C.attributes.mid,needExchangeSDP:!1}}{let R=this.findAvailableMediaIndex(n,_,c),e;return R===-1?(e=this.createOrRecycleSendMedia(n,_,S,"sendonly",c,u),this.updateBundleMids()):(e=Fn(this.sessionDesc.mediaDescriptions[R]),e.attributes.direction="sendonly",e.attributes.ssrcs=_,e.attributes.ssrcGroups=S,this.sessionDesc.mediaDescriptions[R]=this.mungSendMediaDesc(e,u)),Ni()&&this.firefoxSsrcMidMap.set(_[0].ssrcId,e.attributes.mid),{needExchangeSDP:!0,mid:e.attributes.mid}}}stopSending(n){let i=this.sessionDesc.mediaDescriptions.filter(a=>a.attributes.mid&&n.indexOf(a.attributes.mid)!==-1);if(i.length!==n.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.stopSending.");i.forEach(a=>{a.attributes.ssrcs=[]}),this.updateBundleMids()}receive(n,i,a){let c=[];return n.forEach(u=>{let _=u._mediaStreamTrack.kind,S=this.findAvailableRecvMediaIndex(_),C,R=!1;S===-1?(R=!0,C=this.createOrRecycleRecvMedia(u,[],"recvonly",i,a),this.updateBundleMids()):(C=Fn(this.sessionDesc.mediaDescriptions[S]),C.attributes.direction="recvonly"),c.push({mid:C.attributes.mid,needCreateTransceiver:R})}),c}stopReceiving(n){let i=this.sessionDesc.mediaDescriptions.filter(a=>n.indexOf(a.attributes.mid)!==-1);if(i.length!==n.length)throw new Error("MediaDescriptions' length doesn't match mids's length when calling RemoteSDP.receive.");i.forEach(a=>{a.media.port="0",a.attributes.direction="inactive"}),this.updateBundleMids()}addRemoteCandidate(n){let{foundation:i,protocol:a,address:c,port:u,type:_,relatedAddress:S,relatedPort:C,priority:R}=new RTCIceCandidate(n),e={foundation:i??"",componentId:"1",transport:a??"",priority:R?R+"":"",connectionAddress:c??"",port:u?u+"":"",type:_?_+"":"",relAddr:S??"",relPort:C?C+"":"",extension:{}};this.candidates.some(t=>t.priority===e.priority&&t.connectionAddress===e.connectionAddress&&t.port===e.port)||(this._candidates.push(e),this.sessionDesc.mediaDescriptions.forEach(t=>{t.attributes.candidates=this.candidates}))}clearRemoteCandidate(){this._candidates=[],this.sessionDesc.mediaDescriptions[0].attributes.candidates=this._candidates}createOrRecycleRecvMedia(n,i,a,c,u){let _=n._mediaStreamTrack.kind,S=this.rtpCapabilities.recv,C=f1(_,S,this.localCapabilities.send,_===Tt.AUDIO?u:c),R=_===Tt.VIDEO?S.videoExtensions:S.audioExtensions,e="".concat(++this.currentMidIndex),t={media:{mediaType:_,port:"9",protos:["UDP","TLS","RTP","SAVPF"],fmts:C.map(s=>s.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:[],extmaps:R,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:i,ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:C,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:a,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(e)}};t=this.mungRecvMediaDsec(t,n);let r=this.findFirstClosedMedia(_);if(r){let s=this.sessionDesc.mediaDescriptions.indexOf(r);this.sessionDesc.mediaDescriptions[s]=t}else this.sessionDesc.mediaDescriptions.push(t);return t}muteRemote(n){let i=this.sessionDesc.mediaDescriptions.filter(a=>ft(n).call(n,a.attributes.mid||""));if(i.length!==n.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");i.forEach(a=>{a.attributes.direction="inactive"})}unmuteRemote(n){let i=this.sessionDesc.mediaDescriptions.filter(a=>ft(n).call(n,a.attributes.mid||""));if(i.length!==n.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");i.forEach(a=>{a.attributes.direction="recvonly"})}findAvailableMediaIndex(n,i,a){return this.sessionDesc.mediaDescriptions.findIndex(c=>{let u=c.media.mediaType===n&&c.media.port!=="0"&&(c.attributes.direction==="sendonly"||c.attributes.direction==="sendrecv")&&c.attributes.ssrcs.length===0;if(Ni()){if(u){let _=this.firefoxSsrcMidMap.get(i[0].ssrcId);return!(_||c.attributes.mid!=="0"&&c.attributes.mid!=="1")||!(!_||_!==c.attributes.mid)}return!1}return u&&c.attributes.mid===a})}findAvailableRecvMediaIndex(n){return this.sessionDesc.mediaDescriptions.findIndex(i=>{let a=i.media.mediaType===n&&i.media.port!=="0"&&(i.attributes.direction==="recvonly"||i.attributes.direction==="sendrecv");return i.attributes.mid!=="0"&&i.attributes.mid!=="1"&&a})}predictReceivingMids(n){let i=[];for(let a=0;a<n;a++)i.push((this.currentMidIndex+a+1).toString(10));return i}restartICE(n){n=Fn(n),this._iceParameters=n,this.sessionDesc.mediaDescriptions.forEach(i=>{i.attributes.iceUfrag=n.iceUfrag,i.attributes.icePwd=n.icePwd})}createOrRecycleSendMedia(n,i,a,c,u,_){let S=this.rtpCapabilities.send,C=n===Tt.VIDEO?S.videoCodecs:S.audioCodecs,R=n===Tt.VIDEO?S.videoExtensions:S.audioExtensions;Ni()&&(u="".concat(++this.currentMidIndex));let e={media:{mediaType:n,port:"9",protos:["UDP","TLS","RTP","SAVPF"],fmts:C.map(r=>r.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:[],extmaps:R,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:i,ssrcGroups:a,rtcpFeedbackWildcards:[],payloads:C,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:c,rtcpMux:!0,rtcpRsize:!0,mid:u}};e=this.mungSendMediaDesc(e,_);let t=this.findFirstClosedMedia(n);if(t){let r=this.sessionDesc.mediaDescriptions.indexOf(t);this.sessionDesc.mediaDescriptions[r]=e}else this.sessionDesc.mediaDescriptions.push(e);return e}mungRecvMediaDsec(n,i,a){let c=Fn(n);return u1(c),au(c,i),rD(c,i),AI(c),Fg(c,a,this.localCapabilities.send),c}mungSendMediaDesc(n,i){let a=Fn(n);return Fg(a,i,this.localCapabilities.recv),ou(a),a}updateRecvMedia(n,i){let a=this.sessionDesc.mediaDescriptions.findIndex(c=>c.attributes.mid===n);if(a!==-1){let c=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[a],i);this.sessionDesc.mediaDescriptions[a]=c}}updateBundleMids(){this.sessionDesc.attributes.groups[0].identificationTag=this.sessionDesc.mediaDescriptions.filter(n=>n.media.port!=="0").map(n=>n.attributes.mid)}findPreloadMediaDesc(n){return this.sessionDesc.mediaDescriptions.find(i=>{var a;return((a=i.attributes)===null||a===void 0||(a=a.ssrcs[0])===null||a===void 0?void 0:a.ssrcId)===n[0].ssrcId})}findFirstClosedMedia(n){return this.sessionDesc.mediaDescriptions.find(i=>Ni()?i.media.port==="0"&&i.media.mediaType===n:i.media.port==="0")}},ZF=["sdp"];var ri;function $F(n,i){var a=Object.keys(n);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(n);i&&(c=c.filter(function(u){return Object.getOwnPropertyDescriptor(n,u).enumerable})),a.push.apply(a,c)}return a}function aE(n){for(var i=1;i<arguments.length;i++){var a=arguments[i]!=null?arguments[i]:{};i%2?$F(Object(a),!0).forEach(function(c){re(n,c,a[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(a)):$F(Object(a)).forEach(function(c){Object.defineProperty(n,c,Object.getOwnPropertyDescriptor(a,c))})}return n}let eP=(ri=class fP extends gU{get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get dtlsTransportState(){var i,a;return(i=(a=this.peerConnection.getReceivers()[0])===null||a===void 0||(a=a.transport)===null||a===void 0?void 0:a.state)!==null&&i!==void 0?i:null}get localCodecs(){return[]}set isInRestartIce(i){this._isInRestartIce=i}get isInRestartIce(){return this._isInRestartIce}constructor(i,a,c){super(i,a),re(this,"direction",void 0),re(this,"name",void 0),re(this,"store",void 0),re(this,"spec",void 0),re(this,"peerConnection",void 0),re(this,"initialOffer",void 0),re(this,"transport",void 0),re(this,"statsFilter",void 0),re(this,"localCandidateCount",0),re(this,"_isInRestartIce",!1),re(this,"mutex",void 0),re(this,"onLocalCandidate",void 0),re(this,"remoteSDP",void 0),re(this,"pendingCandidates",[]),re(this,"localCapabilities",void 0),re(this,"isReady",!1),re(this,"restartCnt",0),re(this,"curTurnServerIndex",0),this.store=a,this.spec=i,this.mutex=new Na("P2PConnection-mutex",a.clientId),this.peerConnection=new RTCPeerConnection(fP.resolvePCConfiguration(i,a.p2pTransport),{optional:[{googDscp:!0}]}),this.direction=c??Ho.SEND_ONLY,this.name=this.direction===Ho.SEND_ONLY?"sendP2PConnection":"recvP2PConnection",this.statsFilter=bL(this.peerConnection,ge("STATS_UPDATE_INTERVAL"),void 0,Ni()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1}async establish(i){try{let a=await OI();if(this.localCapabilities=z_(a),i){let{sdp:c}=i,u=yK(i,ZF),_=function(){let t={audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]},r=Co(arguments.length>2?arguments[2]:void 0,arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},"sendonly"),s={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},l={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},f={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]};if(su(r,t,"videoExtensions",s,l,f),su(r,t,"videoCodecs",s,l,f),su(r,t,"audioExtensions",s,l,f),su(r,t,"audioCodecs",s,l,f),ge("RAISE_H264_BASELINE_PRIORITY")){let m=f.videoCodecs.findIndex(E=>E.rtpMap&&E.rtpMap.encodingName.toLocaleLowerCase()==="h264"&&E.fmtp&&E.fmtp.parameters["profile-level-id"]==="42001f");if(m!==-1){let E=f.videoCodecs.findIndex(y=>y.rtpMap&&y.rtpMap.encodingName.toLocaleLowerCase()==="h264");if(E<m){z.debug("raising H264 baseline profile priority");let y=f.videoCodecs[m];f.videoCodecs.splice(m,1),f.videoCodecs.splice(E,0,y)}E!==-1&&ge("FILTER_SEND_H264_BASELINE")&&(s.videoCodecs=s.videoCodecs.filter(y=>!(y.rtpMap&&y.rtpMap.encodingName.toLocaleLowerCase()==="h264"&&y.fmtp&&y.fmtp.parameters["profile-level-id"]!=="42001f")))}}return{send:s,recv:l,sendrecv:f}}({},{},c);this.remoteSDP=new $D({remoteIceParameters:u.iceParameters,remoteDtlsParameters:u.dtlsParameters,candidates:[],remoteRTPCapabilities:_,localCapabilities:this.localCapabilities,direction:this.direction,setup:"actpass",videoCodec:this.store.codec,audioCodec:this.store.audioCodec}),await this.setRemoteDescription({type:"offer",sdp:this.remoteSDP.toString()}),this.isReady=!0;let S=await this.peerConnection.createAnswer();if(!S.sdp)throw new Error("Cannot get answer sdp when trying to establish PeerConnection.");let C=Vg(S.sdp);await this.peerConnection.setLocalDescription(S);let R=await wU({},{},S.sdp);this.localCapabilities=z_(R);let e=this.peerConnection.getTransceivers()[0];return e!=null&&e.receiver&&e.receiver.transport&&this.tryBindTransportEvents(e.receiver.transport),aE(aE({},C),{},{sdp:S.sdp})}{this.peerConnection.addTransceiver("video",{direction:"sendonly"}),this.peerConnection.addTransceiver("audio",{direction:"sendonly"});let c=await this.peerConnection.createOffer();if(!c.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");let u=Vg(c.sdp);return this.initialOffer=c,aE(aE({},u),{},{sdp:c.sdp})}}catch(a){throw new Ye(oe.GET_LOCAL_CONNECTION_PARAMS_FAILED,a.toString())}}async connect(i){try{if(!this.initialOffer)throw new Error("Cannot establish P2PConnection without initial offer.");await this.peerConnection.setLocalDescription(this.initialOffer);let{sdp:a,iceParameters:c,dtlsParameters:u}=i,_=await wU({},{},a);this.remoteSDP=new $D({remoteIceParameters:c,remoteDtlsParameters:u,candidates:[],remoteRTPCapabilities:_,localCapabilities:this.localCapabilities,direction:this.direction,setup:"active",videoCodec:this.store.codec,audioCodec:this.store.audioCodec}),await this.setRemoteDescription({type:"answer",sdp:this.remoteSDP.toString()});let S=this.peerConnection.getTransceivers()[0];S!=null&&S.sender&&S.sender.transport&&this.tryBindTransportEvents(S.sender.transport)}catch(a){throw new Ye(oe.EXCHANGE_SDP_FAILED,"P2PConnection.connect failed; ".concat(a.toString()))}}async addRemoteCandidate(i){try{i&&this.pendingCandidates.push(i),this.peerConnection.remoteDescription&&this.isReady&&(this.pendingCandidates.forEach(a=>{this.peerConnection.addIceCandidate(a)}),this.pendingCandidates=[])}catch(a){throw new Ye(oe.ADD_CANDIDATE_FAILED,"P2PConnection.addRemoteCandidate failed; ".concat(a.toString()))}}send(i,a,c){var u=this;return Zl(function*(){let _=yield Kn(u.mutex.lock("From P2PConnection.send"));try{if(!u.remoteSDP)throw new Error("Cannot call P2PConnection.send before remote SDP created");let S=[],C=u.remoteSDP.receive(i,a,c);i.forEach((E,y)=>{if(C[y].needCreateTransceiver){let b=u.peerConnection.addTransceiver(E._mediaStreamTrack,{direction:"sendonly"});S.push(b),E._updateRtpTransceiver(b)}else{let b=u.peerConnection.getTransceivers().find(A=>A.mid===C[y].mid);if(!b)throw new Error("cannot find transceiver when sendPeerconnection send, mid is ".concat(C[y].mid));S.push(b),E._updateRtpTransceiver(b)}}),Ni()&&ge("SIMULCAST")===!0&&(yield Kn(u.applySimulcastForFirefox(S,i)));let R=C.map(E=>E.mid),e=yield Kn(u.peerConnection.createOffer()),t=u.mungSendOfferSDP(e.sdp,i,R),r=Dn(t),s=R.map(E=>{let y=r.mediaDescriptions.find(b=>b.attributes.mid===E);if(!y)throw new Error("Cannot extract ssrc from mediaDescription.");return TU(y,ge("USE_PUB_RTX"))}),l=S.map((E,y)=>{let b=R[y];return{localSSRC:s[y],id:b}});yield Kn(u.peerConnection.setLocalDescription({type:"offer",sdp:t}));try{yield l}catch(E){let y=u.remoteSDP.toString();throw yield Kn(u.peerConnection.setLocalDescription({type:"offer",sdp:t})),yield Kn(u.peerConnection.setRemoteDescription({type:"answer",sdp:y})),yield Kn(u.stopSending(R,!0)),E}yield Kn(u.applySimulcastEncodings(S,i)),yield Kn(u.applySendEncodings(S,i));let f=u.remoteSDP.toString(),m=u.logSDPExchange(t,"offer","local","send");return m==null||m(f),yield Kn(u.setRemoteDescription({type:"answer",sdp:f})),S.map((E,y)=>{let b=R[y];return{localSSRC:s[y],id:b}})}catch(S){throw S instanceof Ye?S:new Ye(oe.EXCHANGE_SDP_FAILED,"P2PConnection.send failed; ".concat(S.toString()))}finally{_()}})()}async stopSending(i,a){let c=a?void 0:await this.mutex.lock("From P2PConnection.stopSending");try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopSending before remote SDP created");let u=this.peerConnection.getTransceivers().filter(R=>i.indexOf(R.mid)!==-1);if(u.length!==i.length)throw new Error("Transceivers' length (".concat(u.length,") doesn't match mids' length (").concat(i.length,") when trying to call P2PConnection.stopSending."));u.map(R=>{var e;R.direction="inactive",(e=R.stop)===null||e===void 0||e.call(R)});let _=await this.peerConnection.createOffer(),S=this.logSDPExchange(_.sdp||"","offer","local","stopSending");await this.peerConnection.setLocalDescription(_),this.remoteSDP.stopReceiving(i);let C=this.remoteSDP.toString();S==null||S(C),await this.setRemoteDescription({type:"answer",sdp:C})}catch(u){throw new Ye(oe.EXCHANGE_SDP_FAILED,"P2PConnection.stopSending failed; ".concat(u.toString()))}finally{c&&c()}}async receive(i,a,c,u){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(i," before remoteSDP created."));let{mid:_,needExchangeSDP:S}=this.remoteSDP.send(i,a,c,u);if(S){let R=this.remoteSDP.toString(),e=this.logSDPExchange(R,"offer","remote","receive");await this.setRemoteDescription({type:"offer",sdp:R});let t=await this.peerConnection.createAnswer(),r=this.mungReceiveAnswerSDP(t.sdp,_,i);e==null||e(r||""),await this.peerConnection.setLocalDescription({type:"answer",sdp:r}),z.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(i," by exchanging SDP."))}else z.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(i," no need to exchange SDP."));let C=this.peerConnection.getTransceivers().find(R=>R.mid===_);if(!C||C.mid===null)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:C.receiver.track,mid:C.mid,transceiver:C}}catch(_){throw new Ye(oe.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(_.toString()))}}async mockReceive(i,a,c,u){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(i," before remoteSDP created."));let{mid:_,needExchangeSDP:S}=this.remoteSDP.send(i,a,c,u);if(S){let C=this.remoteSDP.toString(),R=this.logSDPExchange(C,"offer","remote","receive");await this.setRemoteDescription({type:"offer",sdp:C});let e=await this.peerConnection.createAnswer(),t=this.mungReceiveAnswerSDP(e.sdp,_,i);R==null||R(t||""),await this.peerConnection.setLocalDescription({type:"answer",sdp:t}),z.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(i," by exchanging SDP."))}else z.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(i," no need to exchange SDP."))}catch(_){throw new Ye(oe.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(_.toString()))}}async stopReceiving(i){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");this.remoteSDP.stopSending(i);let a=this.remoteSDP.toString(),c=this.logSDPExchange(a,"offer","remote","stopReceiving");await this.setRemoteDescription({type:"offer",sdp:a});let u=await this.peerConnection.createAnswer();c==null||c(u.sdp||""),await this.peerConnection.setLocalDescription(u)}catch(a){throw new Ye(oe.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(a.toString()))}}async restartICE(i){try{if(this.store.p2pTransport===Fp.Auto&&(this.store.p2pTransport=Fp.SdRtn,Un().supportPCSetConfiguration&&this.peerConnection.setConfiguration(fP.resolvePCConfiguration(this.spec,this.store.p2pTransport))),this.restartCnt>3&&(this.restartCnt=0,Un().supportPCSetConfiguration&&this.peerConnection.setConfiguration(fP.resolvePCConfiguration(this.spec,this.store.p2pTransport,++this.curTurnServerIndex))),!i){this.restartCnt++,this.isReady=!1;let a=await this.peerConnection.createOffer({iceRestart:!0});if(!a.sdp)throw new Error("Cannot restartICE because restart offer SDP does not exist.");let{iceParameters:c}=Vg(a.sdp);return this.store.descriptionStart(),this.direction===Ho.SEND_ONLY&&await this.peerConnection.setLocalDescription(a),c}if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");if(this.remoteSDP.restartICE(i),this.store.descriptionStart(),this.direction===Ho.RECEIVE_ONLY){this.restartCnt++,await this.setRemoteDescription({type:"offer",sdp:this.remoteSDP.toString()});let a=await this.peerConnection.createAnswer();if(!a.sdp)throw new Error("Cannot get answer sdp when trying to iceRestart.");let{iceParameters:c}=Vg(a.sdp);return await this.peerConnection.setLocalDescription(a),c}await this.setRemoteDescription({type:"answer",sdp:this.remoteSDP.toString()}),this.isReady=!0}catch(a){throw new Ye(oe.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(a.toString()))}}close(){var i;this.peerConnection.close(),this.peerConnection.onicecandidate=null,(i=this.onConnectionStateChange)===null||i===void 0||i.call(this,"closed"),this.tryUnbindTransportEvents(),this.unbindPCEvents(),this.unbindStatsEvents(),this.transport=void 0,this.statsFilter.destroy()}getStats(){return this.statsFilter.getStats()}getRemoteVideoIsReady(i){return this.statsFilter.getVideoIsReady(i)}async updateEncoderConfig(i,a){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateEncoderConfig before remote SDP created.");let c=await this.peerConnection.createOffer(),u=this.mungSendOfferSDP(c.sdp,[a],[i]);this.remoteSDP.updateRecvMedia(i,a);let _=this.remoteSDP.toString(),S=this.logSDPExchange(u,"offer","local","updateEncoderConfig");await this.peerConnection.setLocalDescription({type:"offer",sdp:u}),S==null||S(_),await this.peerConnection.setRemoteDescription({type:"answer",sdp:_})}catch(c){throw new Ye(oe.EXCHANGE_SDP_FAILED,c.toString())}}async updateSendParameters(i,a){let c=this.peerConnection.getTransceivers().filter(u=>u.mid===i);c.length===1&&(this.isVP8Simulcast(a)?Ni()||await this.applySimulcastEncodings(c,[a]):await this.applySendEncodings(c,[a]))}setStatsRemoteVideoIsReady(i,a){this.statsFilter.setVideoIsReady2(i,a)}async replaceTrack(i,a){let c=this.peerConnection.getTransceivers().find(u=>u.mid===a);c&&await c.sender.replaceTrack(i._mediaStreamTrack)}async getSelectedCandidatePair(){let i=this.peerConnection.getReceivers();if(i.length>0&&i[0].transport&&i[0].transport.iceTransport&&i[0].transport.iceTransport.getSelectedCandidatePair&&i[0].transport.iceTransport.getSelectedCandidatePair()){let a=i[0].transport.iceTransport,{local:c,remote:u}=a.getSelectedCandidatePair();return{local:aE(aE({},Qu),{},{candidateType:c.type,protocol:c.protocol,address:c.address,port:c.port}),remote:aE(aE({},Qu),{},{candidateType:u.type,protocol:u.protocol,address:u.address,port:u.port})}}return this.statsFilter.getSelectedCandidatePair()}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var i,a;ft(i=["connected","completed"]).call(i,this.peerConnection.iceConnectionState)&&(this.isReady=!1),(a=this.onICEConnectionStateChange)===null||a===void 0||a.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var i;this.peerConnection.connectionState==="connected"&&(this.restartCnt=0),(i=this.onConnectionStateChange)===null||i===void 0||i.call(this,this.peerConnection.connectionState)},this.startICECandidate()}startICECandidate(){this.peerConnection.onicecandidate||(this.localCandidateCount=0,this.peerConnection.onicecandidate=i=>{if(i.candidate){var a;i.candidate.candidate&&((a=this.onLocalCandidate)===null||a===void 0||a.call(this,i.candidate.toJSON())),this.localCandidateCount+=1}else z.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount)})}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(i,a){let c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,u={iceServers:[]};var _;return i.iceServers?u.iceServers=i.iceServers:i.turnServer&&i.turnServer.mode!=="off"&&(vS(i.turnServer.servers)?u.iceServers=i.turnServer.servers:(u.iceServers&&u.iceServers.push(...fP.turnServerConfigToIceServers(i.turnServer.servers,a,c)),ge("USE_TURN_SERVER_OF_GATEWAY")&&u.iceServers&&i.turnServer.serversFromGateway&&u.iceServers.push(...fP.turnServerConfigToIceServers(i.turnServer.serversFromGateway,a,c)),ft(_=[Fp.Relay,Fp.SdRtn]).call(_,a)&&(u.iceTransportPolicy="relay"),ge("FORCE_TURN_TCP")?u.iceTransportPolicy="relay":i.turnServer.servers.concat(i.turnServer.serversFromGateway||[]).forEach(S=>{S.forceturn&&(u.iceTransportPolicy="relay")}))),ge("ENABLE_ENCODED_TRANSFORM")&&Un().supportWebRTCEncodedTransform&&(u.encodedInsertableStreams=!0),z.debug("P2PConnection p2pTransport is ".concat(a)),u}static turnServerConfigToIceServers(i,a){let c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,u=[],_=i.filter(C=>C.tcpport);z.debug("P2PConnection turnServers is ".concat(_,", current index is ").concat(c));let S=_.length>c?_[c]:_[0];switch(a){case Fp.SdRtn:let C=i.filter(e=>{var t;return ft(t=e.username).call(t,"glb:")&&e.turnServerURL==e.turnServerURL}),R=C.length>c?C[c]:C[0];R&&(u.push({username:R.username,credential:R.password,credentialType:"password",urls:"turn:".concat(F_(R.turnServerURL),":").concat(R.tcpport,"?transport=udp")}),u.push({username:R.username,credential:R.password,credentialType:"password",urls:"turns:".concat(F_(R.turnServerURL),":").concat(R.tcpport,"?transport=tcp")}));break;case Fp.Relay:S&&(u.push({username:S.username,credential:S.password,credentialType:"password",urls:"turn:".concat(S.turnServerURL,":").concat(S.tcpport,"?transport=udp")}),u.push({username:S.username,credential:S.password,credentialType:"password",urls:"turns:".concat(F_(S.turnServerURL),":").concat(S.tcpport,"?transport=tcp")}));break;default:S&&(u.push({username:S.username,credential:S.password,credentialType:"password",urls:"turn:".concat(S.turnServerURL,":").concat(S.tcpport,"?transport=udp")}),u.push({username:S.username,credential:S.password,credentialType:"password",urls:"turns:".concat(F_(S.turnServerURL),":").concat(S.tcpport,"?transport=tcp")}),u.push({username:S.username,credential:S.password,credentialType:"password",urls:"stun:".concat(S.turnServerURL,":").concat(S.tcpport)}))}return u}tryBindTransportEvents(i){if(i){this.transport=i,i.onstatechange=()=>{var c;i!=null&&i.state&&((c=this.onDTLSTransportStateChange)===null||c===void 0||c.call(this,i.state))},i.onerror=c=>{var u;(u=this.onDTLSTransportError)===null||u===void 0||u.call(this,"error"in c?c.error:c)};let a=i.iceTransport;a&&(a.onstatechange=()=>{let c=i==null?void 0:i.iceTransport.state;var u;c&&((u=this.onICETransportStateChange)===null||u===void 0||u.call(this,c))},a.getSelectedCandidatePair&&(a.onselectedcandidatepairchange=()=>{if(a.getSelectedCandidatePair()){let{local:c,remote:u}=a.getSelectedCandidatePair();z.info("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] selectedcandidatepairchange: local ").concat(JSON.stringify({candidateType:c.type,protocol:c.protocol}),", remote ").concat(JSON.stringify({candidateType:u.type,protocol:u.protocol,address:u.address,port:u.port})," )"))}}))}}tryUnbindTransportEvents(){this.transport&&(this.transport.onstatechange=null,this.transport.onerror=null,this.transport.iceTransport&&(this.transport.iceTransport.onstatechange=null))}async updateRtpSenderEncodings(i,a){var c;if(a||(a=this.peerConnection.getSenders().find(t=>t.track===i._mediaStreamTrack)),!a)return z.warn("[".concat(i.getTrackId(),"] no rtpSender found}"));if(this.isVP8Simulcast(i))return z.warn("[updateRtpSenderEncodings] Track is VP8 simulcast, please apply simulcast encodings");if(!Un().supportSetRtpSenderParameters)return z.warn("[updateRtpSenderEncodings] Browser not support set rtp-sender parameters");let u={},_={};switch(i._optimizationMode){case"motion":u.degradationPreference="maintain-framerate";break;case"detail":u.degradationPreference="maintain-resolution";break;default:u.degradationPreference="balanced"}if(i._encoderConfig){var S;let{bitrateMax:t,frameRate:r,scaleResolutionDownBy:s}=i._encoderConfig;t&&(_.maxBitrate=1e3*t),ft(S=i._hints).call(S,kr.LOW_STREAM)&&(r&&(_.maxFramerate=Al(r)),s&&s>=1&&(_.scaleResolutionDownBy=s))}if(ge("DSCP_TYPE")&&jp()){var C;let t=ge("DSCP_TYPE");ft(C=["very-low","low","medium","high"]).call(C,t)&&(_.networkPriority=t)}let R=a.getParameters(),e=(c=R.encodings)===null||c===void 0?void 0:c[0];Ni()&&!e&&(u.encodings=[_]),e&&Object.assign(e,_),Object.assign(R,u),z.debug("[".concat(i.getTrackId(),"] updateRtpSenderEncodings: ").concat(JSON.stringify(R.encodings))),await a.setParameters(R)}async applySendEncodings(i,a){try{if(!Un().supportSetRtpSenderParameters||i.length!==a.length)return;for(let c=0;c<i.length;c++){let u=i[c],_=a[c];_ instanceof ni&&!this.isVP8Simulcast(_)&&await this.updateRtpSenderEncodings(_,u.sender)}}catch{z.debug("[".concat(this.store.clientId,"] Apply RTPSendEncodings failed."))}}mungSendOfferSDP(i,a,c){let u=Dn(i);return a.forEach((_,S)=>{let C=c[S],R=u.mediaDescriptions.find(e=>e.attributes.mid===C);R&&(au(R,_),CU(R,_,this.store.codec))}),me(u)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=i=>{var a;(a=this.onFirstAudioReceived)===null||a===void 0||a.call(this,i)},this.statsFilter.onFirstVideoReceived=i=>{var a;(a=this.onFirstVideoReceived)===null||a===void 0||a.call(this,i)},this.statsFilter.onFirstAudioDecoded=i=>{var a;(a=this.onFirstAudioDecoded)===null||a===void 0||a.call(this,i)},this.statsFilter.onFirstVideoDecoded=(i,a,c)=>{var u;(u=this.onFirstVideoDecoded)===null||u===void 0||u.call(this,i,a,c)},this.statsFilter.onSelectedLocalCandidateChanged=(i,a)=>{var c;(c=this.onSelectedLocalCandidateChanged)===null||c===void 0||c.call(this,i,a)},this.statsFilter.onSelectedRemoteCandidateChanged=(i,a)=>{var c;(c=this.onSelectedRemoteCandidateChanged)===null||c===void 0||c.call(this,i,a)},this.statsFilter.onFirstVideoDecodedTimeout=i=>{var a;(a=this.onFirstVideoDecodedTimeout)===null||a===void 0||a.call(this,i)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0,this.statsFilter.onFirstVideoDecodedTimeout=void 0}async applySimulcastForFirefox(i,a){if(i.length===a.length)for(let R=0;R<i.length;R++){var c,u,_,S,C;let e=i[R],t=a[R];if(t instanceof ni&&!ft(c=t._hints).call(c,kr.LOW_STREAM)&&(u=t._encoderConfig)!==null&&u!==void 0&&u.bitrateMax&&((_=t._encoderConfig)===null||_===void 0?void 0:_.bitrateMax)>200&&(S=t._scalabilityMode)!==null&&S!==void 0&&S.numSpatialLayers&&((C=t._scalabilityMode)===null||C===void 0?void 0:C.numSpatialLayers)>1&&this.store.codec==="vp8"){let r={},s={high:1e3*(t._encoderConfig.bitrateMax-50),medium:5e4};r.encodings=[{rid:"m",active:!0,maxBitrate:s.medium,scaleResolutionDownBy:4},{rid:"h",active:!0,maxBitrate:s.high}];let l=e.sender.getParameters();await e.sender.setParameters(Object.assign(l,r))}}}async applySimulcastEncodings(i,a){if(!Ni()&&i.length===a.length)for(let c=0;c<i.length;c++){let u=a[c];if(u instanceof ni&&this.isVP8Simulcast(u)){let _=i[c],S={},C={high:1e3*(u._encoderConfig.bitrateMax-50),medium:5e4};S.encodings=[{active:!0,adaptivePtime:!1,networkPriority:"high",priority:"high",maxBitrate:C.high},{active:!0,adaptivePtime:!1,networkPriority:"low",priority:"low",maxBitrate:C.medium,scaleResolutionDownBy:4}];let R=_.sender.getParameters();await _.sender.setParameters(Object.assign(R,S))}}}isVP8Simulcast(i){var a,c,u,_,S;return!!(i instanceof ni&&ge("SIMULCAST")&&this.store.codec==="vp8"&&!ft(a=i._hints).call(a,kr.LOW_STREAM)&&(c=i._encoderConfig)!==null&&c!==void 0&&c.bitrateMax&&((u=i._encoderConfig)===null||u===void 0?void 0:u.bitrateMax)>200&&(_=i._scalabilityMode)!==null&&_!==void 0&&_.numSpatialLayers&&((S=i._scalabilityMode)===null||S===void 0?void 0:S.numSpatialLayers)>1)}logSDPExchange(i,a,c,u){if(ge("SDP_LOGGING"))return z.upload("[".concat(this.store.clientId,"] exchanging ").concat(c," ").concat(a," SDP during P2PConnection.").concat(u,`
`),i),a==="offer"?_=>{this.logSDPExchange(_,"answer",c==="local"?"remote":"local",u)}:void 0}async muteLocal(i){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteLocal before remote SDP created.");let a=this.peerConnection.getTransceivers().filter(S=>S.mid&&i.indexOf(S.mid)!==-1);if(a.length!==i.length)throw new Error("Transceivers' length doesn't match mids' length.");a.map(S=>{S.direction="inactive"});let c=await this.peerConnection.createOffer(),u=this.logSDPExchange(c.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(c),this.remoteSDP.muteRemote(i);let _=this.remoteSDP.toString();u==null||u(_),await this.setRemoteDescription({type:"answer",sdp:_})}catch(a){throw new Ye(oe.EXCHANGE_SDP_FAILED,"P2PConnection.muteLocal failed; ".concat(a.toString()))}}async unmuteLocal(i){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteLocal before remote SDP created.");let a=this.peerConnection.getTransceivers().filter(S=>S.mid&&i.indexOf(S.mid)!==-1);if(a.length!==i.length)throw new Error("Transceivers' length doesn't match mids' length.");a.map(async S=>{S.direction="sendonly"});let c=await this.peerConnection.createOffer(),u=this.logSDPExchange(c.sdp||"","offer","local","unmuteLocal");await this.peerConnection.setLocalDescription(c),this.remoteSDP.unmuteRemote(i);let _=this.remoteSDP.toString();u==null||u(_),await this.setRemoteDescription({type:"answer",sdp:_})}catch(a){throw new Ye(oe.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteLocal failed; ".concat(a.toString()))}}async getRemoteSSRC(i,a){var c,u;if(a=(c=a)!==null&&c!==void 0?c:(u=this.currentRemoteDescription)===null||u===void 0?void 0:u.sdp){var _;let S=(_=Dn(a).mediaDescriptions.find(C=>C.attributes.mid===i))===null||_===void 0?void 0:_.attributes.ssrcs;return S==null?void 0:S[0].ssrcId}}async setRemoteDescription(i){var a;await this.peerConnection.setRemoteDescription(i),ft(a=["connected","completed"]).call(a,this.peerConnection.iceConnectionState)||(this.isReady=!0,this.addRemoteCandidate())}mungReceiveAnswerSDP(i,a,c){let u=Dn(i),_=u.mediaDescriptions.find(S=>S.attributes.mid===a);return _&&c===Tt.AUDIO&&_.media.mediaType==="audio"&&ou(_),me(u)}},Ut(ri.prototype,"establish",[mf],Object.getOwnPropertyDescriptor(ri.prototype,"establish"),ri.prototype),Ut(ri.prototype,"connect",[mf],Object.getOwnPropertyDescriptor(ri.prototype,"connect"),ri.prototype),Ut(ri.prototype,"receive",[mf],Object.getOwnPropertyDescriptor(ri.prototype,"receive"),ri.prototype),Ut(ri.prototype,"mockReceive",[mf],Object.getOwnPropertyDescriptor(ri.prototype,"mockReceive"),ri.prototype),Ut(ri.prototype,"stopReceiving",[mf],Object.getOwnPropertyDescriptor(ri.prototype,"stopReceiving"),ri.prototype),Ut(ri.prototype,"restartICE",[mf],Object.getOwnPropertyDescriptor(ri.prototype,"restartICE"),ri.prototype),Ut(ri.prototype,"close",[mf],Object.getOwnPropertyDescriptor(ri.prototype,"close"),ri.prototype),Ut(ri.prototype,"updateEncoderConfig",[mf],Object.getOwnPropertyDescriptor(ri.prototype,"updateEncoderConfig"),ri.prototype),Ut(ri.prototype,"updateSendParameters",[mf],Object.getOwnPropertyDescriptor(ri.prototype,"updateSendParameters"),ri.prototype),Ut(ri.prototype,"replaceTrack",[mf],Object.getOwnPropertyDescriptor(ri.prototype,"replaceTrack"),ri.prototype),Ut(ri.prototype,"muteLocal",[mf],Object.getOwnPropertyDescriptor(ri.prototype,"muteLocal"),ri.prototype),Ut(ri.prototype,"unmuteLocal",[mf],Object.getOwnPropertyDescriptor(ri.prototype,"unmuteLocal"),ri.prototype),ri);function mf(n,i,a){let c=n[i];if(typeof c!="function")throw new Error("Cannot use mutex on object property.");return a.value=async function(){let u=this.mutex,_=await u.lock("From P2PConnection.".concat(i));try{for(var S=arguments.length,C=new Array(S),R=0;R<S;R++)C[R]=arguments[R];return await c.apply(this,C)}finally{_()}},a}let gf=function(n){return n.SEND_ONLY="SEND_ONLY",n.RECEIVE_ONLY="RECEIVE_ONLY",n}({});var e7,Aj,t7,Jr,Oj,a0,Nj,fu,_f,Lj,Dj,pi;function Pj(n,i){var a=Object.keys(n);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(n);i&&(c=c.filter(function(u){return Object.getOwnPropertyDescriptor(n,u).enumerable})),a.push.apply(a,c)}return a}function yA(n){for(var i=1;i<arguments.length;i++){var a=arguments[i]!=null?arguments[i]:{};i%2?Pj(Object(a),!0).forEach(function(c){re(n,c,a[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(a)):Pj(Object(a)).forEach(function(c){Object.defineProperty(n,c,Object.getOwnPropertyDescriptor(a,c))})}return n}let n7=(e7=Ef(gf.SEND_ONLY),Aj=Ef(gf.SEND_ONLY),t7=Ef(),Jr=Ef(gf.RECEIVE_ONLY),Oj=Ef(gf.RECEIVE_ONLY),a0=Ef(gf.RECEIVE_ONLY),Nj=Ef(gf.RECEIVE_ONLY),fu=Ef(gf.RECEIVE_ONLY),_f=Ef(gf.RECEIVE_ONLY),Lj=Ef(),Dj=Ef(gf.RECEIVE_ONLY),pi=class extends li{get state(){return this._state}set state(n){let i=this._state;this._state=n,this.emit(Mt.StateChange,i,this._state)}constructor(n,i){super(),re(this,"isPlanB",!1),re(this,"store",void 0),re(this,"statsUploader",void 0),re(this,"sendConnection",void 0),re(this,"recvConnection",void 0),re(this,"localTrackMap",new Map),re(this,"remoteUserMap",new Map),re(this,"localDataChannels",[]),re(this,"pendingLocalTracks",[]),re(this,"pendingRemoteTracks",[]),re(this,"statsCollector",void 0),re(this,"dtlsFailedCount",0),re(this,"sendMutex",void 0),re(this,"recvMutex",void 0),re(this,"_state",or.Disconnected),re(this,"_restartStates",["disconnected","failed"]),re(this,"reconnectInterval",void 0),re(this,"uploadUnplinkStarted",!1),re(this,"uploadDownlinkStarted",!1),re(this,"uplinkStateUploadInterval",void 0),re(this,"downlinkStatsUploadInterval",void 0),re(this,"handleMuteLocalTrack",async(a,c,u)=>{let _=await this.sendMutex.lock("Locking from P2PChannel2.handleMuteLocalTrack");try{if(!this.sendConnection||this.state!==or.Connected)return void u(new Ye(oe.INVALID_OPERATION,"Cannot call P2PChannel2.handleMuteLocalTrack before sendConnection established."));let R=this.filterTobeMutedTracks(a);if(R.length===0)return void c();let e=R.find(l=>l[0]==="videoLowTrack");e&&e[1].track._originMediaStreamTrack.stop(),await this.sendConnection.muteLocal(R.map(l=>{let[,{id:f}]=l;return f}));let t=!1;var S,C;a.trackMediaType==="video"?t=!((S=this.localTrackMap.get(Qe.LocalAudioTrack))===null||S===void 0||!S.track._muted):t=((C=this.localTrackMap.get(Qe.LocalVideoTrack))===null||C===void 0?void 0:C.id)===void 0;let r=this.createMuteMessage(R);await Vr(this,Mt.RequestMuteLocal,r);let s=a.trackMediaType==="video"?zc.MUTE_LOCAL_VIDEO:zc.MUTE_LOCAL_AUDIO;await Vr(this,Mt.RequestP2PMuteLocal,{action:s,message:r,isMuteAll:t}),c()}catch(R){u(R)}finally{_()}}),re(this,"handleUnmuteLocalTrack",async(a,c,u)=>{let _=await this.sendMutex.lock("Locking from P2PChannel2.handleUnmuteLocalTrack");try{if(!this.sendConnection||this.state!==or.Connected)return void u(new Ye(oe.INVALID_OPERATION,"Cannot call P2PChannel2.handleUnmuteLocalTrack before sendConnection established."));let S=this.filterTobeUnmutedTracks(a);if(S.length===0)return void c();await this.sendConnection.unmuteLocal(S.map(e=>{let[,{id:t}]=e;return t}));let C=this.createUnmuteMessage(S),R=a.trackMediaType==="video"?zc.UNMUTE_LOCAL_VIDEO:zc.UNMUTE_LOCAL_AUDIO;await Vr(this,Mt.RequestP2PMuteLocal,{action:R,message:C}),c()}catch(S){u(S)}finally{_()}}),re(this,"handleUpdateVideoEncoder",async(a,c,u,_)=>{let S;typeof _=="boolean"&&_||(S=await this.sendMutex.lock("Locking from P2PChannel2.handleUpdateVideoEncoder"));try{let R=this.localTrackMap.get(Qe.LocalVideoTrack);if(!this.sendConnection||!R||R.track!==a||this.state!==or.Connected)return void c();let{id:e,track:t}=R;e&&(await this.sendConnection.updateSendParameters(e,t),await this.sendConnection.updateEncoderConfig(e,t),this.emit(Mt.UpdateVideoEncoder,t)),c()}catch(R){u(R)}finally{var C;(C=S)===null||C===void 0||C()}}),re(this,"handleUpdateVideoSendParameters",async(a,c,u)=>{let _=await this.sendMutex.lock("Locking from P2PChannel2.handleUpdateVideoSendParameters");try{let S=this.localTrackMap.get(Qe.LocalVideoTrack);if(!this.sendConnection||!S||S.track!==a||this.state!==or.Connected)return void c();let{id:C,track:R}=S;C&&await this.sendConnection.updateSendParameters(C,R),c()}catch(S){u(S)}finally{_()}}),re(this,"handleReplaceTrack",async(a,c,u,_)=>{let S;z.debug("[".concat(this.store.clientId,"] P2PChannel2 handleReplaceTrack for [track-id-").concat(a.getTrackId(),"]")),typeof _=="boolean"&&_||(S=await this.sendMutex.lock("From P2PChannel2.handleReplaceTrack"));try{var C;let e=Array.from(this.localTrackMap.entries()).find(t=>{let[,{track:r}]=t;return a===r});if(!this.sendConnection||!e||e[1].id===void 0||this.state!==or.Connected)return void c();if(await((C=this.sendConnection)===null||C===void 0?void 0:C.replaceTrack(a,e[1].id)),e[0]===Qe.LocalVideoTrack&&Un().supportDualStreamEncoding){let t=this.localTrackMap.get(Qe.LocalVideoLowTrack);if(t){let r=a._mediaStreamTrack.clone();t.track._originMediaStreamTrack.stop(),t.track._mediaStreamTrack=r,t.track._originMediaStreamTrack=r,await new Et((s,l)=>{this.handleReplaceTrack(t.track,s,l,!0)})}}c()}catch(e){u(e)}finally{var R;(R=S)===null||R===void 0||R()}}),re(this,"handleGetLocalVideoStats",a=>{a(this.statsCollector.getLocalVideoTrackStats())}),re(this,"handleGetLocalAudioStats",a=>{a(this.statsCollector.getLocalAudioTrackStats())}),re(this,"handleGetRemoteVideoStats",a=>this.statsCollector.getRemoteVideoTrackStats(a.uid)[a.uid]),re(this,"handleGetRemoteAudioStats",a=>this.statsCollector.getRemoteAudioTrackStats(a.uid)[a.uid]),this.store=n,this.statsCollector=i,this.statsCollector.addP2PChannel(this),this.statsUploader=new Yo(n),this.bindStatsUploaderEvents(),this.sendMutex=new Na("P2PChannel2-send-mutex",n.clientId),this.recvMutex=new Na("P2PChannel2-recv-mutex",n.clientId),this.reconnectInterval=window.setInterval(()=>{[this.sendConnection,this.recvConnection].forEach(a=>{a&&(a.iceConnectionState!=="disconnected"&&a.iceConnectionState!=="failed"||this.handleDisconnect(a.direction))})},ge("ICE_RESTART_INTERVAL"))}async startP2PConnection(n,i){throw new Ye(oe.NOT_SUPPORTED,"p2p mode does not support startP2PConnection.")}async connect(n){throw new Ye(oe.NOT_SUPPORTED,"p2p mode does not support connect.")}async startP2P(n,i){let a;try{if(i){this.recvConnection&&(z.warning("[".concat(this.store.clientId,"] P2PChannel.startP2P reset recvConnection.")),this.recvConnection.close(),this.unbindConnectionEvents(this.recvConnection)),a=await this.recvMutex.lock("From P2PChannel.startP2P"),this.recvConnection=new eP(n,this.store,Ho.RECEIVE_ONLY),this.bindConnectionEvents(this.recvConnection);let c=await this.recvConnection.establish(i);return{iceParameters:c.iceParameters,dtlsParameters:c.dtlsParameters,sdp:c.sdp}}{this.state=or.New,this.sendConnection&&(z.warning("[".concat(this.store.clientId,"] P2PChannel.startP2P reset sendConnection.")),this.sendConnection.close(),this.unbindConnectionEvents(this.sendConnection)),a=await this.sendMutex.lock("From P2PChannel.startP2P"),this.sendConnection=new eP(n,this.store),this.store.peerConnectionStart(),this.bindConnectionEvents(this.sendConnection);let c=await this.sendConnection.establish();return{iceParameters:c.iceParameters,dtlsParameters:c.dtlsParameters,sdp:c.sdp}}}finally{a&&a()}}async p2pConnect(n){if(!this.sendConnection)throw new Ye(oe.UNEXPECTED_ERROR,"Cannot P2PChannel2.p2pConnect before P2PChannel2.startP2PConnection .");this.store.peerConnectionStart(),await this.sendConnection.connect(n),this.statsUploader.startUploadTransportStats(),this.statsUploader.startUploadExtensionUsageStats(),this.state=or.Connected}async addRemoteCandidate(n,i){if(i===Ho.RECEIVE_ONLY){if(!this.sendConnection)throw new Ye(oe.UNEXPECTED_ERROR,"Cannot P2PChannel2.connect before P2PChannel2.addRemoteCandidate .");await this.sendConnection.addRemoteCandidate(n)}else{if(!this.recvConnection)throw new Ye(oe.UNEXPECTED_ERROR,"Cannot P2PChannel2.connect before P2PChannel2.addRemoteCandidate .");await this.recvConnection.addRemoteCandidate(n)}}publish(n,i,a){var c=this;return Zl(function*(){let u=yield Kn(c.sendMutex.lock("From P2PChannel.publish"));try{if(!c.sendConnection||c.state!==or.Connected){c.throwIfTrackTypeNotMatch(n);let e=n.filter(t=>c.pendingLocalTracks.indexOf(t)===-1);return void(c.pendingLocalTracks=c.pendingLocalTracks.concat(e))}c.store.pubId=c.store.pubId+1,Cs.markPublishStart(c.store.clientId,c.store.pubId);let _=c.filterTobePublishedTracks(n,i,a);if(_.length===0)return void(yield Kn(c.tryToUnmuteAudio(n)));_.forEach(e=>{let{track:t,type:r}=e,s=Date.now();c.store.publish(t.getTrackId(),r===Qe.LocalAudioTrack?"audio":"video",s)}),c.bindLocalTrackEvents(_);let S=yield Kn(c.sendConnection.send(_.map(e=>{let{track:t}=e;return t}),c.store.codec,c.store.audioCodec)),C=(yield Kn(S.next())).value,R=c.createGatewayPublishMessage(_,C);try{yield R}catch(e){throw S.throw(e),(e==null?void 0:e.code)===oe.WS_ABORT&&_.forEach(t=>{let{track:r}=t;c.pendingLocalTracks.indexOf(r)===-1&&c.pendingLocalTracks.push(r)}),c.unbindLocalTrackEvents(_),e}yield Kn(S.next()),_.forEach(e=>{let{type:t}=e;c.statsCollector.addLocalStats(t)}),c.statsUploader.startUploadOutboundStats(),c.assignLocalTracks(_,C),_.forEach(e=>{let{track:t,type:r}=e,s=Date.now();c.store.publish(t.getTrackId(),r===Qe.LocalAudioTrack?"audio":"video",void 0,s)}),c.startUploadUplinkState()}finally{u()}})()}async unpublish(n){if(!this.sendConnection||this.state!==or.Connected)return void(n.length===0?this.pendingLocalTracks.length=0:this.pendingLocalTracks=this.pendingLocalTracks.filter(u=>!ft(n).call(n,u)));let i=this.filterTobeUnpublishedTracks(n);if(i.length===0)return;let a=i.find(u=>u[0]==="videoLowTrack");a&&a[1].track.close();let c=this.createGatewayUnpublishMessage(i);if(await this.sendConnection.stopSending(i.map(u=>{let[,{id:_}]=u;return _})),this.withdrawLocalTracks(i),this.unbindLocalTrackEvents(i.map(u=>{let[_,{track:S}]=u;return{type:_,track:S}})),i.forEach(u=>{let[_]=u;this.statsCollector.removeLocalStats(_)}),this.localTrackMap.size===0&&(this.statsUploader.stopUploadOutboundStats(),this.stopUploadUplinkState()),this.sendConnection&&this.state===or.Connected)return a&&a[1].track.close(),c;n.forEach(u=>{let _=this.pendingLocalTracks.indexOf(u);_!==-1&&this.pendingLocalTracks.splice(_,1)})}startUploadUplinkState(){if(this.uploadUnplinkStarted)return;this.uploadUnplinkStarted=!0,this.uplinkStateUploadInterval&&window.clearInterval(this.uplinkStateUploadInterval);let n=()=>{let i=[],a=[];Array.from(this.localTrackMap.entries()).forEach(c=>{let[u,{track:_,ssrcs:S}]=c,C={stream_type:BI(_,u),ssrcs:S};_._muted||!_._enabled?i.push(C):a.push(C)}),i.length>0&&i.forEach(c=>{Vr(this,Mt.RequestMuteLocal,[c])}),a.length>0&&a.forEach(c=>{Vr(this,Mt.RequestUnmuteLocal,[c])})};n(),this.uplinkStateUploadInterval=window.setInterval(()=>{n()},3e3)}stopUploadUplinkState(){this.uploadUnplinkStarted&&(this.uploadUnplinkStarted=!1,this.uplinkStateUploadInterval&&window.clearInterval(this.uplinkStateUploadInterval))}publishLowStream(n){return Zl(function*(){throw new Ye(oe.NOT_SUPPORTED,"p2p mode does not support publishLowStream.")})()}async republish(){this.pendingLocalTracks.length>0&&(z.debug("[".concat(this.store.clientId,"] Emit P2PChannelEvents.RequestRePublish to republish tracks.")),await Bn(this,Mt.RequestRePublish,this.pendingLocalTracks),this.emit(Mt.MediaReconnectEnd,this.store.uid),this.pendingLocalTracks=[])}async unpublishLowStream(){throw new Ye(oe.NOT_SUPPORTED,"p2p mode does not support unpublishLowStream.")}async subscribe(n,i,a,c){var u;if(!this.recvConnection)throw new Ye(oe.INVALID_OPERATION,"Cannot subscribe remote user when recvConnection disconnected.");if((u=this.remoteUserMap.get(n))!==null&&u!==void 0&&u.has(i))return;let{track:_,mid:S,transceiver:C}=await this.recvConnection.receive(i,[{ssrcId:a}],String(n.uid),c);i===Tt.AUDIO?(n._audioTrack?n._audioTrack._updateOriginMediaStreamTrack(_):(n._audioTrack=new V_(_,n.uid,n._uintid,this.store),z.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote audio track: ").concat(n._audioTrack.getTrackId()))),C&&n._audioTrack._updateRtpTransceiver(C),this.bindRemoteTrackEvents(n,n._audioTrack)):(n._videoSSRC=a,n._videoTrack?n._videoTrack._updateOriginMediaStreamTrack(_):(n._videoTrack=new j_(_,n.uid,n._uintid,this.store),z.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote video track: ").concat(n._videoTrack.getTrackId()))),C&&n._videoTrack._updateRtpTransceiver(C),this.bindRemoteTrackEvents(n,n._videoTrack));let R=this.remoteUserMap.get(n);R?R.set(i,S):this.remoteUserMap.set(n,new Map([[i,S]])),this.statsCollector.addRemoteStats(n.uid),this.statsUploader.startUploadInboundStats(),this.startUploadDownlinkState();let e=this.pendingRemoteTracks.findIndex(t=>{let{user:r,kind:s}=t;return r.uid===n.uid&&i===s});e!==-1&&(this.pendingRemoteTracks.splice(e,1),this.emit(Mt.MediaReconnectEnd,n.uid))}async mockSubscribe(n,i,a,c){if(!this.recvConnection)throw new Ye(oe.INVALID_OPERATION,"Cannot subscribe remote user when recvConnection disconnected.");await this.recvConnection.mockReceive(i,[{ssrcId:a}],String(n.uid),c)}async unsubscribe(n,i,a){let c=this.pendingRemoteTracks.filter(_=>{let{user:S,kind:C}=_;return i!==void 0?S.uid===n.uid&&i===C:S.uid===n.uid});if(c.forEach(_=>{let S=this.pendingRemoteTracks.indexOf(_);this.pendingRemoteTracks.splice(S,1)}),this.recvConnection||a||c.forEach(_=>{let{kind:S}=_;var C;if(S===Tt.AUDIO)(C=n._audioTrack)===null||C===void 0||C._destroy(),n._audioTrack=void 0;else if(S===Tt.VIDEO){var R;(R=n._videoTrack)===null||R===void 0||R._destroy(),n._videoTrack=void 0}}),!this.recvConnection)return;let u=this.filterTobeUnSubscribedTracks(n,i);u.length!==0&&(await this.recvConnection.stopReceiving(u.map(_=>{let[,{id:S}]=_;return S})),this.withdrawRemoteTracks(u),this.remoteUserMap.size===0&&(this.statsUploader.stopUploadInboundStats(),this.stopUploadDownlinkState()),u.forEach(_=>{let[S,{kind:C}]=_;var R,e;if(C===Tt.VIDEO&&S._videoSSRC&&((R=this.recvConnection)===null||R===void 0||R.setStatsRemoteVideoIsReady(S._videoSSRC,!1)),C===Tt.VIDEO)this.unbindRemoteTrackEvents(S._videoTrack),a||((e=S._videoTrack)===null||e===void 0||e._destroy(),S._videoTrack=void 0);else if(C===Tt.AUDIO){var t;this.unbindRemoteTrackEvents(S._audioTrack),!a&&((t=S._audioTrack)===null||t===void 0||t._destroy(),S._audioTrack=void 0)}}),u.forEach(_=>{let[,{kind:S}]=_;Vr(this,Mt.RequestP2PMuteRemote,S)}))}startUploadDownlinkState(){if(this.uploadDownlinkStarted)return;this.uploadDownlinkStarted=!0,this.downlinkStatsUploadInterval&&window.clearInterval(this.downlinkStatsUploadInterval);let n=()=>Array.from(this.remoteUserMap.entries()).forEach(i=>{let[,a]=i;[Tt.VIDEO,Tt.AUDIO].forEach(c=>{a.has(c)?Vr(this,Mt.RequestP2PUnmuteRemote,c):Vr(this,Mt.RequestP2PMuteRemote,c)})});n(),this.downlinkStatsUploadInterval=window.setInterval(()=>{n()},3e3)}stopUploadDownlinkState(){this.uploadDownlinkStarted&&(this.uploadDownlinkStarted=!1,this.downlinkStatsUploadInterval&&window.clearInterval(this.downlinkStatsUploadInterval))}getAllDataChannels(){return this.localDataChannels}async massSubscribe(n){throw new Ye(oe.NOT_SUPPORTED,"p2p mode does not support massSubscribe.")}async massSubscribeNoLock(n){throw new Ye(oe.NOT_SUPPORTED,"p2p mode does not support massSubscribeNoLock.")}async massUnsubscribe(n){throw new Ye(oe.NOT_SUPPORTED,"p2p mode does not support massUnsubscribe.")}async massUnsubscribeNoLock(n){throw new Ye(oe.NOT_SUPPORTED,"p2p mode does not support massUnsubscribeNoLock.")}async muteRemote(n,i){if(!this.recvConnection)return;let a=this.remoteUserMap.get(n);if(!a)return void z.warning("[".concat(this.store.clientId,"] P2PChannel2.muteRemote has no remote user ").concat(n.uid,"."));if(!a.get(i))return void z.warning("[".concat(this.store.clientId,"] P2PChannel2.muteRemote has no remote user ").concat(n.uid," media type ").concat(i,"."));let c=i===Tt.VIDEO?n._videoSSRC:n._audioSSRC;c!==void 0&&this.recvConnection.setStatsRemoteVideoIsReady(c,!1)}async unmuteRemote(n,i){return this.unmuteRemoteNoLock(n,i)}async unmuteRemoteNoLock(n,i){if(!this.recvConnection)return;let a=this.remoteUserMap.get(n);if(!a)return void z.warning("[".concat(this.store.clientId,"] P2PChannel2.unmuteRemote has no remote user ").concat(n.uid,"."));a.get(i)||z.warning("[".concat(this.store.clientId,"] P2PChannel2.unmuteRemote has no remote user ").concat(n.uid," media type ").concat(i,"."))}getAllTracks(n){let i=this.localTrackMap.get(Qe.LocalAudioTrack);if((i==null?void 0:i.track)instanceof va){let a=i.track;return Array.from(this.localTrackMap.entries()).filter(c=>{let[u]=c;return u!==Qe.LocalAudioTrack}).filter(c=>{let[u]=c;return!(n&&u===Qe.LocalVideoLowTrack)}).map(c=>{let[,{track:u}]=c;return u}).concat(a.trackList)}return Array.from(this.localTrackMap.entries()).filter(a=>{let[c]=a;return!(n&&c===Qe.LocalVideoLowTrack)}).map(a=>{let[,{track:c}]=a;return c})}reportPublishEvent(n,i,a,c,u){if(n){let S=this.localTrackMap.get(Qe.LocalAudioTrack),C=c?this.localTrackMap.get(Qe.LocalVideoLowTrack):this.localTrackMap.get(Qe.LocalVideoTrack);jt.publish(this.store.sessionId,{eventElapse:Cs.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:n,ec:i,audioName:S==null?void 0:S.track.getTrackLabel(),videoName:C==null?void 0:C.track.getTrackLabel(),screenshare:(C==null?void 0:C.track._hints.indexOf(kr.SCREEN_TRACK))!==-1,audio:!!S,video:!!C,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:u})}else{var _;a||(a=[]);let S=a.find(R=>R instanceof Ui),C=c?(_=this.localTrackMap.get(Qe.LocalVideoTrack))===null||_===void 0?void 0:_.track:a.find(R=>R instanceof ni);jt.publish(this.store.sessionId,{eventElapse:Cs.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:n,ec:i,audioName:S==null?void 0:S.getTrackLabel(),videoName:C==null?void 0:C.getTrackLabel(),screenshare:(C==null?void 0:C._hints.indexOf(kr.SCREEN_TRACK))!==-1,audio:!!S,video:!!C,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:u})}}reportSubscribeEvent(n,i,a,c){let u=c===Tt.VIDEO?a._videoSSRC:a._audioSSRC;u&&jt.subscribe(this.store.sessionId,{succ:n,ec:i,video:c===Tt.VIDEO,audio:c===Tt.AUDIO,peerid:a.uid,subscribeRequestid:c===Tt.VIDEO?a._videoSSRC:a._audioSSRC,p2pid:this.store.p2pId,eventElapse:Cs.measureFromSubscribeStart(this.store.clientId,u)})}reset(){z.debug("[".concat(this.store.clientId,"] P2PChannel2.reset")),this.sendMutex=new Na("P2PChannel2-send-mutex",this.store.clientId),this.sendMutex=new Na("P2PChannel2-recv-mutex",this.store.clientId),this.sendConnection&&(this.sendConnection.close(),this.unbindConnectionEvents(this.sendConnection),this.sendConnection=void 0),this.recvConnection&&(this.recvConnection.close(),this.unbindConnectionEvents(this.recvConnection),this.recvConnection=void 0),this.statsUploader.stopUploadOutboundStats(),this.statsUploader.stopUploadInboundStats(),this.statsUploader.stopUploadTransportStats(),this.statsUploader.stopUploadExtensionUsageStats(),this.stopUploadUplinkState(),this.stopUploadDownlinkState(),this.unbindLocalTrackEvents(),this.unbindAllRemoteTrackEvents(),this.unbindRtpTransceiver();let n=this.localTrackMap.get(Qe.LocalAudioTrack);if((n==null?void 0:n.track)instanceof va){if(n.track.trackList.length>0){let i=n.track;n.track.trackList.forEach(a=>{i.removeAudioTrack(a)})}n.track.close()}this.localTrackMap.clear(),this.remoteUserMap.clear(),this.statsCollector.removeRemoteStats(),this.statsCollector.removeLocalStats(),this.dtlsFailedCount=0,this.pendingLocalTracks=[],this.pendingRemoteTracks=[],this.reconnectInterval&&(window.clearInterval(this.reconnectInterval),this.reconnectInterval=void 0),this.state=or.Disconnected}getStats(n){var i,a;return n?(a=this.recvConnection)===null||a===void 0?void 0:a.getStats():(i=this.sendConnection)===null||i===void 0?void 0:i.getStats()}getRemoteVideoIsReady(n){var i;return((i=this.recvConnection)===null||i===void 0?void 0:i.getRemoteVideoIsReady(n))||!1}getLocalAudioVolume(){let n=this.localTrackMap.get(Qe.LocalAudioTrack);if(n)return n.track.getVolumeLevel()}getLocalVideoSize(){let n=this.localTrackMap.get(Qe.LocalVideoTrack);if(n)return{width:n.track.videoWidth||0,height:n.track.videoHeight||0}}getEncoderConfig(n){let i=this.localTrackMap.get(n);return i&&i.track instanceof ni||i&&i.track instanceof Ui?i.track._encoderConfig:void 0}getLocalMedia(n){return this.localTrackMap.get(n)}hasLocalMedia(){return this.localTrackMap.size>0}hasRemoteMedia(n,i){if(!n)return this.remoteUserMap.size>0;let a=this.remoteUserMap.get(n);return!!a&&(!i||a.has(i))}async hasRemoteMediaWithLock(n,i){if(!n)return this.remoteUserMap.size>0;let a=this.remoteUserMap.get(n);return!!a&&(!i||a.has(i))}getRemoteMedia(n){var i;let a=Array.from(td(i=this.remoteUserMap).call(i)).find(c=>c.uid===n);return a?{audioTrack:a.audioTrack,audioSSRC:a._audioSSRC,videoTrack:a.videoTrack,videoSSRC:a._videoSSRC}:{}}getAudioLevels(){let n=Array.from(this.remoteUserMap.entries()).map(a=>{let[c]=a;return{uid:c.uid,level:c.audioTrack?100*c.audioTrack._source.getAccurateVolumeLevel():0}}),i=this.localTrackMap.get(Qe.LocalAudioTrack);return i&&n.push({level:100*i.track._source.getAccurateVolumeLevel(),uid:this.store.uid}),n=CR(n).call(n,(a,c)=>a.level-c.level),n}async disconnectForReconnect(){this.sendConnection&&this.recvConnection&&(z.debug("[".concat(this.store.clientId,"] P2PChannel2.disconnectForReconnect closing P2PConnection")),this.state=or.Reconnecting,ge("KEEP_LAST_FRAME")&&this.remoteUserMap.size!==0&&Array.from(this.remoteUserMap.entries()).forEach(n=>{let[i]=n;var a;i._videoTrack&&i._videoTrack._player&&((a=i._videoTrack._player.getVideoElement())===null||a===void 0||a.pause(),i._videoTrack._player.isKeepLastFrame=!0,i._videoTrack._originMediaStreamTrack.stop())}),this.sendConnection.close(),this.unbindConnectionEvents(this.sendConnection),this.sendConnection=void 0,this.recvConnection.close(),this.unbindConnectionEvents(this.recvConnection),this.recvConnection=void 0,this.localTrackMap.size!==0&&(Array.from(this.localTrackMap.entries()).forEach(n=>{var i;let[a,{track:c}]=n;switch(a){case Qe.LocalVideoTrack:ft(i=c._hints).call(i,kr.LOW_STREAM)?c.close():this.pendingLocalTracks.push(c);break;case Qe.LocalAudioTrack:c instanceof va?this.pendingLocalTracks=this.pendingLocalTracks.concat(c.trackList):this.pendingLocalTracks.push(c);case Qe.LocalVideoLowTrack:}}),this.emit(Mt.MediaReconnectStart,this.store.uid)),this.unbindLocalTrackEvents(),this.localTrackMap.clear(),this.remoteUserMap.size!==0&&Array.from(this.remoteUserMap.entries()).forEach(n=>{let[i,a]=n;Array.from(td(a).call(a)).forEach(c=>{this.setPendingRemoteMedia(i,c)}),this.emit(Mt.MediaReconnectStart,i.uid)}),this.unbindAllRemoteTrackEvents(),this.remoteUserMap.clear(),this.stopUploadUplinkState(),this.stopUploadDownlinkState(),this.statsUploader.stopUploadOutboundStats(),this.statsUploader.stopUploadInboundStats(),this.statsUploader.stopUploadTransportStats(),z.debug("[".concat(this.store.clientId,"] P2PChannel2 disconnected, waiting to reconnect.")))}hasPendingRemoteMedia(n,i){for(let a of this.pendingRemoteTracks){let{user:c,kind:u}=a;if((n instanceof Hg?n.uid:n)===c.uid&&i===u)return!0}return!1}setPendingRemoteMedia(n,i){this.hasPendingRemoteMedia(n,i)||this.pendingRemoteTracks.push({user:n,kind:i})}async restartICE(n,i){let a,c;if(n===Ho.SEND_ONLY){if(!this.sendConnection)throw new Ye(oe.INVALID_OPERATION,"Cannot call P2PChannel2.handleMuteLocalTrack before sendConnection established.");a=await this.sendMutex.lock("From P2PChannel.restartICE"),c=this.sendConnection}else{if(!this.recvConnection)throw new Ye(oe.INVALID_OPERATION,"Cannot call P2PChannel2.handleMuteLocalTrack before recvConnection established.");a=await this.recvMutex.lock("From P2PChannel.restartICE"),c=this.recvConnection}try{if(i){let u=await c.restartICE(i);return c.isInRestartIce=!1,u}{let u=await c.restartICE();if(u){let _=await Bn(this,Mt.RequestP2PRestartICE,{direction:Ho.RECEIVE_ONLY,iceParameter:u});await c.restartICE(_),c.isInRestartIce=!1}}}finally{a()}}getUplinkNetworkQuality(){if(!this.sendConnection)return 0;let n=this.sendConnection.getStats(),i=this.localTrackMap.get(Qe.LocalVideoTrack),a=this.localTrackMap.get(Qe.LocalAudioTrack),c=n.videoSend.find(l=>{var f;return l.ssrc===(i==null||(f=i.ssrcs)===null||f===void 0?void 0:f[0].ssrcId)}),u=n.audioSend.find(l=>{var f;return l.ssrc===(a==null||(f=a.ssrcs)===null||f===void 0?void 0:f[0].ssrcId)});if(!c||!u)return 1;let _=ed(this,Mt.NeedSignalRTT),S=c?c.rttMs:void 0,C=u?u.rttMs:void 0,R=S&&C?(S+C)/2:S||C,e=(R&&_?(R+_)/2:R||_)||0,t=100*n.sendPacketLossRate*.7/50+.3*e/1500,r=t<.17?1:t<.36?2:t<.59?3:t<.1?4:5,s=i==null?void 0:i.track;if(s&&s._encoderConfig&&s._hints.indexOf(kr.SCREEN_TRACK)===-1){let l=s._encoderConfig.bitrateMax,f=n.bitrate.actualEncoded;if(l&&f){let m=(1e3*l-f)/(1e3*l);return tf[m<.15?0:m<.3?1:m<.45?2:m<.6?3:4][r]}}return r}getDownlinkNetworkQuality(){if(!this.recvConnection)return 0;let n=this.recvConnection.getStats(),i=0;return Array.from(this.remoteUserMap.entries()).forEach(a=>{let[c]=a,u=c._audioSSRC,_=c._videoSSRC,S=n.audioRecv.find(f=>f.ssrc===u),C=n.videoRecv.find(f=>f.ssrc===_);if(!S&&!C)return void(i+=1);let R=ed(this,Mt.NeedSignalRTT),e=n.rtt,t=(e&&R?(e+R)/2:e||R)||0,r=S?S.jitterMs:void 0,s=n.recvPacketLossRate,l=.7*s*100/50+.3*t/1500;r&&(l=.6*s*100/50+.2*t/1500+.2*r/400),i+=l<.1?1:l<.17?2:l<.36?3:l<.59?4:5}),this.remoteUserMap.size>0?Math.round(i/this.remoteUserMap.size):i}async muteLocalTrack(n){return new Et((i,a)=>{this.handleMuteLocalTrack(n,i,a)})}filterTobePublishedTracks(n,i,a){let c=[],u=Un(),_=this.getAllTracks();n=L_(n=n.filter(R=>_.indexOf(R)===-1));let S=!1,C=!1;for(let R of n){if(R instanceof ni&&(this.localTrackMap.has(Qe.LocalVideoTrack)||S?new Ye(oe.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS).throw():(c.push({track:R,type:Qe.LocalVideoTrack}),S=!0),i)){let e=this.getLowVideoTrack(R,a);c.push({track:e,type:Qe.LocalVideoLowTrack})}if(R instanceof Ui){let e=this.localTrackMap.get(Qe.LocalAudioTrack);if(e){if(!(e.track instanceof va))throw new Ye(oe.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser does not support audio mixing");if(R._bypassWebAudio)throw new Ye(oe.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");e.track.addAudioTrack(R),this.bindLocalAudioTrackEvents(R,!0)}else if(C){let t=c.find(r=>{let{type:s}=r;return s===Qe.LocalAudioTrack});if(!(t.track instanceof va))throw new Ye(oe.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser does not support audio mixing");if(R._bypassWebAudio)throw new Ye(oe.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");t.track.addAudioTrack(R)}else{if(!u.webAudioMediaStreamDest||R instanceof va||R._bypassWebAudio)c.push({track:R,type:Qe.LocalAudioTrack});else{let t=new va;t.addAudioTrack(R),c.push({track:t,type:Qe.LocalAudioTrack})}C=!0}}}return c}filterTobeUnpublishedTracks(n){let i=[],a=this.getAllTracks();n=L_(n=n.filter(c=>a.indexOf(c)!==-1));for(let c of n){if(c instanceof Ui){let u=this.localTrackMap.get(Qe.LocalAudioTrack);if(!u)continue;u.track instanceof va?(u.track.removeAudioTrack(c),this.unbindLocalAudioTrackEvents(c),u.track.trackList.length===0&&(i.push([Qe.LocalAudioTrack,u]),u.track.close())):i.push([Qe.LocalAudioTrack,u])}if(c instanceof ni){let u=this.localTrackMap.get(Qe.LocalVideoTrack);if(!u)continue;i.push([Qe.LocalVideoTrack,u]);let _=this.localTrackMap.get(Qe.LocalVideoLowTrack);_&&i.push([Qe.LocalVideoLowTrack,_])}}return i}bindLocalTrackEvents(n){n.forEach(i=>{let{track:a,type:c}=i;switch(c){case Qe.LocalVideoTrack:a.addListener(bt.GET_STATS,this.handleGetLocalVideoStats),a.addListener(bt.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),a.addListener(bt.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),a.addListener(bt.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),a.addListener(bt.NEED_UPDATE_VIDEO_SEND_PARAMETERS,this.handleUpdateVideoSendParameters),a.addListener(bt.NEED_REPLACE_TRACK,this.handleReplaceTrack),a.addListener(bt.NEED_MUTE_TRACK,this.handleMuteLocalTrack),a.addListener(bt.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case Qe.LocalAudioTrack:this.bindLocalAudioTrackEvents(a);case Qe.LocalVideoLowTrack:}})}bindLocalAudioTrackEvents(n,i){n instanceof va?n.trackList.forEach(a=>{a.addListener(bt.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),a.addListener(bt.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),a.addListener(bt.GET_STATS,this.handleGetLocalAudioStats),a.addListener(bt.NEED_MUTE_TRACK,this.handleMuteLocalTrack),a.addListener(bt.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):(n.addListener(bt.GET_STATS,this.handleGetLocalAudioStats),n.addListener(bt.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),n.addListener(bt.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),n.addListener(bt.NEED_MUTE_TRACK,this.handleMuteLocalTrack),n.addListener(bt.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack),i||n.addListener(bt.NEED_REPLACE_TRACK,this.handleReplaceTrack))}unbindLocalTrackEvents(n){n||(n=Array.from(this.localTrackMap.entries()).map(i=>{let[a,{track:c}]=i;return{track:c,type:a}})),n.forEach(i=>{let{track:a,type:c}=i;switch(c){case Qe.LocalVideoTrack:a.off(bt.GET_STATS,this.handleGetLocalVideoStats),a.off(bt.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),a.off(bt.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),a.off(bt.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),a.off(bt.NEED_UPDATE_VIDEO_SEND_PARAMETERS,this.handleUpdateVideoSendParameters),a.off(bt.NEED_REPLACE_TRACK,this.handleReplaceTrack),a.off(bt.NEED_MUTE_TRACK,this.handleMuteLocalTrack),a.off(bt.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case Qe.LocalAudioTrack:this.unbindLocalAudioTrackEvents(a);case Qe.LocalVideoLowTrack:}})}unbindLocalAudioTrackEvents(n){n instanceof va?n.trackList.forEach(i=>{i.off(bt.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),i.off(bt.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),i.off(bt.GET_STATS,this.handleGetLocalAudioStats),i.off(bt.NEED_MUTE_TRACK,this.handleMuteLocalTrack),i.off(bt.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):(n.off(bt.GET_STATS,this.handleGetLocalAudioStats),n.off(bt.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),n.off(bt.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),n.off(bt.NEED_REPLACE_TRACK,this.handleReplaceTrack),n.off(bt.NEED_MUTE_TRACK,this.handleMuteLocalTrack),n.off(bt.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack))}bindRemoteTrackEvents(n,i){i instanceof j_&&i.addListener(bt.GET_STATS,a=>{a(this.handleGetRemoteVideoStats(n))}),i instanceof V_&&i.addListener(bt.GET_STATS,a=>{a(this.handleGetRemoteAudioStats(n))})}unbindRemoteTrackEvents(n){n&&n.removeAllListeners(bt.GET_STATS)}unbindAllRemoteTrackEvents(){Array.from(this.remoteUserMap.entries()).forEach(n=>{let[i,a]=n;a.has(Tt.AUDIO)&&this.unbindRemoteTrackEvents(i._audioTrack),a.has(Tt.VIDEO)&&this.unbindRemoteTrackEvents(i._videoTrack)})}createGatewayPublishMessage(n,i){return n.map((a,c)=>{var u;let _,{track:S,type:C}=a;switch(C){case Qe.LocalAudioTrack:_=lr.Audio;break;case Qe.LocalVideoTrack:_=ft(u=S._hints).call(u,kr.SCREEN_TRACK)?lr.Screen:lr.High;break;case Qe.LocalVideoLowTrack:_=lr.Low}return{kind:C===Qe.LocalAudioTrack?Tt.AUDIO:Tt.VIDEO,stream_type:_,mid:i[c].id,ssrcs:i[c].localSSRC,isMuted:S.muted||!S.enabled}})}createGatewayUnpublishMessage(n){return n.map(i=>{var a;let c,[u,{track:_,ssrcs:S,id:C}]=i;switch(u){case Qe.LocalVideoTrack:c=ft(a=_._hints).call(a,kr.SCREEN_TRACK)?lr.Screen:lr.High;break;case Qe.LocalAudioTrack:c=lr.Audio;break;case Qe.LocalVideoLowTrack:c=lr.Low}return{stream_type:c,ssrcs:S,mid:C}})}assignLocalTracks(n,i){n.forEach((a,c)=>{let{track:u,type:_}=a;this.localTrackMap.set(_,{track:u,id:i[c].id,ssrcs:i[c].localSSRC})})}withdrawLocalTracks(n){n.forEach(i=>{let[a]=i;this.localTrackMap.delete(a)})}bindConnectionEvents(n){n.onConnectionStateChange=async i=>{var a;z.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: ").concat(n.name,".onConnectionStateChange(").concat(i,")")),this.emit(Mt.PeerConnectionStateChange,i),i!=="connected"||this.store.keyMetrics.peerConnectionEnd||this.store.peerConnectionEnd(),i==="connected"&&(n.isInRestartIce=!1),ft(a=this._restartStates).call(a,i)&&!n.isInRestartIce&&(i==="disconnected"&&await Mn(800),n.iceConnectionState!=="disconnected"&&n.iceConnectionState!=="failed"||this.handleDisconnect(n.direction))},n.onICEConnectionStateChange=i=>{i!=="connected"||this.store.keyMetrics.iceConnectionEnd||this.store.iceConnectionEnd(),z.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICEConnectionStateChange(").concat(i,")")),jt.reportApiInvoke(this.store.sessionId,{name:"ICEConnectionStateChange",options:i,tag:Li.TRACER}).onSuccess(),this.emit(Mt.IceConnectionStateChange,i)},n.onICETransportStateChange=i=>{z.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICETransportStateChange(").concat(i,")"))},n.onDTLSTransportStateChange=i=>{z.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportStateChange(").concat(i,")"))},n.onDTLSTransportError=i=>{z.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportError(").concat(i,")"))},n.onFirstAudioDecoded=i=>{var a;let c=Array.from(td(a=this.remoteUserMap).call(a)).find(_=>_._audioSSRC===i);var u;c&&(this.store.subscribe(c.uid,"audio",void 0,void 0,void 0,Date.now()),(u=c.audioTrack)===null||u===void 0||u.emit(Mg.FIRST_FRAME_DECODED),jt.firstRemoteFrame(this.store.sessionId,qt.FIRST_AUDIO_DECODE,di.FIRST_AUDIO_DECODE,{peer:c._uintid,subscribeElapse:Cs.measureFromSubscribeStart(this.store.clientId,i),subscribeRequestid:i,p2pid:this.store.p2pId}))},n.onFirstAudioReceived=i=>{var a;let c=Array.from(td(a=this.remoteUserMap).call(a)).find(u=>u._audioSSRC===i);c&&jt.firstRemoteFrame(this.store.sessionId,qt.FIRST_AUDIO_RECEIVED,di.FIRST_AUDIO_RECEIVED,{peer:c._uintid,subscribeElapse:Cs.measureFromSubscribeStart(this.store.clientId,i),subscribeRequestid:i,p2pid:this.store.p2pId})},n.onFirstVideoDecoded=(i,a,c)=>{this.reportVideoFirstFrameDecoded(i,a,c)},n.onFirstVideoReceived=i=>{var a;let c=Array.from(td(a=this.remoteUserMap).call(a)).find(u=>u._videoSSRC===i);c&&jt.firstRemoteFrame(this.store.sessionId,qt.FIRST_VIDEO_RECEIVED,di.FIRST_VIDEO_RECEIVED,{peer:c._uintid,subscribeElapse:Cs.measureFromSubscribeStart(this.store.clientId,i),subscribeRequestid:i,p2pid:this.store.p2pId})},n.onSelectedLocalCandidateChanged=(i,a)=>{let c=i.candidateType==="relay",u=a.candidateType==="relay";a.candidateType!=="unknown"&&c===u||this.emit(Mt.ConnectionTypeChange,c),z.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedLocalCandidateChanged(").concat(JSON.stringify(Jp(a))," -> ").concat(JSON.stringify(Jp(i)),")"))},n.onSelectedRemoteCandidateChanged=(i,a)=>{z.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedRemoteCandidateChanged(").concat(JSON.stringify(Jp(a))," -> ").concat(JSON.stringify(Jp(i)),")"))},n.onFirstVideoDecodedTimeout=i=>{this.reportVideoFirstFrameDecoded(i,void 0,void 0,!0)},n.onLocalCandidate=i=>{this.emit(Mt.LocalCandidate,{candidate:i,direction:n.direction})}}unbindConnectionEvents(n){n.onConnectionStateChange=void 0,n.onICEConnectionStateChange=void 0,n.onICETransportStateChange=void 0,n.onDTLSTransportStateChange=void 0,n.onDTLSTransportError=void 0,n.onFirstAudioDecoded=void 0,n.onFirstAudioReceived=void 0,n.onFirstVideoDecoded=void 0,n.onFirstVideoReceived=void 0,n.onSelectedLocalCandidateChanged=void 0,n.onSelectedRemoteCandidateChanged=void 0,n.onFirstVideoDecodedTimeout=void 0,n.onLocalCandidate=void 0}async handleDisconnect(n){let i=n===Ho.SEND_ONLY?this.sendConnection:this.recvConnection;i&&!i.isInRestartIce&&(i.isInRestartIce=!0,z.debug("[".concat(this.store.clientId,"] [P2PChannel-").concat(i.name,"] start use restartICE")),n===Ho.SEND_ONLY?this.restartICE(n):Bn(this,Mt.RequestP2PRestartICE,{direction:Ho.SEND_ONLY}))}filterTobeMutedTracks(n){let i=[];if(this.getAllTracks().indexOf(n)===-1)return i;let a=this.localTrackMap.get(Qe.LocalAudioTrack);if(n instanceof Ui&&(a==null?void 0:a.track)instanceof va)return a.track.isActive||i.push([Qe.LocalAudioTrack,a]),i;let c=Array.from(this.localTrackMap.entries()).find(u=>{let[,{track:_}]=u;return n===_});if(c&&(i.push(c),c[0]===Qe.LocalVideoTrack)){let u=this.localTrackMap.get(Qe.LocalVideoLowTrack);u&&i.push([Qe.LocalVideoLowTrack,u])}return i}filterTobeUnmutedTracks(n){let i=[],a=this.localTrackMap.get(Qe.LocalAudioTrack);if(n instanceof Ui&&(a==null?void 0:a.track)instanceof va)return a.track.isActive&&i.push([Qe.LocalAudioTrack,a]),i;let c=Array.from(this.localTrackMap.entries()).find(u=>{let[,{track:_}]=u;return n===_});if(c)if(c[0]===Qe.LocalVideoTrack){i.push(c);let u=this.localTrackMap.get(Qe.LocalVideoLowTrack);u&&i.push([Qe.LocalVideoLowTrack,u])}else i.push(c);return i}createMuteMessage(n){return n.map(i=>{var a;let c,[u,{track:_,ssrcs:S,id:C}]=i;switch(u){case Qe.LocalAudioTrack:c=lr.Audio;break;case Qe.LocalVideoTrack:c=ft(a=_._hints).call(a,kr.SCREEN_TRACK)?lr.Screen:lr.High;break;case Qe.LocalVideoLowTrack:c=lr.Low}return{stream_type:c,ssrcs:S,mid:C}})}createUnmuteMessage(n){return n.map(i=>{var a;let c,[u,{track:_,ssrcs:S,id:C}]=i;switch(u){case Qe.LocalAudioTrack:c=lr.Audio;break;case Qe.LocalVideoTrack:c=ft(a=_._hints).call(a,kr.SCREEN_TRACK)?lr.Screen:lr.High;break;case Qe.LocalVideoLowTrack:c=lr.Low}return{stream_type:c,ssrcs:S,mid:C}})}filterTobeUnSubscribedTracks(n,i){let a=[],c=this.remoteUserMap.get(n);if(!c)return a;if(i){let u=c.get(i);if(!u)return a;a.push([n,{kind:i,id:u}])}else Array.from(c.entries()).forEach(u=>{let[_,S]=u;a.push([n,{kind:_,id:S}])});return a}createUnsubscribeMessage(n){let i=[];return n.forEach(a=>{let[c,{kind:u,id:_}]=a;switch(u){case Tt.VIDEO:return void(c._videoSSRC&&i.push({stream_type:Tt.VIDEO,ssrcId:c._videoSSRC}));case Tt.AUDIO:return void(c._audioSSRC&&i.push({stream_type:Tt.AUDIO,ssrcId:c._audioSSRC}))}}),i}withdrawRemoteTracks(n){n.forEach(i=>{let[a,{kind:c}]=i,u=this.remoteUserMap.get(a);u&&(u.delete(c),Array.from(u.entries()).length===0&&this.remoteUserMap.delete(a))})}async updateBitrateLimit(n){let i=this.localTrackMap.get(Qe.LocalVideoTrack),a=this.localTrackMap.get(Qe.LocalVideoLowTrack);i&&(await i.track.setBitrateLimit(n.uplink),await new Et((c,u)=>{this.handleUpdateVideoEncoder(i.track,c,u,!0)})),a&&n.low_stream_uplink&&(await a.track.setBitrateLimit({max_bitrate:n.low_stream_uplink.bitrate,min_bitrate:n.low_stream_uplink.bitrate||0}),await new Et((c,u)=>{this.handleUpdateVideoEncoder(a.track,c,u,!0)}))}isP2PDisconnected(){if(this.sendConnection&&this.recvConnection){let n=this.sendConnection.peerConnectionState,i=this.recvConnection.peerConnectionState;return n!=="connected"&&i!=="connected"}return!0}async tryToUnmuteAudio(n){for(let i=0;i<n.length;i++)if(n[i]instanceof Ui){let a=this.filterTobeUnmutedTracks(n[i]);if(a.length===0)continue;let c=this.createUnmuteMessage(a);return void await Vr(this,Mt.RequestUnmuteLocal,c)}}bindStatsUploaderEvents(){this.statsUploader.requestStats=n=>this.getStats(n),this.statsUploader.requestLocalMedia=()=>Array.from(this.localTrackMap.entries()).filter(n=>{let[,{ssrcs:i}]=n;return!!i}),this.statsUploader.requestRemoteMedia=()=>Array.from(this.remoteUserMap.entries()),this.statsUploader.requestVideoIsReady=n=>{var i;return!((i=this.recvConnection)===null||i===void 0||!i.getRemoteVideoIsReady(n))},this.statsUploader.requestUpload=(n,i)=>this.emit(Mt.RequestUpload,n,i),this.statsUploader.requestUploadStats=n=>this.emit(Mt.RequestUploadStats,n),this.statsUploader.requestAllTracks=()=>this.getAllTracks()}unbindStatsUploaderEvents(){this.statsUploader.requestStats=void 0,this.statsUploader.requestLocalMedia=void 0,this.statsUploader.requestRemoteMedia=void 0,this.statsUploader.requestVideoIsReady=void 0}async requestReconnect(){this.dtlsFailedCount+=1,await Mn(vL(this.dtlsFailedCount,da)),this.emit(Mt.RequestReconnect)}async reconnectP2P(){}canPublishLowStream(){return this.localTrackMap.has(Qe.LocalVideoTrack)||this.pendingLocalTracks.some(n=>n instanceof ni)}throwIfTrackTypeNotMatch(n){if(n.filter(i=>i instanceof ni).length>1)throw new Ye(oe.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(n.filter(i=>i instanceof Ui).length>1&&(n.some(i=>i instanceof Ui&&i._bypassWebAudio)||!Un().webAudioMediaStreamDest))throw new Ye(oe.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode");for(let i of n){if(i instanceof ni&&this.pendingLocalTracks.some(a=>a instanceof ni))throw new Ye(oe.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(i instanceof Ui&&this.pendingLocalTracks.some(a=>a instanceof Ui)&&(!Un().webAudioMediaStreamDest||i._bypassWebAudio||this.pendingLocalTracks.some(a=>a instanceof Ui&&a._bypassWebAudio)))throw new Ye(oe.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode")}}getLowVideoTrack(n,i){let a=!ge("DISABLE_DUAL_STREAM_USE_ENCODING")&&Un().supportDualStreamEncoding,c=yA(yA({},{width:160,height:120,framerate:15,bitrate:50}),i),u;u=a?n._mediaStreamTrack.clone():HU(n,c);let _=gr(8,"track-low-"),S=new ni(u,yA(yA({},a&&{scaleResolutionDownBy:eD(c,n)}),{},{frameRate:c.framerate,bitrateMax:c.bitrate,bitrateMin:c.bitrate}),void 0,void 0,_);return S.on(Bo.TRANSCEIVER_UPDATED,C=>{n._updateRtpTransceiver(C,qb.LOW_STREAM)}),S._hints.push(kr.LOW_STREAM),n.addListener(bt.NEED_CLOSE,()=>{S.close()}),S}async globalLock(){return this.recvMutex.lock("From P2PChannel2.globalLock")}reportVideoFirstFrameDecoded(n,i,a,c){var u;let _=Array.from(td(u=this.remoteUserMap).call(u)).find(S=>S._videoSSRC===n);if(_){c||this.store.subscribe(_.uid,"video",void 0,void 0,void 0,void 0,Date.now());let S=this.store.keyMetrics,C=S.subscribe.find(R=>R.userId===_.uid&&R.type==="video");jt.firstRemoteVideoDecode(this.store.sessionId,qt.FIRST_VIDEO_DECODE,di.FIRST_VIDEO_DECODE,{peer:_._uintid,videowidth:i,videoheight:a,subscribeElapse:Cs.measureFromSubscribeStart(this.store.clientId,n),subscribeRequestid:n,p2pid:this.store.p2pId,apEnd:S.requestAPEnd||0,apStart:S.requestAPStart||0,joinGwEnd:S.joinGatewayEnd||0,joinGwStart:S.joinGatewayStart||0,pcEnd:S.peerConnectionEnd||0,pcStart:S.peerConnectionStart||0,subscriberEnd:(C==null?void 0:C.subscribeEnd)||0,subscriberStart:(C==null?void 0:C.subscribeStart)||0,videoAddNotify:(C==null?void 0:C.streamAdded)||0,state:c?1:0})}}async remoteMediaSsrcChanged(n,i,a){if(!this.recvConnection)return!1;let c=this.remoteUserMap.get(n);if(!c)return!1;let u=c.get(i);if(!u)return!1;let _=await this.recvConnection.getRemoteSSRC(u);return _!==void 0&&_!==a}isPreSubScribe(n){return!1}async publishDataChannel(n){throw new Ye(oe.NOT_SUPPORTED)}async unpublishDataChannel(n){throw new Ye(oe.NOT_SUPPORTED)}async subscribeDataChannel(n,i){throw new Ye(oe.NOT_SUPPORTED)}async unsubscribeDataChannel(n,i){throw new Ye(oe.NOT_SUPPORTED)}hasPendingRemoteDataChannel(n,i){throw new Ye(oe.NOT_SUPPORTED)}setPendingRemoteDataChannel(n,i){throw new Ye(oe.NOT_SUPPORTED)}async preConnect(n){throw new Ye(oe.NOT_SUPPORTED)}getEstablishParams(){throw new Ye(oe.NOT_SUPPORTED)}async reSubscribe(n){throw new Ye(oe.NOT_SUPPORTED)}async updateVideoStreamParameter(n,i){throw new Ye(oe.NOT_SUPPORTED)}unbindRtpTransceiver(){this.localTrackMap.size!==0&&Array.from(this.localTrackMap.entries()).forEach(n=>{let[i,{track:a}]=n;i===Qe.LocalVideoLowTrack?a._updateRtpTransceiver(void 0,qb.LOW_STREAM):a._updateRtpTransceiver(void 0)})}},Ut(pi.prototype,"p2pConnect",[e7],Object.getOwnPropertyDescriptor(pi.prototype,"p2pConnect"),pi.prototype),Ut(pi.prototype,"unpublish",[Aj],Object.getOwnPropertyDescriptor(pi.prototype,"unpublish"),pi.prototype),Ut(pi.prototype,"unpublishLowStream",[t7],Object.getOwnPropertyDescriptor(pi.prototype,"unpublishLowStream"),pi.prototype),Ut(pi.prototype,"subscribe",[Jr],Object.getOwnPropertyDescriptor(pi.prototype,"subscribe"),pi.prototype),Ut(pi.prototype,"mockSubscribe",[Oj],Object.getOwnPropertyDescriptor(pi.prototype,"mockSubscribe"),pi.prototype),Ut(pi.prototype,"unsubscribe",[a0],Object.getOwnPropertyDescriptor(pi.prototype,"unsubscribe"),pi.prototype),Ut(pi.prototype,"muteRemote",[Nj],Object.getOwnPropertyDescriptor(pi.prototype,"muteRemote"),pi.prototype),Ut(pi.prototype,"unmuteRemote",[fu],Object.getOwnPropertyDescriptor(pi.prototype,"unmuteRemote"),pi.prototype),Ut(pi.prototype,"hasRemoteMediaWithLock",[_f],Object.getOwnPropertyDescriptor(pi.prototype,"hasRemoteMediaWithLock"),pi.prototype),Ut(pi.prototype,"disconnectForReconnect",[Lj],Object.getOwnPropertyDescriptor(pi.prototype,"disconnectForReconnect"),pi.prototype),Ut(pi.prototype,"remoteMediaSsrcChanged",[Dj],Object.getOwnPropertyDescriptor(pi.prototype,"remoteMediaSsrcChanged"),pi.prototype),pi);function Ef(n){return function(i,a,c){let u=i[a];if(typeof u!="function")throw new Error("Cannot use mutex on object property.");return c.value=async function(){for(var _=arguments.length,S=new Array(_),C=0;C<_;C++)S[C]=arguments[C];switch(n){case gf.SEND_ONLY:{let R=await this.sendMutex.lock("From P2PChannel2.".concat(a));try{return await u.apply(this,S)}finally{R()}}case gf.RECEIVE_ONLY:{let R=await this.recvMutex.lock("From P2PChannel2.".concat(a));try{return await u.apply(this,S)}finally{R()}}default:{let R=await this.sendMutex.lock("From P2PChannel2.".concat(a)),e=await this.recvMutex.lock("From P2PChannel2.".concat(a));try{return await u.apply(this,S)}finally{R(),e()}}}},c}}class sE extends li{constructor(i,a){super(),re(this,"signal",void 0),re(this,"token",void 0),re(this,"tokenTimeout",void 0),re(this,"tokenInterval",void 0),re(this,"_sequence",0),re(this,"userMap",new Map),re(this,"encoder",new TextEncoder),this.signal=i,this.token=a;let c=()=>{this.signal.connectionState===qr.CONNECTED&&this.check(),this.userMap.size===0?this.tokenInterval=window.setTimeout(c,1e3):this.tokenInterval=window.setTimeout(c,3*ge("P2P_TOKEN_INTERVAL"))};c()}async send(i,a,c,u,_){var S,C,R;if(this.userMap.size===0)return;let e=Array.from(Pc(S=this.userMap).call(S))[0].token;typeof a!="string"&&(a=JSON.stringify(a)),u=(C=u)!==null&&C!==void 0?C:gr(6,""),_=(R=_)!==null&&R!==void 0?R:this._sequence++;let t={_id:u,_type:i,_seq:_,_message:a,token:"".concat(this.token,"_").concat(e)};ge("SHOW_P2P_LOG")&&z.debug("send message",t,"noNeedResponse : ".concat(c)),this.splitMessage(JSON.stringify(t)).forEach(s=>{this.signal.request(ln.DATA_STREAM,{payload:Gs(this.encoder.encode(s))})});let r=new Et((s,l)=>{let f=window.setTimeout(()=>{this.off("res-@".concat(u,"_ack"),m),this.off("res-@".concat(u),y),this.off(Ua.ABORT,E),z.debug("[external-signal] request timeout, type: ".concat(i,", requestId: ").concat(u)),this.userMap.size===0?l(new Ye(oe.INVALID_REMOTE_USER)):l(new Ye(oe.TIMEOUT))},ge("EXTERNAL_SIGNAL_REQUEST_TIMEOUT")),m=()=>{f&&window.clearTimeout(f),this.off(Ua.ABORT,E),c&&s()},E=()=>{f&&window.clearTimeout(f),this.off("res-@".concat(u,"_ack"),m),this.off("res-@".concat(u),y),l(new Ye(oe.EXTERNAL_SIGNAL_ABORT,"type: ".concat(i,", requestId: ").concat(u)))};this.once(Ua.ABORT,E),this.once("res-@".concat(u,"_ack"),m);let y=(A,O)=>{b=!0,f&&window.clearTimeout(f),this.off("res-@".concat(u,"_ack"),m),this.off(Ua.ABORT,E),A==="success"?s(O):l(new Ye(oe.P2P_MESSAGE_FAILED,"request ".concat(i," failed, requestId: ").concat(u)))},b=!1;c||(this.once("res-@".concat(u),y),Mn(ge("SIGNAL_REQUEST_TIMEOUT")).then(()=>{b||z.warning("external_signal request timeout, type: ".concat(i,", requestId: ").concat(u,", ").concat(t))}))});try{return await r}catch(s){if(s.code===oe.TIMEOUT)return await this.send(i,a,c,u,_);throw s}}onMessage(i){var a;let{_uid:c}=i,u,_=this.userMap.get(c);if(_)u=_.splitMessageMap;else{if(this.userMap.size>0||!("_type"in i)||i._type!==ut.CHECK)return;let{token:e}=i;u=new Map,_={uid:c,isStart:!0,token:e,splitMessageMap:u,nextExpectedSequenceNumber:0,receivedMessagesMap:new Map},this.userMap.set(c,_),this.signal.emit(kn.ON_USER_ONLINE,{uid:c}),this.handleUserOnline()}if("id"in i&&"total"in i){var S;let{id:e,total:t}=i,r=(S=u.get(e))!==null&&S!==void 0?S:[];if(r.push(i),u.has(e)||u.set(e,r),r.length!==t)return;{let s=CR(r).call(r,(l,f)=>l.index-f.index).map(l=>l.payload).join("");u.delete(e),(i=JSON.parse(s))._uid=c}}let{_type:C,token:R}=i;if(ft(a=[ut.ACK,ut.CHECK]).call(a,C))return C===ut.CHECK&&this.handleCheckToken(_,R),void this.receiveMessage(i);R==="".concat(_.token,"_").concat(this.token)?this.handleReceivedMessage(i):z.debug('Receive unexpected message", '.concat(R,", cur_token: ").concat(_.token,"_").concat(this.token),i)}check(){let i={_id:gr(6,""),token:this.token,_type:ut.CHECK};ge("SHOW_P2P_LOG")&&z.debug("send message",i),this.signal.request(ln.DATA_STREAM,{payload:Gs(this.encoder.encode(JSON.stringify(i)))})}ack(i){let a={_id:i,_type:ut.ACK,token:this.token};ge("SHOW_P2P_LOG")&&z.debug("send message",a),this.signal.request(ln.DATA_STREAM,{payload:Gs(this.encoder.encode(JSON.stringify(a)))})}response(i,a,c){this.send(ut.RESPONSE,JSON.stringify({success:!c,message:a}),!0,i)}handleReceivedMessage(i){let a=()=>{this.userMap.forEach(e=>{let{receivedMessagesMap:t,nextExpectedSequenceNumber:r}=e;for(;t.has(r);){let s=t.get(r);t.delete(r),this.receiveMessage(s),e.nextExpectedSequenceNumber++}})};if(!i)return void a();let{_uid:c,_seq:u}=i,_=this.userMap.get(c),{receivedMessagesMap:S,isStart:C,nextExpectedSequenceNumber:R}=_;if(u<R)return this.ack(i._id),void z.debug("[external-signal] receive old message, seq: ".concat(u,", ").concat(i._message));S.set(u,i),C&&u===R&&(this.receiveMessage(i),S.delete(R),_.nextExpectedSequenceNumber++,a())}receiveMessage(i){let{_id:a,_type:c,_message:u,_uid:_}=i;if(ge("SHOW_P2P_LOG")&&z.debug("receive message",i),a){let S;switch(i._type!==ut.ACK&&(u&&(S=JSON.parse(u)),this.ack(i._id)),i._type){case ut.CANDIDATE:case ut.CONTROL:this.signal.emit(c,S,_);break;case ut.PUBLISH:case ut.UNPUBLISH:case ut.RESTART_ICE:case ut.CALL:S.uid=_,Bn(this.signal,c,S).then(C=>{this.response(i._id,C)}).catch(()=>{this.response(i._id,void 0,!0)});break;case ut.ACK:this.getListeners("res-@".concat(a,"_ack")).length>0&&this.emit("res-@".concat(a,"_ack"));break;case ut.RESPONSE:{let{success:C,message:R}=S;this.emit("res-@".concat(a),C?"success":"failed",R);break}}}}splitMessage(i){if(i.length<sE.MAX_MESSAGE_SIZE)return[i];let a=[],{remoteToken:c}=JSON.parse(i),u=gr(6,""),_=0,S=800,C=Math.ceil(i.length/S);for(;i.length>0;){_++;let R={id:u,index:_,total:C,payload:i.slice(0,S),token:"".concat(this.token,"_").concat(c)};JSON.stringify(R).length>sE.MAX_MESSAGE_SIZE?S-=50:(a.push(R),i=i.slice(S))}return a.map(R=>JSON.stringify(R))}handleCheckToken(i,a){return i.token!==a?(z.debug("token changed, from ".concat(i.token," to ").concat(a)),this.reset(i.uid,a),!1):(this.tokenTimeout&&(window.clearTimeout(this.tokenTimeout),this.tokenTimeout=void 0),this.tokenTimeout=window.setTimeout(()=>{z.debug("token timeout, ".concat(a)),this.reset(i.uid)},ge("MAX_P2P_TIMEOUT")),!0)}async handleUserOnline(){let i=await Bn(this.signal,ut.CALL,void 0),a=await this.send(ut.CALL,i);this.signal.emit(dn.P2P_CONNECTION,a,!0)}async reset(i,a){let c=this.userMap.get(i);c&&(this.emit(Ua.ABORT),this.signal.emit(kn.ON_USER_OFFLINE,{uid:c.uid,reason:F8.P2P_TOKEN_CHANGED}),this._sequence=0,this.userMap.clear(),a||(z.debug("change local token from ".concat(a," to ").concat(a)),this.token=gr(6,"")))}clear(){this._sequence=0,this.userMap.clear(),this.tokenInterval&&window.clearTimeout(this.tokenInterval),this.tokenInterval=void 0,this.tokenTimeout&&window.clearTimeout(this.tokenTimeout),this.tokenTimeout=void 0,this.emit(Ua.ABORT)}}re(sE,"MAX_SIZE",1),re(sE,"MAX_MESSAGE_SIZE",1024);class r7 extends li{get connectionState(){return this._connectionState}set connectionState(i){i!==this._connectionState&&(this._connectionState=i,i===qr.CONNECTED?this.emit(dn.WS_CONNECTED):i===qr.RECONNECTING?this.emit(dn.WS_RECONNECTING,this._websocketReconnectReason):i===qr.CLOSED&&this.emit(dn.WS_CLOSED,this._disconnectedReason))}get currentURLIndex(){return this.websocket.currentURLIndex}get url(){return this.websocket&&this.websocket.url||null}get rtt(){return this.rttRolling.mean()}constructor(i,a){super(),re(this,"_disconnectedReason",void 0),re(this,"_websocketReconnectReason",void 0),re(this,"_connectionState",qr.CLOSED),re(this,"reconnectToken",void 0),re(this,"p2pToken",void 0),re(this,"websocket",void 0),re(this,"openConnectionTime",void 0),re(this,"clientId",void 0),re(this,"lastMsgTime",Date.now()),re(this,"uploadCache",[]),re(this,"uploadCacheInterval",void 0),re(this,"rttRolling",new Cx(5)),re(this,"pingpongTimer",void 0),re(this,"pingpongTimeoutCount",0),re(this,"joinResponse",void 0),re(this,"multiIpOption",void 0),re(this,"initError",void 0),re(this,"spec",void 0),re(this,"store",void 0),re(this,"_external_signal",void 0),re(this,"onWebsocketMessage",c=>{if(c.data instanceof ArrayBuffer)return void this.emit(dn.ON_BINARY_DATA,c.data);let u=JSON.parse(c.data);if(this.lastMsgTime=Date.now(),Object.prototype.hasOwnProperty.call(u,"_id")){let _="res-@".concat(u._id);this.emit(_,u._result,u._message)}else if(Object.prototype.hasOwnProperty.call(u,"_type")){switch(u._type){case kn.ON_DATA_STREAM:return void this.handleDataStream(u._message);case kn.MUTE_AUDIO:case kn.MUTE_VIDEO:case kn.ON_P2P_LOST:case kn.ON_USER_ONLINE:return;case kn.ON_USER_OFFLINE:let{uid:_}=u._message;return z.debug("[".concat(this.clientId,"] user-offline uid: ").concat(_)),void this._external_signal.reset(_)}if(this.emit(u._type,u._message),u._type===kn.ON_NOTIFICATION&&this.handleNotification(u._message),u._type===kn.ON_USER_BANNED)switch(u._message.error_code){case 14:this.close(ur.UID_BANNED);break;case 15:this.close(ur.IP_BANNED);break;case 16:this.close(ur.CHANNEL_BANNED)}if(u._type===kn.ON_USER_LICENSE_BANNED)switch(u._message.error_code){case Zt.ERR_LICENSE_MISSING:this.close(ur.LICENSE_MISSING);break;case Zt.ERR_LICENSE_EXPIRED:this.close(ur.LICENSE_EXPIRED);break;case Zt.ERR_LICENSE_MINUTES_EXCEEDED:this.close(ur.LICENSE_MINUTES_EXCEEDED);break;case Zt.ERR_LICENSE_PERIOD_INVALID:this.close(ur.LICENSE_PERIOD_INVALID);break;case Zt.ERR_LICENSE_MULTIPLE_SDK_SERVICE:this.close(ur.LICENSE_MULTIPLE_SDK_SERVICE);break;case Zt.ERR_LICENSE_ILLEGAL:this.close(ur.LICENSE_ILLEGAL);break;default:this.close()}}}),this.clientId=i.clientId,this.spec=i,this.store=a,this.websocket=new EU("gateway-".concat(this.clientId),this.spec.retryConfig,!0,ge("JOIN_GATEWAY_USE_DUAL_DOMAIN"),ge("JOIN_GATEWAY_USE_443PORT_ONLY"),a),this.handleWebsocketEvents(),window.addEventListener("offline",()=>{this.connectionState===qr.CONNECTED&&this.reconnect("retry",Ma.OFFLINE)}),this.p2pToken=gr(6,""),this._external_signal=new sE(this,this.p2pToken)}async request(i,a,c,u){let _=gr(6,""),S={_id:_,_type:i,_message:a},C=this.websocket.connectionID,R=()=>new Et((f,m)=>{if(this.connectionState===qr.CONNECTED)return f();let E=()=>{this.off(dn.WS_CLOSED,y),f()},y=()=>{this.off(dn.WS_CONNECTED,E),m(new Ye(oe.WS_ABORT))};this.once(dn.WS_CONNECTED,E),this.once(dn.WS_CLOSED,y)});if(this.connectionState!==qr.CONNECTING&&this.connectionState!==qr.RECONNECTING||i===ln.JOIN||i===ln.REJOIN||await R(),this.websocket.sendMessage(S,!0),u)return;let e=new Et((f,m)=>{let E=!1,y=(A,O)=>{E=!0,f({isSuccess:A==="success",message:O||{}}),this.off(dn.WS_CLOSED,b),this.off(dn.WS_RECONNECTING,b),this.emit(dn.REQUEST_SUCCESS,i,a)};this.once("res-@".concat(_),y);let b=()=>{m(new Ye(oe.WS_ABORT,"type: ".concat(i))),this.off(dn.WS_CLOSED,b),this.off(dn.WS_RECONNECTING,b),this.off("res-@".concat(_),y)};this.once(dn.WS_CLOSED,b),this.once(dn.WS_RECONNECTING,b),Mn(ge("SIGNAL_REQUEST_TIMEOUT")).then(()=>{this.websocket.connectionID!==C||E||(z.warning("[".concat(this.clientId,"] ws request timeout, type: ").concat(i)),this.emit(dn.REQUEST_TIMEOUT,i,a))})}),t=null;try{t=await e}catch(f){if(this.connectionState===qr.CLOSED||i===ln.LEAVE)throw new Ye(oe.WS_ABORT);return!this.spec.forceWaitGatewayResponse||c?f.throw():i===ln.JOIN||i===ln.REJOIN?null:(await R(),await this.request(i,a))}if(t.isSuccess)return t.message;let r=Number(t.message.error_code||t.message.code),s=Hc(r),l=new Ye(oe.UNEXPECTED_RESPONSE,"".concat(s.desc,": ").concat(t.message.error_str),{code:r,data:t.message,desc:s.desc});return s.action==="success"?t.message:(z.warning("[".concat(this.clientId,"] [").concat(this.websocket.connectionID,"] unexpected response from type ").concat(i,", error_code: ").concat(r,", message: ").concat(s.desc,", action: ").concat(s.action)),r===Zt.ERR_TOO_MANY_BROADCASTERS?((i===ln.JOIN||i===ln.REJOIN)&&(this.initError=l,this.close()),l.throw()):s.action==="failed"?l.throw():s.action==="quit"?(this.initError=l,this.close(),l.throw()):(r===Zt.ERR_JOIN_BY_MULTI_IP?(this.multiIpOption=t.message.option,z.warning("[".concat(this.clientId,"] detect multi ip, recover")),this.reconnect("recover",Ma.MULTI_IP)):this.reconnect(s.action,Ma.SERVER_ERROR),i===ln.JOIN||i===ln.REJOIN?null:await this.request(i,a)))}waitMessage(i,a){return new Et(c=>{let u=_=>{(!a||a(_))&&(this.off(i,u),c(_))};this.on(i,u)})}uploadWRTCStats(i){if(!this.store.sessionId)return void z.warn("[".concat(this.clientId,"] no session id when upload wrtc stats"));let a={lts:Date.now(),sid:this.store.sessionId,uid:this.store.intUid,stats:i};this.upload(bI.WRTC_STATS,a)}upload(i,a){let c={_type:i,_message:a};try{this.websocket.sendMessage(c)}catch{let u=ge("MAX_UPLOAD_CACHE")||50;this.uploadCache.push(c),this.uploadCache.length>u&&this.uploadCache.splice(0,1),this.uploadCache.length>0&&!this.uploadCacheInterval&&(this.uploadCacheInterval=window.setInterval(()=>{if(this.connectionState!==qr.CONNECTED)return;let _=this.uploadCache.splice(0,1)[0];this.uploadCache.length===0&&(window.clearInterval(this.uploadCacheInterval),this.uploadCacheInterval=void 0),this.upload(_._type,_._message)},ge("UPLOAD_CACHE_INTERVAL")||2e3))}}send(i,a){let c={_type:i,_message:a};this.websocket.sendMessage(c)}async sendExtensionMessage(i,a,c){return await this._external_signal.send(i,a,c)}init(i){return this.initError=void 0,this.multiIpOption=void 0,this.joinResponse=void 0,this.reconnectToken=void 0,this.openConnectionTime=void 0,new Et((a,c)=>{this.once(dn.WS_CONNECTED,()=>a(this.joinResponse)),this.once(dn.WS_CLOSED,()=>c(this.initError||new Ye(oe.WS_ABORT))),this.connectionState=qr.CONNECTING,this.websocket.init(i).catch(c)})}close(i){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.reconnectToken=void 0,this.joinResponse=void 0,this._external_signal.clear(),this._disconnectedReason=i||ur.LEAVE,this.connectionState=qr.CLOSED,z.debug("[".concat(this.clientId,"] ")+"will close websocket in signal"),this.websocket.close(),this.p2pToken=gr(6,""),this._external_signal.clear(),this._external_signal=new sE(this,this.p2pToken)}async join(){if(!this.joinResponse){this.emit(dn.ABORT_P2P_EXECUTION);let i=await Bn(this,dn.REQUEST_JOIN_INFO),a=await this.request(ln.JOIN,i);if(!a)return this.emit(dn.REPORT_JOIN_GATEWAY,oe.TIMEOUT,this.url||""),!1;this.joinResponse=a,this.emit(dn.JOIN_RESPONSE,this.joinResponse),this.reconnectToken=this.joinResponse.rejoin_token}return this.connectionState=qr.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),!0}reconnect(i,a){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.websocket.reconnect(i,a)}handleDataStream(i){try{var a;let c=fr(i.payload),u=new TextDecoder().decode(c),_=JSON.parse(u);"total"in _&&"id"in _||ft(a=Object.values(ut)).call(a,_._type)?(_._uid=i.uid,this._external_signal.onMessage(_)):this.emit(kn.ON_DATA_STREAM,i)}catch{this.emit(kn.ON_DATA_STREAM,i)}}handleNotification(i){z.debug("[".concat(this.clientId,"] receive notification: "),i);let a=Hc(i.code);if(a.action!=="success"){if(a.action!=="failed")return a.action==="quit"?(a.desc==="ERR_REPEAT_JOIN_CHANNEL"&&this.close(ur.UID_BANNED),void this.close()):void this.reconnect(a.action,Ma.SERVER_ERROR);z.error("[".concat(this.clientId,"] ignore error: "),a.desc)}}handlePingPong(){if(!this.websocket||this.websocket.state!=="connected")return;this.pingpongTimeoutCount>0&&this.rttRolling.add(3e3),this.pingpongTimeoutCount+=1;let i=ge("PING_PONG_TIME_OUT"),a=Date.now();this.pingpongTimeoutCount>=i&&(z.warning("[".concat(this.clientId,"] PINGPONG Timeout. Last Socket Message: ").concat(a-this.lastMsgTime,"ms")),a-this.lastMsgTime>ge("WEBSOCKET_TIMEOUT_MIN"))?this.reconnect("retry",Ma.TIMEOUT):this.request(ln.PING,void 0,!0).then(()=>{this.pingpongTimeoutCount=0;let c=Date.now()-a;this.rttRolling.add(c),ge("REPORT_STATS")&&this.send(ln.PING_BACK,{pingpongElapse:c})}).catch(c=>{})}handleWebsocketEvents(){this.websocket.on(mn.RECONNECT_CREATE_CONNECTION,i=>{this.emit(dn.WS_RECONNECT_CREATE_CONNECTION,i)}),this.websocket.on(mn.ON_MESSAGE,this.onWebsocketMessage),this.websocket.on(mn.CLOSED,()=>{this.connectionState=qr.CLOSED}),this.websocket.on(mn.FAILED,()=>{this._disconnectedReason=ur.NETWORK_ERROR,this.connectionState=qr.CLOSED}),this.websocket.on(mn.RECONNECTING,i=>{this._websocketReconnectReason=i,this.joinResponse=void 0,this.connectionState===qr.CONNECTED?this.connectionState=qr.RECONNECTING:this.connectionState=qr.CONNECTING}),this.websocket.on(mn.WILL_RECONNECT,(i,a,c)=>{i!=="retry"?(z.debug("".concat(this.clientId," websocket will_connect event, renewSession reconnectMode is ").concat(i)),this.reconnectToken=void 0):z.debug("".concat(this.clientId," reconnect mode is retry, no need to renew session")),c(i)}),this.websocket.on(mn.CONNECTED,()=>{this.openConnectionTime=Date.now(),this.join().catch(i=>{if(this.emit(dn.REPORT_JOIN_GATEWAY,i,this.url||""),i instanceof Ye&&i.code===oe.UNEXPECTED_RESPONSE&&i.data.code===Zt.ERR_NO_AUTHORIZED)return z.warning("[".concat(this.clientId,"] reconnect no authorized, recover")),void this.reconnect("recover",Ma.SERVER_ERROR);z.error("[".concat(this.clientId,"] join gateway request failed"),i.toString()),this.spec.forceWaitGatewayResponse?this.reconnect("tryNext",Ma.SERVER_ERROR):(this.initError=i,this.close())})}),this.websocket.on(mn.REQUEST_NEW_URLS,(i,a)=>{Bn(this,dn.REQUEST_RECOVER,this.multiIpOption).then(i).catch(a)}),this.websocket.on(mn.ON_TOKEN_PRIVILEGE_DID_EXPIRE,()=>{this.emit(kn.ON_TOKEN_PRIVILEGE_DID_EXPIRE)})}}let i7={name:"P2PChannel",create:function(n){let{store:i,statsCollector:a}=n;return new n7(i,a)},createSubmodule:function(n){let{store:i,spec:a}=n;return new r7(a,i)}};function Mj(n,i){var a=Object.keys(n);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(n);i&&(c=c.filter(function(u){return Object.getOwnPropertyDescriptor(n,u).enumerable})),a.push.apply(a,c)}return a}function mi(n){for(var i=1;i<arguments.length;i++){var a=arguments[i]!=null?arguments[i]:{};i%2?Mj(Object(a),!0).forEach(function(c){re(n,c,a[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(a)):Mj(Object(a)).forEach(function(c){Object.defineProperty(n,c,Object.getOwnPropertyDescriptor(a,c))})}return n}class a7{constructor(i){re(this,"sessionDesc",void 0),re(this,"localCapabilities",void 0),re(this,"rtpCapabilities",void 0),re(this,"candidates",void 0),re(this,"_originCandidates",void 0),re(this,"iceParameters",void 0),re(this,"dtlsParameters",void 0),re(this,"setup",void 0),re(this,"currentMidIndex",void 0),re(this,"cname",void 0),i=Fn(i);let{iceParameters:a,dtlsParameters:c,candidates:u,rtpCapabilities:_,setup:S,localCapabilities:C,sdkCodec:R,cname:e}=i,t=Dn(`v=0
o=- 0 0 IN IP4 127.0.0.1
s=AgoraGateway
t=0 0
a=group:BUNDLE audio video
a=msid-semantic: WMS
a=ice-lite
m=audio 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendrecv
a=rtcp-mux
a=rtcp-rsize
a=mid:audio
m=video 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendrecv
a=rtcp-mux
a=rtcp-rsize
a=mid:video
`);this.rtpCapabilities=_,this.candidates=u,this._originCandidates=Fn(u),this.iceParameters=a,this.dtlsParameters=c,this.setup=S,this.localCapabilities=C,this.cname=e;for(let r=0;r<t.mediaDescriptions.length;r++){let s=t.mediaDescriptions[r];if(s.attributes.iceUfrag=a.iceUfrag,s.attributes.icePwd=a.icePwd,s.attributes.fingerprints=c.fingerprints,s.attributes.candidates=u,s.attributes.setup=S,s.media.mediaType==="video"){s.media.fmts=_.videoCodecs.map(f=>f.payloadType.toString(10));let l=_.videoCodecs.filter(f=>{var m,E;return(m=f.rtpMap)===null||m===void 0?void 0:ft(E=m.encodingName.toLowerCase()).call(E,R)});l.length===0&&(l=_.videoCodecs),s.attributes.payloads=l,s.attributes.extmaps=_.videoExtensions}s.media.mediaType==="audio"&&(s.media.fmts=_.audioCodecs.map(l=>l.payloadType.toString(10)),s.attributes.payloads=_.audioCodecs,s.attributes.extmaps=_.audioExtensions),t.mediaDescriptions[r]=this.mungMediaDesc(s)}this.sessionDesc=t,this.currentMidIndex=t.mediaDescriptions.length-1}toString(){return me(this.sessionDesc)}send(i,a,c){let{ssrcs:u,ssrcGroups:_}=Bg(a,this.cname),S=this.sessionDesc.mediaDescriptions.find(e=>i===Tt.VIDEO?e.media.mediaType==="video":e.media.mediaType==="audio"),C=u[0].attributes.label,R=u[0].attributes.mslabel;return S.attributes.ssrcs=S.attributes.ssrcs.concat(u),S.attributes.ssrcGroups=S.attributes.ssrcGroups.concat(_),{id:C,mslabel:R}}batchSend(i){return i.map(a=>{let{kind:c,ssrcMsg:u}=a;return this.send(c,u,void 0)})}stopSending(i){this.sessionDesc.mediaDescriptions.forEach(a=>{let c=[],u=[],_=[];a.attributes.ssrcs.forEach(S=>{ft(i).call(i,S.attributes.label||"")?_.push(S):c.push(S)}),a.attributes.ssrcGroups.forEach(S=>{var C;ft(C=_.map(R=>R.ssrcId)).call(C,S.ssrcIds[0])||u.push(S)}),a.attributes.ssrcs=c,a.attributes.ssrcGroups=u})}mute(i){let a=this.sessionDesc.mediaDescriptions.find(c=>c.attributes.mid===i);if(!a)throw new Error("mediaDescription not found with ".concat(i," in remote SDP when calling RemoteSDP.mute."));a.attributes.direction="inactive"}unmute(i){let a=this.sessionDesc.mediaDescriptions.find(c=>c.attributes.mid===i);if(!a)throw new Error("mediaDescription not found with ".concat(i," in remote SDP when calling RemoteSDP.unmute."));a.attributes.direction="sendonly"}receive(i,a,c){i.forEach((u,_)=>{let S=u._mediaStreamTrack,C=this.sessionDesc.mediaDescriptions.findIndex(e=>e.attributes.mid===S.kind),R=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[C],u);this.sessionDesc.mediaDescriptions[C]=R})}stopReceiving(i){}updateCandidates(i){let a=this._originCandidates.filter(u=>u.transport==="udp"),c=[];if(a.forEach(u=>{c.push(mi(mi({},u),{},{foundation:"tcpcandidate",priority:Number(u.priority)-1+"",transport:"tcp",port:Number(u.port)+90+""}))}),a.length!==0){switch(i){case hi.TCP_RELAY:this.candidates=c;break;case hi.UDP_TCP_RELAY:case hi.RELAY:this.candidates=[...a,...c];break;default:this.candidates=a}for(let u of this.sessionDesc.mediaDescriptions)u.attributes.candidates=this.candidates}}restartICE(i){i=Fn(i),this.iceParameters=i,this.sessionDesc.mediaDescriptions.forEach(a=>{a.attributes.iceUfrag=i.iceUfrag,a.attributes.icePwd=i.icePwd})}predictReceivingMids(i){let a=[];for(let c=0;c<i;c++)a.push((this.currentMidIndex+c+1).toString(10));return a}mungRecvMediaDsec(i,a){let c=Fn(i);return au(c,a),rD(c,a),c}updateRecvMedia(i,a){let c=this.sessionDesc.mediaDescriptions.findIndex(u=>u.attributes.mid===i);if(c!==-1){let u=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[c],a);this.sessionDesc.mediaDescriptions[c]=u}}bumpMid(i){this.currentMidIndex+=i}updateTrackLabel(i,a,c){let u=this.sessionDesc.mediaDescriptions.find(S=>i===Tt.VIDEO?S.attributes.mid==="video":S.attributes.mid==="audio");if(u){let S=u.attributes.ssrcs.find(C=>C.attributes.label===a);var _;S&&(S.attributes.label=c,(_=S.attributes.msid)===null||_===void 0||_.replace(a,c))}}mungMediaDesc(i){let a=Fn(i);return u1(a),function(c){let u=c.attributes.extmaps.find(_=>kS(_.extensionName));u&&c.attributes.extmaps.splice(c.attributes.extmaps.indexOf(u),1),c.attributes.payloads.forEach(_=>{let S=_.rtcpFeedbacks.findIndex(C=>C.type==="transport-cc");S!==-1&&_.rtcpFeedbacks.splice(S,1)})}(a),a}getSSRC(i){for(let a of this.sessionDesc.mediaDescriptions)for(let c of a.attributes.ssrcs)if(c.attributes.label===i)return[c]}}var Or;function s7(n,i){var a=Object.keys(n);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(n);i&&(c=c.filter(function(u){return Object.getOwnPropertyDescriptor(n,u).enumerable})),a.push.apply(a,c)}return a}function hd(n){for(var i=1;i<arguments.length;i++){var a=arguments[i]!=null?arguments[i]:{};i%2?s7(Object(a),!0).forEach(function(c){re(n,c,a[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(a)):s7(Object(a)).forEach(function(c){Object.defineProperty(n,c,Object.getOwnPropertyDescriptor(a,c))})}return n}let ty=(Or=class n5 extends bo{get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get localCodecs(){return[...new Set(this.localCapabilities&&this.localCapabilities.videoCodecs.map(i=>i.rtpMap&&i.rtpMap.encodingName.toLowerCase()||"").filter(i=>{var a;return ft(a=Object.keys(Gp)).call(a,i)}))]}constructor(i,a){super(i,a),re(this,"store",void 0),re(this,"peerConnection",void 0),re(this,"remoteSDP",void 0),re(this,"initialOffer",void 0),re(this,"statsFilter",void 0),re(this,"useRTX",!1),re(this,"localCapabilities",void 0),re(this,"localCandidateCount",0),re(this,"allCandidatesReceived",!1),re(this,"establishPromise",void 0),re(this,"mutex",void 0),this.store=a,this.mutex=new Na("P2PConnection-mutex",a.clientId),this.peerConnection=new RTCPeerConnection(n5.resolvePCConfiguration(i),{optional:[{googDscp:!0}]}),this.statsFilter=bL(this.peerConnection,ge("STATS_UPDATE_INTERVAL"),void 0,Ni()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1,this.establishPromise=this.establish()}async establish(){try{let i=await this.peerConnection.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});if(!i.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");let a=Vg(i.sdp),c=Co(i.sdp,{filterRTX:!this.useRTX,filterVideoFec:ge("FILTER_VIDEO_FEC"),filterAudioFec:ge("FILTER_AUDIO_FEC"),filterAudioCodec:["opus"]});return this.localCapabilities=c,this.initialOffer=i,hd(hd({},a),{},{rtpCapabilities:{send:{audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},recv:{audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},sendrecv:c},offerSDP:i.sdp})}catch(i){throw new Ye(oe.GET_LOCAL_CONNECTION_PARAMS_FAILED,i.toString())}}async updateRemoteConnect(){}async connect(i){try{if(!this.initialOffer)throw new Error("Cannot establish P2PConnection without initial offer.");this.remoteSDP=new a7(hd(hd({},i),{},{rtpCapabilities:i.rtpCapabilities.send,localCapabilities:this.localCapabilities,sdkCodec:this.store.codec}));let a=this.remoteSDP.toString();await this.peerConnection.setLocalDescription(this.initialOffer),await this.peerConnection.setRemoteDescription({type:"answer",sdp:a})}catch(a){throw new Ye(oe.EXCHANGE_SDP_FAILED,"P2PConnection.connect failed; ".concat(a.toString()))}}async updateRemoteRTPCapabilities(i,a){throw new Ye(oe.NOT_SUPPORTED,"Planb mode does not support createDataChannels.")}getPreMedia(i){}send(i,a){var c=this;return Zl(function*(){let u=yield Kn(c.mutex.lock());try{if(!c.remoteSDP)throw new Error("Cannot call P2PConnection.send before remote SDP created");let _=i.map(s=>c.peerConnection.addTrack(s._mediaStreamTrack)),S=yield Kn(c.peerConnection.createOffer()),C=Dn(S.sdp),R=i.map(s=>{let l=s._mediaStreamTrack,f=C.mediaDescriptions.find(m=>m.attributes.mid===l.kind);if(!f)throw new Error("Cannot extract ssrc from mediaDescription.");return function(m,E,y){let b=m.attributes.ssrcs.filter(O=>O.attributes.label===E),A=m.attributes.ssrcGroups;if(b.length===0)throw new Error("Cannot extract ssrc from plan-b SDP.");if(A&&b.length>1){let O=A.find(D=>D.ssrcIds.indexOf(b[0].ssrcId)!==-1);return O?[{ssrcId:O.ssrcIds[0],rtx:y?O.ssrcIds[1]:void 0}]:[{ssrcId:b[0].ssrcId}]}return[{ssrcId:b[0].ssrcId}]}(f,l.id,c.useRTX)}),e;try{e=yield R}catch(s){throw _.forEach(l=>{mr()&&l.replaceTrack(null),c.peerConnection.removeTrack(l)}),s}let t=c.mungSendOfferSDP(S.sdp,i);c.remoteSDP.receive(i,a,e);let r=c.remoteSDP.toString();return yield Kn(c.peerConnection.setLocalDescription({type:"offer",sdp:t})),yield Kn(c.applySendEncodings(_,i)),yield Kn(c.peerConnection.setRemoteDescription({type:"answer",sdp:r})),i.map((s,l)=>{let f=s._mediaStreamTrack.id;return{localSSRC:R[l],id:f}})}catch(_){throw new Ye(oe.EXCHANGE_SDP_FAILED,"P2PConnection.send failed; ".concat(_.toString()))}finally{u()}})()}async stopSending(i){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopSending before remote SDP created");let a=this.peerConnection.getSenders().filter(_=>{var S;return i.indexOf(((S=_.track)===null||S===void 0?void 0:S.id)||"")!==-1});if(a.length!==i.length)throw new Error("Transceivers' length doesn't match mids' length when trying to call P2PConnection.stopSending.");a.map(_=>{mr()&&_.replaceTrack(null),this.peerConnection.removeTrack(_)});let c=await this.peerConnection.createOffer();await this.peerConnection.setLocalDescription(c),this.remoteSDP.stopReceiving(i);let u=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"answer",sdp:u})}catch(a){throw new Ye(oe.EXCHANGE_SDP_FAILED,"P2PConnection.stopSending failed; ".concat(a.toString()))}}async receive(i,a,c,u){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(i," before remoteSDP created."));let{id:_,mslabel:S}=this.remoteSDP.send(i,a,u),C=new Et((t,r)=>{let s=setTimeout(()=>{r(new Error("Cannot receive track, id: ".concat(_)))},1e4),l=f=>{let m=En();if((m.name==="Safari"&&Number(m.version)===11||Ea())&&f.track.id!==_&&f.streams[0].id===S){var E;let y=f.streams[0].getTracks()[0];return(E=this.remoteSDP)===null||E===void 0||E.updateTrackLabel(i,_,f.track.id),this.peerConnection.removeEventListener("track",l),clearTimeout(s),void t(y)}if(f.track.id===_)return this.peerConnection.removeEventListener("track",l),clearTimeout(s),void t(f.track)};this.peerConnection.addEventListener("track",l)}),R=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:R});let e=await this.peerConnection.createAnswer();return await this.peerConnection.setLocalDescription(e),{track:await C,id:_}}catch(_){throw new Ye(oe.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(_.toString()))}}async stopReceiving(i){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");this.remoteSDP.stopSending(i);let a=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:a});let c=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(c)}catch(a){throw new Ye(oe.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(a.toString()))}}async muteRemote(i){}async unmuteRemote(i){}async muteLocal(i){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteLocal before remote SDP created.");let a=this.peerConnection.getSenders().filter(c=>{var u;return i.indexOf(((u=c.track)===null||u===void 0?void 0:u.id)||"")!==-1});if(a.length!==i.length)throw new Error("sender' length doesn't match mids' length.");a.map(c=>{if(mr()&&c.track)c.track.enabled=!1;else{let u=c.getParameters();u.encodings.forEach(_=>_.active=!1),c.setParameters(u)}})}catch(a){throw new Ye(oe.EXCHANGE_SDP_FAILED,"P2PConnection.muteLocal failed; ".concat(a.toString()))}}async unmuteLocal(i){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteLocal before remote SDP created.");let a=this.peerConnection.getSenders().filter(_=>{var S;return i.indexOf(((S=_.track)===null||S===void 0?void 0:S.id)||"")!==-1});if(a.length!==i.length)throw new Error("Senders' length doesn't match mids' length.");a.map(async _=>{if(mr()&&_.track)_.track.enabled=!0;else{let S=_.getParameters();S.encodings.forEach(C=>C.active=!0),await _.setParameters(S)}});let c=await this.peerConnection.createOffer();await this.peerConnection.setLocalDescription(c);let u=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"answer",sdp:u})}catch(a){throw new Ye(oe.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteLocal failed; ".concat(a.toString()))}}restartICE(i){var a=this;return Zl(function*(){let c=yield Kn(a.mutex.lock("From P2PConnection.restartICE"));try{if(!a.remoteSDP)throw new Error("Cannot restartICE before remoteSDP created.");let u=Un().supportPCSetConfiguration;if(i===hi.RELAY&&!u)return;if(u){let e=a.peerConnection.getConfiguration(),t=i===hi.RELAY?"relay":"all";e.iceTransportPolicy!==t&&(z.debug("[".concat(a.store.clientId,"] restartICE change iceTransportPolicy from [").concat(e.iceTransportPolicy,"] to [").concat(t,"]")),e.iceTransportPolicy=t,a.peerConnection.setConfiguration(e))}i!==hi.RELAY&&a.remoteSDP.updateCandidates(i);let _=yield Kn(a.peerConnection.createOffer({iceRestart:!0}));if(!_.sdp)throw new Error("Cannot restartICE because restart offer SDP does not exist.");let S=Vg(_.sdp),{remoteIceParameters:C}=yield S.iceParameters;a.remoteSDP.restartICE(C);let R=a.remoteSDP.toString();yield Kn(a.peerConnection.setLocalDescription(_)),yield Kn(a.peerConnection.setRemoteDescription({type:"answer",sdp:R}))}catch(u){z.warning("[".concat(a.store.clientId,"] restart ICE failed, abort operation"),u)}finally{c()}})()}close(){var i;this.peerConnection.close(),(i=this.onConnectionStateChange)===null||i===void 0||i.call(this,"closed"),this.unbindPCEvents(),this.unbindStatsEvents(),this.removeAllListeners(),this.statsFilter.destroy()}getStats(){return this.statsFilter.getStats()}getRemoteVideoIsReady(i){return this.statsFilter.getVideoIsReady(i)}async updateEncoderConfig(i,a){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateEncoderConfig before remote SDP created.");let c=await this.peerConnection.createOffer(),u=this.mungSendOfferSDP(c.sdp,[a]);this.remoteSDP.updateRecvMedia(a._mediaStreamTrack.kind,a);let _=this.remoteSDP.toString();await this.peerConnection.setLocalDescription({type:"offer",sdp:u}),await this.peerConnection.setRemoteDescription({type:"answer",sdp:_})}catch(c){throw new Ye(oe.EXCHANGE_SDP_FAILED,c.toString())}}async updateSendParameters(i,a){let c=this.peerConnection.getSenders().filter(u=>{var _;return((_=u.track)===null||_===void 0?void 0:_.id)===i});c.length===1&&await this.applySendEncodings(c,[a])}setStatsRemoteVideoIsReady(i,a){this.statsFilter.setVideoIsReady2(i,a)}async replaceTrack(i,a){let c=this.peerConnection.getSenders().find(u=>{var _;return((_=u.track)===null||_===void 0?void 0:_.id)===a});c&&await c.replaceTrack(i._mediaStreamTrack)}createDataChannels(i,a){throw new Ye(oe.NOT_SUPPORTED,"Planb mode does not support createDataChannels.")}stopDataChannels(i){throw new Ye(oe.NOT_SUPPORTED,"Planb mode does not support stopDataChannels.")}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var i;(i=this.onICEConnectionStateChange)===null||i===void 0||i.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var i;(i=this.onConnectionStateChange)===null||i===void 0||i.call(this,this.peerConnection.connectionState)},this.peerConnection.onicecandidate=i=>{i.candidate?this.localCandidateCount+=1:(this.peerConnection.onicecandidate=null,this.allCandidatesReceived=!0,z.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount))},setTimeout(()=>{this.allCandidatesReceived||(this.allCandidatesReceived=!0,z.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] onicecandidate timeout, local candidate count"),this.localCandidateCount))},ge("CANDIDATE_TIMEOUT"))}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(i){let a={iceServers:[],sdpSemantics:"plan-b"};return i.iceServers?a.iceServers=i.iceServers:i.turnServer&&i.turnServer.mode!=="off"&&(vS(i.turnServer.servers)?a.iceServers=i.turnServer.servers:(a.iceServers&&a.iceServers.push(...n5.turnServerConfigToIceServers(i.turnServer.servers)),ge("USE_TURN_SERVER_OF_GATEWAY")&&a.iceServers&&i.turnServer.serversFromGateway&&a.iceServers.push(...n5.turnServerConfigToIceServers(i.turnServer.serversFromGateway)),i.turnServer.servers.concat(i.turnServer.serversFromGateway||[]).forEach(c=>{c.forceturn&&(a.iceTransportPolicy="relay")}))),a}static turnServerConfigToIceServers(i){let a=[];return i.forEach(c=>{c.security?c.tcpport&&a.push({username:c.username,credential:c.password,credentialType:"password",urls:"turns:".concat(c.turnServerURL,":").concat(c.tcpport,"?transport=tcp")}):(c.udpport&&a.push({username:c.username,credential:c.password,credentialType:"password",urls:"turn:".concat(c.turnServerURL,":").concat(c.udpport,"?transport=udp")}),c.tcpport&&a.push({username:c.username,credential:c.password,credentialType:"password",urls:"turn:".concat(c.turnServerURL,":").concat(c.tcpport,"?transport=tcp")}))}),a}async updateRtpSenderEncodings(i,a){var c;if(a||(a=this.peerConnection.getSenders().find(e=>{var t;return((t=e.track)===null||t===void 0?void 0:t.id)===i._mediaStreamTrack.id})),!a)return z.warn("[".concat(i.getTrackId(),"] no rtpSender found}"));if(!Un().supportSetRtpSenderParameters)return z.warn("Browser not support set rtp-sender parameters");let u={},_={};if(i instanceof ni)switch(i._optimizationMode){case"motion":u.degradationPreference="maintain-framerate";break;case"detail":u.degradationPreference="maintain-resolution";break;default:u.degradationPreference="balanced"}if(ge("DSCP_TYPE")&&jp()){var S;let e=ge("DSCP_TYPE");ft(S=["very-low","low","medium","high"]).call(S,e)&&(_.networkPriority=e)}let C=a.getParameters(),R=(c=C.encodings)===null||c===void 0?void 0:c[0];R&&Object.assign(R,_),Object.assign(C,u),z.debug("[".concat(i.getTrackId(),"] updateRtpSenderEncodings: ").concat(JSON.stringify(C.encodings))),await a.setParameters(C)}async applySendEncodings(i,a){try{if(!Un().supportSetRtpSenderParameters||i.length!==a.length)return;for(let c=0;c<i.length;c++){let u=i[c],_=a[c];u&&_&&await this.updateRtpSenderEncodings(_,u)}}catch{z.debug("[".concat(this.store.clientId,"] Apply RTPSendEncodings failed."))}}mungSendOfferSDP(i,a){let c=Dn(i);return a.forEach((u,_)=>{let S=u._mediaStreamTrack,C=c.mediaDescriptions.find(R=>R.attributes.mid===S.kind);C&&au(C,u)}),me(c)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=i=>{var a;(a=this.onFirstAudioReceived)===null||a===void 0||a.call(this,i)},this.statsFilter.onFirstVideoReceived=i=>{var a;(a=this.onFirstVideoReceived)===null||a===void 0||a.call(this,i)},this.statsFilter.onFirstAudioDecoded=i=>{var a;(a=this.onFirstAudioDecoded)===null||a===void 0||a.call(this,i)},this.statsFilter.onFirstVideoDecoded=(i,a,c)=>{var u;(u=this.onFirstVideoDecoded)===null||u===void 0||u.call(this,i,a,c)},this.statsFilter.onSelectedLocalCandidateChanged=(i,a)=>{var c;(c=this.onSelectedLocalCandidateChanged)===null||c===void 0||c.call(this,i,a)},this.statsFilter.onSelectedRemoteCandidateChanged=(i,a)=>{var c;(c=this.onSelectedRemoteCandidateChanged)===null||c===void 0||c.call(this,i,a)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0}async batchReceive(i){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.batchReceive before remoteSDP created.");let a=this.remoteSDP.batchSend(i).map((_,S)=>{let{id:C,mslabel:R}=_,{kind:e}=i[S];return new Et((t,r)=>{let s=setTimeout(()=>{r(new Error("Cannot receive track, id: ".concat(C)))},1e4),l=f=>{let m=En();if(m.name==="Safari"&&Number(m.version)===11&&f.track.id!==C&&f.streams[0].id===R){var E;let y=f.streams[0].getTracks()[0];return(E=this.remoteSDP)===null||E===void 0||E.updateTrackLabel(e,C,f.track.id),this.peerConnection.removeEventListener("track",l),clearTimeout(s),void t({track:y,id:C})}if(f.track.id===C)return this.peerConnection.removeEventListener("track",l),clearTimeout(s),void t({track:f.track,id:C})};this.peerConnection.addEventListener("track",l)})}),c=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:c});let u=await this.peerConnection.createAnswer();return await this.peerConnection.setLocalDescription(u),await Et.all(a)}catch(a){throw new Ye(oe.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(a.toString()))}}async getRemoteSSRC(i){if(!this.remoteSDP)return;let a=this.remoteSDP.getSSRC(i);return a==null?void 0:a[0].ssrcId}setConfiguration(i){if(Un().supportPCSetConfiguration){let a=n5.resolvePCConfiguration(i);this.peerConnection.setConfiguration(a)}}},Ut(Or.prototype,"connect",[hu],Object.getOwnPropertyDescriptor(Or.prototype,"connect"),Or.prototype),Ut(Or.prototype,"stopSending",[hu],Object.getOwnPropertyDescriptor(Or.prototype,"stopSending"),Or.prototype),Ut(Or.prototype,"receive",[hu],Object.getOwnPropertyDescriptor(Or.prototype,"receive"),Or.prototype),Ut(Or.prototype,"stopReceiving",[hu],Object.getOwnPropertyDescriptor(Or.prototype,"stopReceiving"),Or.prototype),Ut(Or.prototype,"muteRemote",[hu],Object.getOwnPropertyDescriptor(Or.prototype,"muteRemote"),Or.prototype),Ut(Or.prototype,"unmuteRemote",[hu],Object.getOwnPropertyDescriptor(Or.prototype,"unmuteRemote"),Or.prototype),Ut(Or.prototype,"muteLocal",[hu],Object.getOwnPropertyDescriptor(Or.prototype,"muteLocal"),Or.prototype),Ut(Or.prototype,"unmuteLocal",[hu],Object.getOwnPropertyDescriptor(Or.prototype,"unmuteLocal"),Or.prototype),Ut(Or.prototype,"close",[hu],Object.getOwnPropertyDescriptor(Or.prototype,"close"),Or.prototype),Ut(Or.prototype,"updateEncoderConfig",[hu],Object.getOwnPropertyDescriptor(Or.prototype,"updateEncoderConfig"),Or.prototype),Ut(Or.prototype,"updateSendParameters",[hu],Object.getOwnPropertyDescriptor(Or.prototype,"updateSendParameters"),Or.prototype),Ut(Or.prototype,"replaceTrack",[hu],Object.getOwnPropertyDescriptor(Or.prototype,"replaceTrack"),Or.prototype),Ut(Or.prototype,"getRemoteSSRC",[hu],Object.getOwnPropertyDescriptor(Or.prototype,"getRemoteSSRC"),Or.prototype),Or);function hu(n,i,a){let c=n[i];if(typeof c!="function")throw new Error("Cannot use mutex on object property.");return a.value=async function(){let u=this.mutex,_=await u.lock("Locking from P2PConnection.".concat(i));try{for(var S=arguments.length,C=new Array(S),R=0;R<S;R++)C[R]=arguments[R];return await c.apply(this,C)}finally{_()}},a}let TK={name:"PlanBConnection",create:function(n){let{store:i,spec:a}=n;return new ty(a,i)}},o7={interceptLocalAudioFrame:async function(n){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!Un().supportWebRTCEncodedTransform)return void z.warning("browser not support audio encoded transform");if(gI.has(n)||!n.track)return;let a={track:n.track};if(Vo()){if(!n.createEncodedStreams)return void z.warning("browser not support createEncodedStreams() API");let u=null;try{u=n.createEncodedStreams()}catch(S){return void z.error("create audio-encoded-streams error",S&&S.message)}let _=new TransformStream({transform(S,C){a.controller||(a.controller=C),n.track&&n.track.id!==a.track.id&&(z.debug("audio track changed: ".concat(a.track.id," => ").concat(n.track.id)),a.track.removeEventListener("ended",c),a.track=n.track,a.track.addEventListener("ended",c));let R=i.metadata&&i.metadata();R?function(e,t){let{chunk:r,controller:s}=t,l=ge("ENABLE_AUDIO_PTS_METADATA")?Hp.AUDIO_64_BIT_PTS:Hp.METADATA;r.data=function(f,m,E){let y=E.byteLength,b=y+FL+aU,A=VL+BL+b,O=new ArrayBuffer(f.byteLength+A),D=new DataView(O);D.setUint8(0,iU),D.setUint16(1,b),D.setUint8(3,m),D.setUint16(4,y);for(let F=0;F<y;F++)D.setUint8(6+F,E[F]);let P=new Uint8Array(D.buffer);return P.set(new Uint8Array(f),A),P.buffer}(r.data,l,e),s.enqueue(r)}(R,{chunk:S,controller:C}):C.enqueue(S)}});u.readable.pipeThrough(_).pipeTo(u.writable)}else if(mr()){if(typeof RTCRtpScriptTransform>"u")return void z.warning("browser not support RTCRtpScriptTransform");let u=Gc(),_=new MessageChannel;await new Et(C=>u.onmessage=R=>{R.data==="registered"&&C(void 0)});let S=new RTCRtpScriptTransform(u,{name:"audio-metadata-tx",port:_.port2},[_.port2]);n.transform=S,await new Et(C=>u.onmessage=R=>{R.data==="started"&&C(void 0)}),_.port1.onmessage=C=>{var R;if(C.data.transformed&&n.track&&((R=n.track)===null||R===void 0?void 0:R.id)!==a.track.id)z.debug("audio track changed: ".concat(a.track.id," => ").concat(n.track.id)),a.track.removeEventListener("ended",c),a.track=n.track,a.track.addEventListener("ended",c);else if(C.data.getMetadata){let e=i.metadata&&i.metadata();e&&_.port1.postMessage({metadata:e})}},a.worker=u}function c(){if(n.track){if(this.id!==n.track.id)return;n.track.removeEventListener("ended",c)}let u=gI.get(n);if(u){gI.delete(n);try{var _,S;(_=u.controller)===null||_===void 0||_.terminate(),(S=u.worker)===null||S===void 0||S.terminate()}catch(C){z.warning(C&&C.message)}}}gI.set(n,a),n.track.addEventListener("ended",c)},interceptRemoteAudioFrame:async function(n){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!Un().supportWebRTCEncodedTransform)return void z.warning("browser not support audio encoded transform");if(HL.has(n))return;let a={track:n.track,onMetadata:i.onMetadata};if(Vo()){if(!n.createEncodedStreams)return void z.warning("browser not support createEncodedStreams() API");fL(cr.CHROME,87,116)||(i.enableTopn=!1);let u=null;try{u=n.createEncodedStreams()}catch(S){return void z.error("create audio-encoded-streams error",S&&S.message)}let _=new TransformStream({transform(S,C){a.controller||(a.controller=C),n.track&&n.track.id!==a.track.id&&(z.debug("audio track changed: ".concat(a.track.id," => ").concat(n.track.id)),a.track.removeEventListener("ended",c),a.track=n.track,a.track.addEventListener("ended",c)),i.enableTopn?function(R,e,t){var r;let s=io(new DataView(e.data));if(!s)return t.enqueue(e);let l=R.track.id;L8.set(l,R.track);let f=(r=s.tlv.find(O=>O.tag===Hp.AUDIO_LEVEL))===null||r===void 0?void 0:r.value,m=0;typeof f=="number"&&(m=127-f);let E=Math.round(Math.pow(10,m/60)-1),{selected:y,speaker:b}=function(O,D){let P=OS.get(O);if(P||(P=function(F){let B=new oU;return OS.set(F,B),To||(To=new lU(ge("TOPN_SILENCE_THRESHOLD")||500),To.on("ActiveSpeakerChanged",Y=>{Y!=null&&(vI=Y)})),To.addSpeakers([B]),B}(O)),OS.size<=SI)return{selected:!0,speaker:P};if(!To)throw new Error("no active speaker detector");return To.levelChanged(P.id,D),Wp=To.loudest.map(F=>F.id),vI&&!ft(Wp).call(Wp,vI)&&Wp.length>=SI&&Wp.pop(),{selected:ft(Wp).call(Wp,P.id)||P.id===vI,speaker:P}}(R,E),A=function(O,D,P){let F=uc.get(O)||new zL(O,D);return F.score=P,uc.set(O,F),function(B){if(n1.set(B,!0),!r1)return void(r1=Date.now());let Y=Date.now();Y-r1>1e3&&(n1.get(B)?n1.set(B,!1):(dU(B),n1.delete(B)),r1=Y)}(O),F}(l,R.track,b.energyScore);A.addSample(y),A.active&&(e.data=s.frame.buffer,t.enqueue(e))}(n,S,C):i.enableMetadata?function(R,e,t){let r=io(new DataView(R.data));if(!r)return e.enqueue(R);let s=r.tlv.find(l=>l.tag===Hp.METADATA||l.tag===Hp.AUDIO_64_BIT_PTS);s&&t&&s.value instanceof Uint8Array&&t(s.value),R.data=r.frame.buffer,e.enqueue(R)}(S,C,i.onMetadata):C.enqueue(S)}});u.readable.pipeThrough(_).pipeTo(u.writable)}else if(mr()){if(typeof RTCRtpScriptTransform>"u")return void z.warning("browser not support RTCRtpScriptTransform");let u=Gc(),_=new MessageChannel;await new Et(C=>u.onmessage=R=>{R.data==="registered"&&C(void 0)});let S=new RTCRtpScriptTransform(u,{name:"audio-metadata-rx",port:_.port2},[_.port2]);n.transform=S,await new Et(C=>u.onmessage=R=>{R.data==="started"&&C(void 0)}),_.port1.onmessage=C=>{var R;C.data.transformed&&n.track&&((R=n.track)===null||R===void 0?void 0:R.id)!==a.track.id?(z.debug("audio track changed: ".concat(a.track.id," => ").concat(n.track.id)),a.track.removeEventListener("ended",c),a.track=n.track,a.track.addEventListener("ended",c)):C.data.metadata&&a.onMetadata&&a.onMetadata(C.data.metadata)},a.worker=u}function c(){n.track.removeEventListener("ended",c),function(u){let _=HL.get(u);if(_){(function(R){let e=OS.get(R);e&&(OS.delete(R),To&&(To.removeSpeakers([e]),OS.size===0&&(To.destroy(),To=null)))})(u),dU(u.track.id),HL.delete(u);try{var S,C;(S=_.controller)===null||S===void 0||S.terminate(),(C=_.worker)===null||C===void 0||C.terminate()}catch(R){z.warning(R&&R.message)}}}(n)}HL.set(n,a),n.track.addEventListener("ended",c)},interceptLocalVideoFrame:async function(n,i){if(!Un().supportWebRTCEncodedTransform)return void z.warning("browser not support video encoded transform");if(i1.has(n)||!n.track)return;let a={track:n.track};if(Vo()){if(!n.createEncodedStreams)return void z.warning("browser not support createEncodedStreams() API");let u=null;try{u=n.createEncodedStreams()}catch(C){return void z.error("create video-encoded-streams error",C&&C.message)}let _=[];i.on("sei-to-send",C=>{_.push(C)});let S=new TransformStream({transform(C,R){a.controller||(a.controller=R),n.track&&n.track.id!==a.track.id&&(z.debug("video track changed: ".concat(a.track.id," => ").concat(n.track.id)),a.track.removeEventListener("ended",c),a.track=n.track,a.track.addEventListener("ended",c));let e=_.shift();e&&(C.data=function(t,r){let s=function(b){let A=b.length,O=[],D=0;for(;D<A;)D+2<A&&b[D]===0&&b[D+1]===0&&(b[D+2]===0||b[D+2]===1||b[D+2]===2||b[D+2]===3)?(O.push(b[D],b[D+1],3,b[D+2]),D+=3):(O.push(b[D]),D++);return new Uint8Array(O)}(r),l=s.length,f=Math.floor(l/255),m=l%255,E=new Uint8Array(6+f+1+l+t.byteLength);E[0]=0,E[1]=0,E[2]=0,E[3]=1,E[4]=6,E[5]=101;let y=0;for(;y<f;)E[6+y]=255,y++;return E[6+y]=m,y++,E.set(s,6+y),E.set(new Uint8Array(t),6+y+l),E.buffer}(C.data,e)),R.enqueue(C)}});u.readable.pipeThrough(S).pipeTo(u.writable)}else{if(!mr())return;{if(typeof RTCRtpScriptTransform>"u")return void z.warning("browser not support RTCRtpScriptTransform");let u=Gc(),_=new MessageChannel;await new Et(C=>u.onmessage=R=>{R.data==="registered"&&C(void 0)});let S=new RTCRtpScriptTransform(u,{name:"sei-tx",port:_.port2},[_.port2]);n.transform=S,await new Et(C=>u.onmessage=R=>{R.data==="started"&&C(void 0)}),i.on("sei-to-send",C=>{_.port1.postMessage({sei:C})}),_.port1.onmessage=C=>{var R;C.data.transformed&&n.track&&((R=n.track)===null||R===void 0?void 0:R.id)!==a.track.id&&(z.debug("video track changed: ".concat(a.track.id," => ").concat(n.track.id)),a.track.removeEventListener("ended",c),a.track=n.track,a.track.addEventListener("ended",c))},a.worker=u}}function c(){if(n.track){if(this.id!==n.track.id)return;n.track.removeEventListener("ended",c)}let u=i1.get(n);if(u){i1.delete(n);try{var _,S;(_=u.controller)===null||_===void 0||_.terminate(),(S=u.worker)===null||S===void 0||S.terminate()}catch(C){z.warning(C&&C.message)}}}i1.set(n,a),n.track.addEventListener("ended",c)},interceptRemoteVideoFrame:async function(n){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!Un().supportWebRTCEncodedTransform)return void z.warning("browser not support video encoded transform");if(!n.track)return;if(yI.has(n)){let u=yI.get(n);return void(u&&(u.onSei=i.onSei))}let a={track:n.track,onSei:i.onSei};if(Vo()){if(!n.createEncodedStreams)return void z.warning("browser not support createEncodedStreams() API");let u=null;try{u=n.createEncodedStreams()}catch(S){return void z.error("create video-encoded-streams error",S&&S.message)}let _=new TransformStream({transform(S,C){a.controller||(a.controller=C),n.track&&n.track.id!==a.track.id&&(z.debug("video track changed: ".concat(a.track.id," => ").concat(n.track.id)),a.track.removeEventListener("ended",c),a.track=n.track,a.track.addEventListener("ended",c));let R=function(e){let t=new DataView(e.data),r=0;for(;r+4<e.data.byteLength;){if(t.getUint8(r+0)===0&&t.getUint8(r+1)===0&&t.getUint8(r+2)===0&&t.getUint8(r+3)===1&&t.getUint8(r+4)===6){let s=r+6,l=0,f=0;for(;(f=t.getUint8(s++))===255;)l+=255;l+=f;let m=hY(e.data,s,l);return new Uint8Array(m)}r++}return null}(S);R&&a.onSei&&a.onSei(R),C.enqueue(S)}});u.readable.pipeThrough(_).pipeTo(u.writable)}else if(mr()){if(typeof RTCRtpScriptTransform>"u")return void z.warning("browser not support RTCRtpScriptTransform");let u=Gc(),_=new MessageChannel;await new Et(C=>u.onmessage=R=>{R.data==="registered"&&C(void 0)});let S=new RTCRtpScriptTransform(u,{name:"sei-rx",port:_.port2},[_.port2]);n.transform=S,await new Et(C=>u.onmessage=R=>{R.data==="started"&&C(void 0)}),_.port1.onmessage=C=>{var R;C.data.transformed&&n.track&&((R=n.track)===null||R===void 0?void 0:R.id)!==a.track.id?(z.debug("video track changed: ".concat(a.track.id," => ").concat(n.track.id)),a.track.removeEventListener("ended",c),a.track=n.track,a.track.addEventListener("ended",c)):C.data.sei&&a.onSei&&a.onSei(C.data.sei)},a.worker=u}function c(){if(n.track){if(this.id!==n.track.id)return;n.track.removeEventListener("ended",c)}(function(u){let _=yI.get(u);if(_){yI.delete(u);try{var S,C;(S=_.controller)===null||S===void 0||S.terminate(),(C=_.worker)===null||C===void 0||C.terminate()}catch(R){z.warning(R&&R.message)}}})(n)}yI.set(n,a),n.track.addEventListener("ended",c)}},c7={name:"InterceptFrame",create:()=>o7};lI(),Sr("PROCESS_ID","process-".concat(gr(8,""),"-").concat(gr(4,""),"-").concat(gr(4,""),"-").concat(gr(4,""),"-").concat(gr(12,""))),function(){let n;try{n=window.localStorage.getItem("websdk_ng_global_parameter")}catch(i){return void z.error("Error loading sdk config",i.message)}if(n)try{let i=JSON.parse(window.atob(n)),a=Date.now();z.debug("Loading global parameters from cache",i),Object.keys(i).forEach(c=>{if(Object.prototype.hasOwnProperty.call(ai,c)){let{value:u,expires:_}=i[c];if(_&&_<=a)return;hs[c]=u,ai[c]=u}})}catch(i){z.error("Error loading mutableParamsCache: ".concat(n),i.message)}}(),Array.isArray(hs.AREAS)&&hs.AREAS.length>0&&cD(hs.AREAS,!0);let l7=(n,i,a)=>{z.debug("setParameter key:".concat(n,", value:").concat(JSON.stringify(i))),Sr(n,i,a)};Gg(cK,!1),Gg(uK,!1),Gg(pF,!1),Gg(XF,!1),Gg(JD,!1),Gg(i7,!1),Gg(TK,!1),Gg(c7,!1);let vn=function(n){let i=new li,a=n,c={getListeners:i.getListeners.bind(i),on:(u,_)=>(function(S,C){S===sd.SECURITY_POLICY_VIOLATION&&yF(C,!0)}(u,_),i.on.bind(i)(u,_)),addListener:i.addListener.bind(i),once:i.once.bind(i),off:i.off.bind(i),removeAllListeners:i.removeAllListeners.bind(i),emit:i.emit.bind(i),safeEmit:i.safeEmit.bind(i)};return K6(K6({},a),c)}({__TRACK_LIST__:_h,VERSION:Zd,BUILD:CS,ESM_BUNDLER:!1,ESM:!1,UMD:!0,DEV:!1,setParameter:l7,getParameter:ge,getSupportedCodec:async function(){let n={audio:[],video:[]};try{let i=new RTCPeerConnection,a=await async function(c){let u;return Un().supportUnifiedPlan?(c.addTransceiver("video",{direction:"recvonly"}),c.addTransceiver("audio",{direction:"recvonly"}),u=(await c.createOffer()).sdp):u=(await c.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0})).sdp,u}(i);if(!a)return n;i.close(),i=null,n=function(c){let u={video:[],audio:[]};return c.match(/ VP8/i)&&u.video.push("VP8"),c.match(/ VP9/i)&&u.video.push("VP9"),c.match(/ AV1/i)&&u.video.push("AV1"),c.match(/ H264/i)&&u.video.push("H264"),c.match(/ H265/i)&&u.video.push("H265"),c.match(/ opus/i)&&u.audio.push("OPUS"),c.match(/ PCMU/i)&&u.audio.push("PCMU"),c.match(/ PCMA/i)&&u.audio.push("PCMA"),c.match(/ G722/i)&&u.audio.push("G722"),u}(a)}catch(i){throw new De(oe.CREATE_OFFER_FAILED,i.toString&&i.toString()).print()}return n},checkSystemRequirements:function(){let n=jt.reportApiInvoke(null,{name:bn.CHECK_SYSTEM_REQUIREMENTS,options:[],tag:Li.TRACER}),i=!1;try{let _=window.RTCPeerConnection,S=navigator.mediaDevices&&navigator.mediaDevices.getUserMedia,C=window.WebSocket;i=!!(_&&S&&C),i&&mL()&&qn(75)&&new _().close()}catch(_){return z.error("check system requirement failed: ",_),!1}let a=!1,c=En();c.name===cr.CHROME&&Number(c.version)>=58&&(uh.engine.name!=="WebKit"||function(){let _=En();if(gS()){if(_.os===Ra.MAC_OS)return!0;if(_.os===Ra.IOS){let S=uh.os.version&&uh.os.version.split(".");if(S&&Number(S[0])===14&&S[1]&&Number(S[1])>=3||S&&Number(S[0])>14)return!0}}return!1}())&&(a=!0),(c.name===cr.FIREFOX&&Number(c.version)>=56||c.name===cr.OPERA&&Number(c.version)>=45||c.name===cr.SAFARI&&Number(c.version)>=11||c.name==="WebKit"&&(Ea()||Jd())&&c.osVersion&&Number(c.osVersion.split(".")[0])>=11||hL()||En().name===cr.QQ)&&(a=!0),z.debug("checkSystemRequirements, api:",i,"browser",a);let u=i&&a;return n.onSuccess(u),u},getDevices:function(n){return bl.enumerateDevices(!0,!0,n)},getMicrophones:function(n){return bl.getRecordingDevices(n)},getCameras:function(n){return bl.getCamerasDevices(n)},getElectronScreenSources:Ux,getPlaybackDevices:function(n){return bl.getSpeakers(n)},createClient:function(){var n;let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{codec:"vp8",audioCodec:"opus",mode:"rtc"},a=gr(5,"client-"),c=jt.reportApiInvoke(null,{id:a,name:bn.CREATE_CLIENT,options:[i],tag:Li.TRACER});try{(function(u){Ia(u.codec,"config.codec",["vp8","vp9","av1","h264","h265"]),Ia(u.mode,"config.mode",["rtc","live","p2p"]),u.audioCodec!==void 0&&Ia(u.audioCodec,"config.audioCodec",["opus","pcmu","pcma","g722"]),u.proxyServer!==void 0&&Pa(u.proxyServer,"config.proxyServer",1,1e4),u.turnServer!==void 0&&Tx(u.turnServer),u.httpRetryConfig!==void 0&&Bb(u.httpRetryConfig),u.websocketRetryConfig!==void 0&&Bb(u.websocketRetryConfig)})(i)}catch(u){throw c.onError(u),u}return(tI(16,0)||Up(16,0,!0))&&(i.codec==="vp9"&&(i.codec="vp8",z.debug("browser not support vp9, force use vp8")),Sr("UNSUPPORTED_VIDEO_CODEC",["vp9"])),i.audioCodec===void 0&&(i.audioCodec="opus"),c.onSuccess(),new EF(lu(lu({forceWaitGatewayResponse:!0},i),{},{role:ft(n=["rtc","p2p"]).call(n,i.mode)?"host":i.role||"audience"}),a)},createCameraVideoTrack:async function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=ge("CAMERA_CAPTURE_CONFIG"),a=gr(8,"track-cam-"),c=jt.reportApiInvoke(null,{id:a,tag:Li.TRACER,name:bn.CREATE_CAM_VIDEO_TRACK,options:[ui({},n),i]});i&&(n.encoderConfig=i);let u=hI(n),_=null;z.info("start create camera video track with config",JSON.stringify(n),"trackId",a);try{_=(await ro({video:u},a)).getVideoTracks()[0]||null}catch(C){throw c.onError(C),C}if(!_){let C=new Ye(oe.UNEXPECTED_ERROR,"can not find track in media stream");return c.onError(C),C.throw(z)}n.optimizationMode&&jL(a,_,n,zi(n.encoderConfig));let S=new UL(_,n,u,n.scalabiltyMode?uI(n.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},n.optimizationMode,a);return c.onSuccess(S.getTrackId()),z.info("create camera video success, trackId:",a),S},createCustomVideoTrack:function(n){let i=gr(8,"track-cus-"),a=jt.reportApiInvoke(null,{id:i,tag:Li.TRACER,name:bn.CREATE_CUSTOM_VIDEO_TRACK,options:[n]}),c=new ni(n.mediaStreamTrack,{width:n.width,height:n.height,frameRate:n.frameRate,bitrateMax:n.bitrateMax,bitrateMin:n.bitrateMin},n.scalabiltyMode?uI(n.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},n.optimizationMode,i,[kr.CUSTOM_TRACK]);return a.onSuccess(c.getTrackId()),z.info("create custom video track success with config",n,"trackId",c.getTrackId()),c},createScreenVideoTrack:async function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"disable",a=typeof i=="object"?function(s){return Gx(s)}(i):void 0;a&&(i="auto");let c=gr(8,"track-scr-v-"),u=jt.reportApiInvoke(null,{id:c,tag:Li.TRACER,name:bn.CREATE_SCREEN_VIDEO_TRACK,options:[ui({},n),i]});n.encoderConfig?typeof n.encoderConfig=="string"||n.encoderConfig.width&&n.encoderConfig.height||(n.encoderConfig.width={max:1920},n.encoderConfig.height={max:1080}):n.encoderConfig="1080p_2";let _=function(s){let l={};s.screenSourceType&&(l.mediaSource=s.screenSourceType),s.extensionId&&Vo()&&(l.extensionId=s.extensionId);let{displaySurface:f,selfBrowserSurface:m,surfaceSwitching:E,systemAudio:y,preferCurrentTab:b}=s;(_S(107)||jb(107)||ns(93))&&(f&&(Ia(f,"displaySurface",["browser","window","monitor"]),l.displaySurface=f),m?(Ia(m,"selfBrowserSurface",["exclude","include"]),l.selfBrowserSurface=m):l.selfBrowserSurface="include",E&&(Ia(E,"surfaceSwitching",["exclude","include"]),l.surfaceSwitching=E)),(_S(105)||jb(105)||ns(91))&&y&&(Ia(y,"systemAudio",["exclude","include"]),l.systemAudio=y),(_S(94)||jb(94)||ns(80))&&b&&(l.preferCurrentTab=!0),s.electronScreenSourceId&&(l.sourceId=s.electronScreenSourceId);let A=s.encoderConfig?zn(s.encoderConfig):null;return l.mandatory={chromeMediaSource:"desktop",maxWidth:A?A.width:void 0,maxHeight:A?A.height:void 0},A&&(A.frameRate&&(typeof A.frameRate=="number"?(l.mandatory.maxFrameRate=A.frameRate,l.mandatory.minFrameRate=A.frameRate):(l.mandatory.maxFrameRate=A.frameRate.max||A.frameRate.ideal||A.frameRate.exact||void 0,l.mandatory.minFrameRate=A.frameRate.min||A.frameRate.ideal||A.frameRate.exact||void 0),l.frameRate=A.frameRate),A.width&&(l.width=A.width),A.height&&(l.height=A.height)),l}(n),S=null,C=null,R=Un();if(!R.supportShareAudio&&i==="enable"){let s=new Ye(oe.NOT_SUPPORTED,"your browser or platform is not support share-screen with audio");return u.onError(s),s.throw(z)}z.info("start create screen video track with config",n,"withAudio",i,"trackId",c);let e=R.supportShareAudio&&i!=="disable";try{let s=await ro({screen:_,screenAudio:e?a||!0:void 0},c);S=s.getVideoTracks()[0]||null,C=s.getAudioTracks()[0]||null}catch(s){throw u.onError(s),s}if(!S){let s=new Ye(oe.UNEXPECTED_ERROR,"can not find track in media stream");return u.onError(s),s.throw(z)}if(!C&&i==="enable"){S&&S.stop();let s=new Ye(oe.SHARE_AUDIO_NOT_ALLOWED);return u.onError(s),s.throw(z)}n.optimizationMode||(n.optimizationMode="detail"),n.optimizationMode&&(jL(c,S,n,n.encoderConfig&&zn(n.encoderConfig)||void 0),n.encoderConfig&&typeof n.encoderConfig!="string"&&(n.encoderConfig.bitrateMin=n.encoderConfig.bitrateMax));let t=new ni(S,n.encoderConfig?zn(n.encoderConfig):{},n.scalabiltyMode?uI(n.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},n.optimizationMode,c,[kr.SCREEN_TRACK]);if(!C)return u.onSuccess(t.getTrackId()),z.info("create screen video track success","video:",t.getTrackId()),t;let r=new Ui(C,void 0,gr(8,"track-scr-a-"),!1);return u.onSuccess([t.getTrackId(),r.getTrackId()]),z.info("create screen video track success","video:",t.getTrackId(),"audio:",r.getTrackId()),[t,r]},createMicrophoneAndCameraTracks:async function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=ge("CAMERA_CAPTURE_CONFIG"),c=gr(8,"track-mic-"),u=gr(8,"track-cam-"),_=jt.reportApiInvoke(null,{id:"".concat(c,"-").concat(u),tag:Li.TRACER,name:bn.CREATE_MIC_AND_CAM_TRACKS,options:[n,i,a]});a&&(i.encoderConfig=a);let S=hI(i),C=y8(n),R=null,e=null;z.info("start create camera video track(".concat(u,") and microphone audio track(").concat(c,") with config, audio: ").concat(JSON.stringify(n),", video: ").concat(JSON.stringify(i)));try{let s=await ro({audio:C,video:S},"".concat(c,"-").concat(u));R=s.getAudioTracks()[0],e=s.getVideoTracks()[0]}catch(s){throw _.onError(s),s}if(!R||!e){let s=new Ye(oe.UNEXPECTED_ERROR,"can not find tracks in media stream");return _.onError(s),s.throw(z)}i.optimizationMode&&jL(u,e,i,zi(i.encoderConfig));let t=new mI(R,n,C,c),r=new UL(e,i,S,i.scalabiltyMode?uI(i.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},i.optimizationMode,u);return _.onSuccess([t.getTrackId(),r.getTrackId()]),z.info("create camera video track(".concat(u,") and microphone audio track(").concat(c,") success")),[t,r]},createMicrophoneAudioTrack:async function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=gr(8,"track-mic-"),a=jt.reportApiInvoke(null,{id:i,tag:Li.TRACER,name:bn.CREATE_MIC_AUDIO_TRACK,options:[n]}),c=y8(n),u=null;z.info("start create microphone audio track with config",JSON.stringify(n),"trackId",i);try{u=(await ro({audio:c},i)).getAudioTracks()[0]||null}catch(S){throw a.onError(S),S}if(!u){let S=new Ye(oe.UNEXPECTED_ERROR,"can not find track in media stream");return a.onError(S),S.throw(z)}let _=new mI(u,n,c,i);return a.onSuccess(_.getTrackId()),z.info("create microphone audio track success, trackId:",i),_},createCustomAudioTrack:function(n){let i=gr(8,"track-cus-"),a=jt.reportApiInvoke(null,{id:i,tag:Li.TRACER,name:bn.CREATE_CUSTOM_AUDIO_TRACK,options:[n]}),c=new Ui(n.mediaStreamTrack,n.encoderConfig?xa(n.encoderConfig):{},i,!1);return z.info("create custom audio track success with config",n,"trackId",c.getTrackId()),a.onSuccess(c.getTrackId()),c},createBufferSourceAudioTrack:async function(n){var i;let{cacheOnlineFile:a,encoderConfig:c}=n,{source:u}=n,_={source:u instanceof AudioBuffer?"AudioBuffer":u instanceof File?(i=File.name)!==null&&i!==void 0?i:"File":u,cacheOnlineFile:a,encoderConfig:c},S=gr(8,"track-buf-"),C=jt.reportApiInvoke(null,{id:S,tag:Li.TRACER,name:bn.CREATE_BUFFER_AUDIO_TRACK,options:[_]});if(ge("DISABLE_WEBAUDIO"))throw new Ye(oe.NOT_SUPPORTED,"can not create BufferSourceAudioTrack when WebAudio disabled");z.info("start create buffer source audio track with config",JSON.stringify(_),"trackId",S);let R=u;if(!(u instanceof AudioBuffer))try{u=await async function(r,s){let l=null;if(typeof r=="string"){let m=S3.get(r);if(m)return z.debug("use cached audio resource: ",r),m;try{l=(await Xu(()=>eo.get(r,{responseType:"arraybuffer"}),void 0,void 0,{maxRetryCount:3})).data}catch(E){throw new Ye(oe.FETCH_AUDIO_FILE_FAILED,E.toString())}}else l=await new Et((m,E)=>{let y=new FileReader;y.onload=b=>{b.target?m(b.target.result):E(new Ye(oe.READ_LOCAL_AUDIO_FILE_ERROR))},y.onerror=()=>{E(new Ye(oe.READ_LOCAL_AUDIO_FILE_ERROR))},y.readAsArrayBuffer(r)});let f=await function(m){let E=Tl();return new Et((y,b)=>{E.decodeAudioData(m,A=>{y(A)},A=>{b(new Ye(oe.DECODE_AUDIO_FILE_FAILED,A.toString()))})})}(l);return typeof r=="string"&&s&&S3.set(r,f),f}(u,a)}catch(r){return C.onError(r),r.throw(z)}let e=new w8(u),t=new C8(R,e,c?xa(c):{},S);return z.info("create buffer source audio track success, trackId:",S),C.onSuccess(t.getTrackId()),t},setAppType:function(n){if(z.debug("setAppType: ".concat(n)),!(Number.isInteger(n)&&n>=0))throw z.debug("Invalid appType"),new De(oe.INVALID_PARAMS,"invalid app type",n);Sr("APP_TYPE",Math.floor(n))},setLogLevel:function(n){z.setLogLevel(n)},enableLogUpload:function(){ge("USE_NEW_LOG")?Sr("UPLOAD_LOG",!0):z.enableLogUpload()},disableLogUpload:function(){ge("USE_NEW_LOG")?Sr("UPLOAD_LOG",!1):z.disableLogUpload()},createChannelMediaRelayConfiguration:function(){return new Q8},checkAudioTrackIsActive:async function(n){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5e3,a=jt.reportApiInvoke(null,{tag:Li.TRACER,name:bn.CHECK_AUDIO_TRACK_IS_ACTIVE,options:[i]});if(!(n instanceof Ui||n instanceof V_)){let R=new De(oe.INVALID_TRACK,"the parameter is not a audio track");return a.onError(R),R.throw()}i&&i<1e3&&(i=1e3);let c=n instanceof Ui?n.getTrackLabel():"remote_track",u=n.getVolumeLevel(),_=u,S=u,C=Date.now();return new Et(R=>{let e=setInterval(()=>{let t=n.getVolumeLevel();_=t>_?t:_,S=t<S?t:S;let r=_-S>1e-4,s=Date.now()-C;if(r||s>i){clearInterval(e);let l=r,f={duration:s,deviceLabel:c,maxVolumeLevel:_,result:l};z.info("[track-".concat(n.getTrackId(),"] check audio track active completed. ").concat(JSON.stringify(f))),a.onSuccess(f),R(l)}},200)})},checkVideoTrackIsActive:async function(n){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5e3,a=jt.reportApiInvoke(null,{tag:Li.TRACER,name:bn.CHECK_VIDEO_TRACK_IS_ACTIVE,options:[i]});if(!(n instanceof ni||n instanceof j_)){let r=new De(oe.INVALID_TRACK,"the parameter is not a video track");return a.onError(r),r.throw()}i&&i<1e3&&(i=1e3);let c=n instanceof ni?n.getTrackLabel():"remote_track",u=n.getMediaStreamTrack(!0),_=document.createElement("video");_.style.width="1px",_.style.height="1px",_.setAttribute("muted",""),_.muted=!0,_.setAttribute("playsinline",""),_.controls=!1,(mr()||gS())&&(_.style.opacity="0.01",_.style.position="fixed",_.style.left="0",_.style.top="0",document.body.appendChild(_)),_.srcObject=new MediaStream([u]),_.play();let S=document.createElement("canvas");S.width=160,S.height=120;let C=0,R=0;try{let r=Date.now();C=await function(s,l,f,m){let E,y=0,b=null;return new Et((A,O)=>{function D(){y>m&&E&&(E(),A(y));let P=f.getContext("2d");if(!P){let Y=new De(oe.UNEXPECTED_ERROR,"can not get canvas 2d context.");return z.error(Y.toString()),void O(Y)}P.drawImage(s,0,0,160,120);let F=P.getImageData(0,0,f.width,f.height),B=Math.floor(F.data.length/3);if(b){for(let Y=0;Y<B;Y+=3)if(F.data[Y]!==b[Y])return y+=1,void(b=F.data);b=F.data}else b=F.data}setTimeout(()=>{E&&(E(),A(y))},l),E=jn(()=>{D()},30)})}(_,i,S,4),R=Date.now()-r}catch(r){throw a.onError(r),r}nF===cr.SAFARI&&(_.pause(),_.remove()),_.srcObject=null;let e=C>4,t={duration:R,changedPicNum:C,deviceLabel:c,result:e};return z.info("[track-".concat(n.getTrackId(),"] check video track active completed. ").concat(JSON.stringify(t))),a.onSuccess(t),e},setArea:cD,audioElementPlayCenter:Go,resumeAudioContext:function(){Go.autoResumeAfterInterruption(!0)},processExternalMediaAEC:function(n){SF.processExternalMediaAEC(n)},registerExtensions:function(n){let i=ge("PLUGIN_INFO")||[];n.forEach(a=>{"name"in a&&!ft(i).call(i,a.name)&&i.push(a.name);let c=a;c.__registered__=!0,c.logger.hookLog=z.extLog,c.reporter.hookApiInvoke=jt.extApiInvoke,c.parameters&&Object.keys(c.parameters).forEach(u=>{c.parameters[u]=ge(u)})}),l7("PLUGIN_INFO",i)},ChannelMediaRelayError:hn,ChannelMediaRelayEvent:yn,ChannelMediaRelayState:Vi,RemoteStreamFallbackType:fY,RemoteStreamType:uY,ConnectionDisconnectedReason:ur,AudienceLatencyLevelType:yx,AREAS:rr,preload:async function(n,i,a,c){return iF(n,i,a,c)}});return Object.defineProperties(vn,{onAudioAutoplayFailed:{get:()=>Cl.onAudioAutoplayFailed,set:n=>{Cl.onAudioAutoplayFailed=n}},onAutoplayFailed:{get:()=>Cl.onAutoplayFailed,set:n=>{Cl.onAutoplayFailed=n}},_onSecurityPolicyViolation:{value:void 0,writable:!0},_cspEventHandlerPointer:{value:void 0,writable:!0},onSecurityPolicyViolation:{get:()=>vn._onSecurityPolicyViolation,set(n){vn._onSecurityPolicyViolation=n,yF(n)}},__CLIENT_LIST__:{get:()=>ge("SHOW_GLOBAL_CLIENT_LIST")?Yp:[]}}),bl.on(Zu.CAMERA_DEVICE_CHANGED,n=>{z.info("camera device changed",JSON.stringify(n)),vn.onCameraChanged&&vn.onCameraChanged(n),vn.safeEmit(sd.CAMERA_CHANGED,n)}),bl.on(Zu.RECORDING_DEVICE_CHANGED,n=>{z.info("microphone device changed",JSON.stringify(n)),vn.onMicrophoneChanged&&vn.onMicrophoneChanged(n),vn.safeEmit(sd.MICROPHONE_CHANGED,n)}),bl.on(Zu.PLAYOUT_DEVICE_CHANGED,n=>{z.debug("playout device changed",JSON.stringify(n)),vn.onPlaybackDeviceChanged&&vn.onPlaybackDeviceChanged(n),vn.safeEmit(sd.PLAYBACK_DEVICE_CHANGED,n)}),Go.onAutoplayFailed=()=>{z.info("detect audio element autoplay failed"),Cl.onAudioAutoplayFailed&&Cl.onAudioAutoplayFailed()},Tn.on("autoplay-failed",()=>{z.info("detect webaudio autoplay failed"),Cl.onAudioAutoplayFailed&&Cl.onAudioAutoplayFailed(),vn.safeEmit(sd.AUTOPLAY_FAILED)}),Tn.on(ms.STATE_CHANGE,(n,i)=>{z.info("audio context state changed: ".concat(i," => ").concat(n)),vn.onAudioContextStateChanged&&vn.onAudioContextStateChanged(n,i),vn.safeEmit(sd.AUDIO_CONTEXT_STATE_CHANGED,n,i)}),ki.on(Di.NETWORK_STATE_CHANGE,(n,i)=>{z.info("[network-indicator] network state changed, ".concat(i," => ").concat(n))}),window&&(window.__ARTC__=vn),vn})}),sde={};GNe(sde,{AgoraRTCProvider:()=>lde,AgoraRTCReactError:()=>gu,AgoraRTCScreenShareProvider:()=>$Ne,LocalAudioTrack:()=>ude,LocalUser:()=>yLe,LocalVideoTrack:()=>pde,RemoteAudioTrack:()=>gde,RemoteUser:()=>TLe,RemoteVideoTrack:()=>_de,TrackBoundary:()=>ELe,VERSION:()=>wLe,default:()=>RLe,useAutoPlayAudioTrack:()=>d$,useAutoPlayVideoTrack:()=>l$,useClientEvent:()=>XNe,useConnectionState:()=>tLe,useCurrentUID:()=>nLe,useIsConnected:()=>WP,useJoin:()=>rLe,useLocalCameraTrack:()=>uLe,useLocalMicrophoneTrack:()=>lLe,useLocalScreenTrack:()=>gLe,useNetworkQuality:()=>iLe,usePublish:()=>sLe,useRTCClient:()=>_0,useRTCScreenShareClient:()=>eLe,useRemoteAudioTracks:()=>fLe,useRemoteUserTrack:()=>vQ,useRemoteUsers:()=>pLe,useRemoteVideoTracks:()=>hLe,useTrackEvent:()=>QNe,useVolumeLevel:()=>oLe});var HNe=e2(t2());function vd(o,d,h){return o.on(d,h),()=>o.off(d,h)}function WNe(o){try{return o()}catch(d){console.error(d)}}function n2(o){return()=>o.forEach(WNe)}function YNe(o,d){let h=setInterval(o,d);return()=>clearInterval(h)}function bz(o,d){let h=setTimeout(o,d);return()=>clearTimeout(h)}function o$(){let o,d,h;function g(){if(d){let x=d;d=void 0,x()}}async function T(){if(h){let x=h;h=void 0;try{await x()}catch(V){console.error(V)}}}async function I(x){o=!0,await T();try{h=await x()}catch(V){console.error(V)}o=!1,g()}async function N(){o=!0,await T(),o=!1,g()}function M(x){o?d=()=>I(x):I(x)}function k(){o?d=N:N()}return{run:M,dispose:k}}var Cz=typeof document<"u"?q.useLayoutEffect:q.useEffect;function KNe(o){return o!=null&&typeof o.then=="function"}function dC(){let o=q.useRef(!1);return q.useEffect(()=>(o.current=!1,()=>{o.current=!0}),[]),o}function qNe(){let o=dC();function d(h,g){return new Promise(async(T,I)=>{try{let N=await h;o.current||T(N)}catch(N){o.current?g&&g(N):I(N)}})}return q.useCallback(d,[o])}function ode(o){let d=qNe(),[h,g]=q.useState();return Cz(()=>{KNe(o)?d(o).then(g):g(o)},[o,d]),h}function r2(o,d){let h=q.useRef();q.useEffect(()=>{let{run:g,dispose:T}=h.current||(h.current=o$());return g(o),T},d)}function JNe(o,d){let h=o.split("."),g=d.split("."),T=Math.max(h.length,g.length);for(let I=0;I<T;I++){let N=parseInt(h[I]||"0"),M=parseInt(g[I]||"0");if(N>M)return 1;if(N<M)return-1}return 0}function XNe(o,d,h){let g=q.useRef(h);Cz(()=>{g.current=h},[h]),q.useEffect(()=>{if(o)return vd(o,d,(...T)=>{g.current&&g.current(...T)})},[d,o])}function QNe(o,d,h){let g=q.useRef(h);Cz(()=>{g.current=h},[h]),q.useEffect(()=>{if(o)return vd(o,d,(...T)=>{g.current&&g.current(...T)})},[d,o])}var cde=q.createContext(null);function lde({client:o,children:d}){return j.jsx(cde.Provider,{value:o,children:d})}function ZNe(o){let d=q.useContext(cde);return o||d}function _0(o){let d=ZNe(o);if(!d)throw new Error("Agora RTC client not found. Should be wrapped in <AgoraRTCProvider value={client} />");return d}var dde=q.createContext(null);function $Ne({client:o,children:d}){return j.jsx(dde.Provider,{value:o,children:d})}function eLe(o){let d=q.useContext(dde);return o||d}function tLe(o){let d=_0(o),[h,g]=q.useState(d?d.connectionState:"DISCONNECTED");return q.useEffect(()=>{if(d){g(d.connectionState);let T;return n2([vd(d,"connection-state-change",I=>{T==null||T(),I==="CONNECTED"?T=bz(()=>g(I),0):g(I)}),()=>T==null?void 0:T()])}else g("DISCONNECTED")},[d]),h}function WP(o){let d=_0(o),[h,g]=q.useState(d?d.connectionState==="CONNECTED":!1);return q.useEffect(()=>{if(d){g(d.connectionState==="CONNECTED");let T;return n2([vd(d,"connection-state-change",I=>{T==null||T(),T=bz(()=>g(I==="CONNECTED"),0)}),()=>T==null?void 0:T()])}else g(!1)},[d]),h}function nLe(o){let d=_0(o),[h,g]=q.useState(d==null?void 0:d.uid);return q.useEffect(()=>{if(d)return vd(d,"connection-state-change",T=>{if(T==="CONNECTED")return bz(()=>g(d.uid),0);T==="DISCONNECTED"&&g(void 0)})},[d]),h}var gu=class extends Error{constructor(d,h){var o=(...fPe)=>(super(...fPe),ry(this,"rtcMethod"),ry(this,"rtcError"),ry(this,"name","AgoraRTCReactException"),this);o(typeof h=="string"?h:h.message),this.rtcMethod=d,this.rtcError=h}log(d){console[d](this)}};function rLe(o,d=!0,h){let g=_0(h),T=WP(h),I=q.useRef(),[N,M]=q.useState(!1),[k,x]=q.useState(0),[V,K]=q.useState(null),Q=dC();return r2(async()=>{if(Q.current||(K(null),x(0),M(!1)),d&&g){try{Q.current||M(!0);let{appid:X,channel:Z,token:ae,uid:le}=typeof o=="function"?await o():o,fe=await g.join(X,Z,ae,le);Q.current||x(fe)}catch(X){console.error(X),Q.current||K(new gu("IAgoraRTCClient.join",X))}Q.current||M(!1);let ie=I.current||(I.current=o$());return n2([()=>{ie.dispose()},()=>{ie.run(()=>g.unpublish(g.localTracks))},()=>{for(let X of g.localTracks)X.isPlaying&&X.stop(),X.close();ie.run(()=>g.leave())}])}},[d,h]),{data:k,isLoading:N,isConnected:T,error:V}}var Yie=()=>({uplinkNetworkQuality:0,downlinkNetworkQuality:0,delay:0});function iLe(o){let d=_0(o),[h,g]=q.useState(Yie);return q.useEffect(()=>{if(d)return vd(d,"network-quality",T=>g({uplinkNetworkQuality:T.uplinkNetworkQuality,downlinkNetworkQuality:T.downlinkNetworkQuality,delay:d.getRTCStats().RTT??0}));g(Yie())},[d]),h}var aLe=e2(t2());function sLe(o,d=!0,h){let g=_0(h),T=WP(h),I=q.useRef([]),[N,M]=q.useState(!1),[k,x]=q.useState(null),V=dC();return r2(async()=>{if(V.current||(M(!1),x(null)),!g||!T||!d)return;let K=o.filter(Boolean),Q=Z=>{let ae=JNe(aLe.default.VERSION,"4.18.2")>=0;return ae||new gu("usePublish","please check your agora-rtc-sdk-ng version in package.json, it's recommend upgrade to >= 4.18.2").log("warn"),ae?g.mode!=="live"||g.role!=="audience":!0},ie=Z=>I.current.some(ae=>ae&&ae.getTrackId()===Z.getTrackId()),X=Z=>Q()&&Z.enabled&&d&&!ie(Z);for(let Z=0;Z<K.length;Z++){let ae=K[Z];if(ae&&X(ae)){await g.unpublish(I.current.filter(le=>(le==null?void 0:le.trackMediaType)===ae.trackMediaType));try{V.current||M(!0),await g.publish(ae)}catch(le){console.error(le),V.current||x(new gu("IAgoraRTCClient.publish",le))}V.current||M(!1)}}I.current=K},[T,d,g,o]),{isLoading:N,error:k}}function oLe(o){let[d,h]=q.useState(0);return q.useEffect(()=>{if(o)return YNe(()=>{h(o.getVolumeLevel())},1e3)},[o]),d}var cLe=e2(t2());function lLe(o=!0,d={ANS:!0,AEC:!0}){let[h,g]=q.useState(null),[T,I]=q.useState(!1),[N,M]=q.useState(null),k=dC();return r2(async()=>{if(k.current||(I(!1),M(null)),o&&!h){try{k.current||I(!0);let x=await cLe.default.createMicrophoneAudioTrack(d);k.current||g(x)}catch(x){console.error(x),k.current||M(new gu("IAgoraRTC.createMicrophoneAudioTrack",x))}k.current||I(!1)}},[o]),{localMicrophoneTrack:h,isLoading:T,error:N}}var dLe=e2(t2());function uLe(o=!0,d){let[h,g]=q.useState(null),[T,I]=q.useState(!1),[N,M]=q.useState(null),k=dC();return r2(async()=>{if(k.current||(I(!1),M(null)),o&&!h){try{k.current||I(!0);let x=await dLe.default.createCameraVideoTrack(d);k.current||g(x)}catch(x){console.error(x),k.current||M(new gu("IAgoraRTC.createCameraVideoTrack",x))}k.current||I(!1)}},[o]),{localCameraTrack:h,isLoading:T,error:N}}function fLe(o,d){let h=_0(d),[g,T]=q.useState([]),I=WP(),N=q.useRef([]),[M,k]=q.useState(!1),[x,V]=q.useState(null),K=dC();return r2(async()=>{if(K.current||V(null),!Array.isArray(o)||!I)return;let Q=async Z=>{if(!Z.audioTrack&&o.some(({uid:ae})=>Z.uid===ae)){try{K.current||k(!0),await h.subscribe(Z,"audio")}catch(ae){console.error(ae),K.current||V(new gu("IAgoraRTCClient.subscribe",ae))}Z.audioTrack&&!N.current.some(ae=>ae.getUserId()===Z.uid)&&N.current.push(Z.audioTrack),N.current=N.current.map(ae=>Z.audioTrack&&ae.getUserId()===Z.uid&&ae.getTrackId()!==Z.audioTrack.getTrackId()?Z.audioTrack:ae),K.current||(T([...N.current]),k(!1))}},ie=async Z=>{if(o.some(({uid:ae})=>Z.uid===ae)){K.current||(N.current=N.current.filter(ae=>ae.getUserId()!==Z.uid),T([...N.current]));try{K.current||k(!0),await h.unsubscribe(Z,"audio")}catch(ae){console.error(ae),K.current||V(new gu("IAgoraRTCClient.unsubscribe",ae))}K.current||k(!1)}};o.map(Z=>{!Z.audioTrack&&Z.hasAudio&&Q(Z)});let X=[];for(let Z=0;Z<N.current.length;Z++){let ae=N.current[Z];if(!o.some(le=>le.uid===ae.getUserId())){let le=h.remoteUsers.find(fe=>fe.uid===ae.getUserId());le&&X.push({user:le,mediaType:"audio"}),N.current.splice(Z,1),Z--}}if(X.length>0){try{K.current||k(!0),await h.massUnsubscribe(X)}catch(Z){console.error(Z),K.current||V(new gu("IAgoraRTCClient.massUnsubscribe",Z))}K.current||(T(N.current.slice()),k(!1))}return n2([vd(h,"user-published",(Z,ae)=>{o.find(le=>le.uid===Z.uid)&&ae==="audio"&&Q(Z)}),vd(h,"user-unpublished",(Z,ae)=>{o.find(le=>le.uid===Z.uid)&&ae==="audio"&&ie(Z)})])},[I,h,o]),{audioTracks:g,isLoading:M,error:x}}function hLe(o,d){let h=_0(d),[g,T]=q.useState([]),I=WP(),N=q.useRef([]),[M,k]=q.useState(!1),[x,V]=q.useState(null),K=dC();return r2(async()=>{if(K.current||V(null),!Array.isArray(o)||!I)return;let Q=async Z=>{if(!Z.videoTrack&&o.some(({uid:ae})=>Z.uid===ae)){try{K.current||k(!0),await h.subscribe(Z,"video")}catch(ae){console.error(ae),K.current||V(new gu("IAgoraRTCClient.subscribe",ae))}Z.videoTrack&&!N.current.some(ae=>ae.getUserId()===Z.uid)&&N.current.push(Z.videoTrack),N.current=N.current.map(ae=>Z.videoTrack&&ae.getUserId()===Z.uid&&ae.getTrackId()!==Z.videoTrack.getTrackId()?Z.videoTrack:ae),K.current||(T([...N.current]),k(!1))}},ie=async Z=>{if(o.some(({uid:ae})=>Z.uid===ae)){K.current||(N.current=N.current.filter(ae=>ae.getUserId()!==Z.uid),T([...N.current]));try{K.current||k(!0),await h.unsubscribe(Z,"video")}catch(ae){console.error(ae),K.current||V(new gu("IAgoraRTCClient.unsubscribe",ae))}K.current||k(!1)}};o.map(Z=>{!Z.videoTrack&&Z.hasVideo&&Q(Z)});let X=[];for(let Z=0;Z<N.current.length;Z++){let ae=N.current[Z];if(!o.some(le=>le.uid===ae.getUserId())){let le=h.remoteUsers.find(fe=>fe.uid===ae.getUserId());le&&X.push({user:le,mediaType:"video"}),N.current.splice(Z,1),Z--}}if(X.length>0){try{K.current||k(!0),await h.massUnsubscribe(X)}catch(Z){console.error(Z),K.current||V(new gu("IAgoraRTCClient.massUnsubscribe",Z))}K.current||(T(N.current.slice()),k(!1))}return n2([vd(h,"user-published",(Z,ae)=>{o.find(le=>le.uid===Z.uid)&&ae==="video"&&Q(Z)}),vd(h,"user-unpublished",(Z,ae)=>{o.find(le=>le.uid===Z.uid)&&ae==="video"&&ie(Z)})])},[I,h,o]),{videoTracks:g,isLoading:M,error:x}}function vQ(o,d,h){let g=_0(h),T=d==="audio"?"audioTrack":"videoTrack",[I,N]=q.useState(o&&o[T]),M=WP(),k=q.useRef(),[x,V]=q.useState(!1),[K,Q]=q.useState(null);return q.useEffect(()=>{if(!o||!M)return;let ie=!1;ie||Q(null);let X=d==="audio"?"hasAudio":"hasVideo",Z=o.uid,ae=async(ue,de)=>{if(ue[T]&&g.remoteUsers.some(({uid:te})=>ue.uid===te))try{ie||V(!0),await g.unsubscribe(ue,de)}catch(te){ie||Q(new gu("IAgoraRTCClient.unsubscribe",te)),console.error(te)}ie||(N(void 0),V(!1))},le=async(ue,de)=>{try{!ue[T]&&g.remoteUsers.some(({uid:te})=>ue.uid===te)&&(ie||V(!0),await g.subscribe(ue,de)),ie||N(ue[T])}catch(te){ie||Q(new gu("IAgoraRTCClient.subscribe",te)),console.error(te)}ie||V(!1)},fe=k.current||(k.current=o$());return!o[T]&&o[X]?fe.run(()=>le(o,d)):N(o[T]),n2([()=>{ie=!0,fe.dispose()},vd(g,"user-published",(ue,de)=>{ue.uid===Z&&de===d&&fe.run(()=>le(ue,d))}),vd(g,"user-unpublished",(ue,de)=>{ue.uid===Z&&de===d&&fe.run(()=>ae(ue,d))})])},[M,g,o,d,T]),{track:I,isLoading:x,error:K}}function pLe(o){let d=_0(o),[h,g]=q.useState(d?d.remoteUsers:[]);return q.useEffect(()=>{if(d){let T=()=>g(d.remoteUsers.slice());return n2([vd(d,"user-joined",T),vd(d,"user-left",T),vd(d,"user-published",T),vd(d,"user-unpublished",T)])}},[d]),h}var mLe=e2(t2());function gLe(o=!0,d,h){let[g,T]=q.useState(null),[I,N]=q.useState(!1),[M,k]=q.useState(null),x=dC();return r2(async()=>{if(x.current||(N(!1),k(null)),o&&!g){try{x.current||N(!0);let V=await mLe.default.createScreenVideoTrack(d,h);x.current||T(V)}catch(V){console.error(V),x.current||k(new gu("IAgoraRTC.createScreenVideoTrack",V))}x.current||N(!1)}},[o]),{screenTrack:g,isLoading:I,error:M}}function _Le(){let o=new Map,d=1500;return{onMount:h=>{let g=o.get(h);g&&(g(),o.delete(h))},onUnmount:h=>{let g=o.get(h);g&&g(),o.set(h,bz(()=>{h.isPlaying&&h.stop(),o.delete(h)},d))},dispose:()=>{for(let[h,g]of o)h.isPlaying&&h.stop(),g&&g();o.clear()}}}var c$=q.createContext(void 0);function ELe({children:o}){let[d]=q.useState(_Le);return q.useEffect(()=>d.dispose,[d]),j.jsx(c$.Provider,{value:d,children:o})}function l$(o,d,h,g){let T=q.useContext(c$);q.useEffect(()=>{if(o)return g&&d?o.play(g,h||void 0):o.stop(),T?(T.onMount(o),()=>T.onUnmount(o)):()=>{o.isPlaying&&o.stop()}},[o,g,d,T,h])}function d$(o,d){let h=q.useContext(c$);Cz(()=>{if(o)return d?o.play():o.stop(),h?(h.onMount(o),()=>h.onUnmount(o)):()=>{o.isPlaying&&o.stop()}},[o,d,h])}function ude({track:o,play:d=!1,volume:h,disabled:g,muted:T,children:I}){let N=ode(o);return d$(N,d),q.useEffect(()=>{N&&h!=null&&N.setVolume(h)},[N,h]),q.useEffect(()=>{N&&g!=null&&N.setEnabled(!g).catch(console.warn)},[g,N]),q.useEffect(()=>{N&&T!=null&&N.setMuted(T).catch(console.warn)},[T,N]),I?j.jsx(j.Fragment,{children:I}):null}var fde={position:"relative",width:"100%",height:"100%",overflow:"hidden",background:"#000"},hde={width:"100%",height:"100%"},u$={position:"absolute",top:0,left:0,width:"100%",height:"100%",overflow:"hidden",zIndex:2},wz=(o,d)=>q.useMemo(()=>({...o,...d}),[o,d]);function pde({track:o,play:d,disabled:h,muted:g,style:T,videoPlayerConfig:I,...N}){let M=wz(hde,T),[k,x]=q.useState(null),V=ode(o);return l$(V,d,I,k),q.useEffect(()=>{V&&h!=null&&V.setEnabled(!h).catch(console.warn)},[h,V]),q.useEffect(()=>{V&&g!=null&&V.setMuted(g).catch(console.warn)},[g,V]),j.jsx("div",{...N,ref:x,style:M})}var vLe={width:"100%",height:"100%",background:"#1a1e21 center/cover no-repeat",filter:"blur(16px) brightness(0.4)"},SLe={position:"absolute",top:"50%",left:"50%",maxWidth:"50%",maxHeight:"50%",aspectRatio:"1",transform:"translate(-50%, -50%)",borderRadius:"50%",overflow:"hidden",objectFit:"cover"};function mde({cover:o}){return j.jsx("div",{style:u$,children:typeof o=="string"?j.jsxs(j.Fragment,{children:[j.jsx("div",{style:{...vLe,backgroundImage:`url(${o})`}}),j.jsx("img",{src:o,style:SLe})]}):o()})}function yLe({micOn:o,cameraOn:d,audioTrack:h,videoTrack:g,playAudio:T,playVideo:I,volume:N,cover:M,children:k,style:x,...V}){let K=wz(fde,x);return I=I??!!d,T=T??!!o,j.jsxs("div",{...V,style:K,children:[j.jsx(pde,{disabled:!d,play:I,track:g}),j.jsx(ude,{disabled:!o,play:T,track:h,volume:N}),M&&!d&&j.jsx(mde,{cover:M}),j.jsx("div",{style:u$,children:k})]})}function gde({track:o,play:d=!1,playbackDeviceId:h,volume:g,children:T}){return d$(o,d),q.useEffect(()=>{o&&h!=null&&o.setPlaybackDevice(h).catch(console.warn)},[o,h]),q.useEffect(()=>{o&&g!=null&&o.setVolume(g)},[o,g]),T?j.jsx(j.Fragment,{children:T}):null}function _de({track:o,play:d,style:h,videoPlayerConfig:g,...T}){let I=wz(hde,h),[N,M]=q.useState(null);return l$(o,d,g,N),j.jsx("div",{...T,ref:M,style:I})}function TLe({user:o,playVideo:d,playAudio:h,playbackDeviceId:g,volume:T,cover:I,style:N,children:M,videoPlayerConfig:k,...x}){let V=wz(fde,N),{track:K}=vQ(o,"video"),{track:Q}=vQ(o,"audio");return d=d??(o==null?void 0:o.hasVideo),h=h??(o==null?void 0:o.hasAudio),j.jsxs("div",{...x,style:V,children:[j.jsx(_de,{play:d,track:K,videoPlayerConfig:k}),j.jsx(gde,{play:h,playbackDeviceId:g,track:Q,volume:T}),I&&!d&&j.jsx(mde,{cover:I}),j.jsx("div",{style:u$,children:M})]})}var bLe=e2(t2()),CLe=class{constructor(){ry(this,"appType",1001);bLe.default.setAppType(this.appType)}};new CLe;var wLe="2.4.0";zNe(sde,e2(t2()));var RLe=HNe.default;const ILe=j7.createClient({mode:"rtc",codec:"vp8"});Nde.createRoot(document.getElementById("root")).render(j.jsx(q.StrictMode,{children:j.jsx(lde,{client:ILe,children:j.jsx(M2e,{children:j.jsx(kNe,{})})})}));
